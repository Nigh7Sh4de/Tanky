
// This is ammo.js, a port of Bullet Physics to JavaScript. zlib licensed.
var Ammo = (function() {
  var Module = this;

var Module;if(!Module)Module=(typeof Module!=="undefined"?Module:null)||{};var moduleOverrides={};for(var key in Module){if(Module.hasOwnProperty(key)){moduleOverrides[key]=Module[key]}}var ENVIRONMENT_IS_NODE=typeof process==="object"&&typeof require==="function";var ENVIRONMENT_IS_WEB=typeof window==="object";var ENVIRONMENT_IS_WORKER=typeof importScripts==="function";var ENVIRONMENT_IS_SHELL=!ENVIRONMENT_IS_WEB&&!ENVIRONMENT_IS_NODE&&!ENVIRONMENT_IS_WORKER;if(ENVIRONMENT_IS_NODE){if(!Module["print"])Module["print"]=function print(x){process["stdout"].write(x+"\n")};if(!Module["printErr"])Module["printErr"]=function printErr(x){process["stderr"].write(x+"\n")};var nodeFS=require("fs");var nodePath=require("path");Module["read"]=function read(filename,binary){filename=nodePath["normalize"](filename);var ret=nodeFS["readFileSync"](filename);if(!ret&&filename!=nodePath["resolve"](filename)){filename=path.join(__dirname,"..","src",filename);ret=nodeFS["readFileSync"](filename)}if(ret&&!binary)ret=ret.toString();return ret};Module["readBinary"]=function readBinary(filename){return Module["read"](filename,true)};Module["load"]=function load(f){globalEval(read(f))};Module["thisProgram"]=process["argv"][1].replace(/\\/g,"/");Module["arguments"]=process["argv"].slice(2);if(typeof module!=="undefined"){module["exports"]=Module}process["on"]("uncaughtException",(function(ex){if(!(ex instanceof ExitStatus)){throw ex}}))}else if(ENVIRONMENT_IS_SHELL){if(!Module["print"])Module["print"]=print;if(typeof printErr!="undefined")Module["printErr"]=printErr;if(typeof read!="undefined"){Module["read"]=read}else{Module["read"]=function read(){throw"no read() available (jsc?)"}}Module["readBinary"]=function readBinary(f){if(typeof readbuffer==="function"){return new Uint8Array(readbuffer(f))}var data=read(f,"binary");assert(typeof data==="object");return data};if(typeof scriptArgs!="undefined"){Module["arguments"]=scriptArgs}else if(typeof arguments!="undefined"){Module["arguments"]=arguments}this["Module"]=Module}else if(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER){Module["read"]=function read(url){var xhr=new XMLHttpRequest;xhr.open("GET",url,false);xhr.send(null);return xhr.responseText};if(typeof arguments!="undefined"){Module["arguments"]=arguments}if(typeof console!=="undefined"){if(!Module["print"])Module["print"]=function print(x){console.log(x)};if(!Module["printErr"])Module["printErr"]=function printErr(x){console.log(x)}}else{var TRY_USE_DUMP=false;if(!Module["print"])Module["print"]=TRY_USE_DUMP&&typeof dump!=="undefined"?(function(x){dump(x)}):(function(x){})}if(ENVIRONMENT_IS_WEB){window["Module"]=Module}else{Module["load"]=importScripts}}else{throw"Unknown runtime environment. Where are we?"}function globalEval(x){throw"NO_DYNAMIC_EXECUTION was set, cannot eval"}if(!Module["load"]&&Module["read"]){Module["load"]=function load(f){globalEval(Module["read"](f))}}if(!Module["print"]){Module["print"]=(function(){})}if(!Module["printErr"]){Module["printErr"]=Module["print"]}if(!Module["arguments"]){Module["arguments"]=[]}if(!Module["thisProgram"]){Module["thisProgram"]="./this.program"}Module.print=Module["print"];Module.printErr=Module["printErr"];Module["preRun"]=[];Module["postRun"]=[];for(var key in moduleOverrides){if(moduleOverrides.hasOwnProperty(key)){Module[key]=moduleOverrides[key]}}var Runtime={setTempRet0:(function(value){tempRet0=value}),getTempRet0:(function(){return tempRet0}),stackSave:(function(){return STACKTOP}),stackRestore:(function(stackTop){STACKTOP=stackTop}),getNativeTypeSize:(function(type){switch(type){case"i1":case"i8":return 1;case"i16":return 2;case"i32":return 4;case"i64":return 8;case"float":return 4;case"double":return 8;default:{if(type[type.length-1]==="*"){return Runtime.QUANTUM_SIZE}else if(type[0]==="i"){var bits=parseInt(type.substr(1));assert(bits%8===0);return bits/8}else{return 0}}}}),getNativeFieldSize:(function(type){return Math.max(Runtime.getNativeTypeSize(type),Runtime.QUANTUM_SIZE)}),STACK_ALIGN:16,getAlignSize:(function(type,size,vararg){if(!vararg&&(type=="i64"||type=="double"))return 8;if(!type)return Math.min(size,8);return Math.min(size||(type?Runtime.getNativeFieldSize(type):0),Runtime.QUANTUM_SIZE)}),dynCall:(function(sig,ptr,args){if(args&&args.length){if(!args.splice)args=Array.prototype.slice.call(args);args.splice(0,0,ptr);return Module["dynCall_"+sig].apply(null,args)}else{return Module["dynCall_"+sig].call(null,ptr)}}),functionPointers:[],addFunction:(function(func){for(var i=0;i<Runtime.functionPointers.length;i++){if(!Runtime.functionPointers[i]){Runtime.functionPointers[i]=func;return 2*(1+i)}}throw"Finished up all reserved function pointers. Use a higher value for RESERVED_FUNCTION_POINTERS."}),removeFunction:(function(index){Runtime.functionPointers[(index-2)/2]=null}),getAsmConst:(function(code,numArgs){if(!Runtime.asmConstCache)Runtime.asmConstCache={};var func=Runtime.asmConstCache[code];if(func)return func;var args=[];for(var i=0;i<numArgs;i++){args.push(String.fromCharCode(36)+i)}var source=Pointer_stringify(code);if(source[0]==='"'){if(source.indexOf('"',1)===source.length-1){source=source.substr(1,source.length-2)}else{abort("invalid EM_ASM input |"+source+"|. Please use EM_ASM(..code..) (no quotes) or EM_ASM({ ..code($0).. }, input) (to input values)")}}abort("NO_DYNAMIC_EXECUTION was set, cannot eval, so EM_ASM is not functional");return Runtime.asmConstCache[code]=evalled}),warnOnce:(function(text){if(!Runtime.warnOnce.shown)Runtime.warnOnce.shown={};if(!Runtime.warnOnce.shown[text]){Runtime.warnOnce.shown[text]=1;Module.printErr(text)}}),funcWrappers:{},getFuncWrapper:(function(func,sig){assert(sig);if(!Runtime.funcWrappers[sig]){Runtime.funcWrappers[sig]={}}var sigCache=Runtime.funcWrappers[sig];if(!sigCache[func]){sigCache[func]=function dynCall_wrapper(){return Runtime.dynCall(sig,func,arguments)}}return sigCache[func]}),UTF8Processor:(function(){var buffer=[];var needed=0;this.processCChar=(function(code){code=code&255;if(buffer.length==0){if((code&128)==0){return String.fromCharCode(code)}buffer.push(code);if((code&224)==192){needed=1}else if((code&240)==224){needed=2}else{needed=3}return""}if(needed){buffer.push(code);needed--;if(needed>0)return""}var c1=buffer[0];var c2=buffer[1];var c3=buffer[2];var c4=buffer[3];var ret;if(buffer.length==2){ret=String.fromCharCode((c1&31)<<6|c2&63)}else if(buffer.length==3){ret=String.fromCharCode((c1&15)<<12|(c2&63)<<6|c3&63)}else{var codePoint=(c1&7)<<18|(c2&63)<<12|(c3&63)<<6|c4&63;ret=String.fromCharCode(((codePoint-65536)/1024|0)+55296,(codePoint-65536)%1024+56320)}buffer.length=0;return ret});this.processJSString=function processJSString(string){string=unescape(encodeURIComponent(string));var ret=[];for(var i=0;i<string.length;i++){ret.push(string.charCodeAt(i))}return ret}}),getCompilerSetting:(function(name){throw"You must build with -s RETAIN_COMPILER_SETTINGS=1 for Runtime.getCompilerSetting or emscripten_get_compiler_setting to work"}),stackAlloc:(function(size){var ret=STACKTOP;STACKTOP=STACKTOP+size|0;STACKTOP=STACKTOP+15&-16;return ret}),staticAlloc:(function(size){var ret=STATICTOP;STATICTOP=STATICTOP+size|0;STATICTOP=STATICTOP+15&-16;return ret}),dynamicAlloc:(function(size){var ret=DYNAMICTOP;DYNAMICTOP=DYNAMICTOP+size|0;DYNAMICTOP=DYNAMICTOP+15&-16;if(DYNAMICTOP>=TOTAL_MEMORY)enlargeMemory();return ret}),alignMemory:(function(size,quantum){var ret=size=Math.ceil(size/(quantum?quantum:16))*(quantum?quantum:16);return ret}),makeBigInt:(function(low,high,unsigned){var ret=unsigned?+(low>>>0)+ +(high>>>0)*+4294967296:+(low>>>0)+ +(high|0)*+4294967296;return ret}),GLOBAL_BASE:8,QUANTUM_SIZE:4,__dummy__:0};Module["Runtime"]=Runtime;var __THREW__=0;var ABORT=false;var EXITSTATUS=0;var undef=0;var tempValue,tempInt,tempBigInt,tempInt2,tempBigInt2,tempPair,tempBigIntI,tempBigIntR,tempBigIntS,tempBigIntP,tempBigIntD,tempDouble,tempFloat;var tempI64,tempI64b;var tempRet0,tempRet1,tempRet2,tempRet3,tempRet4,tempRet5,tempRet6,tempRet7,tempRet8,tempRet9;function assert(condition,text){if(!condition){abort("Assertion failed: "+text)}}var globalScope=this;function getCFunc(ident){var func=Module["_"+ident];if(!func){abort("NO_DYNAMIC_EXECUTION was set, cannot eval - ccall/cwrap are not functional")}assert(func,"Cannot call unknown function "+ident+" (perhaps LLVM optimizations or closure removed it?)");return func}var cwrap,ccall;((function(){var stack=0;var JSfuncs={"stackSave":(function(){stack=Runtime.stackSave()}),"stackRestore":(function(){Runtime.stackRestore(stack)}),"arrayToC":(function(arr){var ret=Runtime.stackAlloc(arr.length);writeArrayToMemory(arr,ret);return ret}),"stringToC":(function(str){var ret=0;if(str!==null&&str!==undefined&&str!==0){ret=Runtime.stackAlloc((str.length<<2)+1);writeStringToMemory(str,ret)}return ret})};var toC={"string":JSfuncs["stringToC"],"array":JSfuncs["arrayToC"]};ccall=function ccallFunc(ident,returnType,argTypes,args){var func=getCFunc(ident);var cArgs=[];if(args){for(var i=0;i<args.length;i++){var converter=toC[argTypes[i]];if(converter){if(stack===0)stack=Runtime.stackSave();cArgs[i]=converter(args[i])}else{cArgs[i]=args[i]}}}var ret=func.apply(null,cArgs);if(returnType==="string")ret=Pointer_stringify(ret);if(stack!==0)JSfuncs["stackRestore"]();return ret};var sourceRegex=/^function\s*\(([^)]*)\)\s*{\s*([^*]*?)[\s;]*(?:return\s*(.*?)[;\s]*)?}$/;function parseJSFunc(jsfunc){var parsed=jsfunc.toString().match(sourceRegex).slice(1);return{arguments:parsed[0],body:parsed[1],returnValue:parsed[2]}}var JSsource={};for(var fun in JSfuncs){if(JSfuncs.hasOwnProperty(fun)){JSsource[fun]=parseJSFunc(JSfuncs[fun])}}cwrap=function cwrap(ident,returnType,argTypes){argTypes=argTypes||[];var cfunc=getCFunc(ident);var numericArgs=argTypes.every((function(type){return type==="number"}));var numericRet=returnType!=="string";if(numericRet&&numericArgs){return cfunc}var argNames=argTypes.map((function(x,i){return"$"+i}));var funcstr="(function("+argNames.join(",")+") {";var nargs=argTypes.length;if(!numericArgs){funcstr+=JSsource["stackSave"].body+";";for(var i=0;i<nargs;i++){var arg=argNames[i],type=argTypes[i];if(type==="number")continue;var convertCode=JSsource[type+"ToC"];funcstr+="var "+convertCode.arguments+" = "+arg+";";funcstr+=convertCode.body+";";funcstr+=arg+"="+convertCode.returnValue+";"}}var cfuncname=parseJSFunc((function(){return cfunc})).returnValue;funcstr+="var ret = "+cfuncname+"("+argNames.join(",")+");";if(!numericRet){var strgfy=parseJSFunc((function(){return Pointer_stringify})).returnValue;funcstr+="ret = "+strgfy+"(ret);"}if(!numericArgs){funcstr+=JSsource["stackRestore"].body+";"}funcstr+="return ret})";abort("NO_DYNAMIC_EXECUTION was set, cannot eval - ccall is not functional")}}))();Module["cwrap"]=cwrap;Module["ccall"]=ccall;function setValue(ptr,value,type,noSafe){type=type||"i8";if(type.charAt(type.length-1)==="*")type="i32";switch(type){case"i1":HEAP8[ptr>>0]=value;break;case"i8":HEAP8[ptr>>0]=value;break;case"i16":HEAP16[ptr>>1]=value;break;case"i32":HEAP32[ptr>>2]=value;break;case"i64":tempI64=[value>>>0,(tempDouble=value,+Math_abs(tempDouble)>=+1?tempDouble>+0?(Math_min(+Math_floor(tempDouble/+4294967296),+4294967295)|0)>>>0:~~+Math_ceil((tempDouble- +(~~tempDouble>>>0))/+4294967296)>>>0:0)],HEAP32[ptr>>2]=tempI64[0],HEAP32[ptr+4>>2]=tempI64[1];break;case"float":HEAPF32[ptr>>2]=value;break;case"double":HEAPF64[ptr>>3]=value;break;default:abort("invalid type for setValue: "+type)}}Module["setValue"]=setValue;function getValue(ptr,type,noSafe){type=type||"i8";if(type.charAt(type.length-1)==="*")type="i32";switch(type){case"i1":return HEAP8[ptr>>0];case"i8":return HEAP8[ptr>>0];case"i16":return HEAP16[ptr>>1];case"i32":return HEAP32[ptr>>2];case"i64":return HEAP32[ptr>>2];case"float":return HEAPF32[ptr>>2];case"double":return HEAPF64[ptr>>3];default:abort("invalid type for setValue: "+type)}return null}Module["getValue"]=getValue;var ALLOC_NORMAL=0;var ALLOC_STACK=1;var ALLOC_STATIC=2;var ALLOC_DYNAMIC=3;var ALLOC_NONE=4;Module["ALLOC_NORMAL"]=ALLOC_NORMAL;Module["ALLOC_STACK"]=ALLOC_STACK;Module["ALLOC_STATIC"]=ALLOC_STATIC;Module["ALLOC_DYNAMIC"]=ALLOC_DYNAMIC;Module["ALLOC_NONE"]=ALLOC_NONE;function allocate(slab,types,allocator,ptr){var zeroinit,size;if(typeof slab==="number"){zeroinit=true;size=slab}else{zeroinit=false;size=slab.length}var singleType=typeof types==="string"?types:null;var ret;if(allocator==ALLOC_NONE){ret=ptr}else{ret=[_malloc,Runtime.stackAlloc,Runtime.staticAlloc,Runtime.dynamicAlloc][allocator===undefined?ALLOC_STATIC:allocator](Math.max(size,singleType?1:types.length))}if(zeroinit){var ptr=ret,stop;assert((ret&3)==0);stop=ret+(size&~3);for(;ptr<stop;ptr+=4){HEAP32[ptr>>2]=0}stop=ret+size;while(ptr<stop){HEAP8[ptr++>>0]=0}return ret}if(singleType==="i8"){if(slab.subarray||slab.slice){HEAPU8.set(slab,ret)}else{HEAPU8.set(new Uint8Array(slab),ret)}return ret}var i=0,type,typeSize,previousType;while(i<size){var curr=slab[i];if(typeof curr==="function"){curr=Runtime.getFunctionIndex(curr)}type=singleType||types[i];if(type===0){i++;continue}if(type=="i64")type="i32";setValue(ret+i,curr,type);if(previousType!==type){typeSize=Runtime.getNativeTypeSize(type);previousType=type}i+=typeSize}return ret}Module["allocate"]=allocate;function Pointer_stringify(ptr,length){if(length===0)return"";var hasUtf=false;var t;var i=0;while(1){t=HEAPU8[ptr+i>>0];if(t>=128)hasUtf=true;else if(t==0&&!length)break;i++;if(length&&i==length)break}if(!length)length=i;var ret="";if(!hasUtf){var MAX_CHUNK=1024;var curr;while(length>0){curr=String.fromCharCode.apply(String,HEAPU8.subarray(ptr,ptr+Math.min(length,MAX_CHUNK)));ret=ret?ret+curr:curr;ptr+=MAX_CHUNK;length-=MAX_CHUNK}return ret}var utf8=new Runtime.UTF8Processor;for(i=0;i<length;i++){t=HEAPU8[ptr+i>>0];ret+=utf8.processCChar(t)}return ret}Module["Pointer_stringify"]=Pointer_stringify;function UTF16ToString(ptr){var i=0;var str="";while(1){var codeUnit=HEAP16[ptr+i*2>>1];if(codeUnit==0)return str;++i;str+=String.fromCharCode(codeUnit)}}Module["UTF16ToString"]=UTF16ToString;function stringToUTF16(str,outPtr){for(var i=0;i<str.length;++i){var codeUnit=str.charCodeAt(i);HEAP16[outPtr+i*2>>1]=codeUnit}HEAP16[outPtr+str.length*2>>1]=0}Module["stringToUTF16"]=stringToUTF16;function UTF32ToString(ptr){var i=0;var str="";while(1){var utf32=HEAP32[ptr+i*4>>2];if(utf32==0)return str;++i;if(utf32>=65536){var ch=utf32-65536;str+=String.fromCharCode(55296|ch>>10,56320|ch&1023)}else{str+=String.fromCharCode(utf32)}}}Module["UTF32ToString"]=UTF32ToString;function stringToUTF32(str,outPtr){var iChar=0;for(var iCodeUnit=0;iCodeUnit<str.length;++iCodeUnit){var codeUnit=str.charCodeAt(iCodeUnit);if(codeUnit>=55296&&codeUnit<=57343){var trailSurrogate=str.charCodeAt(++iCodeUnit);codeUnit=65536+((codeUnit&1023)<<10)|trailSurrogate&1023}HEAP32[outPtr+iChar*4>>2]=codeUnit;++iChar}HEAP32[outPtr+iChar*4>>2]=0}Module["stringToUTF32"]=stringToUTF32;function demangle(func){var hasLibcxxabi=!!Module["___cxa_demangle"];if(hasLibcxxabi){try{var buf=_malloc(func.length);writeStringToMemory(func.substr(1),buf);var status=_malloc(4);var ret=Module["___cxa_demangle"](buf,0,0,status);if(getValue(status,"i32")===0&&ret){return Pointer_stringify(ret)}}catch(e){}finally{if(buf)_free(buf);if(status)_free(status);if(ret)_free(ret)}}var i=3;var basicTypes={"v":"void","b":"bool","c":"char","s":"short","i":"int","l":"long","f":"float","d":"double","w":"wchar_t","a":"signed char","h":"unsigned char","t":"unsigned short","j":"unsigned int","m":"unsigned long","x":"long long","y":"unsigned long long","z":"..."};var subs=[];var first=true;function dump(x){if(x)Module.print(x);Module.print(func);var pre="";for(var a=0;a<i;a++)pre+=" ";Module.print(pre+"^")}function parseNested(){i++;if(func[i]==="K")i++;var parts=[];while(func[i]!=="E"){if(func[i]==="S"){i++;var next=func.indexOf("_",i);var num=func.substring(i,next)||0;parts.push(subs[num]||"?");i=next+1;continue}if(func[i]==="C"){parts.push(parts[parts.length-1]);i+=2;continue}var size=parseInt(func.substr(i));var pre=size.toString().length;if(!size||!pre){i--;break}var curr=func.substr(i+pre,size);parts.push(curr);subs.push(curr);i+=pre+size}i++;return parts}function parse(rawList,limit,allowVoid){limit=limit||Infinity;var ret="",list=[];function flushList(){return"("+list.join(", ")+")"}var name;if(func[i]==="N"){name=parseNested().join("::");limit--;if(limit===0)return rawList?[name]:name}else{if(func[i]==="K"||first&&func[i]==="L")i++;var size=parseInt(func.substr(i));if(size){var pre=size.toString().length;name=func.substr(i+pre,size);i+=pre+size}}first=false;if(func[i]==="I"){i++;var iList=parse(true);var iRet=parse(true,1,true);ret+=iRet[0]+" "+name+"<"+iList.join(", ")+">"}else{ret=name}paramLoop:while(i<func.length&&limit-->0){var c=func[i++];if(c in basicTypes){list.push(basicTypes[c])}else{switch(c){case"P":list.push(parse(true,1,true)[0]+"*");break;case"R":list.push(parse(true,1,true)[0]+"&");break;case"L":{i++;var end=func.indexOf("E",i);var size=end-i;list.push(func.substr(i,size));i+=size+2;break};case"A":{var size=parseInt(func.substr(i));i+=size.toString().length;if(func[i]!=="_")throw"?";i++;list.push(parse(true,1,true)[0]+" ["+size+"]");break};case"E":break paramLoop;default:ret+="?"+c;break paramLoop}}}if(!allowVoid&&list.length===1&&list[0]==="void")list=[];if(rawList){if(ret){list.push(ret+"?")}return list}else{return ret+flushList()}}var final=func;try{if(func=="Object._main"||func=="_main"){return"main()"}if(typeof func==="number")func=Pointer_stringify(func);if(func[0]!=="_")return func;if(func[1]!=="_")return func;if(func[2]!=="Z")return func;switch(func[3]){case"n":return"operator new()";case"d":return"operator delete()"}final=parse()}catch(e){final+="?"}if(final.indexOf("?")>=0&&!hasLibcxxabi){Runtime.warnOnce("warning: a problem occurred in builtin C++ name demangling; build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling")}return final}function demangleAll(text){return text.replace(/__Z[\w\d_]+/g,(function(x){var y=demangle(x);return x===y?x:x+" ["+y+"]"}))}function jsStackTrace(){var err=new Error;if(!err.stack){try{throw new Error(0)}catch(e){err=e}if(!err.stack){return"(no stack trace available)"}}return err.stack.toString()}function stackTrace(){return demangleAll(jsStackTrace())}Module["stackTrace"]=stackTrace;var PAGE_SIZE=4096;function alignMemoryPage(x){return x+4095&-4096}var HEAP;var HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;var STATIC_BASE=0,STATICTOP=0,staticSealed=false;var STACK_BASE=0,STACKTOP=0,STACK_MAX=0;var DYNAMIC_BASE=0,DYNAMICTOP=0;function enlargeMemory(){abort("Cannot enlarge memory arrays. Either (1) compile with -s TOTAL_MEMORY=X with X higher than the current value "+TOTAL_MEMORY+", (2) compile with ALLOW_MEMORY_GROWTH which adjusts the size at runtime but prevents some optimizations, or (3) set Module.TOTAL_MEMORY before the program runs.")}var TOTAL_STACK=Module["TOTAL_STACK"]||5242880;var TOTAL_MEMORY=Module["TOTAL_MEMORY"]||67108864;var FAST_MEMORY=Module["FAST_MEMORY"]||2097152;var totalMemory=64*1024;while(totalMemory<TOTAL_MEMORY||totalMemory<2*TOTAL_STACK){if(totalMemory<16*1024*1024){totalMemory*=2}else{totalMemory+=16*1024*1024}}if(totalMemory!==TOTAL_MEMORY){Module.printErr("increasing TOTAL_MEMORY to "+totalMemory+" to be compliant with the asm.js spec");TOTAL_MEMORY=totalMemory}assert(typeof Int32Array!=="undefined"&&typeof Float64Array!=="undefined"&&!!(new Int32Array(1))["subarray"]&&!!(new Int32Array(1))["set"],"JS engine does not provide full typed array support");var buffer=new ArrayBuffer(TOTAL_MEMORY);HEAP8=new Int8Array(buffer);HEAP16=new Int16Array(buffer);HEAP32=new Int32Array(buffer);HEAPU8=new Uint8Array(buffer);HEAPU16=new Uint16Array(buffer);HEAPU32=new Uint32Array(buffer);HEAPF32=new Float32Array(buffer);HEAPF64=new Float64Array(buffer);HEAP32[0]=255;assert(HEAPU8[0]===255&&HEAPU8[3]===0,"Typed arrays 2 must be run on a little-endian system");Module["HEAP"]=HEAP;Module["buffer"]=buffer;Module["HEAP8"]=HEAP8;Module["HEAP16"]=HEAP16;Module["HEAP32"]=HEAP32;Module["HEAPU8"]=HEAPU8;Module["HEAPU16"]=HEAPU16;Module["HEAPU32"]=HEAPU32;Module["HEAPF32"]=HEAPF32;Module["HEAPF64"]=HEAPF64;function callRuntimeCallbacks(callbacks){while(callbacks.length>0){var callback=callbacks.shift();if(typeof callback=="function"){callback();continue}var func=callback.func;if(typeof func==="number"){if(callback.arg===undefined){Runtime.dynCall("v",func)}else{Runtime.dynCall("vi",func,[callback.arg])}}else{func(callback.arg===undefined?null:callback.arg)}}}var __ATPRERUN__=[];var __ATINIT__=[];var __ATMAIN__=[];var __ATEXIT__=[];var __ATPOSTRUN__=[];var runtimeInitialized=false;var runtimeExited=false;function preRun(){if(Module["preRun"]){if(typeof Module["preRun"]=="function")Module["preRun"]=[Module["preRun"]];while(Module["preRun"].length){addOnPreRun(Module["preRun"].shift())}}callRuntimeCallbacks(__ATPRERUN__)}function ensureInitRuntime(){if(runtimeInitialized)return;runtimeInitialized=true;callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function exitRuntime(){callRuntimeCallbacks(__ATEXIT__);runtimeExited=true}function postRun(){if(Module["postRun"]){if(typeof Module["postRun"]=="function")Module["postRun"]=[Module["postRun"]];while(Module["postRun"].length){addOnPostRun(Module["postRun"].shift())}}callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(cb){__ATPRERUN__.unshift(cb)}Module["addOnPreRun"]=Module.addOnPreRun=addOnPreRun;function addOnInit(cb){__ATINIT__.unshift(cb)}Module["addOnInit"]=Module.addOnInit=addOnInit;function addOnPreMain(cb){__ATMAIN__.unshift(cb)}Module["addOnPreMain"]=Module.addOnPreMain=addOnPreMain;function addOnExit(cb){__ATEXIT__.unshift(cb)}Module["addOnExit"]=Module.addOnExit=addOnExit;function addOnPostRun(cb){__ATPOSTRUN__.unshift(cb)}Module["addOnPostRun"]=Module.addOnPostRun=addOnPostRun;function intArrayFromString(stringy,dontAddNull,length){var ret=(new Runtime.UTF8Processor).processJSString(stringy);if(length){ret.length=length}if(!dontAddNull){ret.push(0)}return ret}Module["intArrayFromString"]=intArrayFromString;function intArrayToString(array){var ret=[];for(var i=0;i<array.length;i++){var chr=array[i];if(chr>255){chr&=255}ret.push(String.fromCharCode(chr))}return ret.join("")}Module["intArrayToString"]=intArrayToString;function writeStringToMemory(string,buffer,dontAddNull){var array=intArrayFromString(string,dontAddNull);var i=0;while(i<array.length){var chr=array[i];HEAP8[buffer+i>>0]=chr;i=i+1}}Module["writeStringToMemory"]=writeStringToMemory;function writeArrayToMemory(array,buffer){for(var i=0;i<array.length;i++){HEAP8[buffer+i>>0]=array[i]}}Module["writeArrayToMemory"]=writeArrayToMemory;function writeAsciiToMemory(str,buffer,dontAddNull){for(var i=0;i<str.length;i++){HEAP8[buffer+i>>0]=str.charCodeAt(i)}if(!dontAddNull)HEAP8[buffer+str.length>>0]=0}Module["writeAsciiToMemory"]=writeAsciiToMemory;function unSign(value,bits,ignore){if(value>=0){return value}return bits<=32?2*Math.abs(1<<bits-1)+value:Math.pow(2,bits)+value}function reSign(value,bits,ignore){if(value<=0){return value}var half=bits<=32?Math.abs(1<<bits-1):Math.pow(2,bits-1);if(value>=half&&(bits<=32||value>half)){value=-2*half+value}return value}if(!Math["imul"]||Math["imul"](4294967295,5)!==-5)Math["imul"]=function imul(a,b){var ah=a>>>16;var al=a&65535;var bh=b>>>16;var bl=b&65535;return al*bl+(ah*bl+al*bh<<16)|0};Math.imul=Math["imul"];var Math_abs=Math.abs;var Math_cos=Math.cos;var Math_sin=Math.sin;var Math_tan=Math.tan;var Math_acos=Math.acos;var Math_asin=Math.asin;var Math_atan=Math.atan;var Math_atan2=Math.atan2;var Math_exp=Math.exp;var Math_log=Math.log;var Math_sqrt=Math.sqrt;var Math_ceil=Math.ceil;var Math_floor=Math.floor;var Math_pow=Math.pow;var Math_imul=Math.imul;var Math_fround=Math.fround;var Math_min=Math.min;var runDependencies=0;var runDependencyWatcher=null;var dependenciesFulfilled=null;function addRunDependency(id){runDependencies++;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}}Module["addRunDependency"]=addRunDependency;function removeRunDependency(id){runDependencies--;if(Module["monitorRunDependencies"]){Module["monitorRunDependencies"](runDependencies)}if(runDependencies==0){if(runDependencyWatcher!==null){clearInterval(runDependencyWatcher);runDependencyWatcher=null}if(dependenciesFulfilled){var callback=dependenciesFulfilled;dependenciesFulfilled=null;callback()}}}Module["removeRunDependency"]=removeRunDependency;Module["preloadedImages"]={};Module["preloadedAudios"]={};var memoryInitializer=null;STATIC_BASE=8;STATICTOP=STATIC_BASE+21648;__ATINIT__.push({func:(function(){__GLOBAL__I_a()})});allocate([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,160,0,0,0,1,0,0,0,2,0,0,0,3,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,49,55,98,116,84,121,112,101,100,67,111,110,115,116,114,97,105,110,116,0,0,0,0,0,49,51,98,116,84,121,112,101,100,79,98,106,101,99,116,0,184,81,0,0,136,0,0,0,64,82,0,0,112,0,0,0,0,0,0,0,1,0,0,0,152,0,0,0,2,4,0,0,0,0,0,0,24,1,0,0,4,0,0,0,5,0,0,0,2,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,49,57,98,116,71,104,111,115,116,80,97,105,114,67,97,108,108,98,97,99,107,0,0,0,50,53,98,116,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,108,108,98,97,99,107,0,0,0,0,0,184,81,0,0,240,0,0,0,224,81,0,0,216,0,0,0,16,1,0,0,0,0,0,0,49,56,98,116,86,101,104,105,99,108,101,82,97,121,99,97,115,116,101,114,0,0,0,0,184,81,0,0,40,1,0,0,0,0,0,0,192,1,0,0,6,0,0,0,7,0,0,0,1,0,0,0,1,0,0,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,52,67,108,111,115,101,115,116,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,184,81,0,0,144,1,0,0,224,81,0,0,96,1,0,0,184,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,152,2,0,0,8,0,0,0,9,0,0,0,1,0,0,0,2,0,0,0,50,48,98,116,68,101,102,97,117,108,116,77,111,116,105,111,110,83,116,97,116,101,0,0,49,51,98,116,77,111,116,105,111,110,83,116,97,116,101,0,184,81,0,0,128,2,0,0,224,81,0,0,104,2,0,0,144,2,0,0,0,0,0,0,0,0,0,0,48,3,0,0,10,0,0,0,11,0,0,0,2,0,0,0,2,0,0,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,55,67,108,111,115,101,115,116,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,0,0,0,0,0,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,0,0,0,0,0,184,81,0,0,248,2,0,0,224,81,0,0,192,2,0,0,40,3,0,0,0,0,0,0,0,0,0,0,176,3,0,0,12,0,0,0,13,0,0,0,3,0,0,0,1,0,0,0,50,57,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,0,0,0,0,0,184,81,0,0,120,3,0,0,224,81,0,0,88,3,0,0,168,3,0,0,0,0,0,0,123,32,118,97,114,32,115,101,108,102,32,61,32,77,111,100,117,108,101,91,39,103,101,116,67,97,99,104,101,39,93,40,77,111,100,117,108,101,91,39,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,39,93,41,91,36,48,93,59,32,105,102,32,40,33,115,101,108,102,46,104,97,115,79,119,110,80,114,111,112,101,114,116,121,40,39,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,39,41,41,32,116,104,114,111,119,32,39,97,32,74,83,73,109,112,108,101,109,101,110,116,97,116,105,111,110,32,109,117,115,116,32,105,109,112,108,101,109,101,110,116,32,97,108,108,32,102,117,110,99,116,105,111,110,115,44,32,121,111,117,32,102,111,114,103,111,116,32,67,111,110,99,114,101,116,101,67,111,110,116,97,99,116,82,101,115,117,108,116,67,97,108,108,98,97,99,107,58,58,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,46,39,59,32,114,101,116,117,114,110,32,115,101,108,102,46,97,100,100,83,105,110,103,108,101,82,101,115,117,108,116,40,36,49,44,36,50,44,36,51,44,36,52,44,36,53,44,36,54,44,36,55,41,59,32,125,0,0,0,0,0,0,0,0,56,5,0,0,14,0,0,0,15,0,0,0,16,0,0,0,1,0,0,0,3,0,0,0,4,0,0,0,2,0,0,0,1,0,0,0,3,0,0,0,2,0,0,0,3,0,0,0,2,0,0,0,50,49,98,116,67,111,110,101,84,119,105,115,116,67,111,110,115,116,114,97,105,110,116,0,224,81,0,0,32,5,0,0,160,0,0,0,0,0,0,0,98,116,67,111,110,101,84,119,105,115,116,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,0,0,0,0,0,0,0,0,0,0,48,8,0,0,17,0,0,0,18,0,0,0,19,0,0,0,20,0,0,0,5,0,0,0,3,0,0,0,21,0,0,0,1,0,0,0,2,0,0,0,3,0,0,0,6,0,0,0,22,0,0,0,7,0,0,0,1,0,0,0,3,0,0,0,8,0,0,0,9,0,0,0,10,0,0,0,11,0,0,0,12,0,0,0,23,0,0,0,13,0,0,0,4,0,0,0,14,0,0,0,15,0,0,0,4,0,0,0,5,0,0,0,4,0,0,0,5,0,0,0,6,0,0,0,24,0,0,0,16,0,0,0,17,0,0,0,18,0,0,0,19,0,0,0,1,0,0,0,2,0,0,0,25,0,0,0,20,0,0,0,3,0,0,0,4,0,0,0,5,0,0,0,26,0,0,0,21,0,0,0,6,0,0,0,0,0,0,0,100,101,98,117,103,68,114,97,119,87,111,114,108,100,0,0,115,121,110,99,104,114,111,110,105,122,101,77,111,116,105,111,110,83,116,97,116,101,115,0,115,116,101,112,83,105,109,117,108,97,116,105,111,110,0,0,105,110,116,101,114,110,97,108,83,105,110,103,108,101,83,116,101,112,83,105,109,117,108,97,116,105,111,110,0,0,0,0,117,112,100,97,116,101,65,99,116,105,111,110,115,0,0,0,117,112,100,97,116,101,65,99,116,105,118,97,116,105,111,110,83,116,97,116,101,0,0,0,115,111,108,118,101,67,111,110,115,116,114,97,105,110,116,115,0,0,0,0,0,0,0,0,99,97,108,99,117,108,97,116,101,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,99,114,101,97,116,101,80,114,101,100,105,99,116,105,118,101,67,111,110,116,97,99,116,115,0,0,0,0,0,0,0,0,114,101,108,101,97,115,101,32,112,114,101,100,105,99,116,105,118,101,32,99,111,110,116,97,99,116,32,109,97,110,105,102,111,108,100,115,0,0,0,0,112,114,101,100,105,99,116,105,118,101,32,99,111,110,118,101,120,83,119,101,101,112,84,101,115,116,0,0,0,0,0,0,105,110,116,101,103,114,97,116,101,84,114,97,110,115,102,111,114,109,115,0,0,0,0,0,67,67,68,32,109,111,116,105,111,110,32,99,108,97,109,112,105,110,103,0,0,0,0,0,97,112,112,108,121,32,115,112,101,99,117,108,97,116,105,118,101,32,99,111,110,116,97,99,116,32,114,101,115,116,105,116,117,116,105,111,110,0,0,0,112,114,101,100,105,99,116,85,110,99,111,110,115,116,114,97,105,110,116,77,111,116,105,111,110,0,0,0,0,0,0,0,98,116,68,121,110,97,109,105,99,115,87,111,114,108,100,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,0,0,50,51,98,116,68,105,115,99,114,101,116,101,68,121,110,97,109,105,99,115,87,111,114,108,100,0,0,0,0,0,0,0,49,53,98,116,68,121,110,97,109,105,99,115,87,111,114,108,100,0,0,0,0,0,0,0,224,81,0,0,8,8,0,0,184,29,0,0,0,0,0,0,224,81,0,0,232,7,0,0,32,8,0,0,0,0,0,0,98,116,67,111,110,118,101,120,73,110,116,101,114,110,97,108,83,104,97,112,101,68,97,116,97,0,0,0,0,0,0,0,83,80,72,69,82,69,0,0,0,0,0,0,168,8,0,0,27,0,0,0,28,0,0,0,6,0,0,0,4,0,0,0,51,52,98,116,67,108,111,115,101,115,116,78,111,116,77,101,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,0,0,0,224,81,0,0,128,8,0,0,48,3,0,0,0,0,0,0,0,0,0,0,40,9,0,0,29,0,0,0,30,0,0,0,1,0,0,0,0,0,0,0,50,55,73,110,112,108,97,99,101,83,111,108,118,101,114,73,115,108,97,110,100,67,97,108,108,98,97,99,107,0,0,0,78,50,53,98,116,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,77,97,110,97,103,101,114,49,52,73,115,108,97,110,100,67,97,108,108,98,97,99,107,69,0,0,0,184,81,0,0,240,8,0,0,224,81,0,0,208,8,0,0,32,9,0,0,0,0,0,0,0,0,0,0,144,9,0,0,31,0,0,0,32,0,0,0,33,0,0,0,1,0,0,0,22,0,0,0,23,0,0,0,1,0,0,0,2,0,0,0,5,0,0,0,7,0,0,0,4,0,0,0,34,0,0,0,50,51,98,116,71,101,110,101,114,105,99,54,68,111,102,67,111,110,115,116,114,97,105,110,116,0,0,0,0,0,0,0,224,81,0,0,112,9,0,0,160,0,0,0,0,0,0,0,98,116,71,101,110,101,114,105,99,54,68,111,102,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,0,0,0,0,0,0,0,0,16,10,0,0,35,0,0,0,36,0,0,0,37,0,0,0,1,0,0,0,24,0,0,0,25,0,0,0,1,0,0,0,3,0,0,0,6,0,0,0,8,0,0,0,5,0,0,0,0,0,0,0,49,55,98,116,72,105,110,103,101,67,111,110,115,116,114,97,105,110,116,0,0,0,0,0,224,81,0,0,248,9,0,0,160,0,0,0,0,0,0,0,98,116,72,105,110,103,101,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,0,0,0,0,56,11,0,0,38,0,0,0,39,0,0,0,1,0,0,0,26,0,0,0,27,0,0,0,2,0,0,0,28,0,0,0,29,0,0,0,30,0,0,0,3,0,0,0,9,0,0,0,40,0,0,0,10,0,0,0,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,51,48,98,116,75,105,110,101,109,97,116,105,99,67,104,97,114,97,99,116,101,114,67,111,110,116,114,111,108,108,101,114,0,0,0,0,0,0,0,0,51,48,98,116,67,104,97,114,97,99,116,101,114,67,111,110,116,114,111,108,108,101,114,73,110,116,101,114,102,97,99,101,0,0,0,0,0,0,0,0,49,55,98,116,65,99,116,105,111,110,73,110,116,101,114,102,97,99,101,0,0,0,0,0,184,81,0,0,8,11,0,0,224,81,0,0,224,10,0,0,32,11,0,0,0,0,0,0,224,81,0,0,184,10,0,0,40,11,0,0,0,0,0,0,0,0,0,0,144,11,0,0,41,0,0,0,42,0,0,0,2,0,0,0,7,0,0,0,52,51,98,116,75,105,110,101,109,97,116,105,99,67,108,111,115,101,115,116,78,111,116,77,101,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,0,0,0,224,81,0,0,96,11,0,0,48,3,0,0,0,0,0,0,0,0,0,0,248,11,0,0,43,0,0,0,44,0,0,0,45,0,0,0,1,0,0,0,32,0,0,0,33,0,0,0,1,0,0,0,4,0,0,0,8,0,0,0,11,0,0,0,6,0,0,0,0,0,0,0,50,51,98,116,80,111,105,110,116,50,80,111,105,110,116,67,111,110,115,116,114,97,105,110,116,0,0,0,0,0,0,0,224,81,0,0,216,11,0,0,160,0,0,0,0,0,0,0,98,116,80,111,105,110,116,50,80,111,105,110,116,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,224,14,0,0,46,0,0,0,47,0,0,0,4,0,0,0,34,0,0,0,7,0,0,0,8,0,0,0,5,0,0,0,0,0,0,0,49,54,98,116,82,97,121,99,97,115,116,86,101,104,105,99,108,101,0,0,0,0,0,0,224,81,0,0,200,14,0,0,32,11,0,0,0,0,0,0,0,0,0,0,40,15,0,0,48,0,0,0,49,0,0,0,2,0,0,0,0,0,0,0,50,53,98,116,68,101,102,97,117,108,116,86,101,104,105,99,108,101,82,97,121,99,97,115,116,101,114,0,0,0,0,0,224,81,0,0,8,15,0,0,64,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,152,15,0,0,7,0,0,0,50,0,0,0,51,0,0,0,35,0,0,0,12,0,0,0,7,0,0,0,36,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,98,116,82,105,103,105,100,66,111,100,121,70,108,111,97,116,68,97,116,97,0,0,0,0,49,49,98,116,82,105,103,105,100,66,111,100,121,0,0,0,224,81,0,0,136,15,0,0,160,27,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,144,16,0,0,52,0,0,0,53,0,0,0,4,0,0,0,1,0,0,0,5,0,0,0,54,0,0,0,13,0,0,0,6,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,115,111,108,118,101,71,114,111,117,112,67,97,99,104,101,70,114,105,101,110,100,108,121,83,101,116,117,112,0,0,0,0,115,111,108,118,101,71,114,111,117,112,67,97,99,104,101,70,114,105,101,110,100,108,121,73,116,101,114,97,116,105,111,110,115,0,0,0,0,0,0,0,115,111,108,118,101,71,114,111,117,112,0,0,0,0,0,0,51,53,98,116,83,101,113,117,101,110,116,105,97,108,73,109,112,117,108,115,101,67,111,110,115,116,114,97,105,110,116,83,111,108,118,101,114,0,0,0,49,56,98,116,67,111,110,115,116,114,97,105,110,116,83,111,108,118,101,114,0,0,0,0,184,81,0,0,112,16,0,0,224,81,0,0,72,16,0,0,136,16,0,0,0,0,0,0,0,0,0,0,240,16,0,0,55,0,0,0,56,0,0,0,3,0,0,0,1,0,0,0,37,0,0,0,38,0,0,0,1,0,0,0,5,0,0,0,9,0,0,0,14,0,0,0,8,0,0,0,0,0,0,0,49,56,98,116,83,108,105,100,101,114,67,111,110,115,116,114,97,105,110,116,0,0,0,0,224,81,0,0,216,16,0,0,160,0,0,0,0,0,0,0,98,116,83,108,105,100,101,114,67,111,110,115,116,114,97,105,110,116,68,97,116,97,0,0,98,116,84,121,112,101,100,67,111,110,115,116,114,97,105,110,116,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,72,20,0,0,57,0,0,0,58,0,0,0,1,0,0,0,6,0,0,0,1,0,0,0,7,0,0,0,2,0,0,0,8,0,0,0,39,0,0,0,15,0,0,0,16,0,0,0,7,0,0,0,40,0,0,0,59,0,0,0,49,50,98,116,65,120,105,115,83,119,101,101,112,51,0,0,50,48,98,116,65,120,105,115,83,119,101,101,112,51,73,110,116,101,114,110,97,108,73,116,69,0,0,0,0,0,0,0,50,49,98,116,66,114,111,97,100,112,104,97,115,101,73,110,116,101,114,102,97,99,101,0,184,81,0,0,24,20,0,0,224,81,0,0,248,19,0,0,48,20,0,0,0,0,0,0,224,81,0,0,232,19,0,0,56,20,0,0,0,0,0,0,0,0,0,0,56,20,0,0,60,0,0,0,61,0,0,0,1,0,0,0,6,0,0,0,1,0,0,0,7,0,0,0,2,0,0,0,8,0,0,0,39,0,0,0,15,0,0,0,16,0,0,0,7,0,0,0,40,0,0,0,59,0,0,0,0,0,0,0,48,21,0,0,62,0,0,0,63,0,0,0,9,0,0,0,3,0,0,0,8,0,0,0,17,0,0,0,18,0,0,0,19,0,0,0,9,0,0,0,20,0,0,0,10,0,0,0,41,0,0,0,11,0,0,0,10,0,0,0,21,0,0,0,42,0,0,0,43,0,0,0,0,0,0,0,49,53,98,116,78,117,108,108,80,97,105,114,67,97,99,104,101,0,0,0,0,0,0,0,50,50,98,116,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,0,0,0,0,0,0,0,0,224,81,0,0,0,21,0,0,16,1,0,0,0,0,0,0,224,81,0,0,232,20,0,0,32,21,0,0,0,0,0,0,0,0,0,0,216,21,0,0,64,0,0,0,65,0,0,0,9,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,44,0,0,0,22,0,0,0,1,0,0,0,23,0,0,0,45,0,0,0,9,0,0,0,2,0,0,0,24,0,0,0,11,0,0,0,46,0,0,0,13,0,0,0,14,0,0,0,2,0,0,0,10,0,0,0,11,0,0,0,25,0,0,0,15,0,0,0,8,0,0,0,26,0,0,0,27,0,0,0,12,0,0,0,16,0,0,0,28,0,0,0,13,0,0,0,1,0,0,0,17,0,0,0,49,48,98,116,66,111,120,83,104,97,112,101,0,0,0,0,224,81,0,0,200,21,0,0,128,62,0,0,0,0,0,0,66,111,120,0,0,0,0,0,0,0,0,0,136,22,0,0,66,0,0,0,67,0,0,0,14,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,47,0,0,0,29,0,0,0,2,0,0,0,30,0,0,0,45,0,0,0,10,0,0,0,3,0,0,0,31,0,0,0,12,0,0,0,46,0,0,0,15,0,0,0,18,0,0,0,19,0,0,0,48,0,0,0,49,0,0,0,0,0,0,0,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,68,97,116,97,0,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,0,0,0,0,0,0,0,224,81,0,0,104,22,0,0,112,68,0,0,0,0,0,0,66,86,72,84,82,73,65,78,71,76,69,77,69,83,72,0,0,0,0,0,80,23,0,0,68,0,0,0,69,0,0,0,20,0,0,0,0,0,0,0,90,78,75,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,57,112,114,111,99,101,115,115,65,108,108,84,114,105,97,110,103,108,101,115,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,0,0,50,49,98,116,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,184,81,0,0,48,23,0,0,224,81,0,0,192,22,0,0,72,23,0,0,0,0,0,0,0,0,0,0,240,23,0,0,70,0,0,0,71,0,0,0,21,0,0,0,0,0,0,0,90,78,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,55,112,101,114,102,111,114,109,67,111,110,118,101,120,99,97,115,116,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,83,52,95,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,0,224,81,0,0,120,23,0,0,72,23,0,0,0,0,0,0,0,0,0,0,128,24,0,0,72,0,0,0,73,0,0,0,22,0,0,0,0,0,0,0,90,78,50,50,98,116,66,118,104,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,52,112,101,114,102,111,114,109,82,97,121,99,97,115,116,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,49,77,121,78,111,100,101,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,224,81,0,0,24,24,0,0,72,23,0,0,0,0,0,0,0,0,0,0,224,25,0,0,74,0,0,0,75,0,0,0,16,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,50,0,0,0,22,0,0,0,3,0,0,0,32,0,0,0,51,0,0,0,11,0,0,0,2,0,0,0,33,0,0,0,13,0,0,0,46,0,0,0,23,0,0,0,24,0,0,0,2,0,0,0,17,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,8,26,0,0,76,0,0,0,77,0,0,0,16,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,50,0,0,0,22,0,0,0,3,0,0,0,35,0,0,0,51,0,0,0,11,0,0,0,2,0,0,0,33,0,0,0,13,0,0,0,46,0,0,0,23,0,0,0,24,0,0,0,2,0,0,0,17,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,48,26,0,0,78,0,0,0,79,0,0,0,16,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,50,0,0,0,22,0,0,0,3,0,0,0,36,0,0,0,51,0,0,0,11,0,0,0,2,0,0,0,33,0,0,0,13,0,0,0,46,0,0,0,23,0,0,0,24,0,0,0,2,0,0,0,17,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,49,52,98,116,67,97,112,115,117,108,101,83,104,97,112,101,0,0,0,0,0,0,0,0,224,81,0,0,200,25,0,0,104,41,0,0,0,0,0,0,49,53,98,116,67,97,112,115,117,108,101,83,104,97,112,101,88,0,0,0,0,0,0,0,224,81,0,0,240,25,0,0,224,25,0,0,0,0,0,0,49,53,98,116,67,97,112,115,117,108,101,83,104,97,112,101,90,0,0,0,0,0,0,0,224,81,0,0,24,26,0,0,224,25,0,0,0,0,0,0,67,97,112,115,117,108,101,90,0,0,0,0,0,0,0,0,67,97,112,115,117,108,101,88,0,0,0,0,0,0,0,0,98,116,67,97,112,115,117,108,101,83,104,97,112,101,68,97,116,97,0,0,0,0,0,0,67,97,112,115,117,108,101,83,104,97,112,101,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,240,26,0,0,80,0,0,0,81,0,0,0,4,0,0,0,14,0,0,0,52,0,0,0,53,0,0,0,15,0,0,0,16,0,0,0,18,0,0,0,37,0,0,0,9,0,0,0,38,0,0,0,39,0,0,0,40,0,0,0,10,0,0,0,54,0,0,0,50,49,98,116,67,111,108,108,105,115,105,111,110,68,105,115,112,97,116,99,104,101,114,0,224,81,0,0,216,26,0,0,88,50,0,0,0,0,0,0,0,0,0,0,88,27,0,0,82,0,0,0,83,0,0,0,11,0,0,0,0,0,0,0,50,51,98,116,67,111,108,108,105,115,105,111,110,80,97,105,114,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,49,55,98,116,79,118,101,114,108,97,112,67,97,108,108,98,97,99,107,0,0,0,0,0,184,81,0,0,56,27,0,0,224,81,0,0,24,27,0,0,80,27,0,0,0,0,0,0,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,49,55,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,0,0,0,0,0,184,81,0,0,136,27,0,0,98,116,67,111,108,108,105,115,105,111,110,83,104,97,112,101,68,97,116,97,0,0,0,0,49,54,98,116,67,111,108,108,105,115,105,111,110,83,104,97,112,101,0,0,0,0,0,0,184,81,0,0,192,27,0,0,0,0,0,0,184,29,0,0,84,0,0,0,85,0,0,0,19,0,0,0,20,0,0,0,5,0,0,0,3,0,0,0,86,0,0,0,1,0,0,0,2,0,0,0,19,0,0,0,55,0,0,0,22,0,0,0,56,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,79,118,101,114,102,108,111,119,32,105,110,32,65,65,66,66,44,32,111,98,106,101,99,116,32,114,101,109,111,118,101,100,32,102,114,111,109,32,115,105,109,117,108,97,116,105,111,110,0,0,0,0,0,0,0,0,73,102,32,121,111,117,32,99,97,110,32,114,101,112,114,111,100,117,99,101,32,116,104,105,115,44,32,112,108,101,97,115,101,32,101,109,97,105,108,32,98,117,103,115,64,99,111,110,116,105,110,117,111,117,115,112,104,121,115,105,99,115,46,99,111,109,10,0,0,0,0,0,80,108,101,97,115,101,32,105,110,99,108,117,100,101,32,97,98,111,118,101,32,105,110,102,111,114,109,97,116,105,111,110,44,32,121,111,117,114,32,80,108,97,116,102,111,114,109,44,32,118,101,114,115,105,111,110,32,111,102,32,79,83,46,10,0,0,0,0,0,0,0,0,84,104,97,110,107,115,46,10,0,0,0,0,0,0,0,0,117,112,100,97,116,101,65,97,98,98,115,0,0,0,0,0,99,97,108,99,117,108,97,116,101,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,115,0,0,0,0,0,0,0,112,101,114,102,111,114,109,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,105,111,110,0,0,0,0,0,0,0,100,105,115,112,97,116,99,104,65,108,108,67,111,108,108,105,115,105,111,110,80,97,105,114,115,0,0,0,0,0,0,0,99,111,110,118,101,120,83,119,101,101,112,67,111,109,112,111,117,110,100,0,0,0,0,0,99,111,110,118,101,120,83,119,101,101,112,84,101,115,116,0,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,0,0,0,0,0,0,184,81,0,0,160,29,0,0,0,0,0,0,8,30,0,0,87,0,0,0,88,0,0,0,20,0,0,0,21,0,0,0,252,255,255,255,8,30,0,0,89,0,0,0,90,0,0,0,22,0,0,0,0,0,0,0,49,55,68,101,98,117,103,68,114,97,119,99,97,108,108,98,97,99,107,0,0,0,0,0,64,82,0,0,240,29,0,0,0,0,0,0,2,0,0,0,88,67,0,0,2,0,0,0,136,67,0,0,2,4,0,0,0,0,0,0,104,30,0,0,91,0,0,0,92,0,0,0,26,0,0,0,27,0,0,0,3,0,0,0,0,0,0,0,50,51,98,116,66,114,105,100,103,101,100,77,97,110,105,102,111,108,100,82,101,115,117,108,116,0,0,0,0,0,0,0,224,81,0,0,72,30,0,0,240,52,0,0,0,0,0,0,50,52,98,116,66,114,111,97,100,112,104,97,115,101,65,97,98,98,67,97,108,108,98,97,99,107,0,0,0,0,0,0,184,81,0,0,120,30,0,0,0,0,0,0,0,31,0,0,93,0,0,0,94,0,0,0,12,0,0,0,0,0,0,0,50,49,98,116,83,105,110,103,108,101,83,119,101,101,112,67,97,108,108,98,97,99,107,0,50,51,98,116,66,114,111,97,100,112,104,97,115,101,82,97,121,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,224,81,0,0,208,30,0,0,152,30,0,0,0,0,0,0,224,81,0,0,184,30,0,0,240,30,0,0,0,0,0,0,0,0,0,0,64,31,0,0,95,0,0,0,96,0,0,0,13,0,0,0,0,0,0,0,49,57,98,116,83,105,110,103,108,101,82,97,121,67,97,108,108,98,97,99,107,0,0,0,224,81,0,0,40,31,0,0,240,30,0,0,0,0,0,0,0,0,0,0,8,32,0,0,97,0,0,0,98,0,0,0,14,0,0,0,10,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,49,52,76,111,99,97,108,73,110,102,111,65,100,100,101,114,95,49,0,0,224,81,0,0,104,31,0,0,40,3,0,0,0,0,0,0,0,0,0,0,232,32,0,0,99,0,0,0,100,0,0,0,23,0,0,0,1,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,51,50,66,114,105,100,103,101,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,95,48,0,0,0,0,0,0,0,0,224,81,0,0,48,32,0,0,224,63,0,0,0,0,0,0,0,0,0,0,192,33,0,0,101,0,0,0,102,0,0,0,23,0,0,0,2,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,53,111,98,106,101,99,116,81,117,101,114,121,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,53,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,50,48,67,111,110,118,101,120,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,102,69,51,50,66,114,105,100,103,101,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,0,0,224,81,0,0,16,33,0,0,224,63,0,0,0,0,0,0,0,0,0,0,112,34,0,0,103,0,0,0,104,0,0,0,15,0,0,0,11,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,49,53,76,111,99,97,108,73,110,102,111,65,100,100,101,114,50,0,0,0,0,224,81,0,0,232,33,0,0,184,1,0,0,0,0,0,0,0,0,0,0,72,35,0,0,105,0,0,0,106,0,0,0,28,0,0,0,57,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,57,82,97,121,84,101,115,116,101,114,95,49,0,78,54,98,116,68,98,118,116,56,73,67,111,108,108,105,100,101,69,0,0,0,0,0,0,184,81,0,0,40,35,0,0,224,81,0,0,168,34,0,0,64,35,0,0,0,0,0,0,0,0,0,0,8,36,0,0,107,0,0,0,108,0,0,0,24,0,0,0,1,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,50,57,66,114,105,100,103,101,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,95,48,0,0,0,0,224,81,0,0,112,35,0,0,176,63,0,0,0,0,0,0,0,0,0,0,200,36,0,0,109,0,0,0,110,0,0,0,24,0,0,0,2,0,0,0,90,78,49,54,98,116,67,111,108,108,105,115,105,111,110,87,111,114,108,100,50,49,114,97,121,84,101,115,116,83,105,110,103,108,101,73,110,116,101,114,110,97,108,69,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,50,95,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,82,78,83,95,49,55,82,97,121,82,101,115,117,108,116,67,97,108,108,98,97,99,107,69,69,50,57,66,114,105,100,103,101,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,0,0,0,0,0,0,224,81,0,0,48,36,0,0,176,63,0,0,0,0,0,0,0,0,0,0,24,37,0,0,12,0,0,0,58,0,0,0,29,0,0,0,111,0,0,0,112,0,0,0,0,0,0,0,78,49,50,98,116,67,111,110,118,101,120,67,97,115,116,49,48,67,97,115,116,82,101,115,117,108,116,69,0,0,0,0,184,81,0,0,248,36,0,0,0,0,0,0,192,37,0,0,113,0,0,0,114,0,0,0,25,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,59,0,0,0,41,0,0,0,4,0,0,0,42,0,0,0,45,0,0,0,13,0,0,0,4,0,0,0,43,0,0,0,17,0,0,0,46,0,0,0,60,0,0,0,115,0,0,0,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,67,104,105,108,100,68,97,116,97,0,0,0,0,0,0,0,0,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,68,97,116,97,0,0,0,0,0,49,53,98,116,67,111,109,112,111,117,110,100,83,104,97,112,101,0,0,0,0,0,0,0,224,81,0,0,168,37,0,0,216,27,0,0,0,0,0,0,67,111,109,112,111,117,110,100,0,0,0,0,0,0,0,0,0,0,0,0,40,39,0,0,116,0,0,0,117,0,0,0,26,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,61,0,0,0,22,0,0,0,5,0,0,0,44,0,0,0,62,0,0,0,14,0,0,0,2,0,0,0,45,0,0,0,18,0,0,0,46,0,0,0,30,0,0,0,31,0,0,0,2,0,0,0,27,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,72,39,0,0,118,0,0,0,119,0,0,0,26,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,61,0,0,0,22,0,0,0,5,0,0,0,46,0,0,0,63,0,0,0,14,0,0,0,2,0,0,0,45,0,0,0,18,0,0,0,46,0,0,0,30,0,0,0,31,0,0,0,2,0,0,0,27,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,0,0,0,0,104,39,0,0,120,0,0,0,121,0,0,0,26,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,61,0,0,0,22,0,0,0,5,0,0,0,47,0,0,0,64,0,0,0,14,0,0,0,2,0,0,0,45,0,0,0,18,0,0,0,46,0,0,0,30,0,0,0,31,0,0,0,2,0,0,0,27,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,49,49,98,116,67,111,110,101,83,104,97,112,101,0,0,0,224,81,0,0,24,39,0,0,104,41,0,0,0,0,0,0,49,50,98,116,67,111,110,101,83,104,97,112,101,90,0,0,224,81,0,0,56,39,0,0,40,39,0,0,0,0,0,0,49,50,98,116,67,111,110,101,83,104,97,112,101,88,0,0,224,81,0,0,88,39,0,0,40,39,0,0,0,0,0,0,67,111,110,101,88,0,0,0,67,111,110,101,90,0,0,0,98,116,67,111,110,101,83,104,97,112,101,68,97,116,97,0,67,111,110,101,0,0,0,0,0,0,0,0,216,39,0,0,122,0,0,0,123,0,0,0,1,0,0,0,0,0,0,0,50,55,98,116,67,111,110,116,105,110,117,111,117,115,67,111,110,118,101,120,67,111,108,108,105,115,105,111,110,0,0,0,224,81,0,0,184,39,0,0,120,40,0,0,0,0,0,0,0,0,0,0,88,40,0,0,124,0,0,0,125,0,0,0,32,0,0,0,33,0,0,0,4],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE);allocate([49,54,98,116,80,111,105,110,116,67,111,108,108,101,99,116,111,114,0,0,0,0,0,0,78,51,54,98,116,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,111,114,73,110,116,101,114,102,97,99,101,54,82,101,115,117,108,116,69,0,184,81,0,0,32,40,0,0,224,81,0,0,8,40,0,0,80,40,0,0,0,0,0,0,49,50,98,116,67,111,110,118,101,120,67,97,115,116,0,0,184,81,0,0,104,40,0,0,0,0,0,0,56,41,0,0,126,0,0,0,127,0,0,0,28,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,65,0,0,0,22,0,0,0,6,0,0,0,48,0,0,0,45,0,0,0,14,0,0,0,2,0,0,0,49,0,0,0,19,0,0,0,46,0,0,0,34,0,0,0,35,0,0,0,2,0,0,0,29,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,8,0,0,0,50,0,0,0,51,0,0,0,30,0,0,0,36,0,0,0,52,0,0,0,31,0,0,0,2,0,0,0,1,0,0,0,98,116,67,111,110,118,101,120,72,117,108,108,83,104,97,112,101,68,97,116,97,0,0,0,49,55,98,116,67,111,110,118,101,120,72,117,108,108,83,104,97,112,101,0,0,0,0,0,224,81,0,0,32,41,0,0,184,62,0,0,0,0,0,0,67,111,110,118,101,120,0,0,50,49,98,116,67,111,110,118,101,120,73,110,116,101,114,110,97,108,83,104,97,112,101,0,224,81,0,0,80,41,0,0,136,41,0,0,0,0,0,0,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,0,224,81,0,0,120,41,0,0,216,27,0,0,0,0,0,0,0,0,0,0,64,42,0,0,128,0,0,0,129,0,0,0,28,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,66,0,0,0,53,0,0,0,6,0,0,0,54,0,0,0,45,0,0,0,14,0,0,0,2,0,0,0,24,0,0,0,11,0,0,0,46,0,0,0,37,0,0,0,38,0,0,0,2,0,0,0,32,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,8,0,0,0,55,0,0,0,56,0,0,0,33,0,0,0,39,0,0,0,57,0,0,0,34,0,0,0,3,0,0,0,0,0,0,0,50,53,98,116,67,111,110,118,101,120,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,0,0,0,0,224,81,0,0,32,42,0,0,184,62,0,0,0,0,0,0,67,111,110,118,101,120,84,114,105,109,101,115,104,0,0,0,0,0,0,0,152,42,0,0,130,0,0,0,131,0,0,0,35,0,0,0,0,0,0,0,50,54,76,111,99,97,108,83,117,112,112,111,114,116,86,101,114,116,101,120,67,97,108,108,98,97,99,107,0,0,0,0,224,81,0,0,120,42,0,0,136,67,0,0,0,0,0,0,0,0,0,0,248,43,0,0,132,0,0,0,133,0,0,0,36,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,67,0,0,0,22,0,0,0,7,0,0,0,58,0,0,0,68,0,0,0,15,0,0,0,2,0,0,0,59,0,0,0,20,0,0,0,46,0,0,0,40,0,0,0,41,0,0,0,2,0,0,0,37,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,5,0,0,0,0,0,0,0,32,44,0,0,134,0,0,0,135,0,0,0,36,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,67,0,0,0,22,0,0,0,7,0,0,0,60,0,0,0,68,0,0,0,15,0,0,0,2,0,0,0,59,0,0,0,20,0,0,0,46,0,0,0,40,0,0,0,42,0,0,0,2,0,0,0,38,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,6,0,0,0,0,0,0,0,72,44,0,0,136,0,0,0,137,0,0,0,36,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,67,0,0,0,22,0,0,0,7,0,0,0,61,0,0,0,68,0,0,0,15,0,0,0,2,0,0,0,59,0,0,0,20,0,0,0,46,0,0,0,40,0,0,0,43,0,0,0,2,0,0,0,39,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,7,0,0,0,49,53,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,0,0,0,0,0,0,0,224,81,0,0,224,43,0,0,104,41,0,0,0,0,0,0,49,54,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,88,0,0,0,0,0,0,224,81,0,0,8,44,0,0,248,43,0,0,0,0,0,0,49,54,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,90,0,0,0,0,0,0,224,81,0,0,48,44,0,0,248,43,0,0,0,0,0,0,67,121,108,105,110,100,101,114,90,0,0,0,0,0,0,0,67,121,108,105,110,100,101,114,88,0,0,0,0,0,0,0,98,116,67,121,108,105,110,100,101,114,83,104,97,112,101,68,97,116,97,0,0,0,0,0,67,121,108,105,110,100,101,114,89,0,0,0,0,0,0,0,0,0,0,0,248,44,0,0,138,0,0,0,139,0,0,0,2,0,0,0,44,0,0,0,3,0,0,0,40,0,0,0,3,0,0,0,41,0,0,0,69,0,0,0,62,0,0,0,63,0,0,0,45,0,0,0,70,0,0,0,140,0,0,0,49,54,98,116,68,98,118,116,66,114,111,97,100,112,104,97,115,101,0,0,0,0,0,0,224,81,0,0,224,44,0,0,48,20,0,0,0,0,0,0,0,0,0,0,72,45,0,0,141,0,0,0,142,0,0,0,28,0,0,0,71,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,50,48,66,114,111,97,100,112,104,97,115,101,65,97,98,98,84,101,115,116,101,114,0,0,224,81,0,0,48,45,0,0,64,35,0,0,0,0,0,0,0,0,0,0,152,45,0,0,143,0,0,0,144,0,0,0,28,0,0,0,72,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,49,57,66,114,111,97,100,112,104,97,115,101,82,97,121,84,101,115,116,101,114,0,0,0,224,81,0,0,128,45,0,0,64,35,0,0,0,0,0,0,0,0,0,0,232,45,0,0,145,0,0,0,146,0,0,0,46,0,0,0,73,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,49,56,98,116,68,98,118,116,84,114,101,101,67,111,108,108,105,100,101,114,0,0,0,0,224,81,0,0,208,45,0,0,64,35,0,0,0,0,0,0,0,0,0,0,104,46,0,0,147,0,0,0,148,0,0,0,64,0,0,0,65,0,0,0,21,0,0,0,66,0,0,0,51,49,98,116,68,101,102,97,117,108,116,67,111,108,108,105,115,105,111,110,67,111,110,102,105,103,117,114,97,116,105,111,110,0,0,0,0,0,0,0,50,52,98,116,67,111,108,108,105,115,105,111,110,67,111,110,102,105,103,117,114,97,116,105,111,110,0,0,0,0,0,0,184,81,0,0,64,46,0,0,224,81,0,0,24,46,0,0,96,46,0,0,0,0,0,0,0,0,0,0,240,46,0,0,149,0,0,0,150,0,0,0,5,0,0,0,0,0,0,0,78,51,49,98,116,67,111,110,118,101,120,80,108,97,110,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,51,48,98,116,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,67,114,101,97,116,101,70,117,110,99,0,0,0,0,0,0,0,0,184,81,0,0,192,46,0,0,224,81,0,0,144,46,0,0,232,46,0,0,0,0,0,0,0,0,0,0,72,47,0,0,151,0,0,0,152,0,0,0,6,0,0,0,0,0,0,0,78,50,54,98,116,66,111,120,66,111,120,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,224,81,0,0,24,47,0,0,232,46,0,0,0,0,0,0,0,0,0,0,168,47,0,0,153,0,0,0,154,0,0,0,7,0,0,0,0,0,0,0,78,51,52,98,116,83,112,104,101,114,101,84,114,105,97,110,103,108,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,224,81,0,0,112,47,0,0,232,46,0,0,0,0,0,0,0,0,0,0,8,48,0,0,155,0,0,0,156,0,0,0,8,0,0,0,0,0,0,0,78,51,50,98,116,83,112,104,101,114,101,83,112,104,101,114,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,0,0,224,81,0,0,208,47,0,0,232,46,0,0,0,0,0,0,0,0,0,0,88,48,0,0,157,0,0,0,158,0,0,0,9,0,0,0,0,0,0,0,78,49,54,98,116,69,109,112,116,121,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,0,0,224,81,0,0,48,48,0,0,232,46,0,0,0,0,0,0,0,0,0,0,184,48,0,0,159,0,0,0,160,0,0,0,10,0,0,0,0,0,0,0,78,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,55,83,119,97,112,112,101,100,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,224,81,0,0,128,48,0,0,232,46,0,0,0,0,0,0,0,0,0,0,24,49,0,0,161,0,0,0,162,0,0,0,11,0,0,0,0,0,0,0,78,51,54,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,224,81,0,0,224,48,0,0,232,46,0,0,0,0,0,0,0,0,0,0,112,49,0,0,163,0,0,0,164,0,0,0,12,0,0,0,0,0,0,0,78,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,224,81,0,0,64,49,0,0,232,46,0,0,0,0,0,0,0,0,0,0,216,49,0,0,165,0,0,0,166,0,0,0,13,0,0,0,0,0,0,0,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,55,83,119,97,112,112,101,100,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,0,0,224,81,0,0,152,49,0,0,232,46,0,0,0,0,0,0,0,0,0,0,56,50,0,0,167,0,0,0,168,0,0,0,14,0,0,0,0,0,0,0,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,0,0,0,0,0,0,224,81,0,0,0,50,0,0,232,46,0,0,0,0,0,0,49,50,98,116,68,105,115,112,97,116,99,104,101,114,0,0,184,81,0,0,72,50,0,0,0,0,0,0,184,50,0,0,169,0,0,0,170,0,0,0,4,0,0,0,1,0,0,0,74,0,0,0,0,0,0,0,49,54,98,116,69,109,112,116,121,65,108,103,111,114,105,116,104,109,0,0,0,0,0,0,50,48,98,116,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,184,81,0,0,152,50,0,0,224,81,0,0,128,50,0,0,176,50,0,0,0,0,0,0,0,0,0,0,56,51,0,0,18,0,0,0,171,0,0,0,172,0,0,0,35,0,0,0,67,0,0,0,22,0,0,0,75,0,0,0,47,0,0,0,42,0,0,0,0,0,0,0,0,0,0,0,104,51,0,0,18,0,0,0,173,0,0,0,174,0,0,0,35,0,0,0,67,0,0,0,22,0,0,0,75,0,0,0,48,0,0,0,43,0,0,0,0,0,0,0,49,51,98,116,71,104,111,115,116,79,98,106,101,99,116,0,224,81,0,0,40,51,0,0,160,27,0,0,0,0,0,0,50,52,98,116,80,97,105,114,67,97,99,104,105,110,103,71,104,111,115,116,79,98,106,101,99,116,0,0,0,0,0,0,224,81,0,0,72,51,0,0,56,51,0,0,0,0,0,0,0,0,0,0,168,51,0,0,175,0,0,0,176,0,0,0,2,0,0,0,0,0,0,0,49,53,98,116,71,106,107,67,111,110,118,101,120,67,97,115,116,0,0,0,0,0,0,0,224,81,0,0,144,51,0,0,120,40,0,0,0,0,0,0,0,0,0,0,40,52,0,0,177,0,0,0,178,0,0,0,1,0,0,0,0,0,0,0,51,48,98,116,71,106,107,69,112,97,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,0,0,0,0,0,0,0,51,48,98,116,67,111,110,118,101,120,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,0,0,0,0,0,0,0,184,81,0,0,248,51,0,0,224,81,0,0,208,51,0,0,32,52,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,168,52,0,0,179,0,0,0,180,0,0,0,5,0,0,0,0,0,0,0,49,55,98,116,71,106,107,80,97,105,114,68,101,116,101,99,116,111,114,0,0,0,0,0,51,54,98,116,68,105,115,99,114,101,116,101,67,111,108,108,105,115,105,111,110,68,101,116,101,99,116,111,114,73,110,116,101,114,102,97,99,101,0,0,184,81,0,0,120,52,0,0,224,81,0,0,96,52,0,0,160,52,0,0,0,0,0,0,0,0,0,0,240,52,0,0,181,0,0,0,182,0,0,0,26,0,0,0,27,0,0,0,5,0,0,0,0,0,0,0,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,0,0,0,0,0,0,224,81,0,0,216,52,0,0,80,40,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,40,57,0,0,183,0,0,0,184,0,0,0,2,0,0,0,0,0,0,0,51,51,98,116,77,105,110,107,111,119,115,107,105,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,0,0,0,0,0,224,81,0,0,0,57,0,0,32,52,0,0,0,0,0,0,0,0,0,0,8,58,0,0,185,0,0,0,186,0,0,0,49,0,0,0,50,0,0,0,6,0,0,0,0,0,0,0,90,78,51,51,98,116,77,105,110,107,111,119,115,107,105,80,101,110,101,116,114,97,116,105,111,110,68,101,112,116,104,83,111,108,118,101,114,49,50,99,97,108,99,80,101,110,68,101,112,116,104,69,82,50,50,98,116,86,111,114,111,110,111,105,83,105,109,112,108,101,120,83,111,108,118,101,114,80,75,49,51,98,116,67,111,110,118,101,120,83,104,97,112,101,83,52,95,82,75,49,49,98,116,84,114,97,110,115,102,111,114,109,83,55,95,82,57,98,116,86,101,99,116,111,114,51,83,57,95,83,57,95,80,49,50,98,116,73,68,101,98,117,103,68,114,97,119,69,50,48,98,116,73,110,116,101,114,109,101,100,105,97,116,101,82,101,115,117,108,116,0,0,0,0,0,0,224,81,0,0,88,57,0,0,80,40,0,0,0,0,0,0,0,0,0,0,88,58,0,0,187,0,0,0,188,0,0,0,15,0,0,0,68,0,0,0,23,0,0,0,76,0,0,0,77,0,0,0,16,0,0,0,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,0,0,0,0,0,0,0,0,224,81,0,0,64,58,0,0,112,63,0,0,0,0,0,0,0,0,0,0,224,58,0,0,189,0,0,0,190,0,0,0,44,0,0,0,0,0,0,0,90,78,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,53,98,117,105,108,100,69,80,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,98,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,48,78,111,100,101,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,95,48,0,0,0,0,224,81,0,0,128,58,0,0,136,67,0,0,0,0,0,0,0,0,0,0,112,59,0,0,191,0,0,0,192,0,0,0,45,0,0,0,0,0,0,0,90,78,49,52,98,116,79,112,116,105,109,105,122,101,100,66,118,104,53,98,117,105,108,100,69,80,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,98,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,50,57,81,117,97,110,116,105,122,101,100,78,111,100,101,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,0,0,0,0,224,81,0,0,8,59,0,0,136,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,60,0,0,193,0,0,0,194,0,0,0,24,0,0,0,17,0,0,0,51,0,0,0,69,0,0,0,70,0,0,0,71,0,0,0,52,0,0,0,72,0,0,0,53,0,0,0,78,0,0,0,54,0,0,0,25,0,0,0,73,0,0,0,79,0,0,0,80,0,0,0,0,0,0,0,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,0,0,224,81,0,0,240,59,0,0,32,21,0,0,0,0,0,0,0,0,0,0,192,60,0,0,195,0,0,0,196,0,0,0,19,0,0,0,0,0,0,0,90,78,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,51,55,114,101,109,111,118,101,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,115,67,111,110,116,97,105,110,105,110,103,80,114,111,120,121,69,80,49,55,98,116,66,114,111,97,100,112,104,97,115,101,80,114,111,120,121,80,49,50,98,116,68,105,115,112,97,116,99,104,101,114,69,49,56,82,101,109,111,118,101,80,97,105,114,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,0,224,81,0,0,56,60,0,0,80,27,0,0,0,0,0,0,0,0,0,0,88,61,0,0,197,0,0,0,198,0,0,0,20,0,0,0,0,0,0,0,90,78,50,56,98,116,72,97,115,104,101,100,79,118,101,114,108,97,112,112,105,110,103,80,97,105,114,67,97,99,104,101,49,57,99,108,101,97,110,80,114,111,120,121,70,114,111,109,80,97,105,114,115,69,80,49,55,98,116,66,114,111,97,100,112,104,97,115,101,80,114,111,120,121,80,49,50,98,116,68,105,115,112,97,116,99,104,101,114,69,49,55,67,108,101,97,110,80,97,105,114,67,97,108,108,98,97,99,107,0,0,0,224,81,0,0,232,60,0,0,80,27,0,0,0,0,0,0,10,215,163,60,0,0,0,0,0,0,0,0,128,62,0,0,199,0,0,0,200,0,0,0,26,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,81,0,0,0,22,0,0,0,6,0,0,0,1,0,0,0,45,0,0,0,14,0,0,0,2,0,0,0,24,0,0,0,11,0,0,0,46,0,0,0,23,0,0,0,55,0,0,0,2,0,0,0,46,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,8,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,50,51,98,116,80,111,108,121,104,101,100,114,97,108,67,111,110,118,101,120,83,104,97,112,101,0,0,0,0,0,0,0,224,81,0,0,96,62,0,0,104,41,0,0,0,0,0,0,51,52,98,116,80,111,108,121,104,101,100,114,97,108,67,111,110,118,101,120,65,97,98,98,67,97,99,104,105,110,103,83,104,97,112,101,0,0,0,0,224,81,0,0,144,62,0,0,128,62,0,0,0,0,0,0,0,0,0,0,112,63,0,0,201,0,0,0,202,0,0,0,15,0,0,0,68,0,0,0,23,0,0,0,76,0,0,0,77,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,98,116,79,112,116,105,109,105,122,101,100,66,118,104,78,111,100,101,68,97,116,97,0,0,98,116,81,117,97,110,116,105,122,101,100,66,118,104,78,111,100,101,68,97,116,97,0,0,98,116,66,118,104,83,117,98,116,114,101,101,73,110,102,111,68,97,116,97,0,0,0,0,98,116,81,117,97,110,116,105,122,101,100,66,118,104,70,108,111,97,116,68,97,116,97,0,49,52,98,116,81,117,97,110,116,105,122,101,100,66,118,104,0,0,0,0,0,0,0,0,184,81,0,0,88,63,0,0,0,0,0,0,224,63,0,0,203,0,0,0,204,0,0,0,23,0,0,0,1,0,0,0,50,53,98,116,84,114,105,97,110,103,108,101,82,97,121,99,97,115,116,67,97,108,108,98,97,99,107,0,0,0,0,0,224,81,0,0,144,63,0,0,88,67,0,0,0,0,0,0,50,56,98,116,84,114,105,97,110,103,108,101,67,111,110,118,101,120,99,97,115,116,67,97,108,108,98,97,99,107,0,0,224,81,0,0,192,63,0,0,88,67,0,0,0,0,0,0,0,0,0,0,144,64,0,0,205,0,0,0,206,0,0,0,47,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,81,0,0,0,22,0,0,0,8,0,0,0,74,0,0,0,45,0,0,0,14,0,0,0,2,0,0,0,24,0,0,0,11,0,0,0,46,0,0,0,23,0,0,0,56,0,0,0,2,0,0,0,48,0,0,0,11,0,0,0,75,0,0,0,57,0,0,0,8,0,0,0,76,0,0,0,77,0,0,0,49,0,0,0,58,0,0,0,78,0,0,0,50,0,0,0,4,0,0,0,51,0,0,0,49,53,98,116,84,114,105,97,110,103,108,101,83,104,97,112,101,0,0,0,0,0,0,0,224,81,0,0,120,64,0,0,128,62,0,0,0,0,0,0,84,114,105,97,110,103,108,101,0,0,0,0,0,0,0,0,0,0,0,0,24,65,0,0,207,0,0,0,208,0,0,0,59,0,0,0,82,0,0,0,105,115,108,97,110,100,85,110,105,111,110,70,105,110,100,65,110,100,81,117,105,99,107,83,111,114,116,0,0,0,0,0,112,114,111,99,101,115,115,73,115,108,97,110,100,115,0,0,50,53,98,116,83,105,109,117,108,97,116,105,111,110,73,115,108,97,110,100,77,97,110,97,103,101,114,0,0,0,0,0,184,81,0,0,248,64,0,0,0,0,0,0,152,65,0,0,209,0,0,0,210,0,0,0,52,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,81,0,0,0,22,0,0,0,9,0,0,0,79,0,0,0,45,0,0,0,16,0,0,0,8,0,0,0,24,0,0,0,11,0,0,0,46,0,0,0,60,0,0,0,61,0,0,0,2,0,0,0,53,0,0,0,11,0,0,0,34,0,0,0,25,0,0,0,0,0,0,0,49,51,98,116,83,112,104,101,114,101,83,104,97,112,101,0,224,81,0,0,136,65,0,0,104,41,0,0,0,0,0,0,0,0,0,0,240,65,0,0,211,0,0,0,212,0,0,0,6,0,0,0,2,0,0,0,83,0,0,0,0,0,0,0,51,50,98,116,83,112,104,101,114,101,83,112,104,101,114,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,0,0,224,81,0,0,200,65,0,0,208,69,0,0,0,0,0,0,0,0,0,0,72,66,0,0,213,0,0,0,214,0,0,0,7,0,0,0,3,0,0,0,84,0,0,0,0,0,0,0,51,52,98,116,83,112,104,101,114,101,84,114,105,97,110,103,108,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,224,81,0,0,32,66,0,0,208,69,0,0,0,0,0,0,0,0,0,0,192,66,0,0,215,0,0,0,216,0,0,0,54,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,85,0,0,0,80,0,0,0,10,0,0,0,81,0,0,0,45,0,0,0,10,0,0,0,3,0,0,0,82,0,0,0,26,0,0,0,46,0,0,0,55,0,0,0,0,0,0,0,49,56,98,116,83,116,97,116,105,99,80,108,97,110,101,83,104,97,112,101,0,0,0,0,224,81,0,0,168,66,0,0,232,71,0,0,0,0,0,0,98,116,83,116,97,116,105,99,80,108,97,110,101,83,104,97,112,101,68,97,116,97,0,0,83,84,65,84,73,67,80,76,65,78,69,0,0,0,0,0,0,0,0,0,48,67,0,0,217,0,0,0,218,0,0,0,3,0,0,0,0,0,0,0,50,50,98,116,83,117,98,115,105,109,112,108,101,120,67,111,110,118,101,120,67,97,115,116,0,0,0,0,0,0,0,0,224,81,0,0,16,67,0,0,120,40,0,0,0,0,0,0,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,0,0,0,184,81,0,0,64,67,0,0,51,49,98,116,73,110,116,101,114,110,97,108,84,114,105,97,110,103,108,101,73,110,100,101,120,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,184,81,0,0,96,67,0,0,0,0,0,0,240,67,0,0,219,0,0,0,220,0,0,0,56,0,0,0,1,0,0,0,2,0,0,0,86,0,0,0,87,0,0,0,83,0,0,0,88,0,0,0,89,0,0,0,84,0,0,0,62,0,0,0,63,0,0,0,85,0,0,0,27,0,0,0,0,0,0,0,49,52,98,116,84,114,105,97,110,103,108,101,77,101,115,104,0,0,0,0,0,0,0,0,224,81,0,0,216,67,0,0,32,78,0,0,0,0,0,0,0,0,0,0,112,68,0,0,221,0,0,0,222,0,0,0,14,0,0,0,12,0,0,0,1,0,0,0,1,0,0,0,90,0,0,0,29,0,0,0,2,0,0,0,86,0,0,0,45,0,0,0,10,0,0,0,3,0,0,0,87,0,0,0,28,0,0,0,46,0,0,0,57,0,0,0,18,0,0,0,19,0,0,0,0,0,0,0,49,57,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,0,0,0,224,81,0,0,88,68,0,0,232,71,0,0,0,0,0,0,84,82,73,65,78,71,76,69,77,69,83,72,0,0,0,0,0,0,0,0,192,68,0,0,223,0,0,0,224,0,0,0,58,0,0,0,0,0,0,0,50,49,83,117,112,112,111,114,116,86,101,114,116,101,120,67,97,108,108,98,97,99,107,0,224,81,0,0,168,68,0,0,88,67,0,0,0,0,0,0,0,0,0,0,80,69,0,0,225,0,0,0,226,0,0,0,59,0,0,0,0,0,0,0,90,78,75,49,57,98,116,84,114,105,97,110,103,108,101,77,101,115,104,83,104,97,112,101,49,57,112,114,111,99,101,115,115,65,108,108,84,114,105,97,110,103,108,101,115,69,80,49,56,98,116,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,82,75,57,98,116,86,101,99,116,111,114,51,83,52,95,69,49,54,70,105,108,116,101,114,101,100,67,97,108,108,98,97,99,107,0,0,0,224,81,0,0,232,68,0,0,136,67,0,0,0,0,0,0,0,0,0,0,152,69,0,0,227,0,0,0,228,0,0,0,8,0,0,0,0,0,0,0,50,50,83,112,104,101,114,101,84,114,105,97,110,103,108,101,68,101,116,101,99,116,111,114,0,0,0,0,0,0,0,0,224,81,0,0,120,69,0,0,160,52,0,0,0,0,0,0,51,48,98,116,65,99,116,105,118,97,116,105,110,103,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,0,0,0,0,224,81,0,0,168,69,0,0,176,50,0,0,0,0,0,0,0,0,0,0,32,70,0,0,229,0,0,0,230,0,0,0,9,0,0,0,4,0,0,0,91,0,0,0,0,0,0,0,50,54,98,116,66,111,120,66,111,120,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,224,81,0,0,0,70,0,0,208,69,0,0,0,0,0,0,0,0,0,0,96,70,0,0,231,0,0,0,232,0,0,0,10,0,0,0,0,0,0,0,49,54,98,116,66,111,120,66,111,120,68,101,116,101,99,116,111,114,0,0,0,0,0,0,224,81,0,0,72,70,0,0,160,52,0,0,0,0,0,0,0,0,0,0,176,70,0,0,233,0,0,0,234,0,0,0,11,0,0,0,5,0,0,0,92,0,0,0,0,0,0,0,50,56,98,116,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,224,81,0,0,144,70,0,0,208,69,0,0,0,0,0,0,0,0,0,0,8,71,0,0,235,0,0,0,236,0,0,0,28,0,0,0,93,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,50,50,98,116,67,111,109,112,111,117,110,100,76,101,97,102,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,0,224,81,0,0,232,70,0,0,64,35,0,0,0,0,0,0,0,0,0,0,96,71,0,0,237,0,0,0,238,0,0,0,12,0,0,0,6,0,0,0,94,0,0,0,0,0,0,0,51,54,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,224,81,0,0,56,71,0,0,208,69,0,0,0,0,0,0,0,0,0,0,192,71,0,0,239,0,0,0,240,0,0,0,64,0,0,0,95,0,0,0,5,0,0,0,16,0,0,0,17,0,0,0,0,0,0,0,51,48,98,116,67,111,109,112,111,117,110,100,67,111,109,112,111,117,110,100,76,101,97,102,67,97,108,108,98,97,99,107,0,0,0,0,0,0,0,0,224,81,0,0,152,71,0,0,64,35,0,0,0,0,0,0,49,52,98,116,67,111,110,99,97,118,101,83,104,97,112,101,0,0,0,0,0,0,0,0,224,81,0,0,208,71,0,0,216,27,0,0,0,0,0,0,0,0,0,0,88,72,0,0,241,0,0,0,242,0,0,0,13,0,0,0,7,0,0,0,96,0,0,0,0,0,0,0,0,0,0,0,136,72,0,0,243,0,0,0,244,0,0,0,60,0,0,0,0,0,0,0,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,0,224,81,0,0,48,72,0,0,208,69,0,0,0,0,0,0,50,52,98,116,67,111,110,118,101,120,84,114,105,97,110,103,108,101,67,97,108,108,98,97,99,107,0,0,0,0,0,0,224,81,0,0,104,72,0,0,88,67,0,0,0,0,0,0,0,0,0,0,80,73,0,0,245,0,0,0,246,0,0,0,61,0,0,0,0,0,0,0,90,78,51,51,98,116,67,111,110,118,101,120,67,111,110,99,97,118,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,50,49,99,97,108,99,117,108,97,116,101,84,105,109,101,79,102,73,109,112,97,99,116,69,80,49,55,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,83,49,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,51,49,76,111,99,97,108,84,114,105,97,110,103,108,101,83,112,104,101,114,101,67,97,115,116,67,97,108,108,98,97,99,107,0,0,0,224,81,0,0,176,72,0,0,88,67,0,0,0,0,0,0,0,0,0,0,240,73,0,0,247,0,0,0,248,0,0,0,18,0,0,0,0,0,0,0,0,0,0,0,184,73,0,0,249,0,0,0,250,0,0,0,14,0,0,0,8,0,0,0,97,0,0,0,0,0,0,0,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,0,0,0,0,0,0,0,224,81,0,0,152,73,0,0,208,69,0,0,0,0,0,0,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,48,67,114,101,97,116,101,70,117,110,99,69,0,224,81,0,0,200,73,0,0,232,46,0,0,0,0,0,0,0,0,0,0,64,74,0,0,251,0,0,0,252,0,0,0,26,0,0,0,27,0,0,0,7,0,0,0,0,0,0,0,50,52,98,116,80,101,114,116,117,114,98,101,100,67,111,110,116,97,99,116,82,101,115,117,108,116,0,0,0,0,0,0,224,81,0,0,32,74,0,0,240,52,0,0,0,0,0,0,0,0,0,0,0,75,0,0,253,0,0,0,254,0,0,0,65,0,0,0,66,0,0,0,8,0,0,0,0,0,0,0,90,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,54,112,114,111,99,101,115,115,67,111,108,108,105,115,105,111,110,69,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,83,50,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,50,49,98,116,87,105,116,104,111,117,116,77,97,114,103,105,110,82,101,115,117,108,116,95,48,0,0,224,81,0,0,112,74,0,0,80,40,0,0,0,0,0,0,0,0,0,0,184,75,0,0,255,0,0,0,0,1,0,0,67,0,0,0,68,0,0,0,9,0,0,0,0,0,0,0,90,78,50,51,98,116,67,111,110,118,101,120,67,111,110,118,101,120,65,108,103,111,114,105,116,104,109,49,54,112,114,111,99,101,115,115,67,111,108,108,105,115,105,111,110,69,80,75,50,52,98,116,67,111,108,108,105,115,105,111,110,79,98,106,101,99,116,87,114,97,112,112,101,114,83,50,95,82,75,49,54,98,116,68,105,115,112,97,116,99,104,101,114,73,110,102,111,80,49,54,98,116,77,97,110,105,102,111,108,100,82,101,115,117,108,116,69,49,51,98,116,68,117,109,109,121,82,101,115,117,108,116,0,0,0,0,224,81,0,0,48,75,0,0,80,40,0,0,0,0,0,0,0,0,0,0,16,76,0,0,1,1,0,0,2,1,0,0,15,0,0,0,9,0,0,0,98,0,0,0,0,0,0,0,51,49,98,116,67,111,110,118,101,120,80,108,97,110,101,67,111,108,108,105,115,105,111,110,65,108,103,111,114,105,116,104,109,0,0,0,0,0,0,0,224,81,0,0,232,75,0,0,176,50,0,0,0,0,0,0,0,0,0,0,72,76,0,0,3,1,0,0,4,1,0,0,49,56,98,116,67,111,110,118,101,120,80,111,108,121,104,101,100,114,111,110,0,0,0,0,184,81,0,0,48,76,0,0,2,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,200,76,0,0,5,1,0,0,6,1,0,0,29,0,0,0,30,0,0,0,88,0,0,0,0,0,0,0,50,51,98,116,72,97,115,104,101,100,83,105,109,112,108,101,80,97,105,114,67,97,99,104,101,0,0,0,0,0,0,0,184,81,0,0,168,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,98,116,73,110,116,73,110,100,101,120,68,97,116,97,0,0,98,116,83,104,111,114,116,73,110,116,73,110,100,101,120,84,114,105,112,108,101,116,68,97,116,97,0,0,0,0,0,0,98,116,67,104,97,114,73,110,100,101,120,84,114,105,112,108,101,116,68,97,116,97,0,0,98,116,86,101,99,116,111,114,51,70,108,111,97,116,68,97,116,97,0,0,0,0,0,0,98,116,86,101,99,116,111,114,51,68,111,117,98,108,101,68,97,116,97,0,0,0,0,0,98,116,77,101,115,104,80,97,114,116,68,97,116,97,0,0,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,68,97,116,97,0,0,0,0,0,50,51,98,116,83,116,114,105,100,105,110,103,77,101,115,104,73,110,116,101,114,102,97,99,101,0,0,0,0,0,0,0,184,81,0,0,144,77,0,0,0,0,0,0,32,78,0,0,7,1,0,0,8,1,0,0,56,0,0,0,1,0,0,0,2,0,0,0,86,0,0,0,87,0,0,0,83,0,0,0,99,0,0,0,100,0,0,0,84,0,0,0,62,0,0,0,63,0,0,0,85,0,0,0,27,0,0,0,0,0,0,0,50,54,98,116,84,114,105,97,110,103,108,101,73,110,100,101,120,86,101,114,116,101,120,65,114,114,97,121,0,0,0,0,224,81,0,0,0,78,0,0,176,77,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,111,111,116,0,0,0,0,72,78,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,117,110,99,97,117,103,104,116,0,0,0,0,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,58,32,37,115,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,101,120,99,101,112,116,105,111,110,32,111,102,32,116,121,112,101,32,37,115,0,0,0,0,0,0,0,0,116,101,114,109,105,110,97,116,105,110,103,32,119,105,116,104,32,37,115,32,102,111,114,101,105,103,110,32,101,120,99,101,112,116,105,111,110,0,0,0,116,101,114,109,105,110,97,116,105,110,103,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,116,104,114,101,97,100,95,111,110,99,101,32,102,97,105,108,117,114,101,32,105,110,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,95,102,97,115,116,40,41,0,0,0,0,0,0,0,0,99,97,110,110,111,116,32,99,114,101,97,116,101,32,112,116,104,114,101,97,100,32,107,101,121,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,0,0,0,0,0,0,99,97,110,110,111,116,32,122,101,114,111,32,111,117,116,32,116,104,114,101,97,100,32,118,97,108,117,101,32,102,111,114,32,95,95,99,120,97,95,103,101,116,95,103,108,111,98,97,108,115,40,41,0,0,0,0,0,0,0,0,40,80,0,0,9,1,0,0,10,1,0,0,89],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE+10240);allocate([115,116,100,58,58,98,97,100,95,97,108,108,111,99,0,0,83,116,57,98,97,100,95,97,108,108,111,99,0,0,0,0,224,81,0,0,24,80,0,0,176,80,0,0,0,0,0,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,114,101,116,117,114,110,101,100,0,116,101,114,109,105,110,97,116,101,95,104,97,110,100,108,101,114,32,117,110,101,120,112,101,99,116,101,100,108,121,32,116,104,114,101,119,32,97,110,32,101,120,99,101,112,116,105,111,110,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,83,116,57,101,120,99,101,112,116,105,111,110,0,0,0,0,184,81,0,0,160,80,0,0,83,116,57,116,121,112,101,95,105,110,102,111,0,0,0,0,184,81,0,0,184,80,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,54,95,95,115,104,105,109,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,0,224,81,0,0,208,80,0,0,200,80,0,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,224,81,0,0,8,81,0,0,248,80,0,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,57,95,95,112,111,105,110,116,101,114,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,49,55,95,95,112,98,97,115,101,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,0,0,0,224,81,0,0,104,81,0,0,248,80,0,0,0,0,0,0,224,81,0,0,64,81,0,0,144,81,0,0,0,0,0,0,0,0,0,0,48,81,0,0,11,1,0,0,12,1,0,0,13,1,0,0,14,1,0,0,31,0,0,0,4,0,0,0,16,0,0,0,62,0,0,0,0,0,0,0,40,82,0,0,11,1,0,0,15,1,0,0,13,1,0,0,14,1,0,0,31,0,0,0,5,0,0,0,17,0,0,0,63,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,48,95,95,115,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,0,0,0,224,81,0,0,0,82,0,0,48,81,0,0,0,0,0,0,0,0,0,0,136,82,0,0,11,1,0,0,16,1,0,0,13,1,0,0,14,1,0,0,31,0,0,0,6,0,0,0,18,0,0,0,64,0,0,0,78,49,48,95,95,99,120,120,97,98,105,118,49,50,49,95,95,118,109,105,95,99,108,97,115,115,95,116,121,112,101,95,105,110,102,111,69,0,0,0,224,81,0,0,96,82,0,0,48,81,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",ALLOC_NONE,Runtime.GLOBAL_BASE+20480);var tempDoublePtr=Runtime.alignMemory(allocate(12,"i8",ALLOC_STATIC),8);assert(tempDoublePtr%8==0);function copyTempFloat(ptr){HEAP8[tempDoublePtr]=HEAP8[ptr];HEAP8[tempDoublePtr+1]=HEAP8[ptr+1];HEAP8[tempDoublePtr+2]=HEAP8[ptr+2];HEAP8[tempDoublePtr+3]=HEAP8[ptr+3]}function copyTempDouble(ptr){HEAP8[tempDoublePtr]=HEAP8[ptr];HEAP8[tempDoublePtr+1]=HEAP8[ptr+1];HEAP8[tempDoublePtr+2]=HEAP8[ptr+2];HEAP8[tempDoublePtr+3]=HEAP8[ptr+3];HEAP8[tempDoublePtr+4]=HEAP8[ptr+4];HEAP8[tempDoublePtr+5]=HEAP8[ptr+5];HEAP8[tempDoublePtr+6]=HEAP8[ptr+6];HEAP8[tempDoublePtr+7]=HEAP8[ptr+7]}var _cosf=Math_cos;Module["_i64Subtract"]=_i64Subtract;var _fabsf=Math_abs;var ___errno_state=0;function ___setErrNo(value){HEAP32[___errno_state>>2]=value;return value}var ERRNO_CODES={EPERM:1,ENOENT:2,ESRCH:3,EINTR:4,EIO:5,ENXIO:6,E2BIG:7,ENOEXEC:8,EBADF:9,ECHILD:10,EAGAIN:11,EWOULDBLOCK:11,ENOMEM:12,EACCES:13,EFAULT:14,ENOTBLK:15,EBUSY:16,EEXIST:17,EXDEV:18,ENODEV:19,ENOTDIR:20,EISDIR:21,EINVAL:22,ENFILE:23,EMFILE:24,ENOTTY:25,ETXTBSY:26,EFBIG:27,ENOSPC:28,ESPIPE:29,EROFS:30,EMLINK:31,EPIPE:32,EDOM:33,ERANGE:34,ENOMSG:42,EIDRM:43,ECHRNG:44,EL2NSYNC:45,EL3HLT:46,EL3RST:47,ELNRNG:48,EUNATCH:49,ENOCSI:50,EL2HLT:51,EDEADLK:35,ENOLCK:37,EBADE:52,EBADR:53,EXFULL:54,ENOANO:55,EBADRQC:56,EBADSLT:57,EDEADLOCK:35,EBFONT:59,ENOSTR:60,ENODATA:61,ETIME:62,ENOSR:63,ENONET:64,ENOPKG:65,EREMOTE:66,ENOLINK:67,EADV:68,ESRMNT:69,ECOMM:70,EPROTO:71,EMULTIHOP:72,EDOTDOT:73,EBADMSG:74,ENOTUNIQ:76,EBADFD:77,EREMCHG:78,ELIBACC:79,ELIBBAD:80,ELIBSCN:81,ELIBMAX:82,ELIBEXEC:83,ENOSYS:38,ENOTEMPTY:39,ENAMETOOLONG:36,ELOOP:40,EOPNOTSUPP:95,EPFNOSUPPORT:96,ECONNRESET:104,ENOBUFS:105,EAFNOSUPPORT:97,EPROTOTYPE:91,ENOTSOCK:88,ENOPROTOOPT:92,ESHUTDOWN:108,ECONNREFUSED:111,EADDRINUSE:98,ECONNABORTED:103,ENETUNREACH:101,ENETDOWN:100,ETIMEDOUT:110,EHOSTDOWN:112,EHOSTUNREACH:113,EINPROGRESS:115,EALREADY:114,EDESTADDRREQ:89,EMSGSIZE:90,EPROTONOSUPPORT:93,ESOCKTNOSUPPORT:94,EADDRNOTAVAIL:99,ENETRESET:102,EISCONN:106,ENOTCONN:107,ETOOMANYREFS:109,EUSERS:87,EDQUOT:122,ESTALE:116,ENOTSUP:95,ENOMEDIUM:123,EILSEQ:84,EOVERFLOW:75,ECANCELED:125,ENOTRECOVERABLE:131,EOWNERDEAD:130,ESTRPIPE:86};function _sysconf(name){switch(name){case 30:return PAGE_SIZE;case 132:case 133:case 12:case 137:case 138:case 15:case 235:case 16:case 17:case 18:case 19:case 20:case 149:case 13:case 10:case 236:case 153:case 9:case 21:case 22:case 159:case 154:case 14:case 77:case 78:case 139:case 80:case 81:case 79:case 82:case 68:case 67:case 164:case 11:case 29:case 47:case 48:case 95:case 52:case 51:case 46:return 200809;case 27:case 246:case 127:case 128:case 23:case 24:case 160:case 161:case 181:case 182:case 242:case 183:case 184:case 243:case 244:case 245:case 165:case 178:case 179:case 49:case 50:case 168:case 169:case 175:case 170:case 171:case 172:case 97:case 76:case 32:case 173:case 35:return-1;case 176:case 177:case 7:case 155:case 8:case 157:case 125:case 126:case 92:case 93:case 129:case 130:case 131:case 94:case 91:return 1;case 74:case 60:case 69:case 70:case 4:return 1024;case 31:case 42:case 72:return 32;case 87:case 26:case 33:return 2147483647;case 34:case 1:return 47839;case 38:case 36:return 99;case 43:case 37:return 2048;case 0:return 2097152;case 3:return 65536;case 28:return 32768;case 44:return 32767;case 75:return 16384;case 39:return 1e3;case 89:return 700;case 71:return 256;case 40:return 255;case 2:return 100;case 180:return 64;case 25:return 20;case 5:return 16;case 6:return 6;case 73:return 4;case 84:{if(typeof navigator==="object")return navigator["hardwareConcurrency"]||1;return 1}}___setErrNo(ERRNO_CODES.EINVAL);return-1}function __ZSt18uncaught_exceptionv(){return!!__ZSt18uncaught_exceptionv.uncaught_exception}var EXCEPTIONS={last:0,caught:[],infos:{},deAdjust:(function(adjusted){if(!adjusted||EXCEPTIONS.infos[adjusted])return adjusted;for(var ptr in EXCEPTIONS.infos){var info=EXCEPTIONS.infos[ptr];if(info.adjusted===adjusted){return ptr}}return adjusted}),addRef:(function(ptr){if(!ptr)return;var info=EXCEPTIONS.infos[ptr];info.refcount++}),decRef:(function(ptr){if(!ptr)return;var info=EXCEPTIONS.infos[ptr];assert(info.refcount>0);info.refcount--;if(info.refcount===0){if(info.destructor){Runtime.dynCall("vi",info.destructor,[ptr])}delete EXCEPTIONS.infos[ptr];___cxa_free_exception(ptr)}}),clearRef:(function(ptr){if(!ptr)return;var info=EXCEPTIONS.infos[ptr];info.refcount=0})};function ___resumeException(ptr){if(!EXCEPTIONS.last){EXCEPTIONS.last=ptr}EXCEPTIONS.clearRef(EXCEPTIONS.deAdjust(ptr));throw ptr+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ___cxa_find_matching_catch(){var thrown=EXCEPTIONS.last;if(!thrown){return(asm["setTempRet0"](0),0)|0}var info=EXCEPTIONS.infos[thrown];var throwntype=info.type;if(!throwntype){return(asm["setTempRet0"](0),thrown)|0}var typeArray=Array.prototype.slice.call(arguments);var pointer=Module["___cxa_is_pointer_type"](throwntype);if(!___cxa_find_matching_catch.buffer)___cxa_find_matching_catch.buffer=_malloc(4);HEAP32[___cxa_find_matching_catch.buffer>>2]=thrown;thrown=___cxa_find_matching_catch.buffer;for(var i=0;i<typeArray.length;i++){if(typeArray[i]&&Module["___cxa_can_catch"](typeArray[i],throwntype,thrown)){thrown=HEAP32[thrown>>2];info.adjusted=thrown;return(asm["setTempRet0"](typeArray[i]),thrown)|0}}thrown=HEAP32[thrown>>2];return(asm["setTempRet0"](throwntype),thrown)|0}function ___cxa_throw(ptr,type,destructor){EXCEPTIONS.infos[ptr]={ptr:ptr,adjusted:ptr,type:type,destructor:destructor,refcount:0};EXCEPTIONS.last=ptr;if(!("uncaught_exception"in __ZSt18uncaught_exceptionv)){__ZSt18uncaught_exceptionv.uncaught_exception=1}else{__ZSt18uncaught_exceptionv.uncaught_exception++}throw ptr+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}Module["_memset"]=_memset;function _abort(){Module["abort"]()}function _pthread_once(ptr,func){if(!_pthread_once.seen)_pthread_once.seen={};if(ptr in _pthread_once.seen)return;Runtime.dynCall("v",func);_pthread_once.seen[ptr]=1}var _acosf=Math_acos;Module["_strlen"]=_strlen;var _sqrtf=Math_sqrt;var FS=undefined;var SOCKFS=undefined;function _send(fd,buf,len,flags){var sock=SOCKFS.getSocket(fd);if(!sock){___setErrNo(ERRNO_CODES.EBADF);return-1}return _write(fd,buf,len)}function _pwrite(fildes,buf,nbyte,offset){var stream=FS.getStream(fildes);if(!stream){___setErrNo(ERRNO_CODES.EBADF);return-1}try{var slab=HEAP8;return FS.write(stream,slab,buf,nbyte,offset)}catch(e){FS.handleFSError(e);return-1}}function _write(fildes,buf,nbyte){var stream=FS.getStream(fildes);if(!stream){___setErrNo(ERRNO_CODES.EBADF);return-1}try{var slab=HEAP8;return FS.write(stream,slab,buf,nbyte)}catch(e){FS.handleFSError(e);return-1}}function _fileno(stream){stream=FS.getStreamFromPtr(stream);if(!stream)return-1;return stream.fd}function _fputc(c,stream){var chr=unSign(c&255);HEAP8[_fputc.ret>>0]=chr;var fd=_fileno(stream);var ret=_write(fd,_fputc.ret,1);if(ret==-1){var streamObj=FS.getStreamFromPtr(stream);if(streamObj)streamObj.error=true;return-1}else{return chr}}var PTHREAD_SPECIFIC={};function _pthread_getspecific(key){return PTHREAD_SPECIFIC[key]||0}Module["_i64Add"]=_i64Add;var PTHREAD_SPECIFIC_NEXT_KEY=1;function _pthread_key_create(key,destructor){if(key==0){return ERRNO_CODES.EINVAL}HEAP32[key>>2]=PTHREAD_SPECIFIC_NEXT_KEY;PTHREAD_SPECIFIC[PTHREAD_SPECIFIC_NEXT_KEY]=0;PTHREAD_SPECIFIC_NEXT_KEY++;return 0}var _llvm_pow_f32=Math_pow;function _fmod(x,y){return x%y}function _fmodf(){return _fmod.apply(null,arguments)}function _pthread_setspecific(key,value){if(!(key in PTHREAD_SPECIFIC)){return ERRNO_CODES.EINVAL}PTHREAD_SPECIFIC[key]=value;return 0}var _atan2f=Math_atan2;function ___cxa_pure_virtual(){ABORT=true;throw"Pure virtual function called!"}function ___cxa_guard_release(){}var _asinf=Math_asin;function ___cxa_guard_acquire(variable){if(!HEAP8[variable>>0]){HEAP8[variable>>0]=1;return 1}return 0}function _gettimeofday(ptr){var now=Date.now();HEAP32[ptr>>2]=now/1e3|0;HEAP32[ptr+4>>2]=now%1e3*1e3|0;return 0}function _emscripten_asm_const_double(code){var args=Array.prototype.slice.call(arguments,1);return+Runtime.getAsmConst(code,args.length).apply(null,args)}function ___cxa_begin_catch(ptr){__ZSt18uncaught_exceptionv.uncaught_exception--;EXCEPTIONS.caught.push(ptr);EXCEPTIONS.addRef(EXCEPTIONS.deAdjust(ptr));return ptr}var _sinf=Math_sin;function _emscripten_memcpy_big(dest,src,num){HEAPU8.set(HEAPU8.subarray(src,src+num),dest);return dest}Module["_memcpy"]=_memcpy;function _sbrk(bytes){var self=_sbrk;if(!self.called){DYNAMICTOP=alignMemoryPage(DYNAMICTOP);self.called=true;assert(Runtime.dynamicAlloc);self.alloc=Runtime.dynamicAlloc;Runtime.dynamicAlloc=(function(){abort("cannot dynamically allocate, sbrk now has control")})}var ret=DYNAMICTOP;if(bytes!=0)self.alloc(bytes);return ret}Module["_memmove"]=_memmove;function _malloc(bytes){var ptr=Runtime.dynamicAlloc(bytes+8);return ptr+8&4294967288}Module["_malloc"]=_malloc;function ___cxa_allocate_exception(size){return _malloc(size)}function ___errno_location(){return ___errno_state}Module["_llvm_bswap_i32"]=_llvm_bswap_i32;function _llvm_trap(){abort("trap!")}function _time(ptr){var ret=Date.now()/1e3|0;if(ptr){HEAP32[ptr>>2]=ret}return ret}var _UItoF=true;function _fwrite(ptr,size,nitems,stream){var bytesToWrite=nitems*size;if(bytesToWrite==0)return 0;var fd=_fileno(stream);var bytesWritten=_write(fd,ptr,bytesToWrite);if(bytesWritten==-1){var streamObj=FS.getStreamFromPtr(stream);if(streamObj)streamObj.error=true;return 0}else{return bytesWritten/size|0}}function __reallyNegative(x){return x<0||x===0&&1/x===-Infinity}function __formatString(format,varargs){var textIndex=format;var argIndex=0;function getNextArg(type){var ret;if(type==="double"){ret=(HEAP32[tempDoublePtr>>2]=HEAP32[varargs+argIndex>>2],HEAP32[tempDoublePtr+4>>2]=HEAP32[varargs+(argIndex+4)>>2],+HEAPF64[tempDoublePtr>>3])}else if(type=="i64"){ret=[HEAP32[varargs+argIndex>>2],HEAP32[varargs+(argIndex+4)>>2]]}else{type="i32";ret=HEAP32[varargs+argIndex>>2]}argIndex+=Runtime.getNativeFieldSize(type);return ret}var ret=[];var curr,next,currArg;while(1){var startTextIndex=textIndex;curr=HEAP8[textIndex>>0];if(curr===0)break;next=HEAP8[textIndex+1>>0];if(curr==37){var flagAlwaysSigned=false;var flagLeftAlign=false;var flagAlternative=false;var flagZeroPad=false;var flagPadSign=false;flagsLoop:while(1){switch(next){case 43:flagAlwaysSigned=true;break;case 45:flagLeftAlign=true;break;case 35:flagAlternative=true;break;case 48:if(flagZeroPad){break flagsLoop}else{flagZeroPad=true;break};case 32:flagPadSign=true;break;default:break flagsLoop}textIndex++;next=HEAP8[textIndex+1>>0]}var width=0;if(next==42){width=getNextArg("i32");textIndex++;next=HEAP8[textIndex+1>>0]}else{while(next>=48&&next<=57){width=width*10+(next-48);textIndex++;next=HEAP8[textIndex+1>>0]}}var precisionSet=false,precision=-1;if(next==46){precision=0;precisionSet=true;textIndex++;next=HEAP8[textIndex+1>>0];if(next==42){precision=getNextArg("i32");textIndex++}else{while(1){var precisionChr=HEAP8[textIndex+1>>0];if(precisionChr<48||precisionChr>57)break;precision=precision*10+(precisionChr-48);textIndex++}}next=HEAP8[textIndex+1>>0]}if(precision<0){precision=6;precisionSet=false}var argSize;switch(String.fromCharCode(next)){case"h":var nextNext=HEAP8[textIndex+2>>0];if(nextNext==104){textIndex++;argSize=1}else{argSize=2}break;case"l":var nextNext=HEAP8[textIndex+2>>0];if(nextNext==108){textIndex++;argSize=8}else{argSize=4}break;case"L":case"q":case"j":argSize=8;break;case"z":case"t":case"I":argSize=4;break;default:argSize=null}if(argSize)textIndex++;next=HEAP8[textIndex+1>>0];switch(String.fromCharCode(next)){case"d":case"i":case"u":case"o":case"x":case"X":case"p":{var signed=next==100||next==105;argSize=argSize||4;var currArg=getNextArg("i"+argSize*8);var origArg=currArg;var argText;if(argSize==8){currArg=Runtime.makeBigInt(currArg[0],currArg[1],next==117)}if(argSize<=4){var limit=Math.pow(256,argSize)-1;currArg=(signed?reSign:unSign)(currArg&limit,argSize*8)}var currAbsArg=Math.abs(currArg);var prefix="";if(next==100||next==105){if(argSize==8&&i64Math)argText=i64Math.stringify(origArg[0],origArg[1],null);else argText=reSign(currArg,8*argSize,1).toString(10)}else if(next==117){if(argSize==8&&i64Math)argText=i64Math.stringify(origArg[0],origArg[1],true);else argText=unSign(currArg,8*argSize,1).toString(10);currArg=Math.abs(currArg)}else if(next==111){argText=(flagAlternative?"0":"")+currAbsArg.toString(8)}else if(next==120||next==88){prefix=flagAlternative&&currArg!=0?"0x":"";if(argSize==8&&i64Math){if(origArg[1]){argText=(origArg[1]>>>0).toString(16);var lower=(origArg[0]>>>0).toString(16);while(lower.length<8)lower="0"+lower;argText+=lower}else{argText=(origArg[0]>>>0).toString(16)}}else if(currArg<0){currArg=-currArg;argText=(currAbsArg-1).toString(16);var buffer=[];for(var i=0;i<argText.length;i++){buffer.push((15-parseInt(argText[i],16)).toString(16))}argText=buffer.join("");while(argText.length<argSize*2)argText="f"+argText}else{argText=currAbsArg.toString(16)}if(next==88){prefix=prefix.toUpperCase();argText=argText.toUpperCase()}}else if(next==112){if(currAbsArg===0){argText="(nil)"}else{prefix="0x";argText=currAbsArg.toString(16)}}if(precisionSet){while(argText.length<precision){argText="0"+argText}}if(currArg>=0){if(flagAlwaysSigned){prefix="+"+prefix}else if(flagPadSign){prefix=" "+prefix}}if(argText.charAt(0)=="-"){prefix="-"+prefix;argText=argText.substr(1)}while(prefix.length+argText.length<width){if(flagLeftAlign){argText+=" "}else{if(flagZeroPad){argText="0"+argText}else{prefix=" "+prefix}}}argText=prefix+argText;argText.split("").forEach((function(chr){ret.push(chr.charCodeAt(0))}));break};case"f":case"F":case"e":case"E":case"g":case"G":{var currArg=getNextArg("double");var argText;if(isNaN(currArg)){argText="nan";flagZeroPad=false}else if(!isFinite(currArg)){argText=(currArg<0?"-":"")+"inf";flagZeroPad=false}else{var isGeneral=false;var effectivePrecision=Math.min(precision,20);if(next==103||next==71){isGeneral=true;precision=precision||1;var exponent=parseInt(currArg.toExponential(effectivePrecision).split("e")[1],10);if(precision>exponent&&exponent>=-4){next=(next==103?"f":"F").charCodeAt(0);precision-=exponent+1}else{next=(next==103?"e":"E").charCodeAt(0);precision--}effectivePrecision=Math.min(precision,20)}if(next==101||next==69){argText=currArg.toExponential(effectivePrecision);if(/[eE][-+]\d$/.test(argText)){argText=argText.slice(0,-1)+"0"+argText.slice(-1)}}else if(next==102||next==70){argText=currArg.toFixed(effectivePrecision);if(currArg===0&&__reallyNegative(currArg)){argText="-"+argText}}var parts=argText.split("e");if(isGeneral&&!flagAlternative){while(parts[0].length>1&&parts[0].indexOf(".")!=-1&&(parts[0].slice(-1)=="0"||parts[0].slice(-1)==".")){parts[0]=parts[0].slice(0,-1)}}else{if(flagAlternative&&argText.indexOf(".")==-1)parts[0]+=".";while(precision>effectivePrecision++)parts[0]+="0"}argText=parts[0]+(parts.length>1?"e"+parts[1]:"");if(next==69)argText=argText.toUpperCase();if(currArg>=0){if(flagAlwaysSigned){argText="+"+argText}else if(flagPadSign){argText=" "+argText}}}while(argText.length<width){if(flagLeftAlign){argText+=" "}else{if(flagZeroPad&&(argText[0]=="-"||argText[0]=="+")){argText=argText[0]+"0"+argText.slice(1)}else{argText=(flagZeroPad?"0":" ")+argText}}}if(next<97)argText=argText.toUpperCase();argText.split("").forEach((function(chr){ret.push(chr.charCodeAt(0))}));break};case"s":{var arg=getNextArg("i8*");var argLength=arg?_strlen(arg):"(null)".length;if(precisionSet)argLength=Math.min(argLength,precision);if(!flagLeftAlign){while(argLength<width--){ret.push(32)}}if(arg){for(var i=0;i<argLength;i++){ret.push(HEAPU8[arg++>>0])}}else{ret=ret.concat(intArrayFromString("(null)".substr(0,argLength),true))}if(flagLeftAlign){while(argLength<width--){ret.push(32)}}break};case"c":{if(flagLeftAlign)ret.push(getNextArg("i8"));while(--width>0){ret.push(32)}if(!flagLeftAlign)ret.push(getNextArg("i8"));break};case"n":{var ptr=getNextArg("i32*");HEAP32[ptr>>2]=ret.length;break};case"%":{ret.push(curr);break};default:{for(var i=startTextIndex;i<textIndex+2;i++){ret.push(HEAP8[i>>0])}}}textIndex+=2}else{ret.push(curr);textIndex+=1}}return ret}function _fprintf(stream,format,varargs){var result=__formatString(format,varargs);var stack=Runtime.stackSave();var ret=_fwrite(allocate(result,"i8",ALLOC_STACK),1,result.length,stream);Runtime.stackRestore(stack);return ret}function _vfprintf(s,f,va_arg){return _fprintf(s,f,HEAP32[va_arg>>2])}var _stderr=allocate(1,"i32*",ALLOC_STATIC);___errno_state=Runtime.staticAlloc(4);HEAP32[___errno_state>>2]=0;_fputc.ret=allocate([0],"i8",ALLOC_STATIC);STACK_BASE=STACKTOP=Runtime.alignMemory(STATICTOP);staticSealed=true;STACK_MAX=STACK_BASE+TOTAL_STACK;DYNAMIC_BASE=DYNAMICTOP=Runtime.alignMemory(STACK_MAX);assert(DYNAMIC_BASE<TOTAL_MEMORY,"TOTAL_MEMORY not big enough for stack");var ctlz_i8=allocate([8,7,6,6,5,5,5,5,4,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"i8",ALLOC_DYNAMIC);var cttz_i8=allocate([8,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,7,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,6,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,5,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0,4,0,1,0,2,0,1,0,3,0,1,0,2,0,1,0],"i8",ALLOC_DYNAMIC);function invoke_viiiii(index,a1,a2,a3,a4,a5){try{Module["dynCall_viiiii"](index,a1,a2,a3,a4,a5)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vid(index,a1,a2){try{Module["dynCall_vid"](index,a1,a2)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vi(index,a1){try{Module["dynCall_vi"](index,a1)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiidii(index,a1,a2,a3,a4,a5,a6){try{Module["dynCall_viiidii"](index,a1,a2,a3,a4,a5,a6)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vii(index,a1,a2){try{Module["dynCall_vii"](index,a1,a2)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiiiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10){try{return Module["dynCall_iiiiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_ii(index,a1){try{return Module["dynCall_ii"](index,a1)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viidi(index,a1,a2,a3,a4){try{Module["dynCall_viidi"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viddiii(index,a1,a2,a3,a4,a5,a6){try{Module["dynCall_viddiii"](index,a1,a2,a3,a4,a5,a6)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vidii(index,a1,a2,a3,a4){try{Module["dynCall_vidii"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiiii(index,a1,a2,a3,a4){try{return Module["dynCall_iiiii"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_vidi(index,a1,a2,a3){try{Module["dynCall_vidi"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8){try{return Module["dynCall_diiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiddddiid(index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11){try{Module["dynCall_viiiiddddiid"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiiii(index,a1,a2,a3,a4,a5){try{return Module["dynCall_diiiii"](index,a1,a2,a3,a4,a5)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiii(index,a1,a2,a3){try{return Module["dynCall_iiii"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiii(index,a1,a2,a3,a4,a5,a6){try{Module["dynCall_viiiiii"](index,a1,a2,a3,a4,a5,a6)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiid(index,a1,a2,a3){try{return Module["dynCall_iiid"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_di(index,a1){try{return Module["dynCall_di"](index,a1)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiiiiii(index,a1,a2,a3,a4,a5,a6){try{return Module["dynCall_iiiiiii"](index,a1,a2,a3,a4,a5,a6)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiidii(index,a1,a2,a3,a4,a5,a6){try{return Module["dynCall_diiidii"](index,a1,a2,a3,a4,a5,a6)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viidii(index,a1,a2,a3,a4,a5){try{Module["dynCall_viidii"](index,a1,a2,a3,a4,a5)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiiii(index,a1,a2,a3,a4,a5,a6,a7){try{Module["dynCall_viiiiiii"](index,a1,a2,a3,a4,a5,a6,a7)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9){try{Module["dynCall_viiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10){try{Module["dynCall_viiiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iii(index,a1,a2){try{return Module["dynCall_iii"](index,a1,a2)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diii(index,a1,a2,a3){try{return Module["dynCall_diii"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10){try{return Module["dynCall_diiiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiid(index,a1,a2,a3,a4,a5){try{Module["dynCall_viiiid"](index,a1,a2,a3,a4,a5)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9){try{return Module["dynCall_diiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_did(index,a1,a2){try{return Module["dynCall_did"](index,a1,a2)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiiidddddidi(index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12){try{Module["dynCall_viiiidddddidi"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9,a10,a11,a12)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diidii(index,a1,a2,a3,a4,a5){try{return Module["dynCall_diidii"](index,a1,a2,a3,a4,a5)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_diiii(index,a1,a2,a3,a4){try{return Module["dynCall_diiii"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iiiiiiiiii(index,a1,a2,a3,a4,a5,a6,a7,a8,a9){try{return Module["dynCall_iiiiiiiiii"](index,a1,a2,a3,a4,a5,a6,a7,a8,a9)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiid(index,a1,a2,a3,a4){try{Module["dynCall_viiid"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viii(index,a1,a2,a3){try{Module["dynCall_viii"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_v(index){try{Module["dynCall_v"](index)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viid(index,a1,a2,a3){try{Module["dynCall_viid"](index,a1,a2,a3)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_iidid(index,a1,a2,a3,a4){try{return Module["dynCall_iidid"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}function invoke_viiii(index,a1,a2,a3,a4){try{Module["dynCall_viiii"](index,a1,a2,a3,a4)}catch(e){if(typeof e!=="number"&&e!=="longjmp")throw e;asm["setThrew"](1,0)}}Module.asmGlobalArg={"Math":Math,"Int8Array":Int8Array,"Int16Array":Int16Array,"Int32Array":Int32Array,"Uint8Array":Uint8Array,"Uint16Array":Uint16Array,"Uint32Array":Uint32Array,"Float32Array":Float32Array,"Float64Array":Float64Array};Module.asmLibraryArg={"abort":abort,"assert":assert,"min":Math_min,"invoke_viiiii":invoke_viiiii,"invoke_vid":invoke_vid,"invoke_vi":invoke_vi,"invoke_viiidii":invoke_viiidii,"invoke_vii":invoke_vii,"invoke_iiiiiiiiiii":invoke_iiiiiiiiiii,"invoke_ii":invoke_ii,"invoke_viidi":invoke_viidi,"invoke_viddiii":invoke_viddiii,"invoke_vidii":invoke_vidii,"invoke_iiiii":invoke_iiiii,"invoke_vidi":invoke_vidi,"invoke_diiiiiiii":invoke_diiiiiiii,"invoke_viiiiddddiid":invoke_viiiiddddiid,"invoke_diiiii":invoke_diiiii,"invoke_iiii":invoke_iiii,"invoke_viiiiii":invoke_viiiiii,"invoke_iiid":invoke_iiid,"invoke_di":invoke_di,"invoke_iiiiiii":invoke_iiiiiii,"invoke_diiidii":invoke_diiidii,"invoke_viidii":invoke_viidii,"invoke_viiiiiii":invoke_viiiiiii,"invoke_viiiiiiiii":invoke_viiiiiiiii,"invoke_viiiiiiiiii":invoke_viiiiiiiiii,"invoke_iii":invoke_iii,"invoke_diii":invoke_diii,"invoke_diiiiiiiiii":invoke_diiiiiiiiii,"invoke_viiiid":invoke_viiiid,"invoke_diiiiiiiii":invoke_diiiiiiiii,"invoke_did":invoke_did,"invoke_viiiidddddidi":invoke_viiiidddddidi,"invoke_diidii":invoke_diidii,"invoke_diiii":invoke_diiii,"invoke_iiiiiiiiii":invoke_iiiiiiiiii,"invoke_viiid":invoke_viiid,"invoke_viii":invoke_viii,"invoke_v":invoke_v,"invoke_viid":invoke_viid,"invoke_iidid":invoke_iidid,"invoke_viiii":invoke_viiii,"_emscripten_asm_const_double":_emscripten_asm_const_double,"_cosf":_cosf,"_send":_send,"_sqrtf":_sqrtf,"_fmod":_fmod,"___cxa_guard_acquire":___cxa_guard_acquire,"___setErrNo":___setErrNo,"_vfprintf":_vfprintf,"_atan2f":_atan2f,"_fmodf":_fmodf,"___cxa_guard_release":___cxa_guard_release,"_pwrite":_pwrite,"_acosf":_acosf,"_asinf":_asinf,"_fabsf":_fabsf,"_sbrk":_sbrk,"_llvm_pow_f32":_llvm_pow_f32,"___cxa_begin_catch":___cxa_begin_catch,"_sinf":_sinf,"_fileno":_fileno,"___resumeException":___resumeException,"___cxa_find_matching_catch":___cxa_find_matching_catch,"_sysconf":_sysconf,"__reallyNegative":__reallyNegative,"_pthread_getspecific":_pthread_getspecific,"__ZSt18uncaught_exceptionv":__ZSt18uncaught_exceptionv,"_emscripten_memcpy_big":_emscripten_memcpy_big,"_pthread_once":_pthread_once,"_pthread_key_create":_pthread_key_create,"_write":_write,"___errno_location":___errno_location,"_pthread_setspecific":_pthread_setspecific,"_fputc":_fputc,"___cxa_throw":___cxa_throw,"_abort":_abort,"___cxa_allocate_exception":___cxa_allocate_exception,"_fwrite":_fwrite,"_time":_time,"_fprintf":_fprintf,"_gettimeofday":_gettimeofday,"__formatString":__formatString,"_llvm_trap":_llvm_trap,"___cxa_pure_virtual":___cxa_pure_virtual,"STACKTOP":STACKTOP,"STACK_MAX":STACK_MAX,"tempDoublePtr":tempDoublePtr,"ABORT":ABORT,"cttz_i8":cttz_i8,"ctlz_i8":ctlz_i8,"NaN":NaN,"Infinity":Infinity,"_stderr":_stderr};// EMSCRIPTEN_START_ASM
var asm=(function(global,env,buffer) {
"use asm";var a=new global.Int8Array(buffer);var b=new global.Int16Array(buffer);var c=new global.Int32Array(buffer);var d=new global.Uint8Array(buffer);var e=new global.Uint16Array(buffer);var f=new global.Uint32Array(buffer);var g=new global.Float32Array(buffer);var h=new global.Float64Array(buffer);var i=env.STACKTOP|0;var j=env.STACK_MAX|0;var k=env.tempDoublePtr|0;var l=env.ABORT|0;var m=env.cttz_i8|0;var n=env.ctlz_i8|0;var o=env._stderr|0;var p=0;var q=0;var r=0;var s=0;var t=+env.NaN,u=+env.Infinity;var v=0,w=0,x=0,y=0,z=0.0,A=0,B=0,C=0,D=0.0;var E=0;var F=0;var G=0;var H=0;var I=0;var J=0;var K=0;var L=0;var M=0;var N=0;var O=global.Math.floor;var P=global.Math.abs;var Q=global.Math.sqrt;var R=global.Math.pow;var S=global.Math.cos;var T=global.Math.sin;var U=global.Math.tan;var V=global.Math.acos;var W=global.Math.asin;var X=global.Math.atan;var Y=global.Math.atan2;var Z=global.Math.exp;var _=global.Math.log;var $=global.Math.ceil;var aa=global.Math.imul;var ba=env.abort;var ca=env.assert;var da=env.min;var ea=env.invoke_viiiii;var fa=env.invoke_vid;var ga=env.invoke_vi;var ha=env.invoke_viiidii;var ia=env.invoke_vii;var ja=env.invoke_iiiiiiiiiii;var ka=env.invoke_ii;var la=env.invoke_viidi;var ma=env.invoke_viddiii;var na=env.invoke_vidii;var oa=env.invoke_iiiii;var pa=env.invoke_vidi;var qa=env.invoke_diiiiiiii;var ra=env.invoke_viiiiddddiid;var sa=env.invoke_diiiii;var ta=env.invoke_iiii;var ua=env.invoke_viiiiii;var va=env.invoke_iiid;var wa=env.invoke_di;var xa=env.invoke_iiiiiii;var ya=env.invoke_diiidii;var za=env.invoke_viidii;var Aa=env.invoke_viiiiiii;var Ba=env.invoke_viiiiiiiii;var Ca=env.invoke_viiiiiiiiii;var Da=env.invoke_iii;var Ea=env.invoke_diii;var Fa=env.invoke_diiiiiiiiii;var Ga=env.invoke_viiiid;var Ha=env.invoke_diiiiiiiii;var Ia=env.invoke_did;var Ja=env.invoke_viiiidddddidi;var Ka=env.invoke_diidii;var La=env.invoke_diiii;var Ma=env.invoke_iiiiiiiiii;var Na=env.invoke_viiid;var Oa=env.invoke_viii;var Pa=env.invoke_v;var Qa=env.invoke_viid;var Ra=env.invoke_iidid;var Sa=env.invoke_viiii;var Ta=env._emscripten_asm_const_double;var Ua=env._cosf;var Va=env._send;var Wa=env._sqrtf;var Xa=env._fmod;var Ya=env.___cxa_guard_acquire;var Za=env.___setErrNo;var _a=env._vfprintf;var $a=env._atan2f;var ab=env._fmodf;var bb=env.___cxa_guard_release;var cb=env._pwrite;var db=env._acosf;var eb=env._asinf;var fb=env._fabsf;var gb=env._sbrk;var hb=env._llvm_pow_f32;var ib=env.___cxa_begin_catch;var jb=env._sinf;var kb=env._fileno;var lb=env.___resumeException;var mb=env.___cxa_find_matching_catch;var nb=env._sysconf;var ob=env.__reallyNegative;var pb=env._pthread_getspecific;var qb=env.__ZSt18uncaught_exceptionv;var rb=env._emscripten_memcpy_big;var sb=env._pthread_once;var tb=env._pthread_key_create;var ub=env._write;var vb=env.___errno_location;var wb=env._pthread_setspecific;var xb=env._fputc;var yb=env.___cxa_throw;var zb=env._abort;var Ab=env.___cxa_allocate_exception;var Bb=env._fwrite;var Cb=env._time;var Db=env._fprintf;var Eb=env._gettimeofday;var Fb=env.__formatString;var Gb=env._llvm_trap;var Hb=env.___cxa_pure_virtual;var Ib=0.0;
// EMSCRIPTEN_START_FUNCS
function wc(a){a=a|0;var b=0;b=i;i=i+a|0;i=i+15&-16;return b|0}function xc(){return i|0}function yc(a){a=a|0;i=a}function zc(a,b){a=a|0;b=b|0;if(!p){p=a;q=b}}function Ac(b){b=b|0;a[k>>0]=a[b>>0];a[k+1>>0]=a[b+1>>0];a[k+2>>0]=a[b+2>>0];a[k+3>>0]=a[b+3>>0]}function Bc(b){b=b|0;a[k>>0]=a[b>>0];a[k+1>>0]=a[b+1>>0];a[k+2>>0]=a[b+2>>0];a[k+3>>0]=a[b+3>>0];a[k+4>>0]=a[b+4>>0];a[k+5>>0]=a[b+5>>0];a[k+6>>0]=a[b+6>>0];a[k+7>>0]=a[b+7>>0]}function Cc(a){a=a|0;E=a}function Dc(){return E|0}function Ec(a){a=a|0;return 52}function Fc(a,b,c,d){a=a|0;b=+b;c=+c;d=+d;var e=0.0,f=0.0,h=0.0;e=+S(+b);f=+S(+c);h=+S(+d);b=+T(+b);c=+T(+c);d=+T(+d);g[a>>2]=f*h;g[a+4>>2]=c*b*h-e*d;g[a+8>>2]=c*e*h+b*d;g[a+12>>2]=0.0;g[a+16>>2]=f*d;g[a+20>>2]=c*b*d+e*h;g[a+24>>2]=c*e*d-b*h;g[a+28>>2]=0.0;g[a+32>>2]=-c;g[a+36>>2]=f*b;g[a+40>>2]=f*e;g[a+44>>2]=0.0;return}function Gc(a,b){a=a|0;b=b|0;var c=0;c=i;Hc(a,b);i=c;return}function Hc(a,b){a=a|0;b=b|0;var c=0,d=0.0,e=0.0,f=0.0,h=0,j=0.0,k=0,l=0;c=i;i=i+16|0;f=+g[a>>2];e=+g[a+20>>2];d=+g[a+40>>2];if(f+e+d>0.0){f=+Q(+(f+e+d+1.0));g[c+12>>2]=f*.5;j=(+g[a+36>>2]- +g[a+24>>2])*(.5/f);g[c>>2]=j;d=(+g[a+8>>2]- +g[a+32>>2])*(.5/f);g[c+4>>2]=d;e=(+g[a+16>>2]- +g[a+4>>2])*(.5/f);g[c+8>>2]=e;f=f*.5;g[b>>2]=j;h=b+4|0;g[h>>2]=d;h=b+8|0;g[h>>2]=e;h=b+12|0;g[h>>2]=f;i=c;return}if(f<e)h=e<d?2:1;else h=f<d?2:0;l=((h+1|0)>>>0)%3|0;k=((h+2|0)>>>0)%3|0;d=+Q(+(+g[a+(h<<4)+(h<<2)>>2]- +g[a+(l<<4)+(l<<2)>>2]- +g[a+(k<<4)+(k<<2)>>2]+1.0));g[c+(h<<2)>>2]=d*.5;g[c+12>>2]=(+g[a+(k<<4)+(l<<2)>>2]- +g[a+(l<<4)+(k<<2)>>2])*(.5/d);g[c+(l<<2)>>2]=(+g[a+(l<<4)+(h<<2)>>2]+ +g[a+(h<<4)+(l<<2)>>2])*(.5/d);g[c+(k<<2)>>2]=(+g[a+(k<<4)+(h<<2)>>2]+ +g[a+(h<<4)+(k<<2)>>2])*(.5/d);d=+g[c>>2];e=+g[c+4>>2];f=+g[c+8>>2];j=+g[c+12>>2];g[b>>2]=d;h=b+4|0;g[h>>2]=e;h=b+8|0;g[h>>2]=f;h=b+12|0;g[h>>2]=j;i=c;return}function Ic(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Jc(){var a=0,d=0,e=0;a=i;d=fF(8)|0;a:do if(!d){while(1){d=c[5158]|0;c[5158]=d+0;if(!d)break;sc[d&3]();d=fF(8)|0;if(d)break a}d=Ab(4)|0;c[d>>2]=20472;yb(d|0,20520,265)}while(0);e=d;c[e>>2]=0;c[e+4>>2]=0;b[d+4>>1]=1;b[d+6>>1]=-1;c[d>>2]=840;i=a;return d|0}function Kc(a,b,d,e,f,g,h,j){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;j=j|0;var k=0.0,l=0;l=i;k=+Vb[c[(c[a>>2]|0)+12>>2]&1](a,b,d,e,f,g,h,j);i=l;return+k}function Lc(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Mc(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(95)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}ft(e,a,b,1);i=d;return e|0}function Nc(a){a=a|0;ib(a|0)|0;IE()}function Oc(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(95)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}ft(f,a,b,d);i=e;return f|0}function Pc(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Qc(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Rc(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Sc(){var a=0,b=0;a=i;b=fF(196)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(196)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);Zx(b,0);i=a;return b|0}function Tc(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Uc(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Vc(){var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(215)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[d>>2]=4024;a[d+20>>0]=1;c[d+16>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;a[d+40>>0]=1;c[d+36>>2]=0;c[d+28>>2]=0;c[d+32>>2]=0;a[d+60>>0]=1;c[d+56>>2]=0;c[d+48>>2]=0;c[d+52>>2]=0;a[d+80>>0]=1;c[d+76>>2]=0;c[d+68>>2]=0;c[d+72>>2]=0;a[d+100>>0]=1;c[d+96>>2]=0;c[d+88>>2]=0;c[d+92>>2]=0;a[d+120>>0]=1;c[d+116>>2]=0;c[d+108>>2]=0;c[d+112>>2]=0;a[d+140>>0]=1;c[d+136>>2]=0;c[d+128>>2]=0;c[d+132>>2]=0;a[d+160>>0]=1;c[d+156>>2]=0;c[d+148>>2]=0;c[d+152>>2]=0;a[d+180>>0]=1;c[d+176>>2]=0;c[d+168>>2]=0;c[d+172>>2]=0;c[d+192>>2]=0;i=b;return d|0}function Wc(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Xc(a){a=a|0;return+(+g[a>>2])}function Yc(a,b){a=a|0;b=+b;g[a>>2]=b;return}function Zc(a){a=a|0;return c[a+4>>2]|0}function _c(a,b){a=a|0;b=b|0;c[a+4>>2]=b;return}function $c(a){a=a|0;return c[a+8>>2]|0}function ad(a,b){a=a|0;b=b|0;c[a+8>>2]=b;return}function bd(a){a=a|0;return+(+g[a+12>>2])}function cd(a,b){a=a|0;b=+b;g[a+12>>2]=b;return}function dd(b){b=b|0;return(a[b+16>>0]&1)!=0|0}function ed(b,c){b=b|0;c=c|0;a[b+16>>0]=c&1;return}function fd(b){b=b|0;return(a[b+24>>0]&1)!=0|0}function gd(b,c){b=b|0;c=c|0;a[b+24>>0]=c&1;return}function hd(b){b=b|0;return(a[b+25>>0]&1)!=0|0}function id(b,c){b=b|0;c=c|0;a[b+25>>0]=c&1;return}function jd(b){b=b|0;return(a[b+26>>0]&1)!=0|0}function kd(b,c){b=b|0;c=c|0;a[b+26>>0]=c&1;return}function ld(a){a=a|0;return+(+g[a+28>>2])}function md(a,b){a=a|0;b=+b;g[a+28>>2]=b;return}function nd(b){b=b|0;return(a[b+32>>0]&1)!=0|0}function od(b,c){b=b|0;c=c|0;a[b+32>>0]=c&1;return}function pd(a){a=a|0;return+(+g[a+36>>2])}function qd(a,b){a=a|0;b=+b;g[a+36>>2]=b;return}function rd(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function sd(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(75)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;c[e>>2]=6296;c[e+4>>2]=10;c[e+52>>2]=1;g[e+28>>2]=a;g[e+32>>2]=b*.5;g[e+36>>2]=a;g[e+40>>2]=0.0;i=d;return e|0}function td(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function ud(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function vd(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function wd(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function xd(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(135)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}_r(e,a,b,16384,0,0);i=d;return e|0}function yd(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(135)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}_r(f,a,b,d&65535,0,0);i=e;return f|0}function zd(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;c[5004]=(c[5004]|0)+1;g=fF(135)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}_r(g,a,b,d&65535,e,0);i=f;return g|0}function Ad(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0;g=i;c[5004]=(c[5004]|0)+1;h=fF(135)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}_r(h,a,b,d&65535,e,f);i=g;return h|0}function Bd(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Cd(){var b=0,d=0,e=0,f=0,h=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(307)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}g[d+164>>2]=1.0;g[d+168>>2]=1.0;g[d+172>>2]=1.0;g[d+176>>2]=0.0;c[d+180>>2]=0;g[d+184>>2]=999999984306749400.0;h=d+188|0;e=d+204|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;c[e>>2]=1;c[d+208>>2]=-1;c[d+212>>2]=-1;c[d+216>>2]=1;g[d+220>>2]=0.0;g[d+224>>2]=.5;g[d+228>>2]=0.0;g[d+232>>2]=0.0;e=d+236|0;c[d+240>>2]=0;g[d+244>>2]=1.0;h=d+248|0;f=d+4|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=d+8|0;h=d+24|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;g[h>>2]=1.0;h=d+28|0;f=d+44|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=d+48|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;a[d+280>>0]=1;c[d+276>>2]=0;c[d+268>>2]=0;c[d+272>>2]=0;c[e>>2]=4;c[d>>2]=13056;c[5004]=(c[5004]|0)+1;e=fF(95)|0;if(!e){f=0;h=d+284|0;c[h>>2]=f;i=b;return d|0}c[(e+19&-16)+ -4>>2]=e;if(!(e+19&-16)){f=0;h=d+284|0;c[h>>2]=f;i=b;return d|0}Yz(e+19&-16);f=e+19&-16;h=d+284|0;c[h>>2]=f;i=b;return d|0}function Dd(a){a=a|0;return c[a+192>>2]|0}function Ed(a,b){a=a|0;b=+b;g[a+184>>2]=b;return}function Fd(a,b){a=a|0;b=b|0;var d=0;d=i;if(((c[a+216>>2]|0)+ -4|0)>>>0<2){i=d;return}c[a+216>>2]=b;i=d;return}function Gd(a,b){a=a|0;b=b|0;c[a+216>>2]=b;return}function Hd(a){a=a|0;var b=0;b=i;if(c[a+204>>2]&3){i=b;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=b;return}function Id(a,b){a=a|0;b=b|0;var d=0;d=i;if(!b?(c[a+204>>2]&3|0)!=0:0){i=d;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=d;return}function Jd(a){a=a|0;a=c[a+216>>2]|0;return((a|0)==2?0:(a|0)!=5)|0}function Kd(a){a=a|0;return(c[a+204>>2]&2|0)!=0|0}function Ld(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+228>>2]=b;return}function Md(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+224>>2]=b;return}function Nd(a){a=a|0;return a+4|0}function Od(a){a=a|0;return c[a+204>>2]|0}function Pd(a,b){a=a|0;b=b|0;c[a+204>>2]=b;return}function Qd(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];i=d;return}function Rd(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function Sd(a,b){a=a|0;b=+b;g[a+252>>2]=b;return}function Td(a,b){a=a|0;b=+b;g[a+248>>2]=b;return}function Ud(a){a=a|0;return c[a+268>>2]|0}function Vd(a,b){a=a|0;b=b|0;return c[(c[a+276>>2]|0)+(b<<2)>>2]|0}function Wd(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+8>>2]&511](a);i=b;return}function Xd(b,d,e){b=+b;d=d|0;e=e|0;var f=0,h=0,j=0,k=0;f=i;h=fF(140)|0;a:do if(!h){while(1){h=c[5158]|0;c[5158]=h+0;if(!h)break;sc[h&3]();h=fF(140)|0;if(h)break a}k=Ab(4)|0;c[k>>2]=20472;yb(k|0,20520,265)}while(0);g[h>>2]=b;c[h+4>>2]=d;d=h+8|0;j=h+56|0;k=d;do k=k+16|0;while((k|0)!=(j|0));c[h+72>>2]=e;j=h+76|0;k=h+100|0;c[j+0>>2]=0;c[j+4>>2]=0;c[j+8>>2]=0;c[j+12>>2]=0;c[j+16>>2]=0;c[j+20>>2]=0;g[k>>2]=.5;g[h+104>>2]=0.0;g[h+108>>2]=0.0;g[h+112>>2]=.800000011920929;g[h+116>>2]=1.0;a[h+120>>0]=0;g[h+124>>2]=.004999999888241291;g[h+128>>2]=.009999999776482582;g[h+132>>2]=.009999999776482582;g[h+136>>2]=.009999999776482582;ln(d);i=f;return h|0}function Yd(b,d,e,f){b=+b;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0;h=i;j=fF(140)|0;a:do if(!j){while(1){j=c[5158]|0;c[5158]=j+0;if(!j)break;sc[j&3]();j=fF(140)|0;if(j)break a}l=Ab(4)|0;c[l>>2]=20472;yb(l|0,20520,265)}while(0);g[j>>2]=b;c[j+4>>2]=d;d=j+8|0;k=j+56|0;l=d;do l=l+16|0;while((l|0)!=(k|0));c[j+72>>2]=e;l=j+76|0;c[l+0>>2]=c[f+0>>2];c[l+4>>2]=c[f+4>>2];c[l+8>>2]=c[f+8>>2];c[l+12>>2]=c[f+12>>2];g[j+92>>2]=0.0;g[j+96>>2]=0.0;g[j+100>>2]=.5;g[j+104>>2]=0.0;g[j+108>>2]=0.0;g[j+112>>2]=.800000011920929;g[j+116>>2]=1.0;a[j+120>>0]=0;g[j+124>>2]=.004999999888241291;g[j+128>>2]=.009999999776482582;g[j+132>>2]=.009999999776482582;g[j+136>>2]=.009999999776482582;ln(d);i=h;return j|0}function Zd(a){a=a|0;return+(+g[a+92>>2])}function _d(a,b){a=a|0;b=+b;g[a+92>>2]=b;return}function $d(a){a=a|0;return+(+g[a+96>>2])}function ae(a,b){a=a|0;b=+b;g[a+96>>2]=b;return}function be(a){a=a|0;return+(+g[a+100>>2])}function ce(a,b){a=a|0;b=+b;g[a+100>>2]=b;return}function de(a){a=a|0;return+(+g[a+104>>2])}function ee(a,b){a=a|0;b=+b;g[a+104>>2]=b;return}function fe(a){a=a|0;return+(+g[a+108>>2])}function ge(a,b){a=a|0;b=+b;g[a+108>>2]=b;return}function he(a){a=a|0;return+(+g[a+112>>2])}function ie(a,b){a=a|0;b=+b;g[a+112>>2]=b;return}function je(a){a=a|0;return+(+g[a+116>>2])}function ke(a,b){a=a|0;b=+b;g[a+116>>2]=b;return}function le(b){b=b|0;return(a[b+120>>0]&1)!=0|0}function me(b,c){b=b|0;c=c|0;a[b+120>>0]=c&1;return}function ne(a){a=a|0;return+(+g[a+124>>2])}function oe(a,b){a=a|0;b=+b;g[a+124>>2]=b;return}function pe(a){a=a|0;return+(+g[a+128>>2])}function qe(a,b){a=a|0;b=+b;g[a+128>>2]=b;return}function re(a){a=a|0;return+(+g[a+132>>2])}function se(a,b){a=a|0;b=+b;g[a+132>>2]=b;return}function te(a){a=a|0;return+(+g[a+136>>2])}function ue(a,b){a=a|0;b=+b;g[a+136>>2]=b;return}function ve(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function we(a){a=a|0;return a+48|0}function xe(a){a=a|0;return a+32|0}function ye(a){a=a|0;return a|0}function ze(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+0>>2]=c[b+0>>2];c[a+4>>2]=c[b+4>>2];c[a+8>>2]=c[b+8>>2];c[a+12>>2]=c[b+12>>2];i=d;return}function Ae(a){a=a|0;return a+16|0}function Be(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+16>>2]=c[b+0>>2];c[a+20>>2]=c[b+4>>2];c[a+24>>2]=c[b+8>>2];c[a+28>>2]=c[b+12>>2];i=d;return}function Ce(a){a=a|0;return a+32|0}function De(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+32>>2]=c[b+0>>2];c[a+36>>2]=c[b+4>>2];c[a+40>>2]=c[b+8>>2];c[a+44>>2]=c[b+12>>2];i=d;return}function Ee(a){a=a|0;return a+48|0}function Fe(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+48>>2]=c[b+0>>2];c[a+52>>2]=c[b+4>>2];c[a+56>>2]=c[b+8>>2];c[a+60>>2]=c[b+12>>2];i=d;return}function Ge(a){a=a|0;return a+64|0}function He(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+64>>2]=c[b+0>>2];c[a+68>>2]=c[b+4>>2];c[a+72>>2]=c[b+8>>2];c[a+76>>2]=c[b+12>>2];i=d;return}function Ie(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Je(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f=i;i=i+96|0;c[5004]=(c[5004]|0)+1;h=fF(1331)|0;if(!h)k=0;else{c[(h+19&-16)+ -4>>2]=h;k=h+19&-16}if((a[5024]|0)==0?(Ya(5024)|0)!=0:0){c[f+80>>2]=0;c[f+84>>2]=0;c[f+88>>2]=0;c[f+92>>2]=0;lr(4408,0.0,0,0,f+80|0);bb(5024)}c[f+64>>2]=0;c[f+68>>2]=0;c[f+72>>2]=0;c[f+76>>2]=0;mr(4408,0.0,f+64|0);c[k+4>>2]=6;c[k+8>>2]=-1;c[k+12>>2]=-1;g[k+16>>2]=3.4028234663852886e+38;a[k+20>>0]=1;a[k+21>>0]=0;c[k+24>>2]=-1;j=k+28|0;c[j>>2]=4408;h=k+32|0;c[h>>2]=b;g[k+36>>2]=0.0;g[k+40>>2]=.30000001192092896;c[k+44>>2]=0;c[k>>2]=2368;l=k+112|0;c[l+0>>2]=c[d+0>>2];c[l+4>>2]=c[d+4>>2];c[l+8>>2]=c[d+8>>2];c[l+12>>2]=c[d+12>>2];o=k+128|0;c[o+0>>2]=c[d+16>>2];c[o+4>>2]=c[d+20>>2];c[o+8>>2]=c[d+24>>2];c[o+12>>2]=c[d+28>>2];o=k+144|0;c[o+0>>2]=c[d+32>>2];c[o+4>>2]=c[d+36>>2];c[o+8>>2]=c[d+40>>2];c[o+12>>2]=c[d+44>>2];o=k+160|0;c[o+0>>2]=c[d+48>>2];c[o+4>>2]=c[d+52>>2];c[o+8>>2]=c[d+56>>2];c[o+12>>2]=c[d+60>>2];o=k+48|0;p=k+740|0;m=k+756|0;d=k+680|0;n=d+48|0;do{c[d>>2]=0;d=d+4|0}while((d|0)<(n|0));c[p+0>>2]=0;c[p+4>>2]=0;c[p+8>>2]=0;c[p+12>>2]=0;g[m>>2]=.20000000298023224;g[k+760>>2]=.20000000298023224;g[k+764>>2]=.20000000298023224;n=k+768|0;p=k+728|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;g[p>>2]=.699999988079071;g[k+732>>2]=1.0;g[k+736>>2]=.5;a[k+788>>0]=0;g[k+792>>2]=0.0;g[k+808>>2]=0.0;a[k+789>>0]=0;g[k+796>>2]=0.0;g[k+812>>2]=0.0;a[k+790>>0]=0;g[k+800>>2]=0.0;g[k+816>>2]=0.0;g[k+928>>2]=0.0;g[k+876>>2]=0.0;g[k+880>>2]=.10000000149011612;g[k+884>>2]=300.0;g[k+868>>2]=1.0;g[k+872>>2]=-1.0;g[k+896>>2]=0.0;g[k+900>>2]=.20000000298023224;g[k+904>>2]=0.0;g[k+908>>2]=0.0;g[k+888>>2]=1.0;g[k+892>>2]=.5;c[k+924>>2]=0;g[k+916>>2]=0.0;a[k+912>>0]=0;g[k+992>>2]=0.0;g[k+940>>2]=0.0;g[k+944>>2]=.10000000149011612;g[k+948>>2]=300.0;g[k+932>>2]=1.0;g[k+936>>2]=-1.0;g[k+960>>2]=0.0;g[k+964>>2]=.20000000298023224;g[k+968>>2]=0.0;g[k+972>>2]=0.0;g[k+952>>2]=1.0;g[k+956>>2]=.5;c[k+988>>2]=0;g[k+980>>2]=0.0;a[k+976>>0]=0;g[k+1056>>2]=0.0;g[k+1004>>2]=0.0;g[k+1008>>2]=.10000000149011612;g[k+1012>>2]=300.0;g[k+996>>2]=1.0;g[k+1e3>>2]=-1.0;g[k+1024>>2]=0.0;g[k+1028>>2]=.20000000298023224;g[k+1032>>2]=0.0;g[k+1036>>2]=0.0;g[k+1016>>2]=1.0;g[k+1020>>2]=.5;c[k+1052>>2]=0;g[k+1044>>2]=0.0;a[k+1040>>0]=0;a[k+1300>>0]=e&1;a[k+1301>>0]=1;c[k+1304>>2]=0;a[k+1308>>0]=0;no(f,b+4|0,l);c[o+0>>2]=c[f+0>>2];c[o+4>>2]=c[f+4>>2];c[o+8>>2]=c[f+8>>2];c[o+12>>2]=c[f+12>>2];p=k+64|0;c[p+0>>2]=c[f+16>>2];c[p+4>>2]=c[f+20>>2];c[p+8>>2]=c[f+24>>2];c[p+12>>2]=c[f+28>>2];p=k+80|0;c[p+0>>2]=c[f+32>>2];c[p+4>>2]=c[f+36>>2];c[p+8>>2]=c[f+40>>2];c[p+12>>2]=c[f+44>>2];p=k+96|0;c[p+0>>2]=c[f+48>>2];c[p+4>>2]=c[f+52>>2];c[p+8>>2]=c[f+56>>2];c[p+12>>2]=c[f+60>>2];Up(k,(c[j>>2]|0)+4|0,(c[h>>2]|0)+4|0);i=f;return k|0}function Ke(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0;j=i;c[5004]=(c[5004]|0)+1;k=fF(1331)|0;if(!k)l=0;else{c[(k+19&-16)+ -4>>2]=k;l=k+19&-16}c[l+4>>2]=6;c[l+8>>2]=-1;c[l+12>>2]=-1;g[l+16>>2]=3.4028234663852886e+38;a[l+20>>0]=1;a[l+21>>0]=0;c[l+24>>2]=-1;k=l+28|0;c[k>>2]=b;b=l+32|0;c[b>>2]=d;g[l+36>>2]=0.0;g[l+40>>2]=.30000001192092896;c[l+44>>2]=0;c[l>>2]=2368;m=l+48|0;c[m+0>>2]=c[e+0>>2];c[m+4>>2]=c[e+4>>2];c[m+8>>2]=c[e+8>>2];c[m+12>>2]=c[e+12>>2];m=l+64|0;c[m+0>>2]=c[e+16>>2];c[m+4>>2]=c[e+20>>2];c[m+8>>2]=c[e+24>>2];c[m+12>>2]=c[e+28>>2];m=l+80|0;c[m+0>>2]=c[e+32>>2];c[m+4>>2]=c[e+36>>2];c[m+8>>2]=c[e+40>>2];c[m+12>>2]=c[e+44>>2];m=l+96|0;c[m+0>>2]=c[e+48>>2];c[m+4>>2]=c[e+52>>2];c[m+8>>2]=c[e+56>>2];c[m+12>>2]=c[e+60>>2];e=l+112|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];e=l+128|0;c[e+0>>2]=c[f+16>>2];c[e+4>>2]=c[f+20>>2];c[e+8>>2]=c[f+24>>2];c[e+12>>2]=c[f+28>>2];e=l+144|0;c[e+0>>2]=c[f+32>>2];c[e+4>>2]=c[f+36>>2];c[e+8>>2]=c[f+40>>2];c[e+12>>2]=c[f+44>>2];e=l+160|0;c[e+0>>2]=c[f+48>>2];c[e+4>>2]=c[f+52>>2];c[e+8>>2]=c[f+56>>2];c[e+12>>2]=c[f+60>>2];e=l+740|0;f=l+756|0;m=l+680|0;d=m+48|0;do{c[m>>2]=0;m=m+4|0}while((m|0)<(d|0));c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;g[f>>2]=.20000000298023224;g[l+760>>2]=.20000000298023224;g[l+764>>2]=.20000000298023224;f=l+768|0;m=l+728|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;g[m>>2]=.699999988079071;g[l+732>>2]=1.0;g[l+736>>2]=.5;a[l+788>>0]=0;g[l+792>>2]=0.0;g[l+808>>2]=0.0;a[l+789>>0]=0;g[l+796>>2]=0.0;g[l+812>>2]=0.0;a[l+790>>0]=0;g[l+800>>2]=0.0;g[l+816>>2]=0.0;g[l+928>>2]=0.0;g[l+876>>2]=0.0;g[l+880>>2]=.10000000149011612;g[l+884>>2]=300.0;g[l+868>>2]=1.0;g[l+872>>2]=-1.0;g[l+896>>2]=0.0;g[l+900>>2]=.20000000298023224;g[l+904>>2]=0.0;g[l+908>>2]=0.0;g[l+888>>2]=1.0;g[l+892>>2]=.5;c[l+924>>2]=0;g[l+916>>2]=0.0;a[l+912>>0]=0;g[l+992>>2]=0.0;g[l+940>>2]=0.0;g[l+944>>2]=.10000000149011612;g[l+948>>2]=300.0;g[l+932>>2]=1.0;g[l+936>>2]=-1.0;g[l+960>>2]=0.0;g[l+964>>2]=.20000000298023224;g[l+968>>2]=0.0;g[l+972>>2]=0.0;g[l+952>>2]=1.0;g[l+956>>2]=.5;c[l+988>>2]=0;g[l+980>>2]=0.0;a[l+976>>0]=0;g[l+1056>>2]=0.0;g[l+1004>>2]=0.0;g[l+1008>>2]=.10000000149011612;g[l+1012>>2]=300.0;g[l+996>>2]=1.0;g[l+1e3>>2]=-1.0;g[l+1024>>2]=0.0;g[l+1028>>2]=.20000000298023224;g[l+1032>>2]=0.0;g[l+1036>>2]=0.0;g[l+1016>>2]=1.0;g[l+1020>>2]=.5;c[l+1052>>2]=0;g[l+1044>>2]=0.0;a[l+1040>>0]=0;a[l+1300>>0]=h&1;a[l+1301>>0]=1;c[l+1304>>2]=0;a[l+1308>>0]=0;Up(l,(c[k>>2]|0)+4|0,(c[b>>2]|0)+4|0);i=j;return l|0}function Le(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Me(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Ne(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Oe(a){a=a|0;return c[a+192>>2]|0}function Pe(a,b){a=a|0;b=+b;g[a+184>>2]=b;return}function Qe(a,b){a=a|0;b=b|0;var d=0;d=i;if(((c[a+216>>2]|0)+ -4|0)>>>0<2){i=d;return}c[a+216>>2]=b;i=d;return}function Re(a,b){a=a|0;b=b|0;c[a+216>>2]=b;return}function Se(a){a=a|0;var b=0;b=i;if(c[a+204>>2]&3){i=b;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=b;return}function Te(a,b){a=a|0;b=b|0;var d=0;d=i;if(!b?(c[a+204>>2]&3|0)!=0:0){i=d;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=d;return}function Ue(a){a=a|0;a=c[a+216>>2]|0;return((a|0)==2?0:(a|0)!=5)|0}function Ve(a){a=a|0;return(c[a+204>>2]&2|0)!=0|0}function We(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+228>>2]=b;return}function Xe(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+224>>2]=b;return}function Ye(a){a=a|0;return a+4|0}function Ze(a){a=a|0;return c[a+204>>2]|0}function _e(a,b){a=a|0;b=b|0;c[a+204>>2]=b;return}function $e(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];i=d;return}function af(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function bf(a,b){a=a|0;b=+b;g[a+252>>2]=b;return}function cf(a,b){a=a|0;b=+b;g[a+248>>2]=b;return}function df(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+8>>2]&511](a);i=b;return}function ef(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0;f=i;c[5004]=(c[5004]|0)+1;h=fF(343)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}a[h+20>>0]=1;c[h+16>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;c[h+24>>2]=b;g[h+28>>2]=0.0;c[h+32>>2]=0;c[h+36>>2]=1;g[h+40>>2]=1.0;a[h+44>>0]=1;c[h+48>>2]=0;a[h+52>>0]=0;a[h+53>>0]=1;a[h+54>>0]=1;g[h+56>>2]=.03999999910593033;a[h+60>>0]=0;g[h+64>>2]=0.0;c[h+68>>2]=d;c[h+72>>2]=0;a[h+76>>0]=1;c[h+80>>2]=0;c[h+84>>2]=0;c[h+88>>2]=0;g[h+92>>2]=.6000000238418579;g[h+96>>2]=1.0;g[h+100>>2]=.30000001192092896;g[h+104>>2]=.01666666753590107;g[h+108>>2]=0.0;g[h+116>>2]=20.0;c[h+112>>2]=10;g[h+124>>2]=.20000000298023224;g[h+128>>2]=.800000011920929;g[h+132>>2]=0.0;g[h+120>>2]=1.0;c[h+136>>2]=1;g[h+140>>2]=-.03999999910593033;g[h+144>>2]=.10000000149011612;g[h+148>>2]=0.0;g[h+152>>2]=.8500000238418579;c[h+156>>2]=260;c[h+160>>2]=2;c[h+164>>2]=128;g[h+168>>2]=100.0;g[h+172>>2]=1.0000000150474662e+30;c[h>>2]=1392;a[h+192>>0]=1;c[h+188>>2]=0;c[h+180>>2]=0;c[h+184>>2]=0;d=h+196|0;c[d>>2]=0;j=h+200|0;c[j>>2]=e;a[h+224>>0]=1;c[h+220>>2]=0;c[h+212>>2]=0;c[h+216>>2]=0;a[h+244>>0]=1;c[h+240>>2]=0;c[h+232>>2]=0;c[h+236>>2]=0;g[h+248>>2]=0.0;g[h+252>>2]=-10.0;m=h+256|0;a[h+274>>0]=0;a[h+275>>0]=0;l=h+292|0;c[m+0>>2]=0;c[m+4>>2]=0;c[m+8>>2]=0;c[m+12>>2]=0;a[l>>0]=1;c[h+288>>2]=0;c[h+280>>2]=0;c[h+284>>2]=0;c[h+296>>2]=0;a[h+300>>0]=1;a[h+320>>0]=1;c[h+316>>2]=0;c[h+308>>2]=0;c[h+312>>2]=0;if(!e){c[5004]=(c[5004]|0)+1;e=fF(215)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e>>2]=4024;a[e+20>>0]=1;c[e+16>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;a[e+40>>0]=1;c[e+36>>2]=0;c[e+28>>2]=0;c[e+32>>2]=0;a[e+60>>0]=1;c[e+56>>2]=0;c[e+48>>2]=0;c[e+52>>2]=0;a[e+80>>0]=1;c[e+76>>2]=0;c[e+68>>2]=0;c[e+72>>2]=0;a[e+100>>0]=1;c[e+96>>2]=0;c[e+88>>2]=0;c[e+92>>2]=0;a[e+120>>0]=1;c[e+116>>2]=0;c[e+108>>2]=0;c[e+112>>2]=0;a[e+140>>0]=1;c[e+136>>2]=0;c[e+128>>2]=0;c[e+132>>2]=0;a[e+160>>0]=1;c[e+156>>2]=0;c[e+148>>2]=0;c[e+152>>2]=0;a[e+180>>0]=1;c[e+176>>2]=0;c[e+168>>2]=0;c[e+172>>2]=0;c[e+192>>2]=0;c[j>>2]=e;a[h+273>>0]=1}else a[h+273>>0]=0;c[5004]=(c[5004]|0)+1;e=fF(87)|0;if((e|0)!=0?(k=e+19&-16,c[k+ -4>>2]=e,(e+19&-16|0)!=0):0){c[(e+19&-16)>>2]=16568;a[k+20>>0]=1;c[k+16>>2]=0;c[k+8>>2]=0;c[k+12>>2]=0;a[k+40>>0]=1;c[k+36>>2]=0;c[k+28>>2]=0;c[k+32>>2]=0;a[k+60>>0]=1;c[k+56>>2]=0;c[k+48>>2]=0;c[k+52>>2]=0;a[k+64>>0]=1;k=e+19&-16}else k=0;c[h+204>>2]=k;a[h+272>>0]=1;c[5004]=(c[5004]|0)+1;k=fF(107)|0;if(!k){m=0;c[d>>2]=m;i=f;return h|0}e=k+19&-16;c[e+ -4>>2]=k;if(!(k+19&-16)){m=0;c[d>>2]=m;i=f;return h|0}m=c[j>>2]|0;c[(k+19&-16)>>2]=2240;c[e+4>>2]=0;c[e+8>>2]=m;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=b;a[e+44>>0]=1;c[e+40>>2]=0;c[e+32>>2]=0;c[e+36>>2]=0;a[e+64>>0]=1;c[e+60>>2]=0;c[e+52>>2]=0;c[e+56>>2]=0;a[e+84>>0]=1;c[e+80>>2]=0;c[e+72>>2]=0;c[e+76>>2]=0;m=k+19&-16;c[d>>2]=m;i=f;return h|0}function ff(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+72>>2]&127](a,b);i=d;return}function gf(b){b=b|0;var d=0;d=i;i=i+16|0;if((a[24]|0)==0?(Ya(24)|0)!=0:0)bb(24);Nb[c[(c[b>>2]|0)+76>>2]&127](d,b);c[2]=c[d+0>>2];c[3]=c[d+4>>2];c[4]=c[d+8>>2];c[5]=c[d+12>>2];i=d;return 8}function hf(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+84>>2]&127](a,b);i=d;return}function jf(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+88>>2]&127](a,b,d,e);i=f;return}function kf(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+92>>2]&127](a,b);i=d;return}function lf(a,b){a=a|0;b=b|0;var d=0;d=i;rc[c[(c[a>>2]|0)+56>>2]&127](a,b,0);i=d;return}function mf(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;rc[c[(c[a>>2]|0)+56>>2]&127](a,b,d);i=e;return}function nf(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+60>>2]&127](a,b);i=d;return}function of(a,b){a=a|0;b=+b;var d=0;d=i;a=uc[c[(c[a>>2]|0)+52>>2]&1](a,b,1,.01666666753590107)|0;i=d;return a|0}function pf(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;a=uc[c[(c[a>>2]|0)+52>>2]&1](a,b,d,.01666666753590107)|0;i=e;return a|0}function qf(a,b,d,e){a=a|0;b=+b;d=d|0;e=+e;var f=0;f=i;a=uc[c[(c[a>>2]|0)+52>>2]&1](a,b,d,e)|0;i=f;return a|0}function rf(a){a=a|0;return c[a+24>>2]|0}function sf(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+32>>2]&127](a,b,d,e);i=f;return}function tf(a){a=a|0;var b=0;b=i;a=c[a+68>>2]|0;a=Pb[c[(c[a>>2]|0)+36>>2]&127](a)|0;i=b;return a|0}function uf(a){a=a|0;return a+28|0}function vf(a,b){a=a|0;b=b|0;var d=0;d=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,2,-3);i=d;return}function wf(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,-3);i=e;return}function xf(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,e);i=f;return}function yf(a){a=a|0;return c[a+68>>2]|0}function zf(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;var g=0;g=i;Ou(a,b,c,d,e,f);i=g;return}function Af(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=i;Qu(a,b,c,d);i=e;return}function Bf(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+64>>2]&127](a,b);i=d;return}function Cf(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Df(b){b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(115)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;c[e+52>>2]=0;g[e+56>>2]=1.0;g[e+60>>2]=1.0;g[e+64>>2]=1.0;g[e+68>>2]=0.0;g[e+72>>2]=-1.0;g[e+76>>2]=-1.0;g[e+80>>2]=-1.0;g[e+84>>2]=0.0;a[e+88>>0]=0;c[e>>2]=10656;c[e+92>>2]=b;c[e+4>>2]=3;EA(e);i=d;return e|0}function Ef(b,d){b=b|0;d=d|0;var e=0,f=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(115)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}c[f+8>>2]=0;g[f+12>>2]=1.0;g[f+16>>2]=1.0;g[f+20>>2]=1.0;g[f+24>>2]=0.0;g[f+44>>2]=.03999999910593033;c[f+52>>2]=0;g[f+56>>2]=1.0;g[f+60>>2]=1.0;g[f+64>>2]=1.0;g[f+68>>2]=0.0;g[f+72>>2]=-1.0;g[f+76>>2]=-1.0;g[f+80>>2]=-1.0;g[f+84>>2]=0.0;a[f+88>>0]=0;c[f>>2]=10656;c[f+92>>2]=b;c[f+4>>2]=3;if(!d){i=e;return f|0}EA(f);i=e;return f|0}function Ff(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Gf(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Hf(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function If(a){a=a|0;return+g[a+4>>2]<1.0|0}function Jf(a){a=a|0;return b[a+8>>1]|0}function Kf(a,c){a=a|0;c=c|0;b[a+8>>1]=c;return}function Lf(a){a=a|0;return b[a+10>>1]|0}function Mf(a,c){a=a|0;c=c|0;b[a+10>>1]=c;return}function Nf(a){a=a|0;return+(+g[a+4>>2])}function Of(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function Pf(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Qf(b,d){b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(379)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}Yr(f,3,b);c[f>>2]=2984;n=f+300|0;c[n+0>>2]=c[d+0>>2];c[n+4>>2]=c[d+4>>2];c[n+8>>2]=c[d+8>>2];c[n+12>>2]=c[d+12>>2];m=+g[d>>2];l=+g[d+4>>2];k=+g[d+8>>2];j=m*+g[b+20>>2]+l*+g[b+24>>2]+k*+g[b+28>>2]+ +g[b+56>>2];h=m*+g[b+36>>2]+l*+g[b+40>>2]+k*+g[b+44>>2]+ +g[b+60>>2];g[f+316>>2]=m*+g[b+4>>2]+l*+g[b+8>>2]+k*+g[b+12>>2]+ +g[b+52>>2];g[f+320>>2]=j;g[f+324>>2]=h;g[f+328>>2]=0.0;c[f+332>>2]=0;a[f+344>>0]=0;g[f+348>>2]=.30000001192092896;g[f+352>>2]=1.0;g[f+356>>2]=0.0;i=e;return f|0}function Rf(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0;h=i;c[5004]=(c[5004]|0)+1;j=fF(379)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}c[j+4>>2]=3;c[j+8>>2]=-1;c[j+12>>2]=-1;g[j+16>>2]=3.4028234663852886e+38;a[j+20>>0]=1;a[j+21>>0]=0;c[j+24>>2]=-1;c[j+28>>2]=b;c[j+32>>2]=d;g[j+36>>2]=0.0;g[j+40>>2]=.30000001192092896;c[j+44>>2]=0;c[j>>2]=2984;d=j+300|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];e=j+316|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];c[j+332>>2]=0;a[j+344>>0]=0;g[j+348>>2]=.30000001192092896;g[j+352>>2]=1.0;g[j+356>>2]=0.0;i=h;return j|0}function Sf(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+300>>2]=c[b+0>>2];c[a+304>>2]=c[b+4>>2];c[a+308>>2]=c[b+8>>2];c[a+312>>2]=c[b+12>>2];i=d;return}function Tf(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+316>>2]=c[b+0>>2];c[a+320>>2]=c[b+4>>2];c[a+324>>2]=c[b+8>>2];c[a+328>>2]=c[b+12>>2];i=d;return}function Uf(a){a=a|0;return a+300|0}function Vf(a){a=a|0;return a+316|0}function Wf(b,c){b=b|0;c=c|0;a[b+21>>0]=c&1;return}function Xf(a){a=a|0;return a+348|0}function Yf(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+348>>2]=c[b+0>>2];c[a+352>>2]=c[b+4>>2];c[a+356>>2]=c[b+8>>2];i=d;return}function Zf(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function _f(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+8>>2]&127](a,b);i=d;return}function $f(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function ag(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function bg(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0;f=i;i=i+96|0;c[5004]=(c[5004]|0)+1;h=fF(1147)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}if((a[5024]|0)==0?(Ya(5024)|0)!=0:0){c[f+80>>2]=0;c[f+84>>2]=0;c[f+88>>2]=0;c[f+92>>2]=0;lr(4408,0.0,0,0,f+80|0);bb(5024)}c[f+64>>2]=0;c[f+68>>2]=0;c[f+72>>2]=0;c[f+76>>2]=0;mr(4408,0.0,f+64|0);c[h+4>>2]=7;c[h+8>>2]=-1;c[h+12>>2]=-1;g[h+16>>2]=3.4028234663852886e+38;a[h+20>>0]=1;a[h+21>>0]=0;c[h+24>>2]=-1;k=h+28|0;c[k>>2]=4408;j=h+32|0;c[j>>2]=b;g[h+36>>2]=0.0;g[h+40>>2]=.30000001192092896;c[h+44>>2]=0;c[h>>2]=4264;a[h+48>>0]=0;l=h+116|0;c[l+0>>2]=c[d+0>>2];c[l+4>>2]=c[d+4>>2];c[l+8>>2]=c[d+8>>2];c[l+12>>2]=c[d+12>>2];m=h+132|0;c[m+0>>2]=c[d+16>>2];c[m+4>>2]=c[d+20>>2];c[m+8>>2]=c[d+24>>2];c[m+12>>2]=c[d+28>>2];m=h+148|0;c[m+0>>2]=c[d+32>>2];c[m+4>>2]=c[d+36>>2];c[m+8>>2]=c[d+40>>2];c[m+12>>2]=c[d+44>>2];m=h+164|0;c[m+0>>2]=c[d+48>>2];c[m+4>>2]=c[d+52>>2];c[m+8>>2]=c[d+56>>2];c[m+12>>2]=c[d+60>>2];a[h+180>>0]=e&1;d=h+52|0;no(f,b+4|0,l);c[d+0>>2]=c[f+0>>2];c[d+4>>2]=c[f+4>>2];c[d+8>>2]=c[f+8>>2];c[d+12>>2]=c[f+12>>2];d=h+68|0;c[d+0>>2]=c[f+16>>2];c[d+4>>2]=c[f+20>>2];c[d+8>>2]=c[f+24>>2];c[d+12>>2]=c[f+28>>2];d=h+84|0;c[d+0>>2]=c[f+32>>2];c[d+4>>2]=c[f+36>>2];c[d+8>>2]=c[f+40>>2];c[d+12>>2]=c[f+44>>2];d=h+100|0;c[d+0>>2]=c[f+48>>2];c[d+4>>2]=c[f+52>>2];c[d+8>>2]=c[f+56>>2];c[d+12>>2]=c[f+60>>2];g[h+184>>2]=1.0;g[h+188>>2]=-1.0;g[h+192>>2]=0.0;g[h+196>>2]=0.0;g[h+200>>2]=1.0;g[h+204>>2]=.699999988079071;g[h+208>>2]=0.0;g[h+212>>2]=0.0;g[h+216>>2]=1.0;g[h+220>>2]=.699999988079071;g[h+224>>2]=0.0;g[h+228>>2]=0.0;g[h+264>>2]=1.0;g[h+268>>2]=.699999988079071;g[h+272>>2]=1.0;g[h+276>>2]=0.0;g[h+280>>2]=1.0;g[h+284>>2]=.699999988079071;g[h+288>>2]=1.0;g[h+292>>2]=0.0;g[h+232>>2]=1.0;g[h+236>>2]=.699999988079071;g[h+240>>2]=1.0;g[h+244>>2]=0.0;g[h+248>>2]=1.0;g[h+252>>2]=.699999988079071;g[h+256>>2]=1.0;g[h+260>>2]=0.0;a[h+1096>>0]=0;d=h+1100|0;g[h+1116>>2]=0.0;g[h+1120>>2]=0.0;g[h+1124>>2]=0.0;c[h+300>>2]=0;e=h+49|0;c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;a[d+12>>0]=0;a[e>>0]=1;Pr(h,(c[k>>2]|0)+4|0,(c[j>>2]|0)+4|0);i=f;return h|0}function cg(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0;j=i;c[5004]=(c[5004]|0)+1;k=fF(1147)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}c[k+4>>2]=7;c[k+8>>2]=-1;c[k+12>>2]=-1;g[k+16>>2]=3.4028234663852886e+38;a[k+20>>0]=1;a[k+21>>0]=0;c[k+24>>2]=-1;l=k+28|0;c[l>>2]=b;b=k+32|0;c[b>>2]=d;g[k+36>>2]=0.0;g[k+40>>2]=.30000001192092896;c[k+44>>2]=0;c[k>>2]=4264;a[k+48>>0]=0;d=k+52|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];d=k+68|0;c[d+0>>2]=c[e+16>>2];c[d+4>>2]=c[e+20>>2];c[d+8>>2]=c[e+24>>2];c[d+12>>2]=c[e+28>>2];d=k+84|0;c[d+0>>2]=c[e+32>>2];c[d+4>>2]=c[e+36>>2];c[d+8>>2]=c[e+40>>2];c[d+12>>2]=c[e+44>>2];d=k+100|0;c[d+0>>2]=c[e+48>>2];c[d+4>>2]=c[e+52>>2];c[d+8>>2]=c[e+56>>2];c[d+12>>2]=c[e+60>>2];e=k+116|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];e=k+132|0;c[e+0>>2]=c[f+16>>2];c[e+4>>2]=c[f+20>>2];c[e+8>>2]=c[f+24>>2];c[e+12>>2]=c[f+28>>2];e=k+148|0;c[e+0>>2]=c[f+32>>2];c[e+4>>2]=c[f+36>>2];c[e+8>>2]=c[f+40>>2];c[e+12>>2]=c[f+44>>2];e=k+164|0;c[e+0>>2]=c[f+48>>2];c[e+4>>2]=c[f+52>>2];c[e+8>>2]=c[f+56>>2];c[e+12>>2]=c[f+60>>2];a[k+180>>0]=h&1;g[k+184>>2]=1.0;g[k+188>>2]=-1.0;g[k+192>>2]=0.0;g[k+196>>2]=0.0;g[k+200>>2]=1.0;g[k+204>>2]=.699999988079071;g[k+208>>2]=0.0;g[k+212>>2]=0.0;g[k+216>>2]=1.0;g[k+220>>2]=.699999988079071;g[k+224>>2]=0.0;g[k+228>>2]=0.0;g[k+264>>2]=1.0;g[k+268>>2]=.699999988079071;g[k+272>>2]=1.0;g[k+276>>2]=0.0;g[k+280>>2]=1.0;g[k+284>>2]=.699999988079071;g[k+288>>2]=1.0;g[k+292>>2]=0.0;g[k+232>>2]=1.0;g[k+236>>2]=.699999988079071;g[k+240>>2]=1.0;g[k+244>>2]=0.0;g[k+248>>2]=1.0;g[k+252>>2]=.699999988079071;g[k+256>>2]=1.0;g[k+260>>2]=0.0;a[k+1096>>0]=0;f=k+1100|0;g[k+1116>>2]=0.0;g[k+1120>>2]=0.0;g[k+1124>>2]=0.0;c[k+300>>2]=0;h=k+49|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;a[f+12>>0]=0;a[h>>0]=1;Pr(k,(c[l>>2]|0)+4|0,(c[b>>2]|0)+4|0);i=j;return k|0}function dg(a,b){a=a|0;b=+b;g[a+184>>2]=b;return}function eg(a,b){a=a|0;b=+b;g[a+188>>2]=b;return}function fg(a,b){a=a|0;b=+b;var c=0;c=i;b=+ab(+b,6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;g[a+192>>2]=b;i=c;return}function gg(a,b){a=a|0;b=+b;var c=0;c=i;b=+ab(+b,6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;g[a+196>>2]=b;i=c;return}function hg(b,c){b=b|0;c=c|0;a[b+21>>0]=c&1;return}function ig(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function jg(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(627)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}Yr(f,5,b);c[f>>2]=1264;k=f+300|0;c[k+0>>2]=c[d+0>>2];c[k+4>>2]=c[d+4>>2];c[k+8>>2]=c[d+8>>2];c[k+12>>2]=c[d+12>>2];j=f+316|0;c[j+0>>2]=c[d+16>>2];c[j+4>>2]=c[d+20>>2];c[j+8>>2]=c[d+24>>2];c[j+12>>2]=c[d+28>>2];h=f+332|0;c[h+0>>2]=c[d+32>>2];c[h+4>>2]=c[d+36>>2];c[h+8>>2]=c[d+40>>2];c[h+12>>2]=c[d+44>>2];b=f+348|0;c[b+0>>2]=c[d+48>>2];c[b+4>>2]=c[d+52>>2];c[b+8>>2]=c[d+56>>2];c[b+12>>2]=c[d+60>>2];b=f+364|0;d=f+524|0;a[f+527>>0]=0;c[b+0>>2]=c[k+0>>2];c[b+4>>2]=c[k+4>>2];c[b+8>>2]=c[k+8>>2];c[b+12>>2]=c[k+12>>2];b=f+380|0;c[b+0>>2]=c[j+0>>2];c[b+4>>2]=c[j+4>>2];c[b+8>>2]=c[j+8>>2];c[b+12>>2]=c[j+12>>2];b=f+396|0;c[b+0>>2]=c[h+0>>2];c[b+4>>2]=c[h+4>>2];c[b+8>>2]=c[h+8>>2];c[b+12>>2]=c[h+12>>2];b=f+412|0;a[d>>0]=0;a[f+525>>0]=0;a[f+526>>0]=0;a[f+552>>0]=0;d=f+572|0;c[b+0>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;g[d>>2]=-1.0;g[f+444>>2]=999999984306749400.0;g[f+448>>2]=999999984306749400.0;g[f+452>>2]=999999984306749400.0;g[f+428>>2]=1.0;g[f+432>>2]=.30000001192092896;g[f+436>>2]=1.0;g[f+440>>2]=.009999999776482582;g[f+456>>2]=.05000000074505806;c[f+592>>2]=0;g[f+596>>2]=0.0;g[f+600>>2]=.699999988079071;g[f+604>>2]=0.0;i=e;return f|0}function kg(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0;h=i;c[5004]=(c[5004]|0)+1;j=fF(627)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}c[j+4>>2]=5;c[j+8>>2]=-1;c[j+12>>2]=-1;g[j+16>>2]=3.4028234663852886e+38;a[j+20>>0]=1;a[j+21>>0]=0;c[j+24>>2]=-1;c[j+28>>2]=b;c[j+32>>2]=d;g[j+36>>2]=0.0;g[j+40>>2]=.30000001192092896;c[j+44>>2]=0;c[j>>2]=1264;d=j+300|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];d=j+316|0;c[d+0>>2]=c[e+16>>2];c[d+4>>2]=c[e+20>>2];c[d+8>>2]=c[e+24>>2];c[d+12>>2]=c[e+28>>2];d=j+332|0;c[d+0>>2]=c[e+32>>2];c[d+4>>2]=c[e+36>>2];c[d+8>>2]=c[e+40>>2];c[d+12>>2]=c[e+44>>2];d=j+348|0;c[d+0>>2]=c[e+48>>2];c[d+4>>2]=c[e+52>>2];c[d+8>>2]=c[e+56>>2];c[d+12>>2]=c[e+60>>2];e=j+364|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];e=j+380|0;c[e+0>>2]=c[f+16>>2];c[e+4>>2]=c[f+20>>2];c[e+8>>2]=c[f+24>>2];c[e+12>>2]=c[f+28>>2];e=j+396|0;c[e+0>>2]=c[f+32>>2];c[e+4>>2]=c[f+36>>2];c[e+8>>2]=c[f+40>>2];c[e+12>>2]=c[f+44>>2];e=j+412|0;c[e+0>>2]=c[f+48>>2];c[e+4>>2]=c[f+52>>2];c[e+8>>2]=c[f+56>>2];c[e+12>>2]=c[f+60>>2];f=j+524|0;a[j+552>>0]=0;a[f>>0]=0;a[f+1>>0]=0;a[f+2>>0]=0;a[f+3>>0]=0;g[j+572>>2]=-1.0;g[j+444>>2]=999999984306749400.0;g[j+448>>2]=999999984306749400.0;g[j+452>>2]=999999984306749400.0;g[j+428>>2]=1.0;g[j+432>>2]=.30000001192092896;g[j+436>>2]=1.0;g[j+440>>2]=.009999999776482582;g[j+456>>2]=.05000000074505806;c[j+592>>2]=0;g[j+596>>2]=0.0;g[j+600>>2]=.699999988079071;g[j+604>>2]=0.0;i=h;return j|0}function lg(a,b,c){a=a|0;b=b|0;c=+c;var d=0;d=i;if((b|0)==4)g[a+448>>2]=c;else if((b|0)==3)g[a+452>>2]=c;else if((b|0)==5)g[a+444>>2]=c;i=d;return}function mg(b,c){b=b|0;c=c|0;a[b+524>>0]=c&1;return}function ng(a,b){a=a|0;b=+b;g[a+440>>2]=b;return}function og(b,c){b=b|0;c=c|0;a[b+552>>0]=c&1;return}function pg(b,c){b=b|0;c=+c;g[b+572>>2]=c;a[b+553>>0]=0;return}function qg(b,c){b=b|0;c=+c;g[b+572>>2]=c;a[b+553>>0]=1;return}function rg(a,b){a=a|0;b=b|0;var c=0,d=0.0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0;c=i;i=i+48|0;Hc(a+364|0,c+16|0);h=-+g[c+16>>2];e=-+g[c+20>>2];m=-+g[c+24>>2];l=+g[c+28>>2];f=+g[b>>2];n=+g[b+12>>2];k=+g[b+8>>2];j=+g[b+4>>2];Hc(a+300|0,c);p=+g[c>>2];q=+g[c+12>>2];d=+g[c+8>>2];o=+g[c+4>>2];g[c+32>>2]=p*(l*n-f*h-j*e-k*m)+(l*f+n*h+k*e-j*m)*q+(f*m+(n*e+l*j)-k*h)*d-(n*m+l*k+j*h-f*e)*o;g[c+36>>2]=p*(n*m+l*k+j*h-f*e)+(q*(f*m+(n*e+l*j)-k*h)+(l*n-f*h-j*e-k*m)*o)-(l*f+n*h+k*e-j*m)*d;g[c+40>>2]=q*(n*m+l*k+j*h-f*e)+(l*n-f*h-j*e-k*m)*d+(l*f+n*h+k*e-j*m)*o-p*(f*m+(n*e+l*j)-k*h);g[c+44>>2]=(l*n-f*h-j*e-k*m)*q-p*(l*f+n*h+k*e-j*m)-(f*m+(n*e+l*j)-k*h)*o-(n*m+l*k+j*h-f*e)*d;Do(a,c+32|0);i=c;return}function sg(a,b){a=a|0;b=b|0;var c=0;c=i;Do(a,b);i=c;return}function tg(b,c){b=b|0;c=c|0;a[b+21>>0]=c&1;return}function ug(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function vg(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(95)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;c[e>>2]=9704;g[e+56>>2]=a;g[e+60>>2]=b;c[e+4>>2]=11;c[e+64>>2]=0;c[e+68>>2]=1;c[e+72>>2]=2;g[e+28>>2]=a;g[e+32>>2]=b;g[e+36>>2]=a;g[e+52>>2]=a/+Q(+(a*a+b*b));i=d;return e|0}function wg(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function xg(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function yg(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function zg(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Ag(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Bg(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Cg(){var a=0,b=0;a=i;i=i+32|0;b=fF(92)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(92)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);c[a>>2]=0;c[a+4>>2]=0;c[a+8>>2]=4096;c[a+12>>2]=4096;c[a+16>>2]=0;c[a+20>>2]=1;zy(b,a);i=a;return b|0}function Dg(a){a=a|0;var b=0,d=0;b=i;d=fF(92)|0;a:do if(!d){while(1){d=c[5158]|0;c[5158]=d+0;if(!d)break;sc[d&3]();d=fF(92)|0;if(d)break a}d=Ab(4)|0;c[d>>2]=20472;yb(d|0,20520,265)}while(0);zy(d,a);i=b;return d|0}function Eg(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Fg(a,b,d,e,f,g,h,j){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;j=j|0;var k=0.0,l=0;l=i;k=+Vb[c[(c[a>>2]|0)+12>>2]&1](a,b,d,e,f,g,h,j);i=l;return+k}function Gg(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Hg(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(95)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;g[e+56>>2]=a;g[e+60>>2]=b;c[e+4>>2]=11;g[e+52>>2]=a/+Q(+(a*a+b*b));c[e>>2]=9808;c[e+64>>2]=0;c[e+68>>2]=2;c[e+72>>2]=1;g[e+28>>2]=a;g[e+36>>2]=b;g[e+32>>2]=a;i=d;return e|0}function Ig(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Jg(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Kg(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Lg(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(95)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;g[e+56>>2]=a;g[e+60>>2]=b;c[e+4>>2]=11;g[e+52>>2]=a/+Q(+(a*a+b*b));c[e>>2]=9912;c[e+64>>2]=1;c[e+68>>2]=0;c[e+72>>2]=2;g[e+32>>2]=a;g[e+28>>2]=b;g[e+36>>2]=a;i=d;return e|0}function Mg(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Ng(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Og(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Pg(){var a=0,b=0;a=i;c[5004]=(c[5004]|0)+1;b=fF(191)|0;if(!b)b=0;else{c[(b+19&-16)+ -4>>2]=b;b=b+19&-16}UB(b,1,1);i=a;return b|0}function Qg(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(191)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}UB(d,a,1);i=b;return d|0}function Rg(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(191)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}UB(e,a,b);i=d;return e|0}function Sg(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;g=c[a+32>>2]|0;c[g>>2]=(c[g>>2]|0)+1;VB(a,WB(a,b,0)|0);VB(a,WB(a,d,0)|0);VB(a,WB(a,e,0)|0);i=f;return}function Tg(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0;g=i;h=c[a+32>>2]|0;c[h>>2]=(c[h>>2]|0)+1;VB(a,WB(a,b,f)|0);VB(a,WB(a,d,f)|0);VB(a,WB(a,e,f)|0);i=g;return}function Ug(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Vg(){var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(131)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[d+8>>2]=0;g[d+12>>2]=1.0;g[d+16>>2]=1.0;g[d+20>>2]=1.0;g[d+24>>2]=0.0;g[d+44>>2]=.03999999910593033;c[d+52>>2]=0;g[d+56>>2]=1.0;g[d+60>>2]=1.0;g[d+64>>2]=1.0;g[d+68>>2]=0.0;g[d+72>>2]=-1.0;g[d+76>>2]=-1.0;g[d+80>>2]=-1.0;g[d+84>>2]=0.0;a[d+88>>0]=0;c[d>>2]=10376;a[d+108>>0]=1;c[d+104>>2]=0;c[d+100>>2]=0;c[d+4>>2]=4;c[d+96>>2]=0;EA(d);i=b;return d|0}function Wg(a,b){a=a|0;b=b|0;var c=0;c=i;Gw(a,b,1);i=c;return}function Xg(a,b,c){a=a|0;b=b|0;c=c|0;var d=0;d=i;Gw(a,b,c);i=d;return}function Yg(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Zg(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function _g(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function $g(){var b=0,d=0,e=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(791)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[d>>2]=1025;c[d+116>>2]=0;a[d+120>>0]=0;e=d+124|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;c[d+300>>2]=0;a[d+304>>0]=0;e=d+308|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;c[d+484>>2]=0;a[d+488>>0]=0;e=d+492|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;c[d+668>>2]=0;a[d+672>>0]=0;e=d+676|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;c[d+740>>2]=0;c[d+744>>2]=0;c[d+748>>2]=0;c[d+768>>2]=0;i=b;return d|0}function ah(a){a=a|0;return c[a+740>>2]|0}function bh(a){a=a|0;return c[a+744>>2]|0}function ch(a){a=a|0;return c[a+748>>2]|0}function dh(a,b){a=a|0;b=b|0;return a+(b*184|0)+4|0}function eh(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function fh(a){a=a|0;var b=0,d=0,e=0,f=0,h=0,j=0,k=0.0,l=0.0,m=0.0,n=0,o=0,p=0.0,q=0,r=0.0;b=i;c[5004]=(c[5004]|0)+1;d=fF(75)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[d+8>>2]=0;h=d+12|0;g[h>>2]=1.0;e=d+16|0;g[e>>2]=1.0;f=d+20|0;g[f>>2]=1.0;g[d+24>>2]=0.0;j=d+44|0;g[j>>2]=.03999999910593033;c[d+52>>2]=0;c[d>>2]=5448;c[d+4>>2]=0;l=+g[a>>2];m=+g[a+4>>2];k=+g[a+8>>2];if(l<m)n=l<k?0:2;else n=m<k?1:2;k=+g[a+(n<<2)>>2]*.10000000149011612;if(k<.03999999910593033){r=+Ts(d);p=+$b[c[(c[d>>2]|0)+48>>2]&15](d);m=+$b[c[(c[d>>2]|0)+48>>2]&15](d);q=d+28|0;r=r+ +g[q>>2];o=d+32|0;p=p+ +g[o>>2];n=d+36|0;m=m+ +g[n>>2];g[j>>2]=k;k=+$b[c[(c[d>>2]|0)+48>>2]&15](d);l=+$b[c[(c[d>>2]|0)+48>>2]&15](d);m=m- +$b[c[(c[d>>2]|0)+48>>2]&15](d);g[q>>2]=r-k;g[o>>2]=p-l;g[n>>2]=m;g[d+40>>2]=0.0;j=c[d>>2]|0}else j=5448|0;m=+$b[c[j+48>>2]&15](d);p=+$b[c[(c[d>>2]|0)+48>>2]&15](d);r=+$b[c[(c[d>>2]|0)+48>>2]&15](d);p=+g[a+4>>2]*+g[e>>2]-p;r=+g[a+8>>2]*+g[f>>2]-r;g[d+28>>2]=+g[a>>2]*+g[h>>2]-m;g[d+32>>2]=p;g[d+36>>2]=r;g[d+40>>2]=0.0;i=b;return d|0}function gh(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function hh(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function ih(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function jh(b){b=b|0;var d=0,e=0,f=0,g=0,h=0;d=i;f=fF(5260)|0;a:do if(!f){while(1){e=c[5158]|0;c[5158]=e+0;if(!e)break;sc[e&3]();f=fF(5260)|0;if(f)break a}g=Ab(4)|0;c[g>>2]=20472;yb(g|0,20520,265)}while(0);c[f>>2]=6808;c[f+4>>2]=2;a[f+24>>0]=1;c[f+20>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;c[f+28>>2]=13504;e=f+5256|0;c[e>>2]=b;c[f+60>>2]=69;c[f+64>>2]=Pb[c[(c[b>>2]|0)+12>>2]&127](b)|0;c[f+68>>2]=Pb[c[(c[b>>2]|0)+8>>2]&127](b)|0;b=0;do{g=0;do{h=c[e>>2]|0;c[f+(b*144|0)+(g<<2)+72>>2]=Yb[c[(c[h>>2]|0)+16>>2]&31](h,b,g)|0;g=g+1|0}while((g|0)<36);b=b+1|0}while((b|0)<36);i=d;return f|0}function kh(a){a=a|0;var b=0;b=i;a=Pb[c[(c[a>>2]|0)+36>>2]&127](a)|0;i=b;return a|0}function lh(a,b){a=a|0;b=b|0;var d=0;d=i;a=gc[c[(c[a>>2]|0)+40>>2]&31](a,b)|0;i=d;return a|0}function mh(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function nh(){var a=0,b=0;a=i;b=fF(24)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(24)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);g[b>>2]=5.880000114440918;g[b+4>>2]=.8299999833106995;g[b+8>>2]=.8799999952316284;g[b+12>>2]=500.0;g[b+16>>2]=10.5;g[b+20>>2]=6.0e3;i=a;return b|0}function oh(a){a=a|0;return+(+g[a>>2])}function ph(a,b){a=a|0;b=+b;g[a>>2]=b;return}function qh(a){a=a|0;return+(+g[a+4>>2])}function rh(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function sh(a){a=a|0;return+(+g[a+8>>2])}function th(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function uh(a){a=a|0;return+(+g[a+12>>2])}function vh(a,b){a=a|0;b=+b;g[a+12>>2]=b;return}function wh(a){a=a|0;return+(+g[a+16>>2])}function xh(a,b){a=a|0;b=+b;g[a+16>>2]=b;return}function yh(a){a=a|0;return+(+g[a+20>>2])}function zh(a,b){a=a|0;b=+b;g[a+20>>2]=b;return}function Ah(){var a=0,b=0;a=i;c[5004]=(c[5004]|0)+1;b=fF(111)|0;if(!b)b=0;else{c[(b+19&-16)+ -4>>2]=b;b=b+19&-16}Ov(b,1);i=a;return b|0}function Bh(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(111)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}Ov(d,a);i=b;return d|0}function Ch(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0,k=0,l=0,m=0,n=0,o=0,p=0.0,q=0,r=0,s=0;j=i;i=i+128|0;c[b+68>>2]=(c[b+68>>2]|0)+1;c[j+0>>2]=c[d+0>>2];c[j+4>>2]=c[d+4>>2];c[j+8>>2]=c[d+8>>2];c[j+12>>2]=c[d+12>>2];c[j+16>>2]=c[d+16>>2];c[j+20>>2]=c[d+20>>2];c[j+24>>2]=c[d+24>>2];c[j+28>>2]=c[d+28>>2];c[j+32>>2]=c[d+32>>2];c[j+36>>2]=c[d+36>>2];c[j+40>>2]=c[d+40>>2];c[j+44>>2]=c[d+44>>2];c[j+48>>2]=c[d+48>>2];c[j+52>>2]=c[d+52>>2];c[j+56>>2]=c[d+56>>2];c[j+60>>2]=c[d+60>>2];f=c[e+4>>2]|0;h=+$b[c[(c[e>>2]|0)+48>>2]&15](e);vc[c[(c[e>>2]|0)+8>>2]&127](e,d,j+112|0,j+96|0);p=+g[j+112>>2];if(+g[b+32>>2]>p)g[b+32>>2]=p;p=+g[j+96>>2];if(+g[b+48>>2]<p)g[b+48>>2]=p;p=+g[j+116>>2];if(+g[b+36>>2]>p)g[b+36>>2]=p;p=+g[j+100>>2];if(+g[b+52>>2]<p)g[b+52>>2]=p;p=+g[j+120>>2];if(+g[b+40>>2]>p)g[b+40>>2]=p;p=+g[j+104>>2];if(+g[b+56>>2]<p)g[b+56>>2]=p;d=c[b+64>>2]|0;if(!d){d=b+16|0;l=0}else{c[j+64>>2]=c[j+112>>2];c[j+68>>2]=c[j+116>>2];c[j+72>>2]=c[j+120>>2];c[j+76>>2]=c[j+124>>2];c[j+80>>2]=c[j+96>>2];c[j+84>>2]=c[j+100>>2];c[j+88>>2]=c[j+104>>2];c[j+92>>2]=c[j+108>>2];m=c[b+16>>2]|0;l=c[d+4>>2]|0;if(!l){c[5004]=(c[5004]|0)+1;o=fF(63)|0;if((o|0)!=0?(c[(o+19&-16)+ -4>>2]=o,(o+19&-16|0)!=0):0){l=(o+19&-16)+0|0;n=l+44|0;do{c[l>>2]=0;l=l+4|0}while((l|0)<(n|0));l=o+19&-16}else l=0}else c[d+4>>2]=0;c[l+32>>2]=0;c[l+36>>2]=m;c[l+40>>2]=0;c[l+0>>2]=c[j+64>>2];c[l+4>>2]=c[j+68>>2];c[l+8>>2]=c[j+72>>2];c[l+12>>2]=c[j+76>>2];c[l+16>>2]=c[j+80>>2];c[l+20>>2]=c[j+84>>2];c[l+24>>2]=c[j+88>>2];c[l+28>>2]=c[j+92>>2];Xx(d,c[d>>2]|0,l);c[d+12>>2]=(c[d+12>>2]|0)+1;d=b+16|0}o=c[d>>2]|0;if((o|0)==(c[b+20>>2]|0)?(k=(o|0)==0?1:o<<1,(o|0)<(k|0)):0){if(!k)m=0;else{c[5004]=(c[5004]|0)+1;m=fF((k*80|3)+16|0)|0;if(!m)m=0;else{c[(m+19&-16)+ -4>>2]=m;m=m+19&-16}o=c[d>>2]|0}if((o|0)>0){n=0;do{q=m+(n*80|0)|0;r=c[b+24>>2]|0;s=r+(n*80|0)|0;c[q+0>>2]=c[s+0>>2];c[q+4>>2]=c[s+4>>2];c[q+8>>2]=c[s+8>>2];c[q+12>>2]=c[s+12>>2];q=m+(n*80|0)+16|0;s=r+(n*80|0)+16|0;c[q+0>>2]=c[s+0>>2];c[q+4>>2]=c[s+4>>2];c[q+8>>2]=c[s+8>>2];c[q+12>>2]=c[s+12>>2];q=m+(n*80|0)+32|0;s=r+(n*80|0)+32|0;c[q+0>>2]=c[s+0>>2];c[q+4>>2]=c[s+4>>2];c[q+8>>2]=c[s+8>>2];c[q+12>>2]=c[s+12>>2];q=m+(n*80|0)+48|0;s=r+(n*80|0)+48|0;c[q+0>>2]=c[s+0>>2];c[q+4>>2]=c[s+4>>2];c[q+8>>2]=c[s+8>>2];c[q+12>>2]=c[s+12>>2];q=m+(n*80|0)+64|0;r=r+(n*80|0)+64|0;c[q+0>>2]=c[r+0>>2];c[q+4>>2]=c[r+4>>2];c[q+8>>2]=c[r+8>>2];c[q+12>>2]=c[r+12>>2];n=n+1|0}while((n|0)!=(o|0))}n=c[b+24>>2]|0;if(n){if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[n+ -4>>2]|0)}c[b+24>>2]=0}a[b+28>>0]=1;c[b+24>>2]=m;c[b+20>>2]=k;o=c[d>>2]|0}s=c[b+24>>2]|0;r=s+(o*80|0)|0;c[r+0>>2]=c[j+0>>2];c[r+4>>2]=c[j+4>>2];c[r+8>>2]=c[j+8>>2];c[r+12>>2]=c[j+12>>2];r=s+(o*80|0)+16|0;c[r+0>>2]=c[j+16>>2];c[r+4>>2]=c[j+20>>2];c[r+8>>2]=c[j+24>>2];c[r+12>>2]=c[j+28>>2];r=s+(o*80|0)+32|0;c[r+0>>2]=c[j+32>>2];c[r+4>>2]=c[j+36>>2];c[r+8>>2]=c[j+40>>2];c[r+12>>2]=c[j+44>>2];r=s+(o*80|0)+48|0;c[r+0>>2]=c[j+48>>2];c[r+4>>2]=c[j+52>>2];c[r+8>>2]=c[j+56>>2];c[r+12>>2]=c[j+60>>2];s=s+(o*80|0)+64|0;c[s>>2]=e;c[s+4>>2]=f;g[s+8>>2]=h;c[s+12>>2]=l;c[d>>2]=(c[d>>2]|0)+1;i=j;return}function Dh(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Eh(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Fh(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Gh(a,d){a=a|0;d=d|0;var e=0,f=0,h=0;e=i;f=fF(80)|0;a:do if(!f){while(1){f=c[5158]|0;c[5158]=f+0;if(!f)break;sc[f&3]();f=fF(80)|0;if(f)break a}f=Ab(4)|0;c[f>>2]=20472;yb(f|0,20520,265)}while(0);g[f+4>>2]=1.0;b[f+8>>1]=1;b[f+10>>1]=-1;c[f>>2]=688;h=f+12|0;c[h+0>>2]=c[a+0>>2];c[h+4>>2]=c[a+4>>2];c[h+8>>2]=c[a+8>>2];c[h+12>>2]=c[a+12>>2];a=f+28|0;c[a+0>>2]=c[d+0>>2];c[a+4>>2]=c[d+4>>2];c[a+8>>2]=c[d+8>>2];c[a+12>>2]=c[d+12>>2];c[f+76>>2]=0;i=e;return f|0}function Hh(a){a=a|0;return+g[a+4>>2]<1.0|0}function Ih(a){a=a|0;return a+12|0}function Jh(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+12>>2]=c[b+0>>2];c[a+16>>2]=c[b+4>>2];c[a+20>>2]=c[b+8>>2];c[a+24>>2]=c[b+12>>2];i=d;return}function Kh(a){a=a|0;return a+28|0}function Lh(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+28>>2]=c[b+0>>2];c[a+32>>2]=c[b+4>>2];c[a+36>>2]=c[b+8>>2];c[a+40>>2]=c[b+12>>2];i=d;return}function Mh(a){a=a|0;return a+44|0}function Nh(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+44>>2]=c[b+0>>2];c[a+48>>2]=c[b+4>>2];c[a+52>>2]=c[b+8>>2];c[a+56>>2]=c[b+12>>2];i=d;return}function Oh(a){a=a|0;return a+60|0}function Ph(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+60>>2]=c[b+0>>2];c[a+64>>2]=c[b+4>>2];c[a+68>>2]=c[b+8>>2];c[a+72>>2]=c[b+12>>2];i=d;return}function Qh(a){a=a|0;return b[a+8>>1]|0}function Rh(a,c){a=a|0;c=c|0;b[a+8>>1]=c;return}function Sh(a){a=a|0;return b[a+10>>1]|0}function Th(a,c){a=a|0;c=c|0;b[a+10>>1]=c;return}function Uh(a){a=a|0;return+(+g[a+4>>2])}function Vh(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function Wh(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Xh(){var a=0,b=0;a=i;c[5004]=(c[5004]|0)+1;b=fF(219)|0;if(!b)b=0;else{c[(b+19&-16)+ -4>>2]=b;b=b+19&-16}Zh();Zh();Yh(b,464,464);i=a;return b|0}function Yh(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;e=i;c[a>>2]=600;f=a+4|0;do f=f+16|0;while((f|0)!=(a+52|0));c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];f=a+68|0;do f=f+16|0;while((f|0)!=(a+116|0));c[a+68>>2]=c[d+0>>2];c[a+72>>2]=c[d+4>>2];c[a+76>>2]=c[d+8>>2];c[a+80>>2]=c[d+12>>2];c[a+84>>2]=c[d+16>>2];c[a+88>>2]=c[d+20>>2];c[a+92>>2]=c[d+24>>2];c[a+96>>2]=c[d+28>>2];c[a+100>>2]=c[d+32>>2];c[a+104>>2]=c[d+36>>2];c[a+108>>2]=c[d+40>>2];c[a+112>>2]=c[d+44>>2];c[a+116>>2]=c[d+48>>2];c[a+120>>2]=c[d+52>>2];c[a+124>>2]=c[d+56>>2];c[a+128>>2]=c[d+60>>2];d=a+132|0;do d=d+16|0;while((d|0)!=(a+180|0));c[a+132>>2]=c[b+0>>2];c[a+136>>2]=c[b+4>>2];c[a+140>>2]=c[b+8>>2];c[a+144>>2]=c[b+12>>2];c[a+148>>2]=c[b+16>>2];c[a+152>>2]=c[b+20>>2];c[a+156>>2]=c[b+24>>2];c[a+160>>2]=c[b+28>>2];c[a+164>>2]=c[b+32>>2];c[a+168>>2]=c[b+36>>2];c[a+172>>2]=c[b+40>>2];c[a+176>>2]=c[b+44>>2];c[a+180>>2]=c[b+48>>2];c[a+184>>2]=c[b+52>>2];c[a+188>>2]=c[b+56>>2];c[a+192>>2]=c[b+60>>2];c[a+196>>2]=0;i=e;return}function Zh(){var b=0,d=0;b=i;i=i+48|0;if(a[528]|0){i=b;return}if(!(Ya(528)|0)){i=b;return}if((a[584]|0)==0?(Ya(584)|0)!=0:0){g[b+32>>2]=1.0;g[b+28>>2]=0.0;g[b+24>>2]=0.0;g[b+20>>2]=0.0;g[b+16>>2]=1.0;g[b+12>>2]=0.0;g[b+8>>2]=0.0;g[b+4>>2]=0.0;g[b>>2]=1.0;io(536,b+32|0,b+28|0,b+24|0,b+20|0,b+16|0,b+12|0,b+8|0,b+4|0,b);bb(584);d=464}else d=464;do d=d+16|0;while((d|0)!=512);c[116]=c[134];c[117]=c[135];c[118]=c[136];c[119]=c[137];c[120]=c[138];c[121]=c[139];c[122]=c[140];c[123]=c[141];c[124]=c[142];c[125]=c[143];c[126]=c[144];c[127]=c[145];c[128]=0;c[129]=0;c[130]=0;c[131]=0;bb(528);i=b;return}function _h(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(219)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}Zh();Yh(d,a,464);i=b;return d|0}function $h(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(219)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}Yh(e,a,b);i=d;return e|0}function ai(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+8>>2]&127](a,b);i=d;return}function bi(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function ci(a){a=a|0;return a+4|0}function di(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];i=d;return}function ei(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function fi(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function gi(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function hi(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function ii(a){a=a|0;var b=0;b=i;a=Pb[c[(c[a>>2]|0)+36>>2]&127](a)|0;i=b;return a|0}function ji(a,b){a=a|0;b=b|0;var d=0;d=i;a=gc[c[(c[a>>2]|0)+40>>2]&31](a,b)|0;i=d;return a|0}function ki(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function li(a,d){a=a|0;d=d|0;var e=0,f=0,h=0;e=i;f=fF(84)|0;a:do if(!f){while(1){f=c[5158]|0;c[5158]=f+0;if(!f)break;sc[f&3]();f=fF(84)|0;if(f)break a}f=Ab(4)|0;c[f>>2]=20472;yb(f|0,20520,265)}while(0);g[f+4>>2]=1.0;c[f+8>>2]=0;b[f+12>>1]=1;b[f+14>>1]=-1;c[f+16>>2]=0;c[f>>2]=336;h=f+20|0;c[h+0>>2]=c[a+0>>2];c[h+4>>2]=c[a+4>>2];c[h+8>>2]=c[a+8>>2];c[h+12>>2]=c[a+12>>2];a=f+36|0;c[a+0>>2]=c[d+0>>2];c[a+4>>2]=c[d+4>>2];c[a+8>>2]=c[d+8>>2];c[a+12>>2]=c[d+12>>2];i=e;return f|0}function mi(a){a=a|0;return(c[a+8>>2]|0)!=0|0}function ni(a){a=a|0;return a+20|0}function oi(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+20>>2]=c[b+0>>2];c[a+24>>2]=c[b+4>>2];c[a+28>>2]=c[b+8>>2];c[a+32>>2]=c[b+12>>2];i=d;return}function pi(a){a=a|0;return a+36|0}function qi(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+36>>2]=c[b+0>>2];c[a+40>>2]=c[b+4>>2];c[a+44>>2]=c[b+8>>2];c[a+48>>2]=c[b+12>>2];i=d;return}function ri(a){a=a|0;return a+52|0}function si(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+52>>2]=c[b+0>>2];c[a+56>>2]=c[b+4>>2];c[a+60>>2]=c[b+8>>2];c[a+64>>2]=c[b+12>>2];i=d;return}function ti(a){a=a|0;return a+68|0}function ui(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+68>>2]=c[b+0>>2];c[a+72>>2]=c[b+4>>2];c[a+76>>2]=c[b+8>>2];c[a+80>>2]=c[b+12>>2];i=d;return}function vi(a){a=a|0;return b[a+12>>1]|0}function wi(a,c){a=a|0;c=c|0;b[a+12>>1]=c;return}function xi(a){a=a|0;return b[a+14>>1]|0}function yi(a,c){a=a|0;c=c|0;b[a+14>>1]=c;return}function zi(a){a=a|0;return c[a+8>>2]|0}function Ai(a,b){a=a|0;b=b|0;c[a+8>>2]=b;return}function Bi(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Ci(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+64>>2]&127](a,b);i=d;return}function Di(a){a=a|0;return c[a+24>>2]|0}function Ei(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+32>>2]&127](a,b,d,e);i=f;return}function Fi(a){a=a|0;var b=0;b=i;a=c[a+68>>2]|0;a=Pb[c[(c[a>>2]|0)+36>>2]&127](a)|0;i=b;return a|0}function Gi(a){a=a|0;return a+28|0}function Hi(a,b){a=a|0;b=b|0;var d=0;d=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,1,-1);i=d;return}function Ii(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,-1);i=e;return}function Ji(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,e);i=f;return}function Ki(a){a=a|0;return c[a+68>>2]|0}function Li(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;var g=0;g=i;Ou(a,b,c,d,e,f);i=g;return}function Mi(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=i;Qu(a,b,c,d);i=e;return}function Ni(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Oi(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(75)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;c[e+4>>2]=10;c[e>>2]=6400;c[e+52>>2]=0;g[e+28>>2]=b*.5;g[e+32>>2]=a;g[e+36>>2]=a;g[e+40>>2]=0.0;i=d;return e|0}function Pi(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Qi(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Ri(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Si(a,b,d,e){a=+a;b=+b;d=+d;e=+e;var f=0,h=0;f=i;h=fF(16)|0;a:do if(!h){while(1){h=c[5158]|0;c[5158]=h+0;if(!h)break;sc[h&3]();h=fF(16)|0;if(h)break a}h=Ab(4)|0;c[h>>2]=20472;yb(h|0,20520,265)}while(0);g[h>>2]=a;g[h+4>>2]=b;g[h+8>>2]=d;g[h+12>>2]=e;i=f;return h|0}function Ti(a,b,c,d,e){a=a|0;b=+b;c=+c;d=+d;e=+e;g[a>>2]=b;g[a+4>>2]=c;g[a+8>>2]=d;g[a+12>>2]=e;return}function Ui(a){a=a|0;return+(+g[a>>2])}function Vi(a){a=a|0;return+(+g[a+4>>2])}function Wi(a){a=a|0;return+(+g[a+8>>2])}function Xi(a){a=a|0;return+(+g[a+12>>2])}function Yi(a,b){a=a|0;b=+b;g[a>>2]=b;return}function Zi(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function _i(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function $i(a,b){a=a|0;b=+b;g[a+12>>2]=b;return}function aj(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function bj(a,b){a=+a;b=+b;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(75)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+8>>2]=0;g[e+12>>2]=1.0;g[e+16>>2]=1.0;g[e+20>>2]=1.0;g[e+24>>2]=0.0;g[e+44>>2]=.03999999910593033;c[e+4>>2]=10;c[e>>2]=6504;c[e+52>>2]=2;g[e+28>>2]=a;g[e+32>>2]=a;g[e+36>>2]=b*.5;g[e+40>>2]=0.0;i=d;return e|0}function cj(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function dj(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function ej(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function fj(a){a=a|0;var b=0,d=0;b=i;d=fF(8)|0;a:do if(!d){while(1){d=c[5158]|0;c[5158]=d+0;if(!d)break;sc[d&3]();d=fF(8)|0;if(d)break a}d=Ab(4)|0;c[d>>2]=20472;yb(d|0,20520,265)}while(0);c[d>>2]=3832;c[d+4>>2]=a;i=b;return d|0}function gj(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function hj(a){a=a|0;return(c[a+8>>2]|0)!=0|0}function ij(a){a=a|0;return b[a+12>>1]|0}function jj(a,c){a=a|0;c=c|0;b[a+12>>1]=c;return}function kj(a){a=a|0;return b[a+14>>1]|0}function lj(a,c){a=a|0;c=c|0;b[a+14>>1]=c;return}function mj(a){a=a|0;return c[a+8>>2]|0}function nj(a,b){a=a|0;b=b|0;c[a+8>>2]=b;return}function oj(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function pj(a){a=a|0;return+(+g[a+216>>2])}function qj(a,b){a=a|0;b=+b;g[a+216>>2]=b;return}function rj(a){a=a|0;return+(+g[a+228>>2])}function sj(a,b){a=a|0;b=+b;g[a+228>>2]=b;return}function tj(a){a=a|0;return+(+g[a+244>>2])}function uj(a,b){a=a|0;b=+b;g[a+244>>2]=b;return}function vj(a){a=a|0;return+(+g[a+204>>2])}function wj(a,b){a=a|0;b=+b;g[a+204>>2]=b;return}function xj(a){a=a|0;return+(+g[a+212>>2])}function yj(a,b){a=a|0;b=+b;g[a+212>>2]=b;return}function zj(a){a=a|0;return+(+g[a+220>>2])}function Aj(a,b){a=a|0;b=+b;g[a+220>>2]=b;return}function Bj(a){a=a|0;return+(+g[a+224>>2])}function Cj(a,b){a=a|0;b=+b;g[a+224>>2]=b;return}function Dj(a){a=a|0;return+(+g[a+232>>2])}function Ej(a,b){a=a|0;b=+b;g[a+232>>2]=b;return}function Fj(a){a=a|0;return+(+g[a+248>>2])}function Gj(a,b){a=a|0;b=+b;g[a+248>>2]=b;return}function Hj(a){a=a|0;return+(+g[a+208>>2])}function Ij(a,b){a=a|0;b=+b;g[a+208>>2]=b;return}function Jj(b){b=b|0;return(a[b+260>>0]&1)!=0|0}function Kj(b,c){b=b|0;c=c|0;a[b+260>>0]=c&1;return}function Lj(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Mj(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Nj(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Oj(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Pj(){var a=0,b=0;a=i;c[5004]=(c[5004]|0)+1;b=fF(35)|0;if(!b){b=0;i=a;return b|0}c[(b+19&-16)+ -4>>2]=b;b=b+19&-16;i=a;return b|0}function Qj(a,b,d,e){a=+a;b=+b;d=+d;e=+e;var f=0,h=0;f=i;c[5004]=(c[5004]|0)+1;h=fF(35)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}g[h>>2]=a;g[h+4>>2]=b;g[h+8>>2]=d;g[h+12>>2]=e;i=f;return h|0}function Rj(a){a=a|0;return+(+g[a+12>>2])}function Sj(a,b,c,d,e){a=a|0;b=+b;c=+c;d=+d;e=+e;g[a>>2]=b;g[a+4>>2]=c;g[a+8>>2]=d;g[a+12>>2]=e;return}function Tj(a){a=a|0;var b=0.0,c=0.0,d=0.0;d=+g[a>>2];c=+g[a+4>>2];b=+g[a+8>>2];b=+Q(+(d*d+c*c+b*b));return+b}function Uj(a){a=a|0;return+(+g[a>>2])}function Vj(a){a=a|0;return+(+g[a+4>>2])}function Wj(a){a=a|0;return+(+g[a+8>>2])}function Xj(a,b){a=a|0;b=+b;g[a>>2]=b;return}function Yj(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function Zj(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function _j(a,b){a=a|0;b=+b;g[a>>2]=+g[a>>2]*b;g[a+4>>2]=+g[a+4>>2]*b;g[a+8>>2]=+g[a+8>>2]*b;return a|0}function $j(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function ak(b,d,e){b=b|0;d=d|0;e=+e;var f=0,h=0,j=0,k=0;f=i;c[5004]=(c[5004]|0)+1;h=fF(203)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}c[h>>2]=2632;a[h+144>>0]=1;c[h+140>>2]=0;c[h+132>>2]=0;c[h+136>>2]=0;c[h+176>>2]=1;g[h+56>>2]=.019999999552965164;k=h+60|0;j=h+170|0;c[k+0>>2]=0;c[k+4>>2]=0;c[k+8>>2]=0;c[k+12>>2]=0;a[j>>0]=1;c[h+8>>2]=b;g[h+52>>2]=e;g[h+48>>2]=0.0;c[h+12>>2]=d;a[h+171>>0]=1;g[h+172>>2]=0.0;g[h+16>>2]=0.0;g[h+20>>2]=0.0;g[h+44>>2]=29.399999618530273;g[h+24>>2]=55.0;g[h+28>>2]=10.0;a[h+168>>0]=0;a[h+169>>0]=0;a[h+180>>0]=1;g[h+36>>2]=.7853981852531433;g[h+40>>2]=.7071067690849304;g[h+108>>2]=0.0;a[h+181>>0]=0;a[h+182>>0]=0;i=f;return h|0}function bk(b,d,e,f){b=b|0;d=d|0;e=+e;f=f|0;var h=0,j=0,k=0;h=i;c[5004]=(c[5004]|0)+1;j=fF(203)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}c[j>>2]=2632;a[j+144>>0]=1;c[j+140>>2]=0;c[j+132>>2]=0;c[j+136>>2]=0;c[j+176>>2]=f;g[j+56>>2]=.019999999552965164;k=j+60|0;f=j+170|0;c[k+0>>2]=0;c[k+4>>2]=0;c[k+8>>2]=0;c[k+12>>2]=0;a[f>>0]=1;c[j+8>>2]=b;g[j+52>>2]=e;g[j+48>>2]=0.0;c[j+12>>2]=d;a[j+171>>0]=1;g[j+172>>2]=0.0;g[j+16>>2]=0.0;g[j+20>>2]=0.0;g[j+44>>2]=29.399999618530273;g[j+24>>2]=55.0;g[j+28>>2]=10.0;a[j+168>>0]=0;a[j+169>>0]=0;a[j+180>>0]=1;g[j+36>>2]=.7853981852531433;g[j+40>>2]=.7071067690849304;g[j+108>>2]=0.0;a[j+181>>0]=0;a[j+182>>0]=0;i=h;return j|0}function ck(a,b){a=a|0;b=b|0;if((b|0)<0)b=0;else b=(b|0)>2?2:b;c[a+176>>2]=b;return}function dk(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+16>>2]&127](a,b);i=d;return}function ek(a,b,d){a=a|0;b=b|0;d=+d;var e=0;e=i;tc[c[(c[a>>2]|0)+20>>2]&7](a,b,d);i=e;return}function fk(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+28>>2]&127](a,b);i=d;return}function gk(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+32>>2]&127](a,b);i=d;return}function hk(a,b,d){a=a|0;b=b|0;d=+d;var e=0;e=i;tc[c[(c[a>>2]|0)+36>>2]&7](a,b,d);i=e;return}function ik(a,b){a=a|0;b=+b;g[a+24>>2]=b;return}function jk(a,b){a=a|0;b=+b;g[a+28>>2]=b;return}function kk(a,b){a=a|0;b=+b;g[a+32>>2]=b;return}function lk(a){a=a|0;var b=0;b=i;a=Pb[c[(c[a>>2]|0)+40>>2]&127](a)|0;i=b;return a|0}function mk(a){a=a|0;var b=0;b=i;Lb[c[(c[a>>2]|0)+44>>2]&511](a);i=b;return}function nk(a,b){a=a|0;b=+b;g[a+44>>2]=b;return}function ok(a){a=a|0;return+(+g[a+44>>2])}function pk(a,b){a=a|0;b=+b;g[a+36>>2]=b;g[a+40>>2]=+S(+b);return}function qk(a){a=a|0;return+(+g[a+36>>2])}function rk(a){a=a|0;return c[a+8>>2]|0}function sk(b,c){b=b|0;c=c|0;a[b+170>>0]=c&1;return}function tk(a){a=a|0;var b=0;b=i;a=Pb[c[(c[a>>2]|0)+48>>2]&127](a)|0;i=b;return a|0}function uk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function vk(a,b){a=a|0;b=+b;var d=0,e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;d=i;c[5004]=(c[5004]|0)+1;e=fF(103)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}f=e+4|0;c[f>>2]=35;c[e+8>>2]=0;g[e+12>>2]=0.0;c[e>>2]=16992;m=+g[a>>2];l=+g[a+4>>2];k=+g[a+8>>2];h=+g[a+12>>2];j=1.0/+Q(+(m*m+l*l+k*k));g[e+48>>2]=m*j;g[e+52>>2]=l*j;g[e+56>>2]=k*j;g[e+60>>2]=h;g[e+64>>2]=b;a=e+68|0;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;c[f>>2]=28;i=d;return e|0}function wk(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function xk(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function yk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function zk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Ak(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+60>>2]&127](a,b);i=d;return}function Bk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Ck(){var a=0,b=0;a=i;c[5004]=(c[5004]|0)+1;b=fF(35)|0;if(!b){b=0;i=a;return b|0}c[(b+19&-16)+ -4>>2]=b;b=b+19&-16;i=a;return b|0}function Dk(a,b,d){a=+a;b=+b;d=+d;var e=0,f=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(35)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}g[f>>2]=a;g[f+4>>2]=b;g[f+8>>2]=d;g[f+12>>2]=0.0;i=e;return f|0}function Ek(a){a=a|0;var b=0.0,c=0.0,d=0.0;d=+g[a>>2];c=+g[a+4>>2];b=+g[a+8>>2];b=+Q(+(d*d+c*c+b*b));return+b}function Fk(a){a=a|0;return+(+g[a>>2])}function Gk(a){a=a|0;return+(+g[a+4>>2])}function Hk(a){a=a|0;return+(+g[a+8>>2])}function Ik(a,b){a=a|0;b=+b;g[a>>2]=b;return}function Jk(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function Kk(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function Lk(a,b,c,d){a=a|0;b=+b;c=+c;d=+d;g[a>>2]=b;g[a+4>>2]=c;g[a+8>>2]=d;g[a+12>>2]=0.0;return}function Mk(a,b){a=a|0;b=+b;g[a>>2]=+g[a>>2]*b;g[a+4>>2]=+g[a+4>>2]*b;g[a+8>>2]=+g[a+8>>2]*b;return a|0}function Nk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Ok(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Pk(a){a=+a;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(71)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[d+8>>2]=0;g[d+12>>2]=1.0;g[d+16>>2]=1.0;g[d+20>>2]=1.0;g[d+24>>2]=0.0;c[d>>2]=16680;c[d+4>>2]=8;g[d+28>>2]=a;g[d+44>>2]=a;i=b;return d|0}function Qk(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function Rk(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Sk(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Tk(){var a=0,b=0;a=i;b=fF(24)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(24)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);c[b>>2]=0;c[b+4>>2]=0;c[b+8>>2]=4096;c[b+12>>2]=4096;c[b+16>>2]=0;c[b+20>>2]=1;i=a;return b|0}function Uk(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Vk(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(783)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}lq(e,a,b,0);i=d;return e|0}function Wk(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;e=i;c[5004]=(c[5004]|0)+1;f=fF(783)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}lq(f,a,b,d);i=e;return f|0}function Xk(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0;h=i;c[5004]=(c[5004]|0)+1;j=fF(783)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}c[j+4>>2]=4;c[j+8>>2]=-1;c[j+12>>2]=-1;g[j+16>>2]=3.4028234663852886e+38;a[j+20>>0]=1;a[j+21>>0]=0;c[j+24>>2]=-1;c[j+28>>2]=b;c[j+32>>2]=d;g[j+36>>2]=0.0;g[j+40>>2]=.30000001192092896;c[j+44>>2]=0;c[j>>2]=2504;d=j+552|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];d=j+568|0;c[d+0>>2]=c[e+16>>2];c[d+4>>2]=c[e+20>>2];c[d+8>>2]=c[e+24>>2];c[d+12>>2]=c[e+28>>2];d=j+584|0;c[d+0>>2]=c[e+32>>2];c[d+4>>2]=c[e+36>>2];c[d+8>>2]=c[e+40>>2];c[d+12>>2]=c[e+44>>2];d=j+600|0;c[d+0>>2]=c[e+48>>2];c[d+4>>2]=c[e+52>>2];c[d+8>>2]=c[e+56>>2];c[d+12>>2]=c[e+60>>2];e=j+616|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];e=j+632|0;c[e+0>>2]=c[f+16>>2];c[e+4>>2]=c[f+20>>2];c[e+8>>2]=c[f+24>>2];c[e+12>>2]=c[f+28>>2];e=j+648|0;c[e+0>>2]=c[f+32>>2];c[e+4>>2]=c[f+36>>2];c[e+8>>2]=c[f+40>>2];c[e+12>>2]=c[f+44>>2];e=j+664|0;c[e+0>>2]=c[f+48>>2];c[e+4>>2]=c[f+52>>2];c[e+8>>2]=c[f+56>>2];c[e+12>>2]=c[f+60>>2];g[j+688>>2]=0.0;g[j+692>>2]=-1.0;g[j+696>>2]=.8999999761581421;g[j+700>>2]=.30000001192092896;g[j+704>>2]=1.0;g[j+708>>2]=0.0;g[j+712>>2]=0.0;a[j+716>>0]=0;a[j+736>>0]=0;a[j+737>>0]=0;a[j+738>>0]=0;a[j+739>>0]=1;a[j+740>>0]=0;c[j+748>>2]=0;g[j+732>>2]=1.0;i=h;return j|0}function Yk(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0;j=i;c[5004]=(c[5004]|0)+1;k=fF(783)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}c[k+4>>2]=4;c[k+8>>2]=-1;c[k+12>>2]=-1;g[k+16>>2]=3.4028234663852886e+38;a[k+20>>0]=1;a[k+21>>0]=0;c[k+24>>2]=-1;c[k+28>>2]=b;c[k+32>>2]=d;g[k+36>>2]=0.0;g[k+40>>2]=.30000001192092896;c[k+44>>2]=0;c[k>>2]=2504;d=k+552|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];d=k+568|0;c[d+0>>2]=c[e+16>>2];c[d+4>>2]=c[e+20>>2];c[d+8>>2]=c[e+24>>2];c[d+12>>2]=c[e+28>>2];d=k+584|0;c[d+0>>2]=c[e+32>>2];c[d+4>>2]=c[e+36>>2];c[d+8>>2]=c[e+40>>2];c[d+12>>2]=c[e+44>>2];d=k+600|0;c[d+0>>2]=c[e+48>>2];c[d+4>>2]=c[e+52>>2];c[d+8>>2]=c[e+56>>2];c[d+12>>2]=c[e+60>>2];e=k+616|0;c[e+0>>2]=c[f+0>>2];c[e+4>>2]=c[f+4>>2];c[e+8>>2]=c[f+8>>2];c[e+12>>2]=c[f+12>>2];e=k+632|0;c[e+0>>2]=c[f+16>>2];c[e+4>>2]=c[f+20>>2];c[e+8>>2]=c[f+24>>2];c[e+12>>2]=c[f+28>>2];e=k+648|0;c[e+0>>2]=c[f+32>>2];c[e+4>>2]=c[f+36>>2];c[e+8>>2]=c[f+40>>2];c[e+12>>2]=c[f+44>>2];e=k+664|0;c[e+0>>2]=c[f+48>>2];c[e+4>>2]=c[f+52>>2];c[e+8>>2]=c[f+56>>2];c[e+12>>2]=c[f+60>>2];g[k+688>>2]=0.0;g[k+692>>2]=-1.0;g[k+696>>2]=.8999999761581421;g[k+700>>2]=.30000001192092896;g[k+704>>2]=1.0;g[k+708>>2]=0.0;g[k+712>>2]=0.0;a[k+716>>0]=0;a[k+736>>0]=0;a[k+737>>0]=0;a[k+738>>0]=0;a[k+739>>0]=1;a[k+740>>0]=h&1;c[k+748>>2]=0;g[k+732>>2]=h?-1.0:1.0;i=j;return k|0}function Zk(a,b,d,e,f,g){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0,j=0;h=i;c[5004]=(c[5004]|0)+1;j=fF(783)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}kq(j,a,b,d,e,f,g,0);i=h;return j|0}function _k(a,b,d,e,f,g,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;var j=0,k=0;j=i;c[5004]=(c[5004]|0)+1;k=fF(783)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}kq(k,a,b,d,e,f,g,h);i=j;return k|0}function $k(a,b,c,d,e){a=a|0;b=+b;c=+c;d=+d;e=+e;var f=0;f=i;g[a+692>>2]=(c-b)*.5;b=+ab(+((c-b)*.5+b),6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;g[a+688>>2]=b;g[a+696>>2]=d;g[a+700>>2]=e;g[a+704>>2]=1.0;i=f;return}function al(a,b,c,d,e,f){a=a|0;b=+b;c=+c;d=+d;e=+e;f=+f;var h=0;h=i;g[a+692>>2]=(c-b)*.5;b=+ab(+((c-b)*.5+b),6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;g[a+688>>2]=b;g[a+696>>2]=d;g[a+700>>2]=e;g[a+704>>2]=f;i=h;return}function bl(b,c){b=b|0;c=c|0;a[b+21>>0]=c&1;return}function cl(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function dl(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function el(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function fl(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function gl(){var a=0,b=0;a=i;b=fF(12)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(12)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);g[b>>2]=.30000001192092896;g[b+4>>2]=1.0;g[b+8>>2]=0.0;i=a;return b|0}function hl(a){a=a|0;return+(+g[a>>2])}function il(a,b){a=a|0;b=+b;g[a>>2]=b;return}function jl(a){a=a|0;return+(+g[a+4>>2])}function kl(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function ll(a){a=a|0;return+(+g[a+8>>2])}function ml(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function nl(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function ol(){var b=0,d=0,e=0,f=0,h=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(303)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}g[d+164>>2]=1.0;g[d+168>>2]=1.0;g[d+172>>2]=1.0;g[d+176>>2]=0.0;c[d+180>>2]=0;g[d+184>>2]=999999984306749400.0;h=d+188|0;e=d+204|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;c[e>>2]=1;c[d+208>>2]=-1;c[d+212>>2]=-1;c[d+216>>2]=1;g[d+220>>2]=0.0;g[d+224>>2]=.5;g[d+228>>2]=0.0;g[d+232>>2]=0.0;e=d+236|0;c[d+240>>2]=0;g[d+244>>2]=1.0;h=d+248|0;f=d+4|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=d+8|0;h=d+24|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;g[h>>2]=1.0;h=d+28|0;f=d+44|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=d+48|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;c[d>>2]=13008;a[d+280>>0]=1;c[d+276>>2]=0;c[d+268>>2]=0;c[d+272>>2]=0;c[e>>2]=4;i=b;return d|0}function pl(a){a=a|0;return c[a+268>>2]|0}function ql(a,b){a=a|0;b=b|0;return c[(c[a+276>>2]|0)+(b<<2)>>2]|0}function rl(a){a=a|0;return c[a+192>>2]|0}function sl(a,b){a=a|0;b=+b;g[a+184>>2]=b;return}function tl(a,b){a=a|0;b=b|0;var d=0;d=i;if(((c[a+216>>2]|0)+ -4|0)>>>0<2){i=d;return}c[a+216>>2]=b;i=d;return}function ul(a,b){a=a|0;b=b|0;c[a+216>>2]=b;return}function vl(a){a=a|0;var b=0;b=i;if(c[a+204>>2]&3){i=b;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=b;return}function wl(a,b){a=a|0;b=b|0;var d=0;d=i;if(!b?(c[a+204>>2]&3|0)!=0:0){i=d;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=d;return}function xl(a){a=a|0;a=c[a+216>>2]|0;return((a|0)==2?0:(a|0)!=5)|0}function yl(a){a=a|0;return(c[a+204>>2]&2|0)!=0|0}function zl(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+228>>2]=b;return}function Al(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+224>>2]=b;return}function Bl(a){a=a|0;return a+4|0}function Cl(a){a=a|0;return c[a+204>>2]|0}function Dl(a,b){a=a|0;b=b|0;c[a+204>>2]=b;return}function El(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];i=d;return}function Fl(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function Gl(a,b){a=a|0;b=+b;g[a+252>>2]=b;return}function Hl(a,b){a=a|0;b=+b;g[a+248>>2]=b;return}function Il(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+8>>2]&511](a);i=b;return}function Jl(a){a=a|0;return c[a>>2]|0}function Kl(a,b){a=a|0;b=b|0;c[a>>2]=b;return}function Ll(a){a=a|0;return c[a+4>>2]|0}function Ml(a,b){a=a|0;b=b|0;c[a+4>>2]=b;return}function Nl(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Ol(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Pl(b,d,e){b=b|0;d=d|0;e=e|0;var f=0;b=i;f=fF(152)|0;a:do if(!f){while(1){f=c[5158]|0;c[5158]=f+0;if(!f)break;sc[f&3]();f=fF(152)|0;if(f)break a}f=Ab(4)|0;c[f>>2]=20472;yb(f|0,20520,265)}while(0);c[f>>2]=3752;a[f+20>>0]=1;c[f+16>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;a[f+40>>0]=1;c[f+36>>2]=0;c[f+28>>2]=0;c[f+32>>2]=0;a[f+60>>0]=1;c[f+56>>2]=0;c[f+48>>2]=0;c[f+52>>2]=0;a[f+80>>0]=1;c[f+76>>2]=0;c[f+68>>2]=0;c[f+72>>2]=0;c[f+100>>2]=e;g[f+104>>2]=0.0;a[f+148>>0]=1;c[f+144>>2]=0;c[f+136>>2]=0;c[f+140>>2]=0;c[f+116>>2]=d;c[f+120>>2]=0;c[f+124>>2]=2;c[f+128>>2]=1;g[f+112>>2]=0.0;g[f+108>>2]=0.0;i=b;return f|0}function Ql(a,b,d){a=a|0;b=+b;d=d|0;g[(c[a+144>>2]|0)+(d*284|0)+252>>2]=b;return}function Rl(a,b,d){a=a|0;b=+b;d=d|0;g[(c[a+144>>2]|0)+(d*284|0)+232>>2]=b;return}function Sl(a,b){a=a|0;b=b|0;return(c[a+144>>2]|0)+(b*284|0)+92|0}function Tl(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;$q(c[a+116>>2]|0,c[a+144>>2]|0,b,d);i=e;return}function Ul(b,d,e,f,h,j,k,l){b=b|0;d=d|0;e=e|0;f=f|0;h=+h;j=+j;k=k|0;l=l|0;var m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0,t=0.0,u=0,v=0,w=0;m=i;i=i+288|0;c[m+144>>2]=c[d+0>>2];c[m+148>>2]=c[d+4>>2];c[m+152>>2]=c[d+8>>2];c[m+156>>2]=c[d+12>>2];w=m+160|0;c[w+0>>2]=c[e+0>>2];c[w+4>>2]=c[e+4>>2];c[w+8>>2]=c[e+8>>2];c[w+12>>2]=c[e+12>>2];v=m+176|0;c[v+0>>2]=c[f+0>>2];c[v+4>>2]=c[f+4>>2];c[v+8>>2]=c[f+8>>2];c[v+12>>2]=c[f+12>>2];o=+g[k>>2];p=+g[k+4>>2];q=+g[k+8>>2];r=+g[k+16>>2];n=+g[k+12>>2];t=+g[k+20>>2];c[m+0>>2]=c[m+144>>2];c[m+4>>2]=c[m+148>>2];c[m+8>>2]=c[m+152>>2];c[m+12>>2]=c[m+156>>2];c[m+16>>2]=c[w+0>>2];c[m+20>>2]=c[w+4>>2];c[m+24>>2]=c[w+8>>2];c[m+28>>2]=c[w+12>>2];c[m+32>>2]=c[v+0>>2];c[m+36>>2]=c[v+4>>2];c[m+40>>2]=c[v+8>>2];c[m+44>>2]=c[v+12>>2];v=c[b+136>>2]|0;if((v|0)==(c[b+140>>2]|0)?(s=(v|0)==0?1:v<<1,(v|0)<(s|0)):0){if(!s)d=0;else{c[5004]=(c[5004]|0)+1;k=fF((s*284|3)+16|0)|0;if(!k)d=0;else{c[(k+19&-16)+ -4>>2]=k;d=k+19&-16}v=c[b+136>>2]|0}if((v|0)>0){w=0;do{k=d+(w*284|0)|0;if(k){u=c[b+144>>2]|0;e=k+0|0;k=u+(w*284|0)+0|0;f=e+92|0;do{c[e>>2]=c[k>>2];e=e+4|0;k=k+4|0}while((e|0)<(f|0));e=d+(w*284|0)+92|0;k=u+(w*284|0)+92|0;c[e+0>>2]=c[k+0>>2];c[e+4>>2]=c[k+4>>2];c[e+8>>2]=c[k+8>>2];c[e+12>>2]=c[k+12>>2];e=d+(w*284|0)+108|0;k=u+(w*284|0)+108|0;c[e+0>>2]=c[k+0>>2];c[e+4>>2]=c[k+4>>2];c[e+8>>2]=c[k+8>>2];c[e+12>>2]=c[k+12>>2];e=d+(w*284|0)+124|0;k=u+(w*284|0)+124|0;c[e+0>>2]=c[k+0>>2];c[e+4>>2]=c[k+4>>2];c[e+8>>2]=c[k+8>>2];c[e+12>>2]=c[k+12>>2];e=d+(w*284|0)+140|0;k=u+(w*284|0)+140|0;c[e+0>>2]=c[k+0>>2];c[e+4>>2]=c[k+4>>2];c[e+8>>2]=c[k+8>>2];c[e+12>>2]=c[k+12>>2];e=d+(w*284|0)+156|0;k=u+(w*284|0)+156|0;f=e+128|0;do{c[e>>2]=c[k>>2];e=e+4|0;k=k+4|0}while((e|0)<(f|0))}w=w+1|0}while((w|0)!=(v|0))}k=c[b+144>>2]|0;if(k){if(a[b+148>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[b+144>>2]=0}a[b+148>>0]=1;c[b+144>>2]=d;c[b+140>>2]=s;v=c[b+136>>2]|0}s=c[b+144>>2]|0;k=s+(v*284|0)|0;if(!k){w=v;d=s;v=w+1|0;c[b+136>>2]=v;w=d+(w*284|0)|0;d=b+116|0;v=c[d>>2]|0;_q(v,w,0);v=c[b+136>>2]|0;v=v+ -1|0;d=c[d>>2]|0;u=c[b+144>>2]|0;$q(d,u,v,0);i=m;return w|0}e=k+0|0;k=m+48|0;f=e+92|0;do{c[e>>2]=c[k>>2];e=e+4|0;k=k+4|0}while((e|0)<(f|0));e=s+(v*284|0)+92|0;c[e+0>>2]=c[m+240>>2];c[e+4>>2]=c[m+244>>2];c[e+8>>2]=c[m+248>>2];c[e+12>>2]=c[m+252>>2];e=s+(v*284|0)+108|0;c[e+0>>2]=c[m+224>>2];c[e+4>>2]=c[m+228>>2];c[e+8>>2]=c[m+232>>2];c[e+12>>2]=c[m+236>>2];e=s+(v*284|0)+124|0;c[e+0>>2]=c[m+208>>2];c[e+4>>2]=c[m+212>>2];c[e+8>>2]=c[m+216>>2];c[e+12>>2]=c[m+220>>2];e=s+(v*284|0)+140|0;c[e+0>>2]=c[m+192>>2];c[e+4>>2]=c[m+196>>2];c[e+8>>2]=c[m+200>>2];c[e+12>>2]=c[m+204>>2];s=s+(v*284|0)+156|0;e=s+0|0;k=m+0|0;f=e+48|0;do{c[e>>2]=c[k>>2];e=e+4|0;k=k+4|0}while((e|0)<(f|0));g[s+48>>2]=h;g[s+52>>2]=n;g[s+56>>2]=j;g[s+60>>2]=o;g[s+64>>2]=p;g[s+68>>2]=q;g[s+72>>2]=r;g[s+76>>2]=0.0;g[s+80>>2]=0.0;g[s+84>>2]=0.0;g[s+88>>2]=.10000000149011612;g[s+92>>2]=t;g[s+96>>2]=0.0;g[s+100>>2]=0.0;a[s+104>>0]=l&1;e=s+105|0;k=m+256|0;f=e+23|0;do{a[e>>0]=a[k>>0]|0;e=e+1|0;k=k+1|0}while((e|0)<(f|0));w=c[b+136>>2]|0;d=c[b+144>>2]|0;v=w+1|0;c[b+136>>2]=v;w=d+(w*284|0)|0;d=b+116|0;v=c[d>>2]|0;_q(v,w,0);v=c[b+136>>2]|0;v=v+ -1|0;d=c[d>>2]|0;u=c[b+144>>2]|0;$q(d,u,v,0);i=m;return w|0}function Vl(a){a=a|0;return c[a+136>>2]|0}function Wl(a){a=a|0;return c[a+116>>2]|0}function Xl(a,b){a=a|0;b=b|0;return(c[a+144>>2]|0)+(b*284|0)|0}function Yl(a,b,d){a=a|0;b=+b;d=d|0;g[(c[a+144>>2]|0)+(d*284|0)+256>>2]=b;return}function Zl(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+24>>2]&127](a,b,d,e);i=f;return}function _l(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function $l(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=+f;var h=0,j=0;h=i;j=fF(44)|0;a:do if(!j){while(1){j=c[5158]|0;c[5158]=j+0;if(!j)break;sc[j&3]();j=fF(44)|0;if(j)break a}j=Ab(4)|0;c[j>>2]=20472;yb(j|0,20520,265)}while(0);c[j>>2]=a;c[j+4>>2]=b;b=j+8|0;c[b+0>>2]=c[d+0>>2];c[b+4>>2]=c[d+4>>2];c[b+8>>2]=c[d+8>>2];c[b+12>>2]=c[d+12>>2];d=j+24|0;c[d+0>>2]=c[e+0>>2];c[d+4>>2]=c[e+4>>2];c[d+8>>2]=c[e+8>>2];c[d+12>>2]=c[e+12>>2];g[j+40>>2]=f;i=h;return j|0}function am(a){a=a|0;return c[a>>2]|0}function bm(a,b){a=a|0;b=b|0;c[a>>2]=b;return}function cm(a){a=a|0;return c[a+4>>2]|0}function dm(a,b){a=a|0;b=b|0;c[a+4>>2]=b;return}function em(a){a=a|0;return a+8|0}function fm(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+8>>2]=c[b+0>>2];c[a+12>>2]=c[b+4>>2];c[a+16>>2]=c[b+8>>2];c[a+20>>2]=c[b+12>>2];i=d;return}function gm(a){a=a|0;return a+24|0}function hm(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+24>>2]=c[b+0>>2];c[a+28>>2]=c[b+4>>2];c[a+32>>2]=c[b+8>>2];c[a+36>>2]=c[b+12>>2];i=d;return}function im(a){a=a|0;return+(+g[a+40>>2])}function jm(a,b){a=a|0;b=+b;g[a+40>>2]=b;return}function km(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function lm(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function mm(b){b=b|0;var d=0,e=0,f=0,h=0;d=i;c[5004]=(c[5004]|0)+1;e=fF(635)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}g[e+164>>2]=1.0;g[e+168>>2]=1.0;g[e+172>>2]=1.0;g[e+176>>2]=0.0;c[e+180>>2]=0;g[e+184>>2]=999999984306749400.0;f=e+188|0;h=e+204|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[h>>2]=1;c[e+208>>2]=-1;c[e+212>>2]=-1;c[e+216>>2]=1;g[e+220>>2]=0.0;g[e+224>>2]=.5;g[e+228>>2]=0.0;g[e+232>>2]=0.0;c[e+236>>2]=1;c[e+240>>2]=0;g[e+244>>2]=1.0;h=e+248|0;f=e+4|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=e+8|0;h=e+24|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;g[h>>2]=1.0;h=e+28|0;f=e+44|0;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;g[f>>2]=1.0;f=e+48|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;c[e>>2]=3912;a[e+500>>0]=1;c[e+496>>2]=0;c[e+488>>2]=0;c[e+492>>2]=0;kr(e,b);i=d;return e|0}function nm(a){a=a|0;return a+4|0}function om(a,b){a=a|0;b=b|0;var c=0;c=i;nr(a,b);i=c;return}function pm(a,b,c){a=a|0;b=+b;c=+c;g[a+472>>2]=b;g[a+476>>2]=c;return}function qm(a,b,c){a=a|0;b=+b;c=+c;if(b<0.0)b=0.0;else b=b>1.0?1.0:b;g[a+444>>2]=b;if(c<0.0)c=0.0;else c=c>1.0?1.0:c;g[a+448>>2]=c;return}function rm(a,b,c){a=a|0;b=+b;c=c|0;var d=0;d=i;mr(a,b,c);i=d;return}function sm(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0;d=i;c[a+348>>2]=c[b+0>>2];c[a+352>>2]=c[b+4>>2];c[a+356>>2]=c[b+8>>2];c[a+360>>2]=c[b+12>>2];h=+g[a+344>>2];f=+g[a+352>>2]*h;e=+g[a+356>>2]*h;g[a+560>>2]=+g[a+348>>2]*h;g[a+564>>2]=f;g[a+568>>2]=e;g[a+572>>2]=0.0;i=d;return}function tm(a,b){a=a|0;b=b|0;var c=0.0,d=0.0;d=+g[b+4>>2]*+g[a+548>>2];c=+g[b+8>>2]*+g[a+552>>2];g[a+428>>2]=+g[a+428>>2]+ +g[b>>2]*+g[a+544>>2];g[a+432>>2]=+g[a+432>>2]+d;g[a+436>>2]=+g[a+436>>2]+c;return}function um(a,b,c){a=a|0;b=b|0;c=c|0;var d=0.0,e=0.0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0;d=+g[a+348>>2];f=+g[a+352>>2];h=+g[b+4>>2]*f;i=+g[a+356>>2];j=+g[b+8>>2]*i;g[a+412>>2]=+g[a+412>>2]+ +g[b>>2]*d;g[a+416>>2]=+g[a+416>>2]+h;g[a+420>>2]=+g[a+420>>2]+j;d=+g[b>>2]*d;f=+g[b+4>>2]*f;i=+g[b+8>>2]*i;j=+g[c+4>>2];h=+g[c+8>>2];k=+g[c>>2];e=(h*d-k*i)*+g[a+548>>2];d=(k*f-j*d)*+g[a+552>>2];g[a+428>>2]=+g[a+428>>2]+(j*i-h*f)*+g[a+544>>2];g[a+432>>2]=+g[a+432>>2]+e;g[a+436>>2]=+g[a+436>>2]+d;return}function vm(a,b){a=a|0;b=b|0;var c=0.0,d=0.0;d=+g[b+4>>2]*+g[a+352>>2];c=+g[b+8>>2]*+g[a+356>>2];g[a+412>>2]=+g[a+412>>2]+ +g[b>>2]*+g[a+348>>2];g[a+416>>2]=+g[a+416>>2]+d;g[a+420>>2]=+g[a+420>>2]+c;return}function wm(a,b){a=a|0;b=b|0;var c=0.0,d=0.0,e=0.0,f=0.0,h=0.0;h=+g[b>>2];f=+g[b+4>>2];e=+g[b+8>>2];d=(+g[a+280>>2]*h+ +g[a+284>>2]*f+ +g[a+288>>2]*e)*+g[a+548>>2];c=(+g[a+296>>2]*h+ +g[a+300>>2]*f+ +g[a+304>>2]*e)*+g[a+552>>2];g[a+328>>2]=+g[a+328>>2]+(+g[a+264>>2]*h+ +g[a+268>>2]*f+ +g[a+272>>2]*e)*+g[a+544>>2];g[a+332>>2]=+g[a+332>>2]+d;g[a+336>>2]=+g[a+336>>2]+c;return}function xm(a,b,c){a=a|0;b=b|0;c=c|0;var d=0;d=i;ym(a,b,c);i=d;return}function ym(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;d=i;if(!(+g[a+344>>2]!=0.0)){i=d;return}Am(a,b);h=+g[b>>2]*+g[a+348>>2];k=+g[b+4>>2]*+g[a+352>>2];m=+g[b+8>>2]*+g[a+356>>2];j=+g[c+4>>2];n=+g[c+8>>2];l=+g[c>>2];f=(+g[a+280>>2]*(j*m-n*k)+ +g[a+284>>2]*(n*h-l*m)+ +g[a+288>>2]*(l*k-j*h))*+g[a+548>>2];e=(+g[a+296>>2]*(j*m-n*k)+ +g[a+300>>2]*(n*h-l*m)+ +g[a+304>>2]*(l*k-j*h))*+g[a+552>>2];g[a+328>>2]=+g[a+328>>2]+(+g[a+264>>2]*(j*m-n*k)+ +g[a+268>>2]*(n*h-l*m)+ +g[a+272>>2]*(l*k-j*h))*+g[a+544>>2];g[a+332>>2]=+g[a+332>>2]+f;g[a+336>>2]=+g[a+336>>2]+e;i=d;return}function zm(a,b){a=a|0;b=b|0;var c=0;c=i;Am(a,b);i=c;return}function Am(a,b){a=a|0;b=b|0;var c=0.0,d=0.0,e=0.0;e=+g[a+344>>2];d=+g[b+4>>2]*+g[a+352>>2]*e;c=+g[b+8>>2]*+g[a+356>>2]*e;g[a+312>>2]=+g[a+312>>2]+ +g[b>>2]*+g[a+348>>2]*e;g[a+316>>2]=+g[a+316>>2]+d;g[a+320>>2]=+g[a+320>>2]+c;return}function Bm(a){a=a|0;var b=0.0,c=0.0,d=0.0,e=0.0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;n=+g[a+4>>2];h=+g[a+396>>2];m=+g[a+8>>2];e=+g[a+400>>2];l=+g[a+12>>2];c=+g[a+404>>2];k=+g[a+20>>2];j=+g[a+24>>2];i=+g[a+28>>2];f=+g[a+36>>2];d=+g[a+40>>2];b=+g[a+44>>2];g[a+264>>2]=n*n*h+m*m*e+l*l*c;g[a+268>>2]=n*h*k+m*e*j+l*c*i;g[a+272>>2]=n*h*f+m*e*d+l*c*b;g[a+276>>2]=0.0;g[a+280>>2]=n*h*k+m*e*j+l*c*i;g[a+284>>2]=k*h*k+j*e*j+i*c*i;g[a+288>>2]=h*k*f+e*j*d+c*i*b;g[a+292>>2]=0.0;g[a+296>>2]=n*h*f+m*e*d+l*c*b;g[a+300>>2]=k*h*f+j*e*d+i*c*b;g[a+304>>2]=f*h*f+d*e*d+b*c*b;g[a+308>>2]=0.0;return}function Cm(a){a=a|0;return a+312|0}function Dm(a){a=a|0;return a+328|0}function Em(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+312>>2]=c[b+0>>2];c[a+316>>2]=c[b+4>>2];c[a+320>>2]=c[b+8>>2];c[a+324>>2]=c[b+12>>2];i=d;return}function Fm(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+328>>2]=c[b+0>>2];c[a+332>>2]=c[b+4>>2];c[a+336>>2]=c[b+8>>2];c[a+340>>2]=c[b+12>>2];i=d;return}function Gm(a){a=a|0;return c[a+480>>2]|0}function Hm(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+544>>2]=c[b+0>>2];c[a+548>>2]=c[b+4>>2];c[a+552>>2]=c[b+8>>2];c[a+556>>2]=c[b+12>>2];i=d;return}function Im(a,b){a=a|0;b=b|0;if(!(c[b+236>>2]&2))b=0;return b|0}function Jm(a){a=a|0;return c[a+192>>2]|0}function Km(a,b){a=a|0;b=+b;g[a+184>>2]=b;return}function Lm(a,b){a=a|0;b=b|0;var d=0;d=i;if(((c[a+216>>2]|0)+ -4|0)>>>0<2){i=d;return}c[a+216>>2]=b;i=d;return}function Mm(a,b){a=a|0;b=b|0;c[a+216>>2]=b;return}function Nm(a){a=a|0;var b=0;b=i;if(c[a+204>>2]&3){i=b;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=b;return}function Om(a,b){a=a|0;b=b|0;var d=0;d=i;if(!b?(c[a+204>>2]&3|0)!=0:0){i=d;return}if(((c[a+216>>2]|0)+ -4|0)>>>0>=2)c[a+216>>2]=1;g[a+220>>2]=0.0;i=d;return}function Pm(a){a=a|0;a=c[a+216>>2]|0;return((a|0)==2?0:(a|0)!=5)|0}function Qm(a){a=a|0;return(c[a+204>>2]&2|0)!=0|0}function Rm(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+228>>2]=b;return}function Sm(a,b){a=a|0;b=+b;c[a+260>>2]=(c[a+260>>2]|0)+1;g[a+224>>2]=b;return}function Tm(a){a=a|0;return a+4|0}function Um(a){a=a|0;return c[a+204>>2]|0}function Vm(a,b){a=a|0;b=b|0;c[a+204>>2]=b;return}function Wm(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2];c[a+20>>2]=c[b+16>>2];c[a+24>>2]=c[b+20>>2];c[a+28>>2]=c[b+24>>2];c[a+32>>2]=c[b+28>>2];c[a+36>>2]=c[b+32>>2];c[a+40>>2]=c[b+36>>2];c[a+44>>2]=c[b+40>>2];c[a+48>>2]=c[b+44>>2];c[a+52>>2]=c[b+48>>2];c[a+56>>2]=c[b+52>>2];c[a+60>>2]=c[b+56>>2];c[a+64>>2]=c[b+60>>2];i=d;return}function Xm(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=d;return}function Ym(a,b){a=a|0;b=+b;g[a+252>>2]=b;return}function Zm(a,b){a=a|0;b=+b;g[a+248>>2]=b;return}function _m(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+8>>2]&511](a);i=b;return}function $m(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(75)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}tx(d,a);c[d>>2]=11032;c[d+52>>2]=0;i=b;return d|0}function an(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function bn(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function cn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function dn(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(75)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}tx(d,a);c[d>>2]=11136;c[d+52>>2]=2;i=b;return d|0}function en(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function fn(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function gn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function hn(){var a=0,b=0,d=0,e=0;a=i;e=fF(64)|0;a:do if(!e){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();e=fF(64)|0;if(e)break a}e=Ab(4)|0;c[e>>2]=20472;yb(e|0,20520,265)}while(0);b=e+48|0;d=e;do d=d+16|0;while((d|0)!=(b|0));i=a;return e|0}function jn(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0;d=i;e=fF(64)|0;a:do if(!e){while(1){e=c[5158]|0;c[5158]=e+0;if(!e)break;sc[e&3]();e=fF(64)|0;if(e)break a}g=Ab(4)|0;c[g>>2]=20472;yb(g|0,20520,265)}while(0);f=e+48|0;g=e;do g=g+16|0;while((g|0)!=(f|0));co(e,a);c[f+0>>2]=c[b+0>>2];c[f+4>>2]=c[b+4>>2];c[f+8>>2]=c[b+8>>2];c[f+12>>2]=c[b+12>>2];i=d;return e|0}function kn(a){a=a|0;var b=0;b=i;ln(a);i=b;return}function ln(a){a=a|0;var b=0;b=i;g[a>>2]=1.0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;c[a+16>>2]=0;g[a+20>>2]=1.0;c[a+24>>2]=0;c[a+28>>2]=0;c[a+32>>2]=0;c[a+36>>2]=0;g[a+40>>2]=1.0;g[a+44>>2]=0.0;c[a+48>>2]=0;c[a+52>>2]=0;c[a+56>>2]=0;c[a+60>>2]=0;i=b;return}function mn(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+48>>2]=c[b+0>>2];c[a+52>>2]=c[b+4>>2];c[a+56>>2]=c[b+8>>2];c[a+60>>2]=c[b+12>>2];i=d;return}function nn(a,b){a=a|0;b=b|0;var c=0;c=i;co(a,b);i=c;return}function on(a){a=a|0;return a+48|0}function pn(b){b=b|0;var d=0;d=i;i=i+16|0;if((a[48]|0)==0?(Ya(48)|0)!=0:0)bb(48);Hc(b,d);c[8]=c[d+0>>2];c[9]=c[d+4>>2];c[10]=c[d+8>>2];c[11]=c[d+12>>2];i=d;return 32}function qn(a){a=a|0;return a|0}function rn(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function sn(a){a=a|0;return c[a+24>>2]|0}function tn(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+32>>2]&127](a,b,d,e);i=f;return}function un(a){a=a|0;var b=0;b=i;a=c[a+68>>2]|0;a=Pb[c[(c[a>>2]|0)+36>>2]&127](a)|0;i=b;return a|0}function vn(a){a=a|0;return a+28|0}function wn(a,b){a=a|0;b=b|0;var d=0;d=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,1,-1);i=d;return}function xn(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,-1);i=e;return}function yn(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+36>>2]&127](a,b,d,e);i=f;return}function zn(a){a=a|0;return c[a+68>>2]|0}function An(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;var g=0;g=i;Ou(a,b,c,d,e,f);i=g;return}function Bn(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=i;Qu(a,b,c,d);i=e;return}function Cn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Dn(a){a=a|0;return+(+g[a>>2])}function En(a){a=a|0;return+(+g[a+4>>2])}function Fn(a){a=a|0;return+(+g[a+8>>2])}function Gn(a){a=a|0;return+(+g[a+12>>2])}function Hn(a,b){a=a|0;b=+b;g[a>>2]=b;return}function In(a,b){a=a|0;b=+b;g[a+4>>2]=b;return}function Jn(a,b){a=a|0;b=+b;g[a+8>>2]=b;return}function Kn(a,b){a=a|0;b=+b;g[a+12>>2]=b;return}function Ln(a){a=a|0;var b=0;b=i;if(a)gF(a);i=b;return}function Mn(a){a=a|0;var b=0,d=0;b=i;c[5004]=(c[5004]|0)+1;d=fF(75)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}tx(d,a);i=b;return d|0}function Nn(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+24>>2]&127](a,b);i=d;return}function On(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;Ub[c[(c[a>>2]|0)+32>>2]&15](a,b,d);i=e;return}function Pn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Qn(){var a=0,b=0,d=0;a=i;b=fF(4)|0;if(b){d=b;c[d>>2]=192;i=a;return d|0}while(1){b=c[5158]|0;c[5158]=b+0;if(!b){b=4;break}sc[b&3]();d=fF(4)|0;if(d){b=5;break}}if((b|0)==4){d=Ab(4)|0;c[d>>2]=20472;yb(d|0,20520,265)}else if((b|0)==5){c[d>>2]=192;i=a;return d|0}return 0}function Rn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Sn(b,c){b=b|0;c=c|0;a[b+21>>0]=c&1;return}function Tn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}Lb[c[(c[a>>2]|0)+4>>2]&511](a);i=b;return}function Un(a){a=a|0;return}function Vn(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Wn(a){a=a|0;return}function Xn(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;return}function Yn(a,b,c,d){a=a|0;b=b|0;c=c|0;d=+d;return}function Zn(a){a=a|0;return}function _n(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function $n(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;a=i;f=c[b>>2]|0;e=c[d>>2]|0;if((c[f+236>>2]|0)!=4)f=0;if((c[e+236>>2]|0)!=4)e=0;if(f)rc[c[(c[f>>2]|0)+28>>2]&127](f,d,b);if(!e){i=a;return 0}rc[c[(c[e>>2]|0)+28>>2]&127](e,b,d);i=a;return 0}function ao(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;a=i;g=c[b>>2]|0;f=c[d>>2]|0;if((c[g+236>>2]|0)!=4)g=0;if((c[f+236>>2]|0)!=4)f=0;if(g)vc[c[(c[g>>2]|0)+32>>2]&127](g,d,e,b);if(!f){i=a;return 0}vc[c[(c[f>>2]|0)+32>>2]&127](f,b,e,d);i=a;return 0}function bo(a,b,c){a=a|0;b=b|0;c=c|0;return}function co(a,b){a=a|0;b=b|0;var c=0.0,d=0.0,e=0.0,f=0.0,h=0.0,i=0.0,j=0.0;f=+g[b>>2];d=+g[b+4>>2];j=+g[b+8>>2];h=+g[b+12>>2];e=f*(2.0/(f*f+d*d+j*j+h*h));c=d*(2.0/(f*f+d*d+j*j+h*h));i=j*(2.0/(f*f+d*d+j*j+h*h));g[a>>2]=1.0-(d*c+j*i);g[a+4>>2]=f*c-h*i;g[a+8>>2]=f*i+h*c;g[a+12>>2]=0.0;g[a+16>>2]=f*c+h*i;g[a+20>>2]=1.0-(f*e+j*i);g[a+24>>2]=d*i-h*e;g[a+28>>2]=0.0;g[a+32>>2]=f*i-h*c;g[a+36>>2]=d*i+h*e;g[a+40>>2]=1.0-(f*e+d*c);g[a+44>>2]=0.0;return}function eo(a){a=a|0;return}function fo(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function go(a,c){a=a|0;c=c|0;var d=0;d=i;if(!((b[c+4>>1]&b[a+14>>1])<<16>>16)){c=0;i=d;return c|0}c=(b[a+12>>1]&b[c+6>>1])<<16>>16!=0;i=d;return c|0}function ho(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0;g[a+4>>2]=+g[b+24>>2];e=c[b>>2]|0;c[a+8>>2]=e;if(d){c[a+52>>2]=c[b+8>>2];c[a+56>>2]=c[b+12>>2];c[a+60>>2]=c[b+16>>2];c[a+64>>2]=c[b+20>>2]}else{k=+g[b+8>>2];j=+g[b+12>>2];i=+g[b+16>>2];h=+g[e+20>>2]*k+ +g[e+24>>2]*j+ +g[e+28>>2]*i;f=+g[e+36>>2]*k+ +g[e+40>>2]*j+ +g[e+44>>2]*i;g[a+52>>2]=+g[e+4>>2]*k+ +g[e+8>>2]*j+ +g[e+12>>2]*i;g[a+56>>2]=h;g[a+60>>2]=f;g[a+64>>2]=0.0}k=+g[b+24>>2];g[a+68>>2]=(1.0-k)*+g[a+20>>2]+ +g[a+36>>2]*k;g[a+72>>2]=(1.0-k)*+g[a+24>>2]+k*+g[a+40>>2];g[a+76>>2]=(1.0-k)*+g[a+28>>2]+k*+g[a+44>>2];return+(+g[b+24>>2])}function io(a,b,c,d,e,f,h,j,k,l){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;var m=0,n=0;n=i;m=a;do m=m+16|0;while((m|0)!=(a+48|0));g[a>>2]=+g[b>>2];g[a+4>>2]=+g[c>>2];g[a+8>>2]=+g[d>>2];g[a+12>>2]=0.0;g[a+16>>2]=+g[e>>2];g[a+20>>2]=+g[f>>2];g[a+24>>2]=+g[h>>2];g[a+28>>2]=0.0;g[a+32>>2]=+g[j>>2];g[a+36>>2]=+g[k>>2];g[a+40>>2]=+g[l>>2];g[a+44>>2]=0.0;i=n;return}function jo(a){a=a|0;return}function ko(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function lo(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0;d=i;i=i+176|0;io(d+128|0,a+68|0,a+84|0,a+100|0,a+72|0,a+88|0,a+104|0,a+76|0,a+92|0,a+108|0);l=-+g[a+116>>2];k=-+g[a+120>>2];h=-+g[a+124>>2];e=+g[d+128>>2]*l+ +g[d+132>>2]*k+ +g[d+136>>2]*h;f=+g[d+144>>2]*l+ +g[d+148>>2]*k+ +g[d+152>>2]*h;h=+g[d+160>>2]*l+ +g[d+164>>2]*k+ +g[d+168>>2]*h;j=d;do j=j+16|0;while((j|0)!=(d+48|0));c[d+0>>2]=c[d+128>>2];c[d+4>>2]=c[d+132>>2];c[d+8>>2]=c[d+136>>2];c[d+12>>2]=c[d+140>>2];c[d+16>>2]=c[d+144>>2];c[d+20>>2]=c[d+148>>2];c[d+24>>2]=c[d+152>>2];c[d+28>>2]=c[d+156>>2];c[d+32>>2]=c[d+160>>2];c[d+36>>2]=c[d+164>>2];c[d+40>>2]=c[d+168>>2];c[d+44>>2]=c[d+172>>2];g[d+48>>2]=e;g[d+52>>2]=f;g[d+56>>2]=h;g[d+60>>2]=0.0;no(d+64|0,d,a+4|0);c[b+0>>2]=c[d+64>>2];c[b+4>>2]=c[d+68>>2];c[b+8>>2]=c[d+72>>2];c[b+12>>2]=c[d+76>>2];c[b+16>>2]=c[d+80>>2];c[b+20>>2]=c[d+84>>2];c[b+24>>2]=c[d+88>>2];c[b+28>>2]=c[d+92>>2];c[b+32>>2]=c[d+96>>2];c[b+36>>2]=c[d+100>>2];c[b+40>>2]=c[d+104>>2];c[b+44>>2]=c[d+108>>2];c[b+48>>2]=c[d+112>>2];c[b+52>>2]=c[d+116>>2];c[b+56>>2]=c[d+120>>2];c[b+60>>2]=c[d+124>>2];i=d;return}function mo(a,b){a=a|0;b=b|0;var d=0;d=i;i=i+64|0;no(d,b,a+68|0);c[a+4>>2]=c[d+0>>2];c[a+8>>2]=c[d+4>>2];c[a+12>>2]=c[d+8>>2];c[a+16>>2]=c[d+12>>2];c[a+20>>2]=c[d+16>>2];c[a+24>>2]=c[d+20>>2];c[a+28>>2]=c[d+24>>2];c[a+32>>2]=c[d+28>>2];c[a+36>>2]=c[d+32>>2];c[a+40>>2]=c[d+36>>2];c[a+44>>2]=c[d+40>>2];c[a+48>>2]=c[d+44>>2];c[a+52>>2]=c[d+48>>2];c[a+56>>2]=c[d+52>>2];c[a+60>>2]=c[d+56>>2];c[a+64>>2]=c[d+60>>2];i=d;return}function no(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0;e=i;i=i+96|0;s=+g[d>>2];h=+g[b>>2];r=+g[d+16>>2];j=+g[b+4>>2];q=+g[d+32>>2];l=+g[b+8>>2];g[e+80>>2]=s*h+r*j+q*l;p=+g[d+4>>2];o=+g[d+20>>2];n=+g[d+36>>2];g[e+76>>2]=p*h+o*j+n*l;m=+g[d+8>>2];f=+g[d+24>>2];k=+g[d+40>>2];g[e+72>>2]=m*h+f*j+k*l;l=+g[b+16>>2];j=+g[b+20>>2];h=+g[b+24>>2];g[e+68>>2]=s*l+r*j+q*h;g[e+64>>2]=p*l+o*j+n*h;g[e+60>>2]=m*l+f*j+k*h;h=+g[b+32>>2];j=+g[b+36>>2];l=+g[b+40>>2];g[e+56>>2]=s*h+r*j+q*l;g[e+52>>2]=p*h+o*j+n*l;g[e+48>>2]=m*h+f*j+k*l;io(e,e+80|0,e+76|0,e+72|0,e+68|0,e+64|0,e+60|0,e+56|0,e+52|0,e+48|0);l=+g[d+48>>2];k=+g[d+52>>2];j=+g[d+56>>2];f=l*+g[b>>2]+k*+g[b+4>>2]+j*+g[b+8>>2]+ +g[b+48>>2];h=l*+g[b+16>>2]+k*+g[b+20>>2]+j*+g[b+24>>2]+ +g[b+52>>2];j=l*+g[b+32>>2]+k*+g[b+36>>2]+j*+g[b+40>>2]+ +g[b+56>>2];b=a;do b=b+16|0;while((b|0)!=(a+48|0));c[a+0>>2]=c[e+0>>2];c[a+4>>2]=c[e+4>>2];c[a+8>>2]=c[e+8>>2];c[a+12>>2]=c[e+12>>2];c[a+16>>2]=c[e+16>>2];c[a+20>>2]=c[e+20>>2];c[a+24>>2]=c[e+24>>2];c[a+28>>2]=c[e+28>>2];c[a+32>>2]=c[e+32>>2];c[a+36>>2]=c[e+36>>2];c[a+40>>2]=c[e+40>>2];c[a+44>>2]=c[e+44>>2];g[a+48>>2]=f;g[a+52>>2]=h;g[a+56>>2]=j;g[a+60>>2]=0.0;i=e;return}function oo(a){a=a|0;return}function po(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function qo(a,c){a=a|0;c=c|0;var d=0;d=i;if(!((b[c+4>>1]&b[a+10>>1])<<16>>16)){c=0;i=d;return c|0}c=(b[a+8>>1]&b[c+6>>1])<<16>>16!=0;i=d;return c|0}function ro(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;e=i;g[a+4>>2]=+g[b+40>>2];f=c[b>>2]|0;c[a+76>>2]=f;if(d){c[a+44>>2]=c[b+8>>2];c[a+48>>2]=c[b+12>>2];c[a+52>>2]=c[b+16>>2];c[a+56>>2]=c[b+20>>2];d=a+60|0;a=b+24|0;c[d+0>>2]=c[a+0>>2];c[d+4>>2]=c[a+4>>2];c[d+8>>2]=c[a+8>>2];c[d+12>>2]=c[a+12>>2];h=+g[b+40>>2];i=e;return+h}else{m=+g[b+8>>2];l=+g[b+12>>2];k=+g[b+16>>2];j=+g[f+20>>2]*m+ +g[f+24>>2]*l+ +g[f+28>>2]*k;h=+g[f+36>>2]*m+ +g[f+40>>2]*l+ +g[f+44>>2]*k;g[a+44>>2]=+g[f+4>>2]*m+ +g[f+8>>2]*l+ +g[f+12>>2]*k;g[a+48>>2]=j;g[a+52>>2]=h;g[a+56>>2]=0.0;d=a+60|0;a=b+24|0;c[d+0>>2]=c[a+0>>2];c[d+4>>2]=c[a+4>>2];c[d+8>>2]=c[a+8>>2];c[d+12>>2]=c[a+12>>2];h=+g[b+40>>2];i=e;return+h}return 0.0}function so(a){a=a|0;return}function to(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function uo(a,c){a=a|0;c=c|0;var d=0;d=i;if(!((b[c+4>>1]&b[a+6>>1])<<16>>16)){c=0;i=d;return c|0}c=(b[a+4>>1]&b[c+6>>1])<<16>>16!=0;i=d;return c|0}function vo(a,b,c,d,e,f,g,h){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;var j=0.0,k=0;k=i;j=+Ta(960,a|0,b|0,c|0,d|0,e|0,f|0,g|0,h|0);i=k;return+j}function wo(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0.0,k=0,l=0;e=i;if(a[b+527>>0]|0){c[d>>2]=0;c[d+4>>2]=0;i=e;return}c[d>>2]=3;c[d+4>>2]=3;l=c[b+28>>2]|0;k=c[b+32>>2]|0;xo(b,l+4|0,k+4|0,l+264|0,k+264|0);if(((a[b+526>>0]|0)!=0?(f=c[d>>2]|0,c[d>>2]=f+1,h=c[d+4>>2]|0,c[d+4>>2]=h+ -1,j=+g[b+456>>2],+g[b+444>>2]<j):0)?+g[b+448>>2]<j:0){c[d>>2]=f+2;c[d+4>>2]=h+ -2}if(!(a[b+525>>0]|0)){i=e;return}c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1;i=e;return}function xo(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,R=0.0,U=0.0,W=0.0,X=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0.0,ca=0.0,da=0.0,ea=0.0,fa=0.0,ga=0.0,ha=0.0,ia=0.0,ja=0.0,ka=0.0,la=0.0,ma=0.0;j=i;i=i+272|0;g[b+504>>2]=0.0;g[b+500>>2]=0.0;a[b+525>>0]=0;a[b+526>>0]=0;if((a[b+552>>0]|0)!=0?(a[b+527>>0]|0)==0:0){ia=+g[b+556>>2];ba=+g[b+560>>2];ja=+g[b+564>>2];ca=+g[b+568>>2];ea=ia*(2.0/(ia*ia+ba*ba+ja*ja+ca*ca));la=ba*(2.0/(ia*ia+ba*ba+ja*ja+ca*ca));fa=ja*(2.0/(ia*ia+ba*ba+ja*ja+ca*ca));no(j+208|0,d,b+300|0);no(j+144|0,e,b+364|0);H=+g[j+144>>2];J=+g[j+148>>2];m=+g[j+152>>2];W=(1.0-(ba*la+ja*fa))*H+(ia*la+ca*fa)*J+(ia*fa-ca*la)*m;X=(ia*la-ca*fa)*H+(1.0-(ia*ea+ja*fa))*J+(ba*fa+ca*ea)*m;Z=(ia*fa+ca*la)*H+(ba*fa-ca*ea)*J+(1.0-(ia*ea+ba*la))*m;K=+g[j+160>>2];L=+g[j+164>>2];l=+g[j+168>>2];_=(1.0-(ba*la+ja*fa))*K+(ia*la+ca*fa)*L+(ia*fa-ca*la)*l;$=(ia*la-ca*fa)*K+(1.0-(ia*ea+ja*fa))*L+(ba*fa+ca*ea)*l;aa=(ia*fa+ca*la)*K+(ba*fa-ca*ea)*L+(1.0-(ia*ea+ba*la))*l;M=+g[j+176>>2];N=+g[j+180>>2];O=+g[j+184>>2];ha=(1.0-(ba*la+ja*fa))*M+(ia*la+ca*fa)*N+(ia*fa-ca*la)*O;ja=(ia*la-ca*fa)*M+(1.0-(ia*ea+ja*fa))*N+(ba*fa+ca*ea)*O;la=(ia*fa+ca*la)*M+(ba*fa-ca*ea)*N+(1.0-(ia*ea+ba*la))*O;ba=+g[j+208>>2];ea=+g[j+224>>2];ia=+g[j+240>>2];ca=+g[j+212>>2];fa=+g[j+228>>2];ka=+g[j+244>>2];da=+g[j+216>>2];ga=+g[j+232>>2];ma=+g[j+248>>2];R=-+g[j+256>>2];U=-+g[j+260>>2];k=-+g[j+264>>2];m=H*0.0+J*0.0+m*0.0+ +g[j+192>>2]+(Z*(da*R+ga*U+ma*k)+(W*(ba*R+ea*U+ia*k)+X*(ca*R+fa*U+ka*k)));l=K*0.0+L*0.0+l*0.0+ +g[j+196>>2]+(aa*(da*R+ga*U+ma*k)+(_*(ba*R+ea*U+ia*k)+$*(ca*R+fa*U+ka*k)));k=M*0.0+N*0.0+O*0.0+ +g[j+200>>2]+(la*(da*R+ga*U+ma*k)+(ha*(ba*R+ea*U+ia*k)+ja*(ca*R+fa*U+ka*k)));g[j+80>>2]=W*ba+X*ca+Z*da;g[j+84>>2]=W*ea+X*fa+Z*ga;g[j+88>>2]=W*ia+X*ka+Z*ma;g[j+92>>2]=0.0;g[j+96>>2]=_*ba+$*ca+aa*da;g[j+100>>2]=_*ea+$*fa+aa*ga;g[j+104>>2]=_*ia+$*ka+aa*ma;g[j+108>>2]=0.0;g[j+112>>2]=ha*ba+ja*ca+la*da;g[j+116>>2]=ha*ea+ja*fa+la*ga;g[j+120>>2]=ha*ia+ja*ka+la*ma;g[j+124>>2]=0.0;g[j+128>>2]=m;g[j+132>>2]=l;g[j+136>>2]=k;g[j+140>>2]=0.0;Hc(j+80|0,j+64|0);k=+g[j+64>>2];l=+g[j+68>>2];m=+g[j+72>>2];if(+P(+(k*k+l*l+m*m))<1.1920928955078125e-7){i=j;return}g[b+472>>2]=0.0;ma=1.0/+Q(+(k*k+l*l+m*m));g[b+460>>2]=k*ma;g[b+464>>2]=l*ma;g[b+468>>2]=m*ma;ma=+g[j+76>>2];ma=ma<-1.0?-1.0:ma;ma=+V(+(ma>1.0?1.0:ma))*2.0;g[b+504>>2]=ma;if(+P(+ma)<1.1920928955078125e-7){i=j;return}a[b+526>>0]=1;i=j;return}Hc(d,j+48|0);Hc(b+300|0,j+32|0);B=+g[j+60>>2];x=+g[j+32>>2];D=+g[j+48>>2];z=+g[j+44>>2];A=+g[j+52>>2];v=+g[j+40>>2];y=+g[j+56>>2];C=+g[j+36>>2];Hc(e,j+16|0);Hc(b+364|0,j);p=+g[j+28>>2];l=+g[j>>2];r=+g[j+16>>2];n=+g[j+12>>2];o=+g[j+20>>2];s=+g[j+8>>2];m=+g[j+24>>2];q=+g[j+4>>2];k=-(p*l+r*n+o*s-m*q);w=-(l*m+(n*o+p*q)-r*s);u=-(p*s+n*m+r*q-l*o);M=(B*x+D*z+A*v-y*C)*(p*n-l*r-o*q-s*m)+(B*z-x*D-A*C-v*y)*k+(B*v+z*y+D*C-x*A)*w-(x*y+(z*A+B*C)-D*v)*u;O=(B*x+D*z+A*v-y*C)*u+((x*y+(z*A+B*C)-D*v)*(p*n-l*r-o*q-s*m)+(B*z-x*D-A*C-v*y)*w)-(B*v+z*y+D*C-x*A)*k;H=(x*y+(z*A+B*C)-D*v)*k+((B*v+z*y+D*C-x*A)*(p*n-l*r-o*q-s*m)+(B*z-x*D-A*C-v*y)*u)-(B*x+D*z+A*v-y*C)*w;R=(B*z-x*D-A*C-v*y)*(p*n-l*r-o*q-s*m)-(B*x+D*z+A*v-y*C)*k-(x*y+(z*A+B*C)-D*v)*w-(B*v+z*y+D*C-x*A)*u;E=-M-O*0.0-H*0.0;G=(H+R*0.0-M*0.0)*-H+(R*(R+O*0.0-H*0.0)+E*-M)-(R*0.0+M*0.0-O)*-O;L=(R*0.0+M*0.0-O)*-M+(R*(H+R*0.0-M*0.0)+E*-O)-(R+O*0.0-H*0.0)*-H;E=(R+O*0.0-H*0.0)*-O+(R*(R*0.0+M*0.0-O)+E*-H)-(H+R*0.0-M*0.0)*-M;K=1.0/+Q(+(E*E+(G*G+L*L)));if(K*E*0.0+(K*L*0.0+K*G)<-.9999998807907104)if(+P(0.0)>.7071067690849304){F=0.0;E=t;N=t;G=0.0}else{F=-0.0;E=1.0;N=0.0;G=0.0}else{ma=+Q(+((K*E*0.0+(K*L*0.0+K*G)+1.0)*2.0));F=(K*E*0.0-K*L*0.0)*(1.0/ma);E=(K*G*0.0-K*E)*(1.0/ma);N=(K*L-K*G*0.0)*(1.0/ma);G=ma*.5}U=1.0/+Q(+(G*G+(N*N+(E*E+F*F))));K=F*U;L=E*U;N=N*U;U=G*U;ma=1.0/+Q(+((R*U-M*-K-O*-L-H*-N)*(R*U-M*-K-O*-L-H*-N)+((O*-K+(H*U+R*-N)-M*-L)*(O*-K+(H*U+R*-N)-M*-L)+((H*-L+(M*U+R*-K)-O*-N)*(H*-L+(M*U+R*-K)-O*-N)+(M*-N+(O*U+R*-L)-H*-K)*(M*-N+(O*U+R*-L)-H*-K)))));G=ma*(H*-L+(M*U+R*-K)-O*-N);F=ma*(M*-N+(O*U+R*-L)-H*-K);E=ma*(O*-K+(H*U+R*-N)-M*-L);H=ma*(R*U-M*-K-O*-L-H*-N);M=+g[b+444>>2];O=+g[b+456>>2];if(M>=O?(J=+g[b+448>>2],J>=O):0){O=U<-1.0?-1.0:U;O=+V(+(O>1.0?1.0:O))*2.0;if(O>1.1920928955078125e-7){U=1.0/+Q(+(N*N+(K*K+L*L)));if(+P(+(L*U))>1.1920928955078125e-7){R=+Q(+((N*U*N*U/(L*U*L*U)+1.0)/(1.0/(J*J)+N*U*N*U/(L*U*L*U)/(M*M))));L=L*U;N=N*U;K=K*U}else{R=M;L=L*U;N=N*U;K=K*U}}else{R=0.0;L=0.0;N=0.0;K=0.0}W=+g[b+428>>2];U=R*W;if(O>U){a[b+526>>0]=1;if(O<R&W<.9999998807907104)R=(O-U)/(R-U);else R=1.0;g[b+528>>2]=R;g[b+504>>2]=O-U;if(+P(+L)>1.1920928955078125e-7){J=+P(+(L*-N/L*(J/M)));if(!(N<-0.0))J=-J;N=1.0/+Q(+(L*L+K*K+J*J));K=K*N;L=L*N;N=-(J*N)}la=-K;ka=-L;ja=-N;ha=(l*m+(n*o+p*q)-r*s)*ja+(p*n-l*r-o*q-s*m)*la-(p*s+n*m+r*q-l*o)*ka;ma=(p*n-l*r-o*q-s*m)*ka+(p*s+n*m+r*q-l*o)*la-(p*l+r*n+o*s-m*q)*ja;ia=(p*n-l*r-o*q-s*m)*ja+(p*l+r*n+o*s-m*q)*ka-(l*m+(n*o+p*q)-r*s)*la;ja=-((p*l+r*n+o*s-m*q)*la)-(l*m+(n*o+p*q)-r*s)*ka-(p*s+n*m+r*q-l*o)*ja;ka=ma*u+((p*n-l*r-o*q-s*m)*ha+ja*k)-ia*w;la=ia*k+((p*n-l*r-o*q-s*m)*ma+ja*w)-ha*u;ma=ha*w+((p*n-l*r-o*q-s*m)*ia+ja*u)-ma*k;g[b+460>>2]=ka;g[b+464>>2]=la;g[b+468>>2]=ma;g[b+472>>2]=0.0;c[b+536>>2]=0;c[b+540>>2]=0;c[b+544>>2]=0;c[b+548>>2]=0;g[b+492>>2]=1.0/(ka*(+g[f>>2]*ka+ +g[f+16>>2]*la+ +g[f+32>>2]*ma)+la*(ka*+g[f+4>>2]+la*+g[f+20>>2]+ma*+g[f+36>>2])+ma*(ka*+g[f+8>>2]+la*+g[f+24>>2]+ma*+g[f+40>>2])+(ka*(ka*+g[h>>2]+la*+g[h+16>>2]+ma*+g[h+32>>2])+la*(ka*+g[h+4>>2]+la*+g[h+20>>2]+ma*+g[h+36>>2])+ma*(ka*+g[h+8>>2]+la*+g[h+24>>2]+ma*+g[h+40>>2])))}}else I=23;a:do if((I|0)==23){N=+g[b+300>>2];R=+g[b+316>>2];K=+g[b+332>>2];Z=+g[d>>2];X=+g[d+4>>2];W=+g[d+8>>2];M=+g[d+16>>2];L=+g[d+20>>2];J=+g[d+24>>2];O=+g[d+32>>2];U=+g[d+36>>2];_=+g[d+40>>2];da=+g[b+304>>2];ca=+g[b+320>>2];ba=+g[b+336>>2];ga=+g[b+308>>2];fa=+g[b+324>>2];ea=+g[b+340>>2];ja=+g[b+364>>2];la=+g[b+380>>2];ha=+g[b+396>>2];$=ja*+g[e>>2]+la*+g[e+4>>2]+ha*+g[e+8>>2];aa=ja*+g[e+16>>2]+la*+g[e+20>>2]+ha*+g[e+24>>2];ha=ja*+g[e+32>>2]+la*+g[e+36>>2]+ha*+g[e+40>>2];la=(N*Z+R*X+K*W)*$+(N*M+R*L+K*J)*aa+(N*O+R*U+K*_)*ha;ja=(Z*da+X*ca+W*ba)*$+(M*da+L*ca+J*ba)*aa+(O*da+U*ca+_*ba)*ha;ia=(Z*ga+X*fa+W*ea)*$+(M*ga+L*fa+J*ea)*aa+(O*ga+U*fa+_*ea)*ha;ka=+g[b+444>>2];ma=+g[b+456>>2];do if(ka<ma){ka=+g[b+448>>2];if(ka<ma){if(+P(+ja)<1.1920928955078125e-7?+P(+ia)<1.1920928955078125e-7:0)break a;a[b+526>>0]=1;g[b+460>>2]=-((N*O+R*U+K*_)*aa-(N*M+R*L+K*J)*ha);g[b+464>>2]=-((N*Z+R*X+K*W)*ha-(N*O+R*U+K*_)*$);g[b+468>>2]=-((N*M+R*L+K*J)*$-(N*Z+R*X+K*W)*aa);g[b+472>>2]=0.0;break a}if(+P(+la)<1.1920928955078125e-7?+P(+ia)<1.1920928955078125e-7:0)break;a[b+526>>0]=1;if(ka>=ma){ja=+Y(+ia,+la);if(ja>ka){la=+S(+ka);ja=0.0;ia=+T(+ka);break}if(ja<-ka){la=+S(+ka);ja=0.0;ia=-+T(+ka)}else ja=0.0}}else{if(+P(+la)<1.1920928955078125e-7?+P(+ja)<1.1920928955078125e-7:0)break;a[b+526>>0]=1;if(ka>=ma){ia=+Y(+ja,+la);if(ia>ka){la=+S(+ka);ja=+T(+ka);ia=0.0;break}if(ia<-ka){la=+S(+ka);ja=-+T(+ka);ia=0.0}else ia=0.0}}while(0);ka=(Z*ga+X*fa+W*ea)*ia+((Z*da+X*ca+W*ba)*ja+(N*Z+R*X+K*W)*la);Z=(M*ga+L*fa+J*ea)*ia+((M*da+L*ca+J*ba)*ja+(N*M+R*L+K*J)*la);ja=(O*ga+U*fa+_*ea)*ia+((O*da+U*ca+_*ba)*ja+(N*O+R*U+K*_)*la);la=1.0/+Q(+(ja*ja+(ka*ka+Z*Z)));g[b+472>>2]=0.0;ma=+Q(+((aa*la*ja-ha*la*Z)*(aa*la*ja-ha*la*Z)+(ha*la*ka-$*la*ja)*(ha*la*ka-$*la*ja)+($*la*Z-aa*la*ka)*($*la*Z-aa*la*ka)));g[b+504>>2]=ma;g[b+460>>2]=-((aa*la*ja-ha*la*Z)*(1.0/ma));g[b+464>>2]=-((ha*la*ka-$*la*ja)*(1.0/ma));g[b+468>>2]=-(($*la*Z-aa*la*ka)*(1.0/ma))}while(0);J=+g[b+452>>2];if(!(J>=0.0)){g[b+512>>2]=0.0;i=j;return}K=H<-1.0?-1.0:H;K=+V(+(K>1.0?1.0:K))*2.0;if(K>3.1415927410125732){H=H>1.0?-1.0:-H;H=+V(+(H>1.0?1.0:H))*2.0;G=-G;F=-F;E=-E}else H=K;g[b+512>>2]=H;if(H>1.1920928955078125e-7){ma=1.0/+Q(+(E*E+(F*F+G*G)));G=G*ma;F=F*ma;E=E*ma}L=+g[b+428>>2];if(H>J*L){a[b+525>>0]=1;K=H-J*L;if(H<J&L<.9999998807907104)H=K/(J-J*L);else H=1.0;g[b+532>>2]=H;g[b+508>>2]=K;la=-G;ka=-F;ja=-E;ha=(l*m+(n*o+p*q)-r*s)*ja+(p*n-l*r-o*q-s*m)*la-(p*s+n*m+r*q-l*o)*ka;ma=(p*n-l*r-o*q-s*m)*ka+(p*s+n*m+r*q-l*o)*la-(p*l+r*n+o*s-m*q)*ja;ia=(p*n-l*r-o*q-s*m)*ja+(p*l+r*n+o*s-m*q)*ka-(l*m+(n*o+p*q)-r*s)*la;ja=-((p*l+r*n+o*s-m*q)*la)-(l*m+(n*o+p*q)-r*s)*ka-(p*s+n*m+r*q-l*o)*ja;ka=ma*u+((p*n-l*r-o*q-s*m)*ha+ja*k)-ia*w;la=ia*k+((p*n-l*r-o*q-s*m)*ma+ja*w)-ha*u;ma=ha*w+((p*n-l*r-o*q-s*m)*ia+ja*u)-ma*k;g[b+476>>2]=ka;g[b+480>>2]=la;g[b+484>>2]=ma;g[b+488>>2]=0.0;g[b+496>>2]=1.0/(ka*(+g[f>>2]*ka+ +g[f+16>>2]*la+ +g[f+32>>2]*ma)+la*(ka*+g[f+4>>2]+la*+g[f+20>>2]+ma*+g[f+36>>2])+ma*(ka*+g[f+8>>2]+la*+g[f+24>>2]+ma*+g[f+40>>2])+(ka*(ka*+g[h>>2]+la*+g[h+16>>2]+ma*+g[h+32>>2])+la*(ka*+g[h+4>>2]+la*+g[h+20>>2]+ma*+g[h+36>>2])+ma*(ka*+g[h+8>>2]+la*+g[h+24>>2]+ma*+g[h+40>>2])))}if(!(a[b+526>>0]|0)){i=j;return}ha=-G;ma=-F;ja=-E;ga=(x*y+(z*A+B*C)-D*v)*ja+(B*z-x*D-A*C-v*y)*ha-(B*v+z*y+D*C-x*A)*ma;la=(B*z-x*D-A*C-v*y)*ma+(B*v+z*y+D*C-x*A)*ha-(B*x+D*z+A*v-y*C)*ja;ia=(B*z-x*D-A*C-v*y)*ja+(B*x+D*z+A*v-y*C)*ma-(x*y+(z*A+B*C)-D*v)*ha;ja=-((B*x+D*z+A*v-y*C)*ha)-(x*y+(z*A+B*C)-D*v)*ma-(B*v+z*y+D*C-x*A)*ja;ma=-(B*x+D*z+A*v-y*C);ha=-(x*y+(z*A+B*C)-D*v);ka=-(B*v+z*y+D*C-x*A);g[b+536>>2]=la*ka+((B*z-x*D-A*C-v*y)*ga+ja*ma)-ia*ha;g[b+540>>2]=ia*ma+((B*z-x*D-A*C-v*y)*la+ja*ha)-ga*ka;g[b+544>>2]=ga*ha+((B*z-x*D-A*C-v*y)*ia+ja*ka)-la*ma;g[b+548>>2]=0.0;i=j;return}function yo(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0;e=i;i=i+64|0;k=c[b+28>>2]|0;o=c[b+32>>2]|0;xo(b,k+4|0,o+4|0,k+264|0,o+264|0);l=c[d+8>>2]|0;g[l>>2]=1.0;m=c[d+24>>2]|0;g[l+(m+1<<2)>>2]=1.0;g[l+((m<<1)+2<<2)>>2]=1.0;q=+g[b+348>>2];w=+g[b+352>>2];t=+g[b+356>>2];u=+g[k+4>>2]*q+ +g[k+8>>2]*w+ +g[k+12>>2]*t;r=q*+g[k+20>>2]+w*+g[k+24>>2]+t*+g[k+28>>2];t=q*+g[k+36>>2]+w*+g[k+40>>2]+t*+g[k+44>>2];l=c[d+12>>2]|0;g[l>>2]=0.0;g[l+4>>2]=t;g[l+8>>2]=-r;g[l+12>>2]=0.0;g[l+(m<<2)>>2]=-t;g[l+(m+1<<2)>>2]=0.0;g[l+(m+2<<2)>>2]=u;g[l+(m+3<<2)>>2]=0.0;g[l+(m<<1<<2)>>2]=r;g[l+((m<<1|1)<<2)>>2]=-u;g[l+((m<<1)+2<<2)>>2]=0.0;g[l+((m<<1)+3<<2)>>2]=0.0;l=c[d+16>>2]|0;g[l>>2]=-1.0;g[l+(m+1<<2)>>2]=-1.0;g[l+((m<<1)+2<<2)>>2]=-1.0;w=+g[b+412>>2];q=+g[b+416>>2];p=+g[b+420>>2];v=+g[o+4>>2]*w+ +g[o+8>>2]*q+ +g[o+12>>2]*p;s=w*+g[o+20>>2]+q*+g[o+24>>2]+p*+g[o+28>>2];p=w*+g[o+36>>2]+q*+g[o+40>>2]+p*+g[o+44>>2];l=c[d+20>>2]|0;g[l>>2]=0.0;g[l+4>>2]=-p;g[l+8>>2]=s;g[l+12>>2]=0.0;g[l+(m<<2)>>2]=p;g[l+(m+1<<2)>>2]=0.0;g[l+(m+2<<2)>>2]=-v;g[l+(m+3<<2)>>2]=0.0;g[l+(m<<1<<2)>>2]=-s;g[l+((m<<1|1)<<2)>>2]=v;g[l+((m<<1)+2<<2)>>2]=0.0;g[l+((m<<1)+3<<2)>>2]=0.0;m=c[b+592>>2]|0;q=+g[((m&2|0)==0?d+4|0:b+600|0)>>2]*+g[d>>2];f=c[d+24>>2]|0;n=c[d+28>>2]|0;j=c[d+36>>2]|0;h=c[d+40>>2]|0;g[n>>2]=q*(v+ +g[o+52>>2]-u- +g[k+52>>2]);g[j>>2]=-3.4028234663852886e+38;g[h>>2]=3.4028234663852886e+38;if(!(m&1)){g[n+(f<<2)>>2]=q*(s+ +g[o+56>>2]-r- +g[k+56>>2]);g[j+(f<<2)>>2]=-3.4028234663852886e+38;g[h+(f<<2)>>2]=3.4028234663852886e+38;g[n+(f<<1<<2)>>2]=q*(p+ +g[o+60>>2]-t- +g[k+60>>2]);g[j+(f<<1<<2)>>2]=-3.4028234663852886e+38;g[h+(f<<1<<2)>>2]=3.4028234663852886e+38}else{x=c[d+32>>2]|0;g[x>>2]=+g[b+596>>2];g[n+(f<<2)>>2]=q*(s+ +g[o+56>>2]-r- +g[k+56>>2]);g[j+(f<<2)>>2]=-3.4028234663852886e+38;g[h+(f<<2)>>2]=3.4028234663852886e+38;g[x+(f<<2)>>2]=+g[b+596>>2];g[n+(f<<1<<2)>>2]=q*(p+ +g[o+60>>2]-t- +g[k+60>>2]);g[j+(f<<1<<2)>>2]=-3.4028234663852886e+38;g[h+(f<<1<<2)>>2]=3.4028234663852886e+38;g[x+(f<<1<<2)>>2]=+g[b+596>>2]}do if(!(a[b+526>>0]|0))f=f*3|0;else{o=c[d+12>>2]|0;w=+g[b+456>>2];if(+g[b+444>>2]<w?+g[b+448>>2]<w:0){no(e,k+4|0,b+300|0);q=+g[e+4>>2];r=+g[e+20>>2];s=+g[e+36>>2];u=+g[e+8>>2];v=+g[e+24>>2];w=+g[e+40>>2];m=c[d+24>>2]|0;x=m+(f*3|0)|0;g[o+(f*3<<2)>>2]=q;g[o+((f*3|0)+1<<2)>>2]=r;g[o+((f*3|0)+2<<2)>>2]=s;g[o+(x<<2)>>2]=u;g[o+(x+1<<2)>>2]=v;g[o+(x+2<<2)>>2]=w;g[l+(f*3<<2)>>2]=-q;g[l+((f*3|0)+1<<2)>>2]=-r;g[l+((f*3|0)+2<<2)>>2]=-s;g[l+(x<<2)>>2]=-u;g[l+(x+1<<2)>>2]=-v;g[l+(x+2<<2)>>2]=-w;t=+g[d>>2]*+g[b+436>>2];n=c[d+28>>2]|0;g[n+(f*3<<2)>>2]=t*(q*+g[b+460>>2]+r*+g[b+464>>2]+s*+g[b+468>>2]);g[n+(x<<2)>>2]=t*(u*+g[b+460>>2]+v*+g[b+464>>2]+w*+g[b+468>>2]);j=c[d+36>>2]|0;g[j+(f*3<<2)>>2]=-3.4028234663852886e+38;h=c[d+40>>2]|0;g[h+(f*3<<2)>>2]=3.4028234663852886e+38;g[j+(x<<2)>>2]=-3.4028234663852886e+38;g[h+(x<<2)>>2]=3.4028234663852886e+38;f=m+x|0;break}w=+g[b+436>>2];u=w*+g[b+460>>2]*w;v=w*w*+g[b+464>>2];w=w*w*+g[b+468>>2];g[o+(f*3<<2)>>2]=u;g[o+((f*3|0)+1<<2)>>2]=v;g[o+((f*3|0)+2<<2)>>2]=w;g[l+(f*3<<2)>>2]=-u;g[l+((f*3|0)+1<<2)>>2]=-v;g[l+((f*3|0)+2<<2)>>2]=-w;g[n+(f*3<<2)>>2]=+g[d>>2]*+g[b+432>>2]*+g[b+504>>2];if(m&4)g[(c[d+32>>2]|0)+(f*3<<2)>>2]=+g[b+604>>2];g[j+(f*3<<2)>>2]=0.0;g[h+(f*3<<2)>>2]=3.4028234663852886e+38;f=f+(f*3|0)|0}while(0);if(!(a[b+525>>0]|0)){i=e;return}w=+g[b+436>>2];u=w*+g[b+476>>2]*w;v=w*w*+g[b+480>>2];w=w*w*+g[b+484>>2];l=c[d+12>>2]|0;o=c[d+20>>2]|0;g[l+(f<<2)>>2]=u;m=f+1|0;g[l+(m<<2)>>2]=v;x=f+2|0;g[l+(x<<2)>>2]=w;g[o+(f<<2)>>2]=-u;g[o+(m<<2)>>2]=-v;g[o+(x<<2)>>2]=-w;g[n+(f<<2)>>2]=+g[d>>2]*+g[b+432>>2]*+g[b+508>>2];if(c[b+592>>2]&4)g[(c[d+32>>2]|0)+(f<<2)>>2]=+g[b+604>>2];if(!(+g[b+452>>2]>0.0)){g[j+(f<<2)>>2]=-3.4028234663852886e+38;g[h+(f<<2)>>2]=3.4028234663852886e+38;i=e;return}d=j+(f<<2)|0;if(+g[b+508>>2]>0.0){g[d>>2]=0.0;g[h+(f<<2)>>2]=3.4028234663852886e+38;i=e;return}else{g[d>>2]=-3.4028234663852886e+38;g[h+(f<<2)>>2]=0.0;i=e;return}}function zo(b){b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0,M=0;d=i;i=i+176|0;if(!(a[b+527>>0]|0)){i=d;return}g[b+36>>2]=0.0;g[b+520>>2]=0.0;g[b+516>>2]=0.0;c[b+576>>2]=0;c[b+580>>2]=0;c[b+584>>2]=0;c[b+588>>2]=0;a:do if(!(a[b+524>>0]|0)){L=c[b+28>>2]|0;A=+g[b+348>>2];z=+g[b+352>>2];f=+g[b+356>>2];e=A*+g[L+20>>2]+z*+g[L+24>>2]+f*+g[L+28>>2]+ +g[L+56>>2];y=c[b+32>>2]|0;j=+g[b+412>>2];k=+g[y+4>>2];l=+g[b+416>>2];m=+g[y+8>>2];n=+g[b+420>>2];x=+g[y+12>>2];q=+g[y+20>>2];r=+g[y+24>>2];s=+g[y+28>>2];u=+g[y+36>>2];v=+g[y+40>>2];w=+g[y+44>>2];p=+g[y+52>>2];t=+g[y+56>>2];o=+g[y+60>>2];B=j*q+l*r+n*s+t-e;h=A*+g[L+4>>2]+z*+g[L+8>>2]+f*+g[L+12>>2]+ +g[L+52>>2];f=A*+g[L+36>>2]+z*+g[L+40>>2]+f*+g[L+44>>2]+ +g[L+60>>2];z=j*k+l*m+n*x+p-h;A=j*u+l*v+n*w+o-f;if(z*z+B*B+A*A>1.1920928955078125e-7){K=1.0/+Q(+(z*z+B*B+A*A));g[d+128>>2]=z*K;g[d+132>>2]=B*K;g[d+136>>2]=A*K;g[d+140>>2]=0.0;A=A*K;B=B*K;z=z*K}else{g[d+128>>2]=1.0;g[d+132>>2]=0.0;g[d+136>>2]=0.0;g[d+140>>2]=0.0;A=0.0;B=0.0;z=1.0}if(+P(+A)>.7071067690849304){H=A*A+B*B;I=1.0/+Q(+H);g[d+144>>2]=0.0;K=-(I*A);g[d+148>>2]=K;J=I*B;g[d+152>>2]=J;g[d+160>>2]=H*I;g[d+164>>2]=-(z*J);g[d+168>>2]=z*K}else{J=z*z+B*B;K=1.0/+Q(+J);I=-(B*K);g[d+144>>2]=I;H=K*z;g[d+148>>2]=H;g[d+152>>2]=0.0;g[d+160>>2]=-(A*H);g[d+164>>2]=A*I;g[d+168>>2]=J*K}F=k;B=q;C=u;D=m;E=r;I=v;A=x;K=s;J=w;z=p;H=t;G=o;L=0;while(1){M=c[b+28>>2]|0;g[d+80>>2]=+g[M+4>>2];g[d+84>>2]=+g[M+20>>2];g[d+88>>2]=+g[M+36>>2];g[d+92>>2]=0.0;g[d+96>>2]=+g[M+8>>2];g[d+100>>2]=+g[M+24>>2];g[d+104>>2]=+g[M+40>>2];g[d+108>>2]=0.0;g[d+112>>2]=+g[M+12>>2];g[d+116>>2]=+g[M+28>>2];g[d+120>>2]=+g[M+44>>2];g[d+124>>2]=0.0;g[d+32>>2]=F;g[d+36>>2]=B;g[d+40>>2]=C;g[d+44>>2]=0.0;g[d+48>>2]=D;g[d+52>>2]=E;g[d+56>>2]=I;g[d+60>>2]=0.0;g[d+64>>2]=A;g[d+68>>2]=K;g[d+72>>2]=J;g[d+76>>2]=0.0;J=e- +g[M+56>>2];K=f- +g[M+60>>2];g[d+16>>2]=h- +g[M+52>>2];g[d+20>>2]=J;g[d+24>>2]=K;g[d+28>>2]=0.0;g[d>>2]=j*k+l*m+n*x+p-z;g[d+4>>2]=j*q+l*r+n*s+t-H;g[d+8>>2]=j*u+l*v+n*w+o-G;g[d+12>>2]=0.0;Mo(b+(L*84|0)+48|0,d+80|0,d+32|0,d+16|0,d,d+128+(L<<4)|0,M+396|0,+g[M+344>>2],y+396|0,+g[y+344>>2]);L=L+1|0;if((L|0)==3){y=b+32|0;break a}y=c[b+32>>2]|0;F=+g[y+4>>2];B=+g[y+20>>2];C=+g[y+36>>2];D=+g[y+8>>2];E=+g[y+24>>2];I=+g[y+40>>2];A=+g[y+12>>2];K=+g[y+28>>2];J=+g[y+44>>2];z=+g[y+52>>2];H=+g[y+56>>2];G=+g[y+60>>2]}}else y=b+32|0;while(0);L=c[b+28>>2]|0;M=c[y>>2]|0;xo(b,L+4|0,M+4|0,L+264|0,M+264|0);i=d;return}function Ao(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0,K=0,L=0,M=0,N=0,O=0,P=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0;h=i;i=i+448|0;if(!(a[b+527>>0]|0)){i=h;return}O=c[b+28>>2]|0;I=+g[b+348>>2];E=+g[b+352>>2];F=+g[b+356>>2];C=+g[O+52>>2];D=I*+g[O+4>>2]+E*+g[O+8>>2]+F*+g[O+12>>2]+C;z=+g[O+56>>2];B=I*+g[O+20>>2]+E*+g[O+24>>2]+F*+g[O+28>>2]+z;p=+g[O+60>>2];F=I*+g[O+36>>2]+E*+g[O+40>>2]+F*+g[O+44>>2]+p;O=c[b+32>>2]|0;E=+g[b+412>>2];I=+g[b+416>>2];y=+g[b+420>>2];w=+g[O+52>>2];v=E*+g[O+4>>2]+I*+g[O+8>>2]+y*+g[O+12>>2]+w;G=+g[O+56>>2];H=E*+g[O+20>>2]+I*+g[O+24>>2]+y*+g[O+28>>2]+G;u=+g[O+60>>2];y=E*+g[O+36>>2]+I*+g[O+40>>2]+y*+g[O+44>>2]+u;if(!(a[b+524>>0]|0)){s=+g[d+192>>2]+ +g[d+80>>2];t=+g[d+196>>2]+ +g[d+84>>2];r=+g[d+200>>2]+ +g[d+88>>2];I=+g[e+192>>2]+ +g[e+80>>2];E=+g[e+196>>2]+ +g[e+84>>2];A=+g[e+200>>2]+ +g[e+88>>2];x=+g[d+176>>2]+ +g[d+64>>2]+((F-p)*t-(B-z)*r)-(+g[e+176>>2]+ +g[e+64>>2]+((y-u)*E-(H-G)*A));A=+g[d+180>>2]+ +g[d+68>>2]+((D-C)*r-(F-p)*s)-(+g[e+180>>2]+ +g[e+68>>2]+((v-w)*A-(y-u)*I));E=+g[d+184>>2]+ +g[d+72>>2]+((B-z)*s-(D-C)*t)-(+g[e+184>>2]+ +g[e+72>>2]+((H-G)*I-(v-w)*E));n=c[d+240>>2]|0;j=0;do{q=1.0/+g[b+(j*84|0)+128>>2];m=b+(j*84|0)+48|0;s=+g[m>>2];k=b+(j*84|0)+52|0;r=+g[k>>2];l=b+(j*84|0)+56|0;t=+g[l>>2];t=q*(((D-v)*s+(B-H)*r+(F-y)*t)*-.30000001192092896/f)-q*(x*s+A*r+E*t);g[b+36>>2]=+g[b+36>>2]+t;r=+g[l>>2];s=+g[k>>2];q=+g[m>>2];o=c[b+28>>2]|0;I=+g[o+344>>2];if(n){S=((F-p)*q-(D-C)*r)*+g[o+300>>2]+((B-z)*r-(F-p)*s)*+g[o+296>>2]+((D-C)*s-(B-z)*q)*+g[o+304>>2];P=((F-p)*q-(D-C)*r)*+g[o+284>>2]+((B-z)*r-(F-p)*s)*+g[o+280>>2]+((D-C)*s-(B-z)*q)*+g[o+288>>2];R=((F-p)*q-(D-C)*r)*+g[o+268>>2]+((B-z)*r-(F-p)*s)*+g[o+264>>2]+((D-C)*s-(B-z)*q)*+g[o+272>>2];U=t*s*I*+g[d+116>>2];T=t*r*I*+g[d+120>>2];g[d+64>>2]=t*q*I*+g[d+112>>2]+ +g[d+64>>2];g[d+68>>2]=U+ +g[d+68>>2];g[d+72>>2]=T+ +g[d+72>>2];P=P*t*+g[d+100>>2];I=S*t*+g[d+104>>2];g[d+80>>2]=R*t*+g[d+96>>2]+ +g[d+80>>2];g[d+84>>2]=P+ +g[d+84>>2];g[d+88>>2]=I+ +g[d+88>>2]}o=c[b+32>>2]|0;I=+g[o+344>>2];if(c[e+240>>2]|0){U=((y-u)*q-(v-w)*r)*+g[o+300>>2]+((H-G)*r-(y-u)*s)*+g[o+296>>2]+((v-w)*s-(H-G)*q)*+g[o+304>>2];T=((y-u)*q-(v-w)*r)*+g[o+284>>2]+((H-G)*r-(y-u)*s)*+g[o+280>>2]+((v-w)*s-(H-G)*q)*+g[o+288>>2];S=((y-u)*q-(v-w)*r)*+g[o+268>>2]+((H-G)*r-(y-u)*s)*+g[o+264>>2]+((v-w)*s-(H-G)*q)*+g[o+272>>2];P=I*+g[k>>2]*-t*+g[e+116>>2];R=I*+g[l>>2]*-t*+g[e+120>>2];g[e+64>>2]=+g[e+112>>2]*I*+g[m>>2]*-t+ +g[e+64>>2];g[e+68>>2]=P+ +g[e+68>>2];g[e+72>>2]=R+ +g[e+72>>2];T=T*+g[e+100>>2]*-t;U=U*+g[e+104>>2]*-t;g[e+80>>2]=S*+g[e+96>>2]*-t+ +g[e+80>>2];g[e+84>>2]=T+ +g[e+84>>2];g[e+88>>2]=U+ +g[e+88>>2]}j=j+1|0}while((j|0)!=3)}do if(!(a[b+552>>0]|0)){q=+g[b+440>>2];if(!(q>1.1920928955078125e-7)){n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0;break}z=+g[e+192>>2]+ +g[e+80>>2]-(+g[d+192>>2]+ +g[d+80>>2]);B=+g[e+196>>2]+ +g[e+84>>2]-(+g[d+196>>2]+ +g[d+84>>2]);A=+g[e+200>>2]+ +g[e+88>>2]-(+g[d+200>>2]+ +g[d+88>>2]);if(z*z+B*B+A*A>1.1920928955078125e-7){U=1.0/+Q(+(z*z+B*B+A*A));j=c[b+28>>2]|0;p=+g[j+264>>2];x=+g[j+280>>2];u=+g[j+296>>2];s=+g[j+268>>2];y=+g[j+284>>2];v=+g[j+300>>2];r=+g[j+272>>2];w=+g[j+288>>2];t=+g[j+304>>2];j=c[b+32>>2]|0;U=q*(1.0/(z*U*(z*U*p+B*U*x+A*U*u)+B*U*(z*U*s+B*U*y+A*U*v)+A*U*(z*U*r+B*U*w+A*U*t)+(z*U*(z*U*+g[j+264>>2]+B*U*+g[j+280>>2]+A*U*+g[j+296>>2])+B*U*(z*U*+g[j+268>>2]+B*U*+g[j+284>>2]+A*U*+g[j+300>>2])+A*U*(z*U*+g[j+272>>2]+B*U*+g[j+288>>2]+A*U*+g[j+304>>2]))));q=+Q(+(A*U*A*U+(z*U*z*U+B*U*B*U)));z=1.0/q*z*U;B=1.0/q*B*U;A=1.0/q*A*U;if(c[d+240>>2]|0){U=q*0.0*+g[d+116>>2];T=q*0.0*+g[d+120>>2];g[d+64>>2]=q*0.0*+g[d+112>>2]+ +g[d+64>>2];g[d+68>>2]=U+ +g[d+68>>2];g[d+72>>2]=T+ +g[d+72>>2];T=(B*y+z*x+A*w)*q*+g[d+100>>2];U=(B*v+z*u+A*t)*q*+g[d+104>>2];g[d+80>>2]=(B*s+z*p+A*r)*q*+g[d+96>>2]+ +g[d+80>>2];g[d+84>>2]=T+ +g[d+84>>2];g[d+88>>2]=U+ +g[d+88>>2];j=c[b+32>>2]|0}if(c[e+240>>2]|0){U=B*+g[j+300>>2]+z*+g[j+296>>2]+A*+g[j+304>>2];T=B*+g[j+284>>2]+z*+g[j+280>>2]+A*+g[j+288>>2];S=B*+g[j+268>>2]+z*+g[j+264>>2]+A*+g[j+272>>2];P=q*-0.0*+g[e+116>>2];R=q*-0.0*+g[e+120>>2];g[e+64>>2]=q*-0.0*+g[e+112>>2]+ +g[e+64>>2];g[e+68>>2]=P+ +g[e+68>>2];g[e+72>>2]=R+ +g[e+72>>2];T=T*+g[e+100>>2]*-q;U=U*+g[e+104>>2]*-q;g[e+80>>2]=S*+g[e+96>>2]*-q+ +g[e+80>>2];g[e+84>>2]=T+ +g[e+84>>2];g[e+88>>2]=U+ +g[e+88>>2];n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}else{n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}}else{n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}}else{N=c[b+28>>2]|0;c[h+352>>2]=c[N+4>>2];c[h+356>>2]=c[N+8>>2];c[h+360>>2]=c[N+12>>2];c[h+364>>2]=c[N+16>>2];c[h+368>>2]=c[N+20>>2];c[h+372>>2]=c[N+24>>2];c[h+376>>2]=c[N+28>>2];c[h+380>>2]=c[N+32>>2];c[h+384>>2]=c[N+36>>2];c[h+388>>2]=c[N+40>>2];c[h+392>>2]=c[N+44>>2];c[h+396>>2]=c[N+48>>2];c[h+400>>2]=c[N+52>>2];c[h+404>>2]=c[N+56>>2];c[h+408>>2]=c[N+60>>2];c[h+412>>2]=c[N+64>>2];N=c[b+32>>2]|0;c[h+288>>2]=c[N+4>>2];c[h+292>>2]=c[N+8>>2];c[h+296>>2]=c[N+12>>2];c[h+300>>2]=c[N+16>>2];c[h+304>>2]=c[N+20>>2];c[h+308>>2]=c[N+24>>2];c[h+312>>2]=c[N+28>>2];c[h+316>>2]=c[N+32>>2];c[h+320>>2]=c[N+36>>2];c[h+324>>2]=c[N+40>>2];c[h+328>>2]=c[N+44>>2];c[h+332>>2]=c[N+48>>2];c[h+336>>2]=c[N+52>>2];c[h+340>>2]=c[N+56>>2];c[h+344>>2]=c[N+60>>2];c[h+348>>2]=c[N+64>>2];S=+g[d+196>>2]+ +g[d+84>>2];C=+g[d+200>>2]+ +g[d+88>>2];g[h+272>>2]=+g[d+192>>2]+ +g[d+80>>2];g[h+276>>2]=S;g[h+280>>2]=C;g[h+284>>2]=0.0;C=+g[e+196>>2]+ +g[e+84>>2];S=+g[e+200>>2]+ +g[e+88>>2];g[h+256>>2]=+g[e+192>>2]+ +g[e+80>>2];g[h+260>>2]=C;g[h+264>>2]=S;g[h+268>>2]=0.0;g[h+192>>2]=1.0;N=h+196|0;c[N+0>>2]=0;c[N+4>>2]=0;c[N+8>>2]=0;c[N+12>>2]=0;g[h+212>>2]=1.0;O=h+216|0;c[O+0>>2]=0;c[O+4>>2]=0;c[O+8>>2]=0;c[O+12>>2]=0;g[h+232>>2]=1.0;L=h+236|0;c[L+0>>2]=0;c[L+4>>2]=0;c[L+8>>2]=0;c[L+12>>2]=0;c[L+16>>2]=0;Bo(h+352|0,0.0,0.0,0.0,h+272|0,f,h+192|0);g[h+128>>2]=1.0;L=h+132|0;c[L+0>>2]=0;c[L+4>>2]=0;c[L+8>>2]=0;c[L+12>>2]=0;g[h+148>>2]=1.0;M=h+152|0;c[M+0>>2]=0;c[M+4>>2]=0;c[M+8>>2]=0;c[M+12>>2]=0;g[h+168>>2]=1.0;K=h+172|0;c[K+0>>2]=0;c[K+4>>2]=0;c[K+8>>2]=0;c[K+12>>2]=0;c[K+16>>2]=0;Bo(h+288|0,0.0,0.0,0.0,h+256|0,f,h+128|0);S=+g[b+556>>2];C=+g[b+560>>2];T=+g[b+564>>2];D=+g[b+568>>2];G=S*(2.0/(S*S+C*C+T*T+D*D));r=C*(2.0/(S*S+C*C+T*T+D*D));H=T*(2.0/(S*S+C*C+T*T+D*D));W=+g[b+364>>2];V=+g[b+368>>2];Z=+g[b+372>>2];w=(S*H-D*r)*Z+(V*(S*r+D*H)+W*(1.0-(C*r+T*H)));x=Z*(C*H+D*G)+(W*(S*r-D*H)+V*(1.0-(S*G+T*H)));y=W*(S*H+D*r)+V*(C*H-D*G)+Z*(1.0-(S*G+C*r));v=+g[b+380>>2];F=+g[b+384>>2];p=+g[b+388>>2];z=(1.0-(C*r+T*H))*v+(S*r+D*H)*F+(S*H-D*r)*p;A=(S*r-D*H)*v+(1.0-(S*G+T*H))*F+(C*H+D*G)*p;B=(S*H+D*r)*v+(C*H-D*G)*F+(1.0-(S*G+C*r))*p;P=+g[b+396>>2];q=+g[b+400>>2];s=+g[b+404>>2];R=(1.0-(C*r+T*H))*P+(S*r+D*H)*q+(S*H-D*r)*s;T=(S*r-D*H)*P+(1.0-(S*G+T*H))*q+(C*H+D*G)*s;r=(S*H+D*r)*P+(C*H-D*G)*q+(1.0-(S*G+C*r))*s;C=+g[b+300>>2];G=+g[b+316>>2];S=+g[b+332>>2];D=+g[b+304>>2];H=+g[b+320>>2];U=+g[b+336>>2];E=+g[b+308>>2];I=+g[b+324>>2];t=+g[b+340>>2];u=-+g[b+348>>2];aa=-+g[b+352>>2];Y=-+g[b+356>>2];Z=W*0.0+V*0.0+Z*0.0+ +g[b+412>>2]+(y*(E*u+I*aa+t*Y)+(w*(C*u+G*aa+S*Y)+x*(D*u+H*aa+U*Y)));p=v*0.0+F*0.0+p*0.0+ +g[b+416>>2]+(B*(E*u+I*aa+t*Y)+(z*(C*u+G*aa+S*Y)+A*(D*u+H*aa+U*Y)));Y=P*0.0+q*0.0+s*0.0+ +g[b+420>>2]+(r*(E*u+I*aa+t*Y)+(R*(C*u+G*aa+S*Y)+T*(D*u+H*aa+U*Y)));aa=+g[h+128>>2];u=+g[L>>2];s=+g[h+136>>2];q=+g[h+144>>2];P=+g[h+148>>2];F=+g[M>>2];v=+g[h+160>>2];V=+g[h+164>>2];W=+g[h+168>>2];X=s*Y+(aa*Z+u*p)+ +g[h+176>>2];_=Y*F+(q*Z+P*p)+ +g[h+180>>2];$=Z*v+p*V+Y*W+ +g[h+184>>2];g[h+64>>2]=(w*C+x*D+y*E)*aa+(z*C+A*D+B*E)*u+(R*C+T*D+r*E)*s;g[h+68>>2]=(w*G+x*H+y*I)*aa+(z*G+A*H+B*I)*u+(R*G+T*H+r*I)*s;g[h+72>>2]=(w*S+x*U+y*t)*aa+(z*S+A*U+B*t)*u+(R*S+T*U+r*t)*s;g[h+76>>2]=0.0;g[h+80>>2]=(w*C+x*D+y*E)*q+(z*C+A*D+B*E)*P+(R*C+T*D+r*E)*F;g[h+84>>2]=(w*G+x*H+y*I)*q+(z*G+A*H+B*I)*P+(R*G+T*H+r*I)*F;g[h+88>>2]=(w*S+x*U+y*t)*q+(z*S+A*U+B*t)*P+(R*S+T*U+r*t)*F;g[h+92>>2]=0.0;g[h+96>>2]=(w*C+x*D+y*E)*v+(z*C+A*D+B*E)*V+(R*C+T*D+r*E)*W;g[h+100>>2]=(w*G+x*H+y*I)*v+(z*G+A*H+B*I)*V+(R*G+T*H+r*I)*W;g[h+104>>2]=(w*S+x*U+y*t)*v+(z*S+A*U+B*t)*V+(R*S+T*U+r*t)*W;g[h+108>>2]=0.0;g[h+112>>2]=X;g[h+116>>2]=_;g[h+120>>2]=$;g[h+124>>2]=0.0;$=(R*C+T*D+r*E)*-Y+((w*C+x*D+y*E)*-Z+(z*C+A*D+B*E)*-p);_=(R*G+T*H+r*I)*-Y+((w*G+x*H+y*I)*-Z+(z*G+A*H+B*I)*-p);p=(R*S+T*U+r*t)*-Y+((w*S+x*U+y*t)*-Z+(z*S+A*U+B*t)*-p);Z=+g[h+192>>2];Y=+g[N>>2];X=+g[h+200>>2];W=+g[h+208>>2];V=+g[h+212>>2];v=+g[O>>2];F=+g[h+224>>2];P=+g[h+228>>2];q=+g[h+232>>2];s=$*Z+_*Y+p*X+ +g[h+240>>2];u=$*W+_*V+p*v+ +g[h+244>>2];p=$*F+_*P+p*q+ +g[h+248>>2];g[h>>2]=(w*C+x*D+y*E)*Z+(w*G+x*H+y*I)*Y+(w*S+x*U+y*t)*X;g[h+4>>2]=(z*C+A*D+B*E)*Z+(z*G+A*H+B*I)*Y+(z*S+A*U+B*t)*X;g[h+8>>2]=(R*C+T*D+r*E)*Z+(R*G+T*H+r*I)*Y+(R*S+T*U+r*t)*X;g[h+12>>2]=0.0;g[h+16>>2]=(w*C+x*D+y*E)*W+(w*G+x*H+y*I)*V+(w*S+x*U+y*t)*v;g[h+20>>2]=(z*C+A*D+B*E)*W+(z*G+A*H+B*I)*V+(z*S+A*U+B*t)*v;g[h+24>>2]=(R*C+T*D+r*E)*W+(R*G+T*H+r*I)*V+(R*S+T*U+r*t)*v;g[h+28>>2]=0.0;g[h+32>>2]=(w*C+x*D+y*E)*F+(w*G+x*H+y*I)*P+(w*S+x*U+y*t)*q;g[h+36>>2]=(z*C+A*D+B*E)*F+(z*G+A*H+B*I)*P+(z*S+A*U+B*t)*q;g[h+40>>2]=(R*C+T*D+r*E)*F+(R*G+T*H+r*I)*P+(R*S+T*U+r*t)*q;g[h+44>>2]=0.0;g[h+48>>2]=s;g[h+52>>2]=u;g[h+56>>2]=p;g[h+60>>2]=0.0;Lo(h+352|0,h+64|0,h+424|0,h+416|0);p=+g[h+416>>2];u=1.0/f*+g[h+424>>2]*p;s=1.0/f*p*+g[h+428>>2];p=1.0/f*p*+g[h+432>>2];Lo(h+288|0,h,h+424|0,h+416|0);q=+g[h+416>>2];u=u- +g[h+272>>2];s=s- +g[h+276>>2];p=p- +g[h+280>>2];t=1.0/f*+g[h+424>>2]*q- +g[h+256>>2];r=1.0/f*q*+g[h+428>>2]- +g[h+260>>2];q=1.0/f*q*+g[h+432>>2]- +g[h+264>>2];if(u*u+s*s+p*p>1.1920928955078125e-7){x=1.0/+Q(+(u*u+s*s+p*p));O=c[b+28>>2]|0;A=u*x*(u*x*+g[O+264>>2]+s*x*+g[O+280>>2]+p*x*+g[O+296>>2])+s*x*(u*x*+g[O+268>>2]+s*x*+g[O+284>>2]+p*x*+g[O+300>>2])+p*x*(u*x*+g[O+272>>2]+s*x*+g[O+288>>2]+p*x*+g[O+304>>2]);v=u*x;y=s*x;x=p*x}else{A=0.0;v=0.0;y=0.0;x=0.0}if(t*t+r*r+q*q>1.1920928955078125e-7){w=1.0/+Q(+(t*t+r*r+q*q));O=c[b+32>>2]|0;z=t*w*(t*w*+g[O+264>>2]+r*w*+g[O+280>>2]+q*w*+g[O+296>>2])+r*w*(t*w*+g[O+268>>2]+r*w*+g[O+284>>2]+q*w*+g[O+300>>2])+q*w*(t*w*+g[O+272>>2]+r*w*+g[O+288>>2]+q*w*+g[O+304>>2]);C=t*w;B=r*w;w=q*w}else{z=0.0;C=0.0;B=0.0;w=0.0}v=v*A+C*z;y=y*A+B*z;x=x*A+w*z;if(x*x+(v*v+y*y)>1.1920928955078125e-7){aa=1.0/+Q(+(x*x+(v*v+y*y)));k=c[b+28>>2]|0;w=v*aa*(v*aa*+g[k+264>>2]+y*aa*+g[k+280>>2]+x*aa*+g[k+296>>2])+y*aa*(v*aa*+g[k+268>>2]+y*aa*+g[k+284>>2]+x*aa*+g[k+300>>2])+x*aa*(v*aa*+g[k+272>>2]+y*aa*+g[k+288>>2]+x*aa*+g[k+304>>2]);j=c[b+32>>2]|0;v=v*aa*(v*aa*+g[j+264>>2]+y*aa*+g[j+280>>2]+x*aa*+g[j+296>>2])+y*aa*(v*aa*+g[j+268>>2]+y*aa*+g[j+284>>2]+x*aa*+g[j+300>>2])+x*aa*(v*aa*+g[j+272>>2]+y*aa*+g[j+288>>2]+x*aa*+g[j+304>>2]);t=1.0/((w+v)*(w+v))*(u*w-t*v);r=1.0/((w+v)*(w+v))*(s*w-r*v);p=1.0/((w+v)*(w+v))*(p*w-q*v);v=+g[b+572>>2];if(v>=0.0){if(a[b+553>>0]|0)v=v/w;s=+g[b+576>>2];q=+g[b+580>>2];u=+g[b+584>>2];w=+Q(+((t+s)*(t+s)+(r+q)*(r+q)+(p+u)*(p+u)));if(w>v){t=v*(t+s)*(1.0/w)-s;r=v*(r+q)*(1.0/w)-q;p=v*(p+u)*(1.0/w)-u}g[b+576>>2]=t+s;g[b+580>>2]=r+q;g[b+584>>2]=p+u}q=+Q(+(p*p+(r*r+t*t)));s=t*(1.0/q);r=r*(1.0/q);p=p*(1.0/q);if(c[d+240>>2]|0){aa=r*+g[k+300>>2]+s*+g[k+296>>2]+p*+g[k+304>>2];$=r*+g[k+284>>2]+s*+g[k+280>>2]+p*+g[k+288>>2];_=r*+g[k+268>>2]+s*+g[k+264>>2]+p*+g[k+272>>2];Y=q*0.0*+g[d+116>>2];Z=q*0.0*+g[d+120>>2];g[d+64>>2]=q*0.0*+g[d+112>>2]+ +g[d+64>>2];g[d+68>>2]=Y+ +g[d+68>>2];g[d+72>>2]=Z+ +g[d+72>>2];$=$*q*+g[d+100>>2];aa=aa*q*+g[d+104>>2];g[d+80>>2]=_*q*+g[d+96>>2]+ +g[d+80>>2];g[d+84>>2]=$+ +g[d+84>>2];g[d+88>>2]=aa+ +g[d+88>>2];j=c[b+32>>2]|0}if(c[e+240>>2]|0){aa=r*+g[j+300>>2]+s*+g[j+296>>2]+p*+g[j+304>>2];$=r*+g[j+284>>2]+s*+g[j+280>>2]+p*+g[j+288>>2];_=r*+g[j+268>>2]+s*+g[j+264>>2]+p*+g[j+272>>2];Y=q*-0.0*+g[e+116>>2];Z=q*-0.0*+g[e+120>>2];g[e+64>>2]=q*-0.0*+g[e+112>>2]+ +g[e+64>>2];g[e+68>>2]=Y+ +g[e+68>>2];g[e+72>>2]=Z+ +g[e+72>>2];$=$*+g[e+100>>2]*-q;aa=aa*+g[e+104>>2]*-q;g[e+80>>2]=_*+g[e+96>>2]*-q+ +g[e+80>>2];g[e+84>>2]=$+ +g[e+84>>2];g[e+88>>2]=aa+ +g[e+88>>2];n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}else{n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}}else{n=d+80|0;N=d+196|0;m=d+84|0;M=d+200|0;o=d+88|0;L=e+192|0;k=e+80|0;K=e+196|0;l=e+84|0;J=e+200|0;j=e+88|0;O=d+192|0}}while(0);p=+g[O>>2]+ +g[n>>2];q=+g[N>>2]+ +g[m>>2];r=+g[M>>2]+ +g[o>>2];s=+g[L>>2]+ +g[k>>2];t=+g[K>>2]+ +g[l>>2];u=+g[J>>2]+ +g[j>>2];if(a[b+526>>0]|0){z=+g[b+528>>2];w=z*+g[b+504>>2]*+g[b+432>>2]/f;x=+g[b+460>>2];y=+g[b+464>>2];v=+g[b+468>>2];if((s-p)*x+(t-q)*y+(u-r)*v>0.0)w=w+z*((s-p)*x+(t-q)*y+(u-r)*v)*+g[b+436>>2];_=+g[b+516>>2];Z=_+w*+g[b+492>>2];Z=Z>0.0?Z:0.0;g[b+516>>2]=Z;X=+g[b+536>>2];Y=+g[b+540>>2];$=+g[b+544>>2];aa=X*x*(Z-_)+y*(Z-_)*Y+v*(Z-_)*$;w=+Q(+((v*(Z-_)-$*aa)*(v*(Z-_)-$*aa)+((x*(Z-_)-X*aa)*(x*(Z-_)-X*aa)+(y*(Z-_)-Y*aa)*(y*(Z-_)-Y*aa))));x=1.0/w*(x*(Z-_)-X*aa);y=1.0/w*(y*(Z-_)-Y*aa);v=1.0/w*(v*(Z-_)-$*aa);J=c[b+28>>2]|0;if(c[d+240>>2]|0){aa=y*+g[J+300>>2]+x*+g[J+296>>2]+v*+g[J+304>>2];$=y*+g[J+284>>2]+x*+g[J+280>>2]+v*+g[J+288>>2];_=y*+g[J+268>>2]+x*+g[J+264>>2]+v*+g[J+272>>2];Y=w*0.0*+g[d+116>>2];Z=w*0.0*+g[d+120>>2];g[d+64>>2]=w*0.0*+g[d+112>>2]+ +g[d+64>>2];g[d+68>>2]=Y+ +g[d+68>>2];g[d+72>>2]=Z+ +g[d+72>>2];$=$*w*+g[d+100>>2];aa=aa*w*+g[d+104>>2];g[n>>2]=_*w*+g[d+96>>2]+ +g[n>>2];g[m>>2]=$+ +g[m>>2];g[o>>2]=aa+ +g[o>>2]}J=c[b+32>>2]|0;if(c[e+240>>2]|0){aa=y*+g[J+300>>2]+x*+g[J+296>>2]+v*+g[J+304>>2];$=y*+g[J+284>>2]+x*+g[J+280>>2]+v*+g[J+288>>2];_=y*+g[J+268>>2]+x*+g[J+264>>2]+v*+g[J+272>>2];Y=w*-0.0*+g[e+116>>2];Z=w*-0.0*+g[e+120>>2];g[e+64>>2]=w*-0.0*+g[e+112>>2]+ +g[e+64>>2];g[e+68>>2]=Y+ +g[e+68>>2];g[e+72>>2]=Z+ +g[e+72>>2];$=$*+g[e+100>>2]*-w;aa=aa*+g[e+104>>2]*-w;g[k>>2]=_*+g[e+96>>2]*-w+ +g[k>>2];g[l>>2]=$+ +g[l>>2];g[j>>2]=aa+ +g[j>>2]}}if(!(a[b+525>>0]|0)){i=h;return}x=+g[b+532>>2];y=x*+g[b+508>>2]*+g[b+432>>2]/f;v=+g[b+476>>2];w=+g[b+480>>2];f=+g[b+484>>2];if((s-p)*v+(t-q)*w+(u-r)*f>0.0)y=y+x*((s-p)*v+(t-q)*w+(u-r)*f)*+g[b+436>>2];p=+g[b+520>>2];q=p+y*+g[b+496>>2];q=q>0.0?q:0.0;g[b+520>>2]=q;J=c[b+28>>2]|0;if(c[d+240>>2]|0){aa=w*+g[J+300>>2]+v*+g[J+296>>2]+f*+g[J+304>>2];$=w*+g[J+284>>2]+v*+g[J+280>>2]+f*+g[J+288>>2];f=w*+g[J+268>>2]+v*+g[J+264>>2]+f*+g[J+272>>2];w=(q-p)*0.0*+g[d+116>>2];v=(q-p)*0.0*+g[d+120>>2];g[d+64>>2]=(q-p)*0.0*+g[d+112>>2]+ +g[d+64>>2];g[d+68>>2]=w+ +g[d+68>>2];g[d+72>>2]=v+ +g[d+72>>2];v=$*(q-p)*+g[d+100>>2];w=aa*(q-p)*+g[d+104>>2];g[n>>2]=f*(q-p)*+g[d+96>>2]+ +g[n>>2];g[m>>2]=v+ +g[m>>2];g[o>>2]=w+ +g[o>>2];w=+g[b+480>>2];v=+g[b+476>>2];f=+g[b+484>>2]}b=c[b+32>>2]|0;if(!(c[e+240>>2]|0)){i=h;return}aa=w*+g[b+300>>2]+v*+g[b+296>>2]+f*+g[b+304>>2];$=w*+g[b+284>>2]+v*+g[b+280>>2]+f*+g[b+288>>2];_=w*+g[b+268>>2]+v*+g[b+264>>2]+f*+g[b+272>>2];Y=(q-p)*-0.0*+g[e+116>>2];Z=(q-p)*-0.0*+g[e+120>>2];g[e+64>>2]=(q-p)*-0.0*+g[e+112>>2]+ +g[e+64>>2];g[e+68>>2]=Y+ +g[e+68>>2];g[e+72>>2]=Z+ +g[e+72>>2];$=$*+g[e+100>>2]*-(q-p);aa=aa*+g[e+104>>2]*-(q-p);g[k>>2]=_*+g[e+96>>2]*-(q-p)+ +g[k>>2];g[l>>2]=$+ +g[l>>2];g[j>>2]=aa+ +g[j>>2];i=h;return}function Bo(a,b,c,d,e,f,h){a=a|0;b=+b;c=+c;d=+d;e=e|0;f=+f;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0;j=i;i=i+16|0;c=c*f+ +g[a+52>>2];d=d*f+ +g[a+56>>2];g[h+48>>2]=b*f+ +g[a+48>>2];g[h+52>>2]=c;g[h+56>>2]=d;g[h+60>>2]=0.0;d=+g[e>>2];b=+g[e+4>>2];c=+g[e+8>>2];k=+Q(+(d*d+b*b+c*c));if(k*f>.7853981852531433)k=.7853981852531433/f;if(k<.0010000000474974513)l=f*.5-k*f*f*f*.02083333395421505*k;else l=+T(+(k*.5*f))/k;o=l*d;b=l*b;c=l*c;q=+S(+(k*f*.5));Hc(a,j);n=+g[j>>2];p=+g[j+12>>2];f=+g[j+8>>2];l=+g[j+4>>2];r=1.0/+Q(+((q*p-o*n-b*l-c*f)*(q*p-o*n-b*l-c*f)+((c*p+q*f+o*l-b*n)*(c*p+q*f+o*l-b*n)+((q*n+o*p+b*f-c*l)*(q*n+o*p+b*f-c*l)+(c*n+(b*p+q*l)-o*f)*(c*n+(b*p+q*l)-o*f)))));d=(q*n+o*p+b*f-c*l)*r;k=r*(c*n+(b*p+q*l)-o*f);m=r*(c*p+q*f+o*l-b*n);f=r*(q*p-o*n-b*l-c*f);c=d*(2.0/(f*f+(m*m+(d*d+k*k))));l=2.0/(f*f+(m*m+(d*d+k*k)))*k;b=2.0/(f*f+(m*m+(d*d+k*k)))*m;g[h>>2]=1.0-(m*b+k*l);g[h+4>>2]=d*l-f*b;g[h+8>>2]=d*b+f*l;g[h+12>>2]=0.0;g[h+16>>2]=f*b+d*l;g[h+20>>2]=1.0-(d*c+m*b);g[h+24>>2]=k*b-f*c;g[h+28>>2]=0.0;g[h+32>>2]=d*b-f*l;g[h+36>>2]=f*c+k*b;g[h+40>>2]=1.0-(d*c+k*l);g[h+44>>2]=0.0;i=j;return}function Co(a,b,c,d){a=a|0;b=b|0;c=+c;d=+d;var e=0.0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0,l=0.0;e=+S(+c);c=+T(+c);f=+g[b+444>>2];if(+P(+e)>1.1920928955078125e-7){j=+g[b+448>>2];h=c*c;i=e*e;f=+Q(+((c*c/(e*e)+1.0)/(1.0/(j*j)+c*c/(e*e)/(f*f))))}else{h=c*c;i=e*e}k=f*.5;j=+T(+k)/+Q(+(i+0.0+h));k=+S(+k);l=k*d+e*j*0.0-c*j*-0.0;i=k*0.0-c*j*d-j*0.0*0.0;f=k*0.0+j*0.0*0.0-e*j*d;h=-(j*0.0*d)-e*j*0.0-c*j*-0.0;g[a>>2]=c*j*i+(k*l+h*-(j*0.0))-f*-(e*j);g[a+4>>2]=f*-(j*0.0)+(k*i+h*-(e*j))-c*j*l;g[a+8>>2]=l*-(e*j)+(k*f+c*j*h)-i*-(j*0.0);g[a+12>>2]=0.0;return}function Do(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,u=0.0;d=i;c[a+556>>2]=c[b+0>>2];c[a+560>>2]=c[b+4>>2];c[a+564>>2]=c[b+8>>2];c[a+568>>2]=c[b+12>>2];p=+g[a+568>>2];r=+g[a+560>>2];q=+g[a+564>>2];j=+g[a+556>>2];e=-j-r*0.0-q*0.0;h=(q+p*0.0-j*0.0)*-q+(p*(p+r*0.0-q*0.0)+e*-j)-(p*0.0+j*0.0-r)*-r;k=(p*0.0+j*0.0-r)*-j+(p*(q+p*0.0-j*0.0)+e*-r)-(p+r*0.0-q*0.0)*-q;e=(p+r*0.0-q*0.0)*-r+(p*(p*0.0+j*0.0-r)+e*-q)-(q+p*0.0-j*0.0)*-j;if(e*0.0+(k*0.0+h)<-.9999998807907104)if(+P(0.0)>.7071067690849304){f=0.0;e=t;k=t;h=0.0}else{f=-0.0;e=1.0;k=0.0;h=0.0}else{s=+Q(+((e*0.0+(k*0.0+h)+1.0)*2.0));f=(e*0.0-k*0.0)*(1.0/s);e=(h*0.0-e)*(1.0/s);k=(k-h*0.0)*(1.0/s);h=s*.5}s=1.0/+Q(+(h*h+(k*k+(e*e+f*f))));l=f*s;m=e*s;o=k*s;k=h*s;s=1.0/+Q(+((k*p-j*-l-r*-m-q*-o)*(k*p-j*-l-r*-m-q*-o)+((p*-o+k*q+r*-l-j*-m)*(p*-o+k*q+r*-l-j*-m)+((k*j+p*-l+q*-m-r*-o)*(k*j+p*-l+q*-m-r*-o)+(j*-o+(p*-m+k*r)-q*-l)*(j*-o+(p*-m+k*r)-q*-l)))));h=(k*j+p*-l+q*-m-r*-o)*s;e=s*(j*-o+(p*-m+k*r)-q*-l);f=s*(p*-o+k*q+r*-l-j*-m);j=s*(k*p-j*-l-r*-m-q*-o);s=+g[a+444>>2];if(s>=.05000000074505806?(n=+g[a+448>>2],n>=.05000000074505806):0){q=k<-1.0?-1.0:k;q=+V(+(q>1.0?1.0:q))*2.0;if(q>1.1920928955078125e-7){p=1.0/+Q(+(o*o+(l*l+m*m)));if(+P(+(m*p))>1.1920928955078125e-7){s=+Q(+((o*p*o*p/(m*p*m*p)+1.0)/(1.0/(n*n)+o*p*o*p/(m*p*m*p)/(s*s))));r=l*p;n=m*p;p=o*p}else{r=l*p;n=m*p;p=o*p}}else{s=0.0;r=0.0;n=0.0;p=0.0}if(+P(+q)>1.1920928955078125e-7){if(!(q>s)){k=-s;if(q<k)q=k}else q=s;k=q*.5;o=+T(+k)/+Q(+(p*p+(n*n+r*r)));k=+S(+k);l=r*o;m=n*o;o=p*o}}p=+g[a+452>>2];if(p>=.05000000074505806){r=j<-1.0?-1.0:j;r=+V(+(r>1.0?1.0:r))*2.0;if(r>3.1415927410125732){r=j>1.0?-1.0:-j;r=+V(+(r>1.0?1.0:r))*2.0;s=-h;n=-e;q=-f}else{s=h;n=e;q=f}if(r>1.1920928955078125e-7){u=1.0/+Q(+(q*q+(n*n+s*s)));s=s*u;n=n*u;q=q*u}if(+P(+r)>1.1920928955078125e-7){if(!(r>p))if(r<-p)p=-p;else p=r;j=p*.5;e=+T(+j)/+Q(+(q*q+(n*n+s*s)));h=s*e;j=+S(+j);f=q*e;e=n*e}}g[a+556>>2]=m*f+(l*j+k*h)-o*e;g[a+560>>2]=o*h+(m*j+k*e)-l*f;g[a+564>>2]=o*j+k*f+l*e-m*h;g[a+568>>2]=k*j-l*h-m*e-o*f;i=d;return}function Eo(a,b,d,e){a=a|0;b=b|0;d=+d;e=e|0;var f=0;f=i;if((b|0)==4|(b|0)==3)if(e>>>0<3){g[a+596>>2]=d;c[a+592>>2]=c[a+592>>2]|1;i=f;return}else{g[a+604>>2]=d;c[a+592>>2]=c[a+592>>2]|4;i=f;return}else if((b|0)==2|(b|0)==1)if(e>>>0<3){g[a+600>>2]=d;c[a+592>>2]=c[a+592>>2]|2;i=f;return}else{g[a+432>>2]=d;i=f;return}else{i=f;return}}function Fo(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0;d=i;do if((b|0)==2|(b|0)==1){if(c>>>0<3){e=+g[a+600>>2];break}if((c+ -3|0)>>>0<3)e=+g[a+432>>2];else e=0.0}else if((b|0)==4|(b|0)==3){if(c>>>0<3){e=+g[a+596>>2];break}if((c+ -3|0)>>>0<3)e=+g[a+604>>2];else e=0.0}else e=0.0;while(0);i=d;return+e}function Go(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;c[a+300>>2]=c[b+0>>2];c[a+304>>2]=c[b+4>>2];c[a+308>>2]=c[b+8>>2];c[a+312>>2]=c[b+12>>2];c[a+316>>2]=c[b+16>>2];c[a+320>>2]=c[b+20>>2];c[a+324>>2]=c[b+24>>2];c[a+328>>2]=c[b+28>>2];c[a+332>>2]=c[b+32>>2];c[a+336>>2]=c[b+36>>2];c[a+340>>2]=c[b+40>>2];c[a+344>>2]=c[b+44>>2];c[a+348>>2]=c[b+48>>2];c[a+352>>2]=c[b+52>>2];c[a+356>>2]=c[b+56>>2];c[a+360>>2]=c[b+60>>2];c[a+364>>2]=c[d+0>>2];c[a+368>>2]=c[d+4>>2];c[a+372>>2]=c[d+8>>2];c[a+376>>2]=c[d+12>>2];c[a+380>>2]=c[d+16>>2];c[a+384>>2]=c[d+20>>2];c[a+388>>2]=c[d+24>>2];c[a+392>>2]=c[d+28>>2];c[a+396>>2]=c[d+32>>2];c[a+400>>2]=c[d+36>>2];c[a+404>>2]=c[d+40>>2];c[a+408>>2]=c[d+44>>2];c[a+412>>2]=c[d+48>>2];c[a+416>>2]=c[d+52>>2];c[a+420>>2]=c[d+56>>2];c[a+424>>2]=c[d+60>>2];Lb[c[(c[a>>2]|0)+8>>2]&511](a);i=e;return}function Ho(a){a=a|0;return}function Io(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Jo(a){a=a|0;return 212}function Ko(a,b,c){a=a|0;b=b|0;c=c|0;var d=0;d=i;Zr(a,b,c)|0;g[b+52>>2]=+g[a+300>>2];g[b+56>>2]=+g[a+304>>2];g[b+60>>2]=+g[a+308>>2];g[b+64>>2]=+g[a+312>>2];g[b+68>>2]=+g[a+316>>2];g[b+72>>2]=+g[a+320>>2];g[b+76>>2]=+g[a+324>>2];g[b+80>>2]=+g[a+328>>2];g[b+84>>2]=+g[a+332>>2];g[b+88>>2]=+g[a+336>>2];g[b+92>>2]=+g[a+340>>2];g[b+96>>2]=+g[a+344>>2];g[b+100>>2]=+g[a+348>>2];g[b+104>>2]=+g[a+352>>2];g[b+108>>2]=+g[a+356>>2];g[b+112>>2]=+g[a+360>>2];g[b+116>>2]=+g[a+364>>2];g[b+120>>2]=+g[a+368>>2];g[b+124>>2]=+g[a+372>>2];g[b+128>>2]=+g[a+376>>2];g[b+132>>2]=+g[a+380>>2];g[b+136>>2]=+g[a+384>>2];g[b+140>>2]=+g[a+388>>2];g[b+144>>2]=+g[a+392>>2];g[b+148>>2]=+g[a+396>>2];g[b+152>>2]=+g[a+400>>2];g[b+156>>2]=+g[a+404>>2];g[b+160>>2]=+g[a+408>>2];g[b+164>>2]=+g[a+412>>2];g[b+168>>2]=+g[a+416>>2];g[b+172>>2]=+g[a+420>>2];g[b+176>>2]=+g[a+424>>2];g[b+180>>2]=+g[a+444>>2];g[b+184>>2]=+g[a+448>>2];g[b+188>>2]=+g[a+452>>2];g[b+192>>2]=+g[a+428>>2];g[b+196>>2]=+g[a+432>>2];g[b+200>>2]=+g[a+436>>2];g[b+204>>2]=+g[a+440>>2];i=d;return 1352}function Lo(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0;e=i;i=i+64|0;f=+g[a+20>>2];t=+g[a+40>>2];o=+g[a+24>>2];r=+g[a+36>>2];s=+g[a+32>>2];h=+g[a+16>>2];l=+g[a>>2];j=+g[a+4>>2];p=+g[a+8>>2];m=1.0/((f*t-o*r)*l+j*(o*s-t*h)+(r*h-f*s)*p);z=+g[b>>2];y=+g[b+4>>2];x=+g[b+8>>2];w=+g[b+16>>2];v=+g[b+20>>2];u=+g[b+24>>2];q=+g[b+32>>2];n=+g[b+36>>2];k=+g[b+40>>2];g[e+16>>2]=(f*t-o*r)*m*z+(o*s-t*h)*m*y+(r*h-f*s)*m*x;g[e+20>>2]=z*m*(r*p-t*j)+y*m*(t*l-s*p)+m*(s*j-r*l)*x;g[e+24>>2]=z*m*(o*j-f*p)+y*m*(h*p-o*l)+m*(f*l-h*j)*x;g[e+28>>2]=0.0;g[e+32>>2]=(f*t-o*r)*m*w+(o*s-t*h)*m*v+(r*h-f*s)*m*u;g[e+36>>2]=m*(r*p-t*j)*w+m*(t*l-s*p)*v+m*(s*j-r*l)*u;g[e+40>>2]=m*(o*j-f*p)*w+m*(h*p-o*l)*v+m*(f*l-h*j)*u;g[e+44>>2]=0.0;g[e+48>>2]=(f*t-o*r)*m*q+(o*s-t*h)*m*n+(r*h-f*s)*m*k;g[e+52>>2]=m*(r*p-t*j)*q+m*(t*l-s*p)*n+m*(s*j-r*l)*k;g[e+56>>2]=m*(o*j-f*p)*q+m*(h*p-o*l)*n+m*(f*l-h*j)*k;g[e+60>>2]=0.0;Hc(e+16|0,e);k=+g[e>>2];j=+g[e+4>>2];h=+g[e+8>>2];l=+g[e+12>>2];f=1.0/+Q(+(k*k+j*j+h*h+l*l));g[e>>2]=k*f;g[e+4>>2]=j*f;g[e+8>>2]=h*f;g[e+12>>2]=l*f;l=l*f<-1.0?-1.0:l*f;g[d>>2]=+V(+(l>1.0?1.0:l))*2.0;g[c>>2]=k*f;g[c+4>>2]=j*f;g[c+8>>2]=h*f;g[c+12>>2]=0.0;if(k*f*k*f+j*f*j*f+h*f*h*f<1.4210854715202004e-14){g[c>>2]=1.0;g[c+4>>2]=0.0;g[c+8>>2]=0.0;g[c+12>>2]=0.0;i=e;return}else{z=1.0/+Q(+(k*f*k*f+j*f*j*f+h*f*h*f));g[c>>2]=k*f*z;g[c+4>>2]=z*j*f;g[c+8>>2]=z*h*f;i=e;return}}function Mo(a,b,d,e,f,h,j,k,l,m){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=+k;l=l|0;m=+m;var n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0;n=i;c[a+0>>2]=c[h+0>>2];c[a+4>>2]=c[h+4>>2];c[a+8>>2]=c[h+8>>2];c[a+12>>2]=c[h+12>>2];u=+g[e+4>>2];t=+g[a+8>>2];r=+g[e+8>>2];x=+g[a+4>>2];o=+g[a>>2];z=+g[e>>2];y=(u*t-r*x)*+g[b>>2]+ +g[b+4>>2]*(r*o-t*z)+(x*z-u*o)*+g[b+8>>2];w=(u*t-r*x)*+g[b+16>>2]+(r*o-t*z)*+g[b+20>>2]+(x*z-u*o)*+g[b+24>>2];u=(u*t-r*x)*+g[b+32>>2]+(r*o-t*z)*+g[b+36>>2]+(x*z-u*o)*+g[b+40>>2];g[a+16>>2]=y;g[a+20>>2]=w;g[a+24>>2]=u;g[a+28>>2]=0.0;z=+g[f+4>>2];r=+g[f+8>>2];v=+g[f>>2];s=+g[d>>2]*(z*-t-r*-x)+ +g[d+4>>2]*(r*-o-v*-t)+(v*-x-z*-o)*+g[d+8>>2];q=(z*-t-r*-x)*+g[d+16>>2]+(r*-o-v*-t)*+g[d+20>>2]+(v*-x-z*-o)*+g[d+24>>2];o=(z*-t-r*-x)*+g[d+32>>2]+(r*-o-v*-t)*+g[d+36>>2]+(v*-x-z*-o)*+g[d+40>>2];g[a+32>>2]=s;g[a+36>>2]=q;g[a+40>>2]=o;g[a+44>>2]=0.0;z=+g[j>>2]*y;x=+g[j+4>>2]*w;v=+g[j+8>>2]*u;g[a+48>>2]=z;g[a+52>>2]=x;g[a+56>>2]=v;g[a+60>>2]=0.0;t=+g[l>>2]*s;r=+g[l+4>>2]*q;p=+g[l+8>>2]*o;g[a+64>>2]=t;g[a+68>>2]=r;g[a+72>>2]=p;g[a+76>>2]=0.0;g[a+80>>2]=z*y+x*w+v*u+k+m+(t*s+r*q+p*o);i=n;return}function No(a){a=a|0;var b=0;b=i;Oo(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Oo(b){b=b|0;var d=0,e=0,f=0,g=0;d=i;c[b>>2]=1392;if((a[b+272>>0]|0)!=0?(g=c[b+204>>2]|0,Lb[c[c[g>>2]>>2]&511](g),g=c[b+204>>2]|0,(g|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[g+ -4>>2]|0)}g=c[b+196>>2]|0;if((g|0)!=0?(Lb[c[c[g>>2]>>2]&511](g),f=c[b+196>>2]|0,(f|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}if((a[b+273>>0]|0)!=0?(e=c[b+200>>2]|0,Lb[c[c[e>>2]>>2]&511](e),e=c[b+200>>2]|0,(e|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+316>>2]|0;if(e){if(a[b+320>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+316>>2]=0}a[b+320>>0]=1;c[b+316>>2]=0;c[b+308>>2]=0;c[b+312>>2]=0;e=c[b+288>>2]|0;if(e){if(a[b+292>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+288>>2]=0}a[b+292>>0]=1;c[b+288>>2]=0;c[b+280>>2]=0;c[b+284>>2]=0;e=c[b+240>>2]|0;if(e){if(a[b+244>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+240>>2]=0}a[b+244>>0]=1;c[b+240>>2]=0;c[b+232>>2]=0;c[b+236>>2]=0;e=c[b+220>>2]|0;if(e){if(a[b+224>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+220>>2]=0}a[b+224>>0]=1;c[b+220>>2]=0;c[b+212>>2]=0;c[b+216>>2]=0;e=c[b+188>>2]|0;if(!e){a[b+192>>0]=1;c[b+188>>2]=0;c[b+180>>2]=0;g=b+184|0;c[g>>2]=0;Bu(b);i=d;return}if(a[b+192>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+188>>2]=0;a[b+192>>0]=1;c[b+188>>2]=0;c[b+180>>2]=0;g=b+184|0;c[g>>2]=0;Bu(b);i=d;return}function Po(a,b){a=a|0;b=+b;var d=0,e=0,f=0,h=0,j=0.0,k=0.0,l=0.0;d=i;i=i+32|0;h=c[a+8>>2]|0;if((h|0)<=0){i=d;return}e=0;do{f=c[(c[a+16>>2]|0)+(e<<2)>>2]|0;if((!((f|0)==0?1:(c[f+236>>2]&2|0)==0)?(c[f+216>>2]|0)!=2:0)?!((c[f+204>>2]&2|0)==0|b!=0.0^1):0){h=c[f+480>>2]|0;if(!h)h=f+4|0;else{Nb[c[(c[h>>2]|0)+8>>2]&127](h,f+4|0);h=f+4|0}k=(+g[f+56>>2]- +g[f+120>>2])*(1.0/b);l=1.0/b*(+g[f+60>>2]- +g[f+124>>2]);g[f+312>>2]=(+g[f+52>>2]- +g[f+116>>2])*(1.0/b);g[f+316>>2]=k;g[f+320>>2]=l;g[f+324>>2]=0.0;Lo(f+68|0,h,d+8|0,d);l=+g[d>>2];k=1.0/b*l*+g[d+12>>2];j=1.0/b*l*+g[d+16>>2];g[f+328>>2]=1.0/b*+g[d+8>>2]*l;g[f+332>>2]=k;g[f+336>>2]=j;g[f+340>>2]=0.0;c[f+132>>2]=c[f+312>>2];c[f+136>>2]=c[f+316>>2];c[f+140>>2]=c[f+320>>2];c[f+144>>2]=c[f+324>>2];c[f+148>>2]=c[f+328>>2];c[f+152>>2]=c[f+332>>2];c[f+156>>2]=c[f+336>>2];c[f+160>>2]=c[f+340>>2];c[f+68>>2]=c[h+0>>2];c[f+72>>2]=c[h+4>>2];c[f+76>>2]=c[h+8>>2];c[f+80>>2]=c[h+12>>2];c[f+84>>2]=c[f+20>>2];c[f+88>>2]=c[f+24>>2];c[f+92>>2]=c[f+28>>2];c[f+96>>2]=c[f+32>>2];c[f+100>>2]=c[f+36>>2];c[f+104>>2]=c[f+40>>2];c[f+108>>2]=c[f+44>>2];c[f+112>>2]=c[f+48>>2];c[f+116>>2]=c[f+52>>2];c[f+120>>2]=c[f+56>>2];c[f+124>>2]=c[f+60>>2];c[f+128>>2]=c[f+64>>2];h=c[a+8>>2]|0}e=e+1|0}while((e|0)<(h|0));i=d;return}function Qo(b){b=b|0;var d=0,e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0.0,B=0,C=0,D=0,E=0,F=0,G=0.0,H=0.0,I=0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0,P=0.0,Q=0.0,R=0.0,U=0.0,V=0.0,W=0.0;d=i;i=i+1024|0;yE(1576);Uu(b);a:do if((Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)!=0?(I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0,((Pb[c[(c[I>>2]|0)+48>>2]&127](I)|0)&6144|0)!=0):0){e=d+988|0;o=d+896|0;n=d+832|0;q=d+912|0;p=d+848|0;s=d+928|0;r=d+864|0;u=d+720|0;t=d+656|0;w=d+736|0;v=d+672|0;y=d+752|0;x=d+688|0;f=d+336|0;h=d+352|0;j=d+368|0;k=d+112|0;l=d+128|0;m=d+144|0;B=Pb[c[(c[b>>2]|0)+104>>2]&127](b)|0;b:while(1){z=B+ -1|0;if((B|0)<=0)break a;B=gc[c[(c[b>>2]|0)+108>>2]&31](b,z)|0;I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=(Pb[c[(c[I>>2]|0)+48>>2]&127](I)|0)>>>11;C=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;C=(Pb[c[(c[C>>2]|0)+48>>2]&127](C)|0)>>>12;A=+g[B+40>>2];if(A<=0.0){B=z;continue}switch(c[B+4>>2]|0){case 3:{g[d+944>>2]=1.0;c[d+948>>2]=0;c[d+952>>2]=0;c[d+956>>2]=0;c[d+960>>2]=0;g[d+964>>2]=1.0;c[d+968>>2]=0;c[d+972>>2]=0;c[d+976>>2]=0;c[d+980>>2]=0;g[d+984>>2]=1.0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;H=+g[B+300>>2];G=+g[B+304>>2];J=+g[B+308>>2];F=c[B+28>>2]|0;K=H*+g[F+20>>2]+G*+g[F+24>>2]+J*+g[F+28>>2]+ +g[F+56>>2];L=H*+g[F+36>>2]+G*+g[F+40>>2]+J*+g[F+44>>2]+ +g[F+60>>2];g[d+992>>2]=H*+g[F+4>>2]+G*+g[F+8>>2]+J*+g[F+12>>2]+ +g[F+52>>2];g[d+996>>2]=K;g[d+1e3>>2]=L;g[d+1004>>2]=0.0;F=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[F>>2]|0)+56>>2]&7](F,d+944|0,A);L=+g[B+316>>2];K=+g[B+320>>2];J=+g[B+324>>2];F=c[B+32>>2]|0;G=L*+g[F+20>>2]+K*+g[F+24>>2]+J*+g[F+28>>2]+ +g[F+56>>2];H=L*+g[F+36>>2]+K*+g[F+40>>2]+J*+g[F+44>>2]+ +g[F+60>>2];g[d+992>>2]=L*+g[F+4>>2]+K*+g[F+8>>2]+J*+g[F+12>>2]+ +g[F+52>>2];g[d+996>>2]=G;g[d+1e3>>2]=H;g[d+1004>>2]=0.0;if(!(I&1)){B=z;continue b}B=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[B>>2]|0)+56>>2]&7](B,d+944|0,A);B=z;continue b};case 4:{no(d+880|0,(c[B+28>>2]|0)+4|0,B+552|0);if(!(I&1)){no(d+816|0,(c[B+32>>2]|0)+4|0,B+616|0);c[d+880>>2]=c[d+816>>2];c[d+884>>2]=c[d+820>>2];c[d+888>>2]=c[d+824>>2];c[d+892>>2]=c[d+828>>2];c[o+0>>2]=c[n+0>>2];c[o+4>>2]=c[n+4>>2];c[o+8>>2]=c[n+8>>2];c[o+12>>2]=c[n+12>>2];c[q+0>>2]=c[p+0>>2];c[q+4>>2]=c[p+4>>2];c[q+8>>2]=c[p+8>>2];c[q+12>>2]=c[p+12>>2];c[s+0>>2]=c[r+0>>2];c[s+4>>2]=c[r+4>>2];c[s+8>>2]=c[r+8>>2];c[s+12>>2]=c[r+12>>2]}else{I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+880|0,A);no(d+816|0,(c[B+32>>2]|0)+4|0,B+616|0);c[d+880>>2]=c[d+816>>2];c[d+884>>2]=c[d+820>>2];c[d+888>>2]=c[d+824>>2];c[d+892>>2]=c[d+828>>2];c[o+0>>2]=c[n+0>>2];c[o+4>>2]=c[n+4>>2];c[o+8>>2]=c[n+8>>2];c[o+12>>2]=c[n+12>>2];c[q+0>>2]=c[p+0>>2];c[q+4>>2]=c[p+4>>2];c[q+8>>2]=c[p+8>>2];c[q+12>>2]=c[p+12>>2];c[s+0>>2]=c[r+0>>2];c[s+4>>2]=c[r+4>>2];c[s+8>>2]=c[r+8>>2];c[s+12>>2]=c[r+12>>2];I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+880|0,A)}G=+ab(+(+g[B+688>>2]- +g[B+692>>2]),6.2831854820251465);if(!(G<-3.1415927410125732)){if(G>3.1415927410125732)G=G+-6.2831854820251465}else G=G+6.2831854820251465;H=+ab(+(+g[B+688>>2]+ +g[B+692>>2]),6.2831854820251465);if(!(H<-3.1415927410125732)){if(H>3.1415927410125732)H=H+-6.2831854820251465}else H=H+6.2831854820251465;if(G==H){B=z;continue b}B=G>H;if(!(C&1)){B=z;continue b}g[d+800>>2]=+g[d+888>>2];g[d+804>>2]=+g[d+904>>2];g[d+808>>2]=+g[d+920>>2];g[d+812>>2]=0.0;g[d+784>>2]=+g[d+880>>2];g[d+788>>2]=+g[d+896>>2];g[d+792>>2]=+g[d+912>>2];g[d+796>>2]=0.0;I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;F=c[(c[I>>2]|0)+60>>2]|0;c[d+768>>2]=0;c[d+772>>2]=0;c[d+776>>2]=0;c[d+780>>2]=0;Wb[F&0](I,s,d+800|0,d+784|0,A,A,B?0.0:G,B?6.2831854820251465:H,d+768|0,B^1,10.0);B=z;continue b};case 5:{no(d+704|0,(c[B+28>>2]|0)+4|0,B+300|0);if(!(I&1)){no(d+640|0,(c[B+32>>2]|0)+4|0,B+364|0);c[d+704>>2]=c[d+640>>2];c[d+708>>2]=c[d+644>>2];c[d+712>>2]=c[d+648>>2];c[d+716>>2]=c[d+652>>2];c[u+0>>2]=c[t+0>>2];c[u+4>>2]=c[t+4>>2];c[u+8>>2]=c[t+8>>2];c[u+12>>2]=c[t+12>>2];c[w+0>>2]=c[v+0>>2];c[w+4>>2]=c[v+4>>2];c[w+8>>2]=c[v+8>>2];c[w+12>>2]=c[v+12>>2];c[y+0>>2]=c[x+0>>2];c[y+4>>2]=c[x+4>>2];c[y+8>>2]=c[x+8>>2];c[y+12>>2]=c[x+12>>2]}else{I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+704|0,A);no(d+640|0,(c[B+32>>2]|0)+4|0,B+364|0);c[d+704>>2]=c[d+640>>2];c[d+708>>2]=c[d+644>>2];c[d+712>>2]=c[d+648>>2];c[d+716>>2]=c[d+652>>2];c[u+0>>2]=c[t+0>>2];c[u+4>>2]=c[t+4>>2];c[u+8>>2]=c[t+8>>2];c[u+12>>2]=c[t+12>>2];c[w+0>>2]=c[v+0>>2];c[w+4>>2]=c[v+4>>2];c[w+8>>2]=c[v+8>>2];c[w+12>>2]=c[v+12>>2];c[y+0>>2]=c[x+0>>2];c[y+4>>2]=c[x+4>>2];c[y+8>>2]=c[x+8>>2];c[y+12>>2]=c[x+12>>2];I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+704|0,A)}if(!(C&1)){B=z;continue b}Co(d+624|0,B,6.0868353843688965,A);G=+g[d+624>>2];H=+g[d+628>>2];J=+g[d+632>>2];K=G*+g[d+720>>2]+H*+g[d+724>>2]+J*+g[d+728>>2]+ +g[d+756>>2];L=G*+g[d+736>>2]+H*+g[d+740>>2]+J*+g[d+744>>2]+ +g[d+760>>2];g[d+624>>2]=G*+g[d+704>>2]+H*+g[d+708>>2]+J*+g[d+712>>2]+ +g[d+752>>2];g[d+628>>2]=K;g[d+632>>2]=L;g[d+636>>2]=0.0;C=0;do{Co(d+608|0,B,+(C|0)*6.283185005187988*.03125,A);G=+g[d+608>>2];H=+g[d+612>>2];J=+g[d+616>>2];K=G*+g[d+720>>2]+H*+g[d+724>>2]+J*+g[d+728>>2]+ +g[d+756>>2];L=G*+g[d+736>>2]+H*+g[d+740>>2]+J*+g[d+744>>2]+ +g[d+760>>2];g[d+608>>2]=G*+g[d+704>>2]+H*+g[d+708>>2]+J*+g[d+712>>2]+ +g[d+752>>2];g[d+612>>2]=K;g[d+616>>2]=L;g[d+620>>2]=0.0;I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;F=c[(c[I>>2]|0)+8>>2]|0;c[d+592>>2]=0;c[d+596>>2]=0;c[d+600>>2]=0;c[d+604>>2]=0;vc[F&127](I,d+624|0,d+608|0,d+592|0);if(!(C&3)){I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;F=c[(c[I>>2]|0)+8>>2]|0;c[d+576>>2]=0;c[d+580>>2]=0;c[d+584>>2]=0;c[d+588>>2]=0;vc[F&127](I,y,d+608|0,d+576|0)}c[d+624>>2]=c[d+608>>2];c[d+628>>2]=c[d+612>>2];c[d+632>>2]=c[d+616>>2];c[d+636>>2]=c[d+620>>2];C=C+1|0}while((C|0)!=32);H=+g[B+452>>2];G=+g[B+512>>2];C=c[B+32>>2]|0;if(+g[C+344>>2]>0.0){no(d+512|0,C+4|0,B+364|0);c[d+704>>2]=c[d+512>>2];c[d+708>>2]=c[d+516>>2];c[d+712>>2]=c[d+520>>2];c[d+716>>2]=c[d+524>>2];c[u+0>>2]=c[d+528>>2];c[u+4>>2]=c[d+532>>2];c[u+8>>2]=c[d+536>>2];c[u+12>>2]=c[d+540>>2];c[w+0>>2]=c[d+544>>2];c[w+4>>2]=c[d+548>>2];c[w+8>>2]=c[d+552>>2];c[w+12>>2]=c[d+556>>2];c[y+0>>2]=c[d+560>>2];c[y+4>>2]=c[d+564>>2];c[y+8>>2]=c[d+568>>2];c[y+12>>2]=c[d+572>>2]}else{no(d+448|0,(c[B+28>>2]|0)+4|0,B+300|0);c[d+704>>2]=c[d+448>>2];c[d+708>>2]=c[d+452>>2];c[d+712>>2]=c[d+456>>2];c[d+716>>2]=c[d+460>>2];c[u+0>>2]=c[d+464>>2];c[u+4>>2]=c[d+468>>2];c[u+8>>2]=c[d+472>>2];c[u+12>>2]=c[d+476>>2];c[w+0>>2]=c[d+480>>2];c[w+4>>2]=c[d+484>>2];c[w+8>>2]=c[d+488>>2];c[w+12>>2]=c[d+492>>2];c[y+0>>2]=c[d+496>>2];c[y+4>>2]=c[d+500>>2];c[y+8>>2]=c[d+504>>2];c[y+12>>2]=c[d+508>>2]}c[d+432>>2]=c[y+0>>2];c[d+436>>2]=c[y+4>>2];c[d+440>>2]=c[y+8>>2];c[d+444>>2]=c[y+12>>2];g[d+416>>2]=+g[d+704>>2];g[d+420>>2]=+g[d+720>>2];g[d+424>>2]=+g[d+736>>2];g[d+428>>2]=0.0;g[d+400>>2]=+g[d+708>>2];g[d+404>>2]=+g[d+724>>2];g[d+408>>2]=+g[d+740>>2];g[d+412>>2]=0.0;B=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=c[(c[B>>2]|0)+60>>2]|0;c[d+384>>2]=0;c[d+388>>2]=0;c[d+392>>2]=0;c[d+396>>2]=0;Wb[I&0](B,d+432|0,d+416|0,d+400|0,A,A,-G-H,H-G,d+384|0,1,10.0);B=z;continue b};case 6:case 9:{c[d+320>>2]=c[B+1064>>2];c[d+324>>2]=c[B+1068>>2];c[d+328>>2]=c[B+1072>>2];c[d+332>>2]=c[B+1076>>2];E=B+1080|0;c[f+0>>2]=c[E+0>>2];c[f+4>>2]=c[E+4>>2];c[f+8>>2]=c[E+8>>2];c[f+12>>2]=c[E+12>>2];F=B+1096|0;c[h+0>>2]=c[F+0>>2];c[h+4>>2]=c[F+4>>2];c[h+8>>2]=c[F+8>>2];c[h+12>>2]=c[F+12>>2];D=B+1112|0;c[j+0>>2]=c[D+0>>2];c[j+4>>2]=c[D+4>>2];c[j+8>>2]=c[D+8>>2];c[j+12>>2]=c[D+12>>2];if(!(I&1)){c[d+320>>2]=c[B+1128>>2];c[d+324>>2]=c[B+1132>>2];c[d+328>>2]=c[B+1136>>2];c[d+332>>2]=c[B+1140>>2];c[f+0>>2]=c[B+1144>>2];c[f+4>>2]=c[B+1148>>2];c[f+8>>2]=c[B+1152>>2];c[f+12>>2]=c[B+1156>>2];c[h+0>>2]=c[B+1160>>2];c[h+4>>2]=c[B+1164>>2];c[h+8>>2]=c[B+1168>>2];c[h+12>>2]=c[B+1172>>2];c[j+0>>2]=c[B+1176>>2];c[j+4>>2]=c[B+1180>>2];c[j+8>>2]=c[B+1184>>2];c[j+12>>2]=c[B+1188>>2]}else{I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+320|0,A);c[d+320>>2]=c[B+1128>>2];c[d+324>>2]=c[B+1132>>2];c[d+328>>2]=c[B+1136>>2];c[d+332>>2]=c[B+1140>>2];c[f+0>>2]=c[B+1144>>2];c[f+4>>2]=c[B+1148>>2];c[f+8>>2]=c[B+1152>>2];c[f+12>>2]=c[B+1156>>2];c[h+0>>2]=c[B+1160>>2];c[h+4>>2]=c[B+1164>>2];c[h+8>>2]=c[B+1168>>2];c[h+12>>2]=c[B+1172>>2];c[j+0>>2]=c[B+1176>>2];c[j+4>>2]=c[B+1180>>2];c[j+8>>2]=c[B+1184>>2];c[j+12>>2]=c[B+1188>>2];I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[I>>2]|0)+56>>2]&7](I,d+320|0,A)}if(!(C&1)){B=z;continue b}c[d+320>>2]=c[B+1064>>2];c[d+324>>2]=c[B+1068>>2];c[d+328>>2]=c[B+1072>>2];c[d+332>>2]=c[B+1076>>2];c[f+0>>2]=c[E+0>>2];c[f+4>>2]=c[E+4>>2];c[f+8>>2]=c[E+8>>2];c[f+12>>2]=c[E+12>>2];c[h+0>>2]=c[F+0>>2];c[h+4>>2]=c[F+4>>2];c[h+8>>2]=c[F+8>>2];c[h+12>>2]=c[F+12>>2];c[j+0>>2]=c[D+0>>2];c[j+4>>2]=c[D+4>>2];c[j+8>>2]=c[D+8>>2];c[j+12>>2]=c[D+12>>2];C=B+1176|0;g[d+304>>2]=+g[d+328>>2];g[d+308>>2]=+g[d+344>>2];g[d+312>>2]=+g[d+360>>2];g[d+316>>2]=0.0;g[d+288>>2]=+g[d+320>>2];g[d+292>>2]=+g[d+336>>2];g[d+296>>2]=+g[d+352>>2];g[d+300>>2]=0.0;J=+g[B+932>>2];H=+g[B+936>>2];L=+g[B+996>>2];M=+g[B+1e3>>2];I=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;O=c[(c[I>>2]|0)+64>>2]|0;c[d+272>>2]=0;c[d+276>>2]=0;c[d+280>>2]=0;c[d+284>>2]=0;mc[O&0](I,C,d+304|0,d+288|0,A*.8999999761581421,J,H,L,M,d+272|0,10.0,1);M=+g[d+324>>2];L=+g[d+340>>2];H=+g[d+356>>2];g[d+288>>2]=M;g[d+292>>2]=L;g[d+296>>2]=H;g[d+300>>2]=0.0;J=+g[B+1196>>2];K=+g[B+1200>>2];G=+S(+J);J=+T(+J);N=+S(+K);K=+T(+K);g[d+256>>2]=G*N*M+G*K*L-J*H;g[d+260>>2]=N*L-K*M;g[d+264>>2]=J*N*M+J*K*L+G*H;c[d+320>>2]=c[B+1128>>2];c[d+324>>2]=c[B+1132>>2];c[d+328>>2]=c[B+1136>>2];c[d+332>>2]=c[B+1140>>2];c[f+0>>2]=c[B+1144>>2];c[f+4>>2]=c[B+1148>>2];c[f+8>>2]=c[B+1152>>2];c[f+12>>2]=c[B+1156>>2];c[h+0>>2]=c[B+1160>>2];c[h+4>>2]=c[B+1164>>2];c[h+8>>2]=c[B+1168>>2];c[h+12>>2]=c[B+1172>>2];c[j+0>>2]=c[C+0>>2];c[j+4>>2]=c[C+4>>2];c[j+8>>2]=c[C+8>>2];c[j+12>>2]=c[C+12>>2];H=-+g[d+336>>2];G=-+g[d+352>>2];g[d+240>>2]=-+g[d+320>>2];g[d+244>>2]=H;g[d+248>>2]=G;g[d+252>>2]=0.0;G=+g[B+868>>2];H=+g[B+872>>2];if(!(G>H)){if(G<H){O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=c[(c[O>>2]|0)+60>>2]|0;c[d+208>>2]=0;c[d+212>>2]=0;c[d+216>>2]=0;c[d+220>>2]=0;Wb[I&0](O,C,d+240|0,d+256|0,A,A,G,H,d+208|0,1,10.0)}}else{O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=c[(c[O>>2]|0)+60>>2]|0;c[d+224>>2]=0;c[d+228>>2]=0;c[d+232>>2]=0;c[d+236>>2]=0;Wb[I&0](O,C,d+240|0,d+256|0,A,A,-3.1415927410125732,3.1415927410125732,d+224|0,0,10.0)}c[d+320>>2]=c[B+1064>>2];c[d+324>>2]=c[B+1068>>2];c[d+328>>2]=c[B+1072>>2];c[d+332>>2]=c[B+1076>>2];c[f+0>>2]=c[E+0>>2];c[f+4>>2]=c[E+4>>2];c[f+8>>2]=c[E+8>>2];c[f+12>>2]=c[E+12>>2];c[h+0>>2]=c[F+0>>2];c[h+4>>2]=c[F+4>>2];c[h+8>>2]=c[F+8>>2];c[h+12>>2]=c[F+12>>2];c[j+0>>2]=c[D+0>>2];c[j+4>>2]=c[D+4>>2];c[j+8>>2]=c[D+8>>2];c[j+12>>2]=c[D+12>>2];c[d+192>>2]=c[B+680>>2];c[d+196>>2]=c[B+684>>2];c[d+200>>2]=c[B+688>>2];c[d+204>>2]=c[B+692>>2];c[d+176>>2]=c[B+696>>2];c[d+180>>2]=c[B+700>>2];c[d+184>>2]=c[B+704>>2];c[d+188>>2]=c[B+708>>2];B=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;O=c[(c[B>>2]|0)+72>>2]|0;c[d+160>>2]=0;c[d+164>>2]=0;c[d+168>>2]=0;c[d+172>>2]=0;Jb[O&31](B,d+192|0,d+176|0,d+320|0,d+160|0);B=z;continue b};case 7:{c[d+96>>2]=c[B+824>>2];c[d+100>>2]=c[B+828>>2];c[d+104>>2]=c[B+832>>2];c[d+108>>2]=c[B+836>>2];c[k+0>>2]=c[B+840>>2];c[k+4>>2]=c[B+844>>2];c[k+8>>2]=c[B+848>>2];c[k+12>>2]=c[B+852>>2];c[l+0>>2]=c[B+856>>2];c[l+4>>2]=c[B+860>>2];c[l+8>>2]=c[B+864>>2];c[l+12>>2]=c[B+868>>2];c[m+0>>2]=c[B+872>>2];c[m+4>>2]=c[B+876>>2];c[m+8>>2]=c[B+880>>2];c[m+12>>2]=c[B+884>>2];if(!(I&1)){c[d+96>>2]=c[B+888>>2];c[d+100>>2]=c[B+892>>2];c[d+104>>2]=c[B+896>>2];c[d+108>>2]=c[B+900>>2];c[k+0>>2]=c[B+904>>2];c[k+4>>2]=c[B+908>>2];c[k+8>>2]=c[B+912>>2];c[k+12>>2]=c[B+916>>2];c[l+0>>2]=c[B+920>>2];c[l+4>>2]=c[B+924>>2];c[l+8>>2]=c[B+928>>2];c[l+12>>2]=c[B+932>>2];c[m+0>>2]=c[B+936>>2];c[m+4>>2]=c[B+940>>2];c[m+8>>2]=c[B+944>>2];c[m+12>>2]=c[B+948>>2]}else{O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[O>>2]|0)+56>>2]&7](O,d+96|0,A);c[d+96>>2]=c[B+888>>2];c[d+100>>2]=c[B+892>>2];c[d+104>>2]=c[B+896>>2];c[d+108>>2]=c[B+900>>2];c[k+0>>2]=c[B+904>>2];c[k+4>>2]=c[B+908>>2];c[k+8>>2]=c[B+912>>2];c[k+12>>2]=c[B+916>>2];c[l+0>>2]=c[B+920>>2];c[l+4>>2]=c[B+924>>2];c[l+8>>2]=c[B+928>>2];c[l+12>>2]=c[B+932>>2];c[m+0>>2]=c[B+936>>2];c[m+4>>2]=c[B+940>>2];c[m+8>>2]=c[B+944>>2];c[m+12>>2]=c[B+948>>2];O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;tc[c[(c[O>>2]|0)+56>>2]&7](O,d+96|0,A)}if(!(C&1)){B=z;continue b}O=(a[B+180>>0]|0)!=0?B+824|0:B+888|0;H=+g[O>>2];L=+g[O+4>>2];J=+g[O+16>>2];N=+g[O+20>>2];K=+g[O+32>>2];M=+g[O+36>>2];W=+g[O+48>>2];U=+g[O+52>>2];Q=+g[O+56>>2];G=+g[B+184>>2];V=+g[O+8>>2]*0.0;R=+g[O+24>>2]*0.0;P=+g[O+40>>2]*0.0;g[d+80>>2]=W+(V+(L*0.0+H*G));g[d+84>>2]=U+(R+(N*0.0+J*G));g[d+88>>2]=Q+(P+(M*0.0+K*G));g[d+92>>2]=0.0;G=+g[B+188>>2];g[d+64>>2]=W+(V+(L*0.0+H*G));g[d+68>>2]=U+(R+(N*0.0+J*G));g[d+72>>2]=Q+(P+(M*0.0+K*G));g[d+76>>2]=0.0;O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=c[(c[O>>2]|0)+8>>2]|0;c[d+48>>2]=0;c[d+52>>2]=0;c[d+56>>2]=0;c[d+60>>2]=0;vc[I&127](O,d+80|0,d+64|0,d+48|0);g[d+32>>2]=H;g[d+36>>2]=J;g[d+40>>2]=K;g[d+44>>2]=0.0;g[d+16>>2]=L;g[d+20>>2]=N;g[d+24>>2]=M;g[d+28>>2]=0.0;M=+g[B+192>>2];N=+g[B+196>>2];O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;I=c[(c[O>>2]|0)+60>>2]|0;c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;Wb[I&0](O,B+936|0,d+32|0,d+16|0,A,A,M,N,d,1,10.0);B=z;continue b};default:{B=z;continue b}}}}while(0);if(((((Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)!=0?(O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0,((Pb[c[(c[O>>2]|0)+48>>2]&127](O)|0)&16387|0)!=0):0)?(Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)!=0:0)?(O=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0,(Pb[c[(c[O>>2]|0)+48>>2]&127](O)|0)!=0):0)?(c[b+280>>2]|0)>0:0){e=0;do{O=c[(c[b+288>>2]|0)+(e<<2)>>2]|0;Nb[c[(c[O>>2]|0)+12>>2]&127](O,c[b+72>>2]|0);e=e+1|0}while((e|0)<(c[b+280>>2]|0))}b=c[5022]|0;O=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=O;if(O){i=d;return}do if(c[b+4>>2]|0){Eb(d+1008|0,0)|0;O=c[5008]|0;g[b+8>>2]=+(((c[d+1012>>2]|0)-(c[O+4>>2]|0)+(((c[d+1008>>2]|0)-(c[O>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=d;return}}while(0);c[5022]=c[b+20>>2];i=d;return}function Ro(a){a=a|0;var b=0,d=0,e=0;b=i;if((c[a+232>>2]|0)<=0){i=b;return}d=0;do{e=(c[(c[a+240>>2]|0)+(d<<2)>>2]|0)+412|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;d=d+1|0}while((d|0)<(c[a+232>>2]|0));i=b;return}function So(a){a=a|0;var b=0,d=0,e=0,f=0,h=0,j=0.0,k=0.0;b=i;d=c[a+232>>2]|0;if((d|0)<=0){i=b;return}a=c[a+240>>2]|0;e=0;do{f=c[a+(e<<2)>>2]|0;h=c[f+216>>2]|0;if(!((h|0)==2|(h|0)==5)?(c[f+204>>2]&3|0)==0:0){k=+g[f+368>>2]*+g[f+352>>2];j=+g[f+372>>2]*+g[f+356>>2];g[f+412>>2]=+g[f+364>>2]*+g[f+348>>2]+ +g[f+412>>2];g[f+416>>2]=k+ +g[f+416>>2];g[f+420>>2]=j+ +g[f+420>>2]}e=e+1|0}while((e|0)<(d|0));i=b;return}function To(b){b=b|0;var d=0,e=0.0,f=0.0,h=0,j=0,k=0,l=0;d=i;i=i+144|0;yE(1592);if(!(a[b+274>>0]|0)){k=c[b+232>>2]|0;if((k|0)>0){h=0;do{j=c[(c[b+240>>2]|0)+(h<<2)>>2]|0;l=c[j+216>>2]|0;if((!((l|0)==2|(l|0)==5)?(c[j+480>>2]|0)!=0:0)?(c[j+204>>2]&3|0)==0:0){if((a[b+300>>0]|0)!=0?(e=+g[b+268>>2],e!=0.0):0)f=+g[b+264>>2]-e;else f=+g[b+264>>2]*+g[j+244>>2];Bo(j+68|0,+g[j+132>>2],+g[j+136>>2],+g[j+140>>2],j+148|0,f,d);k=c[j+480>>2]|0;Nb[c[(c[k>>2]|0)+12>>2]&127](k,d);k=c[b+232>>2]|0}h=h+1|0}while((h|0)<(k|0))}}else{k=c[b+8>>2]|0;if((k|0)>0){h=0;do{j=c[(c[b+16>>2]|0)+(h<<2)>>2]|0;if((!((j|0)==0?1:(c[j+236>>2]&2|0)==0)?(c[j+480>>2]|0)!=0:0)?(c[j+204>>2]&3|0)==0:0){if((a[b+300>>0]|0)!=0?(f=+g[b+268>>2],f!=0.0):0)e=+g[b+264>>2]-f;else e=+g[b+264>>2]*+g[j+244>>2];Bo(j+68|0,+g[j+132>>2],+g[j+136>>2],+g[j+140>>2],j+148|0,e,d+64|0);k=c[j+480>>2]|0;Nb[c[(c[k>>2]|0)+12>>2]&127](k,d+64|0);k=c[b+8>>2]|0}h=h+1|0}while((h|0)<(k|0))}}b=c[5022]|0;l=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=l;if(l){i=d;return}do if(c[b+4>>2]|0){Eb(d+128|0,0)|0;l=c[5008]|0;g[b+8>>2]=+(((c[d+132>>2]|0)-(c[l+4>>2]|0)+(((c[d+128>>2]|0)-(c[l>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=d;return}}while(0);c[5022]=c[b+20>>2];i=d;return}function Uo(b,d,e,f){b=b|0;d=+d;e=e|0;f=+f;var h=0,j=0,k=0.0,l=0;h=i;i=i+16|0;Eb(c[5008]|0,0)|0;xE(20040);c[5011]=(c[5011]|0)+1;l=c[5014]|0;c[5014]=l+1;if(!l){Eb(h|0,0)|0;l=c[5008]|0;c[5013]=(c[h+4>>2]|0)-(c[l+4>>2]|0)+(((c[h>>2]|0)-(c[l>>2]|0)|0)*1e6|0)}c[5024]=0;Eb(h|0,0)|0;yE(1616);if(e){g[b+268>>2]=f;k=+g[b+264>>2]+d;g[b+264>>2]=k;if(!(k>=f)){d=f;j=0}else{g[b+264>>2]=k- +(~~(k/f)|0)*f;d=f;j=~~(k/f)}}else{g[b+264>>2]=(a[b+300>>0]|0)!=0?0.0:d;g[b+268>>2]=0.0;j=!(+P(+d)<1.1920928955078125e-7)&1;e=j}if(Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0){l=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;a[3896]=(Pb[c[(c[l>>2]|0)+48>>2]&127](l)|0)>>>4&1}if(j){e=(j|0)>(e|0)?e:j;Kb[c[(c[b>>2]|0)+164>>2]&31](b,d*+(e|0));Lb[c[(c[b>>2]|0)+168>>2]&511](b);if((e|0)>0){l=0;do{Kb[c[(c[b>>2]|0)+160>>2]&31](b,d);Lb[c[(c[b>>2]|0)+80>>2]&511](b);l=l+1|0}while((l|0)<(e|0))}}else Lb[c[(c[b>>2]|0)+80>>2]&511](b);Lb[c[(c[b>>2]|0)+120>>2]&511](b);c[5024]=(c[5024]|0)+1;b=c[5022]|0;l=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=l;if(l){i=h;return j|0}do if(c[b+4>>2]|0){Eb(h|0,0)|0;l=c[5008]|0;g[b+8>>2]=+(((c[h+4>>2]|0)-(c[l+4>>2]|0)+(((c[h>>2]|0)-(c[l>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=h;return j|0}}while(0);c[5022]=c[b+20>>2];i=h;return j|0}function Vo(d,e){d=d|0;e=+e;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0,p=0,q=0,r=0,s=0,t=0,u=0.0,v=0.0,w=0.0,x=0,y=0.0,z=0,A=0,B=0,C=0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0;f=i;i=i+464|0;yE(1632);p=c[d+84>>2]|0;if(p)Kb[p&31](d,e);Kb[c[(c[d>>2]|0)+140>>2]&31](d,e);g[d+28>>2]=e;c[d+32>>2]=0;c[d+48>>2]=Pb[c[(c[d>>2]|0)+20>>2]&127](d)|0;yE(1768);yE(1800);q=c[d+316>>2]|0;if((c[d+308>>2]|0)>0){p=0;do{C=c[d+24>>2]|0;Nb[c[(c[C>>2]|0)+16>>2]&127](C,c[q+(p<<2)>>2]|0);p=p+1|0;q=c[d+316>>2]|0}while((p|0)<(c[d+308>>2]|0))}if(q){if(a[d+320>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[q+ -4>>2]|0)}c[d+316>>2]=0}a[d+320>>0]=1;c[d+316>>2]=0;c[d+308>>2]=0;c[d+312>>2]=0;p=c[5022]|0;C=(c[p+16>>2]|0)+ -1|0;c[p+16>>2]=C;do if(!C){if(c[p+4>>2]|0){Eb(f+280|0,0)|0;C=c[5008]|0;g[p+8>>2]=+(((c[f+284>>2]|0)-(c[C+4>>2]|0)+(((c[f+280>>2]|0)-(c[C>>2]|0)|0)*1e6|0)-(c[p+12>>2]|0)|0)>>>0)/1.0e3+ +g[p+8>>2];if(c[p+16>>2]|0)break;p=c[5022]|0}c[5022]=c[p+20>>2]}while(0);if((c[d+232>>2]|0)>0){p=f+264|0;s=f+164|0;r=f+400|0;q=0;do{t=c[(c[d+240>>2]|0)+(q<<2)>>2]|0;g[t+244>>2]=1.0;C=c[t+216>>2]|0;do if(((!((C|0)==2|(C|0)==5)?(c[t+204>>2]&3|0)==0:0)?(Bo(t+4|0,+g[t+312>>2],+g[t+316>>2],+g[t+320>>2],t+328|0,e,f+216|0),l=+g[p>>2],h=l- +g[t+52>>2],m=+g[f+268>>2],j=m- +g[t+56>>2],n=+g[f+272>>2],k=n- +g[t+60>>2],(a[d+44>>0]|0)!=0):0)?(y=+g[t+252>>2],y*y!=0.0?y*y<h*h+j*j+k*k:0):0){yE(1840);if((c[(c[t+192>>2]|0)+4>>2]|0)<20){c[440]=(c[440]|0)+1;B=c[d+68>>2]|0;B=Pb[c[(c[B>>2]|0)+36>>2]&127](B)|0;C=c[d+24>>2]|0;g[f+124>>2]=1.0;b[f+128>>1]=1;b[f+130>>1]=-1;c[f+120>>2]=688;c[f+132>>2]=c[t+52>>2];c[f+136>>2]=c[t+56>>2];c[f+140>>2]=c[t+60>>2];c[f+144>>2]=c[t+64>>2];c[f+148>>2]=c[p+0>>2];c[f+152>>2]=c[p+4>>2];c[f+156>>2]=c[p+8>>2];c[f+160>>2]=c[p+12>>2];c[f+196>>2]=0;c[f+120>>2]=2160;c[f+200>>2]=t;g[f+204>>2]=0.0;c[f+208>>2]=B;c[f+212>>2]=C;w=+g[t+248>>2];c[f+72>>2]=0;g[f+76>>2]=1.0;g[f+80>>2]=1.0;g[f+84>>2]=1.0;g[f+88>>2]=0.0;c[f+64>>2]=16680;c[f+68>>2]=8;g[f+92>>2]=w;g[f+108>>2]=w;g[f+204>>2]=+g[d+56>>2];C=c[t+188>>2]|0;b[f+128>>1]=b[C+4>>1]|0;b[f+130>>1]=b[C+6>>1]|0;c[f+48>>2]=c[p+0>>2];c[f+52>>2]=c[p+4>>2];c[f+56>>2]=c[p+8>>2];c[f+60>>2]=c[p+12>>2];c[f+0>>2]=c[t+4>>2];c[f+4>>2]=c[t+8>>2];c[f+8>>2]=c[t+12>>2];c[f+12>>2]=c[t+16>>2];c[f+16>>2]=c[t+20>>2];c[f+20>>2]=c[t+24>>2];c[f+24>>2]=c[t+28>>2];c[f+28>>2]=c[t+32>>2];c[f+32>>2]=c[t+36>>2];c[f+36>>2]=c[t+40>>2];c[f+40>>2]=c[t+44>>2];c[f+44>>2]=c[t+48>>2];Ou(d,f+64|0,t+4|0,f,f+120|0,0.0);w=+g[f+124>>2];if(w<1.0){v=w*(l- +g[t+52>>2]);u=w*(m- +g[t+56>>2]);w=w*(n- +g[t+60>>2]);y=-(u*+g[f+168>>2])-v*+g[s>>2]-w*+g[f+172>>2];x=c[d+24>>2]|0;x=Yb[c[(c[x>>2]|0)+12>>2]&31](x,t,c[f+196>>2]|0)|0;A=c[d+308>>2]|0;if((A|0)==(c[d+312>>2]|0)?(o=(A|0)==0?1:A<<1,(A|0)<(o|0)):0){if(!o)z=0;else{c[5004]=(c[5004]|0)+1;z=fF((o<<2|3)+16|0)|0;if(!z)z=0;else{c[(z+19&-16)+ -4>>2]=z;z=z+19&-16}A=c[d+308>>2]|0}if((A|0)>0){B=0;do{C=z+(B<<2)|0;if(C)c[C>>2]=c[(c[d+316>>2]|0)+(B<<2)>>2];B=B+1|0}while((B|0)!=(A|0))}B=c[d+316>>2]|0;if(B){if(a[d+320>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[B+ -4>>2]|0);A=c[d+308>>2]|0}c[d+316>>2]=0}a[d+320>>0]=1;c[d+316>>2]=z;c[d+312>>2]=o}z=(c[d+316>>2]|0)+(A<<2)|0;if(z)c[z>>2]=x;c[d+308>>2]=A+1;D=v+ +g[t+52>>2];v=u+ +g[t+56>>2];w=w+ +g[t+60>>2];C=c[f+196>>2]|0;O=+g[C+4>>2];N=+g[C+20>>2];M=+g[C+36>>2];L=+g[C+8>>2];K=+g[C+24>>2];J=+g[C+40>>2];I=+g[C+12>>2];G=+g[C+28>>2];E=+g[C+44>>2];H=-+g[C+52>>2];F=-+g[C+56>>2];u=-+g[C+60>>2];c[f+280>>2]=0;c[f+284>>2]=0;c[f+288>>2]=0;c[f+292>>2]=0;g[f+296>>2]=D*O+v*N+w*M+(O*H+N*F+M*u);g[f+300>>2]=D*L+v*K+w*J+(L*H+K*F+J*u);g[f+304>>2]=D*I+v*G+w*E+(I*H+G*F+E*u);g[f+308>>2]=0.0;c[f+344>>2]=c[s+0>>2];c[f+348>>2]=c[s+4>>2];c[f+352>>2]=c[s+8>>2];c[f+356>>2]=c[s+12>>2];g[f+360>>2]=y;g[f+364>>2]=0.0;g[f+368>>2]=0.0;g[f+372>>2]=0.0;c[f+392>>2]=0;a[f+396>>0]=0;c[r+0>>2]=0;c[r+4>>2]=0;c[r+8>>2]=0;c[r+12>>2]=0;c[r+16>>2]=0;c[r+20>>2]=0;c[r+24>>2]=0;c[r+28>>2]=0;C=wA(x,f+280|0)|0;g[x+(C*184|0)+96>>2]=0.0;y=+g[t+224>>2]*+g[(c[f+196>>2]|0)+224>>2];y=y<-10.0?-10.0:y;g[x+(C*184|0)+88>>2]=y>10.0?10.0:y;c[x+(C*184|0)+52>>2]=c[t+52>>2];c[x+(C*184|0)+56>>2]=c[t+56>>2];c[x+(C*184|0)+60>>2]=c[t+60>>2];c[x+(C*184|0)+64>>2]=c[t+64>>2];g[x+(C*184|0)+36>>2]=D;g[x+(C*184|0)+40>>2]=v;g[x+(C*184|0)+44>>2]=w;g[x+(C*184|0)+48>>2]=0.0}}t=c[5022]|0;C=(c[t+16>>2]|0)+ -1|0;c[t+16>>2]=C;if(!C){if(c[t+4>>2]|0){Eb(f+280|0,0)|0;C=c[5008]|0;g[t+8>>2]=+(((c[f+284>>2]|0)-(c[C+4>>2]|0)+(((c[f+280>>2]|0)-(c[C>>2]|0)|0)*1e6|0)-(c[t+12>>2]|0)|0)>>>0)/1.0e3+ +g[t+8>>2];if(c[t+16>>2]|0)break;t=c[5022]|0}c[5022]=c[t+20>>2]}}while(0);q=q+1|0}while((q|0)<(c[d+232>>2]|0))}o=c[5022]|0;C=(c[o+16>>2]|0)+ -1|0;c[o+16>>2]=C;do if(!C){if(c[o+4>>2]|0){Eb(f+280|0,0)|0;C=c[5008]|0;g[o+8>>2]=+(((c[f+284>>2]|0)-(c[C+4>>2]|0)+(((c[f+280>>2]|0)-(c[C>>2]|0)|0)*1e6|0)-(c[o+12>>2]|0)|0)>>>0)/1.0e3+ +g[o+8>>2];if(c[o+16>>2]|0)break;o=c[5022]|0}c[5022]=c[o+20>>2]}while(0);Lb[c[(c[d>>2]|0)+44>>2]&511](d);Lb[c[(c[d>>2]|0)+148>>2]&511](d);g[d+104>>2]=e;Nb[c[(c[d>>2]|0)+152>>2]&127](d,d+92|0);Kb[c[(c[d>>2]|0)+144>>2]&31](d,e);yE(1664);if((c[d+280>>2]|0)>0){o=0;do{C=c[(c[d+288>>2]|0)+(o<<2)>>2]|0;tc[c[(c[C>>2]|0)+8>>2]&7](C,d,e);o=o+1|0}while((o|0)<(c[d+280>>2]|0))}o=c[5022]|0;C=(c[o+16>>2]|0)+ -1|0;c[o+16>>2]=C;do if(!C){if(c[o+4>>2]|0){Eb(f+280|0,0)|0;C=c[5008]|0;g[o+8>>2]=+(((c[f+284>>2]|0)-(c[C+4>>2]|0)+(((c[f+280>>2]|0)-(c[C>>2]|0)|0)*1e6|0)-(c[o+12>>2]|0)|0)>>>0)/1.0e3+ +g[o+8>>2];if(c[o+16>>2]|0)break;o=c[5022]|0}c[5022]=c[o+20>>2]}while(0);Kb[c[(c[d>>2]|0)+156>>2]&31](d,e);o=c[d+80>>2]|0;if(o)Kb[o&31](d,e);d=c[5022]|0;C=(c[d+16>>2]|0)+ -1|0;c[d+16>>2]=C;if(C){i=f;return}do if(c[d+4>>2]|0){Eb(f+280|0,0)|0;C=c[5008]|0;g[d+8>>2]=+(((c[f+284>>2]|0)-(c[C+4>>2]|0)+(((c[f+280>>2]|0)-(c[C>>2]|0)|0)*1e6|0)-(c[d+12>>2]|0)|0)>>>0)/1.0e3+ +g[d+8>>2];if(!(c[d+16>>2]|0)){d=c[5022]|0;break}else{i=f;return}}while(0);c[5022]=c[d+20>>2];i=f;return}function Wo(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,h=0,j=0.0,k=0,l=0.0,m=0.0;d=i;c[a+248>>2]=c[b+0>>2];c[a+252>>2]=c[b+4>>2];c[a+256>>2]=c[b+8>>2];c[a+260>>2]=c[b+12>>2];h=c[a+232>>2]|0;if((h|0)<=0){i=d;return}e=0;do{f=c[(c[a+240>>2]|0)+(e<<2)>>2]|0;k=c[f+216>>2]|0;if(!((k|0)==2|(k|0)==5)?(c[f+504>>2]&1|0)==0:0){j=+g[f+344>>2];if(j!=0.0){m=1.0/j*+g[b+4>>2];l=1.0/j*+g[b+8>>2];g[f+364>>2]=1.0/j*+g[b>>2];g[f+368>>2]=m;g[f+372>>2]=l;g[f+376>>2]=0.0}c[f+380>>2]=c[b+0>>2];c[f+384>>2]=c[b+4>>2];c[f+388>>2]=c[b+8>>2];c[f+392>>2]=c[b+12>>2];h=c[a+232>>2]|0}e=e+1|0}while((e|0)<(h|0));i=d;return}function Xo(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+0>>2]=c[b+248>>2];c[a+4>>2]=c[b+252>>2];c[a+8>>2]=c[b+256>>2];c[a+12>>2]=c[b+260>>2];i=d;return}function Yo(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=i;Cu(a,b,c,d);i=e;return}function Zo(a,b){a=a|0;b=b|0;var d=0;d=i;if((b|0)==0?1:(c[b+236>>2]&2|0)==0){Gu(a,b);i=d;return}else{Nb[c[(c[a>>2]|0)+92>>2]&127](a,b);i=d;return}}function _o(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0;e=i;d=c[a+232>>2]|0;a:do if((d|0)>0){f=c[a+240>>2]|0;g=0;while(1){h=f+(g<<2)|0;j=g+1|0;if((c[h>>2]|0)==(b|0))break;if((j|0)<(d|0))g=j;else break a}if((g|0)<(d|0)){c[h>>2]=c[f+(d+ -1<<2)>>2];c[(c[a+240>>2]|0)+(d+ -1<<2)>>2]=b;c[a+232>>2]=d+ -1}}while(0);Gu(a,b);i=e;return}function $o(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0.0,n=0.0,o=0.0;e=i;h=c[d+204>>2]|0;if((h&3|0)==0?(c[d+504>>2]&1|0)==0:0){m=+g[d+344>>2];if(m!=0.0){o=1.0/m*+g[b+252>>2];n=1.0/m*+g[b+256>>2];g[d+364>>2]=1.0/m*+g[b+248>>2];g[d+368>>2]=o;g[d+372>>2]=n;g[d+376>>2]=0.0}c[d+380>>2]=c[b+248>>2];c[d+384>>2]=c[b+252>>2];c[d+388>>2]=c[b+256>>2];c[d+392>>2]=c[b+260>>2]}if(!(c[d+192>>2]|0)){i=e;return}if(h&1){if(((c[d+216>>2]|0)+ -4|0)>>>0>=2)c[d+216>>2]=2}else{j=c[b+232>>2]|0;if((j|0)==(c[b+236>>2]|0)?(f=(j|0)==0?1:j<<1,(j|0)<(f|0)):0){if(!f)h=0;else{c[5004]=(c[5004]|0)+1;h=fF((f<<2|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+232>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<2)|0;if(l)c[l>>2]=c[(c[b+240>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(j|0))}k=c[b+240>>2]|0;if(k){if(a[b+244>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0);j=c[b+232>>2]|0}c[b+240>>2]=0}a[b+244>>0]=1;c[b+240>>2]=h;c[b+236>>2]=f}f=(c[b+240>>2]|0)+(j<<2)|0;if(f)c[f>>2]=d;c[b+232>>2]=j+1;h=c[d+204>>2]|0}if(!(h&1))f=(h&2|0)==0;else f=0;vc[c[(c[b>>2]|0)+36>>2]&127](b,d,f?1:2,f?-1:-3);i=e;return}function ap(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0.0,p=0.0,q=0.0;h=i;k=c[d+204>>2]|0;if((k&3|0)==0?(c[d+504>>2]&1|0)==0:0){o=+g[d+344>>2];if(o!=0.0){q=1.0/o*+g[b+252>>2];p=1.0/o*+g[b+256>>2];g[d+364>>2]=1.0/o*+g[b+248>>2];g[d+368>>2]=q;g[d+372>>2]=p;g[d+376>>2]=0.0}c[d+380>>2]=c[b+248>>2];c[d+384>>2]=c[b+252>>2];c[d+388>>2]=c[b+256>>2];c[d+392>>2]=c[b+260>>2]}if(!(c[d+192>>2]|0)){i=h;return}if(k&1){if(((c[d+216>>2]|0)+ -4|0)>>>0>=2)c[d+216>>2]=2}else{l=c[b+232>>2]|0;if((l|0)==(c[b+236>>2]|0)?(j=(l|0)==0?1:l<<1,(l|0)<(j|0)):0){if(!j)k=0;else{c[5004]=(c[5004]|0)+1;k=fF((j<<2|3)+16|0)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}l=c[b+232>>2]|0}if((l|0)>0){n=0;do{m=k+(n<<2)|0;if(m)c[m>>2]=c[(c[b+240>>2]|0)+(n<<2)>>2];n=n+1|0}while((n|0)!=(l|0))}m=c[b+240>>2]|0;if(m){if(a[b+244>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0);l=c[b+232>>2]|0}c[b+240>>2]=0}a[b+244>>0]=1;c[b+240>>2]=k;c[b+236>>2]=j}j=(c[b+240>>2]|0)+(l<<2)|0;if(j)c[j>>2]=d;c[b+232>>2]=l+1}vc[c[(c[b>>2]|0)+36>>2]&127](b,d,e,f);i=h;return}function bp(b,d){b=b|0;d=+d;var e=0,f=0,h=0,j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0;e=i;i=i+16|0;yE(1680);if((c[b+232>>2]|0)>0){f=(a[3896]|0)==0;h=0;do{k=c[(c[b+240>>2]|0)+(h<<2)>>2]|0;a:do if(k){l=c[k+216>>2]|0;do if(!((l|0)==4|(l|0)==2)){p=+g[k+312>>2];o=+g[k+316>>2];n=+g[k+320>>2];m=+g[k+472>>2];if(p*p+o*o+n*n<m*m?(m=+g[k+328>>2],n=+g[k+332>>2],o=+g[k+336>>2],p=+g[k+476>>2],m*m+n*n+o*o<p*p):0){g[k+220>>2]=+g[k+220>>2]+d;j=10;break}g[k+220>>2]=0.0;if((l+ -4|0)>>>0>=2){c[k+216>>2]=0;l=0}else j=10}else j=10;while(0);if((j|0)==10){j=0;if((l|0)==4)break}do if(f){if((l+ -2|0)>>>0>=2?!(+g[k+220>>2]>2.0):0)break;if(c[k+204>>2]&3){if((l+ -4|0)>>>0<2)break a;c[k+216>>2]=2;break a}if((l|0)==1){c[k+216>>2]=3;break a}if((l|0)!=2)break a;l=(c[k+260>>2]|0)+2|0;c[k+328>>2]=0;c[k+332>>2]=0;c[k+336>>2]=0;c[k+340>>2]=0;c[k+260>>2]=l;c[k+312>>2]=0;c[k+316>>2]=0;c[k+320>>2]=0;c[k+324>>2]=0;break a}while(0);if((l+ -4|0)>>>0>=2)c[k+216>>2]=1}while(0);h=h+1|0}while((h|0)<(c[b+232>>2]|0))}b=c[5022]|0;l=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=l;if(l){i=e;return}do if(c[b+4>>2]|0){Eb(e|0,0)|0;l=c[5008]|0;g[b+8>>2]=+(((c[e+4>>2]|0)-(c[l+4>>2]|0)+(((c[e>>2]|0)-(c[l>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=e;return}}while(0);c[5022]=c[b+20>>2];i=e;return}function cp(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0;f=i;j=c[b+212>>2]|0;if((j|0)==(c[b+216>>2]|0)?(g=(j|0)==0?1:j<<1,(j|0)<(g|0)):0){if(!g)h=0;else{c[5004]=(c[5004]|0)+1;h=fF((g<<2|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+212>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<2)|0;if(l)c[l>>2]=c[(c[b+220>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(j|0))}k=c[b+220>>2]|0;if(k){if(a[b+224>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0);j=c[b+212>>2]|0}c[b+220>>2]=0}a[b+224>>0]=1;c[b+220>>2]=h;c[b+216>>2]=g}g=(c[b+220>>2]|0)+(j<<2)|0;if(g)c[g>>2]=d;c[b+212>>2]=j+1;if(!e){i=f;return}pr(c[d+28>>2]|0,d);pr(c[d+32>>2]|0,d);i=f;return}function dp(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0;d=i;k=c[a+212>>2]|0;a:do if((k|0)>0){f=c[a+220>>2]|0;g=0;while(1){h=f+(g<<2)|0;j=g+1|0;if((c[h>>2]|0)==(b|0))break;if((j|0)<(k|0))g=j;else break a}if((g|0)<(k|0)){c[h>>2]=c[f+(k+ -1<<2)>>2];c[(c[a+220>>2]|0)+(k+ -1<<2)>>2]=b;c[a+212>>2]=k+ -1}}while(0);a=c[b+28>>2]|0;g=c[a+488>>2]|0;b:do if((g|0)>0){f=c[a+496>>2]|0;h=0;while(1){j=f+(h<<2)|0;k=h+1|0;if((c[j>>2]|0)==(b|0))break;if((k|0)<(g|0))h=k;else break b}if((h|0)<(g|0)){c[j>>2]=c[f+(g+ -1<<2)>>2];c[(c[a+496>>2]|0)+(g+ -1<<2)>>2]=b;c[a+488>>2]=g+ -1;g=g+ -1|0}}while(0);c[a+256>>2]=(g|0)>0&1;a=c[b+32>>2]|0;f=c[a+488>>2]|0;if((f|0)<=0){j=f;j=(j|0)>0;j=j&1;k=a+256|0;c[k>>2]=j;i=d;return}h=c[a+496>>2]|0;j=0;while(1){k=h+(j<<2)|0;g=j+1|0;if((c[k>>2]|0)==(b|0))break;if((g|0)<(f|0))j=g;else{e=19;break}}if((e|0)==19){j=(f|0)>0;j=j&1;k=a+256|0;c[k>>2]=j;i=d;return}if((j|0)>=(f|0)){j=f;j=(j|0)>0;j=j&1;k=a+256|0;c[k>>2]=j;i=d;return}c[k>>2]=c[h+(f+ -1<<2)>>2];c[(c[a+496>>2]|0)+(f+ -1<<2)>>2]=b;c[a+488>>2]=f+ -1;j=f+ -1|0;j=(j|0)>0;j=j&1;k=a+256|0;c[k>>2]=j;i=d;return}function ep(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;h=c[b+280>>2]|0;if((h|0)==(c[b+284>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[b+280>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[b+288>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[b+288>>2]|0;if(j){if(a[b+292>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[b+280>>2]|0}c[b+288>>2]=0}a[b+292>>0]=1;c[b+288>>2]=g;c[b+284>>2]=f}f=(c[b+288>>2]|0)+(h<<2)|0;if(!f){k=h+1|0;c[b+280>>2]=k;i=e;return}c[f>>2]=d;k=h+1|0;c[b+280>>2]=k;i=e;return}function fp(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0;e=i;f=c[a+280>>2]|0;if((f|0)<=0){i=e;return}g=c[a+288>>2]|0;h=0;while(1){j=g+(h<<2)|0;k=h+1|0;if((c[j>>2]|0)==(b|0))break;if((k|0)<(f|0))h=k;else{d=7;break}}if((d|0)==7){i=e;return}if((h|0)>=(f|0)){i=e;return}c[j>>2]=c[g+(f+ -1<<2)>>2];c[(c[a+288>>2]|0)+(f+ -1<<2)>>2]=b;c[a+280>>2]=f+ -1;i=e;return}function gp(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+64>>2]&127](a,b);i=d;return}function hp(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+68>>2]&127](a,b);i=d;return}function ip(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+64>>2]&127](a,b);i=d;return}function jp(a,b){a=a|0;b=b|0;var d=0;d=i;Nb[c[(c[a>>2]|0)+68>>2]&127](a,b);i=d;return}function kp(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0;e=i;i=i+16|0;yE(1704);f=c[b+212>>2]|0;h=c[b+180>>2]|0;if((h|0)<(f|0)){if((c[b+184>>2]|0)<(f|0)){if(!f){k=0;n=h}else{c[5004]=(c[5004]|0)+1;k=fF((f<<2|3)+16|0)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}n=c[b+180>>2]|0}if((n|0)>0){l=0;do{m=k+(l<<2)|0;if(m)c[m>>2]=c[(c[b+188>>2]|0)+(l<<2)>>2];l=l+1|0}while((l|0)!=(n|0))}l=c[b+188>>2]|0;if(l){if(a[b+192>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[b+188>>2]=0}a[b+192>>0]=1;c[b+188>>2]=k;c[b+184>>2]=f;k=b+188|0}else k=b+188|0;do{l=(c[k>>2]|0)+(h<<2)|0;if(l)c[l>>2]=0;h=h+1|0}while((h|0)!=(f|0))}c[b+180>>2]=f;f=0;while(1){if((f|0)>=(Pb[c[(c[b>>2]|0)+104>>2]&127](b)|0))break;c[(c[b+188>>2]|0)+(f<<2)>>2]=c[(c[b+220>>2]|0)+(f<<2)>>2];f=f+1|0}f=c[b+180>>2]|0;if((f|0)>1)Cp(b+176|0,0,f+ -1|0);if(!(Pb[c[(c[b>>2]|0)+104>>2]&127](b)|0))h=0;else h=c[b+188>>2]|0;f=c[b+196>>2]|0;v=c[b+180>>2]|0;k=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;c[f+4>>2]=d;c[f+12>>2]=h;c[f+16>>2]=v;c[f+20>>2]=k;k=c[f+32>>2]|0;if((k|0)<0){if((c[f+36>>2]|0)<0){h=c[f+40>>2]|0;if(h){if(a[f+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[f+40>>2]=0}a[f+44>>0]=1;c[f+40>>2]=0;c[f+36>>2]=0;h=k}else h=k;do{k=(c[f+40>>2]|0)+(h<<2)|0;if(k)c[k>>2]=0;h=h+1|0}while((h|0)!=0)}c[f+32>>2]=0;h=c[f+52>>2]|0;if((h|0)<0){if((c[f+56>>2]|0)<0){k=c[f+60>>2]|0;if(k){if(a[f+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[f+60>>2]=0}a[f+64>>0]=1;c[f+60>>2]=0;c[f+56>>2]=0}do{k=(c[f+60>>2]|0)+(h<<2)|0;if(k)c[k>>2]=0;h=h+1|0}while((h|0)!=0)}c[f+52>>2]=0;k=c[f+72>>2]|0;if((k|0)<0){if((c[f+76>>2]|0)<0){h=c[f+80>>2]|0;if(h){if(a[f+84>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[f+80>>2]=0}a[f+84>>0]=1;c[f+80>>2]=0;c[f+76>>2]=0;h=k}else h=k;do{k=(c[f+80>>2]|0)+(h<<2)|0;if(k)c[k>>2]=0;h=h+1|0}while((h|0)!=0)}c[f+72>>2]=0;f=c[b+200>>2]|0;m=c[(c[f>>2]|0)+8>>2]|0;k=c[b+8>>2]|0;h=c[b+24>>2]|0;h=Pb[c[(c[h>>2]|0)+36>>2]&127](h)|0;rc[m&127](f,k,h);h=c[b+204>>2]|0;k=c[b+24>>2]|0;f=c[b+196>>2]|0;yE(16584);m=c[h+28>>2]|0;if((m|0)<0){if((c[h+32>>2]|0)<0){l=c[h+36>>2]|0;if(l){if(a[h+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[h+36>>2]=0}a[h+40>>0]=1;c[h+36>>2]=0;c[h+32>>2]=0}do{l=(c[h+36>>2]|0)+(m<<2)|0;if(l)c[l>>2]=0;m=m+1|0}while((m|0)!=0)}c[h+28>>2]=0;l=c[h+8>>2]|0;if((l|0)>0){m=c[h+16>>2]|0;n=0;do{o=m+(n<<3)|0;q=c[o>>2]|0;if((q|0)==(n|0))r=n;else{p=o;do{r=m+(q<<3)|0;c[p>>2]=c[r>>2];r=c[r>>2]|0;p=m+(r<<3)|0;q=c[p>>2]|0}while((r|0)!=(q|0))}c[o>>2]=r;n=n+1|0}while((n|0)!=(l|0));q=c[h+8>>2]|0;if((q|0)>1){tC(h+4|0,0,q+ -1|0);q=c[h+8>>2]|0}if((q|0)>0){p=c[h+16>>2]|0;r=0;while(1){o=c[p+(r<<3)>>2]|0;m=r;do{m=m+1|0;l=(m|0)<(q|0);if(!l)break}while((c[p+(m<<3)>>2]|0)==(o|0));if((r|0)<(m|0)){n=c[b+16>>2]|0;t=1;s=r;do{u=c[n+(c[p+(s<<3)+4>>2]<<2)>>2]|0;if((c[u+208>>2]|0)==(o|0)){v=c[u+216>>2]|0;t=t&(v|0)!=1&(v|0)!=4}s=s+1|0}while((s|0)!=(m|0));if(t){do{s=c[n+(c[p+(r<<3)+4>>2]<<2)>>2]|0;if((c[s+208>>2]|0)==(o|0)?((c[s+216>>2]|0)+ -4|0)>>>0>=2:0)c[s+216>>2]=2;r=r+1|0}while((r|0)<(m|0))}else do{s=c[n+(c[p+(r<<3)+4>>2]<<2)>>2]|0;if((c[s+208>>2]|0)==(o|0)?(c[s+216>>2]|0)==2:0){c[s+216>>2]=3;g[s+220>>2]=0.0}r=r+1|0}while((r|0)<(m|0))}if(l)r=m;else break}}}m=Pb[c[(c[k>>2]|0)+36>>2]&127](k)|0;if((m|0)>0){l=0;do{n=gc[c[(c[k>>2]|0)+40>>2]&31](k,l)|0;o=c[n+740>>2]|0;p=c[n+744>>2]|0;if((o|0)!=0?(c[o+216>>2]|0)!=2:0)q=101;else q=99;if(((q|0)==99?(q=0,(p|0)!=0):0)?(c[p+216>>2]|0)!=2:0)q=101;if((q|0)==101){v=c[o+204>>2]|0;if((((v&2|0)!=0?(c[o+216>>2]|0)!=2:0)?(v&4|0)==0:0)?(c[p+204>>2]&3|0)==0:0){if(((c[p+216>>2]|0)+ -4|0)>>>0>=2)c[p+216>>2]=1;g[p+220>>2]=0.0}v=c[p+204>>2]|0;if((((v&2|0)!=0?(c[p+216>>2]|0)!=2:0)?(v&4|0)==0:0)?(c[o+204>>2]&3|0)==0:0){if(((c[o+216>>2]|0)+ -4|0)>>>0>=2)c[o+216>>2]=1;g[o+220>>2]=0.0}if((a[h+64>>0]|0)!=0?Yb[c[(c[k>>2]|0)+28>>2]&31](k,o,p)|0:0){p=c[h+28>>2]|0;if((p|0)==(c[h+32>>2]|0)?(j=(p|0)==0?1:p<<1,(p|0)<(j|0)):0){if(!j)o=0;else{c[5004]=(c[5004]|0)+1;o=fF((j<<2|3)+16|0)|0;if(!o)o=0;else{c[(o+19&-16)+ -4>>2]=o;o=o+19&-16}p=c[h+28>>2]|0}if((p|0)>0){r=0;do{q=o+(r<<2)|0;if(q)c[q>>2]=c[(c[h+36>>2]|0)+(r<<2)>>2];r=r+1|0}while((r|0)!=(p|0))}q=c[h+36>>2]|0;if(q){if(a[h+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[q+ -4>>2]|0);p=c[h+28>>2]|0}c[h+36>>2]=0}a[h+40>>0]=1;c[h+36>>2]=o;c[h+32>>2]=j}o=(c[h+36>>2]|0)+(p<<2)|0;if(o)c[o>>2]=n;c[h+28>>2]=p+1}}l=l+1|0}while((l|0)<(m|0))}j=c[5022]|0;v=(c[j+16>>2]|0)+ -1|0;c[j+16>>2]=v;do if(!v){if(c[j+4>>2]|0){Eb(e|0,0)|0;v=c[5008]|0;g[j+8>>2]=+(((c[e+4>>2]|0)-(c[v+4>>2]|0)+(((c[e>>2]|0)-(c[v>>2]|0)|0)*1e6|0)-(c[j+12>>2]|0)|0)>>>0)/1.0e3+ +g[j+8>>2];if(c[j+16>>2]|0)break;j=c[5022]|0}c[5022]=c[j+20>>2]}while(0);j=c[h+8>>2]|0;yE(16616);if(a[h+64>>0]|0){k=c[h+28>>2]|0;if((k|0)>1)rB(h+24|0,0,k+ -1|0);if((j|0)>0){n=1;o=0;l=0;do{r=c[h+16>>2]|0;m=c[r+(o<<3)>>2]|0;a:do if((o|0)<(j|0)){q=m;p=1;while(1){if((q|0)!=(m|0))break a;q=c[(c[b+16>>2]|0)+(c[r+(o<<3)+4>>2]<<2)>>2]|0;t=c[h+48>>2]|0;do if((t|0)==(c[h+52>>2]|0)){r=(t|0)==0?1:t<<1;if((t|0)>=(r|0))break;if(!r)s=0;else{c[5004]=(c[5004]|0)+1;s=fF((r<<2|3)+16|0)|0;if(!s)s=0;else{c[(s+19&-16)+ -4>>2]=s;s=s+19&-16}t=c[h+48>>2]|0}if((t|0)>0){u=0;do{v=s+(u<<2)|0;if(v)c[v>>2]=c[(c[h+56>>2]|0)+(u<<2)>>2];u=u+1|0}while((u|0)!=(t|0))}u=c[h+56>>2]|0;if(u){if(a[h+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[u+ -4>>2]|0);t=c[h+48>>2]|0}c[h+56>>2]=0}a[h+60>>0]=1;c[h+56>>2]=s;c[h+52>>2]=r}while(0);r=(c[h+56>>2]|0)+(t<<2)|0;if(r)c[r>>2]=q;c[h+48>>2]=t+1;v=c[q+216>>2]|0;p=p&((v|0)==2|(v|0)==5);o=o+1|0;if((o|0)>=(j|0))break a;r=c[h+16>>2]|0;q=c[r+(o<<3)>>2]|0}}else p=1;while(0);if((l|0)<(k|0)){r=c[h+36>>2]|0;q=r+(l<<2)|0;s=c[q>>2]|0;t=c[(c[s+740>>2]|0)+208>>2]|0;if((t|0)<=-1)t=c[(c[s+744>>2]|0)+208>>2]|0;if((t|0)==(m|0)){s=l;do{s=s+1|0;if((s|0)>=(k|0))break;t=c[r+(s<<2)>>2]|0;n=c[(c[t+740>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[t+744>>2]|0)+208>>2]|0}while((m|0)==(n|0));n=s;r=s-l|0}else{r=0;q=0}}else{r=0;q=0}if(!p)Zb[c[(c[f>>2]|0)+8>>2]&7](f,c[h+56>>2]|0,c[h+48>>2]|0,q,r,m);l=(r|0)==0?l:n;p=c[h+48>>2]|0;if((p|0)<0){if((c[h+52>>2]|0)<0){m=c[h+56>>2]|0;if(m){if(a[h+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[h+56>>2]=0}a[h+60>>0]=1;c[h+56>>2]=0;c[h+52>>2]=0}do{m=(c[h+56>>2]|0)+(p<<2)|0;if(m)c[m>>2]=0;p=p+1|0}while((p|0)!=0)}c[h+48>>2]=0}while((o|0)<(j|0))}}else{u=Pb[c[(c[k>>2]|0)+44>>2]&127](k)|0;v=Pb[c[(c[k>>2]|0)+36>>2]&127](k)|0;Zb[c[(c[f>>2]|0)+8>>2]&7](f,c[b+16>>2]|0,c[b+8>>2]|0,u,v,-1)}f=c[5022]|0;v=(c[f+16>>2]|0)+ -1|0;c[f+16>>2]=v;do if(!v){if(c[f+4>>2]|0){Eb(e|0,0)|0;v=c[5008]|0;g[f+8>>2]=+(((c[e+4>>2]|0)-(c[v+4>>2]|0)+(((c[e>>2]|0)-(c[v>>2]|0)|0)*1e6|0)-(c[f+12>>2]|0)|0)>>>0)/1.0e3+ +g[f+8>>2];if(c[f+16>>2]|0)break;f=c[5022]|0}c[5022]=c[f+20>>2]}while(0);lp(c[b+196>>2]|0);v=c[b+200>>2]|0;rc[c[(c[v>>2]|0)+16>>2]&127](v,d,c[b+72>>2]|0);b=c[5022]|0;v=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=v;if(v){i=e;return}do if(c[b+4>>2]|0){Eb(e|0,0)|0;v=c[5008]|0;g[b+8>>2]=+(((c[e+4>>2]|0)-(c[v+4>>2]|0)+(((c[e>>2]|0)-(c[v>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=e;return}}while(0);c[5022]=c[b+20>>2];i=e;return}function lp(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0;d=i;e=c[b+32>>2]|0;if(!e)f=0;else f=c[b+40>>2]|0;g=c[b+52>>2]|0;if(!g)h=0;else h=c[b+60>>2]|0;j=c[b+72>>2]|0;if(!j)k=0;else k=c[b+80>>2]|0;l=c[b+8>>2]|0;+ic[c[(c[l>>2]|0)+12>>2]&3](l,f,e,h,g,k,j,c[b+4>>2]|0,c[b+20>>2]|0,c[b+24>>2]|0);e=c[b+32>>2]|0;if((e|0)<0){if((c[b+36>>2]|0)<0){f=c[b+40>>2]|0;if(f){if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+40>>2]=0}a[b+44>>0]=1;c[b+40>>2]=0;c[b+36>>2]=0}do{f=(c[b+40>>2]|0)+(e<<2)|0;if(f)c[f>>2]=0;e=e+1|0}while((e|0)!=0)}c[b+32>>2]=0;e=c[b+52>>2]|0;if((e|0)<0){if((c[b+56>>2]|0)<0){f=c[b+60>>2]|0;if(f){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=0;c[b+56>>2]=0}do{f=(c[b+60>>2]|0)+(e<<2)|0;if(f)c[f>>2]=0;e=e+1|0}while((e|0)!=0)}c[b+52>>2]=0;e=c[b+72>>2]|0;if((e|0)>=0){c[b+72>>2]=0;i=d;return}if((c[b+76>>2]|0)<0){f=c[b+80>>2]|0;if(f){if(a[b+84>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+80>>2]=0}a[b+84>>0]=1;c[b+80>>2]=0;c[b+76>>2]=0;f=e}else f=e;do{e=(c[b+80>>2]|0)+(f<<2)|0;if(e)c[e>>2]=0;f=f+1|0}while((f|0)!=0);c[b+72>>2]=0;i=d;return}function mp(b){b=b|0;var d=0,e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;d=i;i=i+16|0;yE(1728);p=c[b+204>>2]|0;rc[c[(c[p>>2]|0)+8>>2]&127](p,b,c[b+24>>2]|0);if((c[b+308>>2]|0)>0){h=c[b+316>>2]|0;j=0;do{k=c[h+(j<<2)>>2]|0;l=c[k+740>>2]|0;k=c[k+744>>2]|0;if(((l|0)!=0?!((k|0)==0?1:(c[l+204>>2]&3|0)!=0):0)?(c[k+204>>2]&3|0)==0:0){m=c[l+208>>2]|0;l=c[k+208>>2]|0;k=c[(c[b+204>>2]|0)+16>>2]|0;n=c[k+(m<<3)>>2]|0;if((n|0)!=(m|0)){o=k+(m<<3)|0;do{m=k+(n<<3)|0;c[o>>2]=c[m>>2];m=c[m>>2]|0;o=k+(m<<3)|0;n=c[o>>2]|0}while((m|0)!=(n|0))}n=c[k+(l<<3)>>2]|0;if((n|0)!=(l|0)){o=k+(l<<3)|0;do{l=k+(n<<3)|0;c[o>>2]=c[l>>2];l=c[l>>2]|0;o=k+(l<<3)|0;n=c[o>>2]|0}while((l|0)!=(n|0))}if((m|0)!=(l|0)){c[k+(m<<3)>>2]=l;p=k+(l<<3)+4|0;c[p>>2]=(c[p>>2]|0)+(c[k+(m<<3)+4>>2]|0)}}j=j+1|0}while((j|0)<(c[b+308>>2]|0))}h=c[b+212>>2]|0;if((h|0)>0){k=c[b+220>>2]|0;j=0;do{l=c[k+(j<<2)>>2]|0;if((((a[l+20>>0]|0)!=0?(e=c[l+28>>2]|0,f=c[l+32>>2]|0,(e|0)!=0):0)?!((f|0)==0?1:(c[e+204>>2]&3|0)!=0):0)?(c[f+204>>2]&3|0)==0:0){n=c[e+208>>2]|0;m=c[f+208>>2]|0;l=c[(c[b+204>>2]|0)+16>>2]|0;o=c[l+(n<<3)>>2]|0;if((o|0)!=(n|0)){p=l+(n<<3)|0;do{n=l+(o<<3)|0;c[p>>2]=c[n>>2];n=c[n>>2]|0;p=l+(n<<3)|0;o=c[p>>2]|0}while((n|0)!=(o|0))}o=c[l+(m<<3)>>2]|0;if((o|0)!=(m|0)){p=l+(m<<3)|0;do{m=l+(o<<3)|0;c[p>>2]=c[m>>2];m=c[m>>2]|0;p=l+(m<<3)|0;o=c[p>>2]|0}while((m|0)!=(o|0))}if((n|0)!=(m|0)){c[l+(n<<3)>>2]=m;p=l+(m<<3)+4|0;c[p>>2]=(c[p>>2]|0)+(c[l+(n<<3)+4>>2]|0)}}j=j+1|0}while((j|0)!=(h|0))}p=c[b+204>>2]|0;Nb[c[(c[p>>2]|0)+12>>2]&127](p,b);b=c[5022]|0;p=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=p;if(p){i=d;return}do if(c[b+4>>2]|0){Eb(d|0,0)|0;p=c[5008]|0;g[b+8>>2]=+(((c[d+4>>2]|0)-(c[p+4>>2]|0)+(((c[d>>2]|0)-(c[p>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=d;return}}while(0);c[5022]=c[b+20>>2];i=d;return}function np(a){a=a|0;return}function op(a){a=a|0;return}function pp(d,e){d=d|0;e=+e;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0.0,C=0.0,D=0.0,E=0.0;f=i;i=i+352|0;yE(1872);if((c[d+232>>2]|0)>0){q=f+232|0;n=0;do{o=c[(c[d+240>>2]|0)+(n<<2)>>2]|0;g[o+244>>2]=1.0;A=c[o+216>>2]|0;do if(!((A|0)==2|(A|0)==5)?(c[o+204>>2]&3|0)==0:0){Bo(o+4|0,+g[o+312>>2],+g[o+316>>2],+g[o+320>>2],o+328|0,e,f+184|0);D=+g[q>>2]- +g[o+52>>2];C=+g[f+236>>2]- +g[o+56>>2];B=+g[f+240>>2]- +g[o+60>>2];if((a[d+44>>0]|0)!=0?(E=+g[o+252>>2],E*E!=0.0?E*E<D*D+C*C+B*B:0):0){yE(1896);if((c[(c[o+192>>2]|0)+4>>2]|0)<20){c[440]=(c[440]|0)+1;z=c[d+68>>2]|0;z=Pb[c[(c[z>>2]|0)+36>>2]&127](z)|0;A=c[d+24>>2]|0;g[f+252>>2]=1.0;b[f+256>>1]=1;b[f+258>>1]=-1;c[f+248>>2]=688;c[f+260>>2]=c[o+52>>2];c[f+264>>2]=c[o+56>>2];c[f+268>>2]=c[o+60>>2];c[f+272>>2]=c[o+64>>2];c[f+276>>2]=c[q+0>>2];c[f+280>>2]=c[q+4>>2];c[f+284>>2]=c[q+8>>2];c[f+288>>2]=c[q+12>>2];c[f+324>>2]=0;c[f+248>>2]=2160;c[f+328>>2]=o;g[f+332>>2]=0.0;c[f+336>>2]=z;c[f+340>>2]=A;B=+g[o+248>>2];c[f+136>>2]=0;g[f+140>>2]=1.0;g[f+144>>2]=1.0;g[f+148>>2]=1.0;g[f+152>>2]=0.0;c[f+128>>2]=16680;c[f+132>>2]=8;g[f+156>>2]=B;g[f+172>>2]=B;g[f+332>>2]=+g[d+56>>2];A=c[o+188>>2]|0;b[f+256>>1]=b[A+4>>1]|0;b[f+258>>1]=b[A+6>>1]|0;c[f+112>>2]=c[q+0>>2];c[f+116>>2]=c[q+4>>2];c[f+120>>2]=c[q+8>>2];c[f+124>>2]=c[q+12>>2];c[f+64>>2]=c[o+4>>2];c[f+68>>2]=c[o+8>>2];c[f+72>>2]=c[o+12>>2];c[f+76>>2]=c[o+16>>2];c[f+80>>2]=c[o+20>>2];c[f+84>>2]=c[o+24>>2];c[f+88>>2]=c[o+28>>2];c[f+92>>2]=c[o+32>>2];c[f+96>>2]=c[o+36>>2];c[f+100>>2]=c[o+40>>2];c[f+104>>2]=c[o+44>>2];c[f+108>>2]=c[o+48>>2];Ou(d,f+128|0,o+4|0,f+64|0,f+248|0,0.0);B=+g[f+252>>2];if(B<1.0){g[o+244>>2]=B;Bo(o+4|0,+g[o+312>>2],+g[o+316>>2],+g[o+320>>2],o+328|0,B*e,f+184|0);g[o+244>>2]=0.0;nr(o,f+184|0);r=4}else r=0;if(!r)p=11}else p=11;if((p|0)==11){p=0;r=0}s=c[5022]|0;A=(c[s+16>>2]|0)+ -1|0;c[s+16>>2]=A;do if(!A){if(c[s+4>>2]|0){Eb(f+248|0,0)|0;A=c[5008]|0;g[s+8>>2]=+(((c[f+252>>2]|0)-(c[A+4>>2]|0)+(((c[f+248>>2]|0)-(c[A>>2]|0)|0)*1e6|0)-(c[s+12>>2]|0)|0)>>>0)/1.0e3+ +g[s+8>>2];if(c[s+16>>2]|0)break;s=c[5022]|0}c[5022]=c[s+20>>2]}while(0);if((r|0)==4)break}nr(o,f+184|0)}while(0);n=n+1|0}while((n|0)<(c[d+232>>2]|0))}do if(a[d+275>>0]|0){yE(1920);q=c[d+308>>2]|0;if((q|0)>0){n=0;do{o=c[(c[d+316>>2]|0)+(n<<2)>>2]|0;x=c[o+740>>2]|0;if(!(c[x+236>>2]&2))x=0;p=c[o+744>>2]|0;if(!(c[p+236>>2]&2))p=0;z=c[o+748>>2]|0;if((z|0)>0){s=x+52|0;r=x+56|0;q=x+60|0;v=p+52|0;t=p+56|0;u=p+60|0;w=(p|0)==0;if(!x){x=p+228|0;y=0;do{e=+g[57]*+g[x>>2];if((e>0.0?(h=+g[o+(y*184|0)+124>>2],h!=0.0):0)?(j=e*h*+g[o+(y*184|0)+68>>2],k=e*h*+g[o+(y*184|0)+72>>2],l=e*h*+g[o+(y*184|0)+76>>2],g[f+48>>2]=-j,g[f+52>>2]=-k,g[f+56>>2]=-l,g[f+60>>2]=0.0,E=+g[o+(y*184|0)+56>>2]- +g[r>>2],D=+g[o+(y*184|0)+60>>2]- +g[q>>2],g[f+32>>2]=+g[o+(y*184|0)+52>>2]- +g[s>>2],g[f+36>>2]=E,g[f+40>>2]=D,g[f+44>>2]=0.0,D=+g[o+(y*184|0)+40>>2]- +g[t>>2],E=+g[o+(y*184|0)+44>>2]- +g[u>>2],g[f+16>>2]=+g[o+(y*184|0)+36>>2]- +g[v>>2],g[f+20>>2]=D,g[f+24>>2]=E,g[f+28>>2]=0.0,!w):0){g[f>>2]=j;g[f+4>>2]=k;g[f+8>>2]=l;g[f+12>>2]=0.0;ym(p,f,f+16|0);z=c[o+748>>2]|0}y=y+1|0}while((y|0)<(z|0))}else{z=x+228|0;A=p+228|0;y=0;do{e=+g[z>>2]*+g[A>>2];if((e>0.0?(m=+g[o+(y*184|0)+124>>2],m!=0.0):0)?(D=-(e*m*+g[o+(y*184|0)+72>>2]),E=-(e*m*+g[o+(y*184|0)+76>>2]),g[f+48>>2]=-(e*m*+g[o+(y*184|0)+68>>2]),g[f+52>>2]=D,g[f+56>>2]=E,g[f+60>>2]=0.0,E=+g[o+(y*184|0)+56>>2]- +g[r>>2],D=+g[o+(y*184|0)+60>>2]- +g[q>>2],g[f+32>>2]=+g[o+(y*184|0)+52>>2]- +g[s>>2],g[f+36>>2]=E,g[f+40>>2]=D,g[f+44>>2]=0.0,D=+g[o+(y*184|0)+40>>2]- +g[t>>2],E=+g[o+(y*184|0)+44>>2]- +g[u>>2],g[f+16>>2]=+g[o+(y*184|0)+36>>2]- +g[v>>2],g[f+20>>2]=D,g[f+24>>2]=E,g[f+28>>2]=0.0,ym(x,f+48|0,f+32|0),!w):0){D=-+g[f+52>>2];E=-+g[f+56>>2];g[f>>2]=-+g[f+48>>2];g[f+4>>2]=D;g[f+8>>2]=E;g[f+12>>2]=0.0;ym(p,f,f+16|0)}y=y+1|0}while((y|0)<(c[o+748>>2]|0))}q=c[d+308>>2]|0}n=n+1|0}while((n|0)<(q|0))}d=c[5022]|0;A=(c[d+16>>2]|0)+ -1|0;c[d+16>>2]=A;if(!A){if(c[d+4>>2]|0){Eb(f+248|0,0)|0;A=c[5008]|0;g[d+8>>2]=+(((c[f+252>>2]|0)-(c[A+4>>2]|0)+(((c[f+248>>2]|0)-(c[A>>2]|0)|0)*1e6|0)-(c[d+12>>2]|0)|0)>>>0)/1.0e3+ +g[d+8>>2];if(c[d+16>>2]|0)break;d=c[5022]|0}c[5022]=c[d+20>>2]}}while(0);d=c[5022]|0;A=(c[d+16>>2]|0)+ -1|0;c[d+16>>2]=A;if(A){i=f;return}do if(c[d+4>>2]|0){Eb(f+248|0,0)|0;A=c[5008]|0;g[d+8>>2]=+(((c[f+252>>2]|0)-(c[A+4>>2]|0)+(((c[f+248>>2]|0)-(c[A>>2]|0)|0)*1e6|0)-(c[d+12>>2]|0)|0)>>>0)/1.0e3+ +g[d+8>>2];if(!(c[d+16>>2]|0)){d=c[5022]|0;break}else{i=f;return}}while(0);c[5022]=c[d+20>>2];i=f;return}function qp(b,d){b=b|0;d=+d;var e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0;e=i;i=i+16|0;yE(1960);s=c[b+232>>2]|0;if((s|0)>0){f=0;do{h=c[(c[b+240>>2]|0)+(f<<2)>>2]|0;if(!(c[h+204>>2]&3)){k=+g[h+444>>2];n=+R(+(1.0-k),+d);p=n*+g[h+312>>2];g[h+312>>2]=p;m=n*+g[h+316>>2];g[h+316>>2]=m;n=n*+g[h+320>>2];g[h+320>>2]=n;j=+g[h+448>>2];q=+R(+(1.0-j),+d);l=q*+g[h+328>>2];g[h+328>>2]=l;o=q*+g[h+332>>2];g[h+332>>2]=o;q=q*+g[h+336>>2];g[h+336>>2]=q;do if(a[h+452>>0]|0){if(q*q+(l*l+o*o)<+g[h+464>>2]?p*p+m*m+n*n<+g[h+460>>2]:0){r=+g[h+456>>2];g[h+328>>2]=l*r;g[h+332>>2]=r*o;g[h+336>>2]=r*q;g[h+312>>2]=r*p;g[h+316>>2]=r*m;g[h+320>>2]=r*n;p=r*p;m=r*m;n=r*n;l=l*r;o=r*o;q=r*q}r=+Q(+(p*p+m*m+n*n));do if(r<k)if(r>.004999999888241291){p=p-p*(1.0/r)*.004999999888241291;g[h+312>>2]=p;m=m-m*(1.0/r)*.004999999888241291;g[h+316>>2]=m;n=n-n*(1.0/r)*.004999999888241291;g[h+320>>2]=n;break}else{c[h+312>>2]=0;c[h+316>>2]=0;c[h+320>>2]=0;c[h+324>>2]=0;p=0.0;m=0.0;n=0.0;break}while(0);k=+Q(+(l*l+o*o+q*q));if(k<j)if(k>.004999999888241291){g[h+328>>2]=l-l*(1.0/k)*.004999999888241291;g[h+332>>2]=o-o*(1.0/k)*.004999999888241291;g[h+336>>2]=q-q*(1.0/k)*.004999999888241291;break}else{c[h+328>>2]=0;c[h+332>>2]=0;c[h+336>>2]=0;c[h+340>>2]=0;break}}while(0);Bo(h+4|0,p,m,n,h+328|0,d,h+68|0);s=c[b+232>>2]|0}f=f+1|0}while((f|0)<(s|0))}b=c[5022]|0;s=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=s;if(s){i=e;return}do if(c[b+4>>2]|0){Eb(e|0,0)|0;s=c[5008]|0;g[b+8>>2]=+(((c[e+4>>2]|0)-(c[s+4>>2]|0)+(((c[e>>2]|0)-(c[s>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=e;return}}while(0);c[5022]=c[b+20>>2];i=e;return}function rp(b,d){b=b|0;d=d|0;var e=0,f=0;e=i;if((a[b+273>>0]|0)!=0?(f=c[b+200>>2]|0,(f|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}a[b+273>>0]=0;c[b+200>>2]=d;c[(c[b+196>>2]|0)+8>>2]=d;i=e;return}function sp(a){a=a|0;return c[a+200>>2]|0}function tp(a){a=a|0;return c[a+212>>2]|0}function up(a,b){a=a|0;b=b|0;return c[(c[a+220>>2]|0)+(b<<2)>>2]|0}function vp(a,b){a=a|0;b=b|0;return c[(c[a+220>>2]|0)+(b<<2)>>2]|0}function wp(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,h=0,j=0;d=i;Lb[c[(c[b>>2]|0)+32>>2]&511](b);e=Yb[c[(c[b>>2]|0)+16>>2]&31](b,104,1)|0;f=c[e+8>>2]|0;h=f+0|0;j=h+104|0;do{c[h>>2]=0;h=h+4|0}while((h|0)<(j|0));g[f+88>>2]=+g[a+248>>2];g[f+92>>2]=+g[a+252>>2];g[f+96>>2]=+g[a+256>>2];g[f+100>>2]=+g[a+260>>2];g[f>>2]=+g[a+92>>2];g[f+4>>2]=+g[a+96>>2];g[f+8>>2]=+g[a+100>>2];g[f+12>>2]=+g[a+104>>2];g[f+16>>2]=+g[a+108>>2];g[f+20>>2]=+g[a+116>>2];g[f+24>>2]=+g[a+120>>2];g[f+28>>2]=+g[a+124>>2];g[f+32>>2]=+g[a+128>>2];g[f+36>>2]=+g[a+132>>2];g[f+40>>2]=+g[a+140>>2];g[f+44>>2]=+g[a+144>>2];g[f+48>>2]=+g[a+148>>2];g[f+52>>2]=+g[a+152>>2];g[f+56>>2]=+g[a+168>>2];g[f+60>>2]=+g[a+172>>2];c[f+64>>2]=c[a+112>>2];c[f+68>>2]=c[a+156>>2];c[f+72>>2]=c[a+160>>2];c[f+76>>2]=c[a+164>>2];c[f+80>>2]=c[a+136>>2];Jb[c[(c[b>>2]|0)+20>>2]&31](b,e,1992,1145853764,f);f=c[a+8>>2]|0;if((f|0)>0){e=0;do{h=c[(c[a+16>>2]|0)+(e<<2)>>2]|0;if(c[h+236>>2]&2){j=Pb[c[(c[h>>2]|0)+16>>2]&127](h)|0;j=Yb[c[(c[b>>2]|0)+16>>2]&31](b,j,1)|0;f=Yb[c[(c[h>>2]|0)+20>>2]&31](h,c[j+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,j,f,1497645650,h);f=c[a+8>>2]|0}e=e+1|0}while((e|0)<(f|0))}if((c[a+212>>2]|0)<=0){Vu(a,b);j=c[b>>2]|0;j=j+36|0;j=c[j>>2]|0;Lb[j&511](b);i=d;return}e=0;do{j=c[(c[a+220>>2]|0)+(e<<2)>>2]|0;f=Pb[c[(c[j>>2]|0)+36>>2]&127](j)|0;f=Yb[c[(c[b>>2]|0)+16>>2]&31](b,f,1)|0;h=Yb[c[(c[j>>2]|0)+40>>2]&31](j,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,h,1397641027,j);e=e+1|0}while((e|0)<(c[a+212>>2]|0));Vu(a,b);j=c[b>>2]|0;j=j+36|0;j=c[j>>2]|0;Lb[j&511](b);i=d;return}function xp(a,b){a=a|0;b=b|0;c[a+72>>2]=b;return}function yp(a){a=a|0;return c[a+72>>2]|0}function zp(a){a=a|0;return 2}function Ap(a,b){a=a|0;b=b|0;return}function Bp(a,b){a=a|0;b=+b;var d=0,e=0,f=0;d=i;i=i+16|0;yE(1664);if((c[a+280>>2]|0)>0){e=0;do{f=c[(c[a+288>>2]|0)+(e<<2)>>2]|0;tc[c[(c[f>>2]|0)+8>>2]&7](f,a,b);e=e+1|0}while((e|0)<(c[a+280>>2]|0))}a=c[5022]|0;f=(c[a+16>>2]|0)+ -1|0;c[a+16>>2]=f;if(f){i=d;return}do if(c[a+4>>2]|0){Eb(d|0,0)|0;f=c[5008]|0;g[a+8>>2]=+(((c[d+4>>2]|0)-(c[f+4>>2]|0)+(((c[d>>2]|0)-(c[f>>2]|0)|0)*1e6|0)-(c[a+12>>2]|0)|0)>>>0)/1.0e3+ +g[a+8>>2];if(!(c[a+16>>2]|0)){a=c[5022]|0;break}else{i=d;return}}while(0);c[5022]=c[a+20>>2];i=d;return}function Cp(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;e=i;while(1){f=c[a+12>>2]|0;g=c[f+(((b+d|0)/2|0)<<2)>>2]|0;l=b;k=d;while(1){h=c[(c[g+28>>2]|0)+208>>2]|0;if((h|0)>-1)while(1){j=c[f+(l<<2)>>2]|0;m=c[(c[j+28>>2]|0)+208>>2]|0;if((m|0)<=-1)m=c[(c[j+32>>2]|0)+208>>2]|0;if((m|0)<(h|0))l=l+1|0;else break}else{m=c[(c[g+32>>2]|0)+208>>2]|0;while(1){j=c[f+(l<<2)>>2]|0;n=c[(c[j+28>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[j+32>>2]|0)+208>>2]|0;if((n|0)<(m|0))l=l+1|0;else break}}if((h|0)>-1)while(1){m=c[f+(k<<2)>>2]|0;n=c[(c[m+28>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[m+32>>2]|0)+208>>2]|0;if((h|0)<(n|0))k=k+ -1|0;else break}else{h=c[(c[g+32>>2]|0)+208>>2]|0;while(1){m=c[f+(k<<2)>>2]|0;n=c[(c[m+28>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[m+32>>2]|0)+208>>2]|0;if((h|0)<(n|0))k=k+ -1|0;else break}}if((l|0)<=(k|0)){c[f+(l<<2)>>2]=m;c[(c[a+12>>2]|0)+(k<<2)>>2]=j;l=l+1|0;k=k+ -1|0}if((l|0)>(k|0))break;f=c[a+12>>2]|0}if((k|0)>(b|0))Cp(a,b,k);if((l|0)<(d|0))b=l;else break}i=e;return}function Dp(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Ep(a){a=a|0;return a+12|0}function Fp(a){a=a|0;return 2144}function Gp(a,b){a=a|0;b=b|0;g[a>>2]=1.0;g[a+4>>2]=1.0;g[a+8>>2]=1.0;g[a+12>>2]=0.0;return}function Hp(a,b){a=a|0;b=+b;g[a+44>>2]=b;return}function Ip(a){a=a|0;return+(+g[a+28>>2]*+g[a+12>>2])}function Jp(a){a=a|0;return 52}function Kp(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=h;if(h)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+28>>2]=+g[a+28>>2];g[b+32>>2]=+g[a+32>>2];g[b+36>>2]=+g[a+36>>2];g[b+40>>2]=+g[a+40>>2];g[b+12>>2]=+g[a+12>>2];g[b+16>>2]=+g[a+16>>2];g[b+20>>2]=+g[a+20>>2];g[b+24>>2]=+g[a+24>>2];g[b+44>>2]=+g[a+44>>2];i=e;return 2112}function Lp(a){a=a|0;return 0}function Mp(a,b,c){a=a|0;b=b|0;c=c|0;return}function Np(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Op(a,d){a=a|0;d=d|0;var e=0,f=0,g=0;e=i;g=c[d>>2]|0;f=c[a+80>>2]|0;if((g|0)==(f|0)){d=0;i=e;return d|0}if(!((b[a+10>>1]&b[d+4>>1])<<16>>16)){d=0;i=e;return d|0}if(!((b[d+6>>1]&b[a+8>>1])<<16>>16)){d=0;i=e;return d|0}d=c[a+92>>2]|0;d=Yb[c[(c[d>>2]|0)+28>>2]&31](d,f,g)|0;i=e;return d|0}function Pp(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;e=i;f=c[b>>2]|0;if((f|0)==(c[a+80>>2]|0)){h=1.0;i=e;return+h}if(c[f+204>>2]&4){h=1.0;i=e;return+h}if((+g[a+28>>2]- +g[a+12>>2])*+g[b+8>>2]+(+g[a+32>>2]- +g[a+16>>2])*+g[b+12>>2]+(+g[a+36>>2]- +g[a+20>>2])*+g[b+16>>2]>=-+g[a+84>>2]){h=1.0;i=e;return+h}g[a+4>>2]=+g[b+40>>2];c[a+76>>2]=f;if(d){c[a+44>>2]=c[b+8>>2];c[a+48>>2]=c[b+12>>2];c[a+52>>2]=c[b+16>>2];c[a+56>>2]=c[b+20>>2]}else{m=+g[b+8>>2];l=+g[b+12>>2];k=+g[b+16>>2];j=m*+g[f+20>>2]+l*+g[f+24>>2]+k*+g[f+28>>2];h=m*+g[f+36>>2]+l*+g[f+40>>2]+k*+g[f+44>>2];g[a+44>>2]=+g[f+4>>2]*m+ +g[f+8>>2]*l+ +g[f+12>>2]*k;g[a+48>>2]=j;g[a+52>>2]=h;g[a+56>>2]=0.0}c[a+60>>2]=c[b+24>>2];c[a+64>>2]=c[b+28>>2];c[a+68>>2]=c[b+32>>2];c[a+72>>2]=c[b+36>>2];m=+g[b+40>>2];i=e;return+m}function Qp(a){a=a|0;var b=0;b=i;Tp(a);i=b;return}function Rp(a){a=a|0;var b=0;b=i;Tp(a);gF(a);i=b;return}function Sp(b,d,e,f,g,h){b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0;j=i;if((h|0)<0){r=c[b+8>>2]|0;+ic[c[(c[r>>2]|0)+12>>2]&3](r,d,e,f,g,c[b+12>>2]|0,c[b+16>>2]|0,c[b+4>>2]|0,c[b+20>>2]|0,c[b+24>>2]|0);i=j;return}m=c[b+16>>2]|0;a:do if((m|0)>0){l=c[b+12>>2]|0;o=0;while(1){k=l+(o<<2)|0;p=c[k>>2]|0;n=c[(c[p+28>>2]|0)+208>>2]|0;if((n|0)>-1)p=n;else p=c[(c[p+32>>2]|0)+208>>2]|0;n=o+1|0;if((p|0)==(h|0))break a;if((n|0)<(m|0))o=n;else{o=n;k=0;break}}}else{o=0;k=0}while(0);if((o|0)<(m|0)){n=c[b+12>>2]|0;l=0;do{q=c[n+(o<<2)>>2]|0;p=c[(c[q+28>>2]|0)+208>>2]|0;if((p|0)<=-1)p=c[(c[q+32>>2]|0)+208>>2]|0;l=((p|0)==(h|0)&1)+l|0;o=o+1|0}while((o|0)<(m|0))}else l=0;h=c[b+4>>2]|0;if((c[h+72>>2]|0)<2){r=c[b+8>>2]|0;+ic[c[(c[r>>2]|0)+12>>2]&3](r,d,e,f,g,k,l,h,c[b+20>>2]|0,c[b+24>>2]|0);i=j;return}if((e|0)>0){o=c[b+32>>2]|0;p=c[b+36>>2]|0;h=0;while(1){m=d+(h<<2)|0;if((o|0)==(p|0)){n=(p|0)==0?1:p<<1;if((p|0)<(n|0)){if(!n)o=0;else{c[5004]=(c[5004]|0)+1;o=fF((n<<2|3)+16|0)|0;if(!o)o=0;else{c[(o+19&-16)+ -4>>2]=o;o=o+19&-16}p=c[b+32>>2]|0}if((p|0)>0){r=0;do{q=o+(r<<2)|0;if(q)c[q>>2]=c[(c[b+40>>2]|0)+(r<<2)>>2];r=r+1|0}while((r|0)!=(p|0))}q=c[b+40>>2]|0;if(q){if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[q+ -4>>2]|0);p=c[b+32>>2]|0}c[b+40>>2]=0}a[b+44>>0]=1;c[b+40>>2]=o;c[b+36>>2]=n;o=p}else{o=p;n=p}}else n=p;p=(c[b+40>>2]|0)+(o<<2)|0;if(p)c[p>>2]=c[m>>2];o=o+1|0;c[b+32>>2]=o;h=h+1|0;if((h|0)==(e|0))break;else p=n}}if((g|0)>0){m=c[b+52>>2]|0;n=c[b+56>>2]|0;d=0;while(1){e=f+(d<<2)|0;if((m|0)==(n|0)){h=(n|0)==0?1:n<<1;if((n|0)<(h|0)){if(!h)m=0;else{c[5004]=(c[5004]|0)+1;m=fF((h<<2|3)+16|0)|0;if(!m)m=0;else{c[(m+19&-16)+ -4>>2]=m;m=m+19&-16}n=c[b+52>>2]|0}if((n|0)>0){p=0;do{o=m+(p<<2)|0;if(o)c[o>>2]=c[(c[b+60>>2]|0)+(p<<2)>>2];p=p+1|0}while((p|0)!=(n|0))}o=c[b+60>>2]|0;if(o){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[o+ -4>>2]|0);n=c[b+52>>2]|0}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=m;c[b+56>>2]=h;m=n}else{m=n;h=n}}else h=n;n=(c[b+60>>2]|0)+(m<<2)|0;if(n)c[n>>2]=c[e>>2];m=m+1|0;c[b+52>>2]=m;d=d+1|0;if((d|0)==(g|0))break;else n=h}}if((l|0)>0){e=c[b+72>>2]|0;h=c[b+76>>2]|0;f=0;while(1){g=k+(f<<2)|0;if((e|0)==(h|0)){d=(h|0)==0?1:h<<1;if((h|0)<(d|0)){if(!d)e=0;else{c[5004]=(c[5004]|0)+1;e=fF((d<<2|3)+16|0)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}h=c[b+72>>2]|0}if((h|0)>0){m=0;do{n=e+(m<<2)|0;if(n)c[n>>2]=c[(c[b+80>>2]|0)+(m<<2)>>2];m=m+1|0}while((m|0)!=(h|0))}m=c[b+80>>2]|0;if(m){if(a[b+84>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0);h=c[b+72>>2]|0}c[b+80>>2]=0}a[b+84>>0]=1;c[b+80>>2]=e;c[b+76>>2]=d;e=h}else{e=h;d=h}}else d=h;h=(c[b+80>>2]|0)+(e<<2)|0;if(h)c[h>>2]=c[g>>2];e=e+1|0;c[b+72>>2]=e;f=f+1|0;if((f|0)==(l|0))break;else h=d}}else e=c[b+72>>2]|0;if(((c[b+52>>2]|0)+e|0)<=(c[(c[b+4>>2]|0)+72>>2]|0)){i=j;return}lp(b);i=j;return}function Tp(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=2240;e=c[b+80>>2]|0;if(e){if(a[b+84>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+80>>2]=0}a[b+84>>0]=1;c[b+80>>2]=0;c[b+72>>2]=0;c[b+76>>2]=0;e=c[b+60>>2]|0;if(e){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=0;c[b+52>>2]=0;c[b+56>>2]=0;e=c[b+40>>2]|0;if(!e){a[b+44>>0]=1;c[b+40>>2]=0;c[b+32>>2]=0;e=b+36|0;c[e>>2]=0;i=d;return}if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+40>>2]=0;a[b+44>>0]=1;c[b+40>>2]=0;c[b+32>>2]=0;e=b+36|0;c[e>>2]=0;i=d;return}function Up(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0;f=i;i=i+128|0;no(f+64|0,d,b+48|0);c[b+1064>>2]=c[f+64>>2];c[b+1068>>2]=c[f+68>>2];c[b+1072>>2]=c[f+72>>2];c[b+1076>>2]=c[f+76>>2];c[b+1080>>2]=c[f+80>>2];c[b+1084>>2]=c[f+84>>2];c[b+1088>>2]=c[f+88>>2];c[b+1092>>2]=c[f+92>>2];c[b+1096>>2]=c[f+96>>2];c[b+1100>>2]=c[f+100>>2];c[b+1104>>2]=c[f+104>>2];c[b+1108>>2]=c[f+108>>2];c[b+1112>>2]=c[f+112>>2];c[b+1116>>2]=c[f+116>>2];c[b+1120>>2]=c[f+120>>2];c[b+1124>>2]=c[f+124>>2];no(f,e,b+112|0);c[b+1128>>2]=c[f+0>>2];c[b+1132>>2]=c[f+4>>2];c[b+1136>>2]=c[f+8>>2];c[b+1140>>2]=c[f+12>>2];c[b+1144>>2]=c[f+16>>2];c[b+1148>>2]=c[f+20>>2];c[b+1152>>2]=c[f+24>>2];c[b+1156>>2]=c[f+28>>2];c[b+1160>>2]=c[f+32>>2];c[b+1164>>2]=c[f+36>>2];c[b+1168>>2]=c[f+40>>2];c[b+1172>>2]=c[f+44>>2];c[b+1176>>2]=c[f+48>>2];c[b+1180>>2]=c[f+52>>2];c[b+1184>>2]=c[f+56>>2];c[b+1188>>2]=c[f+60>>2];w=+g[b+1176>>2]- +g[b+1112>>2];x=+g[b+1180>>2]- +g[b+1116>>2];t=+g[b+1184>>2]- +g[b+1120>>2];r=+g[b+1084>>2];q=+g[b+1104>>2];m=+g[b+1088>>2];h=+g[b+1100>>2];s=+g[b+1096>>2];n=+g[b+1080>>2];o=+g[b+1064>>2];l=+g[b+1068>>2];k=+g[b+1072>>2];j=1.0/((r*q-m*h)*o+l*(m*s-q*n)+(h*n-r*s)*k);p=(h*n-r*s)*j;v=(r*q-m*h)*j*w+j*(h*k-q*l)*x+j*(m*l-r*k)*t;u=w*(m*s-q*n)*j+x*j*(q*o-s*k)+j*(n*k-m*o)*t;t=w*p+j*(s*l-h*o)*x+j*(r*o-n*l)*t;g[b+1256>>2]=v;g[b+1260>>2]=u;g[b+1264>>2]=t;g[b+1268>>2]=0.0;g[b+840>>2]=v;x=+g[b+680>>2];w=+g[b+696>>2];do if(!(x>w)){if(x>v){c[b+856>>2]=2;g[b+824>>2]=v-x;break}if(w<v){c[b+856>>2]=1;g[b+824>>2]=v-w;break}else{c[b+856>>2]=0;g[b+824>>2]=0.0;break}}else{c[b+856>>2]=0;g[b+824>>2]=0.0}while(0);g[b+844>>2]=u;w=+g[b+684>>2];v=+g[b+700>>2];do if(!(w>v)){if(w>u){c[b+860>>2]=2;g[b+828>>2]=u-w;break}if(v<u){c[b+860>>2]=1;g[b+828>>2]=u-v;break}else{c[b+860>>2]=0;g[b+828>>2]=0.0;break}}else{c[b+860>>2]=0;g[b+828>>2]=0.0}while(0);g[b+848>>2]=t;v=+g[b+688>>2];u=+g[b+704>>2];do if(!(v>u)){if(v>t){c[b+864>>2]=2;g[b+832>>2]=t-v;break}if(u<t){c[b+864>>2]=1;g[b+832>>2]=t-u;break}else{c[b+864>>2]=0;g[b+832>>2]=0.0;break}}else{c[b+864>>2]=0;g[b+832>>2]=0.0}while(0);B=+g[b+1128>>2];A=+g[b+1144>>2];w=+g[b+1160>>2];u=+g[b+1132>>2];v=+g[b+1148>>2];x=+g[b+1164>>2];C=(r*q-m*h)*j*u+j*(h*k-q*l)*v+j*(m*l-r*k)*x;t=(m*s-q*n)*j*u+j*(q*o-s*k)*v+j*(n*k-m*o)*x;z=B*p+j*(s*l-h*o)*A+j*(r*o-n*l)*w;y=p*+g[b+1136>>2]+j*(s*l-h*o)*+g[b+1152>>2]+j*(r*o-n*l)*+g[b+1168>>2];do if(z<1.0)if(z>-1.0){g[b+1192>>2]=+Y(+-(p*u+j*(s*l-h*o)*v+j*(r*o-n*l)*x),+y);C=z<-1.0?-1.0:z;g[b+1196>>2]=+W(+(C>1.0?1.0:C));g[b+1200>>2]=+Y(+-(B*(m*s-q*n)*j+A*j*(q*o-s*k)+j*(n*k-m*o)*w),+(B*(r*q-m*h)*j+A*j*(h*k-q*l)+j*(m*l-r*k)*w));break}else{g[b+1192>>2]=-+Y(+C,+t);g[b+1196>>2]=-1.5707963705062866;g[b+1200>>2]=0.0;break}else{g[b+1192>>2]=+Y(+C,+t);g[b+1196>>2]=1.5707963705062866;g[b+1200>>2]=0.0}while(0);g[b+1236>>2]=0.0;t=q*(B*q-w*k)-m*(A*k-B*m);u=k*(A*k-B*m)-q*(w*m-A*q);v=m*(w*m-A*q)-k*(B*q-w*k);g[b+1220>>2]=0.0;x=A*(A*k-B*m)-w*(B*q-w*k);y=w*(w*m-A*q)-B*(A*k-B*m);z=B*(B*q-w*k)-A*(w*m-A*q);g[b+1252>>2]=0.0;C=1.0/+Q(+(t*t+u*u+v*v));g[b+1208>>2]=t*C;g[b+1212>>2]=u*C;g[b+1216>>2]=v*C;C=1.0/+Q(+((w*m-A*q)*(w*m-A*q)+(B*q-w*k)*(B*q-w*k)+(A*k-B*m)*(A*k-B*m)));g[b+1224>>2]=(w*m-A*q)*C;g[b+1228>>2]=(B*q-w*k)*C;g[b+1232>>2]=(A*k-B*m)*C;C=1.0/+Q(+(x*x+y*y+z*z));g[b+1240>>2]=x*C;g[b+1244>>2]=y*C;g[b+1248>>2]=z*C;if(!(a[b+1301>>0]|0)){i=f;return}j=+g[(c[b+28>>2]|0)+344>>2];h=+g[(c[b+32>>2]|0)+344>>2];if(j<1.1920928955078125e-7)d=1;else d=h<1.1920928955078125e-7&1;a[b+1280>>0]=d;if(j+h>0.0){g[b+1272>>2]=h/(j+h);h=h/(j+h)}else{g[b+1272>>2]=.5;h=.5}g[b+1276>>2]=1.0-h;i=f;return}function Vp(a,b,d,e,f,h,j,k,l){a=a|0;b=b|0;d=d|0;e=+e;f=+f;h=+h;j=+j;k=+k;l=+l;var m=0,n=0;m=i;i=i+128|0;if(!b){i=m;return}n=c[a+28>>2]|0;g[m+80>>2]=+g[n+4>>2];g[m+84>>2]=+g[n+20>>2];g[m+88>>2]=+g[n+36>>2];g[m+92>>2]=0.0;g[m+96>>2]=+g[n+8>>2];g[m+100>>2]=+g[n+24>>2];g[m+104>>2]=+g[n+40>>2];g[m+108>>2]=0.0;g[m+112>>2]=+g[n+12>>2];g[m+116>>2]=+g[n+28>>2];g[m+120>>2]=+g[n+44>>2];g[m+124>>2]=0.0;a=c[a+32>>2]|0;g[m+32>>2]=+g[a+4>>2];g[m+36>>2]=+g[a+20>>2];g[m+40>>2]=+g[a+36>>2];g[m+44>>2]=0.0;g[m+48>>2]=+g[a+8>>2];g[m+52>>2]=+g[a+24>>2];g[m+56>>2]=+g[a+40>>2];g[m+60>>2]=0.0;g[m+64>>2]=+g[a+12>>2];g[m+68>>2]=+g[a+28>>2];g[m+72>>2]=+g[a+44>>2];g[m+76>>2]=0.0;f=f- +g[n+56>>2];h=h- +g[n+60>>2];g[m+16>>2]=e- +g[n+52>>2];g[m+20>>2]=f;g[m+24>>2]=h;g[m+28>>2]=0.0;k=k- +g[a+56>>2];l=l- +g[a+60>>2];g[m>>2]=j- +g[a+52>>2];g[m+4>>2]=k;g[m+8>>2]=l;g[m+12>>2]=0.0;Mo(b,m+80|0,m+32|0,m+16|0,m,d,n+396|0,+g[n+344>>2],a+396|0,+g[a+344>>2]);i=m;return}function Wp(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0;e=i;if(!b){i=e;return}L=c[a+28>>2]|0;u=+g[L+4>>2];t=+g[L+20>>2];s=+g[L+36>>2];q=+g[L+8>>2];p=+g[L+24>>2];o=+g[L+40>>2];m=+g[L+12>>2];k=+g[L+28>>2];h=+g[L+44>>2];a=c[a+32>>2]|0;K=+g[a+4>>2];J=+g[a+20>>2];I=+g[a+36>>2];G=+g[a+8>>2];F=+g[a+24>>2];E=+g[a+40>>2];C=+g[a+12>>2];A=+g[a+28>>2];y=+g[a+44>>2];c[b+0>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;l=+g[d>>2];j=+g[d+4>>2];f=+g[d+8>>2];g[b+16>>2]=u*l+t*j+s*f;g[b+20>>2]=q*l+p*j+o*f;g[b+24>>2]=m*l+k*j+h*f;g[b+28>>2]=0.0;B=-+g[d>>2];z=-+g[d+4>>2];x=-+g[d+8>>2];g[b+32>>2]=K*B+J*z+I*x;g[b+36>>2]=G*B+F*z+E*x;g[b+40>>2]=C*B+A*z+y*x;g[b+44>>2]=0.0;v=(u*l+t*j+s*f)*+g[L+396>>2];r=(q*l+p*j+o*f)*+g[L+400>>2];n=(m*l+k*j+h*f)*+g[L+404>>2];g[b+48>>2]=v;g[b+52>>2]=r;g[b+56>>2]=n;g[b+60>>2]=0.0;H=(K*B+J*z+I*x)*+g[a+396>>2];D=(G*B+F*z+E*x)*+g[a+400>>2];w=(C*B+A*z+y*x)*+g[a+404>>2];g[b+64>>2]=H;g[b+68>>2]=D;g[b+72>>2]=w;g[b+76>>2]=0.0;g[b+80>>2]=(K*B+J*z+I*x)*H+(G*B+F*z+E*x)*D+(C*B+A*z+y*x)*w+(v*(u*l+t*j+s*f)+r*(q*l+p*j+o*f)+n*(m*l+k*j+h*f));i=e;return}function Xp(b,d){b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0;f=i;h=+Yp(+g[b+(d<<2)+1192>>2],+g[b+(d<<6)+868>>2],+g[b+(d<<6)+872>>2]);g[b+(d<<6)+920>>2]=h;j=+g[b+(d<<6)+868>>2];k=+g[b+(d<<6)+872>>2];do if(!(j>k)){if(j>h){c[b+(d<<6)+924>>2]=1;g[b+(d<<6)+916>>2]=h-j;if(h-j>3.1415927410125732){g[b+(d<<6)+916>>2]=h-j+-6.2831854820251465;break}if(!(h-j<-3.1415927410125732))break;g[b+(d<<6)+916>>2]=h-j+6.2831854820251465;break}if(!(k<h)){c[b+(d<<6)+924>>2]=0;e=14;break}c[b+(d<<6)+924>>2]=2;g[b+(d<<6)+916>>2]=h-k;if(h-k>3.1415927410125732){g[b+(d<<6)+916>>2]=h-k+-6.2831854820251465;break}if(h-k<-3.1415927410125732)g[b+(d<<6)+916>>2]=h-k+6.2831854820251465}else{c[b+(d<<6)+924>>2]=0;e=14}while(0);if((e|0)==14?(a[b+(d<<6)+912>>0]|0)==0:0){d=0;i=f;return d|0}d=1;i=f;return d|0}function Yp(a,b,c){a=+a;b=+b;c=+c;var d=0;d=i;if(b>=c){b=a;i=d;return+b}if(a<b){b=+ab(+(b-a),6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;b=+P(+b);c=+ab(+(c-a),6.2831854820251465);if(!(c<-3.1415927410125732)){if(c>3.1415927410125732)c=c+-6.2831854820251465}else c=c+6.2831854820251465;if(b<+P(+c)){b=a;i=d;return+b}b=a+6.2831854820251465;i=d;return+b}if(!(a>c)){b=a;i=d;return+b}c=+ab(+(a-c),6.2831854820251465);if(!(c<-3.1415927410125732)){if(c>3.1415927410125732)c=c+-6.2831854820251465}else c=c+6.2831854820251465;c=+P(+c);b=+ab(+(a-b),6.2831854820251465);if(!(b<-3.1415927410125732)){if(b>3.1415927410125732)b=b+-6.2831854820251465}else b=b+6.2831854820251465;if(!(+P(+b)<c)){b=a;i=d;return+b}b=a+-6.2831854820251465;i=d;return+b}function Zp(b){b=b|0;var d=0.0,e=0.0,f=0.0,h=0,j=0,k=0,l=0,m=0.0,n=0.0;h=i;i=i+16|0;if(!(a[b+1308>>0]|0)){i=h;return}g[b+928>>2]=0.0;g[b+992>>2]=0.0;g[b+1056>>2]=0.0;c[b+712>>2]=0;c[b+716>>2]=0;c[b+720>>2]=0;c[b+724>>2]=0;Up(b,(c[b+28>>2]|0)+4|0,(c[b+32>>2]|0)+4|0);Lb[c[(c[b>>2]|0)+44>>2]&511](b);d=+g[b+1284>>2];e=+g[b+1288>>2];f=+g[b+1292>>2];if(+g[b+696>>2]>=+g[b+680>>2]){if(!(a[b+1300>>0]|0)){l=b+1160|0;k=b+1144|0;j=b+1128|0}else{l=b+1096|0;k=b+1080|0;j=b+1064|0}m=+g[l>>2];n=+g[k>>2];g[h>>2]=+g[j>>2];g[h+4>>2]=n;g[h+8>>2]=m;g[h+12>>2]=0.0;Vp(b,b+176|0,h,d,e,f,d,e,f)}if(+g[b+700>>2]>=+g[b+684>>2]){if(!(a[b+1300>>0]|0)){l=b+1164|0;k=b+1148|0;j=b+1132|0}else{l=b+1100|0;k=b+1084|0;j=b+1068|0}n=+g[l>>2];m=+g[k>>2];g[h>>2]=+g[j>>2];g[h+4>>2]=m;g[h+8>>2]=n;g[h+12>>2]=0.0;Vp(b,b+260|0,h,d,e,f,d,e,f)}if(+g[b+704>>2]>=+g[b+688>>2]){if(!(a[b+1300>>0]|0)){j=b+1168|0;l=b+1152|0;k=b+1136|0}else{j=b+1104|0;l=b+1088|0;k=b+1072|0}n=+g[j>>2];m=+g[l>>2];g[h>>2]=+g[k>>2];g[h+4>>2]=m;g[h+8>>2]=n;g[h+12>>2]=0.0;Vp(b,b+344|0,h,d,e,f,d,e,f)}if(Xp(b,0)|0){c[h+0>>2]=c[b+1208>>2];c[h+4>>2]=c[b+1212>>2];c[h+8>>2]=c[b+1216>>2];c[h+12>>2]=c[b+1220>>2];Wp(b,b+428|0,h)}if(Xp(b,1)|0){c[h+0>>2]=c[b+1224>>2];c[h+4>>2]=c[b+1228>>2];c[h+8>>2]=c[b+1232>>2];c[h+12>>2]=c[b+1236>>2];Wp(b,b+512|0,h)}if(!(Xp(b,2)|0)){i=h;return}c[h+0>>2]=c[b+1240>>2];c[h+4>>2]=c[b+1244>>2];c[h+8>>2]=c[b+1248>>2];c[h+12>>2]=c[b+1252>>2];Wp(b,b+596|0,h);i=h;return}function _p(b,d){b=b|0;d=d|0;var e=0,f=0,g=0;e=i;if(a[b+1308>>0]|0){c[d>>2]=0;c[d+4>>2]=0;i=e;return}Up(b,(c[b+28>>2]|0)+4|0,(c[b+32>>2]|0)+4|0);c[d>>2]=0;c[d+4>>2]=6;if((c[b+856>>2]|0)==0?(a[b+788>>0]|0)==0:0){g=0;f=6}else{c[d>>2]=1;c[d+4>>2]=5;g=1;f=5}if(!((c[b+860>>2]|0)==0?(a[b+789>>0]|0)==0:0)){g=g+1|0;c[d>>2]=g;f=f+ -1|0;c[d+4>>2]=f}if(!((c[b+864>>2]|0)==0?(a[b+790>>0]|0)==0:0)){c[d>>2]=g+1;c[d+4>>2]=f+ -1}if(Xp(b,0)|0){c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1}if(Xp(b,1)|0){c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1}if(!(Xp(b,2)|0)){i=e;return}c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1;i=e;return}function $p(b,d){b=b|0;d=d|0;var e=0,f=0,g=0;e=i;g=c[b+28>>2]|0;f=c[b+32>>2]|0;if(!(a[b+1301>>0]|0)){aq(b,d,bq(b,d,0,g+4|0,f+4|0,g+312|0,f+312|0,g+328|0,f+328|0)|0,g+4|0,f+4|0,g+312|0,f+312|0,g+328|0,f+328|0)|0;i=e;return}else{bq(b,d,aq(b,d,0,g+4|0,f+4|0,g+312|0,f+312|0,g+328|0,f+328|0)|0,g+4|0,f+4|0,g+312|0,f+312|0,g+328|0,f+328|0)|0;i=e;return}}function aq(b,d,e,f,h,j,k,l,m){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;var n=0,o=0,p=0,q=0;o=i;i=i+16|0;n=0;do{p=b+(n<<6)+868|0;if(!((c[b+(n<<6)+924>>2]|0)==0?(a[b+(n<<6)+912>>0]|0)==0:0)){q=b+(n<<4)+1208|0;c[o+0>>2]=c[q+0>>2];c[o+4>>2]=c[q+4>>2];c[o+8>>2]=c[q+8>>2];c[o+12>>2]=c[q+12>>2];q=c[b+1304>>2]>>(n*3|0)+9;if(!(q&1))g[b+(n<<6)+896>>2]=+g[c[d+32>>2]>>2];if(!(q&2))g[b+(n<<6)+904>>2]=+g[c[d+32>>2]>>2];if(!(q&4))g[b+(n<<6)+900>>2]=+g[d+4>>2];e=(cq(b,p,f,h,j,k,l,m,d,e,o,1,0)|0)+e|0}n=n+1|0}while((n|0)!=3);i=o;return e|0}function bq(b,d,e,f,h,j,k,l,m){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;var n=0,o=0,p=0,q=0;n=i;i=i+80|0;g[n+76>>2]=0.0;g[n+24>>2]=0.0;g[n+28>>2]=.10000000149011612;g[n+32>>2]=300.0;g[n+16>>2]=1.0;g[n+20>>2]=-1.0;g[n+44>>2]=0.0;g[n+48>>2]=.20000000298023224;g[n+52>>2]=0.0;g[n+56>>2]=0.0;g[n+36>>2]=1.0;g[n+40>>2]=.5;c[n+72>>2]=0;g[n+64>>2]=0.0;a[n+60>>0]=0;o=0;do{q=c[b+(o<<2)+856>>2]|0;p=a[b+o+788>>0]|0;do if(!((q|0)==0&p<<24>>24==0)){g[n+56>>2]=0.0;c[n+72>>2]=q;g[n+68>>2]=+g[b+(o<<2)+840>>2];g[n+64>>2]=+g[b+(o<<2)+824>>2];g[n+36>>2]=+g[b+732>>2];a[n+60>>0]=p;g[n+20>>2]=+g[b+(o<<2)+696>>2];g[n+40>>2]=+g[b+728>>2];g[n+16>>2]=+g[b+(o<<2)+680>>2];g[n+32>>2]=0.0;g[n+28>>2]=+g[b+(o<<2)+808>>2];g[n+24>>2]=+g[b+(o<<2)+792>>2];g[n>>2]=+g[b+(o<<2)+1064>>2];g[n+4>>2]=+g[b+(o<<2)+1080>>2];g[n+8>>2]=+g[b+(o<<2)+1096>>2];g[n+12>>2]=0.0;p=c[b+1304>>2]>>o*3;if(!(p&1))q=c[d+32>>2]|0;else q=b+(o<<2)+740|0;g[n+44>>2]=+g[q>>2];if(!(p&2))q=c[d+32>>2]|0;else q=b+(o<<2)+772|0;g[n+52>>2]=+g[q>>2];if(!(p&4))p=d+4|0;else p=b+(o<<2)+756|0;g[n+48>>2]=+g[p>>2];if(!(a[b+1301>>0]|0)){e=(cq(b,n+16|0,f,h,j,k,l,m,d,e,n,0,0)|0)+e|0;break}q=o+1|0;if(!(c[b+(((q|0)==3?0:q)<<6)+924>>2]|0))p=1;else p=(c[b+(((o+2|0)%3|0)<<6)+924>>2]|0)==0&1;e=(cq(b,n+16|0,f,h,j,k,l,m,d,e,n,0,p)|0)+e|0}while(0);o=o+1|0}while((o|0)!=3);i=n;return e|0}function cq(b,d,e,f,h,j,k,l,m,n,o,p,q){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;n=n|0;o=o|0;p=p|0;q=q|0;var r=0,s=0,t=0,u=0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0,E=0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0;r=i;s=aa(c[m+24>>2]|0,n)|0;u=(a[d+44>>0]|0)==0;n=c[d+56>>2]|0;if(u&(n|0)==0){f=0;i=r;return f|0}E=c[((p|0)!=0?m+12|0:m+8|0)>>2]|0;D=c[((p|0)!=0?m+20|0:m+16|0)>>2]|0;g[E+(s<<2)>>2]=+g[o>>2];g[E+(s+1<<2)>>2]=+g[o+4>>2];g[E+(s+2<<2)>>2]=+g[o+8>>2];g[D+(s<<2)>>2]=-+g[o>>2];g[D+(s+1<<2)>>2]=-+g[o+4>>2];g[D+(s+2<<2)>>2]=-+g[o+8>>2];do if(!p){v=+g[b+1176>>2];if(!(a[b+1301>>0]|0)){y=v- +g[e+48>>2];B=+g[b+1180>>2]- +g[e+52>>2];C=+g[b+1184>>2]- +g[e+56>>2];A=+g[o+8>>2];x=+g[o+4>>2];z=+g[o>>2];E=c[m+12>>2]|0;g[E+(s<<2)>>2]=B*A-C*x;g[E+(s+1<<2)>>2]=C*z-y*A;g[E+(s+2<<2)>>2]=y*x-B*z;z=+g[b+1176>>2]- +g[f+48>>2];B=+g[b+1180>>2]- +g[f+52>>2];x=+g[b+1184>>2]- +g[f+56>>2];y=+g[o+8>>2];A=+g[o+4>>2];C=+g[o>>2];E=c[m+20>>2]|0;g[E+(s<<2)>>2]=-(B*y-x*A);g[E+(s+1<<2)>>2]=-(x*C-z*y);g[E+(s+2<<2)>>2]=-(z*A-B*C);break}K=v- +g[f+48>>2];I=+g[b+1180>>2]- +g[f+52>>2];G=+g[b+1184>>2]- +g[f+56>>2];J=+g[o>>2];H=+g[o+4>>2];F=+g[o+8>>2];M=+g[b+1112>>2]- +g[e+48>>2];z=+g[b+1116>>2]- +g[e+52>>2];v=+g[b+1120>>2]- +g[e+56>>2];A=+g[d+52>>2]- +g[d+48>>2];L=J*(J*M+H*z+F*v)+J*A-J*(K*J+I*H+G*F);B=H*(J*M+H*z+F*v)+H*A-H*(K*J+I*H+G*F);A=F*(J*M+H*z+F*v)+F*A-F*(K*J+I*H+G*F);w=+g[b+1272>>2];C=+g[b+1276>>2];y=F*(z-H*(J*M+H*z+F*v)+w*B)-H*(v-F*(J*M+H*z+F*v)+w*A);x=J*(v-F*(J*M+H*z+F*v)+w*A)-F*(M-J*(J*M+H*z+F*v)+w*L);v=H*(M-J*(J*M+H*z+F*v)+w*L)-J*(z-H*(J*M+H*z+F*v)+w*B);z=F*(I-H*(K*J+I*H+G*F)-C*B)-H*(G-F*(K*J+I*H+G*F)-C*A);A=J*(G-F*(K*J+I*H+G*F)-C*A)-F*(K-J*(K*J+I*H+G*F)-C*L);B=H*(K-J*(K*J+I*H+G*F)-C*L)-J*(I-H*(K*J+I*H+G*F)-C*B);if((a[b+1280>>0]|0)!=0&(q|0)==0){z=C*z;A=C*A;B=C*B;y=w*y;x=w*x;v=w*v}E=c[m+12>>2]|0;g[E+(s<<2)>>2]=y;g[E+(s+1<<2)>>2]=x;g[E+(s+2<<2)>>2]=v;E=c[m+20>>2]|0;g[E+(s<<2)>>2]=-z;g[E+(s+1<<2)>>2]=-A;g[E+(s+2<<2)>>2]=-B}while(0);if((n|0)!=0?+g[d>>2]==+g[d+4>>2]:0){u=c[m+28>>2]|0;g[u+(s<<2)>>2]=0.0}else t=11;do if((t|0)==11){t=c[m+28>>2]|0;g[t+(s<<2)>>2]=0.0;if(!u){g[(c[m+32>>2]|0)+(s<<2)>>2]=+g[d+28>>2];if(n){u=t;break}v=+g[d+8>>2];if(p)z=v;else z=-v;x=+g[d+52>>2];y=+g[d>>2];w=+g[d+4>>2];A=+g[m>>2]*+g[d+32>>2];do if(!(y>w))if(!(y==w)){z=z/A;if(z<0.0){if(x>=y?y-z>x:0){w=(y-x)/z;break}w=x<y?0.0:1.0;break}if(z>0.0){if(x<=w?w-z<x:0){w=(w-x)/z;break}w=x>w?0.0:1.0}else w=0.0}else w=0.0;else w=1.0;while(0);g[t+(s<<2)>>2]=w*v+ +g[t+(s<<2)>>2];g[(c[m+36>>2]|0)+(s<<2)>>2]=-+g[d+12>>2];g[(c[m+40>>2]|0)+(s<<2)>>2]=+g[d+12>>2]}if(n)u=t;else{E=1;i=r;return E|0}}while(0);v=+g[m>>2]*+g[d+32>>2]*+g[d+48>>2];t=u+(s<<2)|0;w=+g[t>>2];if(p)v=w-v;else v=v+w;g[t>>2]=v;g[(c[m+32>>2]|0)+(s<<2)>>2]=+g[d+36>>2];if(+g[d>>2]==+g[d+4>>2]){g[(c[m+36>>2]|0)+(s<<2)>>2]=-3.4028234663852886e+38;g[(c[m+40>>2]|0)+(s<<2)>>2]=3.4028234663852886e+38;E=1;i=r;return E|0}u=(c[m+36>>2]|0)+(s<<2)|0;if((n|0)==1){g[u>>2]=0.0;g[(c[m+40>>2]|0)+(s<<2)>>2]=3.4028234663852886e+38}else{g[u>>2]=-3.4028234663852886e+38;g[(c[m+40>>2]|0)+(s<<2)>>2]=0.0}v=+g[d+40>>2];if(!(v>0.0)){E=1;i=r;return E|0}if(p){L=+g[o>>2];M=+g[o+4>>2];w=+g[o+8>>2];w=+g[k>>2]*L+ +g[k+4>>2]*M+ +g[k+8>>2]*w-(L*+g[l>>2]+M*+g[l+4>>2]+w*+g[l+8>>2])}else{L=+g[o>>2];M=+g[o+4>>2];w=+g[o+8>>2];w=+g[h>>2]*L+ +g[h+4>>2]*M+ +g[h+8>>2]*w-(L*+g[j>>2]+M*+g[j+4>>2]+w*+g[j+8>>2])}if((n|0)==1){if(!(w<0.0)){E=1;i=r;return E|0}v=-(w*v);if(!(+g[t>>2]<v)){E=1;i=r;return E|0}g[t>>2]=v;E=1;i=r;return E|0}else{if(!(w>0.0)){E=1;i=r;return E|0}v=-(w*v);if(!(+g[t>>2]>v)){E=1;i=r;return E|0}g[t>>2]=v;E=1;i=r;return E|0}return 0}function dq(a){a=a|0;var b=0.0,d=0.0,e=0.0,f=0.0;d=+g[(c[a+28>>2]|0)+344>>2];b=+g[(c[a+32>>2]|0)+344>>2];if(b==0.0)b=1.0;else b=d/(d+b);f=1.0-b;e=b*+g[a+1116>>2]+f*+g[a+1180>>2];d=b*+g[a+1120>>2]+f*+g[a+1184>>2];g[a+1284>>2]=b*+g[a+1112>>2]+f*+g[a+1176>>2];g[a+1288>>2]=e;g[a+1292>>2]=d;g[a+1296>>2]=0.0;return}function eq(a,b,d,e){a=a|0;b=b|0;d=+d;e=e|0;var f=0;f=i;if(e>>>0<3)if((b|0)==4){g[a+(e<<2)+772>>2]=d;c[a+1304>>2]=c[a+1304>>2]|2<<e*3;i=f;return}else if((b|0)==2){g[a+(e<<2)+756>>2]=d;c[a+1304>>2]=c[a+1304>>2]|4<<e*3;i=f;return}else if((b|0)==3){g[a+(e<<2)+740>>2]=d;c[a+1304>>2]=c[a+1304>>2]|1<<e*3;i=f;return}else{i=f;return}if((e+ -3|0)>>>0>=3){i=f;return}if((b|0)==4){g[a+(e+ -3<<6)+904>>2]=d;c[a+1304>>2]=c[a+1304>>2]|2<<e*3;i=f;return}else if((b|0)==2){g[a+(e+ -3<<6)+900>>2]=d;c[a+1304>>2]=c[a+1304>>2]|4<<e*3;i=f;return}else if((b|0)==3){g[a+(e+ -3<<6)+896>>2]=d;c[a+1304>>2]=c[a+1304>>2]|1<<e*3;i=f;return}else{i=f;return}}function fq(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0;d=i;do if(c>>>0<3)if((b|0)==4){e=+g[a+(c<<2)+772>>2];break}else if((b|0)==2){e=+g[a+(c<<2)+756>>2];break}else if((b|0)==3){e=+g[a+(c<<2)+740>>2];break}else{e=0.0;break}else if((c+ -3|0)>>>0<3)if((b|0)==4){e=+g[a+(c+ -3<<6)+904>>2];break}else if((b|0)==2){e=+g[a+(c+ -3<<6)+900>>2];break}else if((b|0)==3){e=+g[a+(c+ -3<<6)+896>>2];break}else{e=0.0;break}else e=0.0;while(0);i=d;return+e}function gq(a){a=a|0;return}function hq(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function iq(a){a=a|0;return 252}function jq(a,b,e){a=a|0;b=b|0;e=e|0;var f=0;f=i;Zr(a,b,e)|0;g[b+52>>2]=+g[a+48>>2];g[b+56>>2]=+g[a+52>>2];g[b+60>>2]=+g[a+56>>2];g[b+64>>2]=+g[a+60>>2];g[b+68>>2]=+g[a+64>>2];g[b+72>>2]=+g[a+68>>2];g[b+76>>2]=+g[a+72>>2];g[b+80>>2]=+g[a+76>>2];g[b+84>>2]=+g[a+80>>2];g[b+88>>2]=+g[a+84>>2];g[b+92>>2]=+g[a+88>>2];g[b+96>>2]=+g[a+92>>2];g[b+100>>2]=+g[a+96>>2];g[b+104>>2]=+g[a+100>>2];g[b+108>>2]=+g[a+104>>2];g[b+112>>2]=+g[a+108>>2];g[b+116>>2]=+g[a+112>>2];g[b+120>>2]=+g[a+116>>2];g[b+124>>2]=+g[a+120>>2];g[b+128>>2]=+g[a+124>>2];g[b+132>>2]=+g[a+128>>2];g[b+136>>2]=+g[a+132>>2];g[b+140>>2]=+g[a+136>>2];g[b+144>>2]=+g[a+140>>2];g[b+148>>2]=+g[a+144>>2];g[b+152>>2]=+g[a+148>>2];g[b+156>>2]=+g[a+152>>2];g[b+160>>2]=+g[a+156>>2];g[b+164>>2]=+g[a+160>>2];g[b+168>>2]=+g[a+164>>2];g[b+172>>2]=+g[a+168>>2];g[b+176>>2]=+g[a+172>>2];g[b+228>>2]=+g[a+868>>2];g[b+212>>2]=+g[a+872>>2];g[b+196>>2]=+g[a+680>>2];g[b+180>>2]=+g[a+696>>2];g[b+232>>2]=+g[a+932>>2];g[b+216>>2]=+g[a+936>>2];g[b+200>>2]=+g[a+684>>2];g[b+184>>2]=+g[a+700>>2];g[b+236>>2]=+g[a+996>>2];g[b+220>>2]=+g[a+1e3>>2];g[b+204>>2]=+g[a+688>>2];g[b+188>>2]=+g[a+704>>2];c[b+244>>2]=d[a+1300>>0];c[b+248>>2]=d[a+1301>>0];i=f;return 2464}function kq(b,d,e,f,h,j,k,l){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;var m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0;m=i;c[b+4>>2]=4;c[b+8>>2]=-1;c[b+12>>2]=-1;g[b+16>>2]=3.4028234663852886e+38;a[b+20>>0]=1;a[b+21>>0]=0;c[b+24>>2]=-1;c[b+28>>2]=d;c[b+32>>2]=e;g[b+36>>2]=0.0;g[b+40>>2]=.30000001192092896;c[b+44>>2]=0;c[b>>2]=2504;g[b+688>>2]=0.0;g[b+692>>2]=-1.0;g[b+696>>2]=.8999999761581421;g[b+700>>2]=.30000001192092896;g[b+704>>2]=1.0;g[b+708>>2]=0.0;g[b+712>>2]=0.0;a[b+716>>0]=0;a[b+736>>0]=0;a[b+737>>0]=0;a[b+738>>0]=0;a[b+739>>0]=1;a[b+740>>0]=l&1;c[b+748>>2]=0;c[b+600>>2]=c[f+0>>2];c[b+604>>2]=c[f+4>>2];c[b+608>>2]=c[f+8>>2];c[b+612>>2]=c[f+12>>2];u=+g[d+4>>2];w=+g[d+20>>2];t=+g[d+36>>2];p=+g[j>>2];x=+g[j+4>>2];v=+g[j+8>>2];do if(!(u*p+w*x+t*v>=.9999998807907104))if(!(u*p+w*x+t*v<=-.9999998807907104)){s=u*v-t*p;o=x*(t*x-w*v)-p*(u*v-t*p);r=w*p-u*x;n=v*(u*v-t*p)-x*(w*p-u*x);q=t*x-w*v;p=p*(w*p-u*x)-v*(t*x-w*v);break}else{s=+g[d+24>>2];o=+g[d+44>>2];r=+g[d+40>>2];n=+g[d+12>>2];q=+g[d+8>>2];p=+g[d+28>>2];break}else{s=+g[d+24>>2];o=-+g[d+44>>2];r=+g[d+40>>2];n=-+g[d+12>>2];q=+g[d+8>>2];p=-+g[d+28>>2]}while(0);g[b+552>>2]=n;g[b+556>>2]=q;g[b+560>>2]=+g[j>>2];g[b+564>>2]=0.0;g[b+568>>2]=p;g[b+572>>2]=s;g[b+576>>2]=+g[j+4>>2];g[b+580>>2]=0.0;g[b+584>>2]=o;g[b+588>>2]=r;g[b+592>>2]=+g[j+8>>2];g[b+596>>2]=0.0;t=+g[j+4>>2];s=+g[k+8>>2];u=+g[j+8>>2];q=+g[k+4>>2];r=+g[k>>2];x=+g[j>>2];do if(s*u+(t*q+r*x)<-.9999998807907104)if(+P(+u)>.7071067690849304){x=1.0/+Q(+(t*t+u*u));w=0.0;v=-(u*x);x=t*x;t=0.0;break}else{u=1.0/+Q(+(t*t+x*x));w=0.0;v=x*u;x=0.0;t=-(t*u);break}else{y=+Q(+((s*u+(t*q+r*x)+1.0)*2.0));w=y*.5;v=(u*r-s*x)*(1.0/y);x=(q*x-t*r)*(1.0/y);t=(t*s-u*q)*(1.0/y)}while(0);B=n*w+o*v-p*x;z=p*w+n*x-o*t;A=o*w+p*t-n*v;p=-(n*t)-p*v-o*x;u=-t;t=-v;v=-x;y=z*v+(w*B+p*u)-A*t;x=A*u+(w*z+p*t)-B*v;w=B*t+(w*A+p*v)-z*u;c[b+664>>2]=c[h+0>>2];c[b+668>>2]=c[h+4>>2];c[b+672>>2]=c[h+8>>2];c[b+676>>2]=c[h+12>>2];g[b+616>>2]=y;g[b+620>>2]=q*w-s*x;g[b+624>>2]=+g[k>>2];g[b+628>>2]=0.0;g[b+632>>2]=x;g[b+636>>2]=s*y-r*w;g[b+640>>2]=+g[k+4>>2];g[b+644>>2]=0.0;g[b+648>>2]=w;g[b+652>>2]=r*x-q*y;g[b+656>>2]=+g[k+8>>2];g[b+660>>2]=0.0;g[b+732>>2]=l?-1.0:1.0;i=m;return}function lq(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;h=i;Yr(b,4,d);c[b>>2]=2504;c[b+552>>2]=c[e+0>>2];c[b+556>>2]=c[e+4>>2];c[b+560>>2]=c[e+8>>2];c[b+564>>2]=c[e+12>>2];c[b+568>>2]=c[e+16>>2];c[b+572>>2]=c[e+20>>2];c[b+576>>2]=c[e+24>>2];c[b+580>>2]=c[e+28>>2];c[b+584>>2]=c[e+32>>2];c[b+588>>2]=c[e+36>>2];c[b+592>>2]=c[e+40>>2];c[b+596>>2]=c[e+44>>2];c[b+600>>2]=c[e+48>>2];c[b+604>>2]=c[e+52>>2];c[b+608>>2]=c[e+56>>2];c[b+612>>2]=c[e+60>>2];c[b+616>>2]=c[e+0>>2];c[b+620>>2]=c[e+4>>2];c[b+624>>2]=c[e+8>>2];c[b+628>>2]=c[e+12>>2];c[b+632>>2]=c[e+16>>2];c[b+636>>2]=c[e+20>>2];c[b+640>>2]=c[e+24>>2];c[b+644>>2]=c[e+28>>2];c[b+648>>2]=c[e+32>>2];c[b+652>>2]=c[e+36>>2];c[b+656>>2]=c[e+40>>2];c[b+660>>2]=c[e+44>>2];c[b+664>>2]=c[e+48>>2];c[b+668>>2]=c[e+52>>2];c[b+672>>2]=c[e+56>>2];c[b+676>>2]=c[e+60>>2];g[b+688>>2]=0.0;g[b+692>>2]=-1.0;g[b+696>>2]=.8999999761581421;g[b+700>>2]=.30000001192092896;g[b+704>>2]=1.0;g[b+708>>2]=0.0;g[b+712>>2]=0.0;a[b+716>>0]=0;a[b+736>>0]=0;a[b+737>>0]=0;a[b+738>>0]=0;a[b+739>>0]=1;a[b+740>>0]=f&1;c[b+748>>2]=0;d=c[b+28>>2]|0;n=+g[b+600>>2];m=+g[b+604>>2];l=+g[b+608>>2];k=n*+g[d+20>>2]+m*+g[d+24>>2]+l*+g[d+28>>2]+ +g[d+56>>2];j=n*+g[d+36>>2]+m*+g[d+40>>2]+l*+g[d+44>>2]+ +g[d+60>>2];g[b+664>>2]=n*+g[d+4>>2]+m*+g[d+8>>2]+l*+g[d+12>>2]+ +g[d+52>>2];g[b+668>>2]=k;g[b+672>>2]=j;g[b+676>>2]=0.0;g[b+732>>2]=f?-1.0:1.0;i=h;return}function mq(b){b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0,M=0,N=0.0,O=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0;d=i;i=i+176|0;if(!(a[b+738>>0]|0)){i=d;return}g[b+36>>2]=0.0;g[b+744>>2]=0.0;a:do if(!(a[b+736>>0]|0)){L=c[b+28>>2]|0;A=+g[b+600>>2];z=+g[b+604>>2];j=+g[b+608>>2];h=A*+g[L+20>>2]+z*+g[L+24>>2]+j*+g[L+28>>2]+ +g[L+56>>2];y=c[b+32>>2]|0;l=+g[b+664>>2];m=+g[y+4>>2];n=+g[b+668>>2];o=+g[y+8>>2];p=+g[b+672>>2];q=+g[y+12>>2];s=+g[y+20>>2];t=+g[y+24>>2];u=+g[y+28>>2];e=+g[y+36>>2];x=+g[y+40>>2];w=+g[y+44>>2];r=+g[y+52>>2];v=+g[y+56>>2];f=+g[y+60>>2];B=l*s+n*t+p*u+v-h;k=A*+g[L+4>>2]+z*+g[L+8>>2]+j*+g[L+12>>2]+ +g[L+52>>2];j=A*+g[L+36>>2]+z*+g[L+40>>2]+j*+g[L+44>>2]+ +g[L+60>>2];z=l*m+n*o+p*q+r-k;A=l*e+n*x+p*w+f-j;if(z*z+B*B+A*A>1.1920928955078125e-7){K=1.0/+Q(+(z*z+B*B+A*A));g[d+128>>2]=z*K;g[d+132>>2]=B*K;g[d+136>>2]=A*K;g[d+140>>2]=0.0;A=A*K;B=B*K;z=z*K}else{g[d+128>>2]=1.0;g[d+132>>2]=0.0;g[d+136>>2]=0.0;g[d+140>>2]=0.0;A=0.0;B=0.0;z=1.0}if(+P(+A)>.7071067690849304){H=A*A+B*B;I=1.0/+Q(+H);g[d+144>>2]=0.0;K=-(I*A);g[d+148>>2]=K;J=I*B;g[d+152>>2]=J;g[d+160>>2]=H*I;g[d+164>>2]=-(z*J);g[d+168>>2]=z*K}else{J=z*z+B*B;K=1.0/+Q(+J);I=-(B*K);g[d+144>>2]=I;H=K*z;g[d+148>>2]=H;g[d+152>>2]=0.0;g[d+160>>2]=-(A*H);g[d+164>>2]=A*I;g[d+168>>2]=J*K}C=m;z=s;A=e;B=o;D=t;E=x;F=q;K=u;G=w;J=r;I=v;H=f;L=0;while(1){M=c[b+28>>2]|0;g[d+80>>2]=+g[M+4>>2];g[d+84>>2]=+g[M+20>>2];g[d+88>>2]=+g[M+36>>2];g[d+92>>2]=0.0;g[d+96>>2]=+g[M+8>>2];g[d+100>>2]=+g[M+24>>2];g[d+104>>2]=+g[M+40>>2];g[d+108>>2]=0.0;g[d+112>>2]=+g[M+12>>2];g[d+116>>2]=+g[M+28>>2];g[d+120>>2]=+g[M+44>>2];g[d+124>>2]=0.0;g[d+32>>2]=C;g[d+36>>2]=z;g[d+40>>2]=A;g[d+44>>2]=0.0;g[d+48>>2]=B;g[d+52>>2]=D;g[d+56>>2]=E;g[d+60>>2]=0.0;g[d+64>>2]=F;g[d+68>>2]=K;g[d+72>>2]=G;g[d+76>>2]=0.0;G=h- +g[M+56>>2];K=j- +g[M+60>>2];g[d+16>>2]=k- +g[M+52>>2];g[d+20>>2]=G;g[d+24>>2]=K;g[d+28>>2]=0.0;g[d>>2]=l*m+n*o+p*q+r-J;g[d+4>>2]=l*s+n*t+p*u+v-I;g[d+8>>2]=l*e+n*x+p*w+f-H;g[d+12>>2]=0.0;Mo(b+(L*84|0)+48|0,d+80|0,d+32|0,d+16|0,d,d+128+(L<<4)|0,M+396|0,+g[M+344>>2],y+396|0,+g[y+344>>2]);L=L+1|0;if((L|0)==3)break a;y=c[b+32>>2]|0;C=+g[y+4>>2];z=+g[y+20>>2];A=+g[y+36>>2];B=+g[y+8>>2];D=+g[y+24>>2];E=+g[y+40>>2];F=+g[y+12>>2];K=+g[y+28>>2];G=+g[y+44>>2];J=+g[y+52>>2];I=+g[y+56>>2];H=+g[y+60>>2]}}while(0);h=+g[b+560>>2];f=+g[b+576>>2];e=+g[b+592>>2];if(+P(+e)>.7071067690849304){j=1.0/+Q(+(f*f+e*e));o=0.0;n=-(e*j);m=f*j;l=(f*f+e*e)*j;k=-(h*f*j);j=h*-(e*j)}else{j=1.0/+Q(+(h*h+f*f));o=-(f*j);n=h*j;m=0.0;l=-(e*h*j);k=e*-(f*j);j=(h*h+f*f)*j}L=c[b+28>>2]|0;p=+g[L+4>>2];F=+g[L+8>>2];A=+g[L+12>>2];s=o*p+n*F+m*A;x=+g[L+20>>2];t=+g[L+24>>2];C=+g[L+28>>2];u=o*x+n*t+m*C;I=+g[L+36>>2];G=+g[L+40>>2];E=+g[L+44>>2];v=o*I+n*G+m*E;J=l*p+k*F+j*A;m=l*x+k*t+j*C;k=l*I+k*G+j*E;M=c[b+32>>2]|0;B=+g[M+4>>2];D=+g[M+20>>2];N=+g[M+36>>2];S=+g[M+8>>2];T=+g[M+24>>2];V=+g[M+40>>2];X=+g[M+12>>2];j=+g[M+28>>2];H=+g[M+44>>2];c[b+300>>2]=0;c[b+304>>2]=0;c[b+308>>2]=0;c[b+312>>2]=0;g[b+316>>2]=p*s+x*u+I*v;g[b+320>>2]=F*s+t*u+G*v;g[b+324>>2]=A*s+C*u+E*v;g[b+328>>2]=0.0;g[b+332>>2]=B*-s+D*-u+N*-v;g[b+336>>2]=S*-s+T*-u+V*-v;g[b+340>>2]=X*-s+j*-u+H*-v;g[b+344>>2]=0.0;o=(p*s+x*u+I*v)*+g[L+396>>2];K=(F*s+t*u+G*v)*+g[L+400>>2];q=(A*s+C*u+E*v)*+g[L+404>>2];g[b+348>>2]=o;g[b+352>>2]=K;g[b+356>>2]=q;g[b+360>>2]=0.0;R=(B*-s+D*-u+N*-v)*+g[M+396>>2];W=(S*-s+T*-u+V*-v)*+g[M+400>>2];l=(X*-s+j*-u+H*-v)*+g[M+404>>2];g[b+364>>2]=R;g[b+368>>2]=W;g[b+372>>2]=l;g[b+376>>2]=0.0;g[b+380>>2]=(B*-s+D*-u+N*-v)*R+(S*-s+T*-u+V*-v)*W+(X*-s+j*-u+H*-v)*l+(o*(p*s+x*u+I*v)+K*(F*s+t*u+G*v)+q*(A*s+C*u+E*v));M=c[b+28>>2]|0;v=+g[M+4>>2];u=+g[M+20>>2];s=+g[M+36>>2];q=+g[M+8>>2];K=+g[M+24>>2];o=+g[M+40>>2];l=+g[M+12>>2];H=+g[M+28>>2];j=+g[M+44>>2];L=c[b+32>>2]|0;X=+g[L+4>>2];W=+g[L+20>>2];V=+g[L+36>>2];T=+g[L+8>>2];S=+g[L+24>>2];R=+g[L+40>>2];N=+g[L+12>>2];D=+g[L+28>>2];B=+g[L+44>>2];c[b+384>>2]=0;c[b+388>>2]=0;c[b+392>>2]=0;c[b+396>>2]=0;g[b+400>>2]=J*v+m*u+k*s;g[b+404>>2]=J*q+m*K+k*o;g[b+408>>2]=J*l+m*H+k*j;g[b+412>>2]=0.0;g[b+416>>2]=X*-J+W*-m+V*-k;g[b+420>>2]=T*-J+S*-m+R*-k;g[b+424>>2]=N*-J+D*-m+B*-k;g[b+428>>2]=0.0;w=(J*v+m*u+k*s)*+g[M+396>>2];r=(J*q+m*K+k*o)*+g[M+400>>2];n=(J*l+m*H+k*j)*+g[M+404>>2];g[b+432>>2]=w;g[b+436>>2]=r;g[b+440>>2]=n;g[b+444>>2]=0.0;U=(X*-J+W*-m+V*-k)*+g[L+396>>2];O=(T*-J+S*-m+R*-k)*+g[L+400>>2];z=(N*-J+D*-m+B*-k)*+g[L+404>>2];g[b+448>>2]=U;g[b+452>>2]=O;g[b+456>>2]=z;g[b+460>>2]=0.0;g[b+464>>2]=(X*-J+W*-m+V*-k)*U+(T*-J+S*-m+R*-k)*O+(N*-J+D*-m+B*-k)*z+(w*(J*v+m*u+k*s)+r*(J*q+m*K+k*o)+n*(J*l+m*H+k*j));L=c[b+28>>2]|0;j=+g[L+4>>2];k=+g[L+20>>2];H=+g[L+36>>2];l=+g[L+8>>2];m=+g[L+24>>2];J=+g[L+40>>2];n=+g[L+12>>2];o=+g[L+28>>2];K=+g[L+44>>2];M=c[b+32>>2]|0;q=+g[M+4>>2];r=+g[M+20>>2];s=+g[M+36>>2];u=+g[M+8>>2];v=+g[M+24>>2];w=+g[M+40>>2];z=+g[M+12>>2];B=+g[M+28>>2];D=+g[M+44>>2];c[b+468>>2]=0;c[b+472>>2]=0;c[b+476>>2]=0;c[b+480>>2]=0;H=(p*h+F*f+A*e)*j+(x*h+t*f+C*e)*k+(I*h+G*f+E*e)*H;J=(p*h+F*f+A*e)*l+(x*h+t*f+C*e)*m+(I*h+G*f+E*e)*J;K=(p*h+F*f+A*e)*n+(x*h+t*f+C*e)*o+(I*h+G*f+E*e)*K;g[b+484>>2]=H;g[b+488>>2]=J;g[b+492>>2]=K;g[b+496>>2]=0.0;A=-(p*h+F*f+A*e);C=-(x*h+t*f+C*e);E=-(I*h+G*f+E*e);g[b+500>>2]=q*A+r*C+s*E;g[b+504>>2]=u*A+v*C+w*E;g[b+508>>2]=z*A+B*C+D*E;g[b+512>>2]=0.0;G=H*+g[L+396>>2];I=J*+g[L+400>>2];e=K*+g[L+404>>2];g[b+516>>2]=G;g[b+520>>2]=I;g[b+524>>2]=e;g[b+528>>2]=0.0;t=(q*A+r*C+s*E)*+g[M+396>>2];x=(u*A+v*C+w*E)*+g[M+400>>2];F=(z*A+B*C+D*E)*+g[M+404>>2];g[b+532>>2]=t;g[b+536>>2]=x;g[b+540>>2]=F;g[b+544>>2]=0.0;g[b+548>>2]=(q*A+r*C+s*E)*t+(u*A+v*C+w*E)*x+(z*A+B*C+D*E)*F+(G*H+I*J+e*K);g[b+724>>2]=0.0;e=+pq(b,(c[b+28>>2]|0)+4|0,(c[b+32>>2]|0)+4|0);g[b+728>>2]=e;g[b+708>>2]=0.0;g[b+712>>2]=0.0;a[b+716>>0]=0;do if(+g[b+692>>2]>=0.0){e=+ab(+(e- +g[b+688>>2]),6.2831854820251465);if(!(e<-3.1415927410125732)){if(e>3.1415927410125732)e=e+-6.2831854820251465}else e=e+6.2831854820251465;f=+g[b+692>>2];if(e<-f){a[b+716>>0]=1;g[b+708>>2]=-(e+f);g[b+712>>2]=1.0;break}if(e>f){a[b+716>>0]=1;g[b+708>>2]=f-e;g[b+712>>2]=-1.0}}while(0);L=c[b+28>>2]|0;T=+g[b+560>>2];U=+g[b+576>>2];X=+g[b+592>>2];V=T*+g[L+4>>2]+U*+g[L+8>>2]+X*+g[L+12>>2];W=T*+g[L+20>>2]+U*+g[L+24>>2]+X*+g[L+28>>2];X=T*+g[L+36>>2]+U*+g[L+40>>2]+X*+g[L+44>>2];M=c[b+32>>2]|0;g[b+720>>2]=1.0/(V*(V*+g[L+264>>2]+W*+g[L+280>>2]+X*+g[L+296>>2])+W*(V*+g[L+268>>2]+W*+g[L+284>>2]+X*+g[L+300>>2])+X*(V*+g[L+272>>2]+W*+g[L+288>>2]+X*+g[L+304>>2])+(V*(V*+g[M+264>>2]+W*+g[M+280>>2]+X*+g[M+296>>2])+W*(V*+g[M+268>>2]+W*+g[M+284>>2]+X*+g[M+300>>2])+X*(V*+g[M+272>>2]+W*+g[M+288>>2]+X*+g[M+304>>2])));i=d;return}function nq(b,d){b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0;e=i;if(a[b+738>>0]|0){c[d>>2]=0;c[d+4>>2]=0;i=e;return}c[d>>2]=5;c[d+4>>2]=1;h=+pq(b,(c[b+28>>2]|0)+4|0,(c[b+32>>2]|0)+4|0);g[b+728>>2]=h;g[b+708>>2]=0.0;g[b+712>>2]=0.0;a[b+716>>0]=0;do if(+g[b+692>>2]>=0.0){h=+ab(+(h- +g[b+688>>2]),6.2831854820251465);if(!(h<-3.1415927410125732)){if(h>3.1415927410125732)h=h+-6.2831854820251465}else h=h+6.2831854820251465;j=+g[b+692>>2];if(h<-j){a[b+716>>0]=1;g[b+708>>2]=-(h+j);g[b+712>>2]=1.0;break}if(!(h>j))if(!(a[b+716>>0]|0)){f=13;break}else break;else{a[b+716>>0]=1;g[b+708>>2]=j-h;g[b+712>>2]=-1.0;break}}else f=13;while(0);if((f|0)==13?(a[b+737>>0]|0)==0:0){i=e;return}c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1;i=e;return}function oq(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0,O=0.0,P=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0,X=0,Y=0,Z=0,_=0,$=0,aa=0;e=i;i=i+256|0;f=c[b+28>>2]|0;h=c[b+32>>2]|0;n=c[d+24>>2]|0;if(!(a[b+739>>0]|0)){no(e+192|0,f+4|0,b+552|0);no(e+128|0,h+4|0,b+616|0);q=+g[e+240>>2];o=+g[e+244>>2];j=+g[e+248>>2];k=+g[e+176>>2];p=+g[e+180>>2];l=+g[e+184>>2];Y=(a[b+736>>0]|0)==0;if(Y){N=c[d+8>>2]|0;g[N>>2]=1.0;g[N+(n+1<<2)>>2]=1.0;g[N+((n<<1)+2<<2)>>2]=1.0;N=c[d+16>>2]|0;g[N>>2]=-1.0;g[N+(n+1<<2)>>2]=-1.0;g[N+((n<<1)+2<<2)>>2]=-1.0;N=n<<1;_=n+1|0;Z=(n<<1)+2|0}else{N=n<<1;_=n+1|0;Z=(n<<1)+2|0}m=q- +g[f+52>>2];V=o- +g[f+56>>2];U=j- +g[f+60>>2];X=c[d+12>>2]|0;g[X>>2]=0.0;g[X+4>>2]=U;g[X+8>>2]=-V;g[X+12>>2]=0.0;g[X+(n<<2)>>2]=-U;g[X+(_<<2)>>2]=0.0;g[X+(n+2<<2)>>2]=m;g[X+(n+3<<2)>>2]=0.0;g[X+(N<<2)>>2]=V;aa=N|1;g[X+(aa<<2)>>2]=-m;g[X+(Z<<2)>>2]=0.0;$=N+3|0;g[X+($<<2)>>2]=0.0;m=k- +g[h+52>>2];V=p- +g[h+56>>2];U=l- +g[h+60>>2];W=c[d+20>>2]|0;g[W>>2]=0.0;g[W+4>>2]=-U;g[W+8>>2]=V;g[W+12>>2]=0.0;g[W+(n<<2)>>2]=U;g[W+(_<<2)>>2]=0.0;g[W+(n+2<<2)>>2]=-m;g[W+(n+3<<2)>>2]=0.0;g[W+(N<<2)>>2]=-V;g[W+(aa<<2)>>2]=m;g[W+(Z<<2)>>2]=0.0;g[W+($<<2)>>2]=0.0;m=+g[d>>2]*+g[d+4>>2];N=c[d+28>>2]|0;if(Y){g[N>>2]=m*(k-q);g[N+(n<<2)>>2]=m*(p-o);g[N+(n<<1<<2)>>2]=m*(l-j)}l=+g[e+200>>2];k=+g[e+216>>2];j=+g[e+232>>2];M=+g[e+192>>2];O=+g[e+208>>2];L=+g[e+224>>2];R=+g[e+196>>2];T=+g[e+212>>2];P=+g[e+228>>2];n=c[d+24>>2]|0;g[X+(n*3<<2)>>2]=M;g[X+((n*3|0)+1<<2)>>2]=O;g[X+((n*3|0)+2<<2)>>2]=L;g[X+(n<<2<<2)>>2]=R;g[X+((n<<2|1)<<2)>>2]=T;g[X+((n<<2|2)<<2)>>2]=P;g[W+(n*3<<2)>>2]=-M;g[W+((n*3|0)+1<<2)>>2]=-O;g[W+((n*3|0)+2<<2)>>2]=-L;g[W+(n<<2<<2)>>2]=-R;g[W+((n<<2|1)<<2)>>2]=-T;g[W+((n<<2|2)<<2)>>2]=-P;U=+g[e+136>>2];S=+g[e+152>>2];V=+g[e+168>>2];g[N+(n*3<<2)>>2]=m*(L*(l*S-k*U)+(M*(k*V-j*S)+O*(j*U-l*V)));g[N+(n<<2<<2)>>2]=m*(P*(l*S-k*U)+(R*(k*V-j*S)+T*(j*U-l*V)));if(!(a[b+716>>0]|0))if(!(a[b+737>>0]|0)){i=e;return}else{Y=0;_=0;N=0;m=0.0}else{m=+g[b+708>>2]*+g[b+732>>2];Y=1;_=(a[b+737>>0]|0)==0;N=m>0.0?1:2}g[X+(n*5<<2)>>2]=l;g[X+((n*5|0)+1<<2)>>2]=k;g[X+((n*5|0)+2<<2)>>2]=j;g[W+(n*5<<2)>>2]=-l;g[W+((n*5|0)+1<<2)>>2]=-k;g[W+((n*5|0)+2<<2)>>2]=-j;p=+ab(+(+g[b+688>>2]- +g[b+692>>2]),6.2831854820251465);if(!(p<-3.1415927410125732)){if(p>3.1415927410125732)p=p+-6.2831854820251465}else p=p+6.2831854820251465;r=+ab(+(+g[b+688>>2]+ +g[b+692>>2]),6.2831854820251465);if(!(r<-3.1415927410125732)){if(r>3.1415927410125732)r=r+-6.2831854820251465}else r=r+6.2831854820251465;X=p==r;W=(c[d+28>>2]|0)+(n*5<<2)|0;g[W>>2]=0.0;Z=c[b+748>>2]|0;o=+g[((Z&2|0)==0?d+4|0:b+760|0)>>2];if(!(Y&X|_)){if(Z&4)g[(c[d+32>>2]|0)+(n*5<<2)>>2]=+g[b+752>>2];s=+g[b+728>>2];q=+g[b+680>>2];_=p>r;do if(!(_|X)){t=q/(o*+g[d>>2]);if(t<0.0){if(s>=p?p-t>s:0){p=(p-s)/t;break}p=s<p?0.0:1.0;break}if(t>0.0){if(s<=r?r-t<s:0){p=(r-s)/t;break}p=s>r?0.0:1.0}else p=0.0}else p=_?1.0:0.0;while(0);g[W>>2]=p*q*+g[b+732>>2]+ +g[W>>2];g[(c[d+36>>2]|0)+(n*5<<2)>>2]=-+g[b+684>>2];g[(c[d+40>>2]|0)+(n*5<<2)>>2]=+g[b+684>>2]}if(!Y){i=e;return}g[W>>2]=+g[W>>2]+m*o*+g[d>>2];if(Z&1)g[(c[d+32>>2]|0)+(n*5<<2)>>2]=+g[b+756>>2];do if(!X){X=(c[d+36>>2]|0)+(n*5<<2)|0;if((N|0)==1){g[X>>2]=0.0;g[(c[d+40>>2]|0)+(n*5<<2)>>2]=3.4028234663852886e+38;break}else{g[X>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(n*5<<2)>>2]=0.0;break}}else{g[(c[d+36>>2]|0)+(n*5<<2)>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(n*5<<2)>>2]=3.4028234663852886e+38}while(0);m=+g[b+704>>2];do if(m>0.0){j=l*+g[f+328>>2]+k*+g[f+332>>2]+j*+g[f+336>>2]-(l*+g[h+328>>2]+k*+g[h+332>>2]+j*+g[h+336>>2]);if((N|0)==1){if(!(j<0.0))break;if(!(+g[W>>2]<-(m*j)))break;g[W>>2]=-(m*j);break}else{if(!(j>0.0))break;if(!(+g[W>>2]>-(m*j)))break;g[W>>2]=-(m*j);break}}while(0);g[W>>2]=+g[b+700>>2]*+g[W>>2];i=e;return}no(e+64|0,f+4|0,b+552|0);no(e,h+4|0,b+616|0);D=+g[e+48>>2];B=+g[e+112>>2];E=+g[e+52>>2];C=+g[e+116>>2];F=+g[e+56>>2];A=+g[e+120>>2];k=+g[(c[b+28>>2]|0)+344>>2];j=+g[(c[b+32>>2]|0)+344>>2];if(k<1.1920928955078125e-7)N=1;else N=j<1.1920928955078125e-7;if(k+j>0.0)I=j/(k+j);else I=.5;L=1.0-I;q=+g[e+72>>2];p=+g[e+88>>2];t=+g[e+104>>2];r=+g[e+8>>2];s=+g[e+24>>2];o=+g[e+40>>2];m=I*q+L*r;k=I*p+L*s;j=I*t+L*o;l=1.0/+Q(+(m*m+k*k+j*j));x=D- +g[h+52>>2];P=E- +g[h+56>>2];T=F- +g[h+60>>2];y=m*l*(x*m*l+P*k*l+T*j*l);R=k*l*(x*m*l+P*k*l+T*j*l);U=j*l*(x*m*l+P*k*l+T*j*l);z=B- +g[f+52>>2];S=C- +g[f+56>>2];V=A- +g[f+60>>2];u=m*l*(m*l*z+k*l*S+j*l*V);v=k*l*(m*l*z+k*l*S+j*l*V);w=j*l*(m*l*z+k*l*S+j*l*V);H=z-u+I*(u-y);G=S-v+I*(v-R);J=V-w+I*(w-U);M=x-y-L*(u-y);K=P-R-L*(v-R);O=T-U-L*(w-U);u=I*(x-y)+L*(z-u);v=I*(P-R)+L*(S-v);w=I*(T-U)+L*(V-w);if(u*u+v*v+w*w>1.1920928955078125e-7){z=1.0/+Q(+(u*u+v*v+w*w));u=u*z;v=z*v;z=z*w}else{u=+g[e+68>>2];v=+g[e+84>>2];z=+g[e+100>>2]}y=k*l*z-j*l*v;x=j*l*u-z*m*l;w=v*m*l-k*l*u;aa=c[d+12>>2]|0;g[aa>>2]=G*z-J*v;g[aa+4>>2]=J*u-H*z;g[aa+8>>2]=H*v-G*u;aa=c[d+20>>2]|0;g[aa>>2]=-(K*z-O*v);g[aa+4>>2]=-(O*u-M*z);g[aa+8>>2]=-(M*v-K*u);if(N?(a[b+716>>0]|0)!=0:0){S=L*(K*w-O*x);R=L*(O*y-M*w);P=L*(M*x-K*y);T=I*(G*w-J*x);U=I*(J*y-H*w);V=I*(H*x-G*y)}else{S=K*w-O*x;R=O*y-M*w;P=M*x-K*y;T=G*w-J*x;U=J*y-H*w;V=H*x-G*y}aa=c[d+12>>2]|0;g[aa+(n<<2)>>2]=T;g[aa+(n+1<<2)>>2]=U;g[aa+(n+2<<2)>>2]=V;aa=c[d+20>>2]|0;g[aa+(n<<2)>>2]=-S;g[aa+(n+1<<2)>>2]=-R;g[aa+(n+2<<2)>>2]=-P;if(N){P=L*(K*j*l-O*k*l);O=L*(O*m*l-M*j*l);K=L*(M*k*l-K*m*l);L=I*(G*j*l-J*k*l);J=I*(J*m*l-H*j*l);G=I*(H*k*l-G*m*l)}else{P=K*j*l-O*k*l;O=O*m*l-M*j*l;K=M*k*l-K*m*l;L=G*j*l-J*k*l;J=J*m*l-H*j*l;G=H*k*l-G*m*l}N=c[d+12>>2]|0;g[N+(n<<1<<2)>>2]=L;g[N+((n<<1|1)<<2)>>2]=J;g[N+((n<<1)+2<<2)>>2]=G;N=c[d+20>>2]|0;g[N+(n<<1<<2)>>2]=-P;g[N+((n<<1|1)<<2)>>2]=-O;g[N+((n<<1)+2<<2)>>2]=-K;G=+g[d>>2]*+g[d+4>>2];if(!(a[b+736>>0]|0)){X=c[d+8>>2]|0;g[X>>2]=u;g[X+4>>2]=v;g[X+8>>2]=z;X=c[d+8>>2]|0;g[X+(n<<2)>>2]=y;g[X+(n+1<<2)>>2]=x;g[X+(n+2<<2)>>2]=w;X=c[d+8>>2]|0;g[X+(n<<1<<2)>>2]=m*l;g[X+((n<<1|1)<<2)>>2]=k*l;g[X+((n<<1)+2<<2)>>2]=j*l;X=c[d+16>>2]|0;V=-u;g[X>>2]=V;T=-v;g[X+4>>2]=T;U=-z;g[X+8>>2]=U;g[X+(n<<2)>>2]=-y;g[X+(n+1<<2)>>2]=-x;g[X+(n+2<<2)>>2]=-w;g[X+(n<<1<<2)>>2]=-(m*l);g[X+((n<<1|1)<<2)>>2]=-(k*l);g[X+((n<<1)+2<<2)>>2]=-(j*l);X=c[d+28>>2]|0;g[X>>2]=G*((D-B)*u+(E-C)*v+(F-A)*z);g[X+(n<<2)>>2]=G*((D-B)*y+(E-C)*x+(F-A)*w);g[X+(n<<1<<2)>>2]=G*((D-B)*m*l+(E-C)*k*l+(F-A)*j*l);B=-y;C=-x;D=-w;F=T;A=U;E=V;N=c[d+20>>2]|0}else{B=-y;C=-x;D=-w;F=-v;A=-z;E=-u;X=c[d+28>>2]|0}W=c[d+12>>2]|0;g[W+(n*3<<2)>>2]=u;g[W+((n*3|0)+1<<2)>>2]=v;g[W+((n*3|0)+2<<2)>>2]=z;g[W+(n<<2<<2)>>2]=y;g[W+((n<<2|1)<<2)>>2]=x;g[W+((n<<2|2)<<2)>>2]=w;g[N+(n*3<<2)>>2]=E;g[N+((n*3|0)+1<<2)>>2]=F;g[N+((n*3|0)+2<<2)>>2]=A;g[N+(n<<2<<2)>>2]=B;g[N+((n<<2|1)<<2)>>2]=C;g[N+((n<<2|2)<<2)>>2]=D;V=+g[d>>2]*+g[d+4>>2];g[X+(n*3<<2)>>2]=V*((p*o-t*s)*u+(t*r-q*o)*v+(q*s-p*r)*z);g[X+(n<<2<<2)>>2]=V*((p*o-t*s)*y+(t*r-q*o)*x+(q*s-p*r)*w);if(!(a[b+716>>0]|0))if(!(a[b+737>>0]|0)){i=e;return}else{Y=0;_=0;n=0;o=0.0}else{o=+g[b+708>>2]*+g[b+732>>2];Y=1;_=(a[b+737>>0]|0)==0;n=o>0.0?1:2}X=(c[d+24>>2]|0)*5|0;g[W+(X<<2)>>2]=m*l;g[W+(X+1<<2)>>2]=k*l;g[W+(X+2<<2)>>2]=j*l;g[N+(X<<2)>>2]=-(m*l);g[N+(X+1<<2)>>2]=-(k*l);g[N+(X+2<<2)>>2]=-(j*l);p=+ab(+(+g[b+688>>2]- +g[b+692>>2]),6.2831854820251465);if(!(p<-3.1415927410125732)){if(p>3.1415927410125732)p=p+-6.2831854820251465}else p=p+6.2831854820251465;r=+ab(+(+g[b+688>>2]+ +g[b+692>>2]),6.2831854820251465);if(!(r<-3.1415927410125732)){if(r>3.1415927410125732)r=r+-6.2831854820251465}else r=r+6.2831854820251465;W=p==r;N=(c[d+28>>2]|0)+(X<<2)|0;g[N>>2]=0.0;Z=c[b+748>>2]|0;q=+g[((Z&2|0)==0?d+4|0:b+760|0)>>2];if(!(Y&W|_)){if(Z&4)g[(c[d+32>>2]|0)+(X<<2)>>2]=+g[b+752>>2];t=+g[b+728>>2];s=+g[b+680>>2];_=p>r;do if(!(_|W)){u=s/(q*+g[d>>2]);if(u<0.0){if(t>=p?p-u>t:0){p=(p-t)/u;break}p=t<p?0.0:1.0;break}if(u>0.0){if(t<=r?r-u<t:0){p=(r-t)/u;break}p=t>r?0.0:1.0}else p=0.0}else p=_?1.0:0.0;while(0);g[N>>2]=p*s*+g[b+732>>2]+ +g[N>>2];g[(c[d+36>>2]|0)+(X<<2)>>2]=-+g[b+684>>2];g[(c[d+40>>2]|0)+(X<<2)>>2]=+g[b+684>>2]}if(!Y){i=e;return}g[N>>2]=+g[N>>2]+o*q*+g[d>>2];if(Z&1)g[(c[d+32>>2]|0)+(X<<2)>>2]=+g[b+756>>2];do if(!W){W=(c[d+36>>2]|0)+(X<<2)|0;if((n|0)==1){g[W>>2]=0.0;g[(c[d+40>>2]|0)+(X<<2)>>2]=3.4028234663852886e+38;break}else{g[W>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(X<<2)>>2]=0.0;break}}else{g[(c[d+36>>2]|0)+(X<<2)>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(X<<2)>>2]=3.4028234663852886e+38}while(0);o=+g[b+704>>2];do if(o>0.0){j=+g[f+328>>2]*m*l+ +g[f+332>>2]*k*l+ +g[f+336>>2]*j*l-(m*l*+g[h+328>>2]+k*l*+g[h+332>>2]+j*l*+g[h+336>>2]);if((n|0)==1){if(!(j<0.0))break;if(!(+g[N>>2]<-(o*j)))break;g[N>>2]=-(o*j);break}else{if(!(j>0.0))break;if(!(+g[N>>2]>-(o*j)))break;g[N>>2]=-(o*j);break}}while(0);g[N>>2]=+g[b+700>>2]*+g[N>>2];i=e;return}function pq(a,b,c){a=a|0;b=b|0;c=c|0;var d=0.0,e=0.0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0;v=+g[a+552>>2];u=+g[a+568>>2];t=+g[a+584>>2];s=+g[b>>2];r=+g[b+4>>2];q=+g[b+8>>2];o=+g[b+16>>2];n=+g[b+20>>2];m=+g[b+24>>2];k=+g[b+32>>2];i=+g[b+36>>2];f=+g[b+40>>2];j=+g[a+556>>2];h=+g[a+572>>2];e=+g[a+588>>2];x=+g[a+620>>2];w=+g[a+636>>2];d=+g[a+652>>2];p=x*+g[c>>2]+w*+g[c+4>>2]+d*+g[c+8>>2];l=x*+g[c+16>>2]+w*+g[c+20>>2]+d*+g[c+24>>2];d=x*+g[c+32>>2]+w*+g[c+36>>2]+d*+g[c+40>>2];d=+Y(+((v*s+u*r+t*q)*p+(v*o+u*n+t*m)*l+(v*k+u*i+t*f)*d),+((s*j+r*h+q*e)*p+(o*j+n*h+m*e)*l+(k*j+i*h+f*e)*d));return+(d*+g[a+732>>2])}function qq(a,b,d,e){a=a|0;b=b|0;d=+d;e=e|0;var f=0;f=i;do if((e|0)==5|(e|0)==-1)if((b|0)==2){g[a+760>>2]=d;c[a+748>>2]=c[a+748>>2]|2;break}else if((b|0)==3){g[a+752>>2]=d;c[a+748>>2]=c[a+748>>2]|4;break}else if((b|0)==4){g[a+756>>2]=d;c[a+748>>2]=c[a+748>>2]|1;break}else break;while(0);i=f;return}function rq(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0;d=i;do if((c|0)==5|(c|0)==-1)if((b|0)==2){e=+g[a+760>>2];break}else if((b|0)==4){e=+g[a+756>>2];break}else if((b|0)==3){e=+g[a+752>>2];break}else{e=0.0;break}else e=0.0;while(0);i=d;return+e}function sq(a){a=a|0;return}function tq(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function uq(a){a=a|0;return 220}function vq(a,b,e){a=a|0;b=b|0;e=e|0;var f=0,h=0.0;f=i;Zr(a,b,e)|0;g[b+52>>2]=+g[a+552>>2];g[b+56>>2]=+g[a+556>>2];g[b+60>>2]=+g[a+560>>2];g[b+64>>2]=+g[a+564>>2];g[b+68>>2]=+g[a+568>>2];g[b+72>>2]=+g[a+572>>2];g[b+76>>2]=+g[a+576>>2];g[b+80>>2]=+g[a+580>>2];g[b+84>>2]=+g[a+584>>2];g[b+88>>2]=+g[a+588>>2];g[b+92>>2]=+g[a+592>>2];g[b+96>>2]=+g[a+596>>2];g[b+100>>2]=+g[a+600>>2];g[b+104>>2]=+g[a+604>>2];g[b+108>>2]=+g[a+608>>2];g[b+112>>2]=+g[a+612>>2];g[b+116>>2]=+g[a+616>>2];g[b+120>>2]=+g[a+620>>2];g[b+124>>2]=+g[a+624>>2];g[b+128>>2]=+g[a+628>>2];g[b+132>>2]=+g[a+632>>2];g[b+136>>2]=+g[a+636>>2];g[b+140>>2]=+g[a+640>>2];g[b+144>>2]=+g[a+644>>2];g[b+148>>2]=+g[a+648>>2];g[b+152>>2]=+g[a+652>>2];g[b+156>>2]=+g[a+656>>2];g[b+160>>2]=+g[a+660>>2];g[b+164>>2]=+g[a+664>>2];g[b+168>>2]=+g[a+668>>2];g[b+172>>2]=+g[a+672>>2];g[b+176>>2]=+g[a+676>>2];c[b+184>>2]=d[a+736>>0];c[b+188>>2]=d[a+737>>0];g[b+196>>2]=+g[a+684>>2];g[b+192>>2]=+g[a+680>>2];c[b+180>>2]=d[a+740>>0];h=+ab(+(+g[a+688>>2]- +g[a+692>>2]),6.2831854820251465);if(!(h<-3.1415927410125732)){if(h>3.1415927410125732)h=h+-6.2831854820251465}else h=h+6.2831854820251465;g[b+200>>2]=h;h=+ab(+(+g[a+688>>2]+ +g[a+692>>2]),6.2831854820251465);if(h<-3.1415927410125732){h=h+6.2831854820251465;e=b+204|0;g[e>>2]=h;e=a+696|0;h=+g[e>>2];e=b+208|0;g[e>>2]=h;e=a+700|0;h=+g[e>>2];e=b+212|0;g[e>>2]=h;e=a+704|0;h=+g[e>>2];e=b+216|0;g[e>>2]=h;i=f;return 2592}if(!(h>3.1415927410125732)){e=b+204|0;g[e>>2]=h;e=a+696|0;h=+g[e>>2];e=b+208|0;g[e>>2]=h;e=a+700|0;h=+g[e>>2];e=b+212|0;g[e>>2]=h;e=a+704|0;h=+g[e>>2];e=b+216|0;g[e>>2]=h;i=f;return 2592}h=h+-6.2831854820251465;e=b+204|0;g[e>>2]=h;e=a+696|0;h=+g[e>>2];e=b+208|0;g[e>>2]=h;e=a+700|0;h=+g[e>>2];e=b+212|0;g[e>>2]=h;e=a+704|0;h=+g[e>>2];e=b+216|0;g[e>>2]=h;i=f;return 2592}function wq(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=2632;e=c[b+140>>2]|0;if(e){if(a[b+144>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}a[b+144>>0]=1;c[b+140>>2]=0;c[b+132>>2]=0;c[b+136>>2]=0;if(!b){i=d;return}}else{a[b+144>>0]=1;c[b+140>>2]=0;c[b+132>>2]=0;c[b+136>>2]=0}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function xq(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=2632;e=c[b+140>>2]|0;if(e){if(a[b+144>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+140>>2]=0}a[b+144>>0]=1;c[b+140>>2]=0;c[b+132>>2]=0;c[b+136>>2]=0;i=d;return}function yq(a){a=a|0;return}function zq(d,e,f,h,j){d=d|0;e=e|0;f=+f;h=+h;j=+j;var k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0;k=i;i=i+240|0;p=+g[d+96>>2]+h;q=+g[d+100>>2]+j;g[d+112>>2]=+g[d+92>>2]+f;g[d+116>>2]=p;g[d+120>>2]=q;g[d+124>>2]=0.0;g[k+168>>2]=1.0;c[k+172>>2]=0;c[k+176>>2]=0;c[k+180>>2]=0;c[k+184>>2]=0;g[k+188>>2]=1.0;c[k+192>>2]=0;c[k+196>>2]=0;c[k+200>>2]=0;c[k+204>>2]=0;g[k+208>>2]=1.0;l=k+212|0;c[l+0>>2]=0;c[l+4>>2]=0;c[l+8>>2]=0;c[l+12>>2]=0;c[l+16>>2]=0;g[k+104>>2]=1.0;c[k+108>>2]=0;c[k+112>>2]=0;c[k+116>>2]=0;c[k+120>>2]=0;g[k+124>>2]=1.0;c[k+128>>2]=0;c[k+132>>2]=0;c[k+136>>2]=0;c[k+140>>2]=0;g[k+144>>2]=1.0;l=k+148|0;c[l+0>>2]=0;c[l+4>>2]=0;c[l+8>>2]=0;c[l+12>>2]=0;c[l+16>>2]=0;f=1.0;l=10;while(1){r=l;l=l+ -1|0;if((r|0)<=0){d=12;break}c[k+216>>2]=c[d+92>>2];c[k+220>>2]=c[d+96>>2];c[k+224>>2]=c[d+100>>2];c[k+228>>2]=c[d+104>>2];c[k+152>>2]=c[d+112>>2];c[k+156>>2]=c[d+116>>2];c[k+160>>2]=c[d+120>>2];c[k+164>>2]=c[d+124>>2];p=+g[d+92>>2]- +g[d+112>>2];q=+g[d+96>>2]- +g[d+116>>2];j=+g[d+100>>2]- +g[d+120>>2];r=c[d+8>>2]|0;g[k+4>>2]=1.0;b[k+8>>1]=1;b[k+10>>1]=-1;c[k+76>>2]=0;c[k+12>>2]=0;c[k+16>>2]=0;c[k+20>>2]=0;c[k+24>>2]=0;c[k+28>>2]=0;c[k+32>>2]=0;c[k+36>>2]=0;c[k+40>>2]=0;c[k>>2]=2896;c[k+80>>2]=r;g[k+84>>2]=p;g[k+88>>2]=q;g[k+92>>2]=j;g[k+96>>2]=0.0;g[k+100>>2]=0.0;r=c[r+188>>2]|0;b[k+8>>1]=b[r+4>>1]|0;b[k+10>>1]=b[r+6>>1]|0;r=c[d+12>>2]|0;j=+$b[c[(c[r>>2]|0)+48>>2]&15](r);r=c[d+12>>2]|0;Kb[c[(c[r>>2]|0)+44>>2]&31](r,j+ +g[d+56>>2]);if(!(a[d+170>>0]|0))Ou(e,c[d+12>>2]|0,k+168|0,k+104|0,k,+g[e+56>>2]);else vz(c[d+8>>2]|0,c[d+12>>2]|0,k+168|0,k+104|0,k,+g[e+56>>2]);r=c[d+12>>2]|0;Kb[c[(c[r>>2]|0)+44>>2]&31](r,j);q=+g[k+4>>2];f=f-q;if(!(q<1.0)){c[d+92>>2]=c[d+112>>2];c[d+96>>2]=c[d+116>>2];c[d+100>>2]=c[d+120>>2];c[d+104>>2]=c[d+124>>2];if(f>.009999999776482582)continue;else{d=12;break}}p=+g[d+112>>2];m=+g[d+92>>2];o=+g[d+116>>2];h=+g[d+96>>2];n=+g[d+120>>2];j=+g[d+100>>2];q=+Q(+((p-m)*(p-m)+(o-h)*(o-h)+(n-j)*(n-j)));if(q>1.1920928955078125e-7){v=+g[k+44>>2];t=+g[k+48>>2];x=+g[k+52>>2];w=((p-m)*(1.0/q)*v+(o-h)*(1.0/q)*t+(n-j)*(1.0/q)*x)*2.0;u=(p-m)*(1.0/q)-v*w;s=(o-h)*(1.0/q)-t*w;w=(n-j)*(1.0/q)-x*w;n=1.0/+Q(+(w*w+(u*u+s*s)));c[d+112>>2]=c[d+92>>2];c[d+116>>2]=c[d+96>>2];c[d+120>>2]=c[d+100>>2];c[d+124>>2]=c[d+104>>2];p=q*(n*u-v*(x*n*w+(v*n*u+t*n*s)))+ +g[d+112>>2];g[d+112>>2]=p;o=q*(n*s-t*(x*n*w+(v*n*u+t*n*s)))+ +g[d+116>>2];g[d+116>>2]=o;n=q*(n*w-x*(x*n*w+(v*n*u+t*n*s)))+ +g[d+120>>2];g[d+120>>2]=n}m=p-m;h=o-h;j=n-j;if(!(m*m+h*h+j*j>1.1920928955078125e-7)){d=12;break}x=1.0/+Q(+(m*m+h*h+j*j));if(!(f>.009999999776482582?!(m*x*+g[d+76>>2]+h*x*+g[d+80>>2]+j*x*+g[d+84>>2]<=0.0):0)){d=12;break}}if((d|0)==12){i=k;return}}function Aq(b,d){b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0;e=i;a[b+171>>0]=1;c[b+60>>2]=c[d+0>>2];c[b+64>>2]=c[d+4>>2];c[b+68>>2]=c[d+8>>2];c[b+72>>2]=c[d+12>>2];f=+g[b+60>>2];k=+g[b+64>>2];h=+g[b+68>>2];j=1.0/+Q(+(f*f+k*k+h*h));if(+Q(+(h*j*h*j+(f*j*f*j+k*j*k*j)))<1.1920928955078125e-7){f=0.0;k=0.0;j=0.0;h=0.0}else{f=f*j;k=k*j;j=h*j;h=+g[b+72>>2]}g[b+76>>2]=f;g[b+80>>2]=k;g[b+84>>2]=j;g[b+88>>2]=h;i=e;return}function Bq(b,d,e){b=b|0;d=d|0;e=+e;var f=0,h=0.0,j=0.0,k=0.0,l=0.0;f=i;a[b+171>>0]=0;c[b+60>>2]=c[d+0>>2];c[b+64>>2]=c[d+4>>2];c[b+68>>2]=c[d+8>>2];c[b+72>>2]=c[d+12>>2];h=+g[b+60>>2];l=+g[b+64>>2];j=+g[b+68>>2];k=1.0/+Q(+(h*h+l*l+j*j));if(+Q(+(j*k*j*k+(h*k*h*k+l*k*l*k)))<1.1920928955078125e-7){h=0.0;l=0.0;k=0.0;j=0.0}else{h=h*k;l=l*k;k=j*k;j=+g[b+72>>2]}g[b+76>>2]=h;g[b+80>>2]=l;g[b+84>>2]=k;g[b+88>>2]=j;g[b+172>>2]=+g[b+172>>2]+e;i=f;return}function Cq(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0;e=i;g[b+16>>2]=0.0;g[b+20>>2]=0.0;a[b+168>>0]=0;a[b+169>>0]=0;g[b+172>>2]=0.0;c[b+60>>2]=0;c[b+64>>2]=0;c[b+68>>2]=0;c[b+72>>2]=0;b=c[(c[b+8>>2]|0)+284>>2]|0;if((c[(Pb[c[(c[b>>2]|0)+28>>2]&127](b)|0)+4>>2]|0)<=0){i=e;return}do{h=c[b>>2]|0;j=c[h+12>>2]|0;h=c[c[(Pb[c[h+28>>2]&127](b)|0)+12>>2]>>2]|0;f=c[(c[(Pb[c[(c[b>>2]|0)+28>>2]&127](b)|0)+12>>2]|0)+4>>2]|0;Tb[j&31](b,h,f,c[d+24>>2]|0)|0}while((c[(Pb[c[(c[b>>2]|0)+28>>2]&127](b)|0)+4>>2]|0)>0);i=e;return}function Dq(a,b){a=a|0;b=b|0;var d=0;d=i;i=i+32|0;c[d+16>>2]=0;c[d+20>>2]=0;c[d+24>>2]=0;c[d+28>>2]=0;c[d+0>>2]=c[b+0>>2];c[d+4>>2]=c[b+4>>2];c[d+8>>2]=c[b+8>>2];c[d+12>>2]=c[b+12>>2];b=c[a+8>>2]|0;c[b+260>>2]=(c[b+260>>2]|0)+1;g[b+4>>2]=1.0;c[b+8>>2]=c[d+16>>2];c[b+12>>2]=c[d+20>>2];c[b+16>>2]=c[d+24>>2];c[b+20>>2]=0;g[b+24>>2]=1.0;c[b+28>>2]=0;c[b+32>>2]=0;c[b+36>>2]=0;c[b+40>>2]=0;g[b+44>>2]=1.0;g[b+48>>2]=0.0;c[b+52>>2]=c[d+0>>2];c[b+56>>2]=c[d+4>>2];c[b+60>>2]=c[d+8>>2];c[b+64>>2]=c[d+12>>2];i=d;return}function Eq(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0.0,q=0,r=0.0,s=0,t=0.0,u=0,v=0,w=0,x=0.0,y=0.0;h=i;i=i+96|0;a[b+148>>0]=0;e=0;while(1){w=c[b+12>>2]|0;vc[c[(c[w>>2]|0)+8>>2]&127](w,(c[b+8>>2]|0)+4|0,h+80|0,h+64|0);w=c[d+68>>2]|0;Jb[c[(c[w>>2]|0)+16>>2]&31](w,c[(c[b+8>>2]|0)+188>>2]|0,h+80|0,h+64|0,c[d+24>>2]|0);w=c[d+24>>2]|0;vc[c[(c[w>>2]|0)+32>>2]&127](w,c[(c[b+8>>2]|0)+284>>2]|0,d+28|0,w);w=c[b+8>>2]|0;c[b+92>>2]=c[w+52>>2];c[b+96>>2]=c[w+56>>2];c[b+100>>2]=c[w+60>>2];c[b+104>>2]=c[w+64>>2];w=c[w+284>>2]|0;if((Pb[c[(c[w>>2]|0)+36>>2]&127](w)|0)>0){j=0;r=0.0;o=0;do{l=c[b+132>>2]|0;if((l|0)<0){if((c[b+136>>2]|0)<0){k=c[b+140>>2]|0;if(k){if(a[b+144>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[b+140>>2]=0}a[b+144>>0]=1;c[b+140>>2]=0;c[b+136>>2]=0}do{k=(c[b+140>>2]|0)+(l<<2)|0;if(k)c[k>>2]=0;l=l+1|0}while((l|0)!=0)}c[b+132>>2]=0;l=c[(c[b+8>>2]|0)+284>>2]|0;l=c[(Pb[c[(c[l>>2]|0)+28>>2]&127](l)|0)+12>>2]|0;w=c[c[l+(j<<4)>>2]>>2]|0;k=c[c[l+(j<<4)+4>>2]>>2]|0;if(!((w|0)!=0?(c[w+204>>2]&4|0)!=0:0))f=15;do if((f|0)==15){f=0;if((k|0)!=0?(c[k+204>>2]&4|0)!=0:0)break;k=c[l+(j<<4)+8>>2]|0;if(k)Nb[c[(c[k>>2]|0)+16>>2]&127](k,b+128|0);n=c[b+132>>2]|0;if((n|0)>0){m=c[b+140>>2]|0;l=c[b+8>>2]|0;k=0;u=o;while(1){o=c[m+(k<<2)>>2]|0;p=(c[o+740>>2]|0)==(l|0)?-1.0:1.0;s=c[o+748>>2]|0;if((s|0)>0){q=0;do{t=+g[o+(q*184|0)+84>>2];if(t<0.0){v=o+(q*184|0)+68|0;if(t<r){w=o+(q*184|0)+72|0;x=p*+g[w>>2];u=o+(q*184|0)+76|0;r=p*+g[u>>2];g[b+152>>2]=p*+g[v>>2];g[b+156>>2]=x;g[b+160>>2]=r;g[b+164>>2]=0.0;s=c[o+748>>2]|0;r=t}else{w=o+(q*184|0)+72|0;u=o+(q*184|0)+76|0}y=t*p*+g[w>>2]*.20000000298023224;x=t*p*+g[u>>2]*.20000000298023224;g[b+92>>2]=t*p*+g[v>>2]*.20000000298023224+ +g[b+92>>2];g[b+96>>2]=y+ +g[b+96>>2];g[b+100>>2]=x+ +g[b+100>>2];u=1}q=q+1|0}while((q|0)<(s|0));o=u}else o=u;k=k+1|0;if((k|0)>=(n|0))break;else u=o}}}while(0);j=j+1|0;w=c[(c[b+8>>2]|0)+284>>2]|0}while((j|0)<(Pb[c[(c[w>>2]|0)+36>>2]&127](w)|0))}else o=0;w=c[b+8>>2]|0;c[h+0>>2]=c[w+4>>2];c[h+4>>2]=c[w+8>>2];c[h+8>>2]=c[w+12>>2];c[h+12>>2]=c[w+16>>2];c[h+16>>2]=c[w+20>>2];c[h+20>>2]=c[w+24>>2];c[h+24>>2]=c[w+28>>2];c[h+28>>2]=c[w+32>>2];c[h+32>>2]=c[w+36>>2];c[h+36>>2]=c[w+40>>2];c[h+40>>2]=c[w+44>>2];c[h+44>>2]=c[w+48>>2];c[h+48>>2]=c[b+92>>2];c[h+52>>2]=c[b+96>>2];c[h+56>>2]=c[b+100>>2];c[h+60>>2]=c[b+104>>2];c[w+260>>2]=(c[w+260>>2]|0)+1;c[w+4>>2]=c[h+0>>2];c[w+8>>2]=c[h+4>>2];c[w+12>>2]=c[h+8>>2];c[w+16>>2]=c[h+12>>2];c[w+20>>2]=c[h+16>>2];c[w+24>>2]=c[h+20>>2];c[w+28>>2]=c[h+24>>2];c[w+32>>2]=c[h+28>>2];c[w+36>>2]=c[h+32>>2];c[w+40>>2]=c[h+36>>2];c[w+44>>2]=c[h+40>>2];c[w+48>>2]=c[h+44>>2];c[w+52>>2]=c[h+48>>2];c[w+56>>2]=c[h+52>>2];c[w+60>>2]=c[h+56>>2];c[w+64>>2]=c[h+60>>2];if(!o){f=32;break}a[b+148>>0]=1;if((e|0)>3){f=32;break}else e=e+1|0}if((f|0)==32){w=(c[b+8>>2]|0)+52|0;c[b+92>>2]=c[w+0>>2];c[b+96>>2]=c[w+4>>2];c[b+100>>2]=c[w+8>>2];c[b+104>>2]=c[w+12>>2];nF(b+112|0,w|0,16)|0;i=h;return}}function Fq(d,e,f){d=d|0;e=e|0;f=+f;var h=0,j=0.0,k=0.0,l=0.0,m=0,n=0,o=0,p=0.0,q=0.0,r=0,s=0.0;h=i;i=i+528|0;if((a[d+171>>0]|0)==0?+g[d+172>>2]<=0.0:0){i=h;return}a[d+168>>0]=(Pb[c[(c[d>>2]|0)+48>>2]&127](d)|0)&1;p=+g[d+16>>2]- +g[d+44>>2]*f;g[d+16>>2]=p;if(p>0.0?(l=+g[d+28>>2],p>l):0)g[d+16>>2]=l;else l=p;if(l<0.0?(s=+P(+l),k=+P(+(+g[d+24>>2])),s>k):0){g[d+16>>2]=-k;l=-k}g[d+20>>2]=l*f;m=c[d+8>>2]|0;c[h+0>>2]=c[m+4>>2];c[h+4>>2]=c[m+8>>2];c[h+8>>2]=c[m+12>>2];c[h+12>>2]=c[m+16>>2];c[h+16>>2]=c[m+20>>2];c[h+20>>2]=c[m+24>>2];c[h+24>>2]=c[m+28>>2];c[h+28>>2]=c[m+32>>2];c[h+32>>2]=c[m+36>>2];c[h+36>>2]=c[m+40>>2];c[h+40>>2]=c[m+44>>2];c[h+44>>2]=c[m+48>>2];c[h+48>>2]=c[m+52>>2];c[h+52>>2]=c[m+56>>2];c[h+56>>2]=c[m+60>>2];c[h+60>>2]=c[m+64>>2];m=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}p=+g[d+20>>2];p=+g[d+52>>2]+(p>0.0?p:0.0);q=+g[2692+(m<<4)>>2]*p+ +g[d+96>>2];s=p*+g[2696+(m<<4)>>2]+ +g[d+100>>2];g[d+112>>2]=+g[d+92>>2]+ +g[2688+(m<<4)>>2]*p;g[d+116>>2]=q;g[d+120>>2]=s;g[d+124>>2]=0.0;g[h+456>>2]=1.0;c[h+460>>2]=0;c[h+464>>2]=0;c[h+468>>2]=0;c[h+472>>2]=0;g[h+476>>2]=1.0;c[h+480>>2]=0;c[h+484>>2]=0;c[h+488>>2]=0;c[h+492>>2]=0;g[h+496>>2]=1.0;m=h+500|0;c[m+0>>2]=0;c[m+4>>2]=0;c[m+8>>2]=0;c[m+12>>2]=0;c[m+16>>2]=0;g[h+392>>2]=1.0;c[h+396>>2]=0;c[h+400>>2]=0;c[h+404>>2]=0;c[h+408>>2]=0;g[h+412>>2]=1.0;c[h+416>>2]=0;c[h+420>>2]=0;c[h+424>>2]=0;c[h+428>>2]=0;g[h+432>>2]=1.0;m=h+436|0;c[m+0>>2]=0;c[m+4>>2]=0;c[m+8>>2]=0;c[m+12>>2]=0;c[m+16>>2]=0;m=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}n=c[d+12>>2]|0;p=+$b[c[(c[n>>2]|0)+48>>2]&15](n);p=p+ +g[d+56>>2];q=p*+g[2692+(m<<4)>>2]+ +g[d+96>>2];s=p*+g[2696+(m<<4)>>2]+ +g[d+100>>2];g[h+504>>2]=+g[2688+(m<<4)>>2]*p+ +g[d+92>>2];g[h+508>>2]=q;g[h+512>>2]=s;g[h+516>>2]=0.0;c[h+440>>2]=c[d+112>>2];c[h+444>>2]=c[d+116>>2];c[h+448>>2]=c[d+120>>2];c[h+452>>2]=c[d+124>>2];m=c[d+8>>2]|0;n=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}p=-+g[2688+(n<<4)>>2];q=-+g[2692+(n<<4)>>2];s=-+g[2696+(n<<4)>>2];g[h+292>>2]=1.0;b[h+296>>1]=1;b[h+298>>1]=-1;r=h+300|0;c[h+364>>2]=0;c[r+0>>2]=0;c[r+4>>2]=0;c[r+8>>2]=0;c[r+12>>2]=0;c[r+16>>2]=0;c[r+20>>2]=0;c[r+24>>2]=0;c[r+28>>2]=0;c[h+288>>2]=2896;c[h+368>>2]=m;g[h+372>>2]=p;g[h+376>>2]=q;g[h+380>>2]=s;g[h+384>>2]=0.0;g[h+388>>2]=.707099974155426;m=c[d+8>>2]|0;r=c[m+188>>2]|0;b[h+296>>1]=b[r+4>>1]|0;b[h+298>>1]=b[r+6>>1]|0;if(!(a[d+170>>0]|0))Ou(e,c[d+12>>2]|0,h+456|0,h+392|0,h+288|0,0.0);else vz(m,c[d+12>>2]|0,h+456|0,h+392|0,h+288|0,+g[e+56>>2]);if(+g[h+292>>2]<1.0){m=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}do if(+g[h+332>>2]*+g[2688+(m<<4)>>2]+ +g[h+336>>2]*+g[2692+(m<<4)>>2]+ +g[h+340>>2]*+g[2696+(m<<4)>>2]>0.0){k=+g[h+292>>2];g[d+108>>2]=+g[d+52>>2]*k;if(!(a[d+180>>0]|0)){c[d+92>>2]=c[d+112>>2];c[d+96>>2]=c[d+116>>2];c[d+100>>2]=c[d+120>>2];c[d+104>>2]=c[d+124>>2];break}else{g[d+92>>2]=(1.0-k)*+g[d+92>>2]+k*+g[d+112>>2];g[d+96>>2]=(1.0-k)*+g[d+96>>2]+k*+g[d+116>>2];g[d+100>>2]=(1.0-k)*+g[d+100>>2]+k*+g[d+120>>2];break}}while(0);g[d+16>>2]=0.0;g[d+20>>2]=0.0}else{g[d+108>>2]=+g[d+52>>2];c[d+92>>2]=c[d+112>>2];c[d+96>>2]=c[d+116>>2];c[d+100>>2]=c[d+120>>2];c[d+104>>2]=c[d+124>>2]}if(!(a[d+171>>0]|0)){q=+g[d+172>>2];s=q>f?f:q;g[d+172>>2]=q-f;zq(d,e,+g[d+60>>2]*s,s*+g[d+64>>2],s*+g[d+68>>2])}else zq(d,e,+g[d+60>>2],+g[d+64>>2],+g[d+68>>2]);c[h+272>>2]=c[d+112>>2];c[h+276>>2]=c[d+116>>2];c[h+280>>2]=c[d+120>>2];c[h+284>>2]=c[d+124>>2];k=+g[d+16>>2];if(k<0.0)k=-k;else k=0.0;k=k*f;do if(k>0.0?(j=+g[d+24>>2],k>j):0){if((a[d+168>>0]|0)==0?(a[d+169>>0]|0)!=0:0){j=k;break}}else j=k;while(0);m=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}l=j+ +g[d+108>>2];k=+g[2688+(m<<4)>>2]*l;j=l*+g[2692+(m<<4)>>2];l=l*+g[2696+(m<<4)>>2];g[d+112>>2]=+g[d+112>>2]-k;g[d+116>>2]=+g[d+116>>2]-j;g[d+120>>2]=+g[d+120>>2]-l;n=c[d+8>>2]|0;o=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}s=+g[d+40>>2];m=h+172|0;g[m>>2]=1.0;b[h+176>>1]=1;b[h+178>>1]=-1;r=h+180|0;c[h+244>>2]=0;c[r+0>>2]=0;c[r+4>>2]=0;c[r+8>>2]=0;c[r+12>>2]=0;c[r+16>>2]=0;c[r+20>>2]=0;c[r+24>>2]=0;c[r+28>>2]=0;c[h+168>>2]=2896;c[h+248>>2]=n;c[h+252>>2]=c[2688+(o<<4)>>2];c[h+256>>2]=c[2692+(o<<4)>>2];c[h+260>>2]=c[2696+(o<<4)>>2];c[h+264>>2]=c[2700+(o<<4)>>2];g[h+268>>2]=s;o=c[d+8>>2]|0;n=c[o+188>>2]|0;b[h+176>>1]=b[n+4>>1]|0;b[h+178>>1]=b[n+6>>1]|0;n=c[d+176>>2]|0;if((a[2736]|0)==0?(Ya(2736)|0)!=0:0){g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}s=+g[d+40>>2];g[h+68>>2]=1.0;b[h+72>>1]=1;b[h+74>>1]=-1;r=h+76|0;c[h+140>>2]=0;c[r+0>>2]=0;c[r+4>>2]=0;c[r+8>>2]=0;c[r+12>>2]=0;c[r+16>>2]=0;c[r+20>>2]=0;c[r+24>>2]=0;c[r+28>>2]=0;c[h+64>>2]=2896;c[h+144>>2]=o;c[h+148>>2]=c[2688+(n<<4)>>2];c[h+152>>2]=c[2692+(n<<4)>>2];c[h+156>>2]=c[2696+(n<<4)>>2];c[h+160>>2]=c[2700+(n<<4)>>2];g[h+164>>2]=s;n=c[(c[d+8>>2]|0)+188>>2]|0;b[h+72>>1]=b[n+4>>1]|0;b[h+74>>1]=b[n+6>>1]|0;s=+g[d+112>>2];q=+g[d+116>>2];p=+g[d+120>>2];n=0;while(1){g[h+456>>2]=1.0;c[h+460>>2]=0;c[h+464>>2]=0;c[h+468>>2]=0;c[h+472>>2]=0;g[h+476>>2]=1.0;c[h+480>>2]=0;c[h+484>>2]=0;c[h+488>>2]=0;c[h+492>>2]=0;g[h+496>>2]=1.0;c[h+500>>2]=0;g[h+392>>2]=1.0;c[h+396>>2]=0;c[h+400>>2]=0;c[h+404>>2]=0;c[h+408>>2]=0;g[h+412>>2]=1.0;c[h+416>>2]=0;c[h+420>>2]=0;c[h+424>>2]=0;c[h+428>>2]=0;g[h+432>>2]=1.0;c[h+436>>2]=0;g[h+288>>2]=1.0;c[h+292>>2]=0;c[h+296>>2]=0;c[h+300>>2]=0;c[h+304>>2]=0;g[h+308>>2]=1.0;c[h+312>>2]=0;c[h+316>>2]=0;c[h+320>>2]=0;c[h+324>>2]=0;g[h+328>>2]=1.0;c[h+332>>2]=0;c[h+336>>2]=0;c[h+340>>2]=0;c[h+504>>2]=c[d+92>>2];c[h+508>>2]=c[d+96>>2];c[h+512>>2]=c[d+100>>2];c[h+516>>2]=c[d+104>>2];c[h+440>>2]=c[d+112>>2];c[h+444>>2]=c[d+116>>2];c[h+448>>2]=c[d+120>>2];c[h+452>>2]=c[d+124>>2];g[h+336>>2]=s-k;g[h+340>>2]=q-j;g[h+344>>2]=p-l;g[h+348>>2]=0.0;if(!(a[d+170>>0]|0)){Ou(e,c[d+12>>2]|0,h+456|0,h+392|0,h+168|0,+g[e+56>>2]);if(!(+g[m>>2]<1.0))Ou(e,c[d+12>>2]|0,h+456|0,h+288|0,h+64|0,+g[e+56>>2])}else{vz(c[d+8>>2]|0,c[d+12>>2]|0,h+456|0,h+392|0,h+168|0,+g[e+56>>2]);if(!(+g[m>>2]<1.0))vz(c[d+8>>2]|0,c[d+12>>2]|0,h+456|0,h+288|0,h+64|0,+g[e+56>>2])}p=+g[d+16>>2];if(p<0.0)q=-p;else q=0.0;s=q*f;o=(a[d+182>>0]|0)==0;if(!o?+g[m>>2]<1.0:0)r=1;else r=+g[h+68>>2]<1.0;if(!(s>0.0))break;q=+g[d+52>>2];if(!(s<q)|r^1|n)break;if((a[d+168>>0]|0)==0?(a[d+169>>0]|0)!=0:0){n=0;break}c[d+112>>2]=c[h+272>>2];c[d+116>>2]=c[h+276>>2];c[d+120>>2]=c[h+280>>2];c[d+124>>2]=c[h+284>>2];n=c[d+176>>2]|0;do if(!(a[2736]|0)){if(!(Ya(2736)|0))break;g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}while(0);s=q+ +g[d+108>>2];q=s*+g[2692+(n<<4)>>2];p=s*+g[2696+(n<<4)>>2];s=+g[d+112>>2]- +g[2688+(n<<4)>>2]*s;g[d+112>>2]=s;q=+g[d+116>>2]-q;g[d+116>>2]=q;p=+g[d+120>>2]-p;g[d+120>>2]=p;n=1}q=+g[m>>2];if(q<1.0|n){j=+g[d+96>>2];f=(j- +g[h+232>>2])*.5;do if(!o)if(!(a[d+181>>0]|0)){g[d+92>>2]=(1.0-f)*+g[d+92>>2]+f*+g[d+112>>2];g[d+96>>2]=(1.0-f)*j+f*+g[d+116>>2];g[d+100>>2]=(1.0-f)*+g[d+100>>2]+f*+g[d+120>>2];e=d+181|0;break}else{g[d+92>>2]=(1.0-q)*+g[d+92>>2]+q*+g[d+112>>2];g[d+96>>2]=(1.0-q)*j+q*+g[d+116>>2];g[d+100>>2]=(1.0-q)*+g[d+100>>2]+q*+g[d+120>>2];e=d+181|0;break}else{g[d+92>>2]=(1.0-q)*+g[d+92>>2]+q*+g[d+112>>2];g[d+96>>2]=(1.0-q)*j+q*+g[d+116>>2];g[d+100>>2]=(1.0-q)*+g[d+100>>2]+q*+g[d+120>>2];e=d+181|0}while(0);a[e>>0]=0;g[d+16>>2]=0.0;g[d+20>>2]=0.0;a[d+169>>0]=0}else{a[d+181>>0]=1;do if(!o){if(p<0.0)q=-p;else q=0.0;p=+g[d+24>>2];if(q*f>p){if((a[d+168>>0]|0)==0?(a[d+169>>0]|0)!=0:0)break;g[d+112>>2]=k+ +g[d+112>>2];g[d+116>>2]=j+ +g[d+116>>2];g[d+120>>2]=l+ +g[d+120>>2];e=c[d+176>>2]|0;do if(!(a[2736]|0)){if(!(Ya(2736)|0))break;g[672]=1.0;c[673]=0;c[674]=0;c[675]=0;c[676]=0;g[677]=1.0;c[678]=0;c[679]=0;c[680]=0;c[681]=0;g[682]=1.0;g[683]=0.0;bb(2736)}while(0);p=p+ +g[d+108>>2];q=p*+g[2692+(e<<4)>>2];s=p*+g[2696+(e<<4)>>2];g[d+112>>2]=+g[d+112>>2]- +g[2688+(e<<4)>>2]*p;g[d+116>>2]=+g[d+116>>2]-q;g[d+120>>2]=+g[d+120>>2]-s}}while(0);c[d+92>>2]=c[d+112>>2];c[d+96>>2]=c[d+116>>2];c[d+100>>2]=c[d+120>>2];c[d+104>>2]=c[d+124>>2]}c[h+48>>2]=c[d+92>>2];c[h+52>>2]=c[d+96>>2];c[h+56>>2]=c[d+100>>2];c[h+60>>2]=c[d+104>>2];r=c[d+8>>2]|0;c[r+260>>2]=(c[r+260>>2]|0)+1;c[r+4>>2]=c[h+0>>2];c[r+8>>2]=c[h+4>>2];c[r+12>>2]=c[h+8>>2];c[r+16>>2]=c[h+12>>2];c[r+20>>2]=c[h+16>>2];c[r+24>>2]=c[h+20>>2];c[r+28>>2]=c[h+24>>2];c[r+32>>2]=c[h+28>>2];c[r+36>>2]=c[h+32>>2];c[r+40>>2]=c[h+36>>2];c[r+44>>2]=c[h+40>>2];c[r+48>>2]=c[h+44>>2];c[r+52>>2]=c[h+48>>2];c[r+56>>2]=c[h+52>>2];c[r+60>>2]=c[h+56>>2];c[r+64>>2]=c[h+60>>2];i=h;return}function Gq(a){a=a|0;var b=0;b=i;a=Pb[c[(c[a>>2]|0)+48>>2]&127](a)|0;i=b;return a|0}function Hq(b){b=b|0;var d=0;d=i;if(!(Pb[c[(c[b>>2]|0)+40>>2]&127](b)|0)){i=d;return}g[b+16>>2]=+g[b+28>>2];a[b+169>>0]=1;i=d;return}function Iq(a){a=a|0;var b=0;b=i;if(!(+g[a+16>>2]==0.0)){a=0;i=b;return a|0}a=+g[a+20>>2]==0.0;i=b;return a|0}function Jq(a,b){a=a|0;b=b|0;return}function Kq(b,c){b=b|0;c=c|0;a[b+180>>0]=c&1;return}function Lq(a,b,d){a=a|0;b=b|0;d=+d;var e=0;e=i;Nb[c[(c[a>>2]|0)+32>>2]&127](a,b);tc[c[(c[a>>2]|0)+36>>2]&7](a,b,d);i=e;return}function Mq(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Nq(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;e=i;f=c[b>>2]|0;if((f|0)==(c[a+80>>2]|0)){k=1.0;i=e;return+k}if(c[f+204>>2]&4){k=1.0;i=e;return+k}if(d){k=+g[b+8>>2];j=+g[b+12>>2];h=+g[b+16>>2]}else{m=+g[b+8>>2];l=+g[b+12>>2];h=+g[b+16>>2];k=+g[f+4>>2]*m+ +g[f+8>>2]*l+ +g[f+12>>2]*h;j=m*+g[f+20>>2]+l*+g[f+24>>2]+h*+g[f+28>>2];h=m*+g[f+36>>2]+l*+g[f+40>>2]+h*+g[f+44>>2]}if(k*+g[a+84>>2]+j*+g[a+88>>2]+h*+g[a+92>>2]<+g[a+100>>2]){m=1.0;i=e;return+m}g[a+4>>2]=+g[b+40>>2];c[a+76>>2]=f;if(d){c[a+44>>2]=c[b+8>>2];c[a+48>>2]=c[b+12>>2];c[a+52>>2]=c[b+16>>2];c[a+56>>2]=c[b+20>>2]}else{h=+g[b+8>>2];j=+g[b+12>>2];k=+g[b+16>>2];l=h*+g[f+20>>2]+j*+g[f+24>>2]+k*+g[f+28>>2];m=h*+g[f+36>>2]+j*+g[f+40>>2]+k*+g[f+44>>2];g[a+44>>2]=+g[f+4>>2]*h+ +g[f+8>>2]*j+ +g[f+12>>2]*k;g[a+48>>2]=l;g[a+52>>2]=m;g[a+56>>2]=0.0}c[a+60>>2]=c[b+24>>2];c[a+64>>2]=c[b+28>>2];c[a+68>>2]=c[b+32>>2];c[a+72>>2]=c[b+36>>2];m=+g[b+40>>2];i=e;return+m}function Oq(a){a=a|0;var b=0,d=0,e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0;b=i;i=i+144|0;g[a+36>>2]=0.0;c[b+128>>2]=0;c[b+132>>2]=0;c[b+136>>2]=0;c[b+140>>2]=0;d=0;do{e=b+128+(d<<2)|0;g[e>>2]=1.0;h=c[a+28>>2]|0;G=+g[h+4>>2];g[b+80>>2]=G;C=+g[h+20>>2];g[b+84>>2]=C;j=+g[h+36>>2];g[b+88>>2]=j;g[b+92>>2]=0.0;F=+g[h+8>>2];g[b+96>>2]=F;B=+g[h+24>>2];g[b+100>>2]=B;u=+g[h+40>>2];g[b+104>>2]=u;g[b+108>>2]=0.0;E=+g[h+12>>2];g[b+112>>2]=E;A=+g[h+28>>2];g[b+116>>2]=A;n=+g[h+44>>2];g[b+120>>2]=n;g[b+124>>2]=0.0;f=c[a+32>>2]|0;x=+g[f+4>>2];g[b+32>>2]=x;t=+g[f+20>>2];g[b+36>>2]=t;o=+g[f+36>>2];g[b+40>>2]=o;g[b+44>>2]=0.0;w=+g[f+8>>2];g[b+48>>2]=w;s=+g[f+24>>2];g[b+52>>2]=s;m=+g[f+40>>2];g[b+56>>2]=m;g[b+60>>2]=0.0;v=+g[f+12>>2];g[b+64>>2]=v;r=+g[f+28>>2];g[b+68>>2]=r;k=+g[f+44>>2];g[b+72>>2]=k;g[b+76>>2]=0.0;y=+g[a+300>>2];q=+g[a+304>>2];l=+g[a+308>>2];D=+g[h+52>>2];z=+g[h+56>>2];p=+g[h+60>>2];g[b+16>>2]=y*G+q*F+l*E+D-D;g[b+20>>2]=y*C+q*B+l*A+z-z;g[b+24>>2]=y*j+q*u+l*n+p-p;g[b+28>>2]=0.0;p=+g[a+316>>2];n=+g[a+320>>2];l=+g[a+324>>2];u=+g[f+52>>2];q=+g[f+56>>2];j=+g[f+60>>2];g[b>>2]=p*x+n*w+l*v+u-u;g[b+4>>2]=p*t+n*s+l*r+q-q;g[b+8>>2]=p*o+n*m+l*k+j-j;g[b+12>>2]=0.0;h=c[a+28>>2]|0;Mo(a+(d*84|0)+48|0,b+80|0,b+32|0,b+16|0,b,b+128|0,h+396|0,+g[h+344>>2],f+396|0,+g[f+344>>2]);g[e>>2]=0.0;d=d+1|0}while((d|0)!=3);i=b;return}function Pq(b,d){b=b|0;d=d|0;var e=0;e=i;if(!(a[b+344>>0]|0)){c[d>>2]=3;c[d+4>>2]=3;i=e;return}else{c[d>>2]=0;c[d+4>>2]=0;i=e;return}}function Qq(a,b){a=a|0;b=b|0;var d=0,e=0,f=0.0,h=0.0,j=0,k=0,l=0,m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0;d=i;l=c[a+28>>2]|0;m=c[a+32>>2]|0;e=c[b+8>>2]|0;g[e>>2]=1.0;j=c[b+24>>2]|0;g[e+(j+1<<2)>>2]=1.0;g[e+((j<<1)+2<<2)>>2]=1.0;n=+g[a+300>>2];s=+g[a+304>>2];h=+g[a+308>>2];q=+g[l+4>>2]*n+ +g[l+8>>2]*s+ +g[l+12>>2]*h;o=n*+g[l+20>>2]+s*+g[l+24>>2]+h*+g[l+28>>2];h=n*+g[l+36>>2]+s*+g[l+40>>2]+h*+g[l+44>>2];e=c[b+12>>2]|0;g[e>>2]=0.0;g[e+4>>2]=h;g[e+8>>2]=-o;g[e+12>>2]=0.0;g[e+(j<<2)>>2]=-h;g[e+(j+1<<2)>>2]=0.0;g[e+(j+2<<2)>>2]=q;g[e+(j+3<<2)>>2]=0.0;g[e+(j<<1<<2)>>2]=o;g[e+((j<<1|1)<<2)>>2]=-q;g[e+((j<<1)+2<<2)>>2]=0.0;g[e+((j<<1)+3<<2)>>2]=0.0;e=c[b+16>>2]|0;g[e>>2]=-1.0;g[e+(j+1<<2)>>2]=-1.0;g[e+((j<<1)+2<<2)>>2]=-1.0;s=+g[a+316>>2];n=+g[a+320>>2];f=+g[a+324>>2];r=+g[m+4>>2]*s+ +g[m+8>>2]*n+ +g[m+12>>2]*f;p=s*+g[m+20>>2]+n*+g[m+24>>2]+f*+g[m+28>>2];f=s*+g[m+36>>2]+n*+g[m+40>>2]+f*+g[m+44>>2];e=c[b+20>>2]|0;g[e>>2]=0.0;g[e+4>>2]=-f;g[e+8>>2]=p;g[e+12>>2]=0.0;g[e+(j<<2)>>2]=f;g[e+(j+1<<2)>>2]=0.0;g[e+(j+2<<2)>>2]=-r;g[e+(j+3<<2)>>2]=0.0;g[e+(j<<1<<2)>>2]=-p;g[e+((j<<1|1)<<2)>>2]=r;g[e+((j<<1)+2<<2)>>2]=0.0;g[e+((j<<1)+3<<2)>>2]=0.0;j=c[a+332>>2]|0;n=+g[((j&1|0)==0?b+4|0:a+336|0)>>2]*+g[b>>2];e=c[b+24>>2]|0;k=c[b+28>>2]|0;g[k>>2]=n*(r+ +g[m+52>>2]-q- +g[l+52>>2]);g[k+(e<<2)>>2]=n*(p+ +g[m+56>>2]-o- +g[l+56>>2]);g[k+(e<<1<<2)>>2]=n*(f+ +g[m+60>>2]-h- +g[l+60>>2]);if(j&2){m=c[b+32>>2]|0;g[m>>2]=+g[a+340>>2];g[m+(e<<2)>>2]=+g[a+340>>2];g[m+(e<<1<<2)>>2]=+g[a+340>>2]}f=+g[a+356>>2];if(f>0.0){g[c[b+36>>2]>>2]=-f;g[c[b+40>>2]>>2]=f;h=+g[a+356>>2]}else h=f;if(h>0.0){g[(c[b+36>>2]|0)+(e<<2)>>2]=-f;g[(c[b+40>>2]|0)+(e<<2)>>2]=f;h=+g[a+356>>2]}if(!(h>0.0)){m=a+352|0;s=+g[m>>2];m=b+52|0;g[m>>2]=s;i=d;return}g[(c[b+36>>2]|0)+(e<<1<<2)>>2]=-f;g[(c[b+40>>2]|0)+(e<<1<<2)>>2]=f;m=a+352|0;s=+g[m>>2];m=b+52|0;g[m>>2]=s;i=d;return}function Rq(a,b,d,e){a=a|0;b=b|0;d=+d;e=e|0;var f=0;f=i;do if((e|0)==-1)if((b|0)==4|(b|0)==3){g[a+340>>2]=d;c[a+332>>2]=c[a+332>>2]|2;break}else if((b|0)==2|(b|0)==1){g[a+336>>2]=d;c[a+332>>2]=c[a+332>>2]|1;break}else break;while(0);i=f;return}function Sq(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0;d=i;do if((c|0)==-1)if((b|0)==4|(b|0)==3){e=+g[a+340>>2];break}else if((b|0)==2|(b|0)==1){e=+g[a+336>>2];break}else{e=3.4028234663852886e+38;break}else e=3.4028234663852886e+38;while(0);i=d;return+e}function Tq(a){a=a|0;return}function Uq(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Vq(a){a=a|0;return 84}function Wq(a,b,c){a=a|0;b=b|0;c=c|0;var d=0;d=i;Zr(a,b,c)|0;g[b+52>>2]=+g[a+300>>2];g[b+56>>2]=+g[a+304>>2];g[b+60>>2]=+g[a+308>>2];g[b+64>>2]=+g[a+312>>2];g[b+68>>2]=+g[a+316>>2];g[b+72>>2]=+g[a+320>>2];g[b+76>>2]=+g[a+324>>2];g[b+80>>2]=+g[a+328>>2];i=d;return 3080}function Xq(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=3912;e=c[b+496>>2]|0;if(e){if(a[b+500>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+496>>2]=0}a[b+500>>0]=1;c[b+496>>2]=0;c[b+488>>2]=0;c[b+492>>2]=0;i=d;return}function Yq(a){a=a|0;var b=0;b=i;Zq(a);gF(a);i=b;return}function Zq(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=3752;e=c[b+144>>2]|0;if(e){if(a[b+148>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+144>>2]=0}a[b+148>>0]=1;c[b+144>>2]=0;c[b+136>>2]=0;c[b+140>>2]=0;e=c[b+76>>2]|0;if(e){if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+76>>2]=0}a[b+80>>0]=1;c[b+76>>2]=0;c[b+68>>2]=0;c[b+72>>2]=0;e=c[b+56>>2]|0;if(e){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=0;c[b+48>>2]=0;c[b+52>>2]=0;e=c[b+36>>2]|0;if(e){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+28>>2]=0;c[b+32>>2]=0;e=c[b+16>>2]|0;if(!e){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}function _q(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0;f=i;i=i+64|0;a[d+84>>0]=0;c[f+0>>2]=c[b+4>>2];c[f+4>>2]=c[b+8>>2];c[f+8>>2]=c[b+12>>2];c[f+12>>2]=c[b+16>>2];c[f+16>>2]=c[b+20>>2];c[f+20>>2]=c[b+24>>2];c[f+24>>2]=c[b+28>>2];c[f+28>>2]=c[b+32>>2];c[f+32>>2]=c[b+36>>2];c[f+36>>2]=c[b+40>>2];c[f+40>>2]=c[b+44>>2];c[f+44>>2]=c[b+48>>2];c[f+48>>2]=c[b+52>>2];c[f+52>>2]=c[b+56>>2];c[f+56>>2]=c[b+60>>2];c[f+60>>2]=c[b+64>>2];if(e?(h=c[b+480>>2]|0,(h|0)!=0):0)Nb[c[(c[h>>2]|0)+8>>2]&127](h,f);w=+g[d+156>>2];u=+g[f>>2];v=+g[d+160>>2];t=+g[f+4>>2];o=+g[d+164>>2];s=+g[f+8>>2];r=+g[f+16>>2];q=+g[f+20>>2];p=+g[f+24>>2];n=+g[f+32>>2];l=+g[f+36>>2];j=+g[f+40>>2];m=w*r+v*q+o*p+ +g[f+52>>2];k=w*n+v*l+o*j+ +g[f+56>>2];g[d+36>>2]=w*u+v*t+o*s+ +g[f+48>>2];g[d+40>>2]=m;g[d+44>>2]=k;g[d+48>>2]=0.0;k=+g[d+172>>2];m=+g[d+176>>2];o=+g[d+180>>2];g[d+52>>2]=u*k+t*m+s*o;g[d+56>>2]=k*r+m*q+o*p;g[d+60>>2]=k*n+m*l+o*j;g[d+64>>2]=0.0;o=+g[d+188>>2];m=+g[d+192>>2];k=+g[d+196>>2];g[d+68>>2]=u*o+t*m+s*k;g[d+72>>2]=o*r+m*q+k*p;g[d+76>>2]=o*n+m*l+k*j;g[d+80>>2]=0.0;i=f;return}function $q(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0;e=i;_q(a,b+(c*284|0)|0,d);o=+g[b+(c*284|0)+52>>2];j=+g[b+(c*284|0)+56>>2];s=+g[b+(c*284|0)+60>>2];I=+g[b+(c*284|0)+76>>2];B=+g[b+(c*284|0)+72>>2];A=+g[b+(c*284|0)+68>>2];y=1.0/+Q(+((B*-o-A*-j)*(B*-o-A*-j)+((I*-j-B*-s)*(I*-j-B*-s)+(A*-s-I*-o)*(A*-s-I*-o))));x=(I*-j-B*-s)*y;w=y*(A*-s-I*-o);y=y*(B*-o-A*-j);f=+g[b+(c*284|0)+232>>2]*.5;m=+T(+f)/+Q(+(o*o+j*j+s*s));f=+S(+f);n=2.0/(f*f+(m*-s*m*-s+(m*-o*m*-o+m*-j*m*-j)));G=1.0-(m*-j*m*-j*n+m*-s*m*-s*n);F=m*-o*m*-j*n-f*m*-s*n;H=m*-o*m*-s*n+f*m*-j*n;D=m*-o*m*-j*n+f*m*-s*n;C=1.0-(m*-o*m*-o*n+m*-s*m*-s*n);E=m*-j*m*-s*n-f*m*-o*n;l=m*-o*m*-s*n-f*m*-j*n;f=m*-j*m*-s*n+f*m*-o*n;n=1.0-(m*-o*m*-o*n+m*-j*m*-j*n);m=+g[b+(c*284|0)+236>>2]*-.5;z=+T(+m)/+Q(+(I*I+(B*B+A*A)));m=+S(+m);t=2.0/(m*m+(I*z*I*z+(A*z*A*z+B*z*B*z)));p=1.0-(B*z*B*z*t+I*z*I*z*t);k=A*z*B*z*t-m*I*z*t;v=A*z*I*z*t+m*B*z*t;q=A*z*B*z*t+m*I*z*t;h=1.0-(A*z*A*z*t+I*z*I*z*t);u=B*z*I*z*t-m*A*z*t;r=A*z*I*z*t-m*B*z*t;m=B*z*I*z*t+m*A*z*t;t=1.0-(A*z*A*z*t+B*z*B*z*t);z=+g[b+(c*284|0)+72>>2];B=+g[b+(c*284|0)+76>>2];g[b+(c*284|0)+92>>2]=B*(G*v+F*u+H*t)+(A*(H*r+(F*q+G*p))+z*(H*m+(G*k+F*h)));g[b+(c*284|0)+96>>2]=y*(G*v+F*u+H*t)+(x*(H*r+(F*q+G*p))+w*(H*m+(G*k+F*h)));g[b+(c*284|0)+100>>2]=(G*v+F*u+H*t)*-s+((H*r+(F*q+G*p))*-o+(H*m+(G*k+F*h))*-j);g[b+(c*284|0)+104>>2]=0.0;g[b+(c*284|0)+108>>2]=B*(D*v+C*u+E*t)+(A*(E*r+(C*q+D*p))+z*(E*m+(D*k+C*h)));g[b+(c*284|0)+112>>2]=y*(D*v+C*u+E*t)+(x*(E*r+(C*q+D*p))+w*(E*m+(D*k+C*h)));g[b+(c*284|0)+116>>2]=(D*v+C*u+E*t)*-s+((E*r+(C*q+D*p))*-o+(E*m+(D*k+C*h))*-j);g[b+(c*284|0)+120>>2]=0.0;g[b+(c*284|0)+124>>2]=B*(l*v+f*u+n*t)+(A*(n*r+(f*q+l*p))+z*(n*m+(l*k+f*h)));g[b+(c*284|0)+128>>2]=y*(l*v+f*u+n*t)+(x*(n*r+(f*q+l*p))+w*(n*m+(l*k+f*h)));g[b+(c*284|0)+132>>2]=(l*v+f*u+n*t)*-s+((n*r+(f*q+l*p))*-o+(n*m+(l*k+f*h))*-j);g[b+(c*284|0)+136>>2]=0.0;j=+g[b+(c*284|0)+32>>2];h=j*+g[b+(c*284|0)+56>>2]+ +g[b+(c*284|0)+40>>2];f=j*+g[b+(c*284|0)+60>>2]+ +g[b+(c*284|0)+44>>2];g[b+(c*284|0)+140>>2]=+g[b+(c*284|0)+52>>2]*j+ +g[b+(c*284|0)+36>>2];g[b+(c*284|0)+144>>2]=h;g[b+(c*284|0)+148>>2]=f;g[b+(c*284|0)+152>>2]=0.0;i=e;return}function ar(b,d){b=b|0;d=+d;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0.0,s=0.0,t=0.0,u=0,v=0.0,w=0.0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0,F=0.0,G=0.0;e=i;i=i+112|0;h=c[b+136>>2]|0;if((h|0)>0){f=0;do{$q(c[b+116>>2]|0,c[b+144>>2]|0,f,0);f=f+1|0;h=c[b+136>>2]|0}while((f|0)<(h|0));f=b+116|0}else f=b+116|0;k=c[f>>2]|0;C=+g[k+312>>2];D=+g[k+316>>2];r=+g[k+320>>2];r=+Q(+(C*C+D*D+r*r))*3.5999999046325684;g[b+112>>2]=r;y=c[b+128>>2]|0;if(+g[k+(y<<2)+4>>2]*+g[k+312>>2]+ +g[k+(y<<2)+20>>2]*+g[k+316>>2]+ +g[k+(y<<2)+36>>2]*+g[k+320>>2]<0.0)g[b+112>>2]=r*-1.0;a:do if((h|0)>0){h=0;do{j=c[b+144>>2]|0;q=j+(h*284|0)|0;_q(k,q,0);u=j+(h*284|0)+204|0;y=j+(h*284|0)+212|0;r=+g[u>>2]+ +g[y>>2];n=j+(h*284|0)+52|0;o=j+(h*284|0)+56|0;p=j+(h*284|0)+60|0;E=j+(h*284|0)+36|0;m=j+(h*284|0)+16|0;C=r*+g[o>>2]+ +g[j+(h*284|0)+40>>2];D=r*+g[p>>2]+ +g[j+(h*284|0)+44>>2];g[j+(h*284|0)+16>>2]=+g[n>>2]*r+ +g[E>>2];l=j+(h*284|0)+20|0;g[l>>2]=C;k=j+(h*284|0)+24|0;g[k>>2]=D;g[j+(h*284|0)+28>>2]=0.0;g[e+64>>2]=-1.0;x=c[b+100>>2]|0;E=Tb[c[(c[x>>2]|0)+8>>2]&31](x,E,m,e+32|0)|0;x=j+(h*284|0)+88|0;c[x>>2]=0;do if(E){r=r*+g[e+64>>2];c[q+0>>2]=c[e+48>>2];c[q+4>>2]=c[e+52>>2];c[q+8>>2]=c[e+56>>2];c[q+12>>2]=c[e+60>>2];a[j+(h*284|0)+84>>0]=1;if((a[3736]|0)==0?(Ya(3736)|0)!=0:0){c[e+88>>2]=0;c[e+92>>2]=0;c[e+96>>2]=0;c[e+100>>2]=0;lr(3120,0.0,0,0,e+88|0);bb(3736)}c[e+72>>2]=0;c[e+76>>2]=0;c[e+80>>2]=0;c[e+84>>2]=0;mr(3120,0.0,e+72|0);c[x>>2]=3120;t=r- +g[y>>2];x=j+(h*284|0)+32|0;g[x>>2]=t;r=+g[u>>2];s=+g[j+(h*284|0)+208>>2]*.009999999776482582;if(t<r-s){g[x>>2]=r-s;t=r-s}if(t>r+s)g[x>>2]=r+s;c[m+0>>2]=c[e+32>>2];c[m+4>>2]=c[e+36>>2];c[m+8>>2]=c[e+40>>2];c[m+12>>2]=c[e+44>>2];s=+g[q>>2];r=+g[j+(h*284|0)+4>>2];t=+g[j+(h*284|0)+8>>2];v=s*+g[n>>2]+r*+g[o>>2]+t*+g[p>>2];n=c[f>>2]|0;w=+g[m>>2]- +g[n+52>>2];z=+g[l>>2]- +g[n+56>>2];C=+g[k>>2]- +g[n+60>>2];D=+g[n+332>>2];A=+g[n+336>>2];B=+g[n+328>>2];if(!(v>=-.10000000149011612)){g[j+(h*284|0)+272>>2]=-1.0/v*(r*(w*A-C*B+ +g[n+316>>2])+s*(D*C-z*A+ +g[n+312>>2])+t*(z*B-w*D+ +g[n+320>>2]));g[j+(h*284|0)+268>>2]=-1.0/v;break}else{g[j+(h*284|0)+272>>2]=0.0;g[j+(h*284|0)+268>>2]=10.0;break}}else{g[j+(h*284|0)+32>>2]=+g[u>>2];g[j+(h*284|0)+272>>2]=0.0;C=-+g[o>>2];D=-+g[p>>2];g[q>>2]=-+g[n>>2];g[j+(h*284|0)+4>>2]=C;g[j+(h*284|0)+8>>2]=D;g[j+(h*284|0)+12>>2]=0.0;g[j+(h*284|0)+268>>2]=1.0}while(0);h=h+1|0;j=c[b+136>>2]|0;k=c[f>>2]|0}while((h|0)<(j|0));r=1.0/+g[k+344>>2];if((j|0)>0){m=c[b+144>>2]|0;l=0;do{if(a[m+(l*284|0)+84>>0]|0){D=+g[m+(l*284|0)+272>>2];D=r*(+g[m+(l*284|0)+216>>2]*(+g[m+(l*284|0)+204>>2]- +g[m+(l*284|0)+32>>2])*+g[m+(l*284|0)+268>>2]-D*+g[(D<0.0?m+(l*284|0)+220|0:m+(l*284|0)+224|0)>>2]);h=m+(l*284|0)+276|0;g[h>>2]=D;if(D<0.0)g[h>>2]=0.0}else g[m+(l*284|0)+276>>2]=0.0;l=l+1|0}while((l|0)<(j|0));h=0;while(1){B=+g[m+(h*284|0)+276>>2];D=+g[m+(h*284|0)+248>>2];B=B>D?D:B;D=B*+g[m+(h*284|0)+4>>2]*d;C=B*+g[m+(h*284|0)+8>>2]*d;g[e+16>>2]=+g[m+(h*284|0)>>2]*B*d;g[e+20>>2]=D;g[e+24>>2]=C;g[e+28>>2]=0.0;C=+g[m+(h*284|0)+20>>2]- +g[k+56>>2];D=+g[m+(h*284|0)+24>>2]- +g[k+60>>2];g[e>>2]=+g[m+(h*284|0)+16>>2]- +g[k+52>>2];g[e+4>>2]=C;g[e+8>>2]=D;g[e+12>>2]=0.0;ym(k,e+16|0,e);h=h+1|0;if((h|0)>=(c[b+136>>2]|0))break a;m=c[b+144>>2]|0;k=c[f>>2]|0}}}while(0);Kb[c[(c[b>>2]|0)+20>>2]&31](b,d);h=c[b+136>>2]|0;if((h|0)<=0){i=e;return}j=c[b+144>>2]|0;f=c[f>>2]|0;k=0;do{t=+g[j+(k*284|0)+36>>2]- +g[f+52>>2];s=+g[j+(k*284|0)+40>>2]- +g[f+56>>2];w=+g[j+(k*284|0)+44>>2]- +g[f+60>>2];r=+g[f+332>>2];v=+g[f+336>>2];z=+g[f+328>>2];if(!(a[j+(k*284|0)+84>>0]|0)){r=+g[j+(k*284|0)+240>>2];E=j+(k*284|0)+236|0;g[E>>2]=r+ +g[E>>2]}else{E=c[b+128>>2]|0;G=+g[f+(E<<2)+4>>2];A=+g[f+(E<<2)+20>>2];C=+g[f+(E<<2)+36>>2];F=+g[j+(k*284|0)>>2];B=+g[j+(k*284|0)+4>>2];D=+g[j+(k*284|0)+8>>2];r=((s*z-t*r+ +g[f+320>>2])*(C-D*(G*F+A*B+C*D))+((r*w-s*v+ +g[f+312>>2])*(G-F*(G*F+A*B+C*D))+(t*v-w*z+ +g[f+316>>2])*(A-B*(G*F+A*B+C*D))))*d/+g[j+(k*284|0)+212>>2];g[j+(k*284|0)+240>>2]=r;E=j+(k*284|0)+236|0;g[E>>2]=r+ +g[E>>2]}g[j+(k*284|0)+240>>2]=r*.9900000095367432;k=k+1|0}while((k|0)<(h|0));i=e;return}function br(b,d){b=b|0;d=+d;var e=0,f=0,h=0.0,j=0,k=0,l=0,m=0,n=0,o=0,p=0.0,q=0,r=0.0,s=0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,R=0.0;e=i;i=i+384|0;j=c[b+136>>2]|0;if(!j){i=e;return}k=c[b+8>>2]|0;if((k|0)<(j|0)){if((c[b+12>>2]|0)<(j|0)){c[5004]=(c[5004]|0)+1;l=fF((j<<4|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}m=c[b+8>>2]|0;if((m|0)>0){n=0;do{s=l+(n<<4)|0;q=(c[b+16>>2]|0)+(n<<4)|0;c[s+0>>2]=c[q+0>>2];c[s+4>>2]=c[q+4>>2];c[s+8>>2]=c[q+8>>2];c[s+12>>2]=c[q+12>>2];n=n+1|0}while((n|0)!=(m|0))}m=c[b+16>>2]|0;if(m){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=l;c[b+12>>2]=j;l=b+16|0}else l=b+16|0;do{s=(c[l>>2]|0)+(k<<4)|0;c[s+0>>2]=c[e+144>>2];c[s+4>>2]=c[e+148>>2];c[s+8>>2]=c[e+152>>2];c[s+12>>2]=c[e+156>>2];k=k+1|0}while((k|0)!=(j|0))}c[b+8>>2]=j;k=c[b+28>>2]|0;if((k|0)<(j|0)){if((c[b+32>>2]|0)<(j|0)){c[5004]=(c[5004]|0)+1;l=fF((j<<4|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}n=c[b+28>>2]|0;if((n|0)>0){m=0;do{s=l+(m<<4)|0;q=(c[b+36>>2]|0)+(m<<4)|0;c[s+0>>2]=c[q+0>>2];c[s+4>>2]=c[q+4>>2];c[s+8>>2]=c[q+8>>2];c[s+12>>2]=c[q+12>>2];m=m+1|0}while((m|0)!=(n|0))}m=c[b+36>>2]|0;if(m){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=l;c[b+32>>2]=j;l=b+36|0}else l=b+36|0;do{s=(c[l>>2]|0)+(k<<4)|0;c[s+0>>2]=c[e+128>>2];c[s+4>>2]=c[e+132>>2];c[s+8>>2]=c[e+136>>2];c[s+12>>2]=c[e+140>>2];k=k+1|0}while((k|0)!=(j|0))}c[b+28>>2]=j;k=c[b+48>>2]|0;if((k|0)<(j|0)){if((c[b+52>>2]|0)<(j|0)){c[5004]=(c[5004]|0)+1;l=fF((j<<2|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}m=c[b+48>>2]|0;if((m|0)>0){n=0;do{o=l+(n<<2)|0;if(o)g[o>>2]=+g[(c[b+56>>2]|0)+(n<<2)>>2];n=n+1|0}while((n|0)!=(m|0))}m=c[b+56>>2]|0;if(m){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=l;c[b+52>>2]=j}else l=c[b+56>>2]|0;do{m=l+(k<<2)|0;if(m)g[m>>2]=0.0;k=k+1|0}while((k|0)!=(j|0))}c[b+48>>2]=j;k=c[b+68>>2]|0;if((k|0)<(j|0)){if((c[b+72>>2]|0)<(j|0)){c[5004]=(c[5004]|0)+1;l=fF((j<<2|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}n=c[b+68>>2]|0;if((n|0)>0){m=0;do{o=l+(m<<2)|0;if(o)g[o>>2]=+g[(c[b+76>>2]|0)+(m<<2)>>2];m=m+1|0}while((m|0)!=(n|0))}m=c[b+76>>2]|0;if(m){if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+76>>2]=0}a[b+80>>0]=1;c[b+76>>2]=l;c[b+72>>2]=j}else l=c[b+76>>2]|0;do{m=l+(k<<2)|0;if(m)g[m>>2]=0.0;k=k+1|0}while((k|0)!=(j|0))}c[b+68>>2]=j;m=c[b+136>>2]|0;if((m|0)<=0){i=e;return}k=c[b+76>>2]|0;l=c[b+56>>2]|0;j=0;do{g[k+(j<<2)>>2]=0.0;g[l+(j<<2)>>2]=0.0;j=j+1|0}while((j|0)<(m|0));j=0;do{k=c[b+144>>2]|0;l=c[k+(j*284|0)+88>>2]|0;if(l){m=k+(j*284|0)+92|0;c[e+80>>2]=c[m+0>>2];c[e+84>>2]=c[m+4>>2];c[e+88>>2]=c[m+8>>2];c[e+92>>2]=c[m+12>>2];m=k+(j*284|0)+108|0;c[e+96>>2]=c[m+0>>2];c[e+100>>2]=c[m+4>>2];c[e+104>>2]=c[m+8>>2];c[e+108>>2]=c[m+12>>2];m=k+(j*284|0)+124|0;c[e+112>>2]=c[m+0>>2];c[e+116>>2]=c[m+4>>2];c[e+120>>2]=c[m+8>>2];c[e+124>>2]=c[m+12>>2];m=c[b+36>>2]|0;y=c[b+120>>2]|0;p=+g[e+80+(y<<2)+16>>2];z=+g[e+80+(y<<2)+32>>2];g[m+(j<<4)>>2]=+g[e+80+(y<<2)>>2];g[m+(j<<4)+4>>2]=p;g[m+(j<<4)+8>>2]=z;g[m+(j<<4)+12>>2]=0.0;m=c[b+36>>2]|0;y=m+(j<<4)|0;z=+g[y>>2];n=k+(j*284|0)|0;p=+g[n>>2];o=m+(j<<4)+4|0;x=+g[o>>2];s=k+(j*284|0)+4|0;r=+g[s>>2];m=m+(j<<4)+8|0;u=+g[m>>2];q=k+(j*284|0)+8|0;w=+g[q>>2];t=z-p*(z*p+x*r+u*w);v=x-r*(z*p+x*r+u*w);w=u-w*(z*p+x*r+u*w);u=1.0/+Q(+(t*t+v*v+w*w));g[y>>2]=t*u;g[o>>2]=v*u;g[m>>2]=w*u;m=c[b+16>>2]|0;r=+g[s>>2];x=+g[q>>2];p=+g[n>>2];g[m+(j<<4)>>2]=r*w*u-x*v*u;g[m+(j<<4)+4>>2]=x*t*u-w*u*p;g[m+(j<<4)+8>>2]=v*u*p-r*t*u;g[m+(j<<4)+12>>2]=0.0;m=c[b+16>>2]|0;n=m+(j<<4)|0;u=+g[n>>2];q=m+(j<<4)+4|0;t=+g[q>>2];m=m+(j<<4)+8|0;r=+g[m>>2];p=1.0/+Q(+(u*u+t*t+r*r));g[n>>2]=u*p;g[q>>2]=t*p;g[m>>2]=r*p;m=c[b+116>>2]|0;q=c[b+36>>2]|0;n=q+(j<<4)|0;s=(c[b+76>>2]|0)+(j<<2)|0;p=+g[n>>2];o=q+(j<<4)+4|0;r=+g[o>>2];q=q+(j<<4)+8|0;t=+g[q>>2];if(p*p+r*r+t*t>1.100000023841858)g[s>>2]=0.0;else{z=+g[k+(j*284|0)+16>>2];r=z- +g[m+52>>2];t=+g[k+(j*284|0)+20>>2];B=t- +g[m+56>>2];x=+g[k+(j*284|0)+24>>2];D=x- +g[m+60>>2];g[e+360>>2]=r;g[e+364>>2]=B;g[e+368>>2]=D;g[e+372>>2]=0.0;z=z- +g[l+52>>2];t=t- +g[l+56>>2];x=x- +g[l+60>>2];g[e+344>>2]=z;g[e+348>>2]=t;g[e+352>>2]=x;g[e+356>>2]=0.0;p=+g[m+332>>2];E=+g[m+336>>2];A=+g[m+328>>2];v=+g[l+332>>2];C=+g[l+336>>2];u=+g[l+328>>2];w=p*D-E*B+ +g[m+312>>2]-(v*x-C*t+ +g[l+312>>2]);x=+g[m+316>>2]+(E*r-D*A)-(+g[l+316>>2]+(C*z-x*u));z=B*A-p*r+ +g[m+320>>2]-(t*u-v*z+ +g[l+320>>2]);g[e+208>>2]=+g[m+4>>2];g[e+212>>2]=+g[m+20>>2];g[e+216>>2]=+g[m+36>>2];g[e+220>>2]=0.0;g[e+224>>2]=+g[m+8>>2];g[e+228>>2]=+g[m+24>>2];g[e+232>>2]=+g[m+40>>2];g[e+236>>2]=0.0;g[e+240>>2]=+g[m+12>>2];g[e+244>>2]=+g[m+28>>2];g[e+248>>2]=+g[m+44>>2];g[e+252>>2]=0.0;g[e+160>>2]=+g[l+4>>2];g[e+164>>2]=+g[l+20>>2];g[e+168>>2]=+g[l+36>>2];g[e+172>>2]=0.0;g[e+176>>2]=+g[l+8>>2];g[e+180>>2]=+g[l+24>>2];g[e+184>>2]=+g[l+40>>2];g[e+188>>2]=0.0;g[e+192>>2]=+g[l+12>>2];g[e+196>>2]=+g[l+28>>2];g[e+200>>2]=+g[l+44>>2];g[e+204>>2]=0.0;Mo(e+256|0,e+208|0,e+160|0,e+360|0,e+344|0,n,m+396|0,+g[m+344>>2],l+396|0,+g[l+344>>2]);g[s>>2]=1.0/+g[e+336>>2]*(w*+g[n>>2]+x*+g[o>>2]+z*+g[q>>2])*-.20000000298023224}m=c[b+136>>2]|0}j=j+1|0}while((j|0)<(m|0));if((m|0)<=0){i=e;return}o=c[b+144>>2]|0;k=0;j=0;while(1){l=c[o+(j*284|0)+88>>2]|0;if(l){p=+g[o+(j*284|0)+252>>2];if(p!=0.0){l=c[b+56>>2]|0;q=l+(j<<2)|0;g[q>>2]=0.0;n=o+(j*284|0)+280|0;g[n>>2]=1.0;m=o;r=p*d}else{E=+g[o+(j*284|0)+256>>2];E=E!=0.0?E:0.0;m=c[b+116>>2]|0;q=c[b+16>>2]|0;x=+g[o+(j*284|0)+16>>2];v=+g[o+(j*284|0)+20>>2];F=+g[o+(j*284|0)+24>>2];H=+g[q+(j<<4)>>2];u=+g[q+(j<<4)+4>>2];r=+g[q+(j<<4)+8>>2];O=x- +g[m+52>>2];P=v- +g[m+56>>2];M=F- +g[m+60>>2];L=+g[m+264>>2]*(P*r-M*u)+ +g[m+280>>2]*(M*H-O*r)+(O*u-P*H)*+g[m+296>>2];R=(P*r-M*u)*+g[m+268>>2]+(M*H-O*r)*+g[m+284>>2]+(O*u-P*H)*+g[m+300>>2];N=(P*r-M*u)*+g[m+272>>2]+(M*H-O*r)*+g[m+288>>2]+(O*u-P*H)*+g[m+304>>2];C=x- +g[l+52>>2];A=v- +g[l+56>>2];t=F- +g[l+60>>2];I=(u*C-H*A)*+g[l+296>>2]+(+g[l+264>>2]*(r*A-u*t)+ +g[l+280>>2]*(H*t-r*C));K=(r*A-u*t)*+g[l+268>>2]+(H*t-r*C)*+g[l+284>>2]+(u*C-H*A)*+g[l+300>>2];J=(r*A-u*t)*+g[l+272>>2]+(H*t-r*C)*+g[l+288>>2]+(u*C-H*A)*+g[l+304>>2];x=x- +g[m+52>>2];v=v- +g[m+56>>2];F=F- +g[m+60>>2];z=+g[m+332>>2];G=+g[m+336>>2];w=+g[m+328>>2];D=+g[l+332>>2];p=+g[l+336>>2];B=+g[l+328>>2];r=-(1.0/(+g[m+344>>2]+(r*(P*L-O*R)+(H*(M*R-P*N)+u*(O*N-M*L)))+(+g[l+344>>2]+(r*(A*I-C*K)+(H*(t*K-A*J)+u*(C*J-t*I)))))*((F*z-v*G+ +g[m+312>>2]-(t*D-A*p+ +g[l+312>>2]))*H+(+g[m+316>>2]+(x*G-F*w)-(+g[l+316>>2]+(C*p-t*B)))*u+(v*w-x*z+ +g[m+320>>2]-(A*B-C*D+ +g[l+320>>2]))*r));r=E<r?E:r;m=c[b+144>>2]|0;l=c[b+56>>2]|0;q=l+(j<<2)|0;g[q>>2]=0.0;n=m+(j*284|0)+280|0;g[n>>2]=1.0;r=r<-E?-E:r}g[n>>2]=1.0;p=+g[o+(j*284|0)+276>>2]*d*+g[o+(j*284|0)+228>>2];g[q>>2]=r;r=r*.5;t=+g[(c[b+76>>2]|0)+(j<<2)>>2];if(r*r+t*t>p*p){R=p/+Q(+(r*r+t*t));g[n>>2]=R*+g[n>>2];k=1}}else{l=c[b+56>>2]|0;g[l+(j<<2)>>2]=0.0;g[o+(j*284|0)+280>>2]=1.0;m=o}j=j+1|0;n=c[b+136>>2]|0;if((j|0)>=(n|0))break;else o=m}if(k){if((n|0)<=0){i=e;return}j=c[b+76>>2]|0;k=0;do{o=j+(k<<2)|0;if(+g[o>>2]!=0.0?(f=m+(k*284|0)+280|0,h=+g[f>>2],h<1.0):0){y=l+(k<<2)|0;g[y>>2]=h*+g[y>>2];g[o>>2]=+g[f>>2]*+g[o>>2]}k=k+1|0}while((k|0)<(n|0))}if((n|0)<=0){i=e;return}n=0;while(1){o=c[b+116>>2]|0;k=m+(n*284|0)+16|0;f=m+(n*284|0)+20|0;R=+g[f>>2]- +g[o+56>>2];j=m+(n*284|0)+24|0;h=+g[j>>2]- +g[o+60>>2];g[e+64>>2]=+g[k>>2]- +g[o+52>>2];g[e+68>>2]=R;g[e+72>>2]=h;g[e+76>>2]=0.0;h=+g[l+(n<<2)>>2];if(h!=0.0){y=c[b+16>>2]|0;P=h*+g[y+(n<<4)+4>>2];R=h*+g[y+(n<<4)+8>>2];g[e+48>>2]=h*+g[y+(n<<4)>>2];g[e+52>>2]=P;g[e+56>>2]=R;g[e+60>>2]=0.0;ym(o,e+48|0,e+64|0)}h=+g[(c[b+76>>2]|0)+(n<<2)>>2];if(h!=0.0){y=c[(c[b+144>>2]|0)+(n*284|0)+88>>2]|0;L=+g[f>>2]- +g[y+56>>2];N=+g[j>>2]- +g[y+60>>2];g[e+32>>2]=+g[k>>2]- +g[y+52>>2];g[e+36>>2]=L;g[e+40>>2]=N;g[e+44>>2]=0.0;s=c[b+36>>2]|0;N=h*+g[s+(n<<4)+4>>2];L=h*+g[s+(n<<4)+8>>2];g[e+16>>2]=+g[s+(n<<4)>>2]*h;g[e+20>>2]=N;g[e+24>>2]=L;g[e+28>>2]=0.0;s=c[b+116>>2]|0;q=c[b+124>>2]|0;L=+g[s+(q<<2)+4>>2];N=+g[s+(q<<2)+20>>2];R=+g[s+(q<<2)+36>>2];K=+g[e+64>>2];M=+g[e+68>>2];O=+g[e+72>>2];P=(L*K+N*M+R*O)*(1.0- +g[m+(n*284|0)+244>>2]);g[e+64>>2]=K-L*P;g[e+68>>2]=M-N*P;g[e+72>>2]=O-R*P;ym(s,e+16|0,e+64|0);P=-+g[e+20>>2];R=-+g[e+24>>2];g[e>>2]=-+g[e+16>>2];g[e+4>>2]=P;g[e+8>>2]=R;g[e+12>>2]=0.0;ym(y,e,e+32|0)}n=n+1|0;if((n|0)>=(c[b+136>>2]|0))break;m=c[b+144>>2]|0;l=c[b+56>>2]|0}i=e;return}function cr(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0.0,k=0.0,l=0,m=0;e=i;i=i+48|0;if((c[b+136>>2]|0)<=0){i=e;return}f=0;do{m=c[b+144>>2]|0;g[e+32>>2]=(a[m+(f*284|0)+84>>0]|0)==0?1.0:0.0;g[e+36>>2]=0.0;g[e+40>>2]=1.0;g[e+44>>2]=0.0;l=m+(f*284|0)+140|0;c[e+16>>2]=c[l+0>>2];c[e+20>>2]=c[l+4>>2];c[e+24>>2]=c[l+8>>2];c[e+28>>2]=c[l+12>>2];l=c[b+120>>2]|0;h=c[(c[d>>2]|0)+8>>2]|0;k=+g[m+(f*284|0)+(l<<2)+108>>2]+ +g[e+20>>2];j=+g[m+(f*284|0)+(l<<2)+124>>2]+ +g[e+24>>2];g[e>>2]=+g[m+(f*284|0)+(l<<2)+92>>2]+ +g[e+16>>2];g[e+4>>2]=k;g[e+8>>2]=j;g[e+12>>2]=0.0;vc[h&127](d,e+16|0,e,e+32|0);vc[c[(c[d>>2]|0)+8>>2]&127](d,e+16|0,(c[b+144>>2]|0)+(f*284|0)+16|0,e+32|0);f=f+1|0}while((f|0)<(c[b+136>>2]|0));i=e;return}function dr(a,d,e,f){a=a|0;d=d|0;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0;h=i;i=i+96|0;g[h+4>>2]=1.0;c[h+8>>2]=0;b[h+12>>1]=1;b[h+14>>1]=-1;c[h+16>>2]=0;c[h>>2]=336;c[h+20>>2]=c[d+0>>2];c[h+24>>2]=c[d+4>>2];c[h+28>>2]=c[d+8>>2];c[h+32>>2]=c[d+12>>2];c[h+36>>2]=c[e+0>>2];c[h+40>>2]=c[e+4>>2];c[h+44>>2]=c[e+8>>2];c[h+48>>2]=c[e+12>>2];a=c[a+4>>2]|0;vc[c[(c[a>>2]|0)+32>>2]&127](a,d,e,h);e=c[h+8>>2]|0;if(!e){a=0;i=h;return a|0}if(!(c[e+236>>2]&2)){a=0;i=h;return a|0}if(c[e+204>>2]&4){a=0;i=h;return a|0}c[f+0>>2]=c[h+68>>2];c[f+4>>2]=c[h+72>>2];c[f+8>>2]=c[h+76>>2];c[f+12>>2]=c[h+80>>2];c[f+16>>2]=c[h+52>>2];c[f+20>>2]=c[h+56>>2];c[f+24>>2]=c[h+60>>2];c[f+28>>2]=c[h+64>>2];m=+g[f+16>>2];l=+g[f+20>>2];k=+g[f+24>>2];j=1.0/+Q(+(m*m+l*l+k*k));g[f+16>>2]=m*j;g[f+20>>2]=l*j;g[f+24>>2]=k*j;g[f+32>>2]=+g[h+4>>2];a=e;i=h;return a|0}function er(a,b,d){a=a|0;b=b|0;d=+d;b=i;Kb[c[(c[a>>2]|0)+16>>2]&31](a,d);i=b;return}function fr(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;c[a+120>>2]=b;c[a+124>>2]=d;c[a+128>>2]=e;return}function gr(a){a=a|0;return}function hr(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ir(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=3912;e=c[b+496>>2]|0;if(!e){a[b+500>>0]=1;c[b+496>>2]=0;c[b+488>>2]=0;c[b+492>>2]=0}else{if(a[b+500>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}a[b+500>>0]=1;c[b+496>>2]=0;c[b+488>>2]=0;c[b+492>>2]=0}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function jr(a,b){a=a|0;b=b|0;c[a+260>>2]=(c[a+260>>2]|0)+1;c[a+192>>2]=b;c[a+200>>2]=b;return}function kr(b,d){b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0,l=0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0;e=i;c[b+236>>2]=2;c[b+312>>2]=0;c[b+316>>2]=0;c[b+320>>2]=0;c[b+324>>2]=0;c[b+328>>2]=0;c[b+332>>2]=0;c[b+336>>2]=0;c[b+340>>2]=0;g[b+544>>2]=1.0;g[b+548>>2]=1.0;g[b+552>>2]=1.0;g[b+556>>2]=0.0;g[b+348>>2]=1.0;g[b+352>>2]=1.0;g[b+356>>2]=1.0;l=b+360|0;k=l+36|0;do{c[l>>2]=0;l=l+4|0}while((l|0)<(k|0));c[b+412>>2]=0;c[b+416>>2]=0;c[b+420>>2]=0;c[b+424>>2]=0;c[b+428>>2]=0;c[b+432>>2]=0;c[b+436>>2]=0;c[b+440>>2]=0;h=+g[d+92>>2];f=+g[d+96>>2];if(h<0.0)h=0.0;else h=h>1.0?1.0:h;g[b+444>>2]=h;if(f<0.0)f=0.0;else f=f>1.0?1.0:f;g[b+448>>2]=f;g[b+472>>2]=+g[d+112>>2];g[b+476>>2]=+g[d+116>>2];k=c[d+4>>2]|0;c[b+480>>2]=k;c[b+608>>2]=0;c[b+612>>2]=0;a[b+452>>0]=a[d+120>>0]|0;g[b+456>>2]=+g[d+124>>2];g[b+460>>2]=+g[d+128>>2];g[b+464>>2]=+g[d+132>>2];g[b+468>>2]=+g[d+136>>2];if(!k){c[b+4>>2]=c[d+8>>2];c[b+8>>2]=c[d+12>>2];c[b+12>>2]=c[d+16>>2];c[b+16>>2]=c[d+20>>2];c[b+20>>2]=c[d+24>>2];c[b+24>>2]=c[d+28>>2];c[b+28>>2]=c[d+32>>2];c[b+32>>2]=c[d+36>>2];c[b+36>>2]=c[d+40>>2];c[b+40>>2]=c[d+44>>2];c[b+44>>2]=c[d+48>>2];c[b+48>>2]=c[d+52>>2];c[b+52>>2]=c[d+56>>2];c[b+56>>2]=c[d+60>>2];c[b+60>>2]=c[d+64>>2];c[b+64>>2]=c[d+68>>2];n=b+52|0;m=b+20|0;k=b+36|0;l=b+4|0}else{Nb[c[(c[k>>2]|0)+8>>2]&127](k,b+4|0);n=b+52|0;m=b+20|0;k=b+36|0;l=b+4|0}c[b+68>>2]=c[l+0>>2];c[b+72>>2]=c[l+4>>2];c[b+76>>2]=c[l+8>>2];c[b+80>>2]=c[l+12>>2];c[b+84>>2]=c[m+0>>2];c[b+88>>2]=c[m+4>>2];c[b+92>>2]=c[m+8>>2];c[b+96>>2]=c[m+12>>2];c[b+100>>2]=c[k+0>>2];c[b+104>>2]=c[k+4>>2];c[b+108>>2]=c[k+8>>2];c[b+112>>2]=c[k+12>>2];c[b+116>>2]=c[n+0>>2];c[b+120>>2]=c[n+4>>2];c[b+124>>2]=c[n+8>>2];c[b+128>>2]=c[n+12>>2];c[b+132>>2]=0;c[b+136>>2]=0;c[b+140>>2]=0;c[b+144>>2]=0;c[b+148>>2]=0;c[b+152>>2]=0;c[b+156>>2]=0;c[b+160>>2]=0;g[b+224>>2]=+g[d+100>>2];g[b+232>>2]=+g[d+104>>2];g[b+228>>2]=+g[d+108>>2];Nb[c[(c[b>>2]|0)+12>>2]&127](b,c[d+72>>2]|0);k=c[986]|0;c[986]=k+1;c[b+508>>2]=k;h=+g[d>>2];k=c[b+204>>2]|0;if(h==0.0){c[b+204>>2]=k|1;g[b+344>>2]=0.0;f=0.0}else{c[b+204>>2]=k&-2;g[b+344>>2]=1.0/h;f=1.0/h}j=h*+g[b+384>>2];o=h*+g[b+388>>2];g[b+364>>2]=h*+g[b+380>>2];g[b+368>>2]=j;g[b+372>>2]=o;g[b+376>>2]=0.0;h=+g[d+76>>2];if(h!=0.0)h=1.0/h;else h=0.0;j=+g[d+80>>2];if(j!=0.0)j=1.0/j;else j=0.0;o=+g[d+84>>2];if(o!=0.0)o=1.0/o;else o=0.0;g[b+396>>2]=h;g[b+400>>2]=j;g[b+404>>2]=o;g[b+408>>2]=0.0;D=f*+g[b+352>>2];x=f*+g[b+356>>2];g[b+560>>2]=f*+g[b+348>>2];g[b+564>>2]=D;g[b+568>>2]=x;g[b+572>>2]=0.0;x=+g[b+4>>2];D=x*h;w=+g[b+8>>2];C=w*j;v=+g[b+12>>2];B=v*o;u=+g[b+20>>2];A=h*u;t=+g[b+24>>2];z=j*t;s=+g[b+28>>2];y=o*s;r=+g[b+36>>2];q=h*r;p=+g[b+40>>2];f=j*p;j=+g[b+44>>2];h=o*j;g[b+264>>2]=x*D+w*C+v*B;g[b+268>>2]=D*u+C*t+B*s;g[b+272>>2]=D*r+C*p+B*j;g[b+276>>2]=0.0;g[b+280>>2]=x*A+w*z+v*y;g[b+284>>2]=u*A+t*z+s*y;g[b+288>>2]=A*r+z*p+y*j;g[b+292>>2]=0.0;g[b+296>>2]=x*q+w*f+v*h;g[b+300>>2]=u*q+t*f+s*h;g[b+304>>2]=r*q+p*f+j*h;g[b+308>>2]=0.0;c[b+504>>2]=0;c[b+512>>2]=0;c[b+516>>2]=0;c[b+520>>2]=0;c[b+524>>2]=0;c[b+528>>2]=0;c[b+532>>2]=0;c[b+536>>2]=0;c[b+540>>2]=0;h=+g[b+344>>2];j=h*+g[b+352>>2];o=h*+g[b+356>>2];g[b+560>>2]=+g[b+348>>2]*h;g[b+564>>2]=j;g[b+568>>2]=o;l=b+572|0;k=l+36|0;do{c[l>>2]=0;l=l+4|0}while((l|0)<(k|0));i=e;return}function lr(b,d,e,f,h){b=b|0;d=+d;e=e|0;f=f|0;h=h|0;var j=0;j=i;i=i+144|0;g[b+164>>2]=1.0;g[b+168>>2]=1.0;g[b+172>>2]=1.0;g[b+176>>2]=0.0;c[b+180>>2]=0;g[b+184>>2]=999999984306749400.0;c[b+188>>2]=0;c[b+192>>2]=0;c[b+196>>2]=0;c[b+200>>2]=0;c[b+204>>2]=1;c[b+208>>2]=-1;c[b+212>>2]=-1;c[b+216>>2]=1;g[b+220>>2]=0.0;g[b+224>>2]=.5;g[b+228>>2]=0.0;g[b+232>>2]=0.0;c[b+236>>2]=1;c[b+240>>2]=0;g[b+244>>2]=1.0;c[b+248>>2]=0;c[b+252>>2]=0;c[b+256>>2]=0;c[b+260>>2]=0;g[b+4>>2]=1.0;c[b+8>>2]=0;c[b+12>>2]=0;c[b+16>>2]=0;c[b+20>>2]=0;g[b+24>>2]=1.0;c[b+28>>2]=0;c[b+32>>2]=0;c[b+36>>2]=0;c[b+40>>2]=0;g[b+44>>2]=1.0;c[b+48>>2]=0;c[b+52>>2]=0;c[b+56>>2]=0;c[b+60>>2]=0;c[b+64>>2]=0;c[b>>2]=3912;a[b+500>>0]=1;c[b+496>>2]=0;c[b+488>>2]=0;c[b+492>>2]=0;g[j>>2]=d;c[j+4>>2]=e;c[j+72>>2]=f;c[j+76>>2]=c[h+0>>2];c[j+80>>2]=c[h+4>>2];c[j+84>>2]=c[h+8>>2];c[j+88>>2]=c[h+12>>2];g[j+92>>2]=0.0;g[j+96>>2]=0.0;g[j+100>>2]=.5;g[j+104>>2]=0.0;g[j+108>>2]=0.0;g[j+112>>2]=.800000011920929;g[j+116>>2]=1.0;a[j+120>>0]=0;g[j+124>>2]=.004999999888241291;g[j+128>>2]=.009999999776482582;g[j+132>>2]=.009999999776482582;g[j+136>>2]=.009999999776482582;g[j+8>>2]=1.0;c[j+12>>2]=0;c[j+16>>2]=0;c[j+20>>2]=0;c[j+24>>2]=0;g[j+28>>2]=1.0;c[j+32>>2]=0;c[j+36>>2]=0;c[j+40>>2]=0;c[j+44>>2]=0;g[j+48>>2]=1.0;c[j+52>>2]=0;c[j+56>>2]=0;c[j+60>>2]=0;c[j+64>>2]=0;c[j+68>>2]=0;kr(b,j);i=j;return}function mr(a,b,d){a=a|0;b=+b;d=d|0;var e=0.0,f=0.0,h=0.0,i=0;i=c[a+204>>2]|0;if(b==0.0){c[a+204>>2]=i|1;g[a+344>>2]=0.0;e=0.0}else{c[a+204>>2]=i&-2;g[a+344>>2]=1.0/b;e=1.0/b}f=+g[a+384>>2]*b;h=+g[a+388>>2]*b;g[a+364>>2]=+g[a+380>>2]*b;g[a+368>>2]=f;g[a+372>>2]=h;g[a+376>>2]=0.0;b=+g[d>>2];if(b!=0.0)b=1.0/b;else b=0.0;f=+g[d+4>>2];if(f!=0.0)f=1.0/f;else f=0.0;h=+g[d+8>>2];if(h!=0.0)h=1.0/h;else h=0.0;g[a+396>>2]=b;g[a+400>>2]=f;g[a+404>>2]=h;g[a+408>>2]=0.0;f=e*+g[a+352>>2];h=e*+g[a+356>>2];g[a+560>>2]=+g[a+348>>2]*e;g[a+564>>2]=f;g[a+568>>2]=h;g[a+572>>2]=0.0;return}function nr(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0;j=i;if(!(c[a+204>>2]&2)){c[a+68>>2]=c[b+0>>2];c[a+72>>2]=c[b+4>>2];c[a+76>>2]=c[b+8>>2];c[a+80>>2]=c[b+12>>2];c[a+84>>2]=c[b+16>>2];c[a+88>>2]=c[b+20>>2];c[a+92>>2]=c[b+24>>2];c[a+96>>2]=c[b+28>>2];c[a+100>>2]=c[b+32>>2];c[a+104>>2]=c[b+36>>2];c[a+108>>2]=c[b+40>>2];c[a+112>>2]=c[b+44>>2];c[a+116>>2]=c[b+48>>2];c[a+120>>2]=c[b+52>>2];c[a+124>>2]=c[b+56>>2];c[a+128>>2]=c[b+60>>2];l=a+20|0;m=b+16|0;d=a+36|0;k=b+32|0;f=a+52|0;h=b+48|0;e=a+4|0}else{c[a+68>>2]=c[a+4>>2];c[a+72>>2]=c[a+8>>2];c[a+76>>2]=c[a+12>>2];c[a+80>>2]=c[a+16>>2];c[a+84>>2]=c[a+20>>2];c[a+88>>2]=c[a+24>>2];c[a+92>>2]=c[a+28>>2];c[a+96>>2]=c[a+32>>2];c[a+100>>2]=c[a+36>>2];c[a+104>>2]=c[a+40>>2];c[a+108>>2]=c[a+44>>2];c[a+112>>2]=c[a+48>>2];c[a+116>>2]=c[a+52>>2];c[a+120>>2]=c[a+56>>2];c[a+124>>2]=c[a+60>>2];c[a+128>>2]=c[a+64>>2];l=a+20|0;m=b+16|0;d=a+36|0;k=b+32|0;f=a+52|0;h=b+48|0;e=a+4|0}c[a+132>>2]=c[a+312>>2];c[a+136>>2]=c[a+316>>2];c[a+140>>2]=c[a+320>>2];c[a+144>>2]=c[a+324>>2];c[a+148>>2]=c[a+328>>2];c[a+152>>2]=c[a+332>>2];c[a+156>>2]=c[a+336>>2];c[a+160>>2]=c[a+340>>2];c[e+0>>2]=c[b+0>>2];c[e+4>>2]=c[b+4>>2];c[e+8>>2]=c[b+8>>2];c[e+12>>2]=c[b+12>>2];c[l+0>>2]=c[m+0>>2];c[l+4>>2]=c[m+4>>2];c[l+8>>2]=c[m+8>>2];c[l+12>>2]=c[m+12>>2];c[d+0>>2]=c[k+0>>2];c[d+4>>2]=c[k+4>>2];c[d+8>>2]=c[k+8>>2];c[d+12>>2]=c[k+12>>2];c[f+0>>2]=c[h+0>>2];c[f+4>>2]=c[h+4>>2];c[f+8>>2]=c[h+8>>2];c[f+12>>2]=c[h+12>>2];y=+g[a+4>>2];s=+g[a+396>>2];x=+g[a+8>>2];q=+g[a+400>>2];w=+g[a+12>>2];o=+g[a+404>>2];v=+g[a+20>>2];u=+g[a+24>>2];t=+g[a+28>>2];r=+g[a+36>>2];p=+g[a+40>>2];n=+g[a+44>>2];g[a+264>>2]=y*y*s+x*x*q+w*w*o;g[a+268>>2]=y*s*v+x*q*u+w*o*t;g[a+272>>2]=y*s*r+x*q*p+w*o*n;g[a+276>>2]=0.0;g[a+280>>2]=y*s*v+x*q*u+w*o*t;g[a+284>>2]=v*s*v+u*q*u+t*o*t;g[a+288>>2]=s*v*r+q*u*p+o*t*n;g[a+292>>2]=0.0;g[a+296>>2]=y*s*r+x*q*p+w*o*n;g[a+300>>2]=v*s*r+u*q*p+t*o*n;g[a+304>>2]=r*s*r+p*q*p+n*o*n;g[a+308>>2]=0.0;i=j;return}function or(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0;e=i;a:do if((c[d+236>>2]&2|0)!=0?(f=c[b+488>>2]|0,(f|0)>0):0){b=c[b+496>>2]|0;g=0;while(1){h=c[b+(g<<2)>>2]|0;if(a[h+20>>0]|0){if((c[h+28>>2]|0)==(d|0)){d=0;break a}if((c[h+32>>2]|0)==(d|0)){d=0;break a}}g=g+1|0;if((g|0)>=(f|0)){d=1;break}}}else d=1;while(0);i=e;return d|0}function pr(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;h=c[b+488>>2]|0;a:do if((h|0)>0){j=c[b+496>>2]|0;g=0;while(1){k=g+1|0;if((c[j+(g<<2)>>2]|0)==(d|0))break;if((k|0)<(h|0))g=k;else break a}if((g|0)!=(h|0)){k=b+256|0;c[k>>2]=1;i=e;return}}while(0);if((h|0)==(c[b+492>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[b+488>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[b+496>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[b+496>>2]|0;if(j){if(a[b+500>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[b+488>>2]|0}c[b+496>>2]=0}a[b+500>>0]=1;c[b+496>>2]=g;c[b+492>>2]=f}f=(c[b+496>>2]|0)+(h<<2)|0;if(f)c[f>>2]=d;c[b+488>>2]=h+1;k=b+256|0;c[k>>2]=1;i=e;return}function qr(a){a=a|0;return 488}function rr(a,b,e){a=a|0;b=b|0;e=e|0;var f=0;f=i;pu(a,b,e)|0;g[b+256>>2]=+g[a+264>>2];g[b+260>>2]=+g[a+268>>2];g[b+264>>2]=+g[a+272>>2];g[b+268>>2]=+g[a+276>>2];g[b+272>>2]=+g[a+280>>2];g[b+276>>2]=+g[a+284>>2];g[b+280>>2]=+g[a+288>>2];g[b+284>>2]=+g[a+292>>2];g[b+288>>2]=+g[a+296>>2];g[b+292>>2]=+g[a+300>>2];g[b+296>>2]=+g[a+304>>2];g[b+300>>2]=+g[a+308>>2];g[b+304>>2]=+g[a+312>>2];g[b+308>>2]=+g[a+316>>2];g[b+312>>2]=+g[a+320>>2];g[b+316>>2]=+g[a+324>>2];g[b+320>>2]=+g[a+328>>2];g[b+324>>2]=+g[a+332>>2];g[b+328>>2]=+g[a+336>>2];g[b+332>>2]=+g[a+340>>2];g[b+448>>2]=+g[a+344>>2];g[b+336>>2]=+g[a+544>>2];g[b+340>>2]=+g[a+548>>2];g[b+344>>2]=+g[a+552>>2];g[b+348>>2]=+g[a+556>>2];g[b+352>>2]=+g[a+348>>2];g[b+356>>2]=+g[a+352>>2];g[b+360>>2]=+g[a+356>>2];g[b+364>>2]=+g[a+360>>2];g[b+368>>2]=+g[a+364>>2];g[b+372>>2]=+g[a+368>>2];g[b+376>>2]=+g[a+372>>2];g[b+380>>2]=+g[a+376>>2];g[b+384>>2]=+g[a+380>>2];g[b+388>>2]=+g[a+384>>2];g[b+392>>2]=+g[a+388>>2];g[b+396>>2]=+g[a+392>>2];g[b+400>>2]=+g[a+396>>2];g[b+404>>2]=+g[a+400>>2];g[b+408>>2]=+g[a+404>>2];g[b+412>>2]=+g[a+408>>2];g[b+416>>2]=+g[a+412>>2];g[b+420>>2]=+g[a+416>>2];g[b+424>>2]=+g[a+420>>2];g[b+428>>2]=+g[a+424>>2];g[b+432>>2]=+g[a+428>>2];g[b+436>>2]=+g[a+432>>2];g[b+440>>2]=+g[a+436>>2];g[b+444>>2]=+g[a+440>>2];g[b+452>>2]=+g[a+444>>2];g[b+456>>2]=+g[a+448>>2];c[b+484>>2]=d[a+452>>0];g[b+460>>2]=+g[a+456>>2];g[b+464>>2]=+g[a+460>>2];g[b+468>>2]=+g[a+464>>2];g[b+472>>2]=+g[a+468>>2];g[b+476>>2]=+g[a+472>>2];g[b+480>>2]=+g[a+476>>2];i=f;return 3952}function sr(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;e=c[(c[b>>2]|0)+16>>2]|0;f=Pb[c[(c[a>>2]|0)+16>>2]&127](a)|0;f=Yb[e&31](b,f,1)|0;e=Yb[c[(c[a>>2]|0)+20>>2]&31](a,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,e,1497645650,a);i=d;return}function tr(a){a=a|0;var b=0;b=i;ur(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function ur(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=4024;e=c[b+176>>2]|0;if(e){if(a[b+180>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+176>>2]=0}a[b+180>>0]=1;c[b+176>>2]=0;c[b+168>>2]=0;c[b+172>>2]=0;e=c[b+156>>2]|0;if(e){if(a[b+160>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+156>>2]=0}a[b+160>>0]=1;c[b+156>>2]=0;c[b+148>>2]=0;c[b+152>>2]=0;e=c[b+136>>2]|0;if(e){if(a[b+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+136>>2]=0}a[b+140>>0]=1;c[b+136>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;e=c[b+116>>2]|0;if(e){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=0;c[b+108>>2]=0;c[b+112>>2]=0;e=c[b+96>>2]|0;if(e){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=0;c[b+88>>2]=0;c[b+92>>2]=0;e=c[b+76>>2]|0;if(e){if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+76>>2]=0}a[b+80>>0]=1;c[b+76>>2]=0;c[b+68>>2]=0;c[b+72>>2]=0;e=c[b+56>>2]|0;if(e){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=0;c[b+48>>2]=0;c[b+52>>2]=0;e=c[b+36>>2]|0;if(e){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+28>>2]=0;c[b+32>>2]=0;e=c[b+16>>2]|0;if(!e){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}function vr(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0,m=0.0;j=i;k=+g[d+100>>2];h=+g[d+16>>2];e=+g[d+20>>2];f=+g[d+24>>2];l=+g[d+108>>2];l=+g[d+112>>2]-k*+g[d+116>>2]-(h*+g[a+64>>2]+e*+g[a+68>>2]+f*+g[a+72>>2]+(+g[d>>2]*+g[a+80>>2]+ +g[d+4>>2]*+g[a+84>>2]+ +g[d+8>>2]*+g[a+88>>2]))*l-l*(+g[d+48>>2]*+g[b+64>>2]+ +g[d+52>>2]*+g[b+68>>2]+ +g[d+56>>2]*+g[b+72>>2]+(+g[d+32>>2]*+g[b+80>>2]+ +g[d+36>>2]*+g[b+84>>2]+ +g[d+40>>2]*+g[b+88>>2]));m=+g[d+120>>2];do if(!(k+l<m)){m=+g[d+124>>2];if(k+l>m){g[d+100>>2]=m;l=m-k;break}else{g[d+100>>2]=k+l;break}}else{g[d+100>>2]=m;l=m-k}while(0);if(c[a+240>>2]|0){m=l*+g[a+132>>2]*e*+g[a+116>>2];k=l*+g[a+136>>2]*f*+g[a+120>>2];g[a+64>>2]=+g[a+112>>2]*l*+g[a+128>>2]*h+ +g[a+64>>2];g[a+68>>2]=m+ +g[a+68>>2];g[a+72>>2]=k+ +g[a+72>>2];k=l*+g[a+100>>2]*+g[d+68>>2];m=l*+g[a+104>>2]*+g[d+72>>2];g[a+80>>2]=l*+g[a+96>>2]*+g[d+64>>2]+ +g[a+80>>2];g[a+84>>2]=k+ +g[a+84>>2];g[a+88>>2]=m+ +g[a+88>>2]}if(!(c[b+240>>2]|0)){i=j;return}m=l*+g[b+132>>2]*+g[d+52>>2]*+g[b+116>>2];k=l*+g[b+136>>2]*+g[d+56>>2]*+g[b+120>>2];g[b+64>>2]=+g[b+112>>2]*l*+g[b+128>>2]*+g[d+48>>2]+ +g[b+64>>2];g[b+68>>2]=m+ +g[b+68>>2];g[b+72>>2]=k+ +g[b+72>>2];k=l*+g[b+100>>2]*+g[d+84>>2];m=l*+g[b+104>>2]*+g[d+88>>2];g[b+80>>2]=l*+g[b+96>>2]*+g[d+80>>2]+ +g[b+80>>2];g[b+84>>2]=k+ +g[b+84>>2];g[b+88>>2]=m+ +g[b+88>>2];i=j;return}function wr(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0,m=0.0,n=0.0;j=i;m=+g[d+100>>2];h=+g[d+16>>2];e=+g[d+20>>2];f=+g[d+24>>2];n=+g[d+108>>2];n=+g[d+112>>2]-m*+g[d+116>>2]-(h*+g[a+64>>2]+e*+g[a+68>>2]+f*+g[a+72>>2]+(+g[d>>2]*+g[a+80>>2]+ +g[d+4>>2]*+g[a+84>>2]+ +g[d+8>>2]*+g[a+88>>2]))*n-n*(+g[d+48>>2]*+g[b+64>>2]+ +g[d+52>>2]*+g[b+68>>2]+ +g[d+56>>2]*+g[b+72>>2]+(+g[d+32>>2]*+g[b+80>>2]+ +g[d+36>>2]*+g[b+84>>2]+ +g[d+40>>2]*+g[b+88>>2]));l=+g[d+120>>2];if(m+n<l)k=l-m;else{k=n;l=m+n}g[d+100>>2]=l;if(c[a+240>>2]|0){n=k*+g[a+132>>2]*e*+g[a+116>>2];m=k*+g[a+136>>2]*f*+g[a+120>>2];g[a+64>>2]=+g[a+112>>2]*k*+g[a+128>>2]*h+ +g[a+64>>2];g[a+68>>2]=n+ +g[a+68>>2];g[a+72>>2]=m+ +g[a+72>>2];m=k*+g[a+100>>2]*+g[d+68>>2];n=k*+g[a+104>>2]*+g[d+72>>2];g[a+80>>2]=k*+g[a+96>>2]*+g[d+64>>2]+ +g[a+80>>2];g[a+84>>2]=m+ +g[a+84>>2];g[a+88>>2]=n+ +g[a+88>>2]}if(!(c[b+240>>2]|0)){i=j;return}n=k*+g[b+132>>2]*+g[d+52>>2]*+g[b+116>>2];m=k*+g[b+136>>2]*+g[d+56>>2]*+g[b+120>>2];g[b+64>>2]=+g[b+112>>2]*k*+g[b+128>>2]*+g[d+48>>2]+ +g[b+64>>2];g[b+68>>2]=n+ +g[b+68>>2];g[b+72>>2]=m+ +g[b+72>>2];m=k*+g[b+100>>2]*+g[d+84>>2];n=k*+g[b+104>>2]*+g[d+88>>2];g[b+80>>2]=k*+g[b+96>>2]*+g[d+80>>2]+ +g[b+80>>2];g[b+84>>2]=m+ +g[b+84>>2];g[b+88>>2]=n+ +g[b+88>>2];i=j;return}function xr(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0,m=0.0,n=0.0;j=i;l=+g[d+128>>2];if(!(l!=0.0)){i=j;return}c[1002]=(c[1002]|0)+1;k=+g[d+96>>2];f=+g[d+16>>2];h=+g[d+20>>2];e=+g[d+24>>2];n=+g[d+108>>2];n=l-k*+g[d+116>>2]-(f*+g[a+144>>2]+h*+g[a+148>>2]+e*+g[a+152>>2]+(+g[d>>2]*+g[a+160>>2]+ +g[d+4>>2]*+g[a+164>>2]+ +g[d+8>>2]*+g[a+168>>2]))*n-n*(+g[d+48>>2]*+g[b+144>>2]+ +g[d+52>>2]*+g[b+148>>2]+ +g[d+56>>2]*+g[b+152>>2]+(+g[d+32>>2]*+g[b+160>>2]+ +g[d+36>>2]*+g[b+164>>2]+ +g[d+40>>2]*+g[b+168>>2]));m=+g[d+120>>2];if(k+n<m)l=m-k;else{l=n;m=k+n}g[d+96>>2]=m;if(c[a+240>>2]|0){n=l*+g[a+132>>2]*h*+g[a+116>>2];m=l*+g[a+136>>2]*e*+g[a+120>>2];g[a+144>>2]=+g[a+112>>2]*l*+g[a+128>>2]*f+ +g[a+144>>2];g[a+148>>2]=n+ +g[a+148>>2];g[a+152>>2]=m+ +g[a+152>>2];m=l*+g[a+100>>2]*+g[d+68>>2];n=l*+g[a+104>>2]*+g[d+72>>2];g[a+160>>2]=l*+g[a+96>>2]*+g[d+64>>2]+ +g[a+160>>2];g[a+164>>2]=m+ +g[a+164>>2];g[a+168>>2]=n+ +g[a+168>>2]}if(!(c[b+240>>2]|0)){i=j;return}n=l*+g[b+132>>2]*+g[d+52>>2]*+g[b+116>>2];m=l*+g[b+136>>2]*+g[d+56>>2]*+g[b+120>>2];g[b+144>>2]=+g[b+112>>2]*l*+g[b+128>>2]*+g[d+48>>2]+ +g[b+144>>2];g[b+148>>2]=n+ +g[b+148>>2];g[b+152>>2]=m+ +g[b+152>>2];m=l*+g[b+100>>2]*+g[d+84>>2];n=l*+g[b+104>>2]*+g[d+88>>2];g[b+160>>2]=l*+g[b+96>>2]*+g[d+80>>2]+ +g[b+160>>2];g[b+164>>2]=m+ +g[b+164>>2];g[b+168>>2]=n+ +g[b+168>>2];i=j;return}function yr(a,b,d){a=a|0;b=b|0;d=+d;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0,o=0;e=i;if(!((b|0)!=0?(c[b+236>>2]&2|0)!=0:0))b=0;f=(b|0)==0;c[a+64>>2]=0;c[a+68>>2]=0;c[a+72>>2]=0;c[a+76>>2]=0;c[a+80>>2]=0;c[a+84>>2]=0;c[a+88>>2]=0;c[a+92>>2]=0;c[a+144>>2]=0;c[a+148>>2]=0;c[a+152>>2]=0;c[a+156>>2]=0;c[a+160>>2]=0;c[a+164>>2]=0;c[a+168>>2]=0;c[a+172>>2]=0;if(f){g[a>>2]=1.0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;c[a+16>>2]=0;g[a+20>>2]=1.0;c[a+24>>2]=0;c[a+28>>2]=0;c[a+32>>2]=0;c[a+36>>2]=0;g[a+40>>2]=1.0;c[a+44>>2]=0;c[a+48>>2]=0;c[a+52>>2]=0;c[a+56>>2]=0;c[a+60>>2]=0;c[a+240>>2]=0;c[a+128>>2]=0;c[a+132>>2]=0;c[a+136>>2]=0;c[a+140>>2]=0;g[a+96>>2]=1.0;g[a+100>>2]=1.0;g[a+104>>2]=1.0;g[a+108>>2]=0.0;g[a+112>>2]=1.0;g[a+116>>2]=1.0;g[a+120>>2]=1.0;g[a+124>>2]=0.0;b=a+176|0;a=b+64|0;do{c[b>>2]=0;b=b+4|0}while((b|0)<(a|0));i=e;return}else{f=b+4|0;c[a+0>>2]=c[f+0>>2];c[a+4>>2]=c[f+4>>2];c[a+8>>2]=c[f+8>>2];c[a+12>>2]=c[f+12>>2];f=b+20|0;c[a+16>>2]=c[f+0>>2];c[a+20>>2]=c[f+4>>2];c[a+24>>2]=c[f+8>>2];c[a+28>>2]=c[f+12>>2];f=b+36|0;c[a+32>>2]=c[f+0>>2];c[a+36>>2]=c[f+4>>2];c[a+40>>2]=c[f+8>>2];c[a+44>>2]=c[f+12>>2];f=b+52|0;c[a+48>>2]=c[f+0>>2];c[a+52>>2]=c[f+4>>2];c[a+56>>2]=c[f+8>>2];c[a+60>>2]=c[f+12>>2];f=b+344|0;m=+g[f>>2];n=b+348|0;l=m*+g[b+352>>2];k=m*+g[b+356>>2];g[a+128>>2]=m*+g[n>>2];g[a+132>>2]=l;g[a+136>>2]=k;g[a+140>>2]=0.0;c[a+240>>2]=b;o=b+544|0;c[a+96>>2]=c[o+0>>2];c[a+100>>2]=c[o+4>>2];c[a+104>>2]=c[o+8>>2];c[a+108>>2]=c[o+12>>2];c[a+112>>2]=c[n+0>>2];c[a+116>>2]=c[n+4>>2];c[a+120>>2]=c[n+8>>2];c[a+124>>2]=c[n+12>>2];n=b+312|0;c[a+176>>2]=c[n+0>>2];c[a+180>>2]=c[n+4>>2];c[a+184>>2]=c[n+8>>2];c[a+188>>2]=c[n+12>>2];n=b+328|0;c[a+192>>2]=c[n+0>>2];c[a+196>>2]=c[n+4>>2];c[a+200>>2]=c[n+8>>2];c[a+204>>2]=c[n+12>>2];k=+g[f>>2];l=k*+g[b+416>>2]*d;m=k*+g[b+420>>2]*d;g[a+208>>2]=k*+g[b+412>>2]*d;g[a+212>>2]=l;g[a+216>>2]=m;g[a+220>>2]=0.0;m=+g[b+428>>2];l=+g[b+432>>2];k=+g[b+436>>2];j=(m*+g[b+268>>2]+l*+g[b+284>>2]+k*+g[b+300>>2])*d;h=(m*+g[b+272>>2]+l*+g[b+288>>2]+k*+g[b+304>>2])*d;g[a+224>>2]=(+g[b+264>>2]*m+ +g[b+280>>2]*l+ +g[b+296>>2]*k)*d;g[a+228>>2]=j;g[a+232>>2]=h;g[a+236>>2]=0.0;i=e;return}}function zr(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0;d=i;if(!a){i=d;return}if(!(c[a+180>>2]&1)){i=d;return}r=+g[a+4>>2];t=+g[b>>2];o=+g[a+20>>2];s=+g[b+4>>2];l=+g[a+36>>2];e=+g[b+8>>2];q=+g[a+8>>2];n=+g[a+24>>2];j=+g[a+40>>2];p=+g[a+12>>2];m=+g[a+28>>2];f=+g[a+44>>2];k=(r*t+o*s+l*e)*+g[a+164>>2];h=(t*q+s*n+e*j)*+g[a+168>>2];e=(t*p+s*m+e*f)*+g[a+172>>2];g[b>>2]=r*k+q*h+p*e;g[b+4>>2]=o*k+n*h+m*e;g[b+8>>2]=l*k+j*h+f*e;g[b+12>>2]=0.0;i=d;return}function Ar(b,d,e,f,h,j,k,l,m,n,o){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=+m;n=+n;o=+o;var p=0,q=0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0,F=0,G=0.0,H=0.0,I=0.0;q=i;p=c[b+68>>2]|0;if((p|0)==(c[b+72>>2]|0)?(r=(p|0)==0?1:p<<1,(p|0)<(r|0)):0){if(!r){x=0;F=p}else{c[5004]=(c[5004]|0)+1;x=fF((r*152|3)+16|0)|0;if(!x)x=0;else{c[(x+19&-16)+ -4>>2]=x;x=x+19&-16}F=c[b+68>>2]|0}if((F|0)>0){E=0;do{mF(x+(E*152|0)|0,(c[b+76>>2]|0)+(E*152|0)|0,152)|0;E=E+1|0}while((E|0)!=(F|0))}E=c[b+76>>2]|0;if(E){if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[E+ -4>>2]|0)}c[b+76>>2]=0}a[b+80>>0]=1;c[b+76>>2]=x;c[b+72>>2]=r;r=c[b+68>>2]|0}else r=p;c[b+68>>2]=r+1;r=c[b+76>>2]|0;c[r+(p*152|0)+140>>2]=h;h=c[b+16>>2]|0;x=c[h+(e*244|0)+240>>2]|0;b=c[h+(f*244|0)+240>>2]|0;c[r+(p*152|0)+144>>2]=e;c[r+(p*152|0)+148>>2]=f;v=+g[j+84>>2];g[r+(p*152|0)+104>>2]=v;c[r+(p*152|0)+132>>2]=0;g[r+(p*152|0)+100>>2]=0.0;g[r+(p*152|0)+96>>2]=0.0;if(x){c[r+(p*152|0)+16>>2]=c[d+0>>2];c[r+(p*152|0)+20>>2]=c[d+4>>2];c[r+(p*152|0)+24>>2]=c[d+8>>2];c[r+(p*152|0)+28>>2]=c[d+12>>2];B=+g[k+4>>2];C=+g[r+(p*152|0)+24>>2];D=+g[k+8>>2];w=+g[r+(p*152|0)+20>>2];y=+g[r+(p*152|0)+16>>2];u=+g[k>>2];g[r+(p*152|0)>>2]=B*C-D*w;g[r+(p*152|0)+4>>2]=D*y-C*u;g[r+(p*152|0)+8>>2]=w*u-B*y;g[r+(p*152|0)+12>>2]=0.0;z=((B*C-D*w)*+g[x+280>>2]+(D*y-C*u)*+g[x+284>>2]+(w*u-B*y)*+g[x+288>>2])*+g[x+548>>2];A=((B*C-D*w)*+g[x+296>>2]+(D*y-C*u)*+g[x+300>>2]+(w*u-B*y)*+g[x+304>>2])*+g[x+552>>2];g[r+(p*152|0)+64>>2]=((B*C-D*w)*+g[x+264>>2]+ +g[x+268>>2]*(D*y-C*u)+(w*u-B*y)*+g[x+272>>2])*+g[x+544>>2];g[r+(p*152|0)+68>>2]=z;g[r+(p*152|0)+72>>2]=A;g[r+(p*152|0)+76>>2]=0.0;w=B*C-D*w}else{c[r+(p*152|0)+64>>2]=0;c[r+(p*152|0)+68>>2]=0;c[r+(p*152|0)+72>>2]=0;c[r+(p*152|0)+76>>2]=0;c[r+(p*152|0)+0>>2]=0;c[r+(p*152|0)+4>>2]=0;c[r+(p*152|0)+8>>2]=0;c[r+(p*152|0)+12>>2]=0;c[r+(p*152|0)+16>>2]=0;c[r+(p*152|0)+20>>2]=0;c[r+(p*152|0)+24>>2]=0;c[r+(p*152|0)+28>>2]=0;w=0.0}if(b){u=-+g[d>>2];C=-+g[d+4>>2];s=-+g[d+8>>2];g[r+(p*152|0)+48>>2]=u;g[r+(p*152|0)+52>>2]=C;g[r+(p*152|0)+56>>2]=s;g[r+(p*152|0)+60>>2]=0.0;D=+g[l+4>>2];G=+g[l+8>>2];A=+g[l>>2];g[r+(p*152|0)+32>>2]=D*s-G*C;g[r+(p*152|0)+36>>2]=G*u-A*s;g[r+(p*152|0)+40>>2]=A*C-D*u;g[r+(p*152|0)+44>>2]=0.0;B=((D*s-G*C)*+g[b+264>>2]+ +g[b+268>>2]*(G*u-A*s)+(A*C-D*u)*+g[b+272>>2])*+g[b+544>>2];z=((D*s-G*C)*+g[b+280>>2]+(G*u-A*s)*+g[b+284>>2]+(A*C-D*u)*+g[b+288>>2])*+g[b+548>>2];y=((D*s-G*C)*+g[b+296>>2]+(G*u-A*s)*+g[b+300>>2]+(A*C-D*u)*+g[b+304>>2])*+g[b+552>>2];g[r+(p*152|0)+80>>2]=B;g[r+(p*152|0)+84>>2]=z;g[r+(p*152|0)+88>>2]=y;g[r+(p*152|0)+92>>2]=0.0;t=D*s-G*C;s=G*u-A*s;u=A*C-D*u}else{c[r+(p*152|0)+80>>2]=0;c[r+(p*152|0)+84>>2]=0;c[r+(p*152|0)+88>>2]=0;c[r+(p*152|0)+92>>2]=0;c[r+(p*152|0)+32>>2]=0;c[r+(p*152|0)+36>>2]=0;c[r+(p*152|0)+40>>2]=0;c[r+(p*152|0)+44>>2]=0;c[r+(p*152|0)+48>>2]=0;c[r+(p*152|0)+52>>2]=0;c[r+(p*152|0)+56>>2]=0;c[r+(p*152|0)+60>>2]=0;B=0.0;z=0.0;y=0.0;t=0.0;s=0.0;u=0.0}if(x){G=+g[r+(p*152|0)+68>>2];H=+g[k+8>>2];I=+g[r+(p*152|0)+72>>2];C=+g[k+4>>2];A=+g[k>>2];D=+g[r+(p*152|0)+64>>2];A=+g[x+344>>2]+((G*H-I*C)*+g[d>>2]+(I*A-H*D)*+g[d+4>>2]+(C*D-G*A)*+g[d+8>>2])}else A=0.0;if(b){H=-B;I=-z;C=-y;D=+g[l+8>>2];G=+g[l+4>>2];y=+g[l>>2];y=+g[b+344>>2]+((D*I-G*C)*+g[d>>2]+(y*C-D*H)*+g[d+4>>2]+(G*H-y*I)*+g[d+8>>2])}else y=0.0;m=m/(A+y);g[r+(p*152|0)+108>>2]=m;if(x){z=+g[h+(e*244|0)+176>>2]+ +g[h+(e*244|0)+208>>2];y=+g[h+(e*244|0)+180>>2]+ +g[h+(e*244|0)+212>>2];A=+g[h+(e*244|0)+184>>2]+ +g[h+(e*244|0)+216>>2]}else{z=0.0;y=0.0;A=0.0}if(x){B=+g[h+(e*244|0)+192>>2];C=+g[h+(e*244|0)+196>>2];D=+g[h+(e*244|0)+200>>2]}else{B=0.0;C=0.0;D=0.0}w=z*+g[r+(p*152|0)+16>>2]+y*+g[r+(p*152|0)+20>>2]+A*+g[r+(p*152|0)+24>>2]+(B*w+C*+g[r+(p*152|0)+4>>2]+D*+g[r+(p*152|0)+8>>2]);if(b){y=+g[h+(f*244|0)+176>>2]+ +g[h+(f*244|0)+208>>2];A=+g[h+(f*244|0)+180>>2]+ +g[h+(f*244|0)+212>>2];z=+g[h+(f*244|0)+184>>2]+ +g[h+(f*244|0)+216>>2]}else{y=0.0;A=0.0;z=0.0}y=y*+g[r+(p*152|0)+48>>2]+A*+g[r+(p*152|0)+52>>2]+z*+g[r+(p*152|0)+56>>2];if(!b){G=0.0;H=0.0;I=0.0;G=G*t;H=H*s;H=G+H;I=I*u;I=H+I;I=y+I;I=w+I;I=n-I;I=m*I;F=r+(p*152|0)+112|0;g[F>>2]=I;F=r+(p*152|0)+116|0;g[F>>2]=o;I=-v;F=r+(p*152|0)+120|0;g[F>>2]=I;F=r+(p*152|0)+124|0;g[F>>2]=v;i=q;return}G=+g[h+(f*244|0)+192>>2];H=+g[h+(f*244|0)+196>>2];I=+g[h+(f*244|0)+200>>2];G=G*t;H=H*s;H=G+H;I=I*u;I=H+I;I=y+I;I=w+I;I=n-I;I=m*I;F=r+(p*152|0)+112|0;g[F>>2]=I;F=r+(p*152|0)+116|0;g[F>>2]=o;I=-v;F=r+(p*152|0)+120|0;g[F>>2]=I;F=r+(p*152|0)+124|0;g[F>>2]=v;i=q;return}function Br(b,d,e,f,h,j){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0,m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0,C=0;l=i;k=c[b+88>>2]|0;if((k|0)==(c[b+92>>2]|0)?(m=(k|0)==0?1:k<<1,(k|0)<(m|0)):0){if(!m){u=0;B=k}else{c[5004]=(c[5004]|0)+1;u=fF((m*152|3)+16|0)|0;if(!u)u=0;else{c[(u+19&-16)+ -4>>2]=u;u=u+19&-16}B=c[b+88>>2]|0}if((B|0)>0){C=0;do{mF(u+(C*152|0)|0,(c[b+96>>2]|0)+(C*152|0)|0,152)|0;C=C+1|0}while((C|0)!=(B|0))}B=c[b+96>>2]|0;if(B){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[B+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=u;c[b+92>>2]=m;m=c[b+88>>2]|0}else m=k;c[b+88>>2]=m+1;m=c[b+96>>2]|0;c[m+(k*152|0)+140>>2]=h;c[m+(k*152|0)+16>>2]=0;c[m+(k*152|0)+20>>2]=0;c[m+(k*152|0)+24>>2]=0;c[m+(k*152|0)+28>>2]=0;g[m+(k*152|0)+48>>2]=-0.0;g[m+(k*152|0)+52>>2]=-0.0;g[m+(k*152|0)+56>>2]=-0.0;g[m+(k*152|0)+60>>2]=0.0;b=c[b+16>>2]|0;u=c[b+(e*244|0)+240>>2]|0;h=c[b+(f*244|0)+240>>2]|0;c[m+(k*152|0)+144>>2]=e;c[m+(k*152|0)+148>>2]=f;n=+g[j+88>>2];g[m+(k*152|0)+104>>2]=n;c[m+(k*152|0)+132>>2]=0;g[m+(k*152|0)+100>>2]=0.0;g[m+(k*152|0)+96>>2]=0.0;o=-+g[d>>2];p=-+g[d+4>>2];q=-+g[d+8>>2];g[m+(k*152|0)>>2]=o;g[m+(k*152|0)+4>>2]=p;g[m+(k*152|0)+8>>2]=q;g[m+(k*152|0)+12>>2]=0.0;if(u){s=(+g[u+264>>2]*o+ +g[u+268>>2]*p+ +g[u+272>>2]*q)*+g[u+544>>2];r=(+g[u+280>>2]*o+ +g[u+284>>2]*p+ +g[u+288>>2]*q)*+g[u+548>>2];t=(+g[u+296>>2]*o+ +g[u+300>>2]*p+ +g[u+304>>2]*q)*+g[u+552>>2]}else{s=0.0;r=0.0;t=0.0}g[m+(k*152|0)+64>>2]=s;g[m+(k*152|0)+68>>2]=r;g[m+(k*152|0)+72>>2]=t;g[m+(k*152|0)+76>>2]=0.0;t=+g[d>>2];s=+g[d+4>>2];r=+g[d+8>>2];A=+g[d+12>>2];g[m+(k*152|0)+32>>2]=t;g[m+(k*152|0)+36>>2]=s;g[m+(k*152|0)+40>>2]=r;g[m+(k*152|0)+44>>2]=A;if(h){w=(t*+g[h+264>>2]+s*+g[h+268>>2]+r*+g[h+272>>2])*+g[h+544>>2];v=(t*+g[h+280>>2]+s*+g[h+284>>2]+r*+g[h+288>>2])*+g[h+548>>2];x=(t*+g[h+296>>2]+s*+g[h+300>>2]+r*+g[h+304>>2])*+g[h+552>>2]}else{w=0.0;v=0.0;x=0.0}g[m+(k*152|0)+80>>2]=w;g[m+(k*152|0)+84>>2]=v;g[m+(k*152|0)+88>>2]=x;g[m+(k*152|0)+92>>2]=0.0;if(u){A=+g[u+264>>2]*o+ +g[u+268>>2]*p+ +g[u+272>>2]*q;z=+g[u+280>>2]*o+ +g[u+284>>2]*p+ +g[u+288>>2]*q;w=+g[u+296>>2]*o+ +g[u+300>>2]*p+ +g[u+304>>2]*q}else{A=0.0;z=0.0;w=0.0}if(h){v=+g[h+264>>2]*t+ +g[h+268>>2]*s+ +g[h+272>>2]*r;y=t*+g[h+280>>2]+s*+g[h+284>>2]+r*+g[h+288>>2];x=t*+g[h+296>>2]+s*+g[h+300>>2]+r*+g[h+304>>2]}else{v=0.0;y=0.0;x=0.0}v=1.0/(A*o+z*p+w*q+0.0+(v*t+y*s+x*r));g[m+(k*152|0)+108>>2]=v;if(u){y=+g[b+(e*244|0)+192>>2];x=+g[b+(e*244|0)+196>>2];w=+g[b+(e*244|0)+200>>2];z=(+g[b+(e*244|0)+176>>2]+ +g[b+(e*244|0)+208>>2])*0.0+(+g[b+(e*244|0)+180>>2]+ +g[b+(e*244|0)+212>>2])*0.0+(+g[b+(e*244|0)+184>>2]+ +g[b+(e*244|0)+216>>2])*0.0}else{y=0.0;x=0.0;w=0.0;z=0.0}o=z+(y*o+x*p+w*q);if(!h){x=0.0;y=0.0;A=0.0;z=-0.0;x=x*t;y=y*s;y=x+y;A=A*r;A=y+A;A=z+A;A=o+A;A=0.0-A;A=v*A;C=m+(k*152|0)+112|0;g[C>>2]=A;C=m+(k*152|0)+116|0;g[C>>2]=0.0;A=-n;C=m+(k*152|0)+120|0;g[C>>2]=A;C=m+(k*152|0)+124|0;g[C>>2]=n;i=l;return}x=+g[b+(f*244|0)+192>>2];y=+g[b+(f*244|0)+196>>2];A=+g[b+(f*244|0)+200>>2];z=(+g[b+(f*244|0)+176>>2]+ +g[b+(f*244|0)+208>>2])*-0.0+(+g[b+(f*244|0)+180>>2]+ +g[b+(f*244|0)+212>>2])*-0.0+(+g[b+(f*244|0)+184>>2]+ +g[b+(f*244|0)+216>>2])*-0.0;x=x*t;y=y*s;y=x+y;A=A*r;A=y+A;A=z+A;A=o+A;A=0.0-A;A=v*A;C=m+(k*152|0)+112|0;g[C>>2]=A;C=m+(k*152|0)+116|0;g[C>>2]=0.0;A=-n;C=m+(k*152|0)+120|0;g[C>>2]=A;C=m+(k*152|0)+124|0;g[C>>2]=n;i=l;return}function Cr(a,b,d){a=a|0;b=b|0;d=+d;var e=0,f=0;e=i;i=i+496|0;f=c[b+212>>2]|0;if((f|0)>-1){b=f;i=e;return b|0}do if(c[b+236>>2]&2){if(!(+g[b+344>>2]!=0.0)?(c[b+204>>2]&2|0)==0:0)break;f=c[a+8>>2]|0;jF(e+244|0,0,244)|0;yr(Dr(a+4|0,e+244|0)|0,b,d);c[b+212>>2]=f;b=f;i=e;return b|0}while(0);f=c[a+188>>2]|0;if((f|0)>=0){b=f;i=e;return b|0}c[a+188>>2]=c[a+8>>2];jF(e|0,0,244)|0;yr(Dr(a+4|0,e)|0,0,d);b=c[a+188>>2]|0;i=e;return b|0}function Dr(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;e=i;f=c[b+4>>2]|0;if((f|0)==(c[b+8>>2]|0)?(g=(f|0)==0?1:f<<1,(f|0)<(g|0)):0){if(!g){h=0;j=f}else{c[5004]=(c[5004]|0)+1;h=fF((g*244|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+4>>2]|0}if((j|0)>0){k=0;do{m=h+(k*244|0)|0;l=c[b+12>>2]|0;n=l+(k*244|0)|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2];c[m+12>>2]=c[n+12>>2];m=h+(k*244|0)+16|0;n=l+(k*244|0)+16|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2];c[m+12>>2]=c[n+12>>2];m=h+(k*244|0)+32|0;n=l+(k*244|0)+32|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2];c[m+12>>2]=c[n+12>>2];m=h+(k*244|0)+48|0;n=l+(k*244|0)+48|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2];c[m+12>>2]=c[n+12>>2];mF(h+(k*244|0)+64|0,l+(k*244|0)+64|0,180)|0;k=k+1|0}while((k|0)!=(j|0))}j=c[b+12>>2]|0;if(j){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=h;c[b+8>>2]=g;g=c[b+4>>2]|0}else g=f;c[b+4>>2]=g+1;n=c[b+12>>2]|0;c[n+(f*244|0)+0>>2]=c[d+0>>2];c[n+(f*244|0)+4>>2]=c[d+4>>2];c[n+(f*244|0)+8>>2]=c[d+8>>2];c[n+(f*244|0)+12>>2]=c[d+12>>2];c[n+(f*244|0)+16>>2]=c[d+16>>2];c[n+(f*244|0)+20>>2]=c[d+20>>2];c[n+(f*244|0)+24>>2]=c[d+24>>2];c[n+(f*244|0)+28>>2]=c[d+28>>2];c[n+(f*244|0)+32>>2]=c[d+32>>2];c[n+(f*244|0)+36>>2]=c[d+36>>2];c[n+(f*244|0)+40>>2]=c[d+40>>2];c[n+(f*244|0)+44>>2]=c[d+44>>2];c[n+(f*244|0)+48>>2]=c[d+48>>2];c[n+(f*244|0)+52>>2]=c[d+52>>2];c[n+(f*244|0)+56>>2]=c[d+56>>2];c[n+(f*244|0)+60>>2]=c[d+60>>2];mF(n+(f*244|0)+64|0,d+64|0,180)|0;i=e;return(c[b+12>>2]|0)+(f*244|0)|0}function Er(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0.0,x=0,y=0,z=0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0,G=0,H=0,I=0,J=0.0,K=0,L=0.0,M=0.0,N=0.0,O=0,R=0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0.0,ca=0.0;r=i;i=i+80|0;if((e|0)<=0){i=r;return}k=0;do{l=c[d+(k<<2)>>2]|0;h=c[l+740>>2]|0;q=c[l+744>>2]|0;m=Cr(b,h,+g[f+12>>2])|0;n=Cr(b,q,+g[f+12>>2])|0;o=c[b+16>>2]|0;do if(o+(m*244|0)|0){if((+g[o+(m*244|0)+128>>2]==0.0?+g[o+(m*244|0)+132>>2]==0.0:0)?+g[o+(m*244|0)+136>>2]==0.0:0){if(!(o+(n*244|0)|0))break;if((+g[o+(n*244|0)+128>>2]==0.0?+g[o+(n*244|0)+132>>2]==0.0:0)?+g[o+(n*244|0)+136>>2]==0.0:0)break}t=c[l+748>>2]|0;if((t|0)>0){s=0;F=1;do{u=l+(s*184|0)+4|0;K=l+(s*184|0)+84|0;if(+g[K>>2]<=+g[l+756>>2]){t=c[b+28>>2]|0;if((t|0)==(c[b+32>>2]|0)?(p=(t|0)==0?1:t<<1,(t|0)<(p|0)):0){if(!p){v=0;y=t}else{c[5004]=(c[5004]|0)+1;v=fF((p*152|3)+16|0)|0;if(!v)v=0;else{c[(v+19&-16)+ -4>>2]=v;v=v+19&-16}y=c[b+28>>2]|0}if((y|0)>0){x=0;do{mF(v+(x*152|0)|0,(c[b+36>>2]|0)+(x*152|0)|0,152)|0;x=x+1|0}while((x|0)!=(y|0))}x=c[b+36>>2]|0;if(x){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=v;c[b+32>>2]=p;v=c[b+28>>2]|0}else v=t;c[b+28>>2]=v+1;v=c[b+36>>2]|0;H=(c[h+236>>2]&2|0)==0?0:h;G=(c[q+236>>2]&2|0)==0?0:q;c[v+(t*152|0)+144>>2]=m;c[v+(t*152|0)+148>>2]=n;c[v+(t*152|0)+132>>2]=u;S=+g[l+(s*184|0)+52>>2]- +g[h+52>>2];T=+g[l+(s*184|0)+56>>2]- +g[h+56>>2];U=+g[l+(s*184|0)+60>>2]- +g[h+60>>2];g[r+64>>2]=S;g[r+68>>2]=T;g[r+72>>2]=U;g[r+76>>2]=0.0;L=+g[l+(s*184|0)+36>>2]- +g[q+52>>2];M=+g[l+(s*184|0)+40>>2]- +g[q+56>>2];N=+g[l+(s*184|0)+44>>2]- +g[q+60>>2];g[r+48>>2]=L;g[r+52>>2]=M;g[r+56>>2]=N;g[r+60>>2]=0.0;if(!(c[o+(m*244|0)+240>>2]|0)){w=0.0;D=0.0;C=0.0}else{aa=+g[o+(m*244|0)+192>>2]+ +g[o+(m*244|0)+224>>2];C=+g[o+(m*244|0)+196>>2]+ +g[o+(m*244|0)+228>>2];D=+g[o+(m*244|0)+200>>2]+ +g[o+(m*244|0)+232>>2];w=+g[o+(m*244|0)+176>>2]+ +g[o+(m*244|0)+208>>2]+(C*U-D*T);D=+g[o+(m*244|0)+180>>2]+ +g[o+(m*244|0)+212>>2]+(D*S-aa*U);C=+g[o+(m*244|0)+184>>2]+ +g[o+(m*244|0)+216>>2]+(aa*T-C*S)}if(!(c[o+(n*244|0)+240>>2]|0)){E=0.0;A=0.0;B=0.0}else{aa=+g[o+(n*244|0)+192>>2]+ +g[o+(n*244|0)+224>>2];B=+g[o+(n*244|0)+196>>2]+ +g[o+(n*244|0)+228>>2];A=+g[o+(n*244|0)+200>>2]+ +g[o+(n*244|0)+232>>2];E=+g[o+(n*244|0)+176>>2]+ +g[o+(n*244|0)+208>>2]+(B*N-A*M);A=+g[o+(n*244|0)+180>>2]+ +g[o+(n*244|0)+212>>2]+(A*L-aa*N);B=+g[o+(n*244|0)+184>>2]+ +g[o+(n*244|0)+216>>2]+(aa*M-B*L)}w=w-E;A=D-A;D=C-B;y=l+(s*184|0)+68|0;C=+g[y>>2];z=l+(s*184|0)+72|0;B=+g[z>>2];x=l+(s*184|0)+76|0;E=+g[x>>2];I=c[b+16>>2]|0;R=c[I+(m*244|0)+240>>2]|0;O=c[I+(n*244|0)+240>>2]|0;if(R){_=((T*E-U*B)*+g[R+264>>2]+(U*C-E*S)*+g[R+268>>2]+(B*S-T*C)*+g[R+272>>2])*+g[R+544>>2];aa=((T*E-U*B)*+g[R+280>>2]+(U*C-E*S)*+g[R+284>>2]+(B*S-T*C)*+g[R+288>>2])*+g[R+548>>2];$=((T*E-U*B)*+g[R+296>>2]+(U*C-E*S)*+g[R+300>>2]+(B*S-T*C)*+g[R+304>>2])*+g[R+552>>2]}else{_=0.0;aa=0.0;$=0.0}g[v+(t*152|0)+64>>2]=_;g[v+(t*152|0)+68>>2]=aa;g[v+(t*152|0)+72>>2]=$;g[v+(t*152|0)+76>>2]=0.0;W=+g[x>>2];V=+g[z>>2];J=+g[y>>2];if(O){X=(+g[O+264>>2]*-(M*W-N*V)+ +g[O+268>>2]*-(N*J-W*L)+ +g[O+272>>2]*-(V*L-M*J))*+g[O+544>>2];Y=(+g[O+280>>2]*-(M*W-N*V)+ +g[O+284>>2]*-(N*J-W*L)+ +g[O+288>>2]*-(V*L-M*J))*+g[O+548>>2];Z=(+g[O+296>>2]*-(M*W-N*V)+ +g[O+300>>2]*-(N*J-W*L)+ +g[O+304>>2]*-(V*L-M*J))*+g[O+552>>2]}else{X=0.0;Y=0.0;Z=0.0}g[v+(t*152|0)+80>>2]=X;g[v+(t*152|0)+84>>2]=Y;g[v+(t*152|0)+88>>2]=Z;g[v+(t*152|0)+92>>2]=0.0;if(R)_=+g[R+344>>2]+((aa*U-$*T)*+g[y>>2]+($*S-U*_)*+g[z>>2]+(T*_-aa*S)*+g[x>>2]);else _=0.0;if(O){aa=-X;X=-Y;$=-Z;X=+g[O+344>>2]+((N*X-M*$)*+g[y>>2]+(L*$-N*aa)*+g[z>>2]+(M*aa-L*X)*+g[x>>2])}else X=0.0;g[v+(t*152|0)+108>>2]=1.0/(_+X);if(R){c[v+(t*152|0)+16>>2]=c[y+0>>2];c[v+(t*152|0)+20>>2]=c[y+4>>2];c[v+(t*152|0)+24>>2]=c[y+8>>2];c[v+(t*152|0)+28>>2]=c[y+12>>2];g[v+(t*152|0)>>2]=T*E-U*B;g[v+(t*152|0)+4>>2]=U*C-E*S;g[v+(t*152|0)+8>>2]=B*S-T*C;g[v+(t*152|0)+12>>2]=0.0}else{c[v+(t*152|0)+0>>2]=0;c[v+(t*152|0)+4>>2]=0;c[v+(t*152|0)+8>>2]=0;c[v+(t*152|0)+12>>2]=0;c[v+(t*152|0)+16>>2]=0;c[v+(t*152|0)+20>>2]=0;c[v+(t*152|0)+24>>2]=0;c[v+(t*152|0)+28>>2]=0}if(O){$=-+g[z>>2];aa=-+g[x>>2];g[v+(t*152|0)+48>>2]=-+g[y>>2];g[v+(t*152|0)+52>>2]=$;g[v+(t*152|0)+56>>2]=aa;g[v+(t*152|0)+60>>2]=0.0;g[v+(t*152|0)+32>>2]=-(M*W-N*V);g[v+(t*152|0)+36>>2]=-(N*J-W*L);g[v+(t*152|0)+40>>2]=-(V*L-M*J);g[v+(t*152|0)+44>>2]=0.0}else{c[v+(t*152|0)+32>>2]=0;c[v+(t*152|0)+36>>2]=0;c[v+(t*152|0)+40>>2]=0;c[v+(t*152|0)+44>>2]=0;c[v+(t*152|0)+48>>2]=0;c[v+(t*152|0)+52>>2]=0;c[v+(t*152|0)+56>>2]=0;c[v+(t*152|0)+60>>2]=0}J=+g[K>>2]+ +g[f+56>>2];if(R){aa=+g[R+332>>2];_=+g[R+336>>2];$=+g[R+328>>2];V=aa*U-_*T+ +g[R+312>>2];U=+g[R+316>>2]+(_*S-U*$);T=T*$-aa*S+ +g[R+320>>2]}else{V=0.0;U=0.0;T=0.0}if(O){aa=+g[O+332>>2];_=+g[O+336>>2];$=+g[O+328>>2];S=aa*N-_*M+ +g[O+312>>2];N=+g[O+316>>2]+(_*L-N*$);L=M*$-aa*L+ +g[O+320>>2]}else{S=0.0;N=0.0;L=0.0}L=+g[y>>2]*(V-S)+(U-N)*+g[z>>2]+(T-L)*+g[x>>2];g[v+(t*152|0)+104>>2]=+g[l+(s*184|0)+88>>2];L=L*+g[l+(s*184|0)+96>>2];L=!(L>=-0.0)?-L:0.0;do if(!(c[f+64>>2]&4))g[v+(t*152|0)+100>>2]=0.0;else{M=+g[l+(s*184|0)+124>>2]*+g[f+60>>2];g[v+(t*152|0)+100>>2]=M;do if(R){if(!(c[I+(m*244|0)+240>>2]|0))break;aa=M*+g[I+(m*244|0)+132>>2]*+g[v+(t*152|0)+20>>2]*+g[R+352>>2]*+g[I+(m*244|0)+116>>2];$=M*+g[I+(m*244|0)+136>>2]*+g[v+(t*152|0)+24>>2]*+g[R+356>>2]*+g[I+(m*244|0)+120>>2];g[I+(m*244|0)+64>>2]=+g[I+(m*244|0)+112>>2]*M*+g[I+(m*244|0)+128>>2]*+g[v+(t*152|0)+16>>2]*+g[R+348>>2]+ +g[I+(m*244|0)+64>>2];g[I+(m*244|0)+68>>2]=aa+ +g[I+(m*244|0)+68>>2];g[I+(m*244|0)+72>>2]=$+ +g[I+(m*244|0)+72>>2];$=M*+g[I+(m*244|0)+100>>2]*+g[v+(t*152|0)+68>>2];aa=M*+g[I+(m*244|0)+104>>2]*+g[v+(t*152|0)+72>>2];g[I+(m*244|0)+80>>2]=M*+g[I+(m*244|0)+96>>2]*+g[v+(t*152|0)+64>>2]+ +g[I+(m*244|0)+80>>2];g[I+(m*244|0)+84>>2]=$+ +g[I+(m*244|0)+84>>2];g[I+(m*244|0)+88>>2]=aa+ +g[I+(m*244|0)+88>>2]}while(0);if(!O)break;M=+g[v+(t*152|0)+100>>2];if(!(c[I+(n*244|0)+240>>2]|0))break;aa=+g[v+(t*152|0)+88>>2];$=+g[v+(t*152|0)+84>>2];_=+g[v+(t*152|0)+80>>2];Y=M*+g[I+(n*244|0)+132>>2]*+g[v+(t*152|0)+52>>2]*+g[O+352>>2]*+g[I+(n*244|0)+116>>2];Z=M*+g[I+(n*244|0)+136>>2]*+g[v+(t*152|0)+56>>2]*+g[O+356>>2]*+g[I+(n*244|0)+120>>2];g[I+(n*244|0)+64>>2]=+g[I+(n*244|0)+112>>2]*M*+g[I+(n*244|0)+128>>2]*+g[v+(t*152|0)+48>>2]*+g[O+348>>2]+ +g[I+(n*244|0)+64>>2];g[I+(n*244|0)+68>>2]=Y+ +g[I+(n*244|0)+68>>2];g[I+(n*244|0)+72>>2]=Z+ +g[I+(n*244|0)+72>>2];$=$*+g[I+(n*244|0)+100>>2]*-M;aa=aa*+g[I+(n*244|0)+104>>2]*-M;g[I+(n*244|0)+80>>2]=+g[I+(n*244|0)+80>>2]-_*+g[I+(n*244|0)+96>>2]*-M;g[I+(n*244|0)+84>>2]=+g[I+(n*244|0)+84>>2]-$;g[I+(n*244|0)+88>>2]=+g[I+(n*244|0)+88>>2]-aa}while(0);g[v+(t*152|0)+96>>2]=0.0;if(!(c[I+(m*244|0)+240>>2]|0)){$=0.0;_=0.0;Z=0.0;M=0.0;X=0.0;W=0.0}else{$=+g[I+(m*244|0)+208>>2];_=+g[I+(m*244|0)+212>>2];Z=+g[I+(m*244|0)+216>>2];M=+g[I+(m*244|0)+224>>2];X=+g[I+(m*244|0)+228>>2];W=+g[I+(m*244|0)+232>>2]}if(!(c[I+(n*244|0)+240>>2]|0)){S=0.0;Y=0.0;N=0.0;T=0.0;U=0.0;V=0.0}else{S=+g[I+(n*244|0)+208>>2];Y=+g[I+(n*244|0)+212>>2];N=+g[I+(n*244|0)+216>>2];T=+g[I+(n*244|0)+224>>2];U=+g[I+(n*244|0)+228>>2];V=+g[I+(n*244|0)+232>>2]}L=L-(($+ +g[I+(m*244|0)+176>>2])*+g[v+(t*152|0)+16>>2]+(_+ +g[I+(m*244|0)+180>>2])*+g[v+(t*152|0)+20>>2]+(Z+ +g[I+(m*244|0)+184>>2])*+g[v+(t*152|0)+24>>2]+((M+ +g[I+(m*244|0)+192>>2])*+g[v+(t*152|0)>>2]+(X+ +g[I+(m*244|0)+196>>2])*+g[v+(t*152|0)+4>>2]+(W+ +g[I+(m*244|0)+200>>2])*+g[v+(t*152|0)+8>>2])+((S+ +g[I+(n*244|0)+176>>2])*+g[v+(t*152|0)+48>>2]+(Y+ +g[I+(n*244|0)+180>>2])*+g[v+(t*152|0)+52>>2]+(N+ +g[I+(n*244|0)+184>>2])*+g[v+(t*152|0)+56>>2]+((T+ +g[I+(n*244|0)+192>>2])*+g[v+(t*152|0)+32>>2]+(U+ +g[I+(n*244|0)+196>>2])*+g[v+(t*152|0)+36>>2]+(V+ +g[I+(n*244|0)+200>>2])*+g[v+(t*152|0)+40>>2])));I=(c[f+44>>2]|0)==0;if(!I?!(J>+g[f+48>>2]):0)K=f+36|0;else K=f+32|0;if(J>0.0){M=0.0;L=L-J/+g[f+12>>2]}else M=-(J*+g[K>>2])/+g[f+12>>2];aa=+g[v+(t*152|0)+108>>2];M=M*aa;L=L*aa;do if(I)j=69;else{if(J>+g[f+48>>2]){j=69;break}g[v+(t*152|0)+112>>2]=L;g[v+(t*152|0)+128>>2]=M}while(0);if((j|0)==69){j=0;g[v+(t*152|0)+112>>2]=M+L;g[v+(t*152|0)+128>>2]=0.0}g[v+(t*152|0)+116>>2]=0.0;g[v+(t*152|0)+120>>2]=0.0;g[v+(t*152|0)+124>>2]=1.0e10;c[v+(t*152|0)+140>>2]=c[b+68>>2];if(!H){J=0.0;M=0.0;L=0.0}else{J=+g[H+328>>2];M=+g[H+332>>2];L=+g[H+336>>2]}if(!G){T=0.0;S=0.0;N=0.0}else{T=+g[G+328>>2];S=+g[G+332>>2];N=+g[G+336>>2]}J=T-J;M=S-M;L=N-L;g[r+32>>2]=J;g[r+36>>2]=M;g[r+40>>2]=L;g[r+44>>2]=0.0;do if((F|0)>0?+g[l+(s*184|0)+92>>2]>0.0:0){F=F+ -1|0;S=+Q(+(J*J+M*M+L*L));if(S>+g[f+80>>2]){N=J*(1.0/S);g[r+32>>2]=N;J=M*(1.0/S);g[r+36>>2]=J;L=L*(1.0/S);g[r+40>>2]=L;do if(h){if(!(c[h+180>>2]&2))break;S=+g[h+4>>2];V=+g[h+20>>2];Y=+g[h+36>>2];T=+g[h+8>>2];W=+g[h+24>>2];_=+g[h+40>>2];U=+g[h+12>>2];X=+g[h+28>>2];aa=+g[h+44>>2];Z=(S*N+V*J+L*Y)*+g[h+164>>2];$=(N*T+J*W+L*_)*+g[h+168>>2];L=(N*U+J*X+L*aa)*+g[h+172>>2];g[r+32>>2]=S*Z+T*$+U*L;g[r+36>>2]=V*Z+W*$+X*L;g[r+40>>2]=Y*Z+_*$+aa*L;g[r+44>>2]=0.0;N=S*Z+T*$+U*L;J=V*Z+W*$+X*L;L=Y*Z+_*$+aa*L}while(0);do if(q){if(!(c[q+180>>2]&2))break;S=+g[q+4>>2];V=+g[q+20>>2];Y=+g[q+36>>2];T=+g[q+8>>2];W=+g[q+24>>2];_=+g[q+40>>2];U=+g[q+12>>2];X=+g[q+28>>2];aa=+g[q+44>>2];Z=(S*N+V*J+Y*L)*+g[q+164>>2];$=(N*T+J*W+L*_)*+g[q+168>>2];L=(N*U+J*X+L*aa)*+g[q+172>>2];g[r+32>>2]=S*Z+T*$+U*L;g[r+36>>2]=V*Z+W*$+X*L;g[r+40>>2]=Y*Z+_*$+aa*L;g[r+44>>2]=0.0;N=S*Z+T*$+U*L;J=V*Z+W*$+X*L;L=Y*Z+_*$+aa*L}while(0);if(!(+Q(+(N*N+J*J+L*L))>.001))break;Br(b,r+32|0,m,n,t,u);break}Br(b,y,m,n,t,u);L=+g[x>>2];if(+P(+L)>.7071067690849304){M=+g[z>>2];aa=1.0/+Q(+(L*L+M*M));g[r+16>>2]=0.0;g[r+20>>2]=-(aa*L);g[r+24>>2]=aa*M;g[r>>2]=(L*L+M*M)*aa;$=+g[y>>2];g[r+4>>2]=-($*aa*M);J=0.0;S=-(aa*L);T=aa*M;N=(L*L+M*M)*aa;M=-($*aa*M);L=$*-(aa*L)}else{_=+g[y>>2];$=+g[z>>2];aa=1.0/+Q(+(_*_+$*$));g[r+16>>2]=-($*aa);g[r+20>>2]=aa*_;g[r+24>>2]=0.0;g[r>>2]=-(L*aa*_);g[r+4>>2]=L*-($*aa);J=-($*aa);S=aa*_;T=0.0;N=-(L*aa*_);M=L*-($*aa);L=(_*_+$*$)*aa}g[r+8>>2]=L;do if(h){if(!(c[h+180>>2]&2))break;ca=+g[h+4>>2];V=+g[h+20>>2];Y=+g[h+36>>2];ba=+g[h+8>>2];W=+g[h+24>>2];_=+g[h+40>>2];U=+g[h+12>>2];X=+g[h+28>>2];aa=+g[h+44>>2];Z=(ca*J+V*S+Y*T)*+g[h+164>>2];$=(J*ba+S*W+T*_)*+g[h+168>>2];T=(J*U+S*X+T*aa)*+g[h+172>>2];g[r+16>>2]=ca*Z+ba*$+U*T;g[r+20>>2]=V*Z+W*$+X*T;g[r+24>>2]=Y*Z+_*$+aa*T;g[r+28>>2]=0.0;J=ca*Z+ba*$+U*T;S=V*Z+W*$+X*T;T=Y*Z+_*$+aa*T}while(0);do if(q){if(!(c[q+180>>2]&2))break;U=+g[q+4>>2];X=+g[q+20>>2];_=+g[q+36>>2];V=+g[q+8>>2];Y=+g[q+24>>2];aa=+g[q+40>>2];W=+g[q+12>>2];Z=+g[q+28>>2];ca=+g[q+44>>2];$=(U*J+X*S+_*T)*+g[q+164>>2];ba=(J*V+S*Y+T*aa)*+g[q+168>>2];T=(J*W+S*Z+T*ca)*+g[q+172>>2];g[r+16>>2]=U*$+V*ba+W*T;g[r+20>>2]=X*$+Y*ba+Z*T;g[r+24>>2]=_*$+aa*ba+ca*T;g[r+28>>2]=0.0;J=U*$+V*ba+W*T;S=X*$+Y*ba+Z*T;T=_*$+aa*ba+ca*T}while(0);do if(h){if(!(c[h+180>>2]&2))break;U=+g[h+4>>2];X=+g[h+20>>2];_=+g[h+36>>2];V=+g[h+8>>2];Y=+g[h+24>>2];aa=+g[h+40>>2];W=+g[h+12>>2];Z=+g[h+28>>2];ca=+g[h+44>>2];$=(U*N+X*M+_*L)*+g[h+164>>2];ba=(N*V+M*Y+L*aa)*+g[h+168>>2];L=(N*W+M*Z+L*ca)*+g[h+172>>2];g[r>>2]=U*$+V*ba+W*L;g[r+4>>2]=X*$+Y*ba+Z*L;g[r+8>>2]=_*$+aa*ba+ca*L;g[r+12>>2]=0.0;N=U*$+V*ba+W*L;M=X*$+Y*ba+Z*L;L=_*$+aa*ba+ca*L}while(0);do if(q){if(!(c[q+180>>2]&2))break;U=+g[q+4>>2];X=+g[q+20>>2];_=+g[q+36>>2];V=+g[q+8>>2];Y=+g[q+24>>2];aa=+g[q+40>>2];W=+g[q+12>>2];Z=+g[q+28>>2];ca=+g[q+44>>2];$=(U*N+X*M+_*L)*+g[q+164>>2];ba=(N*V+M*Y+L*aa)*+g[q+168>>2];L=(N*W+M*Z+L*ca)*+g[q+172>>2];g[r>>2]=U*$+V*ba+W*L;g[r+4>>2]=X*$+Y*ba+Z*L;g[r+8>>2]=_*$+aa*ba+ca*L;g[r+12>>2]=0.0;N=U*$+V*ba+W*L;M=X*$+Y*ba+Z*L;L=_*$+aa*ba+ca*L}while(0);if(+Q(+(J*J+S*S+T*T))>.001)Br(b,r+16|0,m,n,t,u);if(!(+Q(+(N*N+M*M+L*L))>.001))break;Br(b,r,m,n,t,u)}while(0);do if(!(c[f+64>>2]&32))j=106;else{if(!(a[l+(s*184|0)+120>>0]|0)){j=106;break}Ar(b,l+(s*184|0)+156|0,m,n,t,u,r+64|0,r+48|0,1.0,+g[l+(s*184|0)+136>>2],+g[l+(s*184|0)+144>>2]);if(!(c[f+64>>2]&16))break;Ar(b,l+(s*184|0)+172|0,m,n,t,u,r+64|0,r+48|0,1.0,+g[l+(s*184|0)+140>>2],+g[l+(s*184|0)+148>>2])}while(0);do if((j|0)==106){j=0;G=l+(s*184|0)+156|0;J=+g[y>>2];L=+g[z>>2];M=+g[x>>2];S=w-(C*w+A*B+D*E)*J;N=A-(C*w+A*B+D*E)*L;w=D-(C*w+A*B+D*E)*M;g[l+(s*184|0)+156>>2]=S;I=l+(s*184|0)+160|0;g[I>>2]=N;H=l+(s*184|0)+164|0;g[H>>2]=w;g[l+(s*184|0)+168>>2]=0.0;if((c[f+64>>2]&64|0)==0?S*S+N*N+w*w>1.1920928955078125e-7:0){ca=1.0/+Q(+(S*S+N*N+w*w));g[G>>2]=S*ca;g[I>>2]=ca*N;g[H>>2]=ca*w;zr(h,G);zr(q,G);Ar(b,G,m,n,t,u,r+64|0,r+48|0,1.0,0.0,0.0);if(!(c[f+64>>2]&16))break;R=l+(s*184|0)+172|0;aa=+g[I>>2];Z=+g[x>>2];Y=+g[H>>2];_=+g[z>>2];ba=+g[y>>2];$=+g[G>>2];g[l+(s*184|0)+172>>2]=aa*Z-Y*_;g[l+(s*184|0)+184>>2]=0.0;ca=1.0/+Q(+((aa*Z-Y*_)*(aa*Z-Y*_)+(Y*ba-Z*$)*(Y*ba-Z*$)+(_*$-aa*ba)*(_*$-aa*ba)));g[R>>2]=(aa*Z-Y*_)*ca;g[l+(s*184|0)+176>>2]=(Y*ba-Z*$)*ca;g[l+(s*184|0)+180>>2]=(_*$-aa*ba)*ca;zr(h,R);zr(q,R);Ar(b,R,m,n,t,u,r+64|0,r+48|0,1.0,0.0,0.0);break}x=l+(s*184|0)+172|0;if(+P(+M)>.7071067690849304){ca=1.0/+Q(+(M*M+L*L));g[G>>2]=0.0;g[I>>2]=-(ca*M);g[H>>2]=ca*L;g[x>>2]=(M*M+L*L)*ca;g[l+(s*184|0)+176>>2]=-(J*ca*L);g[l+(s*184|0)+180>>2]=J*-(ca*M)}else{ca=1.0/+Q(+(J*J+L*L));g[G>>2]=-(L*ca);g[I>>2]=ca*J;g[H>>2]=0.0;g[x>>2]=-(M*ca*J);g[l+(s*184|0)+176>>2]=M*-(L*ca);g[l+(s*184|0)+180>>2]=(J*J+L*L)*ca}zr(h,G);zr(q,G);Ar(b,G,m,n,t,u,r+64|0,r+48|0,1.0,0.0,0.0);y=c[f+64>>2]|0;if(y&16){zr(h,x);zr(q,x);Ar(b,x,m,n,t,u,r+64|0,r+48|0,1.0,0.0,0.0);y=c[f+64>>2]|0}if((y&80|0)!=80)break;a[l+(s*184|0)+120>>0]=1}while(0);u=c[b+16>>2]|0;y=c[u+(m*244|0)+240>>2]|0;x=c[u+(n*244|0)+240>>2]|0;v=c[v+(t*152|0)+140>>2]|0;t=c[b+76>>2]|0;z=c[f+64>>2]|0;do if(!(z&4))g[t+(v*152|0)+100>>2]=0.0;else{w=+g[l+(s*184|0)+128>>2]*+g[f+60>>2];g[t+(v*152|0)+100>>2]=w;if(y){aa=+g[y+344>>2];ca=w*aa*+g[t+(v*152|0)+20>>2]*+g[y+352>>2]*+g[u+(m*244|0)+116>>2];ba=w*aa*+g[t+(v*152|0)+24>>2]*+g[y+356>>2]*+g[u+(m*244|0)+120>>2];g[u+(m*244|0)+64>>2]=+g[u+(m*244|0)+112>>2]*w*aa*+g[t+(v*152|0)+16>>2]*+g[y+348>>2]+ +g[u+(m*244|0)+64>>2];g[u+(m*244|0)+68>>2]=ca+ +g[u+(m*244|0)+68>>2];g[u+(m*244|0)+72>>2]=ba+ +g[u+(m*244|0)+72>>2];ba=w*+g[u+(m*244|0)+100>>2]*+g[t+(v*152|0)+68>>2];ca=w*+g[u+(m*244|0)+104>>2]*+g[t+(v*152|0)+72>>2];g[u+(m*244|0)+80>>2]=w*+g[u+(m*244|0)+96>>2]*+g[t+(v*152|0)+64>>2]+ +g[u+(m*244|0)+80>>2];g[u+(m*244|0)+84>>2]=ba+ +g[u+(m*244|0)+84>>2];g[u+(m*244|0)+88>>2]=ca+ +g[u+(m*244|0)+88>>2]}if(!x)break;A=+g[x+344>>2];w=+g[t+(v*152|0)+100>>2];if(!(c[u+(n*244|0)+240>>2]|0))break;ca=+g[t+(v*152|0)+88>>2];ba=+g[t+(v*152|0)+84>>2];aa=+g[t+(v*152|0)+80>>2];_=w*A*+g[t+(v*152|0)+52>>2]*+g[x+352>>2]*+g[u+(n*244|0)+116>>2];$=w*A*+g[t+(v*152|0)+56>>2]*+g[x+356>>2]*+g[u+(n*244|0)+120>>2];g[u+(n*244|0)+64>>2]=+g[u+(n*244|0)+112>>2]*w*A*+g[t+(v*152|0)+48>>2]*+g[x+348>>2]+ +g[u+(n*244|0)+64>>2];g[u+(n*244|0)+68>>2]=_+ +g[u+(n*244|0)+68>>2];g[u+(n*244|0)+72>>2]=$+ +g[u+(n*244|0)+72>>2];ba=ba*+g[u+(n*244|0)+100>>2]*-w;ca=ca*+g[u+(n*244|0)+104>>2]*-w;g[u+(n*244|0)+80>>2]=+g[u+(n*244|0)+80>>2]-aa*+g[u+(n*244|0)+96>>2]*-w;g[u+(n*244|0)+84>>2]=+g[u+(n*244|0)+84>>2]-ba;g[u+(n*244|0)+88>>2]=+g[u+(n*244|0)+88>>2]-ca}while(0);do if(z&16){if(!(z&4)){g[t+((v+1|0)*152|0)+100>>2]=0.0;break}w=+g[l+(s*184|0)+132>>2]*+g[f+60>>2];g[t+((v+1|0)*152|0)+100>>2]=w;do if(y){A=+g[y+344>>2];if(!(c[u+(m*244|0)+240>>2]|0))break;ca=w*A*+g[t+((v+1|0)*152|0)+20>>2]*+g[u+(m*244|0)+116>>2];ba=w*A*+g[t+((v+1|0)*152|0)+24>>2]*+g[u+(m*244|0)+120>>2];g[u+(m*244|0)+64>>2]=+g[u+(m*244|0)+112>>2]*w*A*+g[t+((v+1|0)*152|0)+16>>2]+ +g[u+(m*244|0)+64>>2];g[u+(m*244|0)+68>>2]=ca+ +g[u+(m*244|0)+68>>2];g[u+(m*244|0)+72>>2]=ba+ +g[u+(m*244|0)+72>>2];ba=w*+g[u+(m*244|0)+100>>2]*+g[t+((v+1|0)*152|0)+68>>2];ca=w*+g[u+(m*244|0)+104>>2]*+g[t+((v+1|0)*152|0)+72>>2];g[u+(m*244|0)+80>>2]=w*+g[u+(m*244|0)+96>>2]*+g[t+((v+1|0)*152|0)+64>>2]+ +g[u+(m*244|0)+80>>2];g[u+(m*244|0)+84>>2]=ba+ +g[u+(m*244|0)+84>>2];g[u+(m*244|0)+88>>2]=ca+ +g[u+(m*244|0)+88>>2]}while(0);if(!x)break;A=+g[x+344>>2];w=+g[t+((v+1|0)*152|0)+100>>2];if(!(c[u+(n*244|0)+240>>2]|0))break;ca=+g[t+((v+1|0)*152|0)+88>>2];ba=+g[t+((v+1|0)*152|0)+84>>2];aa=+g[t+((v+1|0)*152|0)+80>>2];_=w*A*+g[t+((v+1|0)*152|0)+52>>2]*+g[u+(n*244|0)+116>>2];$=w*A*+g[t+((v+1|0)*152|0)+56>>2]*+g[u+(n*244|0)+120>>2];g[u+(n*244|0)+64>>2]=+g[u+(n*244|0)+112>>2]*w*A*+g[t+((v+1|0)*152|0)+48>>2]+ +g[u+(n*244|0)+64>>2];g[u+(n*244|0)+68>>2]=_+ +g[u+(n*244|0)+68>>2];g[u+(n*244|0)+72>>2]=$+ +g[u+(n*244|0)+72>>2];ba=ba*+g[u+(n*244|0)+100>>2]*-w;ca=ca*+g[u+(n*244|0)+104>>2]*-w;g[u+(n*244|0)+80>>2]=+g[u+(n*244|0)+80>>2]-aa*+g[u+(n*244|0)+96>>2]*-w;g[u+(n*244|0)+84>>2]=+g[u+(n*244|0)+84>>2]-ba;g[u+(n*244|0)+88>>2]=+g[u+(n*244|0)+88>>2]-ca}while(0);t=c[l+748>>2]|0}s=s+1|0}while((s|0)<(t|0))}}while(0);k=k+1|0}while((k|0)!=(e|0));i=r;return}



function Fr(b,d,e,f,h,j,k,l,m){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;var n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0;m=i;i=i+320|0;c[b+188>>2]=-1;yE(4080);c[b+184>>2]=0;if((e|0)>0){p=0;do{c[(c[d+(p<<2)>>2]|0)+212>>2]=-1;p=p+1|0}while((p|0)!=(e|0))}p=c[b+12>>2]|0;if((p|0)<(e+1|0)){if((e+1|0)!=0?(c[5004]=(c[5004]|0)+1,o=fF(((e+1|0)*244|3)+16|0)|0,(o|0)!=0):0){c[(o+19&-16)+ -4>>2]=o;o=o+19&-16}else o=0;p=c[b+8>>2]|0;if((p|0)>0){q=0;do{x=o+(q*244|0)|0;Y=c[b+16>>2]|0;w=Y+(q*244|0)|0;c[x+0>>2]=c[w+0>>2];c[x+4>>2]=c[w+4>>2];c[x+8>>2]=c[w+8>>2];c[x+12>>2]=c[w+12>>2];x=o+(q*244|0)+16|0;w=Y+(q*244|0)+16|0;c[x+0>>2]=c[w+0>>2];c[x+4>>2]=c[w+4>>2];c[x+8>>2]=c[w+8>>2];c[x+12>>2]=c[w+12>>2];x=o+(q*244|0)+32|0;w=Y+(q*244|0)+32|0;c[x+0>>2]=c[w+0>>2];c[x+4>>2]=c[w+4>>2];c[x+8>>2]=c[w+8>>2];c[x+12>>2]=c[w+12>>2];x=o+(q*244|0)+48|0;w=Y+(q*244|0)+48|0;c[x+0>>2]=c[w+0>>2];c[x+4>>2]=c[w+4>>2];c[x+8>>2]=c[w+8>>2];c[x+12>>2]=c[w+12>>2];mF(o+(q*244|0)+64|0,Y+(q*244|0)+64|0,180)|0;q=q+1|0}while((q|0)!=(p|0))}p=c[b+16>>2]|0;if(p){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[p+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=o;c[b+12>>2]=e+1;o=b+8|0;q=e+1|0}else{o=b+8|0;q=p}jF(m+56|0,0,244)|0;p=c[o>>2]|0;if((p|0)<0){if((q|0)<0){q=c[b+16>>2]|0;if(q){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[q+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=0;c[b+12>>2]=0}do{Y=c[b+16>>2]|0;x=Y+(p*244|0)|0;c[x+0>>2]=c[m+56>>2];c[x+4>>2]=c[m+60>>2];c[x+8>>2]=c[m+64>>2];c[x+12>>2]=c[m+68>>2];x=Y+(p*244|0)+16|0;c[x+0>>2]=c[m+72>>2];c[x+4>>2]=c[m+76>>2];c[x+8>>2]=c[m+80>>2];c[x+12>>2]=c[m+84>>2];x=Y+(p*244|0)+32|0;c[x+0>>2]=c[m+88>>2];c[x+4>>2]=c[m+92>>2];c[x+8>>2]=c[m+96>>2];c[x+12>>2]=c[m+100>>2];x=Y+(p*244|0)+48|0;c[x+0>>2]=c[m+104>>2];c[x+4>>2]=c[m+108>>2];c[x+8>>2]=c[m+112>>2];c[x+12>>2]=c[m+116>>2];mF(Y+(p*244|0)+64|0,m+120|0,180)|0;p=p+1|0}while((p|0)!=0)}c[o>>2]=0;if((e|0)>0){o=0;do{p=d+(o<<2)|0;q=Cr(b,c[p>>2]|0,+g[l+12>>2])|0;p=c[p>>2]|0;if((!((p|0)==0?1:(c[p+236>>2]&2|0)==0)?+g[p+344>>2]!=0.0:0)?(n=c[b+16>>2]|0,(c[p+504>>2]&2|0)!=0):0){E=+g[l+76>>2];S=1.0/+g[p+396>>2];V=1.0/+g[p+400>>2];F=1.0/+g[p+404>>2];M=+g[p+4>>2];N=+g[p+8>>2];O=+g[p+12>>2];R=+g[p+20>>2];U=+g[p+24>>2];X=+g[p+28>>2];T=+g[p+36>>2];W=+g[p+40>>2];C=+g[p+44>>2];B=+g[p+328>>2];z=+g[p+332>>2];D=+g[p+336>>2];y=(M*S*M+N*V*N+O*F*O)*B+(S*M*R+V*N*U+F*O*X)*z+(S*M*T+V*N*W+F*O*C)*D;A=(M*S*R+N*V*U+O*F*X)*B+(R*S*R+U*V*U+X*F*X)*z+(S*R*T+V*U*W+F*X*C)*D;C=D*(T*S*T+W*V*W+C*F*C)+(B*(M*S*T+N*V*W+O*F*C)+z*(R*S*T+U*V*W+X*F*C));F=(z*C-D*A)*(z*C-D*A)+(D*y-B*C)*(D*y-B*C)+(B*A-z*y)*(B*A-z*y);if(F>E*E){X=1.0/+Q(+F)*E;E=(z*C-D*A)*X;C=X*(D*y-B*C);y=X*(B*A-z*y)}else{E=z*C-D*A;C=D*y-B*C;y=B*A-z*y}V=+g[l+12>>2];W=(E*+g[p+268>>2]+C*+g[p+284>>2]+y*+g[p+300>>2])*V;X=V*(E*+g[p+272>>2]+C*+g[p+288>>2]+y*+g[p+304>>2]);g[n+(q*244|0)+224>>2]=+g[n+(q*244|0)+224>>2]-(E*+g[p+264>>2]+C*+g[p+280>>2]+y*+g[p+296>>2])*V;g[n+(q*244|0)+228>>2]=+g[n+(q*244|0)+228>>2]-W;g[n+(q*244|0)+232>>2]=+g[n+(q*244|0)+232>>2]-X}o=o+1|0}while((o|0)<(e|0))}if((k|0)>0){e=0;do{Y=c[j+(e<<2)>>2]|0;Lb[c[(c[Y>>2]|0)+8>>2]&511](Y);g[Y+36>>2]=0.0;e=e+1|0}while((e|0)<(k|0))}o=c[b+168>>2]|0;if((o|0)<(k|0)?(c[b+172>>2]|0)<(k|0):0){if(!k)e=0;else{c[5004]=(c[5004]|0)+1;e=fF((k<<3|3)+16|0)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}o=c[b+168>>2]|0}if((o|0)>0){n=0;do{d=e+(n<<3)|0;if(d){x=(c[b+176>>2]|0)+(n<<3)|0;Y=c[x+4>>2]|0;c[d>>2]=c[x>>2];c[d+4>>2]=Y}n=n+1|0}while((n|0)!=(o|0))}n=c[b+176>>2]|0;if(n){if(a[b+180>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[n+ -4>>2]|0)}c[b+176>>2]=0}a[b+180>>0]=1;c[b+176>>2]=e;c[b+172>>2]=k}c[b+168>>2]=k;if((k|0)>0){e=0;n=0;do{d=c[b+176>>2]|0;o=d+(e<<3)|0;p=j+(e<<2)|0;q=c[p>>2]|0;r=c[q+44>>2]|0;if(r){q=r+0|0;r=q+64|0;do{c[q>>2]=0;q=q+4|0}while((q|0)<(r|0));q=c[p>>2]|0}if(!(a[q+20>>0]|0)){c[o>>2]=0;c[d+(e<<3)+4>>2]=0;d=0}else{Nb[c[(c[q>>2]|0)+16>>2]&127](q,o);d=c[o>>2]|0}n=d+n|0;e=e+1|0}while((e|0)<(k|0))}else n=0;o=c[b+48>>2]|0;if((o|0)<(n|0)?(c[b+52>>2]|0)<(n|0):0){if(!n)e=0;else{c[5004]=(c[5004]|0)+1;e=fF((n*152|3)+16|0)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}o=c[b+48>>2]|0}if((o|0)>0){d=0;do{mF(e+(d*152|0)|0,(c[b+56>>2]|0)+(d*152|0)|0,152)|0;d=d+1|0}while((d|0)!=(o|0))}d=c[b+56>>2]|0;if(d){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=e;c[b+52>>2]=n}c[b+48>>2]=n;if((k|0)>0){o=c[b+176>>2]|0;e=0;n=0;while(1){d=o+(n<<3)|0;if(!(c[d>>2]|0))d=0;else{v=c[b+56>>2]|0;u=j+(n<<2)|0;t=c[u>>2]|0;o=c[t+28>>2]|0;p=c[t+32>>2]|0;s=Cr(b,o,+g[l+12>>2])|0;r=Cr(b,p,+g[l+12>>2])|0;q=c[b+16>>2]|0;x=c[t+24>>2]|0;if((x|0)<=0)x=c[l+20>>2]|0;if((x|0)>(c[b+184>>2]|0))c[b+184>>2]=x;if((c[d>>2]|0)>0){w=0;do{Y=w+e|0;jF(v+(Y*152|0)|0,0,152)|0;g[v+(Y*152|0)+120>>2]=-3.4028234663852886e+38;g[v+(Y*152|0)+124>>2]=3.4028234663852886e+38;g[v+(Y*152|0)+100>>2]=0.0;g[v+(Y*152|0)+96>>2]=0.0;c[v+(Y*152|0)+144>>2]=s;c[v+(Y*152|0)+148>>2]=r;c[v+(Y*152|0)+136>>2]=x;w=w+1|0}while((w|0)<(c[d>>2]|0))}c[q+(s*244|0)+64>>2]=0;c[q+(s*244|0)+68>>2]=0;c[q+(s*244|0)+72>>2]=0;c[q+(s*244|0)+76>>2]=0;c[q+(s*244|0)+80>>2]=0;c[q+(s*244|0)+84>>2]=0;c[q+(s*244|0)+88>>2]=0;c[q+(s*244|0)+92>>2]=0;c[q+(s*244|0)+144>>2]=0;c[q+(s*244|0)+148>>2]=0;c[q+(s*244|0)+152>>2]=0;c[q+(s*244|0)+156>>2]=0;c[q+(s*244|0)+160>>2]=0;c[q+(s*244|0)+164>>2]=0;c[q+(s*244|0)+168>>2]=0;c[q+(s*244|0)+172>>2]=0;c[q+(r*244|0)+64>>2]=0;c[q+(r*244|0)+68>>2]=0;c[q+(r*244|0)+72>>2]=0;c[q+(r*244|0)+76>>2]=0;c[q+(r*244|0)+80>>2]=0;c[q+(r*244|0)+84>>2]=0;c[q+(r*244|0)+88>>2]=0;c[q+(r*244|0)+92>>2]=0;c[q+(r*244|0)+144>>2]=0;c[q+(r*244|0)+148>>2]=0;c[q+(r*244|0)+152>>2]=0;c[q+(r*244|0)+156>>2]=0;c[q+(r*244|0)+160>>2]=0;c[q+(r*244|0)+164>>2]=0;c[q+(r*244|0)+168>>2]=0;c[q+(r*244|0)+172>>2]=0;g[m>>2]=1.0/+g[l+12>>2];g[m+4>>2]=+g[l+32>>2];c[m+8>>2]=v+(e*152|0)+16;c[m+12>>2]=v+(e*152|0);c[m+16>>2]=v+(e*152|0)+48;c[m+20>>2]=v+(e*152|0)+32;c[m+24>>2]=38;c[m+28>>2]=v+(e*152|0)+112;Y=v+(e*152|0)+116|0;g[Y>>2]=+g[l+40>>2];g[m+52>>2]=+g[l+4>>2];c[m+32>>2]=Y;c[m+36>>2]=v+(e*152|0)+120;c[m+40>>2]=v+(e*152|0)+124;c[m+48>>2]=c[l+20>>2];Y=c[u>>2]|0;Nb[c[(c[Y>>2]|0)+20>>2]&127](Y,m);if((c[d>>2]|0)>0){w=0;do{x=w+e|0;Y=(c[u>>2]|0)+16|0;y=+g[Y>>2];if(+g[v+(x*152|0)+124>>2]>=y){g[v+(x*152|0)+124>>2]=y;y=+g[Y>>2]}y=-y;if(+g[v+(x*152|0)+120>>2]<=y)g[v+(x*152|0)+120>>2]=y;c[v+(x*152|0)+132>>2]=t;Y=c[t+28>>2]|0;W=+g[v+(x*152|0)>>2];I=+g[v+(x*152|0)+4>>2];J=+g[v+(x*152|0)+8>>2];y=(W*+g[Y+280>>2]+I*+g[Y+284>>2]+J*+g[Y+288>>2])*+g[Y+548>>2];H=(W*+g[Y+296>>2]+I*+g[Y+300>>2]+J*+g[Y+304>>2])*+g[Y+552>>2];g[v+(x*152|0)+64>>2]=(+g[Y+264>>2]*W+ +g[Y+268>>2]*I+ +g[Y+272>>2]*J)*+g[Y+544>>2];g[v+(x*152|0)+68>>2]=y;g[v+(x*152|0)+72>>2]=H;g[v+(x*152|0)+76>>2]=0.0;Y=c[t+32>>2]|0;H=+g[v+(x*152|0)+32>>2];y=+g[v+(x*152|0)+36>>2];J=+g[v+(x*152|0)+40>>2];I=(H*+g[Y+280>>2]+y*+g[Y+284>>2]+J*+g[Y+288>>2])*+g[Y+548>>2];W=(H*+g[Y+296>>2]+y*+g[Y+300>>2]+J*+g[Y+304>>2])*+g[Y+552>>2];g[v+(x*152|0)+80>>2]=(+g[Y+264>>2]*H+ +g[Y+268>>2]*y+ +g[Y+272>>2]*J)*+g[Y+544>>2];g[v+(x*152|0)+84>>2]=I;g[v+(x*152|0)+88>>2]=W;g[v+(x*152|0)+92>>2]=0.0;W=+g[o+344>>2];I=+g[v+(x*152|0)+16>>2];H=+g[v+(x*152|0)+20>>2];G=+g[v+(x*152|0)+24>>2];F=+g[v+(x*152|0)>>2];E=+g[v+(x*152|0)+4>>2];D=+g[v+(x*152|0)+8>>2];X=+g[p+344>>2];C=+g[v+(x*152|0)+48>>2];B=+g[v+(x*152|0)+52>>2];A=+g[v+(x*152|0)+56>>2];z=+g[v+(x*152|0)+32>>2];J=I*W*I+H*W*H+G*W*G+(F*(+g[o+264>>2]*F+ +g[o+268>>2]*E+ +g[o+272>>2]*D)+E*(F*+g[o+280>>2]+E*+g[o+284>>2]+D*+g[o+288>>2])+D*(F*+g[o+296>>2]+E*+g[o+300>>2]+D*+g[o+304>>2]))+(C*X*C+B*X*B+A*X*A)+(z*(+g[p+264>>2]*z+ +g[p+268>>2]*y+ +g[p+272>>2]*J)+y*(z*+g[p+280>>2]+y*+g[p+284>>2]+J*+g[p+288>>2])+J*(z*+g[p+296>>2]+y*+g[p+300>>2]+J*+g[p+304>>2]));if(+P(+J)>1.1920928955078125e-7)T=1.0/J;else T=0.0;g[v+(x*152|0)+108>>2]=T;if(!(c[q+(s*244|0)+240>>2]|0)){X=0.0;K=0.0;L=0.0;M=0.0;N=0.0;O=0.0}else{X=+g[q+(s*244|0)+208>>2];K=+g[q+(s*244|0)+212>>2];L=+g[q+(s*244|0)+216>>2];M=+g[q+(s*244|0)+224>>2];N=+g[q+(s*244|0)+228>>2];O=+g[q+(s*244|0)+232>>2]}if(!(c[q+(r*244|0)+240>>2]|0)){W=0.0;V=0.0;U=0.0;J=0.0;S=0.0;R=0.0}else{W=+g[q+(r*244|0)+208>>2];V=+g[q+(r*244|0)+212>>2];U=+g[q+(r*244|0)+216>>2];J=+g[q+(r*244|0)+224>>2];S=+g[q+(r*244|0)+228>>2];R=+g[q+(r*244|0)+232>>2]}g[v+(x*152|0)+112>>2]=+g[v+(x*152|0)+112>>2]*T+T*(0.0- +g[m+52>>2]*((X+ +g[o+312>>2])*I+(K+ +g[o+316>>2])*H+(L+ +g[o+320>>2])*G+((M+ +g[o+328>>2])*F+(N+ +g[o+332>>2])*E+(O+ +g[o+336>>2])*D)+((W+ +g[p+312>>2])*C+(V+ +g[p+316>>2])*B+(U+ +g[p+320>>2])*A+((J+ +g[p+328>>2])*z+(S+ +g[p+332>>2])*y+(R+ +g[p+336>>2])*+g[v+(x*152|0)+40>>2]))));g[v+(x*152|0)+100>>2]=0.0;w=w+1|0}while((w|0)<(c[d>>2]|0))}d=c[b+176>>2]|0;o=d;d=c[d+(n<<3)>>2]|0}n=n+1|0;if((n|0)>=(k|0))break;else e=d+e|0}}vc[c[(c[b>>2]|0)+28>>2]&127](b,f,h,l);f=c[b+48>>2]|0;j=c[b+28>>2]|0;k=c[b+68>>2]|0;e=c[b+128>>2]|0;if((e|0)<(f|0)?(c[b+132>>2]|0)<(f|0):0){if(!f)h=0;else{c[5004]=(c[5004]|0)+1;h=fF((f<<2|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}e=c[b+128>>2]|0}if((e|0)>0){n=0;do{d=h+(n<<2)|0;if(d)c[d>>2]=c[(c[b+136>>2]|0)+(n<<2)>>2];n=n+1|0}while((n|0)!=(e|0))}e=c[b+136>>2]|0;if(e){if(a[b+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+136>>2]=0}a[b+140>>0]=1;c[b+136>>2]=h;c[b+132>>2]=f}c[b+128>>2]=f;if(!(c[l+64>>2]&16)){h=c[b+108>>2]|0;if((h|0)<(j|0)?(c[b+112>>2]|0)<(j|0):0){if(!j)l=0;else{c[5004]=(c[5004]|0)+1;l=fF((j<<2|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}h=c[b+108>>2]|0}if((h|0)>0){e=0;do{n=l+(e<<2)|0;if(n)c[n>>2]=c[(c[b+116>>2]|0)+(e<<2)>>2];e=e+1|0}while((e|0)!=(h|0))}h=c[b+116>>2]|0;if(h){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=l;c[b+112>>2]=j}c[b+108>>2]=j}else{n=c[b+108>>2]|0;if((n|0)<(j<<1|0)?(c[b+112>>2]|0)<(j<<1|0):0){if(!j)l=0;else{c[5004]=(c[5004]|0)+1;l=fF((j<<3|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}n=c[b+108>>2]|0}if((n|0)>0){e=0;do{h=l+(e<<2)|0;if(h)c[h>>2]=c[(c[b+116>>2]|0)+(e<<2)>>2];e=e+1|0}while((e|0)!=(n|0))}h=c[b+116>>2]|0;if(h){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=l;c[b+112>>2]=j<<1}c[b+108>>2]=j<<1}e=c[b+148>>2]|0;if((e|0)<(k|0)?(c[b+152>>2]|0)<(k|0):0){if(!k)l=0;else{c[5004]=(c[5004]|0)+1;l=fF((k<<2|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}e=c[b+148>>2]|0}if((e|0)>0){h=0;do{n=l+(h<<2)|0;if(n)c[n>>2]=c[(c[b+156>>2]|0)+(h<<2)>>2];h=h+1|0}while((h|0)!=(e|0))}h=c[b+156>>2]|0;if(h){if(a[b+160>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+156>>2]=0}a[b+160>>0]=1;c[b+156>>2]=l;c[b+152>>2]=k}c[b+148>>2]=k;if((f|0)>0){h=c[b+136>>2]|0;l=0;do{c[h+(l<<2)>>2]=l;l=l+1|0}while((l|0)!=(f|0))}if((j|0)>0){l=c[b+116>>2]|0;f=0;do{c[l+(f<<2)>>2]=f;f=f+1|0}while((f|0)!=(j|0))}if((k|0)>0){b=c[b+156>>2]|0;l=0;do{c[b+(l<<2)>>2]=l;l=l+1|0}while((l|0)!=(k|0))}b=c[5022]|0;Y=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=Y;if(Y){i=m;return 0.0}do if(c[b+4>>2]|0){Eb(m+304|0,0)|0;Y=c[5008]|0;g[b+8>>2]=+(((c[m+308>>2]|0)-(c[Y+4>>2]|0)+(((c[m+304>>2]|0)-(c[Y>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=m;return 0.0}}while(0);c[5022]=c[b+20>>2];i=m;return 0.0}function Gr(b,d,e,f,h,j,k,l,m,n){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;n=n|0;var o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0.0,w=0.0;j=i;n=c[b+48>>2]|0;e=c[b+28>>2]|0;h=c[b+68>>2]|0;if(c[m+64>>2]&1){if((n|0)>0){f=c[b+136>>2]|0;q=c[b+192>>2]|0;r=0;do{s=f+(r<<2)|0;t=c[s>>2]|0;r=r+1|0;q=(aa(q,1664525)|0)+1013904223|0;if(r>>>0<65537){u=q>>>16^q;if(r>>>0<257)if(r>>>0<17){u=(u>>>8^u)>>>4^(u>>>8^u);if(r>>>0<5)if(r>>>0<3)u=(u>>>2^u)>>>1^(u>>>2^u);else u=u>>>2^u}else u=u>>>8^u}else u=q;u=f+(((u>>>0)%(r>>>0)|0)<<2)|0;c[s>>2]=c[u>>2];c[u>>2]=t}while((r|0)!=(n|0));c[b+192>>2]=q}if((c[m+20>>2]|0)>(d|0)){if((e|0)>0){s=c[b+116>>2]|0;r=c[b+192>>2]|0;q=0;do{f=s+(q<<2)|0;n=c[f>>2]|0;q=q+1|0;r=(aa(r,1664525)|0)+1013904223|0;if(q>>>0<65537){t=r>>>16^r;if(q>>>0<257)if(q>>>0<17){t=(t>>>8^t)>>>4^(t>>>8^t);if(q>>>0<5)if(q>>>0<3)t=(t>>>2^t)>>>1^(t>>>2^t);else t=t>>>2^t}else t=t>>>8^t}else t=r;u=s+(((t>>>0)%(q>>>0)|0)<<2)|0;c[f>>2]=c[u>>2];c[u>>2]=n}while((q|0)!=(e|0));c[b+192>>2]=r}if((h|0)>0){r=c[b+156>>2]|0;q=c[b+192>>2]|0;f=0;do{n=r+(f<<2)|0;e=c[n>>2]|0;f=f+1|0;q=(aa(q,1664525)|0)+1013904223|0;if(f>>>0<65537){s=q>>>16^q;if(f>>>0<257)if(f>>>0<17){s=(s>>>8^s)>>>4^(s>>>8^s);if(f>>>0<5)if(f>>>0<3)s=(s>>>2^s)>>>1^(s>>>2^s);else s=s>>>2^s}else s=s>>>8^s}else s=q;u=r+(((s>>>0)%(f>>>0)|0)<<2)|0;c[n>>2]=c[u>>2];c[u>>2]=e}while((f|0)!=(h|0));c[b+192>>2]=q}}}f=c[b+48>>2]|0;if(!(c[m+64>>2]&256)){if((f|0)>0){o=0;do{h=c[(c[b+136>>2]|0)+(o<<2)>>2]|0;p=c[b+56>>2]|0;if((c[p+(h*152|0)+136>>2]|0)>(d|0)){f=c[b+16>>2]|0;vr(f+((c[p+(h*152|0)+144>>2]|0)*244|0)|0,f+((c[p+(h*152|0)+148>>2]|0)*244|0)|0,p+(h*152|0)|0);f=c[b+48>>2]|0}o=o+1|0}while((o|0)<(f|0))}if((c[m+20>>2]|0)<=(d|0)){i=j;return 0.0}if((l|0)>0){p=0;do{o=k+(p<<2)|0;d=c[o>>2]|0;if(a[d+20>>0]|0){s=Cr(b,c[d+28>>2]|0,+g[m+12>>2])|0;u=Cr(b,c[(c[o>>2]|0)+32>>2]|0,+g[m+12>>2])|0;t=c[b+16>>2]|0;r=c[o>>2]|0;qc[c[(c[r>>2]|0)+24>>2]&15](r,t+(s*244|0)|0,t+(u*244|0)|0,+g[m+12>>2])}p=p+1|0}while((p|0)!=(l|0))}m=c[b+28>>2]|0;if((m|0)>0){l=0;do{u=c[(c[b+116>>2]|0)+(l<<2)>>2]|0;t=c[b+36>>2]|0;s=c[b+16>>2]|0;wr(s+((c[t+(u*152|0)+144>>2]|0)*244|0)|0,s+((c[t+(u*152|0)+148>>2]|0)*244|0)|0,t+(u*152|0)|0);l=l+1|0}while((l|0)!=(m|0))}m=c[b+68>>2]|0;if((m|0)>0){l=0;do{k=c[(c[b+156>>2]|0)+(l<<2)>>2]|0;o=c[b+76>>2]|0;v=+g[(c[b+36>>2]|0)+((c[o+(k*152|0)+140>>2]|0)*152|0)+100>>2];if(v>0.0){v=v*+g[o+(k*152|0)+104>>2];g[o+(k*152|0)+120>>2]=-v;g[o+(k*152|0)+124>>2]=v;u=c[b+16>>2]|0;vr(u+((c[o+(k*152|0)+144>>2]|0)*244|0)|0,u+((c[o+(k*152|0)+148>>2]|0)*244|0)|0,o+(k*152|0)|0)}l=l+1|0}while((l|0)!=(m|0))}m=c[b+88>>2]|0;if((m|0)<=0){i=j;return 0.0}l=0;do{k=c[b+96>>2]|0;v=+g[(c[b+36>>2]|0)+((c[k+(l*152|0)+140>>2]|0)*152|0)+100>>2];if(v>0.0){w=+g[k+(l*152|0)+104>>2];v=v*w>w?w:v*w;g[k+(l*152|0)+120>>2]=-v;g[k+(l*152|0)+124>>2]=v;u=c[b+16>>2]|0;vr(u+((c[k+(l*152|0)+144>>2]|0)*244|0)|0,u+((c[k+(l*152|0)+148>>2]|0)*244|0)|0,k+(l*152|0)|0)}l=l+1|0}while((l|0)!=(m|0));i=j;return 0.0}if((f|0)>0){h=0;do{n=c[(c[b+136>>2]|0)+(h<<2)>>2]|0;e=c[b+56>>2]|0;if((c[e+(n*152|0)+136>>2]|0)>(d|0)){f=c[b+16>>2]|0;vr(f+((c[e+(n*152|0)+144>>2]|0)*244|0)|0,f+((c[e+(n*152|0)+148>>2]|0)*244|0)|0,e+(n*152|0)|0);f=c[b+48>>2]|0}h=h+1|0}while((h|0)<(f|0))}if((c[m+20>>2]|0)<=(d|0)){i=j;return 0.0}if((l|0)>0){d=0;do{e=k+(d<<2)|0;h=c[e>>2]|0;if(a[h+20>>0]|0){s=Cr(b,c[h+28>>2]|0,+g[m+12>>2])|0;u=Cr(b,c[(c[e>>2]|0)+32>>2]|0,+g[m+12>>2])|0;t=c[b+16>>2]|0;r=c[e>>2]|0;qc[c[(c[r>>2]|0)+24>>2]&15](r,t+(s*244|0)|0,t+(u*244|0)|0,+g[m+12>>2])}d=d+1|0}while((d|0)!=(l|0))}n=c[m+64>>2]|0;l=c[b+28>>2]|0;if(n&512){if((l|0)<=0){i=j;return 0.0}e=0;do{h=c[(c[b+116>>2]|0)+(e<<2)>>2]|0;d=c[b+36>>2]|0;k=c[b+16>>2]|0;wr(k+((c[d+(h*152|0)+144>>2]|0)*244|0)|0,k+((c[d+(h*152|0)+148>>2]|0)*244|0)|0,d+(h*152|0)|0);v=+g[d+(h*152|0)+100>>2];h=aa(e,(n>>>4&1)+1|0)|0;d=c[(c[b+156>>2]|0)+(h<<2)>>2]|0;k=c[b+76>>2]|0;if(v>0.0){w=v*+g[k+(d*152|0)+104>>2];g[k+(d*152|0)+120>>2]=-w;g[k+(d*152|0)+124>>2]=w;u=c[b+16>>2]|0;vr(u+((c[k+(d*152|0)+144>>2]|0)*244|0)|0,u+((c[k+(d*152|0)+148>>2]|0)*244|0)|0,k+(d*152|0)|0)}if((c[m+64>>2]&16|0)!=0?(o=c[(c[b+156>>2]|0)+(h+1<<2)>>2]|0,p=c[b+76>>2]|0,v>0.0):0){w=v*+g[p+(o*152|0)+104>>2];g[p+(o*152|0)+120>>2]=-w;g[p+(o*152|0)+124>>2]=w;u=c[b+16>>2]|0;vr(u+((c[p+(o*152|0)+144>>2]|0)*244|0)|0,u+((c[p+(o*152|0)+148>>2]|0)*244|0)|0,p+(o*152|0)|0)}e=e+1|0}while((e|0)!=(l|0));i=j;return 0.0}if((l|0)>0){m=0;do{u=c[(c[b+116>>2]|0)+(m<<2)>>2]|0;t=c[b+36>>2]|0;s=c[b+16>>2]|0;wr(s+((c[t+(u*152|0)+144>>2]|0)*244|0)|0,s+((c[t+(u*152|0)+148>>2]|0)*244|0)|0,t+(u*152|0)|0);m=m+1|0}while((m|0)!=(l|0))}m=c[b+68>>2]|0;if((m|0)>0){l=0;do{k=c[(c[b+156>>2]|0)+(l<<2)>>2]|0;o=c[b+76>>2]|0;v=+g[(c[b+36>>2]|0)+((c[o+(k*152|0)+140>>2]|0)*152|0)+100>>2];if(v>0.0){w=v*+g[o+(k*152|0)+104>>2];g[o+(k*152|0)+120>>2]=-w;g[o+(k*152|0)+124>>2]=w;u=c[b+16>>2]|0;vr(u+((c[o+(k*152|0)+144>>2]|0)*244|0)|0,u+((c[o+(k*152|0)+148>>2]|0)*244|0)|0,o+(k*152|0)|0)}l=l+1|0}while((l|0)!=(m|0))}k=c[b+88>>2]|0;if((k|0)<=0){i=j;return 0.0}l=0;do{m=c[b+96>>2]|0;v=+g[(c[b+36>>2]|0)+((c[m+(l*152|0)+140>>2]|0)*152|0)+100>>2];if(v>0.0){w=+g[m+(l*152|0)+104>>2];w=v*w>w?w:v*w;g[m+(l*152|0)+120>>2]=-w;g[m+(l*152|0)+124>>2]=w;u=c[b+16>>2]|0;vr(u+((c[m+(l*152|0)+144>>2]|0)*244|0)|0,u+((c[m+(l*152|0)+148>>2]|0)*244|0)|0,m+(l*152|0)|0)}l=l+1|0}while((l|0)!=(k|0));i=j;return 0.0}function Hr(a,b,d,e,f,g,h,j,k){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;j=j|0;k=k|0;d=i;if(!(c[j+44>>2]|0)){i=d;return}h=c[j+20>>2]|0;if(!(c[j+64>>2]&256)){if((h|0)<=0){i=d;return}f=1;while(1){g=c[a+28>>2]|0;if((g|0)>0){h=0;do{e=c[(c[a+116>>2]|0)+(h<<2)>>2]|0;b=c[a+36>>2]|0;k=c[a+16>>2]|0;xr(k+((c[b+(e*152|0)+144>>2]|0)*244|0)|0,k+((c[b+(e*152|0)+148>>2]|0)*244|0)|0,b+(e*152|0)|0);h=h+1|0}while((h|0)!=(g|0));h=c[j+20>>2]|0}if((f|0)>=(h|0))break;f=f+1|0}i=d;return}else{if((h|0)<=0){i=d;return}f=1;while(1){g=c[a+28>>2]|0;if((g|0)>0){h=0;do{e=c[(c[a+116>>2]|0)+(h<<2)>>2]|0;b=c[a+36>>2]|0;k=c[a+16>>2]|0;xr(k+((c[b+(e*152|0)+144>>2]|0)*244|0)|0,k+((c[b+(e*152|0)+148>>2]|0)*244|0)|0,b+(e*152|0)|0);h=h+1|0}while((h|0)!=(g|0));h=c[j+20>>2]|0}if((f|0)>=(h|0))break;f=f+1|0}i=d;return}}function Ir(a,b,d,e,f,h,j,k,l){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;var m=0,n=0,o=0;m=i;i=i+16|0;yE(4112);ec[c[(c[a>>2]|0)+32>>2]&1](a,b,d,e,f,h,j,k,l);o=c[a+184>>2]|0;n=c[k+20>>2]|0;n=(o|0)>(n|0)?o:n;if((n|0)>0){o=0;do{+ic[c[(c[a>>2]|0)+40>>2]&3](a,o,b,d,e,f,h,j,k,l);o=o+1|0}while((o|0)<(n|0))}h=c[5022]|0;o=(c[h+16>>2]|0)+ -1|0;c[h+16>>2]=o;if(o){i=m;return 0.0}do if(c[h+4>>2]|0){Eb(m|0,0)|0;o=c[5008]|0;g[h+8>>2]=+(((c[m+4>>2]|0)-(c[o+4>>2]|0)+(((c[m>>2]|0)-(c[o>>2]|0)|0)*1e6|0)-(c[h+12>>2]|0)|0)>>>0)/1.0e3+ +g[h+8>>2];if(!(c[h+16>>2]|0)){h=c[5022]|0;break}else{i=m;return 0.0}}while(0);c[5022]=c[h+20>>2];i=m;return 0.0}function Jr(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0,q=0,r=0.0,s=0;d=i;i=i+80|0;j=c[b+28>>2]|0;l=c[f+64>>2]|0;if((l&4|0)!=0&(j|0)>0){e=c[b+36>>2]|0;k=c[b+76>>2]|0;if(!(l&16)){l=0;do{q=c[e+(l*152|0)+132>>2]|0;g[q+120>>2]=+g[e+(l*152|0)+100>>2];g[q+124>>2]=+g[k+((c[e+(l*152|0)+140>>2]|0)*152|0)+100>>2];l=l+1|0}while((l|0)!=(j|0))}else{l=0;do{q=c[e+(l*152|0)+132>>2]|0;g[q+120>>2]=+g[e+(l*152|0)+100>>2];p=c[e+(l*152|0)+140>>2]|0;g[q+124>>2]=+g[k+(p*152|0)+100>>2];g[q+128>>2]=+g[k+((p+1|0)*152|0)+100>>2];l=l+1|0}while((l|0)!=(j|0))}}j=c[b+48>>2]|0;if((j|0)>0){k=0;do{e=c[b+56>>2]|0;l=c[e+(k*152|0)+132>>2]|0;q=c[l+44>>2]|0;p=e+(k*152|0)+100|0;if(q){o=+g[p>>2];s=c[l+28>>2]|0;n=1.0/+g[f+12>>2];m=o*+g[e+(k*152|0)+20>>2]*+g[s+352>>2]*n;r=o*+g[e+(k*152|0)+24>>2]*+g[s+356>>2]*n;g[q>>2]=+g[e+(k*152|0)+16>>2]*o*+g[s+348>>2]*n+ +g[q>>2];g[q+4>>2]=m+ +g[q+4>>2];g[q+8>>2]=r+ +g[q+8>>2];r=+g[p>>2];s=c[l+32>>2]|0;m=1.0/+g[f+12>>2];n=r*+g[e+(k*152|0)+52>>2]*+g[s+352>>2]*m;o=r*+g[e+(k*152|0)+56>>2]*+g[s+356>>2]*m;g[q+32>>2]=+g[e+(k*152|0)+48>>2]*r*+g[s+348>>2]*m+ +g[q+32>>2];g[q+36>>2]=n+ +g[q+36>>2];g[q+40>>2]=o+ +g[q+40>>2];s=c[l+28>>2]|0;o=+g[p>>2];n=1.0/+g[f+12>>2];m=+g[e+(k*152|0)+4>>2]*+g[s+548>>2]*o*n;r=o*+g[e+(k*152|0)+8>>2]*+g[s+552>>2]*n;g[q+16>>2]=+g[e+(k*152|0)>>2]*+g[s+544>>2]*o*n+ +g[q+16>>2];g[q+20>>2]=m+ +g[q+20>>2];g[q+24>>2]=r+ +g[q+24>>2];s=c[l+32>>2]|0;r=+g[p>>2];m=1.0/+g[f+12>>2];n=+g[e+(k*152|0)+36>>2]*+g[s+548>>2]*r*m;o=r*+g[e+(k*152|0)+40>>2]*+g[s+552>>2]*m;g[q+48>>2]=+g[e+(k*152|0)+32>>2]*+g[s+544>>2]*r*m+ +g[q+48>>2];g[q+52>>2]=n+ +g[q+52>>2];g[q+56>>2]=o+ +g[q+56>>2]}g[l+36>>2]=+g[p>>2];r=+P(+(+g[p>>2]));if(r>=+g[l+16>>2])a[l+20>>0]=0;k=k+1|0}while((k|0)!=(j|0))}p=c[b+8>>2]|0;if((p|0)>0){j=c[b+16>>2]|0;e=0;do{k=j+(e*244|0)|0;l=c[j+(e*244|0)+240>>2]|0;if(l){if(!(c[f+44>>2]|0)){s=j+(e*244|0)+176|0;o=+g[j+(e*244|0)+64>>2]+ +g[s>>2];g[s>>2]=o;s=j+(e*244|0)+180|0;n=+g[j+(e*244|0)+68>>2]+ +g[s>>2];g[s>>2]=n;s=j+(e*244|0)+184|0;m=+g[j+(e*244|0)+72>>2]+ +g[s>>2];g[s>>2]=m;s=j+(e*244|0)+192|0;g[s>>2]=+g[j+(e*244|0)+80>>2]+ +g[s>>2];s=j+(e*244|0)+196|0;g[s>>2]=+g[j+(e*244|0)+84>>2]+ +g[s>>2];s=j+(e*244|0)+200|0;g[s>>2]=+g[j+(e*244|0)+88>>2]+ +g[s>>2]}else{n=+g[f+12>>2];m=+g[f+52>>2];l=j+(e*244|0)+176|0;g[l>>2]=+g[j+(e*244|0)+64>>2]+ +g[l>>2];l=j+(e*244|0)+180|0;g[l>>2]=+g[j+(e*244|0)+68>>2]+ +g[l>>2];l=j+(e*244|0)+184|0;g[l>>2]=+g[j+(e*244|0)+72>>2]+ +g[l>>2];l=j+(e*244|0)+192|0;g[l>>2]=+g[j+(e*244|0)+80>>2]+ +g[l>>2];l=j+(e*244|0)+196|0;g[l>>2]=+g[j+(e*244|0)+84>>2]+ +g[l>>2];l=j+(e*244|0)+200|0;g[l>>2]=+g[j+(e*244|0)+88>>2]+ +g[l>>2];l=j+(e*244|0)+144|0;p=j+(e*244|0)+148|0;if(((((!(+g[l>>2]!=0.0)?!(+g[p>>2]!=0.0):0)?!(+g[j+(e*244|0)+152>>2]!=0.0):0)?!(+g[j+(e*244|0)+160>>2]!=0.0):0)?!(+g[j+(e*244|0)+164>>2]!=0.0):0)?!(+g[j+(e*244|0)+168>>2]!=0.0):0)k=j;else h=22;if((h|0)==22){h=0;o=+g[j+(e*244|0)+164>>2]*m;r=+g[j+(e*244|0)+168>>2]*m;g[d>>2]=+g[j+(e*244|0)+160>>2]*m;g[d+4>>2]=o;g[d+8>>2]=r;g[d+12>>2]=0.0;Bo(k,+g[l>>2],+g[p>>2],+g[j+(e*244|0)+152>>2],d,n,d+16|0);c[k+0>>2]=c[d+16>>2];c[k+4>>2]=c[d+20>>2];c[k+8>>2]=c[d+24>>2];c[k+12>>2]=c[d+28>>2];k=j+(e*244|0)+16|0;c[k+0>>2]=c[d+32>>2];c[k+4>>2]=c[d+36>>2];c[k+8>>2]=c[d+40>>2];c[k+12>>2]=c[d+44>>2];k=j+(e*244|0)+32|0;c[k+0>>2]=c[d+48>>2];c[k+4>>2]=c[d+52>>2];c[k+8>>2]=c[d+56>>2];c[k+12>>2]=c[d+60>>2];k=j+(e*244|0)+48|0;c[k+0>>2]=c[d+64>>2];c[k+4>>2]=c[d+68>>2];c[k+8>>2]=c[d+72>>2];c[k+12>>2]=c[d+76>>2];k=c[b+16>>2]|0}j=k;o=+g[k+(e*244|0)+176>>2];n=+g[k+(e*244|0)+180>>2];m=+g[k+(e*244|0)+184>>2];l=c[k+(e*244|0)+240>>2]|0}r=o+ +g[j+(e*244|0)+208>>2];o=n+ +g[j+(e*244|0)+212>>2];n=m+ +g[j+(e*244|0)+216>>2];q=l+260|0;c[q>>2]=(c[q>>2]|0)+1;g[l+312>>2]=r;g[l+316>>2]=o;g[l+320>>2]=n;g[l+324>>2]=0.0;q=c[b+16>>2]|0;s=c[q+(e*244|0)+240>>2]|0;n=+g[q+(e*244|0)+192>>2]+ +g[q+(e*244|0)+224>>2];o=+g[q+(e*244|0)+196>>2]+ +g[q+(e*244|0)+228>>2];r=+g[q+(e*244|0)+200>>2]+ +g[q+(e*244|0)+232>>2];c[s+260>>2]=(c[s+260>>2]|0)+1;g[s+328>>2]=n;g[s+332>>2]=o;g[s+336>>2]=r;g[s+340>>2]=0.0;if(c[f+44>>2]|0){q=c[b+16>>2]|0;s=c[q+(e*244|0)+240>>2]|0;p=q+(e*244|0)|0;c[s+260>>2]=(c[s+260>>2]|0)+1;c[s+4>>2]=c[p+0>>2];c[s+8>>2]=c[p+4>>2];c[s+12>>2]=c[p+8>>2];c[s+16>>2]=c[p+12>>2];p=q+(e*244|0)+16|0;c[s+20>>2]=c[p+0>>2];c[s+24>>2]=c[p+4>>2];c[s+28>>2]=c[p+8>>2];c[s+32>>2]=c[p+12>>2];p=q+(e*244|0)+32|0;c[s+36>>2]=c[p+0>>2];c[s+40>>2]=c[p+4>>2];c[s+44>>2]=c[p+8>>2];c[s+48>>2]=c[p+12>>2];q=q+(e*244|0)+48|0;c[s+52>>2]=c[q+0>>2];c[s+56>>2]=c[q+4>>2];c[s+60>>2]=c[q+8>>2];c[s+64>>2]=c[q+12>>2]}j=c[b+16>>2]|0;c[(c[j+(e*244|0)+240>>2]|0)+212>>2]=-1;p=c[b+8>>2]|0}e=e+1|0}while((e|0)<(p|0))}if((c[b+28>>2]|0)<0?(c[b+32>>2]|0)<0:0){f=c[b+36>>2]|0;if(f){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+32>>2]=0}c[b+28>>2]=0;if((c[b+48>>2]|0)<0?(c[b+52>>2]|0)<0:0){f=c[b+56>>2]|0;if(f){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=0;c[b+52>>2]=0}c[b+48>>2]=0;if((c[b+68>>2]|0)<0?(c[b+72>>2]|0)<0:0){f=c[b+76>>2]|0;if(f){if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+76>>2]=0}a[b+80>>0]=1;c[b+76>>2]=0;c[b+72>>2]=0}c[b+68>>2]=0;if((c[b+88>>2]|0)<0?(c[b+92>>2]|0)<0:0){f=c[b+96>>2]|0;if(f){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=0;c[b+92>>2]=0}c[b+88>>2]=0;if((c[b+8>>2]|0)>=0){c[b+8>>2]=0;i=d;return 0.0}if((c[b+12>>2]|0)>=0){c[b+8>>2]=0;i=d;return 0.0}f=c[b+16>>2]|0;if(f){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=0;c[b+12>>2]=0;c[b+8>>2]=0;i=d;return 0.0}function Kr(a,b,d,e,f,h,j,k,l,m){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;m=i;i=i+16|0;yE(4152);+kc[c[(c[a>>2]|0)+44>>2]&3](a,b,d,e,f,h,j,k,l);+kc[c[(c[a>>2]|0)+48>>2]&3](a,b,d,e,f,h,j,k,l);+oc[c[(c[a>>2]|0)+36>>2]&1](a,b,d,k);j=c[5022]|0;e=(c[j+16>>2]|0)+ -1|0;c[j+16>>2]=e;if(e){i=m;return 0.0}do if(c[j+4>>2]|0){Eb(m|0,0)|0;e=c[5008]|0;g[j+8>>2]=+(((c[m+4>>2]|0)-(c[e+4>>2]|0)+(((c[m>>2]|0)-(c[e>>2]|0)|0)*1e6|0)-(c[j+12>>2]|0)|0)>>>0)/1.0e3+ +g[j+8>>2];if(!(c[j+16>>2]|0)){j=c[5022]|0;break}else{i=m;return 0.0}}while(0);c[5022]=c[j+20>>2];i=m;return 0.0}function Lr(a){a=a|0;c[a+192>>2]=0;return}function Mr(a,b,c){a=a|0;b=b|0;c=c|0;return}function Nr(a,b,c){a=a|0;b=b|0;c=c|0;return}function Or(a){a=a|0;return 1}function Pr(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0;f=i;i=i+256|0;if((a[b+180>>0]|0)==0?(a[b+48>>0]|0)!=0:0){no(f+64|0,e,b+116|0);c[b+824>>2]=c[f+64>>2];c[b+828>>2]=c[f+68>>2];c[b+832>>2]=c[f+72>>2];c[b+836>>2]=c[f+76>>2];c[b+840>>2]=c[f+80>>2];c[b+844>>2]=c[f+84>>2];c[b+848>>2]=c[f+88>>2];c[b+852>>2]=c[f+92>>2];c[b+856>>2]=c[f+96>>2];c[b+860>>2]=c[f+100>>2];c[b+864>>2]=c[f+104>>2];c[b+868>>2]=c[f+108>>2];c[b+872>>2]=c[f+112>>2];c[b+876>>2]=c[f+116>>2];c[b+880>>2]=c[f+120>>2];c[b+884>>2]=c[f+124>>2];no(f,d,b+52|0);c[b+888>>2]=c[f+0>>2];c[b+892>>2]=c[f+4>>2];c[b+896>>2]=c[f+8>>2];c[b+900>>2]=c[f+12>>2];c[b+904>>2]=c[f+16>>2];c[b+908>>2]=c[f+20>>2];c[b+912>>2]=c[f+24>>2];c[b+916>>2]=c[f+28>>2];c[b+920>>2]=c[f+32>>2];c[b+924>>2]=c[f+36>>2];c[b+928>>2]=c[f+40>>2];c[b+932>>2]=c[f+44>>2];c[b+936>>2]=c[f+48>>2];c[b+940>>2]=c[f+52>>2];c[b+944>>2]=c[f+56>>2];c[b+948>>2]=c[f+60>>2]}else{no(f+192|0,d,b+52|0);c[b+824>>2]=c[f+192>>2];c[b+828>>2]=c[f+196>>2];c[b+832>>2]=c[f+200>>2];c[b+836>>2]=c[f+204>>2];c[b+840>>2]=c[f+208>>2];c[b+844>>2]=c[f+212>>2];c[b+848>>2]=c[f+216>>2];c[b+852>>2]=c[f+220>>2];c[b+856>>2]=c[f+224>>2];c[b+860>>2]=c[f+228>>2];c[b+864>>2]=c[f+232>>2];c[b+868>>2]=c[f+236>>2];c[b+872>>2]=c[f+240>>2];c[b+876>>2]=c[f+244>>2];c[b+880>>2]=c[f+248>>2];c[b+884>>2]=c[f+252>>2];no(f+128|0,e,b+116|0);c[b+888>>2]=c[f+128>>2];c[b+892>>2]=c[f+132>>2];c[b+896>>2]=c[f+136>>2];c[b+900>>2]=c[f+140>>2];c[b+904>>2]=c[f+144>>2];c[b+908>>2]=c[f+148>>2];c[b+912>>2]=c[f+152>>2];c[b+916>>2]=c[f+156>>2];c[b+920>>2]=c[f+160>>2];c[b+924>>2]=c[f+164>>2];c[b+928>>2]=c[f+168>>2];c[b+932>>2]=c[f+172>>2];c[b+936>>2]=c[f+176>>2];c[b+940>>2]=c[f+180>>2];c[b+944>>2]=c[f+184>>2];c[b+948>>2]=c[f+188>>2]}c[b+968>>2]=c[b+872>>2];c[b+972>>2]=c[b+876>>2];c[b+976>>2]=c[b+880>>2];c[b+980>>2]=c[b+884>>2];c[b+984>>2]=c[b+936>>2];c[b+988>>2]=c[b+940>>2];c[b+992>>2]=c[b+944>>2];c[b+996>>2]=c[b+948>>2];k=+g[b+824>>2];j=+g[b+840>>2];h=+g[b+856>>2];g[b+952>>2]=k;g[b+956>>2]=j;g[b+960>>2]=h;g[b+964>>2]=0.0;if((a[b+180>>0]|0)==0?(a[b+48>>0]|0)==0:0){t=+g[b+968>>2];n=t- +g[b+984>>2];r=+g[b+972>>2];m=r- +g[b+988>>2];q=+g[b+976>>2];l=q- +g[b+992>>2];g[b+1016>>2]=n;g[b+1020>>2]=m;g[b+1024>>2]=l;g[b+1028>>2]=0.0;p=k*n;s=j*m;s=p+s;p=h*l;p=s+p;s=k*p;j=j*p;k=h*p;h=t+s;j=r+j;k=q+k;d=b+1e3|0;g[d>>2]=h;d=b+1004|0;g[d>>2]=j;d=b+1008|0;g[d>>2]=k;d=b+1012|0;g[d>>2]=0.0;d=b+1032|0;g[d>>2]=p;d=b+828|0;e=b+844|0;o=b+860|0;k=+g[d>>2];j=+g[e>>2];h=+g[o>>2];k=k*n;j=j*m;j=k+j;h=h*l;h=j+h;o=b+1036|0;g[o>>2]=h;o=b+832|0;e=b+848|0;d=b+864|0;h=+g[o>>2];j=+g[e>>2];k=+g[d>>2];h=h*n;j=j*m;j=h+j;k=k*l;k=j+k;d=b+1040|0;g[d>>2]=k;i=f;return}v=+g[b+968>>2];q=+g[b+984>>2]-v;u=+g[b+972>>2];s=+g[b+988>>2]-u;l=+g[b+976>>2];t=+g[b+992>>2]-l;g[b+1016>>2]=q;g[b+1020>>2]=s;g[b+1024>>2]=t;g[b+1028>>2]=0.0;r=k*q;m=j*s;m=r+m;r=h*t;r=m+r;m=k*r;n=j*r;p=h*r;m=v+m;n=u+n;p=l+p;o=b+1e3|0;g[o>>2]=m;o=b+1004|0;g[o>>2]=n;o=b+1008|0;g[o>>2]=p;o=b+1012|0;g[o>>2]=0.0;o=b+1032|0;g[o>>2]=r;o=b+828|0;d=b+844|0;e=b+860|0;r=+g[o>>2];p=+g[d>>2];n=+g[e>>2];r=r*q;p=p*s;p=r+p;n=n*t;n=p+n;e=b+1036|0;g[e>>2]=n;e=b+832|0;d=b+848|0;o=b+864|0;n=+g[e>>2];p=+g[d>>2];r=+g[o>>2];q=n*q;s=p*s;s=q+s;t=r*t;t=s+t;o=b+1040|0;g[o>>2]=t;i=f;return}function Qr(b,d){b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0,l=0.0,m=0.0;e=i;if(a[b+48>>0]|0){c[d>>2]=0;c[d+4>>2]=0;i=e;return}c[d>>2]=4;c[d+4>>2]=2;Pr(b,(c[b+28>>2]|0)+4|0,(c[b+32>>2]|0)+4|0);g[b+1088>>2]=0.0;a[b+297>>0]=0;f=+g[b+192>>2];h=+g[b+196>>2];do if(f<=h){m=+g[b+892>>2];l=+g[b+908>>2];j=+g[b+924>>2];f=+Yp(+Y(+(+g[b+832>>2]*m+ +g[b+848>>2]*l+ +g[b+864>>2]*j),+(+g[b+828>>2]*m+ +g[b+844>>2]*l+ +g[b+860>>2]*j)),f,h);g[b+1084>>2]=f;h=+g[b+192>>2];if(f<h){g[b+1088>>2]=f-h;a[b+297>>0]=1;break}h=+g[b+196>>2];if(f>h){g[b+1088>>2]=f-h;a[b+297>>0]=1}}while(0);a[b+296>>0]=0;h=+g[b+1032>>2];g[b+1080>>2]=h;f=+g[b+184>>2];j=+g[b+188>>2];do if(f<=j){if(h>j){g[b+1032>>2]=h-j;a[b+296>>0]=1;k=14;break}if(h<f){g[b+1032>>2]=h-f;a[b+296>>0]=1;k=14}else k=13}else k=13;while(0);if((k|0)==13?(g[b+1032>>2]=0.0,(a[b+1096>>0]|0)!=0):0)k=14;if((k|0)==14){c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1}if((a[b+297>>0]|0)==0?(a[b+1112>>0]|0)==0:0){i=e;return}c[d>>2]=(c[d>>2]|0)+1;c[d+4>>2]=(c[d+4>>2]|0)+ -1;i=e;return}function Rr(b,d){b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0,m=0,n=0,o=0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0,v=0,w=0,x=0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0,H=0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0;e=i;l=c[b+28>>2]|0;m=c[b+32>>2]|0;f=+g[l+344>>2];h=+g[m+344>>2];u=c[d+24>>2]|0;k=(a[b+180>>0]|0)!=0?1.0:-1.0;r=+g[b+936>>2]- +g[b+872>>2];s=+g[b+940>>2]- +g[b+876>>2];t=+g[b+944>>2]- +g[b+880>>2];if(f<1.1920928955078125e-7)o=1;else o=h<1.1920928955078125e-7;if(f+h>0.0)q=h/(f+h);else q=.5;p=1.0-q;I=+g[b+824>>2];D=+g[b+840>>2];z=+g[b+856>>2];M=+g[b+888>>2];O=+g[b+904>>2];B=+g[b+920>>2];G=(a[b+49>>0]|0)==0;do if(!G){C=q*I+p*M;L=q*D+p*O;J=q*z+p*B;E=1.0/+Q(+(C*C+L*L+J*J));if(+P(+(J*E))>.7071067690849304){T=1.0/+Q(+(J*E*J*E+L*E*L*E));f=C*E;h=L*E;j=J*E;y=0.0;A=-(J*E*T);F=L*E*T;K=(J*E*J*E+L*E*L*E)*T;S=-(C*E*L*E*T);T=C*E*-(J*E*T);break}else{T=1.0/+Q(+(C*E*C*E+L*E*L*E));f=C*E;h=L*E;j=J*E;y=-(L*E*T);A=C*E*T;F=0.0;K=-(J*E*C*E*T);S=J*E*-(L*E*T);T=(C*E*C*E+L*E*L*E)*T;break}}else{f=I;h=D;j=z;y=+g[b+828>>2];A=+g[b+844>>2];F=+g[b+860>>2];K=+g[b+832>>2];S=+g[b+848>>2];T=+g[b+864>>2]}while(0);w=c[d+12>>2]|0;g[w>>2]=y;g[w+4>>2]=A;g[w+8>>2]=F;g[w+(u<<2)>>2]=K;g[w+(u+1<<2)>>2]=S;g[w+(u+2<<2)>>2]=T;E=-y;x=c[d+20>>2]|0;g[x>>2]=E;L=-A;g[x+4>>2]=L;N=-F;g[x+8>>2]=N;C=-K;g[x+(u<<2)>>2]=C;R=-S;g[x+(u+1<<2)>>2]=R;J=-T;g[x+(u+2<<2)>>2]=J;v=c[b+300>>2]|0;U=+g[b+280>>2];if(!(v&128))U=U*+g[d+4>>2];_=U*+g[d>>2];$=c[d+28>>2]|0;g[$>>2]=_*((D*B-z*O)*y+(z*M-I*B)*A+(I*O-D*M)*F);g[$+(u<<2)>>2]=_*((D*B-z*O)*K+(z*M-I*B)*S+(I*O-D*M)*T);if(v&64){$=c[d+32>>2]|0;g[$>>2]=+g[b+292>>2];g[$+(u<<2)>>2]=+g[b+292>>2]}I=+g[l+52>>2];O=+g[l+56>>2];M=+g[l+60>>2];z=+g[m+52>>2];D=+g[m+56>>2];B=+g[m+60>>2];if(G){_=(D-O)*F-(B-M)*A;Z=(B-M)*y-(z-I)*F;Y=(z-I)*A-(D-O)*y;g[w+(u<<1<<2)>>2]=q*_;g[w+((u<<1|1)<<2)>>2]=q*Z;g[w+((u<<1)+2<<2)>>2]=q*Y;g[x+(u<<1<<2)>>2]=p*_;g[x+((u<<1|1)<<2)>>2]=p*Z;g[x+((u<<1)+2<<2)>>2]=p*Y;Y=(D-O)*T-(B-M)*S;Z=(B-M)*K-(z-I)*T;_=(z-I)*S-(D-O)*K;g[w+(u*3<<2)>>2]=q*Y;g[w+((u*3|0)+1<<2)>>2]=q*Z;g[w+((u*3|0)+2<<2)>>2]=q*_;g[x+(u*3<<2)>>2]=p*Y;g[x+((u*3|0)+1<<2)>>2]=p*Z;g[x+((u*3|0)+2<<2)>>2]=p*_;H=c[d+8>>2]|0;g[H+(u<<1<<2)>>2]=y;g[H+((u<<1|1)<<2)>>2]=A;g[H+((u<<1)+2<<2)>>2]=F;g[H+(u*3<<2)>>2]=K;g[H+((u*3|0)+1<<2)>>2]=S;g[H+((u*3|0)+2<<2)>>2]=T;G=c[d+16>>2]|0;g[G+(u<<1<<2)>>2]=E;g[G+((u<<1|1)<<2)>>2]=L;g[G+((u<<1)+2<<2)>>2]=N;g[G+(u*3<<2)>>2]=C;g[G+((u*3|0)+1<<2)>>2]=R;g[G+((u*3|0)+2<<2)>>2]=J;L=0.0;N=0.0;R=0.0;C=0.0;E=0.0;J=0.0;D=D-O;B=B-M;z=z-I}else{z=+g[b+936>>2]-z;C=+g[b+940>>2]-D;D=+g[b+944>>2]-B;E=f*z+h*C+j*D;B=f*E;J=h*E;E=j*E;Y=+g[b+872>>2]-I;Z=+g[b+876>>2]-O;_=+g[b+880>>2]-M;F=f*Y+h*Z+j*_;y=f*F;A=h*F;F=j*F;M=+g[b+1080>>2]- +g[b+1032>>2];I=y+f*M-B;O=A+h*M-J;M=F+j*M-E;R=Y-y+q*I;L=Z-A+q*O;N=_-F+q*M;y=q*(z-B)+p*(Y-y);A=q*(C-J)+p*(Z-A);F=q*(D-E)+p*(_-F);if(y*y+A*A+F*F>1.1920928955078125e-7){_=1.0/+Q(+(y*y+A*A+F*F));y=y*_;A=_*A;F=_*F}else{y=+g[b+828>>2];A=+g[b+844>>2];F=+g[b+860>>2]}K=h*F-j*A;S=j*y-f*F;T=f*A-h*y;g[w+(u<<1<<2)>>2]=L*F-N*A;g[w+((u<<1|1)<<2)>>2]=N*y-R*F;g[w+((u<<1)+2<<2)>>2]=R*A-L*y;$=c[d+20>>2]|0;g[$+(u<<1<<2)>>2]=-((C-J-p*O)*F-(D-E-p*M)*A);g[$+((u<<1|1)<<2)>>2]=-((D-E-p*M)*y-(z-B-p*I)*F);g[$+((u<<1)+2<<2)>>2]=-((z-B-p*I)*A-(C-J-p*O)*y);U=(C-J-p*O)*T-(D-E-p*M)*S;W=(D-E-p*M)*K-(z-B-p*I)*T;_=(z-B-p*I)*S-(C-J-p*O)*K;if(o?(a[b+297>>0]|0)!=0:0){U=p*U;W=p*W;_=p*_;Z=q*(L*T-N*S);X=q*(N*K-R*T);Y=q*(R*S-L*K)}else{Z=L*T-N*S;X=N*K-R*T;Y=R*S-L*K}x=c[d+12>>2]|0;g[x+(u*3<<2)>>2]=Z;g[x+((u*3|0)+1<<2)>>2]=X;g[x+((u*3|0)+2<<2)>>2]=Y;x=c[d+20>>2]|0;g[x+(u*3<<2)>>2]=-U;g[x+((u*3|0)+1<<2)>>2]=-W;g[x+((u*3|0)+2<<2)>>2]=-_;H=c[d+8>>2]|0;g[H+(u<<1<<2)>>2]=y;g[H+((u<<1|1)<<2)>>2]=A;g[H+((u<<1)+2<<2)>>2]=F;g[H+(u*3<<2)>>2]=K;g[H+((u*3|0)+1<<2)>>2]=S;g[H+((u*3|0)+2<<2)>>2]=T;G=c[d+16>>2]|0;g[G+(u<<1<<2)>>2]=-y;g[G+((u<<1|1)<<2)>>2]=-A;g[G+((u<<1)+2<<2)>>2]=-F;g[G+(u*3<<2)>>2]=-K;g[G+((u*3|0)+1<<2)>>2]=-S;g[G+((u*3|0)+2<<2)>>2]=-T;v=c[b+300>>2]|0;C=C-J-p*O;E=D-E-p*M;J=z-B-p*I;D=0.0;B=0.0;z=0.0}I=+g[b+264>>2];if(!(v&32))I=I*+g[d+4>>2];_=I*+g[d>>2];w=c[d+28>>2]|0;g[w+(u<<1<<2)>>2]=_*(r*y+s*A+t*F);g[w+(u*3<<2)>>2]=_*(r*K+s*S+t*T);if(v&16){$=c[d+32>>2]|0;g[$+(u<<1<<2)>>2]=+g[b+276>>2];g[$+(u*3<<2)>>2]=+g[b+276>>2]}if(!(a[b+296>>0]|0))if(!(a[b+1096>>0]|0))m=4;else{V=0;$=0;u=0;r=0.0;n=30}else{r=k*+g[b+1032>>2];V=1;$=(a[b+1096>>0]|0)==0;u=r>0.0?2:1;n=30}if((n|0)==30){n=c[d+24>>2]<<2;g[H+(n<<2)>>2]=f;g[H+((n|1)<<2)>>2]=h;g[H+((n|2)<<2)>>2]=j;g[G+(n<<2)>>2]=-f;g[G+((n|1)<<2)>>2]=-h;g[G+((n|2)<<2)>>2]=-j;if(a[b+49>>0]|0){if(!o){H=c[d+12>>2]|0;g[H+(n<<2)>>2]=j*L-h*N;g[H+((n|1)<<2)>>2]=f*N-j*R;g[H+((n|2)<<2)>>2]=h*R-f*L;g[x+(n<<2)>>2]=-(j*C-h*E);g[x+((n|1)<<2)>>2]=-(f*E-j*J);g[x+((n|2)<<2)>>2]=-(h*J-f*C)}}else{Y=j*D-h*B;Z=f*B-j*z;_=h*z-f*D;H=c[d+12>>2]|0;g[H+(n<<2)>>2]=q*Y;g[H+((n|1)<<2)>>2]=q*Z;g[H+((n|2)<<2)>>2]=q*_;g[x+(n<<2)>>2]=p*Y;g[x+((n|1)<<2)>>2]=p*Z;g[x+((n|2)<<2)>>2]=p*_}G=+g[b+184>>2]==+g[b+188>>2];g[w+(n<<2)>>2]=0.0;o=(c[d+36>>2]|0)+(n<<2)|0;g[o>>2]=0.0;H=(c[d+40>>2]|0)+(n<<2)|0;g[H>>2]=0.0;p=+g[((v&512|0)==0?d+4|0:b+232|0)>>2];if(!(V&G|$)){if(v&1)g[(c[d+32>>2]|0)+(n<<2)>>2]=+g[b+212>>2];q=+g[b+1100>>2];y=+g[b+1080>>2];z=+g[b+184>>2];t=+g[b+188>>2];s=p*+g[d>>2];a:do if(!(z>t))if(!(z==t)){if(q/s<0.0){do if(y>=z){if(!(z-q/s>y))break;s=(z-y)/(q/s);break a}while(0);s=y<z?0.0:1.0;break}if(q/s>0.0){do if(y<=t){if(!(t-q/s<y))break;s=(t-y)/(q/s);break a}while(0);s=y>t?0.0:1.0}else s=0.0}else s=0.0;else s=1.0;while(0);g[w+(n<<2)>>2]=+g[w+(n<<2)>>2]-k*s*q;g[o>>2]=+g[o>>2]- +g[b+1104>>2]*+g[d>>2];g[H>>2]=+g[b+1104>>2]*+g[d>>2]+ +g[H>>2]}if(V){g[w+(n<<2)>>2]=+g[w+(n<<2)>>2]+r*p*+g[d>>2];if(v&256)g[(c[d+32>>2]|0)+(n<<2)>>2]=+g[b+244>>2];do if(!G)if((u|0)==1){g[o>>2]=-3.4028234663852886e+38;g[H>>2]=0.0;break}else{g[o>>2]=0.0;g[H>>2]=3.4028234663852886e+38;break}else{g[o>>2]=-3.4028234663852886e+38;g[H>>2]=3.4028234663852886e+38}while(0);_=1.0- +g[b+240>>2];p=+P(+_);do if(!(_!=_|0.0!=0.0|_==0.0)){k=k*(f*+g[l+312>>2]+h*+g[l+316>>2]+j*+g[l+320>>2]-(f*+g[m+312>>2]+h*+g[m+316>>2]+j*+g[m+320>>2]));if((u|0)==1){if(!(k<0.0))break;if(!(+g[w+(n<<2)>>2]<-(p*k)))break;g[w+(n<<2)>>2]=-(p*k);break}else{if(!(k>0.0))break;if(!(+g[w+(n<<2)>>2]>-(p*k)))break;g[w+(n<<2)>>2]=-(p*k);break}}while(0);g[w+(n<<2)>>2]=+g[b+232>>2]*+g[w+(n<<2)>>2];m=5}else m=5}if(!(a[b+297>>0]|0))if(!(a[b+1112>>0]|0)){i=e;return}else{n=0;o=0;l=0;k=0.0}else{k=+g[b+1088>>2];n=1;o=(a[b+1112>>0]|0)==0;l=k>0.0?1:2}m=aa(c[d+24>>2]|0,m)|0;$=c[d+12>>2]|0;g[$+(m<<2)>>2]=f;g[$+(m+1<<2)>>2]=h;g[$+(m+2<<2)>>2]=j;g[x+(m<<2)>>2]=-f;g[x+(m+1<<2)>>2]=-h;g[x+(m+2<<2)>>2]=-j;p=+g[b+192>>2];q=+g[b+196>>2];r=+g[((v&2048|0)==0?d+4|0:b+248|0)>>2];if(!(n&p==q|o)){if(!(v&4)){y=q;A=p}else{g[(c[d+32>>2]|0)+(m<<2)>>2]=+g[b+228>>2];y=+g[b+196>>2];A=+g[b+192>>2]}z=+g[b+1084>>2];s=+g[b+1116>>2];t=r*+g[d>>2];b:do if(!(A>y))if(!(A==y)){if(s/t<0.0){do if(z>=A){if(!(A-s/t>z))break;t=(A-z)/(s/t);break b}while(0);t=z<A?0.0:1.0;break}if(s/t>0.0){do if(z<=y){if(!(y-s/t<z))break;t=(y-z)/(s/t);break b}while(0);t=z>y?0.0:1.0}else t=0.0}else t=0.0;else t=1.0;while(0);g[w+(m<<2)>>2]=t*s;g[(c[d+36>>2]|0)+(m<<2)>>2]=-(+g[b+1120>>2]*+g[d>>2]);g[(c[d+40>>2]|0)+(m<<2)>>2]=+g[b+1120>>2]*+g[d>>2]}if(!n){i=e;return}g[w+(m<<2)>>2]=+g[w+(m<<2)>>2]+k*r*+g[d>>2];if(v&1024)g[(c[d+32>>2]|0)+(m<<2)>>2]=+g[b+260>>2];do if(!(p==q)){n=(c[d+36>>2]|0)+(m<<2)|0;if((l|0)==1){g[n>>2]=0.0;g[(c[d+40>>2]|0)+(m<<2)>>2]=3.4028234663852886e+38;break}else{g[n>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(m<<2)>>2]=0.0;break}}else{g[(c[d+36>>2]|0)+(m<<2)>>2]=-3.4028234663852886e+38;g[(c[d+40>>2]|0)+(m<<2)>>2]=3.4028234663852886e+38}while(0);_=1.0- +g[b+256>>2];k=+P(+_);do if(!(_!=_|0.0!=0.0|_==0.0)){V=c[b+28>>2]|0;$=c[b+32>>2]|0;f=f*+g[V+328>>2]+h*+g[V+332>>2]+j*+g[V+336>>2]-(f*+g[$+328>>2]+h*+g[$+332>>2]+j*+g[$+336>>2]);if((l|0)==1){if(!(f<0.0))break;if(!(+g[w+(m<<2)>>2]<-(k*f)))break;g[w+(m<<2)>>2]=-(k*f);break}else{if(!(f>0.0))break;if(!(+g[w+(m<<2)>>2]>-(k*f)))break;g[w+(m<<2)>>2]=-(k*f);break}}while(0);g[w+(m<<2)>>2]=+g[b+248>>2]*+g[w+(m<<2)>>2];i=e;return}function Sr(a,b,d,e){a=a|0;b=b|0;d=+d;e=e|0;var f=0;f=i;if((b|0)==3){if((e|0)<1){g[a+212>>2]=d;c[a+300>>2]=c[a+300>>2]|1;i=f;return}if((e|0)!=3){i=f;return}g[a+228>>2]=d;c[a+300>>2]=c[a+300>>2]|4;i=f;return}else if((b|0)==4){if((e|0)<1){g[a+244>>2]=d;c[a+300>>2]=c[a+300>>2]|256;i=f;return}if((e|0)<3){g[a+276>>2]=d;c[a+300>>2]=c[a+300>>2]|16;i=f;return}if((e|0)==3){g[a+260>>2]=d;c[a+300>>2]=c[a+300>>2]|1024;i=f;return}if((e|0)>=6){i=f;return}g[a+292>>2]=d;c[a+300>>2]=c[a+300>>2]|64;i=f;return}else if((b|0)==2){if((e|0)<1){g[a+232>>2]=d;c[a+300>>2]=c[a+300>>2]|512;i=f;return}if((e|0)<3){g[a+264>>2]=d;c[a+300>>2]=c[a+300>>2]|32;i=f;return}if((e|0)==3){g[a+248>>2]=d;c[a+300>>2]=c[a+300>>2]|2048;i=f;return}if((e|0)>=6){i=f;return}g[a+280>>2]=d;c[a+300>>2]=c[a+300>>2]|128;i=f;return}else{i=f;return}}function Tr(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0;d=i;do if((b|0)==4){if((c|0)<1){e=+g[a+244>>2];break}if((c|0)<3){e=+g[a+276>>2];break}if((c|0)==3){e=+g[a+260>>2];break}if((c|0)<6)e=+g[a+292>>2];else e=3.4028234663852886e+38}else if((b|0)==3){if((c|0)<1){e=+g[a+212>>2];break}if((c|0)==3)e=+g[a+228>>2];else e=3.4028234663852886e+38}else if((b|0)==2){if((c|0)<1){e=+g[a+232>>2];break}if((c|0)<3){e=+g[a+264>>2];break}if((c|0)==3){e=+g[a+248>>2];break}if((c|0)<6)e=+g[a+280>>2];else e=3.4028234663852886e+38}else e=3.4028234663852886e+38;while(0);i=d;return+e}function Ur(a){a=a|0;return}function Vr(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Wr(a){a=a|0;return 204}function Xr(a,b,e){a=a|0;b=b|0;e=e|0;var f=0;f=i;Zr(a,b,e)|0;g[b+52>>2]=+g[a+52>>2];g[b+56>>2]=+g[a+56>>2];g[b+60>>2]=+g[a+60>>2];g[b+64>>2]=+g[a+64>>2];g[b+68>>2]=+g[a+68>>2];g[b+72>>2]=+g[a+72>>2];g[b+76>>2]=+g[a+76>>2];g[b+80>>2]=+g[a+80>>2];g[b+84>>2]=+g[a+84>>2];g[b+88>>2]=+g[a+88>>2];g[b+92>>2]=+g[a+92>>2];g[b+96>>2]=+g[a+96>>2];g[b+100>>2]=+g[a+100>>2];g[b+104>>2]=+g[a+104>>2];g[b+108>>2]=+g[a+108>>2];g[b+112>>2]=+g[a+112>>2];g[b+116>>2]=+g[a+116>>2];g[b+120>>2]=+g[a+120>>2];g[b+124>>2]=+g[a+124>>2];g[b+128>>2]=+g[a+128>>2];g[b+132>>2]=+g[a+132>>2];g[b+136>>2]=+g[a+136>>2];g[b+140>>2]=+g[a+140>>2];g[b+144>>2]=+g[a+144>>2];g[b+148>>2]=+g[a+148>>2];g[b+152>>2]=+g[a+152>>2];g[b+156>>2]=+g[a+156>>2];g[b+160>>2]=+g[a+160>>2];g[b+164>>2]=+g[a+164>>2];g[b+168>>2]=+g[a+168>>2];g[b+172>>2]=+g[a+172>>2];g[b+176>>2]=+g[a+176>>2];g[b+180>>2]=+g[a+188>>2];g[b+184>>2]=+g[a+184>>2];g[b+188>>2]=+g[a+196>>2];g[b+192>>2]=+g[a+192>>2];c[b+196>>2]=d[a+180>>0];c[b+200>>2]=d[a+49>>0];i=f;return 4352}function Yr(b,d,e){b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+32|0;c[b+4>>2]=d;c[b>>2]=64;c[b+8>>2]=-1;c[b+12>>2]=-1;g[b+16>>2]=3.4028234663852886e+38;a[b+20>>0]=1;a[b+21>>0]=0;c[b+24>>2]=-1;c[b+28>>2]=e;if((a[5024]|0)==0?(Ya(5024)|0)!=0:0){c[f+16>>2]=0;c[f+20>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;lr(4408,0.0,0,0,f+16|0);bb(5024)}c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;mr(4408,0.0,f);c[b+32>>2]=4408;g[b+36>>2]=0.0;g[b+40>>2]=.30000001192092896;c[b+44>>2]=0;i=f;return}function Zr(a,b,e){a=a|0;b=b|0;e=e|0;var f=0,h=0,j=0;f=i;c[b>>2]=gc[c[(c[e>>2]|0)+28>>2]&31](e,c[a+28>>2]|0)|0;c[b+4>>2]=gc[c[(c[e>>2]|0)+28>>2]&31](e,c[a+32>>2]|0)|0;h=gc[c[(c[e>>2]|0)+40>>2]&31](e,a)|0;j=gc[c[(c[e>>2]|0)+28>>2]&31](e,h)|0;c[b+8>>2]=j;if(j)Nb[c[(c[e>>2]|0)+48>>2]&127](e,h);c[b+12>>2]=c[a+4>>2];c[b+24>>2]=d[a+21>>0];c[b+40>>2]=c[a+24>>2];g[b+44>>2]=+g[a+16>>2];c[b+48>>2]=d[a+20>>0];c[b+20>>2]=c[a+12>>2];c[b+16>>2]=c[a+8>>2];g[b+28>>2]=+g[a+36>>2];g[b+32>>2]=+g[a+40>>2];c[b+36>>2]=0;h=c[a+28>>2]|0;if((c[h+488>>2]|0)>0){e=0;do{if((c[(c[h+496>>2]|0)+(e<<2)>>2]|0)==(a|0)){c[b+36>>2]=1;h=c[a+28>>2]|0}e=e+1|0}while((e|0)<(c[h+488>>2]|0))}h=c[a+32>>2]|0;if((c[h+488>>2]|0)>0)e=0;else{i=f;return 4376}do{if((c[(c[h+496>>2]|0)+(e<<2)>>2]|0)==(a|0)){c[b+36>>2]=1;h=c[a+32>>2]|0}e=e+1|0}while((e|0)<(c[h+488>>2]|0));i=f;return 4376}function _r(d,f,h,j,k,l){d=d|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;var m=0,n=0,o=0.0,p=0.0,q=0.0;m=i;c[d>>2]=5216;b[d+4>>1]=-2;b[d+6>>1]=-1;c[d+92>>2]=k;c[d+96>>2]=0;a[d+100>>0]=0;c[d+104>>2]=0;c[d+108>>2]=0;if(!k){c[5004]=(c[5004]|0)+1;k=fF(95)|0;if((k|0)!=0?(c[(k+19&-16)+ -4>>2]=k,(k+19&-16|0)!=0):0){Yz(k+19&-16);k=k+19&-16}else k=0;c[d+92>>2]=k;a[d+100>>0]=1}if(!l){c[5004]=(c[5004]|0)+1;l=fF(43)|0;if((l|0)!=0?(n=l+19&-16,c[n+ -4>>2]=l,(l+19&-16|0)!=0):0){c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;c[n+20>>2]=0;c[(l+19&-16)>>2]=5280;a[n+20>>0]=1;c[n+16>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;n=l+19&-16}else n=0;c[d+112>>2]=n;c[5004]=(c[5004]|0)+1;n=fF(215)|0;if((n|0)!=0?(c[(n+19&-16)+ -4>>2]=n,(n+19&-16|0)!=0):0){Zx(n+19&-16,c[d+112>>2]|0);n=n+19&-16}else n=0;c[d+108>>2]=n;a[n+193>>0]=1}c[d+8>>2]=c[f+0>>2];c[d+12>>2]=c[f+4>>2];c[d+16>>2]=c[f+8>>2];c[d+20>>2]=c[f+12>>2];c[d+24>>2]=c[h+0>>2];c[d+28>>2]=c[h+4>>2];c[d+32>>2]=c[h+8>>2];c[d+36>>2]=c[h+12>>2];q=+(e[d+6>>1]|0);p=q/(+g[d+28>>2]- +g[d+12>>2]);o=q/(+g[d+32>>2]- +g[d+16>>2]);g[d+40>>2]=q/(+g[d+24>>2]- +g[d+8>>2]);g[d+44>>2]=p;g[d+48>>2]=o;g[d+52>>2]=0.0;f=(j&65535)+1&65535;c[5004]=(c[5004]|0)+1;h=fF(f<<6|19)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}if(f){n=h+(f<<6)|0;l=h;do{c[l>>2]=0;c[l+8>>2]=0;l=l+64|0}while((l|0)!=(n|0))}c[d+60>>2]=h;b[d+58>>1]=(j&65535)+1;b[d+56>>1]=0;b[d+64>>1]=1;if(f>>>0>1){j=1;n=1;do{b[h+(j<<6)+48>>1]=j+1;n=n+1<<16>>16;j=n&65535}while(j>>>0<f>>>0)}b[h+(f+ -1<<6)+48>>1]=0;c[5004]=(c[5004]|0)+1;j=fF((f<<3|3)+16|0)|0;if(j){c[(j+19&-16)+ -4>>2]=j;c[d+80>>2]=j+19&-16;if(!(j+19&-16))j=0;else j=j+19&-16}else{c[d+80>>2]=0;j=0}c[d+68>>2]=j;c[5004]=(c[5004]|0)+1;j=fF((f<<3|3)+16|0)|0;if(j){c[(j+19&-16)+ -4>>2]=j;c[d+84>>2]=j+19&-16;if(!(j+19&-16))j=0;else j=j+19&-16}else{c[d+84>>2]=0;j=0}c[d+72>>2]=j;c[5004]=(c[5004]|0)+1;j=fF((f<<3|3)+16|0)|0;if(j){c[(j+19&-16)+ -4>>2]=j;c[d+88>>2]=j+19&-16;if(!(j+19&-16))j=0;else j=j+19&-16}else{c[d+88>>2]=0;j=0}c[d+76>>2]=j;c[c[d+60>>2]>>2]=0;k=c[d+60>>2]|0;b[k+48>>1]=0;b[k+54>>1]=1;l=c[d+68>>2]|0;b[l>>1]=0;b[l+2>>1]=0;b[l+4>>1]=b[d+6>>1]|0;b[l+6>>1]=0;b[k+50>>1]=0;b[k+56>>1]=1;l=c[d+72>>2]|0;b[l>>1]=0;b[l+2>>1]=0;b[l+4>>1]=b[d+6>>1]|0;b[l+6>>1]=0;b[k+52>>1]=0;b[k+58>>1]=1;k=c[d+76>>2]|0;b[k>>1]=0;b[k+2>>1]=0;b[k+4>>1]=b[d+6>>1]|0;b[k+6>>1]=0;c[d>>2]=5040;i=m;return}function $r(a){a=a|0;var b=0;b=i;ss(a);i=b;return}function as(a){a=a|0;var b=0;b=i;ss(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function bs(a,d,f,h,j,k,l,m,n){a=a|0;d=d|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;n=n|0;var o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0;o=i;i=i+16|0;ps(a,o+6|0,+g[d>>2],+g[d+4>>2],+g[d+8>>2],0);ps(a,o,+g[f>>2],+g[f+4>>2],+g[f+8>>2],1);p=b[a+64>>1]|0;q=c[a+60>>2]|0;b[a+64>>1]=b[q+((p&65535)<<6)+48>>1]|0;b[a+56>>1]=(b[a+56>>1]|0)+1<<16>>16;c[q+((p&65535)<<6)+12>>2]=p&65535;c[q+((p&65535)<<6)>>2]=j;b[q+((p&65535)<<6)+4>>1]=k;b[q+((p&65535)<<6)+6>>1]=l;c[q+((p&65535)<<6)+8>>2]=n;u=(e[a+56>>1]|0)<<1;v=(u&65534)+ -1|0;s=(c[a+60>>2]|0)+54|0;b[s>>1]=(e[s>>1]|0)+2;s=c[a+68>>2]|0;r=e[s+(v<<2)>>1]|e[s+(v<<2)+2>>1]<<16;b[s+((u&65534|1)<<2)>>1]=r;b[s+((u&65534|1)<<2)+2>>1]=r>>>16;s=c[a+68>>2]|0;b[s+(v<<2)>>1]=b[o+6>>1]|0;b[s+(v<<2)+2>>1]=p;b[s+((u&65534)<<2)>>1]=b[o>>1]|0;b[s+((u&65534)<<2)+2>>1]=p;b[q+((p&65535)<<6)+48>>1]=v;b[q+((p&65535)<<6)+54>>1]=u;s=(c[a+60>>2]|0)+56|0;b[s>>1]=(e[s>>1]|0)+2;s=c[a+72>>2]|0;r=e[s+(v<<2)>>1]|e[s+(v<<2)+2>>1]<<16;b[s+((u&65534|1)<<2)>>1]=r;b[s+((u&65534|1)<<2)+2>>1]=r>>>16;s=c[a+72>>2]|0;b[s+(v<<2)>>1]=b[o+8>>1]|0;b[s+(v<<2)+2>>1]=p;b[s+((u&65534)<<2)>>1]=b[o+2>>1]|0;b[s+((u&65534)<<2)+2>>1]=p;b[q+((p&65535)<<6)+50>>1]=v;b[q+((p&65535)<<6)+56>>1]=u;s=(c[a+60>>2]|0)+58|0;b[s>>1]=(e[s>>1]|0)+2;s=c[a+76>>2]|0;r=e[s+(v<<2)>>1]|e[s+(v<<2)+2>>1]<<16;b[s+((u&65534|1)<<2)>>1]=r;b[s+((u&65534|1)<<2)+2>>1]=r>>>16;s=c[a+76>>2]|0;b[s+(v<<2)>>1]=b[o+10>>1]|0;b[s+(v<<2)+2>>1]=p;b[s+((u&65534)<<2)>>1]=b[o+4>>1]|0;b[s+((u&65534)<<2)+2>>1]=p;b[q+((p&65535)<<6)+52>>1]=v;b[q+((p&65535)<<6)+58>>1]=u;u=c[a+68>>2]|0;v=e[q+((p&65535)<<6)+48>>1]|0;s=c[a+60>>2]|0;r=b[u+(v+ -1<<2)>>1]|0;if((e[u+(v<<2)>>1]|0)<(r&65535)){n=s+((e[u+(v<<2)+2>>1]|0)<<6)+48|0;t=u+(v<<2)|0;u=u+(v+ -1<<2)|0;while(1){v=e[u+2>>1]|0;if(!(r&1)){v=s+(v<<6)+48|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}else{v=s+(v<<6)+54|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}b[n>>1]=(b[n>>1]|0)+ -1<<16>>16;r=e[t>>1]|e[t+2>>1]<<16;v=e[u>>1]|e[u+2>>1]<<16;b[t>>1]=v;b[t+2>>1]=v>>>16;b[u>>1]=r;b[u+2>>1]=r>>>16;t=t+ -4|0;u=u+ -4|0;r=b[u>>1]|0;if((e[t>>1]|0)>=(r&65535))break;s=c[a+60>>2]|0}n=c[a+68>>2]|0}else n=u;r=e[q+((p&65535)<<6)+54>>1]|0;u=n+(r<<2)|0;t=n+(r+ -1<<2)|0;s=b[t>>1]|0;a:do if((e[u>>1]|0)<(s&65535)){v=c[a+60>>2]|0;n=v+((e[n+(r<<2)+2>>1]|0)<<6)+54|0;r=v;while(1){v=e[t+2>>1]|0;if(!(s&1)){v=r+(v<<6)+48|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}else{v=r+(v<<6)+54|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}b[n>>1]=(b[n>>1]|0)+ -1<<16>>16;s=e[u>>1]|e[u+2>>1]<<16;v=e[t>>1]|e[t+2>>1]<<16;b[u>>1]=v;b[u+2>>1]=v>>>16;b[t>>1]=s;b[t+2>>1]=s>>>16;u=u+ -4|0;t=t+ -4|0;s=b[t>>1]|0;if((e[u>>1]|0)>=(s&65535))break a;r=c[a+60>>2]|0}}while(0);v=c[a+72>>2]|0;u=e[q+((p&65535)<<6)+50>>1]|0;s=c[a+60>>2]|0;r=b[v+(u+ -1<<2)>>1]|0;if((e[v+(u<<2)>>1]|0)<(r&65535)){n=s+((e[v+(u<<2)+2>>1]|0)<<6)+50|0;t=v+(u<<2)|0;u=v+(u+ -1<<2)|0;while(1){v=e[u+2>>1]|0;if(!(r&1)){v=s+(v<<6)+50|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}else{v=s+(v<<6)+56|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}b[n>>1]=(b[n>>1]|0)+ -1<<16>>16;r=e[t>>1]|e[t+2>>1]<<16;v=e[u>>1]|e[u+2>>1]<<16;b[t>>1]=v;b[t+2>>1]=v>>>16;b[u>>1]=r;b[u+2>>1]=r>>>16;t=t+ -4|0;u=u+ -4|0;r=b[u>>1]|0;if((e[t>>1]|0)>=(r&65535))break;s=c[a+60>>2]|0}v=c[a+72>>2]|0}n=e[q+((p&65535)<<6)+56>>1]|0;u=v+(n<<2)|0;t=v+(n+ -1<<2)|0;r=b[t>>1]|0;b:do if((e[u>>1]|0)<(r&65535)){s=c[a+60>>2]|0;n=s+((e[v+(n<<2)+2>>1]|0)<<6)+56|0;while(1){v=e[t+2>>1]|0;if(!(r&1)){v=s+(v<<6)+50|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}else{v=s+(v<<6)+56|0;b[v>>1]=(b[v>>1]|0)+1<<16>>16}b[n>>1]=(b[n>>1]|0)+ -1<<16>>16;r=e[u>>1]|e[u+2>>1]<<16;v=e[t>>1]|e[t+2>>1]<<16;b[u>>1]=v;b[u+2>>1]=v>>>16;b[t>>1]=r;b[t+2>>1]=r>>>16;u=u+ -4|0;t=t+ -4|0;r=b[t>>1]|0;if((e[u>>1]|0)>=(r&65535))break b;s=c[a+60>>2]|0}}while(0);qs(a,2,b[q+((p&65535)<<6)+52>>1]|0);rs(a,2,b[q+((p&65535)<<6)+58>>1]|0,m);q=c[a+60>>2]|0;a=c[a+108>>2]|0;if(!a){v=q+((p&65535)<<6)|0;i=o;return v|0}c[q+((p&65535)<<6)+60>>2]=pc[c[(c[a>>2]|0)+8>>2]&3](a,d,f,h,j,k,l,m,0)|0;v=q+((p&65535)<<6)|0;i=o;return v|0}function cs(a,d,f){a=a|0;d=d|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0;g=i;h=c[a+108>>2]|0;if(h)rc[c[(c[h>>2]|0)+12>>2]&127](h,c[d+60>>2]|0,f);h=c[d+12>>2]|0;d=c[a+60>>2]|0;r=c[a+92>>2]|0;if(!(Pb[c[(c[r>>2]|0)+56>>2]&127](r)|0)){r=c[a+92>>2]|0;rc[c[(c[r>>2]|0)+16>>2]&127](r,d+((h&65535)<<6)|0,f)}f=e[a+56>>1]|0;j=c[a+60>>2]|0;b[j+54>>1]=(e[j+54>>1]|0)+65534;b[j+56>>1]=(e[j+56>>1]|0)+65534;b[j+58>>1]=(e[j+58>>1]|0)+65534;j=0;do{l=a+(j<<2)+68|0;k=c[l>>2]|0;o=e[d+((h&65535)<<6)+(j<<1)+54>>1]|0;b[k+(o<<2)>>1]=b[a+6>>1]|0;p=b[k+(o+1<<2)+2>>1]|0;if(!(p<<16>>16))o=k;else{m=(c[a+60>>2]|0)+((e[k+(o<<2)+2>>1]|0)<<6)+(j<<1)+54|0;n=k+(o<<2)|0;o=k+(o+1<<2)|0;while(1){r=b[o>>1]|0;if((e[n>>1]|0)<(r&65535))break;q=c[a+60>>2]|0;p=p&65535;if(!(r&1)){r=q+(p<<6)+(j<<1)+48|0;b[r>>1]=(b[r>>1]|0)+ -1<<16>>16}else{r=q+(p<<6)+(j<<1)+54|0;b[r>>1]=(b[r>>1]|0)+ -1<<16>>16}b[m>>1]=(b[m>>1]|0)+1<<16>>16;p=e[n>>1]|e[n+2>>1]<<16;r=e[o>>1]|e[o+2>>1]<<16;b[n>>1]=r;b[n+2>>1]=r>>>16;b[o>>1]=p;b[o+2>>1]=p>>>16;p=b[o+6>>1]|0;if(!(p<<16>>16))break;else{n=n+4|0;o=o+4|0}}o=c[l>>2]|0}p=e[d+((h&65535)<<6)+(j<<1)+48>>1]|0;b[k+(p<<2)>>1]=b[a+6>>1]|0;n=b[o+(p+1<<2)+2>>1]|0;a:do if(n<<16>>16){l=(c[a+60>>2]|0)+((e[o+(p<<2)+2>>1]|0)<<6)+(j<<1)+48|0;m=o+(p<<2)|0;o=o+(p+1<<2)|0;while(1){p=b[o>>1]|0;if((e[m>>1]|0)<(p&65535))break a;q=c[a+60>>2]|0;n=n&65535;if(!(p&1)){r=q+(n<<6)+(j<<1)+48|0;b[r>>1]=(b[r>>1]|0)+ -1<<16>>16}else{r=q+(n<<6)+(j<<1)+54|0;b[r>>1]=(b[r>>1]|0)+ -1<<16>>16}b[l>>1]=(b[l>>1]|0)+1<<16>>16;n=e[m>>1]|e[m+2>>1]<<16;r=e[o>>1]|e[o+2>>1]<<16;b[m>>1]=r;b[m+2>>1]=r>>>16;b[o>>1]=n;b[o+2>>1]=n>>>16;n=b[o+6>>1]|0;if(!(n<<16>>16))break;else{m=m+4|0;o=o+4|0}}}while(0);b[k+((f<<1)+ -1<<2)+2>>1]=0;b[k+((f<<1)+ -1<<2)>>1]=b[a+6>>1]|0;j=j+1|0}while((j|0)!=3);b[(c[a+60>>2]|0)+((h&65535)<<6)+48>>1]=b[a+64>>1]|0;b[a+64>>1]=h;b[a+56>>1]=(b[a+56>>1]|0)+ -1<<16>>16;i=g;return}function ds(a,d,f,h,j){a=a|0;d=d|0;f=f|0;h=h|0;j=j|0;var k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0,F=0,G=0,H=0,I=0;k=i;i=i+16|0;c[d+16>>2]=c[f+0>>2];c[d+20>>2]=c[f+4>>2];c[d+24>>2]=c[f+8>>2];c[d+28>>2]=c[f+12>>2];c[d+32>>2]=c[h+0>>2];c[d+36>>2]=c[h+4>>2];c[d+40>>2]=c[h+8>>2];c[d+44>>2]=c[h+12>>2];q=c[a+60>>2]|0;r=c[d+12>>2]&65535;ps(a,k+6|0,+g[f>>2],+g[f+4>>2],+g[f+8>>2],0);ps(a,k,+g[h>>2],+g[h+4>>2],+g[h+8>>2],1);y=0;do{z=b[q+(r<<6)+(y<<1)+48>>1]|0;w=b[q+(r<<6)+(y<<1)+54>>1]|0;F=b[k+6+(y<<1)>>1]|0;A=a+(y<<2)+68|0;I=c[A>>2]|0;H=(F&65535)-(e[I+((z&65535)<<2)>>1]|0)|0;G=b[k+(y<<1)>>1]|0;x=(G&65535)-(e[I+((w&65535)<<2)>>1]|0)|0;b[I+((z&65535)<<2)>>1]=F;b[I+((w&65535)<<2)>>1]=G;if((H|0)<0)qs(a,y,z);a:do if((x|0)>0?(v=c[A>>2]|0,s=c[a+60>>2]|0,t=e[v+((w&65535)<<2)+2>>1]|0,u=b[v+((w&65535)+1<<2)+2>>1]|0,u<<16>>16!=0):0){B=1<<y&3;C=s+(t<<6)+(y<<1)+54|0;I=u;D=v+((w&65535)<<2)|0;E=v+((w&65535)+1<<2)|0;while(1){F=b[E>>1]|0;if((e[D>>1]|0)<(F&65535))break a;G=c[a+60>>2]|0;I=I&65535;if(!(F&1)){if(((((e[s+(t<<6)+(B<<1)+54>>1]|0)>=(e[G+(I<<6)+(B<<1)+48>>1]|0)?(e[G+(I<<6)+(B<<1)+54>>1]|0)>=(e[s+(t<<6)+(B<<1)+48>>1]|0):0)?(e[s+(t<<6)+((1<<B&3)<<1)+54>>1]|0)>=(e[G+(I<<6)+((1<<B&3)<<1)+48>>1]|0):0)?(e[G+(I<<6)+((1<<B&3)<<1)+54>>1]|0)>=(e[s+(t<<6)+((1<<B&3)<<1)+48>>1]|0):0)?(m=c[a+92>>2]|0,n=G+((e[D+2>>1]|0)<<6)|0,Yb[c[(c[m>>2]|0)+8>>2]&31](m,n,G+(I<<6)|0)|0,m=c[a+96>>2]|0,(m|0)!=0):0)Yb[c[(c[m>>2]|0)+8>>2]&31](m,n,G+(I<<6)|0)|0;I=G+(I<<6)+(y<<1)+48|0;b[I>>1]=(b[I>>1]|0)+ -1<<16>>16}else{I=G+(I<<6)+(y<<1)+54|0;b[I>>1]=(b[I>>1]|0)+ -1<<16>>16}b[C>>1]=(b[C>>1]|0)+1<<16>>16;I=e[D>>1]|e[D+2>>1]<<16;G=e[E>>1]|e[E+2>>1]<<16;b[D>>1]=G;b[D+2>>1]=G>>>16;b[E>>1]=I;b[E+2>>1]=I>>>16;I=b[E+6>>1]|0;if(!(I<<16>>16))break;else{D=D+4|0;E=E+4|0}}}while(0);b:do if((H|0)>0?(o=c[A>>2]|0,p=b[o+((z&65535)+1<<2)+2>>1]|0,p<<16>>16!=0):0){B=(c[a+60>>2]|0)+((e[o+((z&65535)<<2)+2>>1]|0)<<6)+(y<<1)+48|0;C=1<<y&3;E=p;A=o+((z&65535)<<2)|0;z=o+((z&65535)+1<<2)|0;while(1){F=b[z>>1]|0;if((e[A>>1]|0)<(F&65535))break b;D=c[a+60>>2]|0;E=E&65535;if(!(F&1)){I=D+(E<<6)+(y<<1)+48|0;b[I>>1]=(b[I>>1]|0)+ -1<<16>>16}else{F=e[A+2>>1]|0;if(((((e[D+(F<<6)+(C<<1)+54>>1]|0)>=(e[D+(E<<6)+(C<<1)+48>>1]|0)?(e[D+(E<<6)+(C<<1)+54>>1]|0)>=(e[D+(F<<6)+(C<<1)+48>>1]|0):0)?(e[D+(F<<6)+((1<<C&3)<<1)+54>>1]|0)>=(e[D+(E<<6)+((1<<C&3)<<1)+48>>1]|0):0)?(e[D+(E<<6)+((1<<C&3)<<1)+54>>1]|0)>=(e[D+(F<<6)+((1<<C&3)<<1)+48>>1]|0):0)?(l=c[a+92>>2]|0,Tb[c[(c[l>>2]|0)+12>>2]&31](l,D+(F<<6)|0,D+(E<<6)|0,j)|0,l=c[a+96>>2]|0,(l|0)!=0):0)Tb[c[(c[l>>2]|0)+12>>2]&31](l,D+(F<<6)|0,D+(E<<6)|0,j)|0;I=D+(E<<6)+(y<<1)+54|0;b[I>>1]=(b[I>>1]|0)+ -1<<16>>16}b[B>>1]=(b[B>>1]|0)+1<<16>>16;E=e[A>>1]|e[A+2>>1]<<16;I=e[z>>1]|e[z+2>>1]<<16;b[A>>1]=I;b[A+2>>1]=I>>>16;b[z>>1]=E;b[z+2>>1]=E>>>16;E=b[z+6>>1]|0;if(!(E<<16>>16))break;else{A=A+4|0;z=z+4|0}}}while(0);if((x|0)<0)rs(a,y,w,j);y=y+1|0}while((y|0)!=3);l=c[a+108>>2]|0;if(!l){i=k;return}Jb[c[(c[l>>2]|0)+16>>2]&31](l,c[d+60>>2]|0,f,h,j);i=k;return}function es(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;a=i;c[d+0>>2]=c[b+16>>2];c[d+4>>2]=c[b+20>>2];c[d+8>>2]=c[b+24>>2];c[d+12>>2]=c[b+28>>2];c[e+0>>2]=c[b+32>>2];c[e+4>>2]=c[b+36>>2];c[e+8>>2]=c[b+40>>2];c[e+12>>2]=c[b+44>>2];i=a;return}function fs(a,d,f,g,h,j){a=a|0;d=d|0;f=f|0;g=g|0;h=h|0;j=j|0;var k=0,l=0;k=i;l=c[a+108>>2]|0;if(l){Zb[c[(c[l>>2]|0)+24>>2]&7](l,d,f,g,h,j);i=k;return}l=b[a+56>>1]|0;if((l&65535)<<1>>>0<=1){i=k;return}h=1;j=2;while(1){f=c[a+68>>2]|0;if(b[f+(h<<2)>>1]&1){gc[c[(c[g>>2]|0)+8>>2]&31](g,(c[a+60>>2]|0)+((e[f+(h<<2)+2>>1]|0)<<6)|0)|0;l=b[a+56>>1]|0}h=j&65535;if(h>>>0>=((l&65535)<<1|1)>>>0)break;j=j+1<<16>>16}i=k;return}function gs(a,d,f,h){a=a|0;d=d|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0;j=i;k=c[a+108>>2]|0;if(k){vc[c[(c[k>>2]|0)+28>>2]&127](k,d,f,h);i=j;return}m=b[a+56>>1]|0;if((m&65535)<<1>>>0<=1){i=j;return}n=1;k=2;while(1){o=c[a+68>>2]|0;if(b[o+(n<<2)>>1]&1){l=c[a+60>>2]|0;n=e[o+(n<<2)+2>>1]|0;if(!(+g[d>>2]>+g[l+(n<<6)+32>>2])?!(+g[f>>2]<+g[l+(n<<6)+16>>2]):0)o=1;else o=0;if(!(!(+g[d+8>>2]>+g[l+(n<<6)+40>>2])?!(+g[f+8>>2]<+g[l+(n<<6)+24>>2]):0))o=0;if(!(+g[d+4>>2]>+g[l+(n<<6)+36>>2])?!(+g[f+4>>2]<+g[l+(n<<6)+20>>2]|o^1):0){gc[c[(c[h>>2]|0)+8>>2]&31](h,l+(n<<6)|0)|0;m=b[a+56>>1]|0}}n=k&65535;if(n>>>0>=((m&65535)<<1|1)>>>0)break;k=k+1<<16>>16}i=j;return}function hs(a,b){a=a|0;b=b|0;var d=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0;f=i;i=i+32|0;r=c[a+92>>2]|0;if(!(Pb[c[(c[r>>2]|0)+56>>2]&127](r)|0)){i=f;return}d=c[a+92>>2]|0;d=Pb[c[(c[d>>2]|0)+28>>2]&127](d)|0;g=c[d+4>>2]|0;if((g|0)>1){os(d,0,g+ -1|0);g=c[d+4>>2]|0}o=g-(c[a+104>>2]|0)|0;c[f+16>>2]=0;c[f+20>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;ns(d,o,f+16|0);c[a+104>>2]=0;o=c[d+4>>2]|0;if((o|0)>0){h=0;p=0;m=0;g=0;while(1){j=c[d+12>>2]|0;k=j+(g<<4)|0;n=c[k>>2]|0;j=j+(g<<4)+4|0;l=c[j>>2]|0;if((n|0)==(h|0))if((l|0)==(p|0)){l=p;n=h;h=12}else{n=h;h=8}else h=8;a:do if((h|0)==8){h=0;q=n+54|0;r=n+48|0;p=0;do{if((e[q+(p<<1)>>1]|0)<(e[l+48+(p<<1)>>1]|0)){h=12;break a}if((e[l+54+(p<<1)>>1]|0)<(e[r+(p<<1)>>1]|0)){h=12;break a}p=p+1|0}while((p|0)<3)}while(0);if((h|0)==12){m=c[a+92>>2]|0;rc[c[(c[m>>2]|0)+32>>2]&127](m,k,b);c[k>>2]=0;c[j>>2]=0;m=(c[a+104>>2]|0)+1|0;c[a+104>>2]=m;c[3808]=(c[3808]|0)+ -1;o=c[d+4>>2]|0}g=g+1|0;if((g|0)>=(o|0))break;else{h=n;p=l}}if((o|0)>1){os(d,0,o+ -1|0);m=c[a+104>>2]|0;o=c[d+4>>2]|0}}else m=0;r=o-m|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;ns(d,r,f);c[a+104>>2]=0;i=f;return}function is(a){a=a|0;return c[a+92>>2]|0}function js(a){a=a|0;return c[a+92>>2]|0}function ks(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;c[b+0>>2]=c[a+8>>2];c[b+4>>2]=c[a+12>>2];c[b+8>>2]=c[a+16>>2];c[b+12>>2]=c[a+20>>2];c[d+0>>2]=c[a+24>>2];c[d+4>>2]=c[a+28>>2];c[d+8>>2]=c[a+32>>2];c[d+12>>2]=c[a+36>>2];i=e;return}function ls(a,d){a=a|0;d=d|0;var e=0,f=0,g=0;d=i;if(b[a+56>>1]|0){i=d;return}b[a+64>>1]=1;f=b[a+58>>1]|0;e=c[a+60>>2]|0;if((f&65535)>1){f=1;g=1;while(1){b[e+(f<<6)+48>>1]=f+1;g=g+1<<16>>16;f=b[a+58>>1]|0;if((g&65535)<(f&65535))f=g&65535;else break}}b[e+((f&65535)+ -1<<6)+48>>1]=0;i=d;return}function ms(a){a=a|0;return}function ns(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0;f=i;g=c[b+4>>2]|0;if(!((g|0)<=(d|0)&(g|0)<(d|0))){c[b+4>>2]=d;i=f;return}if((c[b+8>>2]|0)<(d|0)){if(!d){h=0;j=g}else{c[5004]=(c[5004]|0)+1;h=fF((d<<4|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+4>>2]|0}if((j|0)>0){k=0;do{l=c[b+12>>2]|0;c[h+(k<<4)>>2]=c[l+(k<<4)>>2];c[h+(k<<4)+4>>2]=c[l+(k<<4)+4>>2];c[h+(k<<4)+8>>2]=c[l+(k<<4)+8>>2];c[h+(k<<4)+12>>2]=c[l+(k<<4)+12>>2];k=k+1|0}while((k|0)!=(j|0))}j=c[b+12>>2]|0;if(j){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=h;c[b+8>>2]=d;h=b+12|0}else h=b+12|0;do{l=c[h>>2]|0;c[l+(g<<4)>>2]=c[e>>2];c[l+(g<<4)+4>>2]=c[e+4>>2];c[l+(g<<4)+8>>2]=c[e+8>>2];c[l+(g<<4)+12>>2]=c[e+12>>2];g=g+1|0}while((g|0)!=(d|0));c[b+4>>2]=d;i=f;return}function os(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0;e=i;while(1){j=(b+d|0)/2|0;g=c[a+12>>2]|0;h=c[g+(j<<4)>>2]|0;f=c[g+(j<<4)+4>>2]|0;j=c[g+(j<<4)+8>>2]|0;k=b;o=d;while(1){a:while(1){m=c[g+(k<<4)>>2]|0;if(!m)q=-1;else q=c[m+12>>2]|0;if(!h)n=-1;else n=c[h+12>>2]|0;l=c[g+(k<<4)+4>>2]|0;if(!l)r=-1;else r=c[l+12>>2]|0;if(!f)p=-1;else p=c[f+12>>2]|0;do if((q|0)<=(n|0)){n=(m|0)==(h|0)&(r|0)>(p|0);if(n|(m|0)==(h|0)^1)if(n)break;else break a;if((l|0)!=(f|0))break a;if((c[g+(k<<4)+8>>2]|0)>>>0<=j>>>0)break a}while(0);k=k+1|0}b:do if(!h)while(1){p=c[g+(o<<4)>>2]|0;if(!p)r=-1;else r=c[p+12>>2]|0;if(!f)s=-1;else s=c[f+12>>2]|0;n=c[g+(o<<4)+4>>2]|0;if(!n)q=-1;else q=c[n+12>>2]|0;do if((r|0)>=-1){q=(p|0)==0&(s|0)>(q|0);if(q|(p|0)==0^1)if(q)break;else break b;if((f|0)!=(n|0))break b;if(j>>>0<=(c[g+(o<<4)+8>>2]|0)>>>0)break b}while(0);o=o+ -1|0}else{n=c[h+12>>2]|0;q=o;while(1){p=c[g+(q<<4)>>2]|0;if(!p)t=-1;else t=c[p+12>>2]|0;if(!f)r=-1;else r=c[f+12>>2]|0;o=c[g+(q<<4)+4>>2]|0;if(!o)s=-1;else s=c[o+12>>2]|0;do if((n|0)<=(t|0)){r=(h|0)==(p|0)&(r|0)>(s|0);if(r|(h|0)==(p|0)^1)if(r)break;else{o=q;break b}if((f|0)!=(o|0)){o=q;break b}if(j>>>0<=(c[g+(q<<4)+8>>2]|0)>>>0){o=q;break b}}while(0);q=q+ -1|0}}while(0);if((k|0)<=(o|0)){t=g+(k<<4)|0;r=c[g+(k<<4)+8>>2]|0;s=c[g+(k<<4)+12>>2]|0;q=g+(o<<4)|0;c[t+0>>2]=c[q+0>>2];c[t+4>>2]=c[q+4>>2];c[t+8>>2]=c[q+8>>2];c[t+12>>2]=c[q+12>>2];t=c[a+12>>2]|0;c[t+(o<<4)>>2]=m;c[t+(o<<4)+4>>2]=l;c[t+(o<<4)+8>>2]=r;c[t+(o<<4)+12>>2]=s;k=k+1|0;o=o+ -1|0}if((k|0)>(o|0))break;g=c[a+12>>2]|0}if((o|0)>(b|0))os(a,b,o);if((k|0)<(d|0))b=k;else break}i=e;return}function ps(a,c,d,e,f,h){a=a|0;c=c|0;d=+d;e=+e;f=+f;h=h|0;var j=0,k=0;j=i;d=(d- +g[a+8>>2])*+g[a+40>>2];e=(e- +g[a+12>>2])*+g[a+44>>2];f=(f- +g[a+16>>2])*+g[a+48>>2];do if(!(d<=0.0)){k=b[a+6>>1]|0;if(!(d>=+(k&65535|0))){k=b[a+4>>1]&(~~d&65535)&65535|h;break}else{k=b[a+4>>1]&k&65535|h;break}}else k=h;while(0);b[c>>1]=k;do if(!(e<=0.0)){k=b[a+6>>1]|0;if(!(e>=+(k&65535|0))){k=b[a+4>>1]&(~~e&65535)&65535|h;break}else{k=b[a+4>>1]&k&65535|h;break}}else k=h;while(0);b[c+2>>1]=k;if(f<=0.0){h=h&65535;k=c+4|0;b[k>>1]=h;i=j;return}k=b[a+6>>1]|0;if(!(f>=+(k&65535|0))){h=b[a+4>>1]&(~~f&65535)&65535|h;h=h&65535;k=c+4|0;b[k>>1]=h;i=j;return}else{h=b[a+4>>1]&k&65535|h;h=h&65535;k=c+4|0;b[k>>1]=h;i=j;return}}function qs(a,d,f){a=a|0;d=d|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;l=i;p=c[a+(d<<2)+68>>2]|0;g=c[a+60>>2]|0;h=e[p+((f&65535)<<2)+2>>1]|0;n=b[p+((f&65535)+ -1<<2)>>1]|0;if((e[p+((f&65535)<<2)>>1]|0)>=(n&65535)){i=l;return}m=g;o=p+((f&65535)<<2)|0;p=p+((f&65535)+ -1<<2)|0;while(1){f=e[p+2>>1]|0;if(!(n&1)){f=m+(f<<6)+(d<<1)+48|0;b[f>>1]=(b[f>>1]|0)+1<<16>>16}else{if(((((e[g+(h<<6)+((1<<d&3)<<1)+54>>1]|0)>=(e[m+(f<<6)+((1<<d&3)<<1)+48>>1]|0)?(e[m+(f<<6)+((1<<d&3)<<1)+54>>1]|0)>=(e[g+(h<<6)+((1<<d&3)<<1)+48>>1]|0):0)?(e[g+(h<<6)+((1<<(1<<d&3)&3)<<1)+54>>1]|0)>=(e[m+(f<<6)+((1<<(1<<d&3)&3)<<1)+48>>1]|0):0)?(e[m+(f<<6)+((1<<(1<<d&3)&3)<<1)+54>>1]|0)>=(e[g+(h<<6)+((1<<(1<<d&3)&3)<<1)+48>>1]|0):0)?(j=c[a+92>>2]|0,k=m+(f<<6)|0,Yb[c[(c[j>>2]|0)+8>>2]&31](j,g+(h<<6)|0,k)|0,j=c[a+96>>2]|0,(j|0)!=0):0)Yb[c[(c[j>>2]|0)+8>>2]&31](j,g+(h<<6)|0,k)|0;f=m+(f<<6)+(d<<1)+54|0;b[f>>1]=(b[f>>1]|0)+1<<16>>16}b[g+(h<<6)+(d<<1)+48>>1]=(b[g+(h<<6)+(d<<1)+48>>1]|0)+ -1<<16>>16;n=e[o>>1]|e[o+2>>1]<<16;f=e[p>>1]|e[p+2>>1]<<16;b[o>>1]=f;b[o+2>>1]=f>>>16;b[p>>1]=n;b[p+2>>1]=n>>>16;o=o+ -4|0;p=p+ -4|0;n=b[p>>1]|0;if((e[o>>1]|0)>=(n&65535))break;m=c[a+60>>2]|0}i=l;return}function rs(a,d,f,g){a=a|0;d=d|0;f=f|0;g=g|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;j=i;q=c[a+(d<<2)+68>>2]|0;o=b[q+((f&65535)+ -1<<2)>>1]|0;if((e[q+((f&65535)<<2)>>1]|0)>=(o&65535)){i=j;return}n=c[a+60>>2]|0;h=n+((e[q+((f&65535)<<2)+2>>1]|0)<<6)+(d<<1)+54|0;p=q+((f&65535)<<2)|0;q=q+((f&65535)+ -1<<2)|0;while(1){f=e[q+2>>1]|0;if(!(o&1)){o=e[p+2>>1]|0;if(((((e[n+(o<<6)+((1<<d&3)<<1)+54>>1]|0)>=(e[n+(f<<6)+((1<<d&3)<<1)+48>>1]|0)?(e[n+(f<<6)+((1<<d&3)<<1)+54>>1]|0)>=(e[n+(o<<6)+((1<<d&3)<<1)+48>>1]|0):0)?(e[n+(o<<6)+((1<<(1<<d&3)&3)<<1)+54>>1]|0)>=(e[n+(f<<6)+((1<<(1<<d&3)&3)<<1)+48>>1]|0):0)?(e[n+(f<<6)+((1<<(1<<d&3)&3)<<1)+54>>1]|0)>=(e[n+(o<<6)+((1<<(1<<d&3)&3)<<1)+48>>1]|0):0)?(l=c[a+92>>2]|0,m=n+(o<<6)|0,k=n+(f<<6)|0,Tb[c[(c[l>>2]|0)+12>>2]&31](l,m,k,g)|0,l=c[a+96>>2]|0,(l|0)!=0):0)Tb[c[(c[l>>2]|0)+12>>2]&31](l,m,k,g)|0;f=n+(f<<6)+(d<<1)+48|0;b[f>>1]=(b[f>>1]|0)+1<<16>>16}else{f=n+(f<<6)+(d<<1)+54|0;b[f>>1]=(b[f>>1]|0)+1<<16>>16}b[h>>1]=(b[h>>1]|0)+ -1<<16>>16;o=e[p>>1]|e[p+2>>1]<<16;f=e[q>>1]|e[q+2>>1]<<16;b[p>>1]=f;b[p+2>>1]=f>>>16;b[q>>1]=o;b[q+2>>1]=o>>>16;p=p+ -4|0;q=q+ -4|0;o=b[q>>1]|0;if((e[p>>1]|0)>=(o&65535))break;n=c[a+60>>2]|0}i=j;return}function ss(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=5216;if(c[b+108>>2]|0){e=c[b+112>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+112>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+108>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+108>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}}e=c[b+88>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+84>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+80>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+60>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}if(!(a[b+100>>0]|0)){i=d;return}e=c[b+92>>2]|0;Lb[c[c[e>>2]>>2]&511](e);b=c[b+92>>2]|0;if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function ts(a){a=a|0;var b=0;b=i;ss(a);i=b;return}function us(a){a=a|0;var b=0;b=i;ss(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function vs(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=5280;e=c[b+16>>2]|0;if(e){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;i=d;return}function ws(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=5280;e=c[b+16>>2]|0;if((e|0)!=0?(a[b+20>>0]|0)!=0:0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}gF(b);i=d;return}function xs(a,b,c){a=a|0;b=b|0;c=c|0;return 0}function ys(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return 0}function zs(a,b,c){a=a|0;b=b|0;c=c|0;return}function As(a){a=a|0;return c[a+16>>2]|0}function Bs(a){a=a|0;return c[a+16>>2]|0}function Cs(a){a=a|0;return a+4|0}function Ds(a,b,c){a=a|0;b=b|0;c=c|0;return}function Es(a){a=a|0;return 0}function Fs(a,b,c){a=a|0;b=b|0;c=c|0;return}function Gs(a,b){a=a|0;b=b|0;return}function Hs(a,b,c){a=a|0;b=b|0;c=c|0;return}function Is(a,b,c){a=a|0;b=b|0;c=c|0;return 0}function Js(a){a=a|0;return 1}function Ks(a,b){a=a|0;b=b|0;return}function Ls(a,b){a=a|0;b=b|0;return}function Ms(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0;f=i;k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=k+ +g[a+28>>2];m=k+ +g[a+32>>2];k=k+ +g[a+36>>2];w=+P(+(+g[b>>2]));v=+P(+(+g[b+4>>2]));u=+P(+(+g[b+8>>2]));s=+P(+(+g[b+16>>2]));r=+P(+(+g[b+20>>2]));q=+P(+(+g[b+24>>2]));n=+P(+(+g[b+32>>2]));l=+P(+(+g[b+36>>2]));j=+P(+(+g[b+40>>2]));t=+g[b+48>>2];p=+g[b+52>>2];h=+g[b+56>>2];g[d>>2]=t-(o*w+m*v+k*u);g[d+4>>2]=p-(o*s+m*r+k*q);g[d+8>>2]=h-(o*n+m*l+k*j);g[d+12>>2]=0.0;g[e>>2]=o*w+m*v+k*u+t;g[e+4>>2]=o*s+m*r+k*q+p;g[e+8>>2]=o*n+m*l+k*j+h;g[e+12>>2]=0.0;i=f;return}function Ns(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;k=+g[a+28>>2];h=+g[a+32>>2];l=+g[a+36>>2];j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);l=(l+ +$b[c[(c[a>>2]|0)+48>>2]&15](a))*2.0;g[d>>2]=b/12.0*((h+f)*2.0*(h+f)*2.0+l*l);g[d+4>>2]=b/12.0*((k+j)*2.0*(k+j)*2.0+l*l);g[d+8>>2]=b/12.0*((k+j)*2.0*(k+j)*2.0+(h+f)*2.0*(h+f)*2.0);g[d+12>>2]=0.0;i=e;return}function Os(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(!d){i=b;return}Lb[c[c[d>>2]>>2]&511](d);a=c[a+52>>2]|0;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Ps(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(d){Lb[c[c[d>>2]>>2]&511](d);d=c[a+52>>2]|0;if(d){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}if(!a){i=b;return}}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Qs(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0;d=i;m=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=(m+ +g[a+28>>2])/+g[a+12>>2];l=(j+ +g[a+32>>2])/+g[a+16>>2];h=(e+ +g[a+36>>2])/+g[a+20>>2];n=+P(+(+g[b>>2]));k=+P(+(+g[b+4>>2]));f=+P(+(+g[b+8>>2]));g[a+12>>2]=n;g[a+16>>2]=k;g[a+20>>2]=f;g[a+24>>2]=0.0;g[a+28>>2]=o*n-m;g[a+32>>2]=l*k-j;g[a+36>>2]=h*f-e;g[a+40>>2]=0.0;i=d;return}function Rs(a){a=a|0;return 5608}function Ss(a,b){a=a|0;b=+b;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=j+ +g[a+28>>2];f=f+ +g[a+32>>2];k=k+ +g[a+36>>2];g[a+44>>2]=b;h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);b=k- +$b[c[(c[a>>2]|0)+48>>2]&15](a);g[a+28>>2]=j-h;g[a+32>>2]=f-e;g[a+36>>2]=b;g[a+40>>2]=0.0;i=d;return}function Ts(a){a=a|0;return+(+g[a+44>>2])}function Us(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;k=+g[b+28>>2];l=+g[b+32>>2];f=+g[b+36>>2];j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);h=+$b[c[(c[b>>2]|0)+48>>2]&15](b);f=f+ +$b[c[(c[b>>2]|0)+48>>2]&15](b);h=+g[d+4>>2]>=0.0?l+h:-(l+h);f=+g[d+8>>2]>=0.0?f:-f;g[a>>2]=+g[d>>2]>=0.0?k+j:-(k+j);g[a+4>>2]=h;g[a+8>>2]=f;g[a+12>>2]=0.0;i=e;return}function Vs(a,b,c){a=a|0;b=b|0;c=c|0;var d=0.0,e=0.0,f=0.0;f=+g[b+28>>2];e=+g[b+32>>2];e=+g[c+4>>2]>=0.0?e:-e;d=+g[b+36>>2];d=+g[c+8>>2]>=0.0?d:-d;g[a>>2]=+g[c>>2]>=0.0?f:-f;g[a+4>>2]=e;g[a+8>>2]=d;g[a+12>>2]=0.0;return}function Ws(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0;e=i;if((d|0)<=0){i=e;return}f=0;do{k=+g[a+28>>2];j=+g[a+32>>2];j=+g[b+(f<<4)+4>>2]>=0.0?j:-j;h=+g[a+36>>2];h=+g[b+(f<<4)+8>>2]>=0.0?h:-h;g[c+(f<<4)>>2]=+g[b+(f<<4)>>2]>=0.0?k:-k;g[c+(f<<4)+4>>2]=j;g[c+(f<<4)+8>>2]=h;g[c+(f<<4)+12>>2]=0.0;f=f+1|0}while((f|0)!=(d|0));i=e;return}function Xs(a){a=a|0;return 6}function Ys(a,b,c){a=a|0;b=b|0;c=c|0;a=i;switch(b|0){case 5:{g[c>>2]=0.0;g[c+4>>2]=0.0;g[c+8>>2]=-1.0;g[c+12>>2]=0.0;i=a;return};case 3:{g[c>>2]=0.0;g[c+4>>2]=-1.0;g[c+8>>2]=0.0;g[c+12>>2]=0.0;i=a;return};case 2:{g[c>>2]=0.0;g[c+4>>2]=1.0;g[c+8>>2]=0.0;g[c+12>>2]=0.0;i=a;return};case 4:{g[c>>2]=0.0;g[c+4>>2]=0.0;g[c+8>>2]=1.0;g[c+12>>2]=0.0;i=a;return};case 0:{g[c>>2]=1.0;g[c+4>>2]=0.0;g[c+8>>2]=0.0;g[c+12>>2]=0.0;i=a;return};case 1:{g[c>>2]=-1.0;g[c+4>>2]=0.0;g[c+8>>2]=0.0;g[c+12>>2]=0.0;i=a;return};default:{i=a;return}}}function Zs(a){a=a|0;return 8}function _s(a){a=a|0;return 12}function $s(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;do switch(b|0){case 9:{g=4;b=6;break};case 3:{g=2;break};case 8:{g=4;b=5;break};case 1:{g=0;b=2;break};case 0:{g=0;b=1;break};case 11:{g=6;b=7;break};case 2:{g=1;b=3;break};case 7:{g=3;break};case 10:{g=5;b=7;break};case 6:{g=2;break};case 5:{g=1;break};case 4:{g=0;break};default:{g=0;b=0}}while(0);rc[c[(c[a>>2]|0)+108>>2]&127](a,g,d);rc[c[(c[a>>2]|0)+108>>2]&127](a,b,e);i=f;return}function at(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;l=+g[a+28>>2];j=+g[a+32>>2];f=+g[a+36>>2];k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=f+ +$b[c[(c[a>>2]|0)+48>>2]&15](a);g[d>>2]=+(b&1^1|0)*(l+k)- +(b&1|0)*(l+k);g[d+4>>2]=+(b>>>1&1^1|0)*(j+h)- +(b>>>1&1|0)*(j+h);g[d+8>>2]=+(b>>>2&1^1|0)*f- +(b>>>2&1|0)*f;g[d+12>>2]=0.0;i=e;return}function bt(a){a=a|0;return 6}function ct(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0;f=i;i=i+48|0;rc[c[(c[a>>2]|0)+124>>2]&127](a,f+32|0,e);k=+g[f+32>>2];j=+g[f+36>>2];h=+g[f+40>>2];g[b>>2]=k;g[b+4>>2]=j;g[b+8>>2]=h;g[b+12>>2]=0.0;e=c[(c[a>>2]|0)+64>>2]|0;g[f>>2]=-k;g[f+4>>2]=-j;g[f+8>>2]=-h;g[f+12>>2]=0.0;rc[e&127](f+16|0,a,f);c[d+0>>2]=c[f+16>>2];c[d+4>>2]=c[f+20>>2];c[d+8>>2]=c[f+24>>2];c[d+12>>2]=c[f+28>>2];i=f;return}function dt(a,b,c){a=a|0;b=b|0;c=+c;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;d=i;k=+g[a+28>>2];e=+g[a+32>>2];j=+g[a+36>>2];l=+g[b>>2];if((((l<=k+c?l>=-k-c:0)?(h=+g[b+4>>2],h<=e+c):0)?h>=-e-c:0)?(f=+g[b+8>>2],f<=j+c):0)b=f>=-j-c;else b=0;i=d;return b|0}function et(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0,f=0.0,h=0.0;d=i;e=+g[a+28>>2];f=+g[a+32>>2];h=+g[a+36>>2];switch(c|0){case 1:{g[b>>2]=-1.0;g[b+4>>2]=0.0;g[b+8>>2]=0.0;g[b+12>>2]=-e;i=d;return};case 0:{g[b>>2]=1.0;g[b+4>>2]=0.0;g[b+8>>2]=0.0;g[b+12>>2]=-e;i=d;return};case 4:{g[b>>2]=0.0;g[b+4>>2]=0.0;g[b+8>>2]=1.0;g[b+12>>2]=-h;i=d;return};case 3:{g[b>>2]=0.0;g[b+4>>2]=-1.0;g[b+8>>2]=0.0;g[b+12>>2]=-f;i=d;return};case 2:{g[b>>2]=0.0;g[b+4>>2]=1.0;g[b+8>>2]=0.0;g[b+12>>2]=-f;i=d;return};case 5:{g[b>>2]=0.0;g[b+4>>2]=0.0;g[b+8>>2]=-1.0;g[b+12>>2]=-h;i=d;return};default:{i=d;return}}}function ft(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0;h=i;i=i+48|0;c[b+8>>2]=0;g[b+12>>2]=0.0;c[b>>2]=17416;c[b+48>>2]=d;c[b+4>>2]=21;if(Pb[c[(c[d>>2]|0)+40>>2]&127](d)|0)rc[c[(c[d>>2]|0)+48>>2]&127](d,b+16|0,b+32|0);else{c[h+32>>2]=0;c[h+36>>2]=0;c[h+40>>2]=0;c[h+44>>2]=0;g[h+32>>2]=1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h+16|0,b,h+32|0);g[b+32>>2]=+g[h+16>>2]+ +g[b+12>>2];g[h+32>>2]=-1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h,b,h+32|0);c[h+16>>2]=c[h+0>>2];c[h+20>>2]=c[h+4>>2];c[h+24>>2]=c[h+8>>2];c[h+28>>2]=c[h+12>>2];g[b+16>>2]=+g[h+16>>2]- +g[b+12>>2];c[h+32>>2]=0;c[h+36>>2]=0;c[h+40>>2]=0;c[h+44>>2]=0;g[h+36>>2]=1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h+16|0,b,h+32|0);g[b+36>>2]=+g[h+20>>2]+ +g[b+12>>2];g[h+36>>2]=-1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h,b,h+32|0);c[h+16>>2]=c[h+0>>2];c[h+20>>2]=c[h+4>>2];c[h+24>>2]=c[h+8>>2];c[h+28>>2]=c[h+12>>2];g[b+20>>2]=+g[h+20>>2]- +g[b+12>>2];c[h+32>>2]=0;c[h+36>>2]=0;c[h+40>>2]=0;c[h+44>>2]=0;g[h+40>>2]=1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h+16|0,b,h+32|0);g[b+40>>2]=+g[h+24>>2]+ +g[b+12>>2];g[h+40>>2]=-1.0;rc[c[(c[b>>2]|0)+68>>2]&127](h,b,h+32|0);c[h+16>>2]=c[h+0>>2];c[h+20>>2]=c[h+4>>2];c[h+24>>2]=c[h+8>>2];c[h+28>>2]=c[h+12>>2];g[b+24>>2]=+g[h+24>>2]- +g[b+12>>2]}c[b>>2]=5624;c[b+52>>2]=0;c[b+56>>2]=0;a[b+60>>0]=e&1;a[b+61>>0]=0;c[b+4>>2]=21;if(!f){i=h;return}c[5004]=(c[5004]|0)+1;e=fF(191)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}c[e+52>>2]=282;a[e+60>>0]=0;a[e+80>>0]=1;c[e+76>>2]=0;c[e+68>>2]=0;c[e+72>>2]=0;a[e+100>>0]=1;c[e+96>>2]=0;c[e+88>>2]=0;c[e+92>>2]=0;a[e+120>>0]=1;c[e+116>>2]=0;c[e+108>>2]=0;c[e+112>>2]=0;a[e+140>>0]=1;c[e+136>>2]=0;c[e+128>>2]=0;c[e+132>>2]=0;c[e+144>>2]=0;a[e+164>>0]=1;c[e+160>>2]=0;c[e+152>>2]=0;c[e+156>>2]=0;c[e+168>>2]=0;g[e+4>>2]=-3.4028234663852886e+38;g[e+8>>2]=-3.4028234663852886e+38;g[e+12>>2]=-3.4028234663852886e+38;g[e+16>>2]=0.0;g[e+20>>2]=3.4028234663852886e+38;g[e+24>>2]=3.4028234663852886e+38;g[e+28>>2]=3.4028234663852886e+38;g[e+32>>2]=0.0;c[e>>2]=14880;c[b+52>>2]=e;Pz(e,c[b+48>>2]|0,(a[b+60>>0]|0)!=0,b+16|0,b+32|0);a[b+61>>0]=1;i=h;return}function gt(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=5624;if(a[b+61>>0]|0){e=c[b+52>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+52>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}if(!b){i=d;return}}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function ht(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=5624;if(!(a[b+61>>0]|0)){i=d;return}e=c[b+52>>2]|0;Lb[c[c[e>>2]>>2]&511](e);b=c[b+52>>2]|0;if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function it(d,f,h,j){d=d|0;f=f|0;h=h|0;j=j|0;var k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0;k=i;i=i+80|0;w=c[d+48>>2]|0;c[k>>2]=5808;c[k+4>>2]=w;c[k+8>>2]=f;f=c[d+52>>2]|0;if(!(a[f+60>>0]|0)){n=c[f+56>>2]|0;a:do if((n|0)>0){m=0;l=c[f+96>>2]|0;d=1;while(1){if(!(+g[h>>2]>+g[l+16>>2])?!(+g[j>>2]<+g[l>>2]):0)r=1;else r=0;if(!(!(+g[h+8>>2]>+g[l+24>>2])?!(+g[j+8>>2]<+g[l+8>>2]):0))r=0;if(!(+g[h+4>>2]>+g[l+20>>2])?!(+g[j+4>>2]<+g[l+4>>2]):0){q=c[l+32>>2]|0;if((q|0)==-1&r){rc[c[(c[k>>2]|0)+8>>2]&127](k,c[l+36>>2]|0,c[l+40>>2]|0);n=c[f+56>>2]|0;o=44}else{p=(q|0)==-1;o=43}}else{q=c[l+32>>2]|0;p=(q|0)==-1;r=0;o=43}if((o|0)==43){o=0;if(r|p)o=44;else{m=q+m|0;l=l+(q<<6)|0}}if((o|0)==44){m=m+1|0;l=l+64|0}if((m|0)>=(n|0))break a;d=d+1|0}}else d=0;while(0);if((c[4028]|0)>=(d|0)){i=k;return}c[4028]=d;i=k;return}z=+g[h>>2];D=+g[h+4>>2];H=+g[h+8>>2];G=+g[f+4>>2];z=z<G?G:z;C=+g[f+8>>2];D=D<C?C:D;y=+g[f+12>>2];H=H<y?y:H;I=+g[f+20>>2];E=+g[f+24>>2];A=+g[f+28>>2];F=+g[f+36>>2];B=+g[f+40>>2];x=+g[f+44>>2];h=~~(((I<z?I:z)-G)*F)&65534;b[k+66>>1]=h;l=~~(((E<D?E:D)-C)*B)&65534;b[k+68>>1]=l;d=~~(((A<H?A:H)-y)*x)&65534;b[k+70>>1]=d;H=+g[j>>2];D=+g[j+4>>2];z=+g[j+8>>2];H=H<G?G:H;D=D<C?C:D;z=z<y?y:z;m=(~~(((I<H?I:H)-G)*F+1.0)&65535|1)&65535;b[k+60>>1]=m;n=(~~(((E<D?E:D)-C)*B+1.0)&65535|1)&65535;b[k+62>>1]=n;j=(~~(((A<z?A:z)-y)*x+1.0)&65535|1)&65535;b[k+64>>1]=j;o=c[f+144>>2]|0;if(!o){o=c[f+56>>2]|0;b:do if((o|0)>0){p=0;q=c[f+136>>2]|0;f=1;while(1){t=((m&65535)>=(e[q>>1]|0)?(h&65535)<=(e[q+6>>1]|0):0)&(d&65535)<=(e[q+10>>1]|0)&(j&65535)>=(e[q+4>>1]|0)&(l&65535)<=(e[q+8>>1]|0)&(n&65535)>=(e[q+2>>1]|0);s=q+12|0;r=c[s>>2]|0;if((r|0)>-1&t)rc[c[(c[k>>2]|0)+8>>2]&127](k,r>>21,r&2097151);if(t|(r|0)>-1){p=p+1|0;q=q+16|0}else{w=c[s>>2]|0;p=p-w|0;q=q+(0-w<<4)|0}if((p|0)>=(o|0))break b;f=f+1|0}}else f=0;while(0);if((c[4028]|0)>=(f|0)){i=k;return}c[4028]=f;i=k;return}else if((o|0)==1){if((c[f+152>>2]|0)<=0){i=k;return}o=0;do{q=c[f+160>>2]|0;if(((m&65535)>=(e[q+(o<<5)>>1]|0)?(h&65535)<=(e[q+(o<<5)+6>>1]|0):0)&(d&65535)<=(e[q+(o<<5)+10>>1]|0)&(j&65535)>=(e[q+(o<<5)+4>>1]|0)&(l&65535)<=(e[q+(o<<5)+8>>1]|0)&(n&65535)>=(e[q+(o<<5)+2>>1]|0)){p=c[q+(o<<5)+12>>2]|0;q=c[q+(o<<5)+16>>2]|0;c:do if((q|0)>0){s=p;t=(c[f+136>>2]|0)+(p<<4)|0;r=1;while(1){v=((m&65535)>=(e[t>>1]|0)?(h&65535)<=(e[t+6>>1]|0):0)&(d&65535)<=(e[t+10>>1]|0)&(j&65535)>=(e[t+4>>1]|0)&(l&65535)<=(e[t+8>>1]|0)&(n&65535)>=(e[t+2>>1]|0);u=t+12|0;w=c[u>>2]|0;if((w|0)>-1&v)rc[c[(c[k>>2]|0)+8>>2]&127](k,w>>21,w&2097151);if(v|(w|0)>-1){s=s+1|0;t=t+16|0}else{w=c[u>>2]|0;s=s-w|0;t=t+(0-w<<4)|0}if((s|0)>=(q+p|0))break c;r=r+1|0}}else r=0;while(0);if((c[4028]|0)<(r|0))c[4028]=r}o=o+1|0}while((o|0)<(c[f+152>>2]|0));i=k;return}else if((o|0)==2){NA(c[f+136>>2]|0,k,k+66|0,k+60|0);i=k;return}else{i=k;return}}function jt(b,d){b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0;e=i;l=Pb[c[(c[b>>2]|0)+28>>2]&127](b)|0;k=+g[l>>2]- +g[d>>2];j=+g[l+4>>2]- +g[d+4>>2];h=+g[l+8>>2]- +g[d+8>>2];if(!(k*k+j*j+h*h>1.1920928955078125e-7)){i=e;return}hC(b,d);if((a[b+61>>0]|0)!=0?(f=c[b+52>>2]|0,Lb[c[c[f>>2]>>2]&511](f),f=c[b+52>>2]|0,(f|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[5004]=(c[5004]|0)+1;f=fF(191)|0;if(!f)f=0;else{c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}c[f+52>>2]=282;a[f+60>>0]=0;a[f+80>>0]=1;c[f+76>>2]=0;c[f+68>>2]=0;c[f+72>>2]=0;a[f+100>>0]=1;c[f+96>>2]=0;c[f+88>>2]=0;c[f+92>>2]=0;a[f+120>>0]=1;c[f+116>>2]=0;c[f+108>>2]=0;c[f+112>>2]=0;a[f+140>>0]=1;c[f+136>>2]=0;c[f+128>>2]=0;c[f+132>>2]=0;c[f+144>>2]=0;a[f+164>>0]=1;c[f+160>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+168>>2]=0;g[f+4>>2]=-3.4028234663852886e+38;g[f+8>>2]=-3.4028234663852886e+38;g[f+12>>2]=-3.4028234663852886e+38;g[f+16>>2]=0.0;g[f+20>>2]=3.4028234663852886e+38;g[f+24>>2]=3.4028234663852886e+38;g[f+28>>2]=3.4028234663852886e+38;g[f+32>>2]=0.0;c[f>>2]=14880;c[b+52>>2]=f;Pz(f,c[b+48>>2]|0,(a[b+60>>0]|0)!=0,b+16|0,b+32|0);a[b+61>>0]=1;i=e;return}function kt(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0;e=i;h=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;j=gc[c[(c[d>>2]|0)+28>>2]&31](d,h)|0;c[b>>2]=j;if(j)Nb[c[(c[d>>2]|0)+48>>2]&127](d,h);c[b+4>>2]=c[a+4>>2];j=c[a+48>>2]|0;Yb[c[(c[j>>2]|0)+56>>2]&31](j,b+12|0,d)|0;g[b+52>>2]=+g[a+12>>2];do if((c[a+52>>2]|0)!=0?((Pb[c[(c[d>>2]|0)+52>>2]&127](d)|0)&1|0)==0:0){h=gc[c[(c[d>>2]|0)+24>>2]&31](d,c[a+52>>2]|0)|0;if(!h){c[b+40>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,c[a+52>>2]|0)|0;c[b+44>>2]=0;h=c[a+52>>2]|0;h=Pb[c[(c[h>>2]|0)+12>>2]&127](h)|0;h=Yb[c[(c[d>>2]|0)+16>>2]&31](d,h,1)|0;j=c[a+52>>2]|0;j=Yb[c[(c[j>>2]|0)+16>>2]&31](j,c[h+8>>2]|0,d)|0;Jb[c[(c[d>>2]|0)+20>>2]&31](d,h,j,1213612625,c[a+52>>2]|0);break}else{c[b+40>>2]=h;c[b+44>>2]=0;break}}else f=8;while(0);if((f|0)==8){c[b+40>>2]=0;c[b+44>>2]=0}if((c[a+56>>2]|0)!=0?((Pb[c[(c[d>>2]|0)+52>>2]&127](d)|0)&2|0)==0:0){f=gc[c[(c[d>>2]|0)+24>>2]&31](d,c[a+56>>2]|0)|0;if(!f){c[b+48>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,c[a+56>>2]|0)|0;h=c[a+56>>2]|0;h=Pb[c[(c[h>>2]|0)+8>>2]&127](h)|0;h=Yb[c[(c[d>>2]|0)+16>>2]&31](d,h,1)|0;j=c[a+56>>2]|0;j=Yb[c[(c[j>>2]|0)+12>>2]&31](j,c[h+8>>2]|0,d)|0;Jb[c[(c[d>>2]|0)+20>>2]&31](d,h,j,1346456916,c[a+56>>2]|0);i=e;return 5712}else{c[b+48>>2]=f;i=e;return 5712}}c[b+48>>2]=0;i=e;return 5712}function lt(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;e=c[a+52>>2]|0;if(!e){i=d;return}f=Pb[c[(c[e>>2]|0)+12>>2]&127](e)|0;f=Yb[c[(c[b>>2]|0)+16>>2]&31](b,f,1)|0;e=c[a+52>>2]|0;e=Yb[c[(c[e>>2]|0)+16>>2]&31](e,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,e,1213612625,c[a+52>>2]|0);i=d;return}function mt(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;e=c[a+56>>2]|0;if(!e){i=d;return}f=Pb[c[(c[e>>2]|0)+8>>2]&127](e)|0;f=Yb[c[(c[b>>2]|0)+16>>2]&31](b,f,1)|0;e=c[a+56>>2]|0;e=Yb[c[(c[e>>2]|0)+12>>2]&31](e,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,e,1346456916,c[a+56>>2]|0);i=d;return}function nt(a){a=a|0;return 5784}function ot(a,b){a=a|0;b=+b;g[a+12>>2]=b;return}function pt(a){a=a|0;return+(+g[a+12>>2])}function qt(a){a=a|0;return 60}function rt(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);i=e;return}function st(a){a=a|0;return}function tt(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ut(a,b,f){a=a|0;b=b|0;f=f|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0.0,s=0.0;o=i;i=i+32|0;l=c[a+4>>2]|0;fc[c[(c[l>>2]|0)+16>>2]&3](l,o+28|0,o+24|0,o+20|0,o+16|0,o+12|0,o+8|0,o+4|0,o,b);l=c[o+12>>2]|0;m=aa(c[o+8>>2]|0,f)|0;k=c[a+4>>2]|0;n=c[o>>2]|0;j=2;while(1){if((n|0)==2)q=c[l+m+(j<<2)>>2]|0;else if((n|0)==3)q=e[l+m+(j<<1)>>1]|0;else q=d[l+(j+m)>>0]|0;p=c[o+28>>2]|0;q=aa(c[o+16>>2]|0,q)|0;if(!(c[o+20>>2]|0)){s=+g[p+(q+4)>>2]*+g[k+8>>2];r=+g[p+(q+8)>>2]*+g[k+12>>2];g[a+(j<<4)+12>>2]=+g[p+q>>2]*+g[k+4>>2];g[a+(j<<4)+16>>2]=s;g[a+(j<<4)+20>>2]=r;g[a+(j<<4)+24>>2]=0.0}else{r=+h[p+(q+8)>>3]*+g[k+8>>2];s=+h[p+(q+16)>>3]*+g[k+12>>2];g[a+(j<<4)+12>>2]=+h[p+q>>3]*+g[k+4>>2];g[a+(j<<4)+16>>2]=r;g[a+(j<<4)+20>>2]=s;g[a+(j<<4)+24>>2]=0.0}if((j|0)>0)j=j+ -1|0;else break}q=c[a+8>>2]|0;vc[c[(c[q>>2]|0)+8>>2]&127](q,a+12|0,b,f);q=c[a+4>>2]|0;Nb[c[(c[q>>2]|0)+24>>2]&127](q,b);i=o;return}function vt(a){a=a|0;return}function wt(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function xt(a,b,d){a=a|0;b=b|0;d=d|0;var f=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0.0,s=0.0;n=i;i=i+80|0;l=c[a+4>>2]|0;fc[c[(c[l>>2]|0)+16>>2]&3](l,n+28|0,n+24|0,n+20|0,n+16|0,n+12|0,n+8|0,n+4|0,n,b);l=c[n+12>>2]|0;k=aa(c[n+8>>2]|0,d)|0;f=c[a+4>>2]|0;m=(c[n+20>>2]|0)==0;j=c[n+28>>2]|0;if((c[n>>2]|0)!=3){o=c[n+16>>2]|0;p=aa(o,c[l+(k+8)>>2]|0)|0;if(m){s=+g[j+(p+4)>>2]*+g[f+8>>2];r=+g[j+(p+8)>>2]*+g[f+12>>2];g[n+64>>2]=+g[j+p>>2]*+g[f+4>>2];g[n+68>>2]=s;g[n+72>>2]=r;g[n+76>>2]=0.0;q=aa(o,c[l+(k+4)>>2]|0)|0;r=+g[j+(q+4)>>2]*+g[f+8>>2];s=+g[j+(q+8)>>2]*+g[f+12>>2];g[n+48>>2]=+g[j+q>>2]*+g[f+4>>2];g[n+52>>2]=r;g[n+56>>2]=s;g[n+60>>2]=0.0;q=aa(o,c[l+k>>2]|0)|0;s=+g[j+(q+4)>>2]*+g[f+8>>2];r=+g[j+(q+8)>>2]*+g[f+12>>2];g[n+32>>2]=+g[j+q>>2]*+g[f+4>>2];g[n+36>>2]=s;g[n+40>>2]=r;g[n+44>>2]=0.0;q=a+8|0;q=c[q>>2]|0;p=c[q>>2]|0;p=p+8|0;p=c[p>>2]|0;vc[p&127](q,n+32|0,b,d);q=c[a+4>>2]|0;p=c[q>>2]|0;p=p+24|0;p=c[p>>2]|0;Nb[p&127](q,b);i=n;return}else{r=+h[j+(p+8)>>3]*+g[f+8>>2];s=+h[j+(p+16)>>3]*+g[f+12>>2];g[n+64>>2]=+h[j+p>>3]*+g[f+4>>2];g[n+68>>2]=r;g[n+72>>2]=s;g[n+76>>2]=0.0;q=aa(o,c[l+(k+4)>>2]|0)|0;s=+h[j+(q+8)>>3]*+g[f+8>>2];r=+h[j+(q+16)>>3]*+g[f+12>>2];g[n+48>>2]=+h[j+q>>3]*+g[f+4>>2];g[n+52>>2]=s;g[n+56>>2]=r;g[n+60>>2]=0.0;q=aa(o,c[l+k>>2]|0)|0;r=+h[j+(q+8)>>3]*+g[f+8>>2];s=+h[j+(q+16)>>3]*+g[f+12>>2];g[n+32>>2]=+h[j+q>>3]*+g[f+4>>2];g[n+36>>2]=r;g[n+40>>2]=s;g[n+44>>2]=0.0;q=a+8|0;q=c[q>>2]|0;p=c[q>>2]|0;p=p+8|0;p=c[p>>2]|0;vc[p&127](q,n+32|0,b,d);q=c[a+4>>2]|0;p=c[q>>2]|0;p=p+24|0;p=c[p>>2]|0;Nb[p&127](q,b);i=n;return}}o=c[n+16>>2]|0;p=2;while(1){q=aa(o,e[l+k+(p<<1)>>1]|0)|0;if(m){r=+g[j+(q+4)>>2]*+g[f+8>>2];s=+g[j+(q+8)>>2]*+g[f+12>>2];g[n+32+(p<<4)>>2]=+g[j+q>>2]*+g[f+4>>2];g[n+32+(p<<4)+4>>2]=r;g[n+32+(p<<4)+8>>2]=s;g[n+32+(p<<4)+12>>2]=0.0}else{r=+h[j+(q+8)>>3]*+g[f+8>>2];s=+h[j+(q+16)>>3]*+g[f+12>>2];g[n+32+(p<<4)>>2]=+h[j+q>>3]*+g[f+4>>2];g[n+32+(p<<4)+4>>2]=r;g[n+32+(p<<4)+8>>2]=s;g[n+32+(p<<4)+12>>2]=0.0}if((p|0)>0)p=p+ -1|0;else break}q=a+8|0;q=c[q>>2]|0;p=c[q>>2]|0;p=p+8|0;p=c[p>>2]|0;vc[p&127](q,n+32|0,b,d);q=c[a+4>>2]|0;p=c[q>>2]|0;p=p+24|0;p=c[p>>2]|0;Nb[p&127](q,b);i=n;return}function yt(a){a=a|0;return}function zt(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function At(a,b,d){a=a|0;b=b|0;d=d|0;var f=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0.0,r=0.0;n=i;i=i+80|0;m=c[a+4>>2]|0;fc[c[(c[m>>2]|0)+16>>2]&3](m,n+28|0,n+24|0,n+20|0,n+16|0,n+12|0,n+8|0,n+4|0,n,b);m=(c[n+12>>2]|0)+(aa(c[n+8>>2]|0,d)|0)|0;k=c[a+4>>2]|0;f=(c[n>>2]|0)==3;l=(c[n+20>>2]|0)==0;j=c[n+28>>2]|0;o=2;while(1){if(f)p=e[m+(o<<1)>>1]|0;else p=c[m+(o<<2)>>2]|0;p=aa(c[n+16>>2]|0,p)|0;if(l){r=+g[j+(p+4)>>2]*+g[k+8>>2];q=+g[j+(p+8)>>2]*+g[k+12>>2];g[n+32+(o<<4)>>2]=+g[j+p>>2]*+g[k+4>>2];g[n+32+(o<<4)+4>>2]=r;g[n+32+(o<<4)+8>>2]=q;g[n+32+(o<<4)+12>>2]=0.0}else{q=+h[j+(p+8)>>3]*+g[k+8>>2];r=+h[j+(p+16)>>3]*+g[k+12>>2];g[n+32+(o<<4)>>2]=+h[j+p>>3]*+g[k+4>>2];g[n+32+(o<<4)+4>>2]=q;g[n+32+(o<<4)+8>>2]=r;g[n+32+(o<<4)+12>>2]=0.0}if((o|0)>0)o=o+ -1|0;else break}p=c[a+8>>2]|0;vc[c[(c[p>>2]|0)+8>>2]&127](p,n+32|0,b,d);p=c[a+4>>2]|0;Nb[c[(c[p>>2]|0)+24>>2]&127](p,b);i=n;return}function Bt(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0;e=i;i=i+32|0;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;f=+g[d>>2];h=+g[d+4>>2];j=+g[d+8>>2];if(f*f+h*h+j*j<9999999747378752.0e-20){f=1.0;h=0.0;j=0.0}else{q=1.0/+Q(+(f*f+h*h+j*j));f=f*q;h=h*q;j=j*q}d=c[b+52>>2]|0;m=+g[b+(((d+2|0)%3|0)<<2)+28>>2];c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;g[e+16+(d<<2)>>2]=+g[b+(d<<2)+28>>2];l=f*m;k=h*m;m=j*m;q=l+ +g[e+16>>2];n=k+ +g[e+20>>2];o=m+ +g[e+24>>2];p=+$b[c[(c[b>>2]|0)+48>>2]&15](b);q=q-f*p;n=n-h*p;p=o-j*p;o=j*p+(f*q+h*n);if(o>-999999984306749400.0){g[a>>2]=q;g[a+4>>2]=n;g[a+8>>2]=p;g[a+12>>2]=0.0}else o=-999999984306749400.0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;d=c[b+52>>2]|0;g[e+(d<<2)>>2]=-+g[b+(d<<2)+28>>2];l=l+ +g[e>>2];k=k+ +g[e+4>>2];q=m+ +g[e+8>>2];m=+$b[c[(c[b>>2]|0)+48>>2]&15](b);l=l-f*m;k=k-h*m;m=q-j*m;if(!(j*m+(f*l+h*k)>o)){i=e;return}g[a>>2]=l;g[a+4>>2]=k;g[a+8>>2]=m;g[a+12>>2]=0.0;i=e;return}function Ct(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0,k=0,l=0,m=0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0;f=i;i=i+32|0;k=c[a+52>>2]|0;h=+g[a+(((k+2|0)%3|0)<<2)+28>>2];if((e|0)<=0){i=f;return}j=0;while(1){m=a+(k<<2)+28|0;c[f+16>>2]=0;c[f+20>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;g[f+16+(k<<2)>>2]=+g[m>>2];m=b+(j<<4)|0;l=b+(j<<4)+4|0;k=b+(j<<4)+8|0;u=h*+g[m>>2]+ +g[f+16>>2];s=h*+g[l>>2]+ +g[f+20>>2];q=h*+g[k>>2]+ +g[f+24>>2];w=+$b[c[(c[a>>2]|0)+48>>2]&15](a);t=+g[m>>2];r=+g[l>>2];v=+g[k>>2];if(t*(u-w*t)+r*(s-w*r)+v*(q-w*v)>-999999984306749400.0){g[d+(j<<4)>>2]=u-w*t;g[d+(j<<4)+4>>2]=s-w*r;g[d+(j<<4)+8>>2]=q-w*v;g[d+(j<<4)+12>>2]=0.0;p=+g[m>>2];o=+g[l>>2];n=+g[k>>2];q=t*(u-w*t)+r*(s-w*r)+v*(q-w*v)}else{p=t;o=r;n=v;q=-999999984306749400.0}c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;x=c[a+52>>2]|0;g[f+(x<<2)>>2]=-+g[a+(x<<2)+28>>2];p=h*p+ +g[f>>2];o=h*o+ +g[f+4>>2];r=h*n+ +g[f+8>>2];n=+$b[c[(c[a>>2]|0)+48>>2]&15](a);s=+g[m>>2];t=+g[l>>2];u=+g[k>>2];if(s*(p-n*s)+t*(o-n*t)+u*(r-n*u)>q){g[d+(j<<4)>>2]=p-n*s;g[d+(j<<4)+4>>2]=o-n*t;g[d+(j<<4)+8>>2]=r-n*u;g[d+(j<<4)+12>>2]=0.0}j=j+1|0;if((j|0)==(e|0))break;k=c[a+52>>2]|0}i=f;return}function Dt(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0;e=i;i=i+16|0;k=c[a+52>>2]|0;h=+g[a+(((k+2|0)%3|0)<<2)+28>>2];g[e>>2]=h;g[e+4>>2]=h;g[e+8>>2]=h;g[e+12>>2]=0.0;g[e+(k<<2)>>2]=+g[a+(k<<2)+28>>2]+ +g[e+(k<<2)>>2];h=(+g[e>>2]+.03999999910593033)*2.0;f=(+g[e+4>>2]+.03999999910593033)*2.0;j=(+g[e+8>>2]+.03999999910593033)*2.0;g[d>>2]=b*.0833333283662796*(f*f+j*j);g[d+4>>2]=b*.0833333283662796*(h*h+j*j);g[d+8>>2]=b*.0833333283662796*(h*h+f*f);i=e;return}function Et(a){a=a|0;return}function Ft(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Gt(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0;f=i;i=i+16|0;x=c[a+52>>2]|0;k=+g[a+(((x+2|0)%3|0)<<2)+28>>2];g[f>>2]=k;g[f+4>>2]=k;g[f+8>>2]=k;g[f+12>>2]=0.0;g[f+(x<<2)>>2]=k+ +g[a+(x<<2)+28>>2];k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);n=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=k+ +g[f>>2];g[f>>2]=k;h=h+ +g[f+4>>2];g[f+4>>2]=h;n=n+ +g[f+8>>2];u=+P(+(+g[b>>2]));t=+P(+(+g[b+4>>2]));v=+P(+(+g[b+8>>2]));q=+P(+(+g[b+16>>2]));p=+P(+(+g[b+20>>2]));r=+P(+(+g[b+24>>2]));l=+P(+(+g[b+32>>2]));j=+P(+(+g[b+36>>2]));m=+P(+(+g[b+40>>2]));w=+g[b+48>>2];s=+g[b+52>>2];o=+g[b+56>>2];g[d>>2]=w-(n*v+(u*k+t*h));g[d+4>>2]=s-(n*r+(q*k+p*h));g[d+8>>2]=o-(n*m+(l*k+j*h));g[d+12>>2]=0.0;g[e>>2]=w+(n*v+(u*k+t*h));g[e+4>>2]=s+(n*r+(q*k+p*h));g[e+8>>2]=o+(n*m+(l*k+j*h));g[e+12>>2]=0.0;i=f;return}function Ht(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0;d=i;m=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=(m+ +g[a+28>>2])/+g[a+12>>2];l=(j+ +g[a+32>>2])/+g[a+16>>2];h=(e+ +g[a+36>>2])/+g[a+20>>2];n=+P(+(+g[b>>2]));k=+P(+(+g[b+4>>2]));f=+P(+(+g[b+8>>2]));g[a+12>>2]=n;g[a+16>>2]=k;g[a+20>>2]=f;g[a+24>>2]=0.0;g[a+28>>2]=o*n-m;g[a+32>>2]=l*k-j;g[a+36>>2]=h*f-e;g[a+40>>2]=0.0;i=d;return}function It(a){a=a|0;return 6776}function Jt(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;g[a+(c[b+52>>2]<<2)>>2]=1.0;i=d;return}function Kt(a,b){a=a|0;b=+b;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=j+ +g[a+28>>2];f=f+ +g[a+32>>2];k=k+ +g[a+36>>2];g[a+44>>2]=b;h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);b=k- +$b[c[(c[a>>2]|0)+48>>2]&15](a);g[a+28>>2]=j-h;g[a+32>>2]=f-e;g[a+36>>2]=b;g[a+40>>2]=0.0;i=d;return}function Lt(a){a=a|0;return 60}function Mt(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=h;if(h)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+28>>2]=+g[a+28>>2];g[b+32>>2]=+g[a+32>>2];g[b+36>>2]=+g[a+36>>2];g[b+40>>2]=+g[a+40>>2];g[b+12>>2]=+g[a+12>>2];g[b+16>>2]=+g[a+16>>2];g[b+20>>2]=+g[a+20>>2];g[b+24>>2]=+g[a+24>>2];g[b+44>>2]=+g[a+44>>2];c[b+52>>2]=c[a+52>>2];i=e;return 6752}function Nt(a){a=a|0;return}function Ot(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Pt(a){a=a|0;return 6736}function Qt(a){a=a|0;return}function Rt(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function St(a){a=a|0;return 6720}function Tt(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0.0;e=i;i=i+80|0;f=c[c[a>>2]>>2]|0;h=c[c[a+4>>2]>>2]|0;if(!(Yb[c[(c[b>>2]|0)+24>>2]&31](b,f,h)|0)){i=e;return}j=c[f+192>>2]|0;c[e+56>>2]=0;c[e+60>>2]=j;c[e+64>>2]=f;c[e+68>>2]=f+4;c[e+72>>2]=-1;c[e+76>>2]=-1;j=c[h+192>>2]|0;c[e+32>>2]=0;c[e+36>>2]=j;c[e+40>>2]=h;c[e+44>>2]=h+4;c[e+48>>2]=-1;c[e+52>>2]=-1;j=c[a+8>>2]|0;if(!j){j=Tb[c[(c[b>>2]|0)+8>>2]&31](b,e+56|0,e+32|0,0)|0;c[a+8>>2]=j;if(!j){i=e;return}}c[e>>2]=13504;c[e+4>>2]=0;c[e+8>>2]=e+56;c[e+12>>2]=e+32;if((c[d+8>>2]|0)==1){Jb[c[(c[j>>2]|0)+8>>2]&31](j,e+56|0,e+32|0,d,e);i=e;return}k=+Xb[c[(c[j>>2]|0)+12>>2]&15](j,f,h,d,e);if(!(+g[d+12>>2]>k)){i=e;return}g[d+12>>2]=k;i=e;return}function Ut(a){a=a|0;return}function Vt(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=6808;e=c[b+20>>2]|0;if(e){if(a[b+24>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+20>>2]=0}a[b+24>>0]=1;c[b+20>>2]=0;c[b+12>>2]=0;c[b+16>>2]=0;gF(b);i=d;return}function Wt(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=6808;e=c[b+20>>2]|0;if(e){if(a[b+24>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+20>>2]=0}a[b+24>>0]=1;c[b+20>>2]=0;c[b+12>>2]=0;c[b+16>>2]=0;i=d;return}function Xt(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0.0,l=0.0,m=0,n=0,o=0.0;f=i;i=i+16|0;c[1698]=(c[1698]|0)+1;if(!(c[b+4>>2]&2))j=15720;else{j=c[d+192>>2]|0;k=+lc[c[(c[j>>2]|0)+20>>2]&1](j,.019999999552965164);g[f+4>>2]=k;j=c[e+192>>2]|0;l=+lc[c[(c[j>>2]|0)+20>>2]&1](j,.019999999552965164);g[f>>2]=l;j=k<l?f+4|0:f}l=+g[j>>2];o=+g[d+184>>2];k=+g[e+184>>2];k=o<k?o:k;m=c[b+68>>2]|0;j=c[m+8>>2]|0;if(!j){if(c[b+4>>2]&4){n=0;i=f;return n|0}c[5004]=(c[5004]|0)+1;j=fF(791)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}}else{n=c[m+12>>2]|0;c[m+12>>2]=c[n>>2];c[m+8>>2]=j+ -1;j=n}c[j>>2]=1025;c[j+116>>2]=0;a[j+120>>0]=0;n=j+124|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;c[n+20>>2]=0;c[n+24>>2]=0;c[n+28>>2]=0;c[j+300>>2]=0;a[j+304>>0]=0;n=j+308|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;c[n+20>>2]=0;c[n+24>>2]=0;c[n+28>>2]=0;c[j+484>>2]=0;a[j+488>>0]=0;n=j+492|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;c[n+20>>2]=0;c[n+24>>2]=0;c[n+28>>2]=0;c[j+668>>2]=0;a[j+672>>0]=0;n=j+676|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;c[n+20>>2]=0;c[n+24>>2]=0;c[n+28>>2]=0;c[j+740>>2]=d;c[j+744>>2]=e;c[j+748>>2]=0;g[j+752>>2]=l;g[j+756>>2]=k;c[j+768>>2]=c[b+12>>2];e=c[b+12>>2]|0;if((e|0)==(c[b+16>>2]|0)?(h=(e|0)==0?1:e<<1,(e|0)<(h|0)):0){if(!h)d=0;else{c[5004]=(c[5004]|0)+1;d=fF((h<<2|3)+16|0)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}e=c[b+12>>2]|0}if((e|0)>0){n=0;do{m=d+(n<<2)|0;if(m)c[m>>2]=c[(c[b+20>>2]|0)+(n<<2)>>2];n=n+1|0}while((n|0)!=(e|0))}m=c[b+20>>2]|0;if(m){if(a[b+24>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0);e=c[b+12>>2]|0}c[b+20>>2]=0}a[b+24>>0]=1;c[b+20>>2]=d;c[b+16>>2]=h}h=(c[b+20>>2]|0)+(e<<2)|0;if(h)c[h>>2]=j;c[b+12>>2]=e+1;n=j;i=f;return n|0}function Yt(a,b){a=a|0;b=b|0;var d=0,e=0;a=i;d=c[b+748>>2]|0;if((d|0)>0){e=0;do e=e+1|0;while((e|0)<(d|0))}c[b+748>>2]=0;i=a;return}function Zt(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0;d=i;c[1698]=(c[1698]|0)+ -1;Nb[c[(c[a>>2]|0)+20>>2]&127](a,b);e=c[b+768>>2]|0;f=(c[a+12>>2]|0)+ -1|0;h=c[a+20>>2]|0;g=c[h+(e<<2)>>2]|0;c[h+(e<<2)>>2]=c[h+(f<<2)>>2];c[(c[a+20>>2]|0)+(f<<2)>>2]=g;c[(c[(c[a+20>>2]|0)+(e<<2)>>2]|0)+768>>2]=e;c[a+12>>2]=(c[a+12>>2]|0)+ -1;a=c[a+68>>2]|0;if(!b){i=d;return}h=c[a+16>>2]|0;if(h>>>0<=b>>>0?(h+(aa(c[a>>2]|0,c[a+4>>2]|0)|0)|0)>>>0>b>>>0:0){c[b>>2]=c[a+12>>2];c[a+12>>2]=b;c[a+8>>2]=(c[a+8>>2]|0)+1;i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function _t(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+16|0;c[f>>2]=a;c[f+4>>2]=e;e=c[a+((c[(c[b+4>>2]|0)+4>>2]|0)*144|0)+(c[(c[d+4>>2]|0)+4>>2]<<2)+72>>2]|0;e=Tb[c[(c[e>>2]|0)+8>>2]&31](e,f,b,d)|0;i=f;return e|0}function $t(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;a=i;b=c[b+204>>2]|0;if((b&4|0)==0?(e=c[d+204>>2]|0,(e&4|0)==0):0)if(!(b&3))d=1;else d=(e&3|0)==0;else d=0;i=a;return d|0}function au(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;a=i;e=c[b+216>>2]|0;if((e|0)==2|(e|0)==5?(e=c[d+216>>2]|0,(e|0)==2|(e|0)==5):0)b=0;else if(!(c[b+256>>2]|0))b=1;else b=gc[c[c[b>>2]>>2]&31](b,d)|0;i=a;return b|0}function bu(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+16|0;c[f>>2]=6920;c[f+4>>2]=d;c[f+8>>2]=a;rc[c[(c[b>>2]|0)+48>>2]&127](b,f,e);i=f;return}function cu(a){a=a|0;return}function du(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;a=c[a+64>>2]|0;e=c[a+8>>2]|0;if(e){b=c[a+12>>2]|0;c[a+12>>2]=c[b>>2];c[a+8>>2]=e+ -1;e=b;i=d;return e|0}c[5004]=(c[5004]|0)+1;b=fF(b+19|0)|0;if(!b){e=0;i=d;return e|0}c[(b+19&-16)+ -4>>2]=b;e=b+19&-16;i=d;return e|0}function eu(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;a=c[a+64>>2]|0;if(!b){i=d;return}e=c[a+16>>2]|0;if(e>>>0<=b>>>0?(e+(aa(c[a>>2]|0,c[a+4>>2]|0)|0)|0)>>>0>b>>>0:0){c[b>>2]=c[a+12>>2];c[a+12>>2]=b;c[a+8>>2]=(c[a+8>>2]|0)+1;i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function fu(a){a=a|0;return c[a+12>>2]|0}function gu(a,b){a=a|0;b=b|0;return c[(c[a+20>>2]|0)+(b<<2)>>2]|0}function hu(a){a=a|0;if(!(c[a+12>>2]|0))a=0;else a=c[a+20>>2]|0;return a|0}function iu(a){a=a|0;return c[a+68>>2]|0}function ju(a){a=a|0;return c[a+68>>2]|0}function ku(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function lu(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;e=c[a+8>>2]|0;rc[c[e+60>>2]&127](b,e,c[a+4>>2]|0);i=d;return 0}function mu(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function nu(a,b,d){a=a|0;b=b|0;d=d|0;c[a+16>>2]=b;c[a+24>>2]=d;return}function ou(a,b,d){a=a|0;b=b|0;d=d|0;c[a+20>>2]=b;c[a+28>>2]=d;return}function pu(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0.0;e=i;g[b+16>>2]=+g[a+4>>2];g[b+20>>2]=+g[a+8>>2];g[b+24>>2]=+g[a+12>>2];g[b+28>>2]=+g[a+16>>2];g[b+32>>2]=+g[a+20>>2];g[b+36>>2]=+g[a+24>>2];g[b+40>>2]=+g[a+28>>2];g[b+44>>2]=+g[a+32>>2];g[b+48>>2]=+g[a+36>>2];g[b+52>>2]=+g[a+40>>2];g[b+56>>2]=+g[a+44>>2];g[b+60>>2]=+g[a+48>>2];g[b+64>>2]=+g[a+52>>2];g[b+68>>2]=+g[a+56>>2];g[b+72>>2]=+g[a+60>>2];g[b+76>>2]=+g[a+64>>2];g[b+80>>2]=+g[a+68>>2];g[b+84>>2]=+g[a+72>>2];g[b+88>>2]=+g[a+76>>2];g[b+92>>2]=+g[a+80>>2];g[b+96>>2]=+g[a+84>>2];g[b+100>>2]=+g[a+88>>2];g[b+104>>2]=+g[a+92>>2];g[b+108>>2]=+g[a+96>>2];g[b+112>>2]=+g[a+100>>2];g[b+116>>2]=+g[a+104>>2];g[b+120>>2]=+g[a+108>>2];g[b+124>>2]=+g[a+112>>2];g[b+128>>2]=+g[a+116>>2];g[b+132>>2]=+g[a+120>>2];g[b+136>>2]=+g[a+124>>2];g[b+140>>2]=+g[a+128>>2];g[b+144>>2]=+g[a+132>>2];g[b+148>>2]=+g[a+136>>2];g[b+152>>2]=+g[a+140>>2];g[b+156>>2]=+g[a+144>>2];g[b+160>>2]=+g[a+148>>2];g[b+164>>2]=+g[a+152>>2];g[b+168>>2]=+g[a+156>>2];g[b+172>>2]=+g[a+160>>2];g[b+176>>2]=+g[a+164>>2];g[b+180>>2]=+g[a+168>>2];g[b+184>>2]=+g[a+172>>2];g[b+188>>2]=+g[a+176>>2];c[b+224>>2]=c[a+180>>2];g[b+192>>2]=+g[a+184>>2];c[b>>2]=0;c[b+4>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,c[a+192>>2]|0)|0;c[b+8>>2]=0;c[b+228>>2]=c[a+204>>2];c[b+232>>2]=c[a+208>>2];c[b+236>>2]=c[a+212>>2];c[b+240>>2]=c[a+216>>2];g[b+196>>2]=+g[a+220>>2];g[b+200>>2]=+g[a+224>>2];g[b+204>>2]=+g[a+232>>2];g[b+208>>2]=+g[a+228>>2];c[b+244>>2]=c[a+236>>2];f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b+12>>2]=h;if(!h){d=a+244|0;j=+g[d>>2];d=b+212|0;g[d>>2]=j;d=a+248|0;j=+g[d>>2];d=b+216|0;g[d>>2]=j;d=a+252|0;j=+g[d>>2];d=b+220|0;g[d>>2]=j;d=a+256|0;d=c[d>>2]|0;h=b+248|0;c[h>>2]=d;i=e;return 7016}Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);d=a+244|0;j=+g[d>>2];d=b+212|0;g[d>>2]=j;d=a+248|0;j=+g[d>>2];d=b+216|0;g[d>>2]=j;d=a+252|0;j=+g[d>>2];d=b+220|0;g[d>>2]=j;d=a+256|0;d=c[d>>2]|0;h=b+248|0;c[h>>2]=d;i=e;return 7016}function qu(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;f=Pb[c[(c[a>>2]|0)+16>>2]&127](a)|0;f=Yb[c[(c[b>>2]|0)+16>>2]&31](b,f,1)|0;e=Yb[c[(c[a>>2]|0)+20>>2]&31](a,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,e,1245859651,a);i=d;return}function ru(a,b){a=a|0;b=b|0;return 1}function su(a){a=a|0;return 256}function tu(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0;e=i;i=i+96|0;g[e+32>>2]=1.0;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=1.0;c[e+56>>2]=0;c[e+60>>2]=0;c[e+64>>2]=0;c[e+68>>2]=0;g[e+72>>2]=1.0;n=e+76|0;c[n+0>>2]=0;c[n+4>>2]=0;c[n+8>>2]=0;c[n+12>>2]=0;c[n+16>>2]=0;vc[c[(c[a>>2]|0)+8>>2]&127](a,e+32|0,e+16|0,e);l=+g[e>>2];m=+g[e+16>>2];j=+g[e+4>>2];k=+g[e+20>>2];f=+g[e+8>>2];h=+g[e+24>>2];g[d>>2]=+Q(+((l-m)*(l-m)+(j-k)*(j-k)+(f-h)*(f-h)))*.5;g[b>>2]=(m+l)*.5;g[b+4>>2]=(k+j)*.5;g[b+8>>2]=(h+f)*.5;g[b+12>>2]=0.0;i=e;return}function uu(a,b){a=a|0;b=+b;var d=0;d=i;b=+$b[c[(c[a>>2]|0)+16>>2]&15](a)*b;i=d;return+b}function vu(a){a=a|0;var b=0,d=0.0,e=0.0,f=0.0;b=i;i=i+32|0;rc[c[(c[a>>2]|0)+12>>2]&127](a,b+8|0,b);f=+g[b+8>>2];e=+g[b+12>>2];d=+g[b+16>>2];d=+Q(+(f*f+e*e+d*d));i=b;return+(d+ +g[b>>2])}function wu(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0;j=i;vc[c[(c[a>>2]|0)+8>>2]&127](a,b,f,h);r=+g[h>>2];p=+g[h+4>>2];k=+g[h+8>>2];m=+g[f>>2];q=+g[f+4>>2];l=+g[f+8>>2];s=+g[d>>2];o=+g[d+4>>2];n=+g[d+8>>2];if(s>0.0)r=r+s;else m=m+s;if(o>0.0)p=p+o;else q=q+o;if(n>0.0)k=k+n;else l=l+n;n=+g[e>>2];o=+g[e+4>>2];s=+g[e+8>>2];s=+Q(+(n*n+o*o+s*s));s=s*+$b[c[(c[a>>2]|0)+16>>2]&15](a);g[f>>2]=m;g[f+4>>2]=q;g[f+8>>2]=l;g[f+12>>2]=0.0;g[h>>2]=r;g[h+4>>2]=p;g[h+8>>2]=k;g[h+12>>2]=0.0;g[f>>2]=+g[f>>2]-s;g[f+4>>2]=+g[f+4>>2]-s;g[f+8>>2]=+g[f+8>>2]-s;g[h>>2]=s+ +g[h>>2];g[h+4>>2]=s+ +g[h+4>>2];g[h+8>>2]=s+ +g[h+8>>2];i=j;return}function xu(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;g=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=g;if(g)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];i=e;return 7080}function yu(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;f=Pb[c[(c[a>>2]|0)+52>>2]&127](a)|0;f=Yb[c[(c[b>>2]|0)+16>>2]&31](b,f,1)|0;e=Yb[c[(c[a>>2]|0)+56>>2]&31](a,c[f+8>>2]|0,b)|0;Jb[c[(c[b>>2]|0)+20>>2]&31](b,f,e,1346455635,a);i=d;return}function zu(a){a=a|0;return 12}function Au(a){a=a|0;var b=0;b=i;Bu(a);gF(a);i=b;return}function Bu(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0;d=i;c[b>>2]=7144;e=c[b+8>>2]|0;g=c[b+16>>2]|0;if((e|0)>0){f=0;do{h=(c[g+(f<<2)>>2]|0)+188|0;j=c[h>>2]|0;if(j){e=c[b+68>>2]|0;e=Pb[c[(c[e>>2]|0)+36>>2]&127](e)|0;rc[c[(c[e>>2]|0)+40>>2]&127](e,j,c[b+24>>2]|0);e=c[b+68>>2]|0;rc[c[(c[e>>2]|0)+12>>2]&127](e,j,c[b+24>>2]|0);c[h>>2]=0;e=c[b+8>>2]|0;g=c[b+16>>2]|0}f=f+1|0}while((f|0)<(e|0))}if(!g){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;j=b+12|0;c[j>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[g+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;j=b+12|0;c[j>>2]=0;i=d;return}function Cu(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0;g=i;i=i+96|0;k=c[b+8>>2]|0;if((k|0)==(c[b+12>>2]|0)?(h=(k|0)==0?1:k<<1,(k|0)<(h|0)):0){if(!h)j=0;else{c[5004]=(c[5004]|0)+1;j=fF((h<<2|3)+16|0)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}k=c[b+8>>2]|0}if((k|0)>0){l=0;do{m=j+(l<<2)|0;if(m)c[m>>2]=c[(c[b+16>>2]|0)+(l<<2)>>2];l=l+1|0}while((l|0)!=(k|0))}l=c[b+16>>2]|0;if(l){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0);k=c[b+8>>2]|0}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=j;c[b+12>>2]=h}h=(c[b+16>>2]|0)+(k<<2)|0;if(h)c[h>>2]=d;c[b+8>>2]=k+1;c[g+32>>2]=c[d+4>>2];c[g+36>>2]=c[d+8>>2];c[g+40>>2]=c[d+12>>2];c[g+44>>2]=c[d+16>>2];c[g+48>>2]=c[d+20>>2];c[g+52>>2]=c[d+24>>2];c[g+56>>2]=c[d+28>>2];c[g+60>>2]=c[d+32>>2];c[g+64>>2]=c[d+36>>2];c[g+68>>2]=c[d+40>>2];c[g+72>>2]=c[d+44>>2];c[g+76>>2]=c[d+48>>2];c[g+80>>2]=c[d+52>>2];c[g+84>>2]=c[d+56>>2];c[g+88>>2]=c[d+60>>2];c[g+92>>2]=c[d+64>>2];m=c[d+192>>2]|0;vc[c[(c[m>>2]|0)+8>>2]&127](m,g+32|0,g+16|0,g);m=c[b+68>>2]|0;c[d+188>>2]=pc[c[(c[m>>2]|0)+8>>2]&3](m,g+16|0,g,c[(c[d+192>>2]|0)+4>>2]|0,d,e,f,c[b+24>>2]|0,0)|0;i=g;return}function Du(b){b=b|0;var d=0,e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0;d=i;i=i+64|0;yE(7424);q=c[b+8>>2]|0;if((q|0)>0){f=0;do{h=c[(c[b+16>>2]|0)+(f<<2)>>2]|0;if(!((a[b+76>>0]|0)==0?(r=c[h+216>>2]|0,(r|0)==2|(r|0)==5):0)){r=c[h+192>>2]|0;vc[c[(c[r>>2]|0)+8>>2]&127](r,h+4|0,d+48|0,d+32|0);k=+g[d+48>>2]+-.019999999552965164;g[d+48>>2]=k;j=+g[d+52>>2]+-.019999999552965164;g[d+52>>2]=j;n=+g[d+56>>2]+-.019999999552965164;g[d+56>>2]=n;o=+g[d+32>>2]+.019999999552965164;g[d+32>>2]=o;m=+g[d+36>>2]+.019999999552965164;g[d+36>>2]=m;l=+g[d+40>>2]+.019999999552965164;g[d+40>>2]=l;if(((a[b+44>>0]|0)!=0?(c[h+236>>2]|0)==2:0)?(c[h+204>>2]&3|0)==0:0){r=c[h+192>>2]|0;vc[c[(c[r>>2]|0)+8>>2]&127](r,h+68|0,d+16|0,d);k=+g[d+16>>2]+-.019999999552965164;g[d+16>>2]=k;j=+g[d+20>>2]+-.019999999552965164;g[d+20>>2]=j;n=+g[d+24>>2]+-.019999999552965164;g[d+24>>2]=n;o=+g[d>>2]+.019999999552965164;g[d>>2]=o;m=+g[d+4>>2]+.019999999552965164;g[d+4>>2]=m;l=+g[d+8>>2]+.019999999552965164;g[d+8>>2]=l;p=+g[d+48>>2];if(k<p)g[d+48>>2]=k;else k=p;p=+g[d+52>>2];if(j<p)g[d+52>>2]=j;else j=p;p=+g[d+56>>2];if(n<p)g[d+56>>2]=n;else n=p;p=+g[d+28>>2];if(p<+g[d+60>>2])g[d+60>>2]=p;p=+g[d+32>>2];if(p<o)g[d+32>>2]=o;else o=p;p=+g[d+36>>2];if(p<m)g[d+36>>2]=m;else m=p;p=+g[d+40>>2];if(p<l)g[d+40>>2]=l;else l=p;p=+g[d+12>>2];if(+g[d+44>>2]<p)g[d+44>>2]=p}q=c[b+68>>2]|0;if((c[h+204>>2]&1|0)==0?(k=o-k,o=m-j,p=l-n,!(k*k+o*o+p*p<999999995904.0)):0){if(((c[h+216>>2]|0)+ -4|0)>>>0>=2)c[h+216>>2]=5;if((a[7200]|0)!=0?(e=c[b+72>>2]|0,(e|0)!=0):0){a[7200]=0;Nb[c[(c[e>>2]|0)+36>>2]&127](e,7208);r=c[b+72>>2]|0;Nb[c[(c[r>>2]|0)+36>>2]&127](r,7264);r=c[b+72>>2]|0;Nb[c[(c[r>>2]|0)+36>>2]&127](r,7336);r=c[b+72>>2]|0;Nb[c[(c[r>>2]|0)+36>>2]&127](r,7408)}}else Jb[c[(c[q>>2]|0)+16>>2]&31](q,c[h+188>>2]|0,d+48|0,d+32|0,c[b+24>>2]|0);q=c[b+8>>2]|0}f=f+1|0}while((f|0)<(q|0))}b=c[5022]|0;r=(c[b+16>>2]|0)+ -1|0;c[b+16>>2]=r;if(r){i=d;return}do if(c[b+4>>2]|0){Eb(d+48|0,0)|0;r=c[5008]|0;g[b+8>>2]=+(((c[d+52>>2]|0)-(c[r+4>>2]|0)+(((c[d+48>>2]|0)-(c[r>>2]|0)|0)*1e6|0)-(c[b+12>>2]|0)|0)>>>0)/1.0e3+ +g[b+8>>2];if(!(c[b+16>>2]|0)){b=c[5022]|0;break}else{i=d;return}}while(0);c[5022]=c[b+20>>2];i=d;return}function Eu(a){a=a|0;var b=0,d=0;b=i;i=i+16|0;yE(7440);d=c[a+68>>2]|0;Nb[c[(c[d>>2]|0)+32>>2]&127](d,c[a+24>>2]|0);a=c[5022]|0;d=(c[a+16>>2]|0)+ -1|0;c[a+16>>2]=d;if(d){i=b;return}do if(c[a+4>>2]|0){Eb(b|0,0)|0;d=c[5008]|0;g[a+8>>2]=+(((c[b+4>>2]|0)-(c[d+4>>2]|0)+(((c[b>>2]|0)-(c[d>>2]|0)|0)*1e6|0)-(c[a+12>>2]|0)|0)>>>0)/1.0e3+ +g[a+8>>2];if(!(c[a+16>>2]|0)){a=c[5022]|0;break}else{i=b;return}}while(0);c[5022]=c[a+20>>2];i=b;return}function Fu(a){a=a|0;var b=0,d=0,e=0,f=0;b=i;i=i+16|0;yE(7472);Lb[c[(c[a>>2]|0)+8>>2]&511](a);Lb[c[(c[a>>2]|0)+12>>2]&511](a);d=c[a+24>>2]|0;yE(7512);if(d){f=c[(c[d>>2]|0)+32>>2]|0;e=c[a+68>>2]|0;e=Pb[c[(c[e>>2]|0)+36>>2]&127](e)|0;vc[f&127](d,e,a+28|0,c[a+24>>2]|0)}a=c[5022]|0;f=(c[a+16>>2]|0)+ -1|0;c[a+16>>2]=f;do if(!f){if(c[a+4>>2]|0){Eb(b|0,0)|0;d=c[5008]|0;g[a+8>>2]=+(((c[b+4>>2]|0)-(c[d+4>>2]|0)+(((c[b>>2]|0)-(c[d>>2]|0)|0)*1e6|0)-(c[a+12>>2]|0)|0)>>>0)/1.0e3+ +g[a+8>>2];d=c[5022]|0;if(!(c[a+16>>2]|0))a=d;else{a=d;break}}a=c[a+20>>2]|0;c[5022]=a}while(0);d=a+16|0;f=(c[d>>2]|0)+ -1|0;c[d>>2]=f;if(f){i=b;return}do if(c[a+4>>2]|0){Eb(b|0,0)|0;e=c[5008]|0;f=a+8|0;g[f>>2]=+(((c[b+4>>2]|0)-(c[e+4>>2]|0)+(((c[b>>2]|0)-(c[e>>2]|0)|0)*1e6|0)-(c[a+12>>2]|0)|0)>>>0)/1.0e3+ +g[f>>2];if(!(c[d>>2]|0)){a=c[5022]|0;break}else{i=b;return}}while(0);c[5022]=c[a+20>>2];i=b;return}function Gu(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0;e=i;f=c[b+188>>2]|0;if(f){k=c[a+68>>2]|0;k=Pb[c[(c[k>>2]|0)+36>>2]&127](k)|0;rc[c[(c[k>>2]|0)+40>>2]&127](k,f,c[a+24>>2]|0);k=c[a+68>>2]|0;rc[c[(c[k>>2]|0)+12>>2]&127](k,f,c[a+24>>2]|0);c[b+188>>2]=0}f=c[a+8>>2]|0;if((f|0)<=0){i=e;return}g=c[a+16>>2]|0;h=0;while(1){j=g+(h<<2)|0;k=h+1|0;if((c[j>>2]|0)==(b|0))break;if((k|0)<(f|0))h=k;else{d=9;break}}if((d|0)==9){i=e;return}if((h|0)>=(f|0)){i=e;return}c[j>>2]=c[g+(f+ -1<<2)>>2];c[(c[a+16>>2]|0)+(f+ -1<<2)>>2]=b;c[a+8>>2]=f+ -1;i=e;return}function Hu(d,e,f,h){d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0,A=0,B=0,C=0,D=0,E=0.0,F=0.0,G=0.0,H=0.0,I=0,J=0,K=0.0,L=0.0;j=i;i=i+1392|0;c[j+1192>>2]=0;g[j+1196>>2]=1.0;g[j+1200>>2]=1.0;g[j+1204>>2]=1.0;g[j+1208>>2]=0.0;c[j+1184>>2]=16680;c[j+1188>>2]=8;g[j+1212>>2]=0.0;g[j+1228>>2]=0.0;z=c[f+4>>2]|0;y=c[f+12>>2]|0;A=c[z+4>>2]|0;if((A|0)<20){c[j+1008>>2]=9440;c[j+1176>>2]=0;g[j+1180>>2]=0.0;g[j+1172>>2]=+g[h+4>>2];g[j+956>>2]=9999999747378752.0e-20;a[j+980>>0]=0;c[j+632>>2]=17152;c[j+636>>2]=j+648;c[j+640>>2]=j+1184;c[j+644>>2]=z;c[j+616>>2]=13184;c[j+620>>2]=j+648;c[j+624>>2]=j+1184;c[j+628>>2]=z;J=(c[h+16>>2]&8|0)==0?j+632|0:j+616|0;if(!(ac[c[(c[J>>2]|0)+8>>2]&3](J,d,e,y,y,j+1008|0)|0)){i=j;return}y=j+1140|0;m=+g[y>>2];k=+g[j+1144>>2];n=+g[j+1148>>2];if(!(m*m+k*k+n*n>9999999747378752.0e-20)){i=j;return}l=+g[j+1172>>2];if(!(l<+g[h+4>>2])){i=j;return}H=1.0/+Q(+(m*m+k*k+n*n));g[y>>2]=m*H;g[j+1144>>2]=k*H;g[j+1148>>2]=n*H;c[j+584>>2]=c[f+8>>2];c[j+588>>2]=0;c[j+592>>2]=c[y+0>>2];c[j+596>>2]=c[y+4>>2];c[j+600>>2]=c[y+8>>2];c[j+604>>2]=c[y+12>>2];g[j+608>>2]=l;+hc[c[(c[h>>2]|0)+12>>2]&15](h,j+584|0,1);i=j;return}if((A+ -21|0)>>>0<9){t=+g[y>>2];u=+g[y+16>>2];s=+g[y+32>>2];v=+g[y+4>>2];w=+g[y+20>>2];r=+g[y+36>>2];G=+g[y+8>>2];H=+g[y+24>>2];q=+g[y+40>>2];x=-+g[y+48>>2];E=-+g[y+52>>2];F=-+g[y+56>>2];n=+g[d+48>>2];o=+g[d+52>>2];p=+g[d+56>>2];g[j+568>>2]=t*x+u*E+s*F+(t*n+u*o+s*p);g[j+572>>2]=v*x+w*E+r*F+(v*n+w*o+r*p);g[j+576>>2]=G*x+H*E+q*F+(G*n+H*o+q*p);g[j+580>>2]=0.0;l=+g[e+48>>2];k=+g[e+52>>2];m=+g[e+56>>2];s=t*x+u*E+s*F+(t*l+u*k+s*m);r=v*x+w*E+r*F+(v*l+w*k+r*m);q=G*x+H*E+q*F+(G*l+H*k+q*m);g[j+552>>2]=s;g[j+556>>2]=r;g[j+560>>2]=q;g[j+564>>2]=0.0;e=c[z+4>>2]|0;if((e|0)==25){J=c[f+8>>2]|0;I=c[h+16>>2]|0;c[j+316>>2]=c[j+568>>2];c[j+320>>2]=c[j+572>>2];c[j+324>>2]=c[j+576>>2];c[j+328>>2]=c[j+580>>2];c[j+332>>2]=c[j+552>>2];c[j+336>>2]=c[j+556>>2];c[j+340>>2]=c[j+560>>2];c[j+344>>2]=c[j+564>>2];c[j+348>>2]=I;g[j+352>>2]=1.0;c[j+312>>2]=9248;c[j+356>>2]=h;c[j+360>>2]=J;c[j+364>>2]=z;c[j+368>>2]=c[y+0>>2];c[j+372>>2]=c[y+4>>2];c[j+376>>2]=c[y+8>>2];c[j+380>>2]=c[y+12>>2];c[j+384>>2]=c[y+16>>2];c[j+388>>2]=c[y+20>>2];c[j+392>>2]=c[y+24>>2];c[j+396>>2]=c[y+28>>2];c[j+400>>2]=c[y+32>>2];c[j+404>>2]=c[y+36>>2];c[j+408>>2]=c[y+40>>2];c[j+412>>2]=c[y+44>>2];c[j+416>>2]=c[y+48>>2];c[j+420>>2]=c[y+52>>2];c[j+424>>2]=c[y+56>>2];c[j+428>>2]=c[y+60>>2];g[j+352>>2]=+g[h+4>>2];vc[c[(c[z>>2]|0)+144>>2]&127](z,j+312|0,j+568|0,j+552|0);i=j;return}else if((e|0)==21){J=c[f+8>>2]|0;I=c[h+16>>2]|0;c[j+436>>2]=c[j+568>>2];c[j+440>>2]=c[j+572>>2];c[j+444>>2]=c[j+576>>2];c[j+448>>2]=c[j+580>>2];c[j+452>>2]=c[j+552>>2];c[j+456>>2]=c[j+556>>2];c[j+460>>2]=c[j+560>>2];c[j+464>>2]=c[j+564>>2];c[j+468>>2]=I;g[j+472>>2]=1.0;c[j+432>>2]=9248;c[j+476>>2]=h;c[j+480>>2]=J;c[j+484>>2]=z;c[j+488>>2]=c[y+0>>2];c[j+492>>2]=c[y+4>>2];c[j+496>>2]=c[y+8>>2];c[j+500>>2]=c[y+12>>2];c[j+504>>2]=c[y+16>>2];c[j+508>>2]=c[y+20>>2];c[j+512>>2]=c[y+24>>2];c[j+516>>2]=c[y+28>>2];c[j+520>>2]=c[y+32>>2];c[j+524>>2]=c[y+36>>2];c[j+528>>2]=c[y+40>>2];c[j+532>>2]=c[y+44>>2];c[j+536>>2]=c[y+48>>2];c[j+540>>2]=c[y+52>>2];c[j+544>>2]=c[y+56>>2];c[j+548>>2]=c[y+60>>2];g[j+472>>2]=+g[h+4>>2];h=c[z+48>>2]|0;c[j+1272>>2]=6152;c[j+1276>>2]=h;c[j+1280>>2]=j+432;h=c[z+52>>2]|0;c[j+1328>>2]=0;c[j+1332>>2]=0;c[j+1336>>2]=0;c[j+1340>>2]=0;c[j+1304>>2]=0;c[j+1308>>2]=0;c[j+1312>>2]=0;c[j+1316>>2]=0;if(!(a[h+60>>0]|0)){OA(h,j+1272|0,j+568|0,s,r,q,j+1328|0,j+1304|0);i=j;return}else{PA(h,j+1272|0,j+568|0,s,r,q,j+1328|0,j+1304|0,c[h+56>>2]|0);i=j;return}}else{L=+g[y>>2];K=+g[y+16>>2];s=+g[y+32>>2];t=+g[y+4>>2];u=+g[y+20>>2];v=+g[y+36>>2];F=+g[y+8>>2];G=+g[y+24>>2];H=+g[y+40>>2];w=-+g[y+48>>2];x=-+g[y+52>>2];E=-+g[y+56>>2];r=L*w+K*x+s*E+(L*n+K*o+s*p);q=t*w+u*x+v*E+(t*n+u*o+v*p);o=F*w+G*x+H*E+(F*n+G*o+H*p);p=L*w+K*x+s*E+(L*l+K*k+s*m);n=t*w+u*x+v*E+(t*l+u*k+v*m);k=F*w+G*x+H*E+(F*l+G*k+H*m);J=c[f+8>>2]|0;I=c[h+16>>2]|0;g[j+196>>2]=r;g[j+200>>2]=q;g[j+204>>2]=o;g[j+208>>2]=0.0;g[j+212>>2]=p;g[j+216>>2]=n;g[j+220>>2]=k;g[j+224>>2]=0.0;c[j+228>>2]=I;g[j+232>>2]=1.0;c[j+192>>2]=9056;c[j+236>>2]=h;c[j+240>>2]=J;c[j+244>>2]=z;c[j+248>>2]=c[y+0>>2];c[j+252>>2]=c[y+4>>2];c[j+256>>2]=c[y+8>>2];c[j+260>>2]=c[y+12>>2];c[j+264>>2]=c[y+16>>2];c[j+268>>2]=c[y+20>>2];c[j+272>>2]=c[y+24>>2];c[j+276>>2]=c[y+28>>2];c[j+280>>2]=c[y+32>>2];c[j+284>>2]=c[y+36>>2];c[j+288>>2]=c[y+40>>2];c[j+292>>2]=c[y+44>>2];c[j+296>>2]=c[y+48>>2];c[j+300>>2]=c[y+52>>2];c[j+304>>2]=c[y+56>>2];c[j+308>>2]=c[y+60>>2];g[j+232>>2]=+g[h+4>>2];g[j+176>>2]=r;g[j+180>>2]=q;g[j+184>>2]=o;g[j+188>>2]=0.0;if(p<r)g[j+176>>2]=p;if(n<q)g[j+180>>2]=n;if(k<o)g[j+184>>2]=k;g[j+160>>2]=r;g[j+164>>2]=q;g[j+168>>2]=o;g[j+172>>2]=0.0;if(r<p)g[j+160>>2]=p;if(q<n)g[j+164>>2]=n;if(o<k)g[j+168>>2]=k;vc[c[(c[z>>2]|0)+64>>2]&127](z,j+192|0,j+176|0,j+160|0);i=j;return}}if((A|0)!=31){i=j;return}A=c[z+64>>2]|0;J=c[f+8>>2]|0;c[j+128>>2]=8840;c[j+132>>2]=J;c[j+136>>2]=z;c[j+140>>2]=y;c[j+144>>2]=d;c[j+148>>2]=e;c[j+152>>2]=h;if(!A){h=c[z+16>>2]|0;if((h|0)<=0){i=j;return}f=0;while(1){J=c[z+24>>2]|0;I=c[J+(f*80|0)+64>>2]|0;no(j+1328|0,y,J+(f*80|0)|0);J=c[j+132>>2]|0;c[j+1304>>2]=0;c[j+1308>>2]=I;c[j+1312>>2]=J;c[j+1316>>2]=j+1328;c[j+1320>>2]=-1;c[j+1324>>2]=f;J=c[j+152>>2]|0;g[j+1276>>2]=1.0;c[j+1280>>2]=0;b[j+1284>>1]=1;b[j+1286>>1]=-1;c[j+1288>>2]=0;c[j+1272>>2]=8664;c[j+1292>>2]=J;c[j+1296>>2]=f;g[j+1276>>2]=+g[J+4>>2];c[j+1288>>2]=c[J+16>>2];Hu(c[j+144>>2]|0,c[j+148>>2]|0,j+1304|0,j+1272|0);f=f+1|0;if((f|0)>=(h|0))break;z=c[j+136>>2]|0;y=c[j+140>>2]|0}i=j;return}Ju(j+64|0,y,d);p=+g[j+112>>2];q=+g[j+116>>2];o=+g[j+120>>2];Ju(j,y,e);z=c[A>>2]|0;if(!z){i=j;return}r=+g[j+48>>2]-p;t=+g[j+52>>2]-q;u=+g[j+56>>2]-o;s=1.0/+Q(+(r*r+t*t+u*u));if(r*s==0.0)v=999999984306749400.0;else v=1.0/(r*s);if(t*s==0.0)w=999999984306749400.0;else w=1.0/(t*s);if(u*s==0.0)x=999999984306749400.0;else x=1.0/(u*s);h=v<0.0&1;y=w<0.0&1;f=x<0.0&1;c[5004]=(c[5004]|0)+1;e=fF(531)|0;if(!e)C=0;else{c[(e+19&-16)+ -4>>2]=e;C=e+19&-16}d=0;do{e=C+(d<<2)|0;if(e)c[e>>2]=0;d=d+1|0}while((d|0)!=128);c[C>>2]=z;A=128;D=128;z=1;B=126;do{e=z+ -1|0;d=c[C+(e<<2)>>2]|0;c[j+1240>>2]=c[d+0>>2];c[j+1244>>2]=c[d+4>>2];c[j+1248>>2]=c[d+8>>2];c[j+1252>>2]=c[d+12>>2];c[j+1256>>2]=c[d+16>>2];c[j+1260>>2]=c[d+20>>2];c[j+1264>>2]=c[d+24>>2];c[j+1268>>2]=c[d+28>>2];G=v*(+g[j+1240+(h<<4)>>2]-p);E=v*(+g[j+1240+((h^1)<<4)>>2]-p);H=w*(+g[j+1240+(y<<4)+4>>2]-q);F=w*(+g[j+1240+((y^1)<<4)+4>>2]-q);do if(((!(G>F|H>E)?(n=H>G?H:G,l=F<E?F:E,m=x*(+g[j+1240+(f<<4)+8>>2]-o),k=x*(+g[j+1240+((f^1)<<4)+8>>2]-o),!(n>k|m>l)):0)?(m>n?m:n)<r*s*r+t*s*t+u*s*u:0)?(k<l?k:l)>0.0:0){if(!(c[d+40>>2]|0)){Nb[c[(c[j+128>>2]|0)+12>>2]&127](j+128|0,d);z=e;break}if((e|0)>(B|0)){B=A<<1;if((A|0)<(B|0)){do if((D|0)<(B|0)){do if(!A)D=0;else{c[5004]=(c[5004]|0)+1;D=fF((A<<3|3)+16|0)|0;if(!D)D=0;else{c[(D+19&-16)+ -4>>2]=D;D=D+19&-16}if((A|0)>0)I=0;else break;do{J=D+(I<<2)|0;if(J)c[J>>2]=c[C+(I<<2)>>2];I=I+1|0}while((I|0)!=(A|0))}while(0);if(!C){C=D;D=B;break}c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0);C=D;D=B}while(0);do{I=C+(A<<2)|0;if(I)c[I>>2]=0;A=A+1|0}while((A|0)!=(B|0))}A=B;B=B+ -2|0}c[C+(e<<2)>>2]=c[d+36>>2];c[C+(z<<2)>>2]=c[d+40>>2];z=z+1|0}else z=e;while(0)}while((z|0)!=0);if(!C){i=j;return}c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0);i=j;return}function Iu(a){a=a|0;return}function Ju(a,b,c){a=a|0;b=b|0;c=c|0;var d=0.0,e=0.0,f=0.0,h=0.0,i=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0;j=+g[c+48>>2]- +g[b+48>>2];h=+g[c+52>>2]- +g[b+52>>2];e=+g[c+56>>2]- +g[b+56>>2];p=+g[b>>2];y=+g[c>>2];o=+g[b+16>>2];x=+g[c+16>>2];n=+g[b+32>>2];w=+g[c+32>>2];v=+g[c+4>>2];u=+g[c+20>>2];t=+g[c+36>>2];s=+g[c+8>>2];r=+g[c+24>>2];q=+g[c+40>>2];m=+g[b+4>>2];l=+g[b+20>>2];k=+g[b+36>>2];i=+g[b+8>>2];f=+g[b+24>>2];d=+g[b+40>>2];g[a>>2]=p*y+o*x+n*w;g[a+4>>2]=p*v+o*u+n*t;g[a+8>>2]=p*s+o*r+n*q;g[a+12>>2]=0.0;g[a+16>>2]=y*m+x*l+w*k;g[a+20>>2]=v*m+u*l+t*k;g[a+24>>2]=s*m+r*l+q*k;g[a+28>>2]=0.0;g[a+32>>2]=y*i+x*f+w*d;g[a+36>>2]=v*i+u*f+t*d;g[a+40>>2]=s*i+r*f+q*d;g[a+44>>2]=0.0;g[a+48>>2]=j*p+h*o+e*n;g[a+52>>2]=j*m+h*l+e*k;g[a+56>>2]=j*i+h*f+e*d;g[a+60>>2]=0.0;return}function Ku(d,e,f,h,j,k){d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=+k;var l=0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0,E=0,F=0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0;l=i;i=i+1664|0;m=c[h+4>>2]|0;n=c[h+12>>2]|0;D=c[m+4>>2]|0;if((D|0)<20){c[l+1424>>2]=9440;c[l+1592>>2]=0;g[l+1596>>2]=k;g[l+1588>>2]=+g[j+4>>2];g[l+1372>>2]=9999999747378752.0e-20;a[l+1396>>0]=0;c[l+1056>>2]=13248;c[l+1032>>2]=10152;c[l+1036>>2]=l+1064;c[l+1040>>2]=l+1056;c[l+1044>>2]=d;c[l+1048>>2]=m;c[l+1052>>2]=0;if(!(xw(l+1032|0,e,f,n,n,l+1424|0)|0)){i=l;return}m=l+1556|0;q=+g[m>>2];p=+g[l+1560>>2];o=+g[l+1564>>2];if(!(q*q+p*p+o*o>9999999747378752.0e-20)){i=l;return}k=+g[l+1588>>2];if(!(k<+g[j+4>>2])){i=l;return}C=1.0/+Q(+(q*q+p*p+o*o));g[m>>2]=q*C;g[l+1560>>2]=p*C;g[l+1564>>2]=o*C;c[l+984>>2]=c[h+8>>2];c[l+988>>2]=0;c[l+992>>2]=c[m+0>>2];c[l+996>>2]=c[m+4>>2];c[l+1e3>>2]=c[m+8>>2];c[l+1004>>2]=c[m+12>>2];c[l+1008>>2]=c[l+1572>>2];c[l+1012>>2]=c[l+1576>>2];c[l+1016>>2]=c[l+1580>>2];c[l+1020>>2]=c[l+1584>>2];g[l+1024>>2]=k;+hc[c[(c[j>>2]|0)+12>>2]&15](j,l+984|0,1);i=l;return}if((D+ -21|0)>>>0>=9){if((D|0)!=31){i=l;return}yE(7544);if((c[m+16>>2]|0)>0){D=0;do{F=c[m+24>>2]|0;o=+g[F+(D*80|0)>>2];r=+g[F+(D*80|0)+4>>2];u=+g[F+(D*80|0)+8>>2];p=+g[F+(D*80|0)+16>>2];s=+g[F+(D*80|0)+20>>2];w=+g[F+(D*80|0)+24>>2];q=+g[F+(D*80|0)+32>>2];t=+g[F+(D*80|0)+36>>2];y=+g[F+(D*80|0)+40>>2];N=+g[F+(D*80|0)+48>>2];M=+g[F+(D*80|0)+52>>2];C=+g[F+(D*80|0)+56>>2];F=c[F+(D*80|0)+64>>2]|0;L=+g[n>>2];K=+g[n+4>>2];J=+g[n+8>>2];I=+g[n+16>>2];H=+g[n+20>>2];G=+g[n+24>>2];v=+g[n+32>>2];x=+g[n+36>>2];z=+g[n+40>>2];A=N*L+M*K+C*J+ +g[n+48>>2];B=N*I+M*H+C*G+ +g[n+52>>2];C=N*v+M*x+C*z+ +g[n+56>>2];g[l+1600>>2]=o*L+p*K+q*J;g[l+1604>>2]=r*L+s*K+t*J;g[l+1608>>2]=u*L+w*K+y*J;g[l+1612>>2]=0.0;g[l+1616>>2]=o*I+p*H+q*G;g[l+1620>>2]=r*I+s*H+t*G;g[l+1624>>2]=u*I+w*H+y*G;g[l+1628>>2]=0.0;g[l+1632>>2]=o*v+p*x+q*z;g[l+1636>>2]=r*v+s*x+t*z;g[l+1640>>2]=u*v+w*x+y*z;g[l+1644>>2]=0.0;g[l+1648>>2]=A;g[l+1652>>2]=B;g[l+1656>>2]=C;g[l+1660>>2]=0.0;b[l+32>>1]=1;b[l+34>>1]=-1;c[l+24>>2]=8024;c[l+36>>2]=j;c[l+40>>2]=D;g[l+28>>2]=+g[j+4>>2];E=c[h+8>>2]|0;c[l>>2]=h;c[l+4>>2]=F;c[l+8>>2]=E;c[l+12>>2]=l+1600;c[l+16>>2]=-1;c[l+20>>2]=D;Ku(d,e,f,l,l+24|0,k);D=D+1|0}while((D|0)<(c[m+16>>2]|0))}h=c[5022]|0;F=(c[h+16>>2]|0)+ -1|0;c[h+16>>2]=F;if(F){i=l;return}do if(c[h+4>>2]|0){Eb(l+1600|0,0)|0;F=c[5008]|0;g[h+8>>2]=+(((c[l+1604>>2]|0)-(c[F+4>>2]|0)+(((c[l+1600>>2]|0)-(c[F>>2]|0)|0)*1e6|0)-(c[h+12>>2]|0)|0)>>>0)/1.0e3+ +g[h+8>>2];if(!(c[h+16>>2]|0)){h=c[5022]|0;break}else{i=l;return}}while(0);c[5022]=c[h+20>>2];i=l;return}if((D|0)==21){v=+g[n>>2];p=+g[n+16>>2];q=+g[n+32>>2];r=+g[n+4>>2];s=+g[n+20>>2];t=+g[n+36>>2];C=+g[n+8>>2];A=+g[n+24>>2];y=+g[n+40>>2];u=-+g[n+48>>2];o=-+g[n+52>>2];w=-+g[n+56>>2];x=+g[e+48>>2];z=+g[e+52>>2];B=+g[e+56>>2];g[l+968>>2]=v*u+p*o+q*w+(v*x+p*z+q*B);g[l+972>>2]=r*u+s*o+t*w+(r*x+s*z+t*B);g[l+976>>2]=C*u+A*o+y*w+(C*x+A*z+y*B);g[l+980>>2]=0.0;B=+g[f+48>>2];z=+g[f+52>>2];x=+g[f+56>>2];O=+g[f>>2];G=+g[f+16>>2];H=+g[f+32>>2];I=+g[f+4>>2];J=+g[f+20>>2];K=+g[f+36>>2];L=+g[f+8>>2];M=+g[f+24>>2];N=+g[f+40>>2];g[l+904>>2]=v*O+p*G+q*H;g[l+908>>2]=v*I+p*J+q*K;g[l+912>>2]=v*L+p*M+q*N;g[l+916>>2]=0.0;g[l+920>>2]=r*O+s*G+t*H;g[l+924>>2]=r*I+s*J+t*K;g[l+928>>2]=r*L+s*M+t*N;g[l+932>>2]=0.0;g[l+936>>2]=C*O+A*G+y*H;g[l+940>>2]=C*I+A*J+y*K;g[l+944>>2]=C*L+A*M+y*N;F=l+948|0;c[F+0>>2]=0;c[F+4>>2]=0;c[F+8>>2]=0;c[F+12>>2]=0;c[F+16>>2]=0;h=c[h+8>>2]|0;N=+$b[c[(c[m>>2]|0)+48>>2]&15](m);c[l+680>>2]=16256;c[l+684>>2]=d;c[l+688>>2]=c[e+0>>2];c[l+692>>2]=c[e+4>>2];c[l+696>>2]=c[e+8>>2];c[l+700>>2]=c[e+12>>2];c[l+704>>2]=c[e+16>>2];c[l+708>>2]=c[e+20>>2];c[l+712>>2]=c[e+24>>2];c[l+716>>2]=c[e+28>>2];c[l+720>>2]=c[e+32>>2];c[l+724>>2]=c[e+36>>2];c[l+728>>2]=c[e+40>>2];c[l+732>>2]=c[e+44>>2];c[l+736>>2]=c[e+48>>2];c[l+740>>2]=c[e+52>>2];c[l+744>>2]=c[e+56>>2];c[l+748>>2]=c[e+60>>2];c[l+752>>2]=c[f+0>>2];c[l+756>>2]=c[f+4>>2];c[l+760>>2]=c[f+8>>2];c[l+764>>2]=c[f+12>>2];c[l+768>>2]=c[f+16>>2];c[l+772>>2]=c[f+20>>2];c[l+776>>2]=c[f+24>>2];c[l+780>>2]=c[f+28>>2];c[l+784>>2]=c[f+32>>2];c[l+788>>2]=c[f+36>>2];c[l+792>>2]=c[f+40>>2];c[l+796>>2]=c[f+44>>2];c[l+800>>2]=c[f+48>>2];c[l+804>>2]=c[f+52>>2];c[l+808>>2]=c[f+56>>2];c[l+812>>2]=c[f+60>>2];c[l+816>>2]=c[n+0>>2];c[l+820>>2]=c[n+4>>2];c[l+824>>2]=c[n+8>>2];c[l+828>>2]=c[n+12>>2];c[l+832>>2]=c[n+16>>2];c[l+836>>2]=c[n+20>>2];c[l+840>>2]=c[n+24>>2];c[l+844>>2]=c[n+28>>2];c[l+848>>2]=c[n+32>>2];c[l+852>>2]=c[n+36>>2];c[l+856>>2]=c[n+40>>2];c[l+860>>2]=c[n+44>>2];c[l+864>>2]=c[n+48>>2];c[l+868>>2]=c[n+52>>2];c[l+872>>2]=c[n+56>>2];c[l+876>>2]=c[n+60>>2];g[l+884>>2]=N;c[l+680>>2]=8448;c[l+892>>2]=j;c[l+896>>2]=h;c[l+900>>2]=m;g[l+880>>2]=+g[j+4>>2];g[l+888>>2]=k;vc[c[(c[d>>2]|0)+8>>2]&127](d,l+904|0,l+664|0,l+648|0);h=c[m+48>>2]|0;c[l+1600>>2]=5992;c[l+1604>>2]=h;c[l+1608>>2]=l+680;h=c[m+52>>2]|0;if(!(a[h+60>>0]|0)){OA(h,l+1600|0,l+968|0,v*u+p*o+q*w+(v*B+p*z+q*x),r*u+s*o+t*w+(r*B+s*z+t*x),C*u+A*o+y*w+(C*B+A*z+y*x),l+664|0,l+648|0);i=l;return}else{PA(h,l+1600|0,l+968|0,v*u+p*o+q*w+(v*B+p*z+q*x),r*u+s*o+t*w+(r*B+s*z+t*x),C*u+A*o+y*w+(C*B+A*z+y*x),l+664|0,l+648|0,c[h+56>>2]|0);i=l;return}}else if((D|0)==28){c[l+472>>2]=9440;c[l+640>>2]=0;g[l+644>>2]=k;g[l+636>>2]=+g[j+4>>2];c[l+448>>2]=10152;c[l+452>>2]=0;c[l+456>>2]=0;c[l+460>>2]=d;c[l+464>>2]=0;c[l+468>>2]=m;if(!(xw(l+448|0,e,f,n,n,l+472|0)|0)){i=l;return}m=l+604|0;k=+g[m>>2];o=+g[l+608>>2];p=+g[l+612>>2];if(!(k*k+o*o+p*p>9999999747378752.0e-20)){i=l;return}q=+g[l+636>>2];if(!(q<+g[j+4>>2])){i=l;return}O=1.0/+Q(+(k*k+o*o+p*p));g[m>>2]=k*O;g[l+608>>2]=o*O;g[l+612>>2]=p*O;c[l+400>>2]=c[h+8>>2];c[l+404>>2]=0;c[l+408>>2]=c[m+0>>2];c[l+412>>2]=c[m+4>>2];c[l+416>>2]=c[m+8>>2];c[l+420>>2]=c[m+12>>2];c[l+424>>2]=c[l+620>>2];c[l+428>>2]=c[l+624>>2];c[l+432>>2]=c[l+628>>2];c[l+436>>2]=c[l+632>>2];g[l+440>>2]=q;+hc[c[(c[j>>2]|0)+12>>2]&15](j,l+400|0,1);i=l;return}else{u=+g[n>>2];v=+g[n+16>>2];w=+g[n+32>>2];x=+g[n+4>>2];y=+g[n+20>>2];z=+g[n+36>>2];J=+g[n+8>>2];L=+g[n+24>>2];N=+g[n+40>>2];H=-+g[n+48>>2];G=-+g[n+52>>2];C=-+g[n+56>>2];A=+g[e+48>>2];B=+g[e+52>>2];p=+g[e+56>>2];t=u*H+v*G+w*C+(u*A+v*B+w*p);q=x*H+y*G+z*C+(x*A+y*B+z*p);p=J*H+L*G+N*C+(J*A+L*B+N*p);B=+g[f+48>>2];A=+g[f+52>>2];o=+g[f+56>>2];s=u*H+v*G+w*C+(u*B+v*A+w*o);r=x*H+y*G+z*C+(x*B+y*A+z*o);o=J*H+L*G+N*C+(J*B+L*A+N*o);A=+g[f>>2];B=+g[f+16>>2];C=+g[f+32>>2];G=+g[f+4>>2];H=+g[f+20>>2];I=+g[f+36>>2];K=+g[f+8>>2];M=+g[f+24>>2];O=+g[f+40>>2];g[l+336>>2]=u*A+v*B+w*C;g[l+340>>2]=u*G+v*H+w*I;g[l+344>>2]=u*K+v*M+w*O;g[l+348>>2]=0.0;g[l+352>>2]=x*A+y*B+z*C;g[l+356>>2]=x*G+y*H+z*I;g[l+360>>2]=x*K+y*M+z*O;g[l+364>>2]=0.0;g[l+368>>2]=J*A+L*B+N*C;g[l+372>>2]=J*G+L*H+N*I;g[l+376>>2]=J*K+L*M+N*O;F=l+380|0;c[F+0>>2]=0;c[F+4>>2]=0;c[F+8>>2]=0;c[F+12>>2]=0;c[F+16>>2]=0;F=c[h+8>>2]|0;O=+$b[c[(c[m>>2]|0)+48>>2]&15](m);c[l+112>>2]=16256;c[l+116>>2]=d;c[l+120>>2]=c[e+0>>2];c[l+124>>2]=c[e+4>>2];c[l+128>>2]=c[e+8>>2];c[l+132>>2]=c[e+12>>2];c[l+136>>2]=c[e+16>>2];c[l+140>>2]=c[e+20>>2];c[l+144>>2]=c[e+24>>2];c[l+148>>2]=c[e+28>>2];c[l+152>>2]=c[e+32>>2];c[l+156>>2]=c[e+36>>2];c[l+160>>2]=c[e+40>>2];c[l+164>>2]=c[e+44>>2];c[l+168>>2]=c[e+48>>2];c[l+172>>2]=c[e+52>>2];c[l+176>>2]=c[e+56>>2];c[l+180>>2]=c[e+60>>2];c[l+184>>2]=c[f+0>>2];c[l+188>>2]=c[f+4>>2];c[l+192>>2]=c[f+8>>2];c[l+196>>2]=c[f+12>>2];c[l+200>>2]=c[f+16>>2];c[l+204>>2]=c[f+20>>2];c[l+208>>2]=c[f+24>>2];c[l+212>>2]=c[f+28>>2];c[l+216>>2]=c[f+32>>2];c[l+220>>2]=c[f+36>>2];c[l+224>>2]=c[f+40>>2];c[l+228>>2]=c[f+44>>2];c[l+232>>2]=c[f+48>>2];c[l+236>>2]=c[f+52>>2];c[l+240>>2]=c[f+56>>2];c[l+244>>2]=c[f+60>>2];c[l+248>>2]=c[n+0>>2];c[l+252>>2]=c[n+4>>2];c[l+256>>2]=c[n+8>>2];c[l+260>>2]=c[n+12>>2];c[l+264>>2]=c[n+16>>2];c[l+268>>2]=c[n+20>>2];c[l+272>>2]=c[n+24>>2];c[l+276>>2]=c[n+28>>2];c[l+280>>2]=c[n+32>>2];c[l+284>>2]=c[n+36>>2];c[l+288>>2]=c[n+40>>2];c[l+292>>2]=c[n+44>>2];c[l+296>>2]=c[n+48>>2];c[l+300>>2]=c[n+52>>2];c[l+304>>2]=c[n+56>>2];c[l+308>>2]=c[n+60>>2];g[l+316>>2]=O;c[l+112>>2]=8224;c[l+324>>2]=j;c[l+328>>2]=F;c[l+332>>2]=m;g[l+312>>2]=+g[j+4>>2];g[l+320>>2]=k;vc[c[(c[d>>2]|0)+8>>2]&127](d,l+336|0,l+96|0,l+80|0);g[l+64>>2]=t;g[l+68>>2]=q;g[l+72>>2]=p;g[l+76>>2]=0.0;if(s<t){g[l+64>>2]=s;v=s}else v=t;if(r<q){g[l+68>>2]=r;u=r}else u=q;if(o<p){g[l+72>>2]=o;k=o}else k=p;g[l+48>>2]=t;g[l+52>>2]=q;g[l+56>>2]=p;g[l+60>>2]=0.0;if(t<s)g[l+48>>2]=s;else s=t;if(q<r){g[l+52>>2]=r;q=r}if(p<o)g[l+56>>2]=o;else o=p;g[l+64>>2]=+g[l+96>>2]+v;g[l+68>>2]=+g[l+100>>2]+u;g[l+72>>2]=+g[l+104>>2]+k;g[l+48>>2]=+g[l+80>>2]+s;g[l+52>>2]=+g[l+84>>2]+q;g[l+56>>2]=+g[l+88>>2]+o;vc[c[(c[m>>2]|0)+64>>2]&127](m,l+112|0,l+64|0,l+48|0);i=l;return}}function Lu(a){a=a|0;return}function Mu(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0;j=i;i=i+256|0;c[j+32>>2]=7960;h=j+68|0;c[h+0>>2]=c[b+0>>2];c[h+4>>2]=c[b+4>>2];c[h+8>>2]=c[b+8>>2];c[h+12>>2]=c[b+12>>2];f=j+84|0;c[f+0>>2]=c[d+0>>2];c[f+4>>2]=c[d+4>>2];c[f+8>>2]=c[d+8>>2];c[f+12>>2]=c[d+12>>2];c[j+244>>2]=a;c[j+248>>2]=e;g[j+100>>2]=1.0;c[j+104>>2]=0;c[j+108>>2]=0;c[j+112>>2]=0;c[j+116>>2]=0;g[j+120>>2]=1.0;c[j+124>>2]=0;c[j+128>>2]=0;c[j+132>>2]=0;c[j+136>>2]=0;g[j+140>>2]=1.0;c[j+144>>2]=0;c[j+148>>2]=c[h+0>>2];c[j+152>>2]=c[h+4>>2];c[j+156>>2]=c[h+8>>2];c[j+160>>2]=c[h+12>>2];g[j+164>>2]=1.0;c[j+168>>2]=0;c[j+172>>2]=0;c[j+176>>2]=0;c[j+180>>2]=0;g[j+184>>2]=1.0;c[j+188>>2]=0;c[j+192>>2]=0;c[j+196>>2]=0;c[j+200>>2]=0;g[j+204>>2]=1.0;c[j+208>>2]=0;c[j+212>>2]=c[d+0>>2];c[j+216>>2]=c[d+4>>2];c[j+220>>2]=c[d+8>>2];c[j+224>>2]=c[d+12>>2];n=+g[d>>2]- +g[b>>2];k=+g[d+4>>2]- +g[b+4>>2];q=+g[d+8>>2]- +g[b+8>>2];l=1.0/+Q(+(n*n+k*k+q*q));if(n*l==0.0)p=999999984306749400.0;else p=1.0/(n*l);g[j+36>>2]=p;if(k*l==0.0)o=999999984306749400.0;else o=1.0/(k*l);g[j+40>>2]=o;if(q*l==0.0)m=999999984306749400.0;else m=1.0/(q*l);g[j+44>>2]=m;c[j+52>>2]=p<0.0&1;c[j+56>>2]=o<0.0&1;c[j+60>>2]=m<0.0&1;g[j+64>>2]=n*l*(+g[f>>2]- +g[h>>2])+k*l*(+g[j+88>>2]- +g[j+72>>2])+q*l*(+g[j+92>>2]- +g[j+76>>2]);e=c[a+68>>2]|0;h=c[(c[e>>2]|0)+24>>2]|0;c[j+16>>2]=0;c[j+20>>2]=0;c[j+24>>2]=0;c[j+28>>2]=0;c[j+0>>2]=0;c[j+4>>2]=0;c[j+8>>2]=0;c[j+12>>2]=0;Zb[h&7](e,b,d,j+32|0,j+16|0,j);i=j;return}function Nu(a){a=a|0;return}function Ou(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=+h;var j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0,t=0,u=0.0,v=0;j=i;i=i+416|0;yE(7568);c[j+144>>2]=c[d+0>>2];c[j+148>>2]=c[d+4>>2];c[j+152>>2]=c[d+8>>2];c[j+156>>2]=c[d+12>>2];c[j+160>>2]=c[d+16>>2];c[j+164>>2]=c[d+20>>2];c[j+168>>2]=c[d+24>>2];c[j+172>>2]=c[d+28>>2];c[j+176>>2]=c[d+32>>2];c[j+180>>2]=c[d+36>>2];c[j+184>>2]=c[d+40>>2];c[j+188>>2]=c[d+44>>2];k=j+192|0;c[k+0>>2]=c[d+48>>2];c[k+4>>2]=c[d+52>>2];c[k+8>>2]=c[d+56>>2];c[k+12>>2]=c[d+60>>2];c[j+80>>2]=c[e+0>>2];c[j+84>>2]=c[e+4>>2];c[j+88>>2]=c[e+8>>2];c[j+92>>2]=c[e+12>>2];c[j+96>>2]=c[e+16>>2];c[j+100>>2]=c[e+20>>2];c[j+104>>2]=c[e+24>>2];c[j+108>>2]=c[e+28>>2];c[j+112>>2]=c[e+32>>2];c[j+116>>2]=c[e+36>>2];c[j+120>>2]=c[e+40>>2];c[j+124>>2]=c[e+44>>2];l=j+128|0;c[l+0>>2]=c[e+48>>2];c[l+4>>2]=c[e+52>>2];c[l+8>>2]=c[e+56>>2];c[l+12>>2]=c[e+60>>2];Lo(j+144|0,j+80|0,j+212|0,j+208|0);u=+g[j+208>>2];m=u*+g[j+216>>2];r=u*+g[j+220>>2];g[j+32>>2]=+g[j+212>>2]*u;g[j+36>>2]=m;g[j+40>>2]=r;g[j+44>>2]=0.0;c[j+16>>2]=0;c[j+20>>2]=0;c[j+24>>2]=0;c[j+28>>2]=0;g[j+212>>2]=1.0;v=j+216|0;c[v+0>>2]=0;c[v+4>>2]=0;c[v+8>>2]=0;c[v+12>>2]=0;g[j+232>>2]=1.0;t=j+236|0;c[t+0>>2]=0;c[t+4>>2]=0;c[t+8>>2]=0;c[t+12>>2]=0;g[j+252>>2]=1.0;s=j+256|0;c[s+0>>2]=0;c[s+4>>2]=0;c[s+8>>2]=0;c[s+12>>2]=0;c[s+16>>2]=0;Hc(j+144|0,j);r=+g[j>>2];m=+g[j+4>>2];u=+g[j+8>>2];q=+g[j+12>>2];o=r*(2.0/(r*r+m*m+u*u+q*q));n=m*(2.0/(r*r+m*m+u*u+q*q));p=u*(2.0/(r*r+m*m+u*u+q*q));g[j+212>>2]=1.0-(m*n+u*p);g[v>>2]=r*n-q*p;g[j+220>>2]=r*p+q*n;g[j+224>>2]=0.0;g[j+228>>2]=r*n+q*p;g[j+232>>2]=1.0-(r*o+u*p);g[t>>2]=m*p-q*o;g[j+240>>2]=0.0;g[j+244>>2]=r*p-q*n;g[j+248>>2]=m*p+q*o;g[j+252>>2]=1.0-(r*o+m*n);g[s>>2]=0.0;wu(b,j+212|0,j+16|0,j+32|0,j+64|0,j+48|0);c[j+212>>2]=7848;c[j+248>>2]=c[d+0>>2];c[j+252>>2]=c[d+4>>2];c[j+256>>2]=c[d+8>>2];c[j+260>>2]=c[d+12>>2];c[j+264>>2]=c[d+16>>2];c[j+268>>2]=c[d+20>>2];c[j+272>>2]=c[d+24>>2];c[j+276>>2]=c[d+28>>2];c[j+280>>2]=c[d+32>>2];c[j+284>>2]=c[d+36>>2];c[j+288>>2]=c[d+40>>2];c[j+292>>2]=c[d+44>>2];s=j+296|0;c[s+0>>2]=c[d+48>>2];c[s+4>>2]=c[d+52>>2];c[s+8>>2]=c[d+56>>2];c[s+12>>2]=c[d+60>>2];c[j+312>>2]=c[e+0>>2];c[j+316>>2]=c[e+4>>2];c[j+320>>2]=c[e+8>>2];c[j+324>>2]=c[e+12>>2];c[j+328>>2]=c[e+16>>2];c[j+332>>2]=c[e+20>>2];c[j+336>>2]=c[e+24>>2];c[j+340>>2]=c[e+28>>2];c[j+344>>2]=c[e+32>>2];c[j+348>>2]=c[e+36>>2];c[j+352>>2]=c[e+40>>2];c[j+356>>2]=c[e+44>>2];d=j+360|0;c[d+0>>2]=c[e+48>>2];c[d+4>>2]=c[e+52>>2];c[d+8>>2]=c[e+56>>2];c[d+12>>2]=c[e+60>>2];c[j+392>>2]=a;c[j+396>>2]=f;g[j+400>>2]=h;c[j+404>>2]=b;n=+g[d>>2]- +g[s>>2];h=+g[j+364>>2]- +g[j+300>>2];m=+g[j+368>>2]- +g[j+304>>2];o=1.0/+Q(+(n*n+h*h+m*m));if(n*o==0.0)p=999999984306749400.0;else p=1.0/(n*o);g[j+216>>2]=p;if(h*o==0.0)q=999999984306749400.0;else q=1.0/(h*o);g[j+220>>2]=q;if(m*o==0.0)r=999999984306749400.0;else r=1.0/(m*o);g[j+224>>2]=r;c[j+232>>2]=p<0.0&1;c[j+236>>2]=q<0.0&1;c[j+240>>2]=r<0.0&1;g[j+244>>2]=m*m*o+(n*n*o+h*h*o);v=c[a+68>>2]|0;Zb[c[(c[v>>2]|0)+24>>2]&7](v,k,l,j+212|0,j+64|0,j+48|0);k=c[5022]|0;v=(c[k+16>>2]|0)+ -1|0;c[k+16>>2]=v;if(v){i=j;return}do if(c[k+4>>2]|0){Eb(j+212|0,0)|0;v=c[5008]|0;g[k+8>>2]=+(((c[j+216>>2]|0)-(c[v+4>>2]|0)+(((c[j+212>>2]|0)-(c[v>>2]|0)|0)*1e6|0)-(c[k+12>>2]|0)|0)>>>0)/1.0e3+ +g[k+8>>2];if(!(c[k+16>>2]|0)){k=c[5022]|0;break}else{i=j;return}}while(0);c[5022]=c[k+20>>2];i=j;return}function Pu(a){a=a|0;return}function Qu(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;i=i+96|0;g=c[b+192>>2]|0;c[f+64>>2]=0;c[f+68>>2]=g;c[f+72>>2]=b;c[f+76>>2]=b+4;c[f+80>>2]=-1;c[f+84>>2]=-1;b=c[d+192>>2]|0;c[f+40>>2]=0;c[f+44>>2]=b;c[f+48>>2]=d;c[f+52>>2]=d+4;c[f+56>>2]=-1;c[f+60>>2]=-1;d=c[a+24>>2]|0;d=Tb[c[(c[d>>2]|0)+8>>2]&31](d,f+64|0,f+40|0,0)|0;if(!d){i=f;return}c[f+4>>2]=0;c[f+8>>2]=f+64;c[f+12>>2]=f+40;c[f>>2]=7728;c[f+32>>2]=e;Jb[c[(c[d>>2]|0)+8>>2]&31](d,f+64|0,f+40|0,a+28|0,f);Lb[c[c[d>>2]>>2]&511](d);g=c[a+24>>2]|0;Nb[c[(c[g>>2]|0)+60>>2]&127](g,d);i=f;return}function Ru(a){a=a|0;return}function Su(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0.0,m=0.0,n=0,o=0.0,p=0,q=0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0,N=0;f=i;i=i+480|0;h=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;tc[c[(c[h>>2]|0)+56>>2]&7](h,b,1.0);h=c[d+4>>2]|0;switch(h|0){case 0:{c[f+400>>2]=c[d+28>>2];c[f+404>>2]=c[d+32>>2];c[f+408>>2]=c[d+36>>2];c[f+412>>2]=c[d+40>>2];l=+$b[c[(c[d>>2]|0)+48>>2]&15](d);m=+$b[c[(c[d>>2]|0)+48>>2]&15](d);o=+$b[c[(c[d>>2]|0)+48>>2]&15](d);l=l+ +g[f+400>>2];g[f+400>>2]=l;m=m+ +g[f+404>>2];g[f+404>>2]=m;o=o+ +g[f+408>>2];g[f+408>>2]=o;r=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;q=c[(c[r>>2]|0)+72>>2]|0;g[f+384>>2]=-l;g[f+388>>2]=-m;g[f+392>>2]=-o;g[f+396>>2]=0.0;Jb[q&31](r,f+384|0,f+400|0,b,e);i=f;return};case 9:{h=c[d+92>>2]|0;if((h|0)<=0){i=f;return}do{h=h+ -1|0;r=c[d+100>>2]|0;D=+g[r+(h<<4)>>2];C=+g[r+(h<<4)+4>>2];m=+g[r+(h<<4)+8>>2];r=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;q=c[(c[r>>2]|0)+16>>2]|0;o=+g[(c[d+120>>2]|0)+(h<<2)>>2];A=+g[b>>2];z=+g[b+4>>2];B=+g[b+8>>2];x=+g[b+16>>2];w=+g[b+20>>2];y=+g[b+24>>2];u=+g[b+32>>2];t=+g[b+36>>2];v=+g[b+40>>2];s=D*A+C*z+m*B+ +g[b+48>>2];l=D*x+C*w+m*y+ +g[b+52>>2];m=D*u+C*t+m*v+ +g[b+56>>2];g[f+320>>2]=A+z*0.0+B*0.0;g[f+324>>2]=A*0.0+z+B*0.0;g[f+328>>2]=B+(A*0.0+z*0.0);g[f+332>>2]=0.0;g[f+336>>2]=x+w*0.0+y*0.0;g[f+340>>2]=x*0.0+w+y*0.0;g[f+344>>2]=y+(x*0.0+w*0.0);g[f+348>>2]=0.0;g[f+352>>2]=u+t*0.0+v*0.0;g[f+356>>2]=u*0.0+t+v*0.0;g[f+360>>2]=v+(u*0.0+t*0.0);g[f+364>>2]=0.0;g[f+368>>2]=s;g[f+372>>2]=l;g[f+376>>2]=m;g[f+380>>2]=0.0;Sb[q&0](r,o,f+320|0,e)}while((h|0)>0);i=f;return};case 11:{C=+g[d+56>>2];D=+g[d+60>>2];r=c[d+68>>2]|0;q=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;Rb[c[(c[q>>2]|0)+84>>2]&0](q,C,D,r,b,e);i=f;return};case 13:{r=c[d+52>>2]|0;C=+$b[c[(c[d>>2]|0)+92>>2]&15](d);c[f+304>>2]=c[d+28>>2];c[f+308>>2]=c[d+32>>2];c[f+312>>2]=c[d+36>>2];c[f+316>>2]=c[d+40>>2];A=+$b[c[(c[d>>2]|0)+48>>2]&15](d);B=+$b[c[(c[d>>2]|0)+48>>2]&15](d);D=+$b[c[(c[d>>2]|0)+48>>2]&15](d);g[f+304>>2]=A+ +g[f+304>>2];g[f+308>>2]=B+ +g[f+308>>2];g[f+312>>2]=D+ +g[f+312>>2];D=+g[f+304+(r<<2)>>2];q=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;Rb[c[(c[q>>2]|0)+80>>2]&0](q,C,D,r,b,e);i=f;return};case 31:{h=c[d+16>>2]|0;if((h|0)<=0){i=f;return}do{h=h+ -1|0;r=c[d+24>>2]|0;l=+g[r+(h*80|0)>>2];s=+g[r+(h*80|0)+4>>2];v=+g[r+(h*80|0)+8>>2];m=+g[r+(h*80|0)+16>>2];t=+g[r+(h*80|0)+20>>2];x=+g[r+(h*80|0)+24>>2];o=+g[r+(h*80|0)+32>>2];u=+g[r+(h*80|0)+36>>2];z=+g[r+(h*80|0)+40>>2];L=+g[r+(h*80|0)+48>>2];K=+g[r+(h*80|0)+52>>2];D=+g[r+(h*80|0)+56>>2];r=c[r+(h*80|0)+64>>2]|0;q=c[(c[a>>2]|0)+28>>2]|0;J=+g[b>>2];I=+g[b+4>>2];H=+g[b+8>>2];G=+g[b+16>>2];F=+g[b+20>>2];E=+g[b+24>>2];w=+g[b+32>>2];y=+g[b+36>>2];A=+g[b+40>>2];B=L*J+K*I+D*H+ +g[b+48>>2];C=L*G+K*F+D*E+ +g[b+52>>2];D=L*w+K*y+D*A+ +g[b+56>>2];g[f+416>>2]=l*J+m*I+o*H;g[f+420>>2]=s*J+t*I+u*H;g[f+424>>2]=v*J+x*I+z*H;g[f+428>>2]=0.0;g[f+432>>2]=l*G+m*F+o*E;g[f+436>>2]=s*G+t*F+u*E;g[f+440>>2]=v*G+x*F+z*E;g[f+444>>2]=0.0;g[f+448>>2]=l*w+m*y+o*A;g[f+452>>2]=s*w+t*y+u*A;g[f+456>>2]=v*w+x*y+z*A;g[f+460>>2]=0.0;g[f+464>>2]=B;g[f+468>>2]=C;g[f+472>>2]=D;g[f+476>>2]=0.0;vc[q&127](a,f+416|0,r,e)}while((h|0)>0);i=f;return};case 28:{L=+g[d+64>>2];r=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;cc[c[(c[r>>2]|0)+88>>2]&0](r,d+48|0,L,b,e);i=f;return};case 8:{L=+$b[c[(c[d>>2]|0)+48>>2]&15](d);r=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;Sb[c[(c[r>>2]|0)+16>>2]&0](r,L,b,e);i=f;return};case 10:{r=c[d+52>>2]|0;K=+g[d+(((r+2|0)%3|0)<<2)+28>>2];L=+g[d+(r<<2)+28>>2];q=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;Rb[c[(c[q>>2]|0)+76>>2]&0](q,K,L,r,b,e);i=f;return};default:{a:do if((h|0)<7){j=c[d+52>>2]|0;if(!j){if((Pb[c[(c[d>>2]|0)+100>>2]&127](d)|0)<=0)break;h=0;while(1){vc[c[(c[d>>2]|0)+104>>2]&127](d,h,f+208|0,f+192|0);J=+g[f+208>>2];x=+g[b>>2];H=+g[f+212>>2];y=+g[b+4>>2];F=+g[f+216>>2];z=+g[b+8>>2];B=+g[b+16>>2];C=+g[b+20>>2];D=+g[b+24>>2];G=+g[b+32>>2];I=+g[b+36>>2];K=+g[b+40>>2];A=+g[b+48>>2];E=+g[b+52>>2];L=+g[b+56>>2];g[f+176>>2]=J*x+H*y+F*z+A;g[f+180>>2]=J*B+H*C+F*D+E;g[f+184>>2]=J*G+H*I+F*K+L;g[f+188>>2]=0.0;F=+g[f+192>>2];H=+g[f+196>>2];J=+g[f+200>>2];g[f+160>>2]=F*x+H*y+J*z+A;g[f+164>>2]=F*B+H*C+J*D+E;g[f+168>>2]=F*G+H*I+J*K+L;g[f+172>>2]=0.0;r=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;vc[c[(c[r>>2]|0)+8>>2]&127](r,f+176|0,f+160|0,e);h=h+1|0;if((h|0)>=(Pb[c[(c[d>>2]|0)+100>>2]&127](d)|0))break a}}if((c[j+28>>2]|0)>0){h=0;do{n=c[j+36>>2]|0;k=c[n+(h*36|0)+4>>2]|0;b:do if((k|0)>0){p=c[n+(h*36|0)+12>>2]|0;q=p;o=0.0;m=0.0;l=0.0;p=c[p+(k+ -1<<2)>>2]|0;r=0;while(1){n=c[q+(r<<2)>>2]|0;q=c[j+16>>2]|0;o=o+ +g[q+(n<<4)>>2];m=m+ +g[q+(n<<4)+4>>2];l=l+ +g[q+(n<<4)+8>>2];q=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;M=c[(c[q>>2]|0)+8>>2]|0;N=c[j+16>>2]|0;J=+g[N+(p<<4)>>2];x=+g[b>>2];H=+g[N+(p<<4)+4>>2];y=+g[b+4>>2];F=+g[N+(p<<4)+8>>2];z=+g[b+8>>2];B=+g[b+16>>2];C=+g[b+20>>2];D=+g[b+24>>2];G=+g[b+32>>2];I=+g[b+36>>2];K=+g[b+40>>2];A=+g[b+48>>2];E=+g[b+52>>2];L=+g[b+56>>2];g[f+288>>2]=J*x+H*y+F*z+A;g[f+292>>2]=J*B+H*C+F*D+E;g[f+296>>2]=J*G+H*I+F*K+L;g[f+300>>2]=0.0;F=+g[N+(n<<4)>>2];H=+g[N+(n<<4)+4>>2];J=+g[N+(n<<4)+8>>2];g[f+272>>2]=F*x+H*y+J*z+A;g[f+276>>2]=F*B+H*C+J*D+E;g[f+280>>2]=F*G+H*I+J*K+L;g[f+284>>2]=0.0;vc[M&127](q,f+288|0,f+272|0,e);r=r+1|0;p=c[j+36>>2]|0;if((r|0)>=(c[p+(h*36|0)+4>>2]|0))break b;q=c[p+(h*36|0)+12>>2]|0;p=n}}else{o=0.0;m=0.0;l=0.0}while(0);o=o*(1.0/+(k|0));m=m*(1.0/+(k|0));l=l*(1.0/+(k|0));N=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;if((Pb[c[(c[N>>2]|0)+48>>2]&127](N)|0)&16384){g[f+256>>2]=1.0;g[f+260>>2]=1.0;g[f+264>>2]=0.0;g[f+268>>2]=0.0;N=c[j+36>>2]|0;F=+g[N+(h*36|0)+20>>2];H=+g[N+(h*36|0)+24>>2];J=+g[N+(h*36|0)+28>>2];N=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;M=c[(c[N>>2]|0)+8>>2]|0;x=+g[b>>2];y=+g[b+4>>2];z=+g[b+8>>2];B=+g[b+16>>2];C=+g[b+20>>2];D=+g[b+24>>2];G=+g[b+32>>2];I=+g[b+36>>2];K=+g[b+40>>2];A=+g[b+48>>2];E=+g[b+52>>2];L=+g[b+56>>2];g[f+240>>2]=o*x+m*y+l*z+A;g[f+244>>2]=o*B+m*C+l*D+E;g[f+248>>2]=o*G+m*I+l*K+L;g[f+252>>2]=0.0;g[f+224>>2]=(o+F)*x+(m+H)*y+(l+J)*z+A;g[f+228>>2]=(o+F)*B+(m+H)*C+(l+J)*D+E;g[f+232>>2]=(o+F)*G+(m+H)*I+(l+J)*K+L;g[f+236>>2]=0.0;vc[M&127](N,f+240|0,f+224|0,f+256|0)}h=h+1|0}while((h|0)<(c[j+28>>2]|0))}}while(0);h=c[d+4>>2]|0;if((h+ -21|0)>>>0<9){g[f+144>>2]=999999984306749400.0;g[f+148>>2]=999999984306749400.0;g[f+152>>2]=999999984306749400.0;g[f+156>>2]=0.0;g[f+128>>2]=-999999984306749400.0;g[f+132>>2]=-999999984306749400.0;g[f+136>>2]=-999999984306749400.0;g[f+140>>2]=0.0;h=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;c[f+32>>2]=7624;c[f+36>>2]=7648;c[f+40>>2]=h;c[f+44>>2]=c[e+0>>2];c[f+48>>2]=c[e+4>>2];c[f+52>>2]=c[e+8>>2];c[f+56>>2]=c[e+12>>2];c[f+60>>2]=c[b+0>>2];c[f+64>>2]=c[b+4>>2];c[f+68>>2]=c[b+8>>2];c[f+72>>2]=c[b+12>>2];c[f+76>>2]=c[b+16>>2];c[f+80>>2]=c[b+20>>2];c[f+84>>2]=c[b+24>>2];c[f+88>>2]=c[b+28>>2];c[f+92>>2]=c[b+32>>2];c[f+96>>2]=c[b+36>>2];c[f+100>>2]=c[b+40>>2];c[f+104>>2]=c[b+44>>2];c[f+108>>2]=c[b+48>>2];c[f+112>>2]=c[b+52>>2];c[f+116>>2]=c[b+56>>2];c[f+120>>2]=c[b+60>>2];vc[c[(c[d>>2]|0)+64>>2]&127](d,f+32|0,f+128|0,f+144|0);h=c[d+4>>2]|0}if((h|0)!=3){i=f;return}g[f+16>>2]=999999984306749400.0;g[f+20>>2]=999999984306749400.0;g[f+24>>2]=999999984306749400.0;g[f+28>>2]=0.0;g[f>>2]=-999999984306749400.0;g[f+4>>2]=-999999984306749400.0;g[f+8>>2]=-999999984306749400.0;g[f+12>>2]=0.0;N=Pb[c[(c[a>>2]|0)+20>>2]&127](a)|0;c[f+32>>2]=7624;c[f+36>>2]=7648;c[f+40>>2]=N;c[f+44>>2]=c[e+0>>2];c[f+48>>2]=c[e+4>>2];c[f+52>>2]=c[e+8>>2];c[f+56>>2]=c[e+12>>2];c[f+60>>2]=c[b+0>>2];c[f+64>>2]=c[b+4>>2];c[f+68>>2]=c[b+8>>2];c[f+72>>2]=c[b+12>>2];c[f+76>>2]=c[b+16>>2];c[f+80>>2]=c[b+20>>2];c[f+84>>2]=c[b+24>>2];c[f+88>>2]=c[b+28>>2];c[f+92>>2]=c[b+32>>2];c[f+96>>2]=c[b+36>>2];c[f+100>>2]=c[b+40>>2];c[f+104>>2]=c[b+44>>2];c[f+108>>2]=c[b+48>>2];c[f+112>>2]=c[b+52>>2];c[f+116>>2]=c[b+56>>2];c[f+120>>2]=c[b+60>>2];N=c[d+92>>2]|0;vc[c[(c[N>>2]|0)+8>>2]&127](N,f+36|0,f,f+16|0);i=f;return}}}function Tu(a){a=a|0;return}function Uu(b){b=b|0;var d=0,e=0,f=0,h=0,j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0;d=i;i=i+112|0;if(((Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)!=0?(r=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0,((Pb[c[(c[r>>2]|0)+48>>2]&127](r)|0)&8|0)!=0):0)?(e=c[b+24>>2]|0,e=Pb[c[(c[e>>2]|0)+36>>2]&127](e)|0,g[d+96>>2]=1.0,g[d+100>>2]=1.0,g[d+104>>2]=0.0,g[d+108>>2]=0.0,(e|0)>0):0){q=0;do{h=c[b+24>>2]|0;h=gc[c[(c[h>>2]|0)+40>>2]&31](h,q)|0;j=c[h+748>>2]|0;if((j|0)>0){f=0;do{r=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;Mb[c[(c[r>>2]|0)+32>>2]&0](r,h+(f*184|0)+36|0,h+(f*184|0)+68|0,+g[h+(f*184|0)+84>>2],c[h+(f*184|0)+152>>2]|0,d+96|0);f=f+1|0}while((f|0)!=(j|0))}q=q+1|0}while((q|0)!=(e|0))}if(!(Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)){i=d;return}r=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0;if(!((Pb[c[(c[r>>2]|0)+48>>2]&127](r)|0)&3)){i=d;return}if((c[b+8>>2]|0)<=0){i=d;return}j=d+84|0;h=d+88|0;f=d+92|0;e=0;do{q=c[(c[b+16>>2]|0)+(e<<2)>>2]|0;if(!(c[q+204>>2]&32)){if((Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0)!=0?(r=Pb[c[(c[b>>2]|0)+20>>2]&127](b)|0,((Pb[c[(c[r>>2]|0)+48>>2]&127](r)|0)&1|0)!=0):0){g[d+80>>2]=1.0;g[j>>2]=1.0;g[h>>2]=1.0;g[f>>2]=0.0;switch(c[q+216>>2]|0){case 3:{g[d+80>>2]=0.0;g[j>>2]=1.0;g[h>>2]=1.0;g[f>>2]=0.0;break};case 5:{g[d+80>>2]=1.0;g[j>>2]=1.0;g[h>>2]=0.0;g[f>>2]=0.0;break};case 1:{g[d+80>>2]=1.0;g[j>>2]=1.0;g[h>>2]=1.0;g[f>>2]=0.0;break};case 2:{g[d+80>>2]=0.0;g[j>>2]=1.0;g[h>>2]=0.0;g[f>>2]=0.0;break};case 4:{g[d+80>>2]=1.0;g[j>>2]=0.0;g[h>>2]=0.0;g[f>>2]=0.0;break};default:{g[d+80>>2]=1.0;g[j>>2]=0.0;g[h>>2]=0.0;g[f>>2]=0.0}}vc[c[(c[b>>2]|0)+28>>2]&127](b,q+4|0,c[q+192>>2]|0,d+80|0)}r=c[b+72>>2]|0;if((r|0)!=0?((Pb[c[(c[r>>2]|0)+48>>2]&127](r)|0)&2|0)!=0:0){g[d+32>>2]=1.0;g[d+36>>2]=0.0;g[d+40>>2]=0.0;g[d+44>>2]=0.0;r=c[q+192>>2]|0;vc[c[(c[r>>2]|0)+8>>2]&127](r,q+4|0,d+64|0,d+48|0);g[d+64>>2]=+g[d+64>>2]+-.019999999552965164;g[d+68>>2]=+g[d+68>>2]+-.019999999552965164;g[d+72>>2]=+g[d+72>>2]+-.019999999552965164;g[d+48>>2]=+g[d+48>>2]+.019999999552965164;g[d+52>>2]=+g[d+52>>2]+.019999999552965164;g[d+56>>2]=+g[d+56>>2]+.019999999552965164;do if(((a[b+44>>0]|0)!=0?(c[q+236>>2]|0)==2:0)?(c[q+204>>2]&3|0)==0:0){r=c[q+192>>2]|0;vc[c[(c[r>>2]|0)+8>>2]&127](r,q+68|0,d+16|0,d);p=+g[d+16>>2]+-.019999999552965164;g[d+16>>2]=p;o=+g[d+20>>2]+-.019999999552965164;g[d+20>>2]=o;n=+g[d+24>>2]+-.019999999552965164;g[d+24>>2]=n;m=+g[d>>2]+.019999999552965164;g[d>>2]=m;l=+g[d+4>>2]+.019999999552965164;g[d+4>>2]=l;k=+g[d+8>>2]+.019999999552965164;g[d+8>>2]=k;if(p<+g[d+64>>2])g[d+64>>2]=p;if(o<+g[d+68>>2])g[d+68>>2]=o;if(n<+g[d+72>>2])g[d+72>>2]=n;n=+g[d+28>>2];if(n<+g[d+76>>2])g[d+76>>2]=n;if(+g[d+48>>2]<m)g[d+48>>2]=m;if(+g[d+52>>2]<l)g[d+52>>2]=l;if(+g[d+56>>2]<k)g[d+56>>2]=k;k=+g[d+12>>2];if(!(+g[d+60>>2]<k))break;g[d+60>>2]=k}while(0);r=c[b+72>>2]|0;vc[c[(c[r>>2]|0)+52>>2]&127](r,d+64|0,d+48|0,d+32|0)}}e=e+1|0}while((e|0)<(c[b+8>>2]|0));i=d;return}function Vu(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0;j=i;i=i+80|0;r=c[b+8>>2]|0;if((r|0)>0){m=0;do{n=c[(c[b+16>>2]|0)+(m<<2)>>2]|0;if((c[n+236>>2]|0)==1){Nb[c[(c[n>>2]|0)+24>>2]&127](n,d);r=c[b+8>>2]|0}m=m+1|0}while((m|0)<(r|0))}a[j+16>>0]=1;c[j+12>>2]=0;c[j+4>>2]=0;c[j+8>>2]=0;a[j+36>>0]=1;c[j+32>>2]=0;c[j+24>>2]=0;c[j+28>>2]=0;a[j+56>>0]=1;c[j+52>>2]=0;c[j+44>>2]=0;c[j+48>>2]=0;a[j+76>>0]=1;c[j+72>>2]=0;c[j+64>>2]=0;c[j+68>>2]=0;if((r|0)<=0){Xu(j);i=j;return}u=-1;t=0;p=0;s=0;q=0;m=0;while(1){n=c[(c[(c[b+16>>2]|0)+(m<<2)>>2]|0)+192>>2]|0;o=(n+~(n<<15)>>10^n+~(n<<15))*9|0;o=(o>>6^o)+~((o>>6^o)<<11)>>16^(o>>6^o)+~((o>>6^o)<<11);u=o&u;a:do if(u>>>0<t>>>0?(h=c[p+(u<<2)>>2]|0,(h|0)!=-1):0){u=c[j+72>>2]|0;v=h;while(1){if((n|0)==(c[u+(v<<3)>>2]|0))break;v=c[s+(v<<2)>>2]|0;if((v|0)==-1){f=15;break a}}if(!((v|0)!=-1?((c[j+52>>2]|0)+(v<<2)|0)!=0:0))f=15}else f=15;while(0);if((f|0)==15){f=0;r=o&q+ -1;b:do if(r>>>0<t>>>0?(g=c[p+(r<<2)>>2]|0,(g|0)!=-1):0){t=c[j+72>>2]|0;u=g;while(1){if((n|0)==(c[t+(u<<3)>>2]|0))break;u=c[s+(u<<2)>>2]|0;if((u|0)==-1){f=22;break b}}if((u|0)!=-1)c[(c[j+52>>2]|0)+(u<<2)>>2]=n;else f=22}else f=22;while(0);if((f|0)==22){f=0;p=c[j+44>>2]|0;if((p|0)==(q|0)){s=(q|0)==0?1:q<<1;if((q|0)<(s|0)){if((s|0)!=0?(c[5004]=(c[5004]|0)+1,l=fF((s<<2|3)+16|0)|0,(l|0)!=0):0){c[(l+19&-16)+ -4>>2]=l;t=l+19&-16}else t=0;if((q|0)>0){u=0;do{v=t+(u<<2)|0;if(v)c[v>>2]=c[(c[j+52>>2]|0)+(u<<2)>>2];u=u+1|0}while((u|0)!=(q|0))}u=c[j+52>>2]|0;if(u){if(a[j+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[u+ -4>>2]|0)}c[j+52>>2]=0}a[j+56>>0]=1;c[j+52>>2]=t;c[j+48>>2]=s;s=q}else s=q}else s=p;t=(c[j+52>>2]|0)+(s<<2)|0;if(t)c[t>>2]=n;c[j+44>>2]=s+1;t=c[j+64>>2]|0;if((t|0)==(c[j+68>>2]|0)?(k=(t|0)==0?1:t<<1,(t|0)<(k|0)):0){if((k|0)!=0?(c[5004]=(c[5004]|0)+1,e=fF((k<<3|3)+16|0)|0,(e|0)!=0):0){c[(e+19&-16)+ -4>>2]=e;s=e+19&-16}else s=0;if((t|0)>0){v=0;do{u=s+(v<<3)|0;if(u){x=(c[j+72>>2]|0)+(v<<3)|0;w=c[x+4>>2]|0;c[u>>2]=c[x>>2];c[u+4>>2]=w}v=v+1|0}while((v|0)!=(t|0))}t=c[j+72>>2]|0;if(t){if(a[j+76>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[t+ -4>>2]|0)}c[j+72>>2]=0}a[j+76>>0]=1;c[j+72>>2]=s;c[j+68>>2]=k;t=c[j+64>>2]|0}s=(c[j+72>>2]|0)+(t<<3)|0;if(s){c[s>>2]=n;c[s+4>>2]=0}c[j+64>>2]=t+1;s=c[j+48>>2]|0;if((q|0)<(s|0)){q=c[j+4>>2]|0;do if((q|0)<(s|0)){if((q|0)<=(s|0)){if((c[j+8>>2]|0)<(s|0)){do if(!s)r=0;else{c[5004]=(c[5004]|0)+1;r=fF((s<<2|3)+16|0)|0;if(!r){r=0;break}c[(r+19&-16)+ -4>>2]=r;r=r+19&-16}while(0);v=c[j+12>>2]|0;if((q|0)>0){u=0;do{t=r+(u<<2)|0;if(t)c[t>>2]=c[v+(u<<2)>>2];u=u+1|0}while((u|0)!=(q|0))}if(v){if(a[j+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[v+ -4>>2]|0)}c[j+12>>2]=0}a[j+16>>0]=1;c[j+12>>2]=r;c[j+8>>2]=s}else r=c[j+12>>2]|0;t=q;do{u=r+(t<<2)|0;if(u)c[u>>2]=0;t=t+1|0}while((t|0)!=(s|0))}c[j+4>>2]=s;r=c[j+24>>2]|0;if((r|0)<(s|0)){if((c[j+28>>2]|0)<(s|0)){do if(!s)t=0;else{c[5004]=(c[5004]|0)+1;t=fF((s<<2|3)+16|0)|0;if(!t){t=0;break}c[(t+19&-16)+ -4>>2]=t;t=t+19&-16}while(0);v=c[j+32>>2]|0;if((r|0)>0){w=0;do{u=t+(w<<2)|0;if(u)c[u>>2]=c[v+(w<<2)>>2];w=w+1|0}while((w|0)!=(r|0))}if(v){if(a[j+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[v+ -4>>2]|0)}c[j+32>>2]=0}a[j+36>>0]=1;c[j+32>>2]=t;c[j+28>>2]=s}else t=c[j+32>>2]|0;do{u=t+(r<<2)|0;if(u)c[u>>2]=0;r=r+1|0}while((r|0)!=(s|0))}c[j+24>>2]=s;if((s|0)>0){jF(c[j+12>>2]|0,-1,s<<2|0)|0;jF(c[j+32>>2]|0,-1,s<<2|0)|0}if((q|0)<=0){s=c[j+48>>2]|0;break}t=c[j+72>>2]|0;r=c[j+12>>2]|0;v=c[j+32>>2]|0;s=c[j+48>>2]|0;u=0;do{x=c[t+(u<<3)>>2]|0;x=(x+~(x<<15)>>10^x+~(x<<15))*9|0;x=r+((((x>>6^x)+~((x>>6^x)<<11)>>16^(x>>6^x)+~((x>>6^x)<<11))&s+ -1)<<2)|0;c[v+(u<<2)>>2]=c[x>>2];c[x>>2]=u;u=u+1|0}while((u|0)!=(q|0))}while(0);q=s;r=o&s+ -1}else q=s;x=c[j+12>>2]|0;w=x+(r<<2)|0;s=c[j+32>>2]|0;c[s+(p<<2)>>2]=c[w>>2];c[w>>2]=p;p=x}Nb[c[(c[n>>2]|0)+60>>2]&127](n,d);r=c[b+8>>2]|0}m=m+1|0;if((m|0)>=(r|0))break;u=q+ -1|0;t=c[j+4>>2]|0}Xu(j);i=j;return}function Wu(a,b){a=a|0;b=b|0;var d=0;d=i;Lb[c[(c[b>>2]|0)+32>>2]&511](b);Vu(a,b);Lb[c[(c[b>>2]|0)+36>>2]&511](b);i=d;return}function Xu(b){b=b|0;var d=0,e=0;d=i;e=c[b+72>>2]|0;if(e){if(a[b+76>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+72>>2]=0}a[b+76>>0]=1;c[b+72>>2]=0;c[b+64>>2]=0;c[b+68>>2]=0;e=c[b+52>>2]|0;if(e){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;e=c[b+12>>2]|0;if(!e){a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;e=b+8|0;c[e>>2]=0;i=d;return}if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+12>>2]=0;a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;e=b+8|0;c[e>>2]=0;i=d;return}function Yu(a){a=a|0;return}function Zu(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function _u(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0,G=0.0,H=0.0;d=i;i=i+96|0;p=+g[b>>2];j=+g[a+28>>2];q=+g[b+4>>2];l=+g[a+32>>2];r=+g[b+8>>2];n=+g[a+36>>2];s=+g[a+44>>2];t=+g[a+48>>2];f=+g[a+52>>2];v=+g[a+60>>2];w=+g[a+64>>2];x=+g[a+68>>2];o=+g[a+76>>2];u=+g[a+80>>2];y=+g[a+84>>2];g[d+80>>2]=p*j+q*l+r*n+o;g[d+84>>2]=p*s+q*t+r*f+u;g[d+88>>2]=p*v+q*w+r*x+y;g[d+92>>2]=0.0;h=+g[b+16>>2];k=+g[b+20>>2];m=+g[b+24>>2];g[d+64>>2]=h*j+k*l+m*n+o;g[d+68>>2]=h*s+k*t+m*f+u;g[d+72>>2]=h*v+k*w+m*x+y;g[d+76>>2]=0.0;z=+g[b+32>>2];A=+g[b+36>>2];B=+g[b+40>>2];g[d+48>>2]=z*j+A*l+B*n+o;g[d+52>>2]=z*s+A*t+B*f+u;g[d+56>>2]=z*v+A*w+B*x+y;g[d+60>>2]=0.0;C=(p*j+q*l+r*n+o+(h*j+k*l+m*n+o)+(z*j+A*l+B*n+o))*.3333333432674408;D=(p*s+q*t+r*f+u+(h*s+k*t+m*f+u)+(z*s+A*t+B*f+u))*.3333333432674408;E=(p*v+q*w+r*x+y+(h*v+k*w+m*x+y)+(z*v+A*w+B*x+y))*.3333333432674408;g[d+32>>2]=C;g[d+36>>2]=D;g[d+40>>2]=E;g[d+44>>2]=0.0;e=c[a+8>>2]|0;if(!((Pb[c[(c[e>>2]|0)+48>>2]&127](e)|0)&16384)){b=c[a+8>>2]|0;F=c[b>>2]|0;F=F+8|0;F=c[F>>2]|0;e=a+12|0;vc[F&127](b,d+80|0,d+64|0,e);b=c[a+8>>2]|0;F=c[b>>2]|0;F=F+8|0;F=c[F>>2]|0;vc[F&127](b,d+64|0,d+48|0,e);b=c[a+8>>2]|0;a=c[b>>2]|0;a=a+8|0;a=c[a>>2]|0;vc[a&127](b,d+48|0,d+80|0,e);i=d;return}H=h*j+k*l+m*n+o-(p*j+q*l+r*n+o);G=h*s+k*t+m*f+u-(p*s+q*t+r*f+u);m=h*v+k*w+m*x+y-(p*v+q*w+r*x+y);o=z*j+A*l+B*n+o-(p*j+q*l+r*n+o);u=z*s+A*t+B*f+u-(p*s+q*t+r*f+u);A=z*v+A*w+B*x+y-(p*v+q*w+r*x+y);B=1.0/+Q(+((H*u-G*o)*(H*u-G*o)+((G*A-m*u)*(G*A-m*u)+(m*o-H*A)*(m*o-H*A))));g[d+16>>2]=1.0;g[d+20>>2]=1.0;g[d+24>>2]=0.0;g[d+28>>2]=0.0;e=c[a+8>>2]|0;b=c[(c[e>>2]|0)+8>>2]|0;g[d>>2]=B*(G*A-m*u)+C;g[d+4>>2]=B*(m*o-H*A)+D;g[d+8>>2]=B*(H*u-G*o)+E;g[d+12>>2]=0.0;vc[b&127](e,d+32|0,d,d+16|0);e=c[a+8>>2]|0;b=c[e>>2]|0;b=b+8|0;b=c[b>>2]|0;F=a+12|0;vc[b&127](e,d+80|0,d+64|0,F);e=c[a+8>>2]|0;b=c[e>>2]|0;b=b+8|0;b=c[b>>2]|0;vc[b&127](e,d+64|0,d+48|0,F);e=c[a+8>>2]|0;b=c[e>>2]|0;b=b+8|0;b=c[b>>2]|0;vc[b&127](e,d+48|0,d+80|0,F);i=d;return}function $u(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+8>>2]&127](a,b,d,e);i=f;return}function av(a){a=a|0;var b=0;b=i;gF(a+ -4|0);i=b;return}function bv(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a+ -4>>2]|0)+8>>2]&127](a+ -4|0,b,d,e);i=f;return}function cv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function dv(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0,j=0,k=0.0,l=0.0,m=0.0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0,x=0.0,y=0,z=0,A=0;n=i;i=i+192|0;h=c[(c[b+4>>2]|0)+740>>2]|0;j=c[(c[b+8>>2]|0)+8>>2]|0;q=+g[e>>2];k=+g[d>>2]*f+q;o=+g[e+4>>2];l=+g[d+4>>2]*f+o;p=+g[e+8>>2];m=+g[d+8>>2]*f+p;if((h|0)!=(j|0)){w=c[(c[b+12>>2]|0)+8>>2]|0;x=k- +g[w+52>>2];s=l- +g[w+56>>2];t=m- +g[w+60>>2];v=q- +g[j+52>>2];u=o- +g[j+56>>2];r=p- +g[j+60>>2];q=x*+g[w+4>>2]+s*+g[w+20>>2]+t*+g[w+36>>2];o=x*+g[w+8>>2]+s*+g[w+24>>2]+t*+g[w+40>>2];p=x*+g[w+12>>2]+s*+g[w+28>>2]+t*+g[w+44>>2];t=v*+g[j+4>>2]+u*+g[j+20>>2]+r*+g[j+36>>2];s=v*+g[j+8>>2]+u*+g[j+24>>2]+r*+g[j+40>>2];r=v*+g[j+12>>2]+u*+g[j+28>>2]+r*+g[j+44>>2]}else{u=k- +g[h+52>>2];s=l- +g[h+56>>2];t=m- +g[h+60>>2];w=c[(c[b+12>>2]|0)+8>>2]|0;v=q- +g[w+52>>2];x=o- +g[w+56>>2];r=p- +g[w+60>>2];q=u*+g[h+4>>2]+s*+g[h+20>>2]+t*+g[h+36>>2];o=u*+g[h+8>>2]+s*+g[h+24>>2]+t*+g[h+40>>2];p=u*+g[h+12>>2]+s*+g[h+28>>2]+t*+g[h+44>>2];t=v*+g[w+4>>2]+x*+g[w+20>>2]+r*+g[w+36>>2];s=v*+g[w+8>>2]+x*+g[w+24>>2]+r*+g[w+40>>2];r=v*+g[w+12>>2]+x*+g[w+28>>2]+r*+g[w+44>>2]}g[n>>2]=q;g[n+4>>2]=o;g[n+8>>2]=p;g[n+12>>2]=0.0;g[n+16>>2]=t;g[n+20>>2]=s;g[n+24>>2]=r;g[n+28>>2]=0.0;c[n+64>>2]=c[d+0>>2];c[n+68>>2]=c[d+4>>2];c[n+72>>2]=c[d+8>>2];c[n+76>>2]=c[d+12>>2];g[n+80>>2]=f;g[n+84>>2]=0.0;g[n+88>>2]=0.0;g[n+92>>2]=0.0;c[n+112>>2]=0;a[n+116>>0]=0;c[n+120>>2]=0;c[n+124>>2]=0;c[n+128>>2]=0;c[n+132>>2]=0;c[n+136>>2]=0;c[n+140>>2]=0;c[n+144>>2]=0;c[n+148>>2]=0;g[n+48>>2]=k;g[n+52>>2]=l;g[n+56>>2]=m;g[n+60>>2]=0.0;c[n+32>>2]=c[e+0>>2];c[n+36>>2]=c[e+4>>2];c[n+40>>2]=c[e+8>>2];c[n+44>>2]=c[e+12>>2];if((h|0)!=(j|0)){z=c[b+20>>2]|0;c[n+96>>2]=z;e=c[b+16>>2]|0;c[n+100>>2]=e;y=c[b+28>>2]|0;c[n+104>>2]=y;w=c[b+24>>2]|0;c[n+108>>2]=w;d=b+12|0;A=(h|0)!=(j|0)?d:b+8|0;A=c[A>>2]|0;d=(h|0)!=(j|0)?b+8|0:d;d=c[d>>2]|0;j=b+32|0;j=c[j>>2]|0;h=c[j>>2]|0;h=h+12|0;h=c[h>>2]|0;+Vb[h&1](j,n,A,z,y,d,e,w);i=n;return}else{e=c[b+16>>2]|0;c[n+96>>2]=e;z=c[b+20>>2]|0;c[n+100>>2]=z;w=c[b+24>>2]|0;c[n+104>>2]=w;A=c[b+28>>2]|0;c[n+108>>2]=A;y=b+12|0;d=(h|0)!=(j|0)?y:b+8|0;d=c[d>>2]|0;y=(h|0)!=(j|0)?b+8|0:y;y=c[y>>2]|0;j=b+32|0;j=c[j>>2]|0;h=c[j>>2]|0;h=h+12|0;h=c[h>>2]|0;+Vb[h&1](j,n,d,e,w,y,z,A);i=n;return}}function ev(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function fv(a,b){a=a|0;b=b|0;var d=0,e=0,f=0.0,h=0,j=0;d=i;i=i+32|0;e=c[a+184>>2]|0;if(+g[e+4>>2]==0.0){b=0;i=d;return b|0}b=c[b>>2]|0;if(!(gc[c[(c[e>>2]|0)+8>>2]&31](e,c[b+188>>2]|0)|0)){b=1;i=d;return b|0}h=c[a+192>>2]|0;j=c[b+192>>2]|0;e=c[a+184>>2]|0;f=+g[a+188>>2];c[d>>2]=0;c[d+4>>2]=j;c[d+8>>2]=b;c[d+12>>2]=b+4;c[d+16>>2]=-1;c[d+20>>2]=-1;Ku(h,a+36|0,a+100|0,d,e,f);b=1;i=d;return b|0}function gv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function hv(a,b){a=a|0;b=b|0;var d=0,e=0,f=0;d=i;i=i+32|0;e=c[a+216>>2]|0;if(+g[e+4>>2]==0.0){b=0;i=d;return b|0}b=c[b>>2]|0;if(!(gc[c[(c[e>>2]|0)+8>>2]&31](e,c[b+188>>2]|0)|0)){b=1;i=d;return b|0}f=c[b+192>>2]|0;e=c[a+216>>2]|0;c[d>>2]=0;c[d+4>>2]=f;c[d+8>>2]=b;c[d+12>>2]=b+4;c[d+16>>2]=-1;c[d+20>>2]=-1;Hu(a+68|0,a+132|0,d,e);b=1;i=d;return b|0}function iv(a){a=a|0;return}function jv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function kv(a,b){a=a|0;b=b|0;var d=0;d=i;a=c[a+12>>2]|0;a=gc[c[(c[a>>2]|0)+8>>2]&31](a,b)|0;i=d;return a|0}function lv(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0;e=i;i=i+16|0;c[e>>2]=-1;c[e+4>>2]=c[a+16>>2];if(!(c[b+4>>2]|0))c[b+4>>2]=e;h=c[a+12>>2]|0;f=+hc[c[(c[h>>2]|0)+12>>2]&15](h,b,d);g[a+4>>2]=+g[(c[a+12>>2]|0)+4>>2];i=e;return+f}function mv(a){a=a|0;return}function nv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ov(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=+e;f=f|0;h=h|0;var j=0;j=i;i=i+64|0;c[j+48>>2]=f;c[j+52>>2]=h;h=c[a+212>>2]|0;if(!(+g[h+4>>2]>=e)){i=j;return+e}c[j>>2]=c[a+216>>2];c[j+4>>2]=j+48;c[j+8>>2]=c[b+0>>2];c[j+12>>2]=c[b+4>>2];c[j+16>>2]=c[b+8>>2];c[j+20>>2]=c[b+12>>2];c[j+24>>2]=c[d+0>>2];c[j+28>>2]=c[d+4>>2];c[j+32>>2]=c[d+8>>2];c[j+36>>2]=c[d+12>>2];g[j+40>>2]=e;e=+hc[c[(c[h>>2]|0)+12>>2]&15](h,j,0);i=j;return+e}function pv(a){a=a|0;return}function qv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function rv(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=+e;f=f|0;h=h|0;var j=0;j=i;i=i+64|0;c[j+48>>2]=f;c[j+52>>2]=h;h=c[a+212>>2]|0;if(!(+g[h+4>>2]>=e)){i=j;return+e}c[j>>2]=c[a+216>>2];c[j+4>>2]=j+48;c[j+8>>2]=c[b+0>>2];c[j+12>>2]=c[b+4>>2];c[j+16>>2]=c[b+8>>2];c[j+20>>2]=c[b+12>>2];c[j+24>>2]=c[d+0>>2];c[j+28>>2]=c[d+4>>2];c[j+32>>2]=c[d+8>>2];c[j+36>>2]=c[d+12>>2];g[j+40>>2]=e;e=+hc[c[(c[h>>2]|0)+12>>2]&15](h,j,1);i=j;return+e}function sv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function tv(a){a=a|0;return}function uv(a){a=a|0;return}function vv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function wv(a,b){a=a|0;b=b|0;var d=0;d=i;a=c[a+20>>2]|0;a=gc[c[(c[a>>2]|0)+8>>2]&31](a,b)|0;i=d;return a|0}function xv(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0;e=i;i=i+16|0;c[e>>2]=-1;c[e+4>>2]=c[a+24>>2];if(!(c[b+4>>2]|0))c[b+4>>2]=e;h=c[a+20>>2]|0;f=+hc[c[(c[h>>2]|0)+12>>2]&15](h,b,d);g[a+4>>2]=+g[(c[a+20>>2]|0)+4>>2];i=e;return+f}function yv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function zv(a,b,c){a=a|0;b=b|0;c=c|0;return}function Av(a,d){a=a|0;d=d|0;var e=0,f=0,h=0;e=i;i=i+128|0;f=c[d+36>>2]|0;d=c[(c[a+8>>2]|0)+24>>2]|0;h=c[d+(f*80|0)+64>>2]|0;no(e+56|0,c[a+12>>2]|0,d+(f*80|0)|0);d=c[a+4>>2]|0;c[e+32>>2]=0;c[e+36>>2]=h;c[e+40>>2]=d;c[e+44>>2]=e+56;c[e+48>>2]=-1;c[e+52>>2]=f;d=c[a+24>>2]|0;g[e+4>>2]=1.0;c[e+8>>2]=0;b[e+12>>1]=1;b[e+14>>1]=-1;c[e+16>>2]=0;c[e>>2]=8664;c[e+20>>2]=d;c[e+24>>2]=f;g[e+4>>2]=+g[d+4>>2];c[e+16>>2]=c[d+16>>2];Hu(c[a+16>>2]|0,c[a+20>>2]|0,e+32|0,e);i=e;return}function Bv(a,b,d){a=a|0;b=b|0;d=+d;var e=0;e=i;Nb[c[(c[a>>2]|0)+12>>2]&127](a,b);i=e;return}function Cv(a,b){a=a|0;b=b|0;return 1}function Dv(a,b){a=a|0;b=b|0;return 1}function Ev(a){a=a|0;return}function Fv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Gv(a,b,d,e,f){a=a|0;b=b|0;d=+d;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;h=i;i=i+48|0;c[h+32>>2]=e;c[h+36>>2]=f;n=+g[b>>2];m=+g[b+4>>2];j=+g[b+8>>2];l=+g[a+56>>2]*n+ +g[a+60>>2]*m+ +g[a+64>>2]*j;k=n*+g[a+72>>2]+m*+g[a+76>>2]+j*+g[a+80>>2];j=n*+g[a+88>>2]+m*+g[a+92>>2]+j*+g[a+96>>2];c[h>>2]=c[a+48>>2];c[h+4>>2]=h+32;g[h+8>>2]=l;g[h+12>>2]=k;g[h+16>>2]=j;g[h+20>>2]=0.0;g[h+24>>2]=d;e=c[a+44>>2]|0;d=+hc[c[(c[e>>2]|0)+12>>2]&15](e,h,1);i=h;return+d}function Hv(a){a=a|0;return}function Iv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Jv(a,b,d,e,f){a=a|0;b=b|0;d=+d;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;h=i;i=i+48|0;c[h+32>>2]=e;c[h+36>>2]=f;n=+g[b>>2];m=+g[b+4>>2];j=+g[b+8>>2];l=+g[a+56>>2]*n+ +g[a+60>>2]*m+ +g[a+64>>2]*j;k=n*+g[a+72>>2]+m*+g[a+76>>2]+j*+g[a+80>>2];j=n*+g[a+88>>2]+m*+g[a+92>>2]+j*+g[a+96>>2];c[h>>2]=c[a+48>>2];c[h+4>>2]=h+32;g[h+8>>2]=l;g[h+12>>2]=k;g[h+16>>2]=j;g[h+20>>2]=0.0;g[h+24>>2]=d;e=c[a+44>>2]|0;d=+hc[c[(c[e>>2]|0)+12>>2]&15](e,h,1);i=h;return+d}function Kv(a,b){a=a|0;b=+b;return}function Lv(a,b){a=a|0;b=b|0;return}function Mv(a,b,c){a=a|0;b=b|0;c=c|0;return}function Nv(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Ov(b,d){b=b|0;d=d|0;var e=0,f=0;e=i;c[b+8>>2]=0;c[b>>2]=9512;a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;c[b+20>>2]=0;g[b+32>>2]=999999984306749400.0;g[b+36>>2]=999999984306749400.0;g[b+40>>2]=999999984306749400.0;g[b+44>>2]=0.0;g[b+48>>2]=-999999984306749400.0;g[b+52>>2]=-999999984306749400.0;g[b+56>>2]=-999999984306749400.0;g[b+60>>2]=0.0;c[b+64>>2]=0;c[b+68>>2]=1;g[b+72>>2]=0.0;g[b+76>>2]=1.0;g[b+80>>2]=1.0;g[b+84>>2]=1.0;g[b+88>>2]=0.0;c[b+4>>2]=31;if(!d){i=e;return}c[5004]=(c[5004]|0)+1;d=fF(79)|0;if((d|0)!=0?(f=d+19&-16,c[f+ -4>>2]=d,(d+19&-16|0)!=0):0){a[f+36>>0]=1;c[f+32>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;a[f+56>>0]=1;c[f+52>>2]=0;c[f+44>>2]=0;c[f+48>>2]=0;c[(d+19&-16)>>2]=0;c[f+4>>2]=0;c[f+8>>2]=-1;c[f+12>>2]=0;c[f+16>>2]=0;f=d+19&-16}else f=0;c[b+64>>2]=f;i=e;return}function Pv(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=9512;e=c[b+64>>2]|0;if((e|0)!=0?(Ux(e),f=c[b+64>>2]|0,(f|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}e=c[b+24>>2]|0;if(e){if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+24>>2]=0}a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;c[b+20>>2]=0;if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function Qv(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=9512;e=c[b+64>>2]|0;if((e|0)!=0?(Ux(e),f=c[b+64>>2]|0,(f|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}e=c[b+24>>2]|0;if(!e){a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;f=b+20|0;c[f>>2]=0;i=d;return}if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+24>>2]=0;a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;f=b+20|0;c[f>>2]=0;i=d;return}function Rv(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;d=i;i=i+80|0;c[a+68>>2]=(c[a+68>>2]|0)+1;e=c[a+16>>2]|0;if((e|0)<=0){h=c[a>>2]|0;h=h+68|0;h=c[h>>2]|0;Lb[h&511](a);i=d;return}h=e;do{e=e+ -1|0;g=c[a+24>>2]|0;if((c[g+(e*80|0)+64>>2]|0)==(b|0)){c[a+68>>2]=(c[a+68>>2]|0)+1;f=c[a+64>>2]|0;if(f){g=c[g+(e*80|0)+76>>2]|0;Yx(f,g)|0;h=c[f+4>>2]|0;if(h){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[f+4>>2]=g;c[f+12>>2]=(c[f+12>>2]|0)+ -1;h=c[a+16>>2]|0;g=c[a+24>>2]|0}h=h+ -1|0;m=g+(e*80|0)|0;c[d+0>>2]=c[m+0>>2];c[d+4>>2]=c[m+4>>2];c[d+8>>2]=c[m+8>>2];c[d+12>>2]=c[m+12>>2];l=g+(e*80|0)+16|0;c[d+16>>2]=c[l+0>>2];c[d+20>>2]=c[l+4>>2];c[d+24>>2]=c[l+8>>2];c[d+28>>2]=c[l+12>>2];k=g+(e*80|0)+32|0;c[d+32>>2]=c[k+0>>2];c[d+36>>2]=c[k+4>>2];c[d+40>>2]=c[k+8>>2];c[d+44>>2]=c[k+12>>2];j=g+(e*80|0)+48|0;c[d+48>>2]=c[j+0>>2];c[d+52>>2]=c[j+4>>2];c[d+56>>2]=c[j+8>>2];c[d+60>>2]=c[j+12>>2];f=g+(e*80|0)+64|0;c[d+64>>2]=c[f+0>>2];c[d+68>>2]=c[f+4>>2];c[d+72>>2]=c[f+8>>2];c[d+76>>2]=c[f+12>>2];n=g+(h*80|0)|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2];c[m+12>>2]=c[n+12>>2];m=g+(h*80|0)+16|0;c[l+0>>2]=c[m+0>>2];c[l+4>>2]=c[m+4>>2];c[l+8>>2]=c[m+8>>2];c[l+12>>2]=c[m+12>>2];l=g+(h*80|0)+32|0;c[k+0>>2]=c[l+0>>2];c[k+4>>2]=c[l+4>>2];c[k+8>>2]=c[l+8>>2];c[k+12>>2]=c[l+12>>2];k=g+(h*80|0)+48|0;c[j+0>>2]=c[k+0>>2];c[j+4>>2]=c[k+4>>2];c[j+8>>2]=c[k+8>>2];c[j+12>>2]=c[k+12>>2];g=g+(h*80|0)+64|0;c[f+0>>2]=c[g+0>>2];c[f+4>>2]=c[g+4>>2];c[f+8>>2]=c[g+8>>2];c[f+12>>2]=c[g+12>>2];g=c[a+24>>2]|0;c[g+(h*80|0)+0>>2]=c[d+0>>2];c[g+(h*80|0)+4>>2]=c[d+4>>2];c[g+(h*80|0)+8>>2]=c[d+8>>2];c[g+(h*80|0)+12>>2]=c[d+12>>2];c[g+(h*80|0)+16>>2]=c[d+16>>2];c[g+(h*80|0)+20>>2]=c[d+20>>2];c[g+(h*80|0)+24>>2]=c[d+24>>2];c[g+(h*80|0)+28>>2]=c[d+28>>2];c[g+(h*80|0)+32>>2]=c[d+32>>2];c[g+(h*80|0)+36>>2]=c[d+36>>2];c[g+(h*80|0)+40>>2]=c[d+40>>2];c[g+(h*80|0)+44>>2]=c[d+44>>2];c[g+(h*80|0)+48>>2]=c[d+48>>2];c[g+(h*80|0)+52>>2]=c[d+52>>2];c[g+(h*80|0)+56>>2]=c[d+56>>2];c[g+(h*80|0)+60>>2]=c[d+60>>2];c[g+(h*80|0)+64>>2]=c[d+64>>2];c[g+(h*80|0)+68>>2]=c[d+68>>2];c[g+(h*80|0)+72>>2]=c[d+72>>2];c[g+(h*80|0)+76>>2]=c[d+76>>2];if(c[a+64>>2]|0)c[(c[(c[a+24>>2]|0)+(e*80|0)+76>>2]|0)+36>>2]=e;h=(c[a+16>>2]|0)+ -1|0;c[a+16>>2]=h}}while((e|0)>0);n=c[a>>2]|0;n=n+68|0;n=c[n>>2]|0;Lb[n&511](a);i=d;return}function Sv(a){a=a|0;var b=0,d=0,e=0.0,f=0,h=0;b=i;i=i+32|0;g[a+32>>2]=999999984306749400.0;g[a+36>>2]=999999984306749400.0;g[a+40>>2]=999999984306749400.0;g[a+44>>2]=0.0;g[a+48>>2]=-999999984306749400.0;g[a+52>>2]=-999999984306749400.0;g[a+56>>2]=-999999984306749400.0;g[a+60>>2]=0.0;if((c[a+16>>2]|0)<=0){i=b;return}d=0;do{f=c[a+24>>2]|0;h=c[f+(d*80|0)+64>>2]|0;vc[c[(c[h>>2]|0)+8>>2]&127](h,f+(d*80|0)|0,b+16|0,b);e=+g[b+16>>2];if(+g[a+32>>2]>e)g[a+32>>2]=e;e=+g[b>>2];if(+g[a+48>>2]<e)g[a+48>>2]=e;e=+g[b+20>>2];if(+g[a+36>>2]>e)g[a+36>>2]=e;e=+g[b+4>>2];if(+g[a+52>>2]<e)g[a+52>>2]=e;e=+g[b+24>>2];if(+g[a+40>>2]>e)g[a+40>>2]=e;e=+g[b+8>>2];if(+g[a+56>>2]<e)g[a+56>>2]=e;d=d+1|0}while((d|0)<(c[a+16>>2]|0));i=b;return}function Tv(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0;f=i;t=+g[a+48>>2];v=+g[a+32>>2];E=+g[a+52>>2];w=+g[a+36>>2];F=+g[a+56>>2];k=+g[a+40>>2];G=(c[a+16>>2]|0)==0;x=G?0.0:(F+k)*.5;z=G?0.0:(E+w)*.5;B=G?0.0:(t+v)*.5;o=+$b[c[(c[a>>2]|0)+48>>2]&15](a);m=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=(G?0.0:(t-v)*.5)+o;m=(G?0.0:(E-w)*.5)+m;k=(G?0.0:(F-k)*.5)+ +$b[c[(c[a>>2]|0)+48>>2]&15](a);F=+g[b>>2];w=+P(+F);E=+g[b+4>>2];v=+P(+E);t=+g[b+8>>2];u=+P(+t);D=+g[b+16>>2];s=+P(+D);C=+g[b+20>>2];r=+P(+C);p=+g[b+24>>2];q=+P(+p);A=+g[b+32>>2];n=+P(+A);y=+g[b+36>>2];l=+P(+y);h=+g[b+40>>2];j=+P(+h);t=B*F+z*E+x*t+ +g[b+48>>2];p=B*D+z*C+x*p+ +g[b+52>>2];h=B*A+z*y+x*h+ +g[b+56>>2];g[d>>2]=t-(o*w+m*v+k*u);g[d+4>>2]=p-(o*s+m*r+k*q);g[d+8>>2]=h-(o*n+m*l+k*j);g[d+12>>2]=0.0;g[e>>2]=o*w+m*v+k*u+t;g[e+4>>2]=o*s+m*r+k*q+p;g[e+8>>2]=o*n+m*l+k*j+h;g[e+12>>2]=0.0;i=f;return}function Uv(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0;e=i;i=i+96|0;g[e+32>>2]=1.0;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=1.0;c[e+56>>2]=0;c[e+60>>2]=0;c[e+64>>2]=0;c[e+68>>2]=0;g[e+72>>2]=1.0;k=e+76|0;c[k+0>>2]=0;c[k+4>>2]=0;c[k+8>>2]=0;c[k+12>>2]=0;c[k+16>>2]=0;vc[c[(c[a>>2]|0)+8>>2]&127](a,e+32|0,e+16|0,e);h=(+g[e>>2]- +g[e+16>>2])*.5*2.0;f=(+g[e+4>>2]- +g[e+20>>2])*.5*2.0;j=(+g[e+8>>2]- +g[e+24>>2])*.5*2.0;g[d>>2]=b/12.0*(f*f+j*j);g[d+4>>2]=b/12.0*(h*h+j*j);g[d+8>>2]=b/12.0*(h*h+f*f);i=e;return}function Vv(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0.0,r=0.0;k=i;i=i+144|0;if((c[a+16>>2]|0)<=0){p=a+76|0;c[p+0>>2]=c[b+0>>2];c[p+4>>2]=c[b+4>>2];c[p+8>>2]=c[b+8>>2];c[p+12>>2]=c[b+12>>2];p=c[a>>2]|0;p=p+68|0;p=c[p>>2]|0;Lb[p&511](a);i=k;return}f=k+32|0;h=k+48|0;j=k+64|0;e=0;do{p=c[a+24>>2]|0;o=p+(e*80|0)|0;c[k+16>>2]=c[o+0>>2];c[k+20>>2]=c[o+4>>2];c[k+24>>2]=c[o+8>>2];c[k+28>>2]=c[o+12>>2];o=p+(e*80|0)+16|0;c[f+0>>2]=c[o+0>>2];c[f+4>>2]=c[o+4>>2];c[f+8>>2]=c[o+8>>2];c[f+12>>2]=c[o+12>>2];o=p+(e*80|0)+32|0;c[h+0>>2]=c[o+0>>2];c[h+4>>2]=c[o+4>>2];c[h+8>>2]=c[o+8>>2];c[h+12>>2]=c[o+12>>2];o=p+(e*80|0)+48|0;c[j+0>>2]=c[o+0>>2];c[j+4>>2]=c[o+4>>2];c[j+8>>2]=c[o+8>>2];c[j+12>>2]=c[o+12>>2];p=c[p+(e*80|0)+64>>2]|0;p=Pb[c[(c[p>>2]|0)+28>>2]&127](p)|0;c[k+0>>2]=c[p+0>>2];c[k+4>>2]=c[p+4>>2];c[k+8>>2]=c[p+8>>2];q=+g[k+4>>2]*+g[b+4>>2]/+g[a+80>>2];r=+g[k+8>>2]*+g[b+8>>2]/+g[a+84>>2];g[k>>2]=+g[k>>2]*+g[b>>2]/+g[a+76>>2];g[k+4>>2]=q;g[k+8>>2]=r;g[k+12>>2]=0.0;p=c[(c[a+24>>2]|0)+(e*80|0)+64>>2]|0;Nb[c[(c[p>>2]|0)+24>>2]&127](p,k);r=+g[k+68>>2]*+g[b+4>>2]/+g[a+80>>2];q=+g[k+72>>2]*+g[b+8>>2]/+g[a+84>>2];g[k+64>>2]=+g[j>>2]*+g[b>>2]/+g[a+76>>2];g[k+68>>2]=r;g[k+72>>2]=q;g[k+76>>2]=0.0;p=c[a+24>>2]|0;o=p+(e*80|0)|0;c[o+0>>2]=c[k+16>>2];c[o+4>>2]=c[k+20>>2];c[o+8>>2]=c[k+24>>2];c[o+12>>2]=c[k+28>>2];o=p+(e*80|0)+16|0;c[o+0>>2]=c[f+0>>2];c[o+4>>2]=c[f+4>>2];c[o+8>>2]=c[f+8>>2];c[o+12>>2]=c[f+12>>2];o=p+(e*80|0)+32|0;c[o+0>>2]=c[h+0>>2];c[o+4>>2]=c[h+4>>2];c[o+8>>2]=c[h+8>>2];c[o+12>>2]=c[h+12>>2];p=p+(e*80|0)+48|0;c[p+0>>2]=c[j+0>>2];c[p+4>>2]=c[j+4>>2];c[p+8>>2]=c[j+8>>2];c[p+12>>2]=c[j+12>>2];if(c[a+64>>2]|0){l=c[(c[a+24>>2]|0)+(e*80|0)+64>>2]|0;vc[c[(c[l>>2]|0)+8>>2]&127](l,k+16|0,k+128|0,k+112|0);c[k+80>>2]=c[k+128>>2];c[k+84>>2]=c[k+132>>2];c[k+88>>2]=c[k+136>>2];c[k+92>>2]=c[k+140>>2];c[k+96>>2]=c[k+112>>2];c[k+100>>2]=c[k+116>>2];c[k+104>>2]=c[k+120>>2];c[k+108>>2]=c[k+124>>2];l=c[a+64>>2]|0;d=c[(c[a+24>>2]|0)+(e*80|0)+76>>2]|0;o=Yx(l,d)|0;a:do if(o){m=c[l+8>>2]|0;if((m|0)<=-1){o=c[l>>2]|0;break}if((m|0)>0){n=0;while(1){p=c[o+32>>2]|0;n=n+1|0;if(!p)break a;if((n|0)>=(m|0)){o=p;break}else o=p}}}else o=0;while(0);c[d+0>>2]=c[k+80>>2];c[d+4>>2]=c[k+84>>2];c[d+8>>2]=c[k+88>>2];c[d+12>>2]=c[k+92>>2];c[d+16>>2]=c[k+96>>2];c[d+20>>2]=c[k+100>>2];c[d+24>>2]=c[k+104>>2];c[d+28>>2]=c[k+108>>2];Xx(l,o,d)}e=e+1|0}while((e|0)<(c[a+16>>2]|0));p=a+76|0;c[p+0>>2]=c[b+0>>2];c[p+4>>2]=c[b+4>>2];c[p+8>>2]=c[b+8>>2];c[p+12>>2]=c[b+12>>2];p=c[a>>2]|0;p=p+68|0;p=c[p>>2]|0;Lb[p&511](a);i=k;return}function Wv(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;k=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=k;if(k)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+20>>2]=+g[a+72>>2];f=c[a+16>>2]|0;c[b+16>>2]=f;c[b+12>>2]=0;if(!f){i=e;return 9616}f=Yb[c[(c[d>>2]|0)+16>>2]&31](d,76,f)|0;k=c[f+8>>2]|0;c[b+12>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,k)|0;if((c[b+16>>2]|0)>0){j=c[a+24>>2]|0;h=0;while(1){g[k+72>>2]=+g[j+(h*80|0)+72>>2];c[k+64>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,c[j+(h*80|0)+64>>2]|0)|0;if(!(gc[c[(c[d>>2]|0)+24>>2]&31](d,c[(c[a+24>>2]|0)+(h*80|0)+64>>2]|0)|0)){j=c[(c[d>>2]|0)+16>>2]|0;l=c[(c[a+24>>2]|0)+(h*80|0)+64>>2]|0;l=Pb[c[(c[l>>2]|0)+52>>2]&127](l)|0;l=Yb[j&31](d,l,1)|0;j=c[(c[a+24>>2]|0)+(h*80|0)+64>>2]|0;j=Yb[c[(c[j>>2]|0)+56>>2]&31](j,c[l+8>>2]|0,d)|0;Jb[c[(c[d>>2]|0)+20>>2]&31](d,l,j,1346455635,c[(c[a+24>>2]|0)+(h*80|0)+64>>2]|0)}j=c[a+24>>2]|0;c[k+68>>2]=c[j+(h*80|0)+68>>2];g[k>>2]=+g[j+(h*80|0)>>2];g[k+4>>2]=+g[j+(h*80|0)+4>>2];g[k+8>>2]=+g[j+(h*80|0)+8>>2];g[k+12>>2]=+g[j+(h*80|0)+12>>2];g[k+16>>2]=+g[j+(h*80|0)+16>>2];g[k+20>>2]=+g[j+(h*80|0)+20>>2];g[k+24>>2]=+g[j+(h*80|0)+24>>2];g[k+28>>2]=+g[j+(h*80|0)+28>>2];g[k+32>>2]=+g[j+(h*80|0)+32>>2];g[k+36>>2]=+g[j+(h*80|0)+36>>2];g[k+40>>2]=+g[j+(h*80|0)+40>>2];g[k+44>>2]=+g[j+(h*80|0)+44>>2];g[k+48>>2]=+g[j+(h*80|0)+48>>2];g[k+52>>2]=+g[j+(h*80|0)+52>>2];g[k+56>>2]=+g[j+(h*80|0)+56>>2];g[k+60>>2]=+g[j+(h*80|0)+60>>2];h=h+1|0;if((h|0)>=(c[b+16>>2]|0)){b=d;break}else k=k+76|0}}else b=d;Jb[c[(c[b>>2]|0)+20>>2]&31](d,f,9584,1497453121,c[f+8>>2]|0);i=e;return 9616}function Xv(a){a=a|0;return a+76|0}function Yv(a){a=a|0;return 9680}function Zv(a,b){a=a|0;b=+b;g[a+72>>2]=b;return}function _v(a){a=a|0;return+(+g[a+72>>2])}function $v(a){a=a|0;return 24}function aw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0,j=0,k=0.0,l=0,m=0.0,n=0.0;j=i;i=i+48|0;f=+g[b+60>>2]*.5;e=c[b+68>>2]|0;k=+g[d>>2];m=+g[d+4>>2];n=+g[d+8>>2];n=+Q(+(k*k+m*m+n*n));h=c[b+64>>2]|0;if(+g[d+(e<<2)>>2]>n*+g[b+52>>2]){g[j+32+(h<<2)>>2]=0.0;g[j+32+(e<<2)>>2]=f;g[j+32+(c[b+72>>2]<<2)>>2]=0.0;c[a+0>>2]=c[j+32>>2];c[a+4>>2]=c[j+36>>2];c[a+8>>2]=c[j+40>>2];c[a+12>>2]=c[j+44>>2];i=j;return}k=+g[d+(h<<2)>>2];l=c[b+72>>2]|0;m=+g[d+(l<<2)>>2];n=+Q(+(k*k+m*m));if(n>1.1920928955078125e-7){n=+g[b+56>>2]/n;g[j+16+(h<<2)>>2]=k*n;g[j+16+(e<<2)>>2]=-f;g[j+16+(l<<2)>>2]=n*m;c[a+0>>2]=c[j+16>>2];c[a+4>>2]=c[j+20>>2];c[a+8>>2]=c[j+24>>2];c[a+12>>2]=c[j+28>>2];i=j;return}else{g[j+(h<<2)>>2]=0.0;g[j+(e<<2)>>2]=-f;g[j+(l<<2)>>2]=0.0;c[a+0>>2]=c[j+0>>2];c[a+4>>2]=c[j+4>>2];c[a+8>>2]=c[j+8>>2];c[a+12>>2]=c[j+12>>2];i=j;return}}function bw(a,b,c){a=a|0;b=b|0;c=c|0;var d=0;d=i;aw(a,b,c);i=d;return}function cw(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0;f=i;i=i+16|0;if((e|0)<=0){i=f;return}g=0;do{h=d+(g<<4)|0;aw(f,a,b+(g<<4)|0);c[h+0>>2]=c[f+0>>2];c[h+4>>2]=c[f+4>>2];c[h+8>>2]=c[f+8>>2];c[h+12>>2]=c[f+12>>2];g=g+1|0}while((g|0)!=(e|0));i=f;return}function dw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;aw(a,b,d);if(!(+$b[c[(c[b>>2]|0)+48>>2]&15](b)!=0.0)){i=e;return}l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function ew(a,b){a=a|0;b=b|0;var d=0.0,e=0.0,f=0.0,h=0,i=0,j=0;j=c[a+68>>2]|0;i=c[a+64>>2]|0;h=c[a+72>>2]|0;e=+g[b+(j<<2)>>2]/+g[a+(j<<2)+12>>2]*+g[a+60>>2];g[a+60>>2]=e;f=+g[a+56>>2]*(+g[b+(i<<2)>>2]/+g[a+(i<<2)+12>>2]+ +g[b+(h<<2)>>2]/+g[a+(h<<2)+12>>2])*.5;g[a+56>>2]=f;g[a+52>>2]=f/+Q(+(e*e+f*f));f=+P(+(+g[b>>2]));e=+P(+(+g[b+4>>2]));d=+P(+(+g[b+8>>2]));g[a+12>>2]=f;g[a+16>>2]=e;g[a+20>>2]=d;g[a+24>>2]=0.0;return}function fw(a){a=a|0;return}function gw(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function hw(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+80>>2]&127](a,b,d,e);i=f;return}function iw(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0;e=i;i=i+96|0;g[e+32>>2]=1.0;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=1.0;c[e+56>>2]=0;c[e+60>>2]=0;c[e+64>>2]=0;c[e+68>>2]=0;g[e+72>>2]=1.0;l=e+76|0;c[l+0>>2]=0;c[l+4>>2]=0;c[l+8>>2]=0;c[l+12>>2]=0;c[l+16>>2]=0;vc[c[(c[a>>2]|0)+8>>2]&127](a,e+32|0,e+16|0,e);j=(+g[e>>2]- +g[e+16>>2])*.5;h=(+g[e+4>>2]- +g[e+20>>2])*.5;k=(+g[e+8>>2]- +g[e+24>>2])*.5;f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);g[d>>2]=b*.0833333283662796*((h+f)*2.0*(h+f)*2.0+(k+f)*2.0*(k+f)*2.0);g[d+4>>2]=b*.0833333283662796*((j+f)*2.0*(j+f)*2.0+(k+f)*2.0*(k+f)*2.0);g[d+8>>2]=b*.0833333283662796*((j+f)*2.0*(j+f)*2.0+(h+f)*2.0*(h+f)*2.0);g[d+12>>2]=0.0;i=e;return}function jw(a){a=a|0;return 10136}function kw(a,b){a=a|0;b=b|0;g[a>>2]=0.0;g[a+4>>2]=1.0;g[a+8>>2]=0.0;g[a+12>>2]=0.0;return}function lw(a,b){a=a|0;b=+b;g[a+44>>2]=b;return}function mw(a){a=a|0;return 60}function nw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=h;if(h)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+28>>2]=+g[a+28>>2];g[b+32>>2]=+g[a+32>>2];g[b+36>>2]=+g[a+36>>2];g[b+40>>2]=+g[a+40>>2];g[b+12>>2]=+g[a+12>>2];g[b+16>>2]=+g[a+16>>2];g[b+20>>2]=+g[a+20>>2];g[b+24>>2]=+g[a+24>>2];g[b+44>>2]=+g[a+44>>2];c[b+52>>2]=c[a+68>>2];i=e;return 10120}function ow(a){a=a|0;return}function pw(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function qw(a){a=a|0;return 10112}function rw(a,b){a=a|0;b=b|0;g[a>>2]=0.0;g[a+4>>2]=0.0;g[a+8>>2]=1.0;g[a+12>>2]=0.0;return}function sw(a){a=a|0;return}function tw(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function uw(a){a=a|0;return 10104}function vw(a,b){a=a|0;b=b|0;g[a>>2]=1.0;g[a+4>>2]=0.0;g[a+8>>2]=0.0;g[a+12>>2]=0.0;return}function ww(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0,L=0,M=0,N=0,O=0;h=i;i=i+288|0;if(!(c[b+16>>2]|0)){K=c[b+12>>2]|0;b=c[b+20>>2]|0;n=+g[d>>2];q=+g[d+4>>2];u=+g[d+8>>2];k=+g[d+16>>2];r=+g[d+20>>2];j=+g[d+24>>2];m=+g[d+32>>2];s=+g[d+36>>2];l=+g[d+40>>2];F=+g[d+48>>2];E=+g[d+52>>2];D=+g[d+56>>2];J=+g[e>>2];I=+g[e+16>>2];y=+g[e+32>>2];H=+g[e+4>>2];G=+g[e+20>>2];w=+g[e+36>>2];v=+g[e+8>>2];z=+g[e+24>>2];x=+g[e+40>>2];C=-+g[e+48>>2];B=-+g[e+52>>2];p=-+g[e+56>>2];d=c[(c[K>>2]|0)+64>>2]|0;A=-+g[b+48>>2];t=-+g[b+52>>2];o=-+g[b+56>>2];g[h+32>>2]=(n*J+k*I+m*y)*A+(n*H+k*G+m*w)*t+(n*v+k*z+m*x)*o;g[h+36>>2]=(q*J+r*I+s*y)*A+(q*H+r*G+s*w)*t+(q*v+r*z+s*x)*o;g[h+40>>2]=(u*J+j*I+l*y)*A+(u*H+j*G+l*w)*t+(u*v+j*z+l*x)*o;g[h+44>>2]=0.0;rc[d&127](h+48|0,K,h+32|0);o=+g[h+48>>2];t=+g[h+52>>2];A=+g[h+56>>2];y=F*J+E*I+D*y+(J*C+I*B+y*p)+((n*J+k*I+m*y)*o+(q*J+r*I+s*y)*t+(u*J+j*I+l*y)*A);w=F*H+E*G+D*w+(H*C+G*B+w*p)+((n*H+k*G+m*w)*o+(q*H+r*G+s*w)*t+(u*H+j*G+l*w)*A);A=F*v+E*z+D*x+(v*C+z*B+x*p)+((n*v+k*z+m*x)*o+(q*v+r*z+s*x)*t+(u*v+j*z+l*x)*A);x=+g[b+48>>2];l=+g[b+52>>2];z=+g[b+56>>2];j=z*A+(x*y+l*w)- +g[b+64>>2];v=+g[e>>2];u=+g[e+4>>2];t=+g[e+8>>2];s=+g[e+16>>2];r=+g[e+20>>2];q=+g[e+24>>2];o=+g[e+32>>2];m=+g[e+36>>2];k=+g[e+40>>2];n=s*(y-x*j)+(w-l*j)*r+(A-z*j)*q+ +g[e+52>>2];p=(y-x*j)*o+(w-l*j)*m+(A-z*j)*k+ +g[e+56>>2];g[h+16>>2]=t*(A-z*j)+(v*(y-x*j)+u*(w-l*j))+ +g[e+48>>2];g[h+20>>2]=n;g[h+24>>2]=p;g[h+28>>2]=0.0;p=+g[b+48>>2];n=+g[b+52>>2];l=+g[b+56>>2];g[h>>2]=v*p+u*n+t*l;g[h+4>>2]=p*s+n*r+l*q;g[h+8>>2]=p*o+n*m+l*k;g[h+12>>2]=0.0;qc[c[(c[f>>2]|0)+16>>2]&15](f,h,h+16|0,j);i=h;return}else{N=c[b+4>>2]|0;a[N+312>>0]=0;c[N>>2]=0;a[N+356>>0]=1;g[N+292>>2]=999999984306749400.0;g[N+296>>2]=999999984306749400.0;g[N+300>>2]=999999984306749400.0;g[N+304>>2]=0.0;c[N+336>>2]=0;c[N+340>>2]=0;c[N+344>>2]=0;c[N+348>>2]=0;a[N+352>>0]=0;a[N+332>>0]=a[N+332>>0]&-16;N=c[b+12>>2]|0;M=c[b+16>>2]|0;L=c[N+4>>2]|0;K=c[M+4>>2]|0;I=+$b[c[(c[N>>2]|0)+48>>2]&15](N);O=c[b+16>>2]|0;J=+$b[c[(c[O>>2]|0)+48>>2]&15](O);O=c[b+4>>2]|0;b=c[b+8>>2]|0;c[h+200>>2]=13392;g[h+204>>2]=0.0;g[h+208>>2]=1.0;g[h+212>>2]=0.0;g[h+216>>2]=0.0;c[h+220>>2]=b;c[h+224>>2]=O;c[h+228>>2]=N;c[h+232>>2]=M;c[h+236>>2]=L;c[h+240>>2]=K;g[h+244>>2]=I;g[h+248>>2]=J;a[h+252>>0]=0;c[h+260>>2]=-1;c[h+272>>2]=1;c[h+276>>2]=1;g[h+192>>2]=999999984306749400.0;c[h+64>>2]=c[d+0>>2];c[h+68>>2]=c[d+4>>2];c[h+72>>2]=c[d+8>>2];c[h+76>>2]=c[d+12>>2];c[h+80>>2]=c[d+16>>2];c[h+84>>2]=c[d+20>>2];c[h+88>>2]=c[d+24>>2];c[h+92>>2]=c[d+28>>2];c[h+96>>2]=c[d+32>>2];c[h+100>>2]=c[d+36>>2];c[h+104>>2]=c[d+40>>2];c[h+108>>2]=c[d+44>>2];c[h+112>>2]=c[d+48>>2];c[h+116>>2]=c[d+52>>2];c[h+120>>2]=c[d+56>>2];c[h+124>>2]=c[d+60>>2];c[h+128>>2]=c[e+0>>2];c[h+132>>2]=c[e+4>>2];c[h+136>>2]=c[e+8>>2];c[h+140>>2]=c[e+12>>2];c[h+144>>2]=c[e+16>>2];c[h+148>>2]=c[e+20>>2];c[h+152>>2]=c[e+24>>2];c[h+156>>2]=c[e+28>>2];c[h+160>>2]=c[e+32>>2];c[h+164>>2]=c[e+36>>2];c[h+168>>2]=c[e+40>>2];c[h+172>>2]=c[e+44>>2];c[h+176>>2]=c[e+48>>2];c[h+180>>2]=c[e+52>>2];c[h+184>>2]=c[e+56>>2];c[h+188>>2]=c[e+60>>2];Az(h+200|0,h+64|0,f,0,0);i=h;return}}function xw(b,d,e,f,h,j){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0;k=i;i=i+304|0;l=+g[e+48>>2]- +g[d+48>>2];n=+g[e+52>>2]- +g[d+52>>2];m=+g[e+56>>2]- +g[d+56>>2];Lo(d,e,k+256|0,k+192|0);r=+g[k+192>>2];s=+g[k+256>>2]*r;t=r*+g[k+260>>2];r=r*+g[k+264>>2];g[k+176>>2]=s;g[k+180>>2]=t;g[k+184>>2]=r;g[k+188>>2]=0.0;q=+g[h+48>>2]- +g[f+48>>2];o=+g[h+52>>2]- +g[f+52>>2];p=+g[h+56>>2]- +g[f+56>>2];Lo(f,h,k+256|0,k+192|0);v=+g[k+192>>2];x=+g[k+256>>2]*v;w=v*+g[k+260>>2];v=v*+g[k+264>>2];g[k+160>>2]=x;g[k+164>>2]=w;g[k+168>>2]=v;g[k+172>>2]=0.0;h=c[b+12>>2]|0;u=+$b[c[(c[h>>2]|0)+16>>2]&15](h);h=c[b+16>>2]|0;if(!h)y=0.0;else y=+$b[c[(c[h>>2]|0)+16>>2]&15](h);r=u*+Q(+(s*s+t*t+r*r))+y*+Q(+(x*x+w*w+v*v));if(r+ +Q(+((q-l)*(q-l)+(o-n)*(o-n)+(p-m)*(p-m)))==0.0){e=0;i=k;return e|0}c[k+256>>2]=10224;g[k+292>>2]=999999984306749400.0;a[k+296>>0]=0;ww(b,d,f,k+256|0);e=(a[k+296>>0]|0)==0;c[k+144>>2]=c[k+276>>2];c[k+148>>2]=c[k+280>>2];c[k+152>>2]=c[k+284>>2];c[k+156>>2]=c[k+288>>2];if(e){e=0;i=k;return e|0}s=+g[k+260>>2];u=+g[k+264>>2];w=+g[k+268>>2];if(r+((q-l)*s+(o-n)*u+(p-m)*w)<=1.1920928955078125e-7){e=0;i=k;return e|0}y=+g[k+272>>2];v=+g[k+292>>2]+ +g[j+172>>2];t=0.0;h=0;while(1){if(!(v>.0010000000474974513)){f=18;break}e=c[j+168>>2]|0;if(e){z=c[(c[e>>2]|0)+20>>2]|0;g[k+128>>2]=1.0;g[k+132>>2]=1.0;g[k+136>>2]=1.0;g[k+140>>2]=0.0;Qb[z&7](e,k+144|0,.20000000298023224,k+128|0)}s=r+((p-m)*w+((o-n)*u+(q-l)*s));if(s<=1.1920928955078125e-7){j=0;f=19;break}x=t+v/s;if(!(!(x<0.0)&!(x>1.0)&!(x<=t))){j=0;f=19;break}Bo(d,l,n,m,k+176|0,x,k+192|0);Bo(f,q,o,p,k+160|0,x,k+64|0);e=c[j+168>>2]|0;if(e){z=c[(c[e>>2]|0)+20>>2]|0;g[k+48>>2]=1.0;g[k+52>>2]=0.0;g[k+56>>2]=0.0;g[k+60>>2]=0.0;Qb[z&7](e,k+240|0,.20000000298023224,k+48|0)}Kb[c[c[j>>2]>>2]&31](j,x);c[k>>2]=10224;g[k+36>>2]=999999984306749400.0;a[k+40>>0]=0;ww(b,k+192|0,k+64|0,k);if(!(a[k+40>>0]|0)){f=16;break}v=+g[k+36>>2]+ +g[j+172>>2];c[k+144>>2]=c[k+20>>2];c[k+148>>2]=c[k+24>>2];c[k+152>>2]=c[k+28>>2];c[k+156>>2]=c[k+32>>2];e=h+1|0;if((h|0)>63){f=17;break}else{s=+g[k+4>>2];u=+g[k+8>>2];w=+g[k+12>>2];y=+g[k+16>>2];t=x;h=e}}if((f|0)==16){rc[c[(c[j>>2]|0)+8>>2]&127](j,-1,h);z=0;i=k;return z|0}else if((f|0)==17){rc[c[(c[j>>2]|0)+8>>2]&127](j,-2,e);z=0;i=k;return z|0}else if((f|0)==18){g[j+164>>2]=t;g[j+132>>2]=s;g[j+136>>2]=u;g[j+140>>2]=w;g[j+144>>2]=y;c[j+148>>2]=c[k+144>>2];c[j+152>>2]=c[k+148>>2];c[j+156>>2]=c[k+152>>2];c[j+160>>2]=c[k+156>>2];z=1;i=k;return z|0}else if((f|0)==19){i=k;return j|0}return 0}function yw(a){a=a|0;return}function zw(a){a=a|0;return}function Aw(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Bw(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Cw(a,b,c){a=a|0;b=b|0;c=c|0;return}function Dw(a,b,c){a=a|0;b=b|0;c=c|0;return}function Ew(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0;h=i;if(!(+g[b+36>>2]>f)){i=h;return}a[b+40>>0]=1;c[b+4>>2]=c[d+0>>2];c[b+8>>2]=c[d+4>>2];c[b+12>>2]=c[d+8>>2];c[b+16>>2]=c[d+12>>2];c[b+20>>2]=c[e+0>>2];c[b+24>>2]=c[e+4>>2];c[b+28>>2]=c[e+8>>2];c[b+32>>2]=c[e+12>>2];g[b+36>>2]=f;i=h;return}function Fw(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+12>>2]=c[b+0>>2];c[a+16>>2]=c[b+4>>2];c[a+20>>2]=c[b+8>>2];c[a+24>>2]=c[b+12>>2];EA(a);i=d;return}function Gw(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;j=c[b+96>>2]|0;if((j|0)==(c[b+100>>2]|0)?(g=(j|0)==0?1:j<<1,(j|0)<(g|0)):0){if(!g)h=0;else{c[5004]=(c[5004]|0)+1;h=fF((g<<4|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+96>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<4)|0;m=(c[b+104>>2]|0)+(k<<4)|0;c[l+0>>2]=c[m+0>>2];c[l+4>>2]=c[m+4>>2];c[l+8>>2]=c[m+8>>2];c[l+12>>2]=c[m+12>>2];k=k+1|0}while((k|0)!=(j|0))}j=c[b+104>>2]|0;if(j){if(a[b+108>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[b+104>>2]=0}a[b+108>>0]=1;c[b+104>>2]=h;c[b+100>>2]=g;j=c[b+96>>2]|0}m=(c[b+104>>2]|0)+(j<<4)|0;c[m+0>>2]=c[d+0>>2];c[m+4>>2]=c[d+4>>2];c[m+8>>2]=c[d+8>>2];c[m+12>>2]=c[d+12>>2];c[b+96>>2]=(c[b+96>>2]|0)+1;if(!e){i=f;return}EA(b);i=f;return}function Hw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0,h=0.0,j=0.0,k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0,q=0.0,r=0;k=i;f=c[b+96>>2]|0;if((f|0)<=0){c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;i=k;return}e=+g[b+12>>2];j=+g[d>>2]*e;l=+g[b+16>>2];h=+g[d+4>>2]*l;m=+g[b+20>>2];n=+g[d+8>>2]*m;b=c[b+104>>2]|0;d=0;o=-3.4028234663852886e+38;p=-1;while(1){q=j*+g[b+(d<<4)>>2]+h*+g[b+(d<<4)+4>>2]+n*+g[b+(d<<4)+8>>2];r=q>o;p=r?d:p;d=d+1|0;if((d|0)==(f|0))break;else o=r?q:o}o=+g[b+(p<<4)+4>>2]*l;q=+g[b+(p<<4)+8>>2]*m;g[a>>2]=+g[b+(p<<4)>>2]*e;g[a+4>>2]=o;g[a+8>>2]=q;g[a+12>>2]=0.0;i=k;return}function Iw(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0,k=0.0,l=0.0,m=0,n=0.0,o=0.0,p=0.0,q=0,r=0,s=0,t=0.0,u=0.0,v=0;f=i;if((e|0)>0)j=0;else{i=f;return}do{g[d+(j<<4)+12>>2]=-999999984306749400.0;j=j+1|0}while((j|0)!=(e|0));j=0;do{t=+g[a+12>>2];n=+g[b+(j<<4)>>2]*t;k=+g[a+16>>2];o=+g[b+(j<<4)+4>>2]*k;l=+g[a+20>>2];p=+g[b+(j<<4)+8>>2]*l;q=c[a+96>>2]|0;if((q|0)>0){r=c[a+104>>2]|0;s=0;h=-3.4028234663852886e+38;m=-1;do{u=n*+g[r+(s<<4)>>2]+o*+g[r+(s<<4)+4>>2]+p*+g[r+(s<<4)+8>>2];v=u>h;m=v?s:m;h=v?u:h;s=s+1|0}while((s|0)!=(q|0));p=+g[r+(m<<4)+4>>2]*k;u=+g[r+(m<<4)+8>>2]*l;g[d+(j<<4)>>2]=+g[r+(m<<4)>>2]*t;g[d+(j<<4)+4>>2]=p;g[d+(j<<4)+8>>2]=u;g[d+(j<<4)+12>>2]=h}else g[d+(j<<4)+12>>2]=-999999984306749400.0;j=j+1|0}while((j|0)!=(e|0));i=f;return}function Jw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);if(!(+$b[c[(c[b>>2]|0)+48>>2]&15](b)!=0.0)){i=e;return}l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function Kw(a){a=a|0;return c[a+96>>2]|0}function Lw(a){a=a|0;return c[a+96>>2]|0}function Mw(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,i=0,j=0;i=c[a+96>>2]|0;j=c[a+104>>2]|0;f=+g[j+(((b|0)%(i|0)|0)<<4)+4>>2]*+g[a+16>>2];h=+g[j+(((b|0)%(i|0)|0)<<4)+8>>2]*+g[a+20>>2];g[d>>2]=+g[j+(((b|0)%(i|0)|0)<<4)>>2]*+g[a+12>>2];g[d+4>>2]=f;g[d+8>>2]=h;g[d+12>>2]=0.0;d=c[a+104>>2]|0;h=+g[d+(((b+1|0)%(i|0)|0)<<4)+4>>2]*+g[a+16>>2];f=+g[d+(((b+1|0)%(i|0)|0)<<4)+8>>2]*+g[a+20>>2];g[e>>2]=+g[d+(((b+1|0)%(i|0)|0)<<4)>>2]*+g[a+12>>2];g[e+4>>2]=h;g[e+8>>2]=f;g[e+12>>2]=0.0;return}function Nw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0.0,h=0;h=c[a+104>>2]|0;f=+g[h+(b<<4)+4>>2]*+g[a+16>>2];e=+g[h+(b<<4)+8>>2]*+g[a+20>>2];g[d>>2]=+g[h+(b<<4)>>2]*+g[a+12>>2];g[d+4>>2]=f;g[d+8>>2]=e;g[d+12>>2]=0.0;return}function Ow(a){a=a|0;return 0}function Pw(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return}function Qw(a,b,c){a=a|0;b=b|0;c=+c;return 0}function Rw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;j=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=j;if(j)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+28>>2]=+g[a+28>>2];g[b+32>>2]=+g[a+32>>2];g[b+36>>2]=+g[a+36>>2];g[b+40>>2]=+g[a+40>>2];g[b+12>>2]=+g[a+12>>2];g[b+16>>2]=+g[a+16>>2];g[b+20>>2]=+g[a+20>>2];g[b+24>>2]=+g[a+24>>2];g[b+44>>2]=+g[a+44>>2];f=c[a+96>>2]|0;c[b+60>>2]=f;if(!f){c[b+52>>2]=0;c[b+56>>2]=0;i=e;return 10504}c[b+52>>2]=gc[c[(c[d>>2]|0)+28>>2]&31](d,c[a+104>>2]|0)|0;c[b+56>>2]=0;b=Yb[c[(c[d>>2]|0)+16>>2]&31](d,16,f)|0;if((f|0)>0){h=c[a+104>>2]|0;a=0;j=c[b+8>>2]|0;while(1){g[j>>2]=+g[h+(a<<4)>>2];g[j+4>>2]=+g[h+(a<<4)+4>>2];g[j+8>>2]=+g[h+(a<<4)+8>>2];g[j+12>>2]=+g[h+(a<<4)+12>>2];a=a+1|0;if((a|0)==(f|0))break;else j=j+16|0}}else h=c[a+104>>2]|0;Jb[c[(c[d>>2]|0)+20>>2]&31](d,b,19760,1497453121,h);i=e;return 10504}function Sw(a,b,d,e,f,h,j){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0;k=i;i=i+16|0;g[e>>2]=3.4028234663852886e+38;g[f>>2]=-3.4028234663852886e+38;m=c[a+96>>2]|0;if((m|0)>0){n=0;do{s=c[a+104>>2]|0;r=+g[s+(n<<4)>>2]*+g[a+12>>2];q=+g[s+(n<<4)+4>>2]*+g[a+16>>2];l=+g[s+(n<<4)+8>>2]*+g[a+20>>2];p=r*+g[b>>2]+q*+g[b+4>>2]+l*+g[b+8>>2]+ +g[b+48>>2];o=r*+g[b+16>>2]+q*+g[b+20>>2]+l*+g[b+24>>2]+ +g[b+52>>2];l=r*+g[b+32>>2]+q*+g[b+36>>2]+l*+g[b+40>>2]+ +g[b+56>>2];q=p*+g[d>>2]+o*+g[d+4>>2]+l*+g[d+8>>2];if(q<+g[e>>2]){g[e>>2]=q;g[h>>2]=p;g[h+4>>2]=o;g[h+8>>2]=l;g[h+12>>2]=0.0}if(q>+g[f>>2]){g[f>>2]=q;g[j>>2]=p;g[j+4>>2]=o;g[j+8>>2]=l;g[j+12>>2]=0.0}n=n+1|0}while((n|0)!=(m|0));o=+g[f>>2]}else o=-3.4028234663852886e+38;l=+g[e>>2];if(!(l>o)){i=k;return}g[e>>2]=o;g[f>>2]=l;c[k+0>>2]=c[h+0>>2];c[k+4>>2]=c[h+4>>2];c[k+8>>2]=c[h+8>>2];c[k+12>>2]=c[h+12>>2];c[h+0>>2]=c[j+0>>2];c[h+4>>2]=c[j+4>>2];c[h+8>>2]=c[j+8>>2];c[h+12>>2]=c[j+12>>2];c[j+0>>2]=c[k+0>>2];c[j+4>>2]=c[k+4>>2];c[j+8>>2]=c[k+8>>2];c[j+12>>2]=c[k+12>>2];i=k;return}function Tw(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=10376;e=c[b+104>>2]|0;if(e){if(a[b+108>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+104>>2]=0}a[b+108>>0]=1;c[b+104>>2]=0;c[b+96>>2]=0;c[b+100>>2]=0;c[b>>2]=15736;e=c[b+52>>2]|0;if(!e){i=d;return}Lb[c[c[e>>2]>>2]&511](e);b=c[b+52>>2]|0;if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function Uw(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=10376;f=c[b+104>>2]|0;if(f){if(a[b+108>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+104>>2]=0}a[b+108>>0]=1;c[b+104>>2]=0;c[b+96>>2]=0;c[b+100>>2]=0;c[b>>2]=15736;f=c[b+52>>2]|0;if((f|0)!=0?(Lb[c[c[f>>2]>>2]&511](f),e=c[b+52>>2]|0,(e|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function Vw(a){a=a|0;return 10568}function Ww(a){a=a|0;return 68}function Xw(a,b){a=a|0;b=b|0;var c=0.0,d=0.0,e=0.0;e=+P(+(+g[b>>2]));d=+P(+(+g[b+4>>2]));c=+P(+(+g[b+8>>2]));g[a+12>>2]=e;g[a+16>>2]=d;g[a+20>>2]=c;g[a+24>>2]=0.0;return}function Yw(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0,k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0;f=i;i=i+96|0;h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=0;do{q=f+80+(j<<2)|0;c[f+80>>2]=0;c[f+84>>2]=0;c[f+88>>2]=0;c[f+92>>2]=0;g[q>>2]=1.0;k=c[(c[a>>2]|0)+64>>2]|0;l=+g[f+80>>2];m=+g[f+84>>2];n=+g[f+88>>2];o=l*+g[b+4>>2]+m*+g[b+20>>2]+n*+g[b+36>>2];p=l*+g[b+8>>2]+m*+g[b+24>>2]+n*+g[b+40>>2];g[f+48>>2]=+g[b>>2]*l+ +g[b+16>>2]*m+ +g[b+32>>2]*n;g[f+52>>2]=o;g[f+56>>2]=p;g[f+60>>2]=0.0;rc[k&127](f+64|0,a,f+48|0);p=+g[f+64>>2];o=+g[f+68>>2];n=+g[f+72>>2];m=p*+g[b+16>>2]+o*+g[b+20>>2]+n*+g[b+24>>2]+ +g[b+52>>2];l=p*+g[b+32>>2]+o*+g[b+36>>2]+n*+g[b+40>>2]+ +g[b+56>>2];g[f+32>>2]=p*+g[b>>2]+o*+g[b+4>>2]+n*+g[b+8>>2]+ +g[b+48>>2];g[f+36>>2]=m;g[f+40>>2]=l;g[f+44>>2]=0.0;k=f+32+(j<<2)|0;g[e+(j<<2)>>2]=h+ +g[k>>2];g[q>>2]=-1.0;q=c[(c[a>>2]|0)+64>>2]|0;l=+g[f+80>>2];m=+g[f+84>>2];n=+g[f+88>>2];o=l*+g[b+4>>2]+m*+g[b+20>>2]+n*+g[b+36>>2];p=l*+g[b+8>>2]+m*+g[b+24>>2]+n*+g[b+40>>2];g[f>>2]=+g[b>>2]*l+ +g[b+16>>2]*m+ +g[b+32>>2]*n;g[f+4>>2]=o;g[f+8>>2]=p;g[f+12>>2]=0.0;rc[q&127](f+16|0,a,f);p=+g[f+16>>2];o=+g[f+20>>2];n=+g[f+24>>2];m=p*+g[b+16>>2]+o*+g[b+20>>2]+n*+g[b+24>>2]+ +g[b+52>>2];l=p*+g[b+32>>2]+o*+g[b+36>>2]+n*+g[b+40>>2]+ +g[b+56>>2];g[f+32>>2]=p*+g[b>>2]+o*+g[b+4>>2]+n*+g[b+8>>2]+ +g[b+48>>2];g[f+36>>2]=m;g[f+40>>2]=l;g[f+44>>2]=0.0;g[d+(j<<2)>>2]=+g[k>>2]-h;j=j+1|0}while((j|0)!=3);i=f;return}function Zw(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);if(!(+$b[c[(c[b>>2]|0)+48>>2]&15](b)!=0.0)){i=e;return}l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function _w(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0;h=i;i=i+64|0;n=+g[d>>2];o=+g[d+4>>2];m=+g[d+8>>2];p=n*+g[b+4>>2]+o*+g[b+20>>2]+m*+g[b+36>>2];q=n*+g[b+8>>2]+o*+g[b+24>>2]+m*+g[b+40>>2];g[h+48>>2]=+g[b>>2]*n+ +g[b+16>>2]*o+ +g[b+32>>2]*m;g[h+52>>2]=p;g[h+56>>2]=q;g[h+60>>2]=0.0;rc[c[(c[a>>2]|0)+64>>2]&127](h+32|0,a,h+48|0);q=+g[h+32>>2];p=+g[h+36>>2];m=+g[h+40>>2];o=q*+g[b>>2]+p*+g[b+4>>2]+m*+g[b+8>>2]+ +g[b+48>>2];n=q*+g[b+16>>2]+p*+g[b+20>>2]+m*+g[b+24>>2]+ +g[b+52>>2];m=q*+g[b+32>>2]+p*+g[b+36>>2]+m*+g[b+40>>2]+ +g[b+56>>2];r=c[(c[a>>2]|0)+64>>2]|0;p=-+g[h+52>>2];q=-+g[h+56>>2];g[h>>2]=-+g[h+48>>2];g[h+4>>2]=p;g[h+8>>2]=q;g[h+12>>2]=0.0;rc[r&127](h+16|0,a,h);q=+g[h+16>>2];p=+g[h+20>>2];j=+g[h+24>>2];l=q*+g[b>>2]+p*+g[b+4>>2]+j*+g[b+8>>2]+ +g[b+48>>2];k=q*+g[b+16>>2]+p*+g[b+20>>2]+j*+g[b+24>>2]+ +g[b+52>>2];j=q*+g[b+32>>2]+p*+g[b+36>>2]+j*+g[b+40>>2]+ +g[b+56>>2];g[e>>2]=o*+g[d>>2]+n*+g[d+4>>2]+m*+g[d+8>>2];j=l*+g[d>>2]+k*+g[d+4>>2]+j*+g[d+8>>2];g[f>>2]=j;k=+g[e>>2];if(!(k>j)){i=h;return}g[e>>2]=j;g[f>>2]=k;i=h;return}function $w(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0,v=0.0,w=0,x=0;e=i;i=i+80|0;switch(c[b+4>>2]|0){case 8:{c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;i=e;return};case 1:{t=+g[d>>2];v=+g[d+4>>2];j=+g[d+8>>2];h=t*+g[b+56>>2]+v*+g[b+60>>2]+j*+g[b+64>>2];f=t*+g[b+72>>2]+v*+g[b+76>>2]+j*+g[b+80>>2];j=t*+g[b+88>>2]+v*+g[b+92>>2]+j*+g[b+96>>2];if(h<f)d=f<j?2:1;else d=h<j?2:0;t=+g[b+56+(d<<4)+4>>2];v=+g[b+56+(d<<4)+8>>2];g[a>>2]=+g[b+56+(d<<4)>>2];g[a+4>>2]=t;g[a+8>>2]=v;g[a+12>>2]=0.0;i=e;return};case 13:{c[e+64>>2]=c[b+28>>2];c[e+68>>2]=c[b+32>>2];c[e+72>>2]=c[b+36>>2];c[e+76>>2]=c[b+40>>2];g[e+48>>2]=+g[d>>2];f=+g[d+4>>2];g[e+52>>2]=f;h=+g[d+8>>2];g[e+56>>2]=h;g[e+60>>2]=0.0;w=c[b+52>>2]|0;if((w|0)==1){u=0;d=w;b=2}else if((w|0)==2){h=f;u=0;d=w;b=1}else{u=1;d=0;b=2}f=+g[e+64+(u<<2)>>2];k=+g[e+64+(w<<2)>>2];l=+g[e+48+(u<<2)>>2];j=+Q(+(l*l+h*h));if(j!=0.0){g[e+32+(u<<2)>>2]=l*(f/j);if(+g[e+48+(d<<2)>>2]<0.0)k=-k;g[e+32+(d<<2)>>2]=k;g[e+32+(b<<2)>>2]=f/j*h;g[a>>2]=+g[e+32>>2];g[a+4>>2]=+g[e+36>>2];g[a+8>>2]=+g[e+40>>2];g[a+12>>2]=0.0;i=e;return}else{g[e+32+(u<<2)>>2]=f;if(+g[e+48+(d<<2)>>2]<0.0)k=-k;g[e+32+(d<<2)>>2]=k;g[e+32+(b<<2)>>2]=0.0;g[a>>2]=+g[e+32>>2];g[a+4>>2]=+g[e+36>>2];g[a+8>>2]=+g[e+40>>2];g[a+12>>2]=0.0;i=e;return}};case 10:{h=+g[d>>2];j=+g[d+4>>2];k=+g[d+8>>2];d=c[b+52>>2]|0;f=+g[b+(d<<2)+28>>2];n=+g[b+(((d+2|0)%3|0)<<2)+28>>2];if(h*h+j*j+k*k<9999999747378752.0e-20){h=1.0;j=0.0;k=0.0}else{v=1.0/+Q(+(h*h+j*j+k*k));h=h*v;j=j*v;k=k*v}c[e+16>>2]=0;c[e+20>>2]=0;c[e+24>>2]=0;c[e+28>>2]=0;g[e+16+(d<<2)>>2]=f;m=n*h;l=n*j;n=n*k;q=+g[b+44>>2];o=h*q;p=j*q;q=k*q;v=+g[e+16>>2]+m-o;t=l+ +g[e+20>>2]-p;s=n+ +g[e+24>>2]-q;r=k*s+(h*v+j*t);if(!(r>-999999984306749400.0)){s=0.0;t=0.0;v=0.0;r=-999999984306749400.0}c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;g[e+(d<<2)>>2]=-f;o=m+ +g[e>>2]-o;p=l+ +g[e+4>>2]-p;q=n+ +g[e+8>>2]-q;x=k*q+(h*o+j*p)>r;g[a>>2]=x?o:v;g[a+4>>2]=x?p:t;g[a+8>>2]=x?q:s;g[a+12>>2]=0.0;i=e;return};case 4:{u=c[b+104>>2]|0;w=c[b+96>>2]|0;h=+g[b+12>>2];f=+g[b+16>>2];j=+g[b+20>>2];k=+g[d>>2]*h;l=+g[d+4>>2]*f;n=+g[d+8>>2]*j;if((w|0)>0){d=0;m=-3.4028234663852886e+38;x=-1;while(1){o=k*+g[u+(d<<4)>>2]+l*+g[u+(d<<4)+4>>2]+n*+g[u+(d<<4)+8>>2];b=o>m;x=b?d:x;d=d+1|0;if((d|0)==(w|0))break;else m=b?o:m}}else x=-1;t=f*+g[u+(x<<4)+4>>2];v=j*+g[u+(x<<4)+8>>2];g[a>>2]=h*+g[u+(x<<4)>>2];g[a+4>>2]=t;g[a+8>>2]=v;g[a+12>>2]=0.0;i=e;return};case 5:{u=c[b+92>>2]|0;w=c[b+96>>2]|0;h=+g[b+12>>2];f=+g[b+16>>2];j=+g[b+20>>2];k=+g[d>>2]*h;l=+g[d+4>>2]*f;n=+g[d+8>>2]*j;if((w|0)>0){d=0;o=-3.4028234663852886e+38;x=-1;while(1){m=k*+g[u+(d<<4)>>2]+l*+g[u+(d<<4)+4>>2]+n*+g[u+(d<<4)+8>>2];b=m>o;x=b?d:x;d=d+1|0;if((d|0)==(w|0))break;else o=b?m:o}}else x=-1;t=f*+g[u+(x<<4)+4>>2];v=j*+g[u+(x<<4)+8>>2];g[a>>2]=h*+g[u+(x<<4)>>2];g[a+4>>2]=t;g[a+8>>2]=v;g[a+12>>2]=0.0;i=e;return};case 0:{s=+g[b+28>>2];t=+g[b+32>>2];t=+g[d+4>>2]>=0.0?t:-t;v=+g[b+36>>2];v=+g[d+8>>2]>=0.0?v:-v;g[a>>2]=+g[d>>2]>=0.0?s:-s;g[a+4>>2]=t;g[a+8>>2]=v;g[a+12>>2]=0.0;i=e;return};default:{rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);i=e;return}}}function ax(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0;e=i;i=i+32|0;c[e+16>>2]=c[d+0>>2];c[e+20>>2]=c[d+4>>2];c[e+24>>2]=c[d+8>>2];c[e+28>>2]=c[d+12>>2];h=+g[e+16>>2];j=+g[e+20>>2];f=+g[e+24>>2];if(h*h+j*j+f*f<1.4210854715202004e-14){g[e+16>>2]=-1.0;g[e+20>>2]=-1.0;g[e+24>>2]=-1.0;g[e+28>>2]=0.0;h=-1.0;j=-1.0;f=-1.0}k=1.0/+Q(+(h*h+j*j+f*f));g[e+16>>2]=h*k;g[e+20>>2]=j*k;g[e+24>>2]=f*k;$w(e,b,e+16|0);switch(c[b+4>>2]|0){case 0:{f=+g[b+44>>2];break};case 11:{f=+g[b+44>>2];break};case 10:{f=+g[b+44>>2];break};case 8:{f=+g[b+28>>2]*+g[b+12>>2];break};case 13:{f=+g[b+44>>2];break};case 4:case 5:{f=+g[b+44>>2];break};case 1:{f=+g[b+44>>2];break};default:f=+$b[c[(c[b>>2]|0)+48>>2]&15](b)}j=f*+g[e+20>>2]+ +g[e+4>>2];k=f*+g[e+24>>2]+ +g[e+8>>2];g[a>>2]=f*+g[e+16>>2]+ +g[e>>2];g[a+4>>2]=j;g[a+8>>2]=k;g[a+12>>2]=0.0;i=e;return}function bx(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0;e=i;i=i+80|0;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;f=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];if(f*f+j*j+h*h<9999999747378752.0e-20){f=1.0;j=0.0;h=0.0;k=0.0}else{k=1.0/+Q(+(f*f+j*j+h*h));f=f*k;j=j*k;h=h*k;k=+g[d+12>>2]}c[e+32>>2]=10856;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=-999999984306749400.0;g[e+56>>2]=f;g[e+60>>2]=j;g[e+64>>2]=h;g[e+68>>2]=k;g[e+16>>2]=999999984306749400.0;g[e+20>>2]=999999984306749400.0;g[e+24>>2]=999999984306749400.0;g[e+28>>2]=0.0;d=c[b+92>>2]|0;b=c[(c[d>>2]|0)+8>>2]|0;g[e>>2]=-999999984306749400.0;g[e+4>>2]=-999999984306749400.0;g[e+8>>2]=-999999984306749400.0;g[e+12>>2]=0.0;vc[b&127](d,e+32|0,e,e+16|0);c[a+0>>2]=c[e+36>>2];c[a+4>>2]=c[e+40>>2];c[a+8>>2]=c[e+44>>2];c[a+12>>2]=c[e+48>>2];i=e;return}function cx(a){a=a|0;return}function dx(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0;f=i;i=i+80|0;if((e|0)>0)h=0;else{i=f;return}do{g[d+(h<<4)+12>>2]=-999999984306749400.0;h=h+1|0}while((h|0)!=(e|0));h=0;do{j=b+(h<<4)|0;c[f+32>>2]=10856;c[f+36>>2]=0;c[f+40>>2]=0;c[f+44>>2]=0;c[f+48>>2]=0;g[f+52>>2]=-999999984306749400.0;c[f+56>>2]=c[j+0>>2];c[f+60>>2]=c[j+4>>2];c[f+64>>2]=c[j+8>>2];c[f+68>>2]=c[j+12>>2];g[f+16>>2]=999999984306749400.0;g[f+20>>2]=999999984306749400.0;g[f+24>>2]=999999984306749400.0;g[f+28>>2]=0.0;j=c[a+92>>2]|0;k=c[(c[j>>2]|0)+8>>2]|0;g[f>>2]=-999999984306749400.0;g[f+4>>2]=-999999984306749400.0;g[f+8>>2]=-999999984306749400.0;g[f+12>>2]=0.0;vc[k&127](j,f+32|0,f,f+16|0);j=d+(h<<4)|0;c[j+0>>2]=c[f+36>>2];c[j+4>>2]=c[f+40>>2];c[j+8>>2]=c[f+44>>2];c[j+12>>2]=c[f+48>>2];h=h+1|0}while((h|0)<(e|0));i=f;return}function ex(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);if(!(+$b[c[(c[b>>2]|0)+48>>2]&15](b)!=0.0)){i=e;return}l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function fx(a){a=a|0;return 0}function gx(a){a=a|0;return 0}function hx(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return}function ix(a,b,c){a=a|0;b=b|0;c=c|0;return}function jx(a){a=a|0;return 0}function kx(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return}function lx(a,b,c){a=a|0;b=b|0;c=+c;return 0}function mx(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;e=(c[a+92>>2]|0)+4|0;c[e+0>>2]=c[b+0>>2];c[e+4>>2]=c[b+4>>2];c[e+8>>2]=c[b+8>>2];c[e+12>>2]=c[b+12>>2];EA(a);i=d;return}function nx(a){a=a|0;return(c[a+92>>2]|0)+4|0}function ox(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(!d){i=b;return}Lb[c[c[d>>2]>>2]&511](d);a=c[a+52>>2]|0;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function px(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(d){Lb[c[c[d>>2]>>2]&511](d);d=c[a+52>>2]|0;if(d){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}if(!a){i=b;return}}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function qx(a){a=a|0;return 10832}function rx(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function sx(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;f=+g[a+24>>2];j=+g[a+28>>2];h=+g[a+32>>2];k=f*+g[b>>2]+j*+g[b+4>>2]+h*+g[b+8>>2];l=+g[a+20>>2];if(k>l){g[a+20>>2]=k;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2]}else k=l;l=f*+g[b+16>>2]+j*+g[b+20>>2]+h*+g[b+24>>2];if(l>k){g[a+20>>2]=l;c[a+4>>2]=c[b+16>>2];c[a+8>>2]=c[b+20>>2];c[a+12>>2]=c[b+24>>2];c[a+16>>2]=c[b+28>>2];k=l}f=f*+g[b+32>>2]+j*+g[b+36>>2]+h*+g[b+40>>2];if(!(f>k)){i=e;return}g[a+20>>2]=f;c[a+4>>2]=c[b+32>>2];c[a+8>>2]=c[b+36>>2];c[a+12>>2]=c[b+40>>2];c[a+16>>2]=c[b+44>>2];i=e;return}function tx(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0;d=i;c[a+4>>2]=35;c[a+8>>2]=0;g[a+12>>2]=1.0;g[a+16>>2]=1.0;g[a+20>>2]=1.0;g[a+24>>2]=0.0;g[a+44>>2]=.03999999910593033;c[a>>2]=10928;c[a+52>>2]=1;f=+g[b>>2];h=+g[b+4>>2];e=+g[b+8>>2];if(f<h)j=f<e?0:2;else j=h<e?1:2;e=+g[b+(j<<2)>>2]*.10000000149011612;if(e<.03999999910593033){l=+Ts(a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);l=l+ +g[a+28>>2];k=k+ +g[a+32>>2];h=h+ +g[a+36>>2];g[a+44>>2]=e;e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=h- +$b[c[(c[a>>2]|0)+48>>2]&15](a);g[a+28>>2]=l-e;g[a+32>>2]=k-f;g[a+36>>2]=h;g[a+40>>2]=0.0;j=c[a>>2]|0}else j=10928|0;h=+$b[c[j+48>>2]&15](a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);l=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=+g[b+4>>2]*+g[a+16>>2]-k;l=+g[b+8>>2]*+g[a+20>>2]-l;g[a+28>>2]=+g[b>>2]*+g[a+12>>2]-h;g[a+32>>2]=k;g[a+36>>2]=l;g[a+40>>2]=0.0;c[a+4>>2]=13;i=d;return}function ux(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0;f=i;k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=k+ +g[a+28>>2];m=k+ +g[a+32>>2];k=k+ +g[a+36>>2];w=+P(+(+g[b>>2]));v=+P(+(+g[b+4>>2]));u=+P(+(+g[b+8>>2]));s=+P(+(+g[b+16>>2]));r=+P(+(+g[b+20>>2]));q=+P(+(+g[b+24>>2]));n=+P(+(+g[b+32>>2]));l=+P(+(+g[b+36>>2]));j=+P(+(+g[b+40>>2]));t=+g[b+48>>2];p=+g[b+52>>2];h=+g[b+56>>2];g[d>>2]=t-(o*w+m*v+k*u);g[d+4>>2]=p-(o*s+m*r+k*q);g[d+8>>2]=h-(o*n+m*l+k*j);g[d+12>>2]=0.0;g[e>>2]=o*w+m*v+k*u+t;g[e+4>>2]=o*s+m*r+k*q+p;g[e+8>>2]=o*n+m*l+k*j+h;g[e+12>>2]=0.0;i=f;return}function vx(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0,h=0.0,j=0,k=0.0,l=0.0;e=i;i=i+16|0;c[e+0>>2]=c[a+28>>2];c[e+4>>2]=c[a+32>>2];c[e+8>>2]=c[a+36>>2];c[e+12>>2]=c[a+40>>2];l=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);g[e>>2]=l+ +g[e>>2];g[e+4>>2]=h+ +g[e+4>>2];g[e+8>>2]=k+ +g[e+8>>2];a=c[a+52>>2]|0;if((a|0)==2){f=2;j=0}else if(!a){f=0;j=1}else{f=1;j=0}h=+g[e+(j<<2)>>2];k=+g[e+(f<<2)>>2];k=b*.25*h*h+b/12.0*k*k*4.0;if(!a){g[d>>2]=b*.5*h*h;g[d+4>>2]=k;g[d+8>>2]=k;g[d+12>>2]=0.0;i=e;return}else if((a|0)==2){g[d>>2]=k;g[d+4>>2]=k;g[d+8>>2]=b*.5*h*h;g[d+12>>2]=0.0;i=e;return}else{g[d>>2]=k;g[d+4>>2]=b*.5*h*h;g[d+8>>2]=k;g[d+12>>2]=0.0;i=e;return}}function wx(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;e=+g[b+32>>2];k=+g[b+28>>2];j=+g[c+4>>2];h=+g[c+8>>2];f=+Q(+(j*j+h*h));if(f!=0.0){g[a+4>>2]=j*(e/f);if(+g[c>>2]<0.0)k=-k;g[a>>2]=k;g[a+8>>2]=h*(e/f);i=d;return}else{g[a+4>>2]=e;if(+g[c>>2]<0.0)k=-k;g[a>>2]=k;g[a+8>>2]=0.0;i=d;return}}function xx(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;e=+g[b+28>>2];k=+g[b+36>>2];j=+g[c>>2];h=+g[c+4>>2];f=+Q(+(j*j+h*h));if(f!=0.0){g[a>>2]=j*(e/f);if(+g[c+8>>2]<0.0)k=-k;g[a+8>>2]=k;g[a+4>>2]=h*(e/f);i=d;return}else{g[a>>2]=e;if(+g[c+8>>2]<0.0)k=-k;g[a+8>>2]=k;g[a+4>>2]=0.0;i=d;return}}function yx(a,b,c){a=a|0;b=b|0;c=c|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;e=+g[b+28>>2];k=+g[b+32>>2];j=+g[c>>2];h=+g[c+8>>2];f=+Q(+(j*j+h*h));if(f!=0.0){g[a>>2]=j*(e/f);if(+g[c+4>>2]<0.0)k=-k;g[a+4>>2]=k;g[a+8>>2]=h*(e/f);i=d;return}else{g[a>>2]=e;if(+g[c+4>>2]<0.0)k=-k;g[a+4>>2]=k;g[a+8>>2]=0.0;i=d;return}}function zx(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;f=i;if((d|0)<=0){i=f;return}e=0;do{j=+g[a+28>>2];m=+g[a+32>>2];h=+g[b+(e<<4)>>2];k=+g[b+(e<<4)+8>>2];l=+Q(+(h*h+k*k));if(!(l!=0.0))if(+g[b+(e<<4)+4>>2]<0.0){h=j;m=-m;j=0.0}else{h=j;j=0.0}else{if(+g[b+(e<<4)+4>>2]<0.0)m=-m;h=h*(j/l);j=k*(j/l)}g[c+(e<<4)>>2]=h;g[c+(e<<4)+4>>2]=m;g[c+(e<<4)+8>>2]=j;e=e+1|0}while((e|0)!=(d|0));i=f;return}function Ax(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;f=i;if((d|0)<=0){i=f;return}e=0;do{m=+g[a+28>>2];j=+g[a+36>>2];h=+g[b+(e<<4)>>2];l=+g[b+(e<<4)+4>>2];k=+Q(+(h*h+l*l));if(!(k!=0.0))if(+g[b+(e<<4)+8>>2]<0.0){h=m;k=0.0;j=-j}else{h=m;k=0.0}else{if(+g[b+(e<<4)+8>>2]<0.0)j=-j;h=h*(m/k);k=l*(m/k)}g[c+(e<<4)>>2]=h;g[c+(e<<4)+4>>2]=k;g[c+(e<<4)+8>>2]=j;e=e+1|0}while((e|0)!=(d|0));i=f;return}function Bx(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0;f=i;if((d|0)<=0){i=f;return}e=0;do{h=+g[a+32>>2];m=+g[a+28>>2];n=b+(e<<4)|0;l=+g[b+(e<<4)+4>>2];j=+g[b+(e<<4)+8>>2];k=+Q(+(l*l+j*j));if(!(k!=0.0))if(+g[n>>2]<0.0){m=-m;l=h;h=0.0}else{l=h;h=0.0}else{if(+g[n>>2]<0.0)m=-m;l=l*(h/k);h=j*(h/k)}g[c+(e<<4)>>2]=m;g[c+(e<<4)+4>>2]=l;g[c+(e<<4)+8>>2]=h;e=e+1|0}while((e|0)!=(d|0));i=f;return}function Cx(a){a=a|0;return}function Dx(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Ex(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0;d=i;m=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);o=(m+ +g[a+28>>2])/+g[a+12>>2];l=(j+ +g[a+32>>2])/+g[a+16>>2];h=(e+ +g[a+36>>2])/+g[a+20>>2];n=+P(+(+g[b>>2]));k=+P(+(+g[b+4>>2]));f=+P(+(+g[b+8>>2]));g[a+12>>2]=n;g[a+16>>2]=k;g[a+20>>2]=f;g[a+24>>2]=0.0;g[a+28>>2]=o*n-m;g[a+32>>2]=l*k-j;g[a+36>>2]=h*f-e;g[a+40>>2]=0.0;i=d;return}function Fx(a){a=a|0;return 11408}function Gx(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;g[a+(c[b+52>>2]<<2)>>2]=1.0;i=d;return}function Hx(a,b){a=a|0;b=+b;var d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0;d=i;j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);f=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=j+ +g[a+28>>2];f=f+ +g[a+32>>2];k=k+ +g[a+36>>2];g[a+44>>2]=b;h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);e=+$b[c[(c[a>>2]|0)+48>>2]&15](a);b=k- +$b[c[(c[a>>2]|0)+48>>2]&15](a);g[a+28>>2]=j-h;g[a+32>>2]=f-e;g[a+36>>2]=b;g[a+40>>2]=0.0;i=d;return}function Ix(a){a=a|0;return 60}function Jx(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=h;if(h)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+28>>2]=+g[a+28>>2];g[b+32>>2]=+g[a+32>>2];g[b+36>>2]=+g[a+36>>2];g[b+40>>2]=+g[a+40>>2];g[b+12>>2]=+g[a+12>>2];g[b+16>>2]=+g[a+16>>2];g[b+20>>2]=+g[a+20>>2];g[b+24>>2]=+g[a+24>>2];g[b+44>>2]=+g[a+44>>2];c[b+52>>2]=c[a+52>>2];i=e;return 11384}function Kx(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);if(!(+$b[c[(c[b>>2]|0)+48>>2]&15](b)!=0.0)){i=e;return}l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function Lx(a){a=a|0;var b=0.0,d=0.0,e=0;e=i;d=+g[a+28>>2];b=+$b[c[(c[a>>2]|0)+48>>2]&15](a);+$b[c[(c[a>>2]|0)+48>>2]&15](a);+$b[c[(c[a>>2]|0)+48>>2]&15](a);i=e;return+(d+b)}function Mx(a){a=a|0;return}function Nx(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Ox(a){a=a|0;return 11368}function Px(a){a=a|0;var b=0.0,d=0.0,e=0;e=i;d=+g[a+32>>2];+$b[c[(c[a>>2]|0)+48>>2]&15](a);b=+$b[c[(c[a>>2]|0)+48>>2]&15](a);+$b[c[(c[a>>2]|0)+48>>2]&15](a);i=e;return+(d+b)}function Qx(a){a=a|0;return}function Rx(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Sx(a){a=a|0;return 11352}function Tx(a){a=a|0;var b=0.0,d=0.0,e=0;e=i;d=+g[a+28>>2];b=+$b[c[(c[a>>2]|0)+48>>2]&15](a);+$b[c[(c[a>>2]|0)+48>>2]&15](a);+$b[c[(c[a>>2]|0)+48>>2]&15](a);i=e;return+(d+b)}function Ux(b){b=b|0;var d=0,e=0;d=i;e=c[b>>2]|0;if(e)Vx(b,e);e=c[b+4>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+4>>2]=0;c[b+8>>2]=-1;e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;c[b+16>>2]=0;e=c[b+52>>2]|0;if(!e){a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;i=d;return}if(!(a[b+56>>0]|0)){a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;i=d;return}c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);e=c[b+32>>2]|0;a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;if(!e){a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;i=d;return}if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0;a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;i=d;return}function Vx(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;if(c[b+40>>2]|0){Vx(a,c[b+36>>2]|0);Vx(a,c[b+40>>2]|0)}if((c[a>>2]|0)==(b|0))c[a>>2]=0;e=c[a+4>>2]|0;if(!e){c[a+4>>2]=b;i=d;return}c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);c[a+4>>2]=b;i=d;return}function Wx(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;d=i;i=i+32|0;if((b|0)<0)b=c[a+12>>2]|0;j=c[a>>2]|0;if(!((j|0)!=0&(b|0)>0)){i=d;return}while(1){f=j+40|0;a:do if(c[f>>2]|0){e=0;while(1){g=(c[a+16>>2]|0)>>>e&1;k=j+32|0;h=c[k>>2]|0;if(h>>>0>j>>>0){l=(c[h+40>>2]|0)==(j|0)&1;m=c[h+((l^1)<<2)+36>>2]|0;n=c[h+32>>2]|0;if(!n)c[a>>2]=j;else c[n+(((c[n+40>>2]|0)==(h|0)&1)<<2)+36>>2]=j;c[m+32>>2]=j;c[h+32>>2]=j;c[k>>2]=n;n=j+36|0;c[h+36>>2]=c[n>>2];c[h+40>>2]=c[f>>2];c[(c[n>>2]|0)+32>>2]=h;c[(c[f>>2]|0)+32>>2]=h;c[j+(l<<2)+36>>2]=h;c[j+((l^1)<<2)+36>>2]=m;c[d+0>>2]=c[h+0>>2];c[d+4>>2]=c[h+4>>2];c[d+8>>2]=c[h+8>>2];c[d+12>>2]=c[h+12>>2];c[d+16>>2]=c[h+16>>2];c[d+20>>2]=c[h+20>>2];c[d+24>>2]=c[h+24>>2];c[d+28>>2]=c[h+28>>2];c[h+0>>2]=c[j+0>>2];c[h+4>>2]=c[j+4>>2];c[h+8>>2]=c[j+8>>2];c[h+12>>2]=c[j+12>>2];c[h+16>>2]=c[j+16>>2];c[h+20>>2]=c[j+20>>2];c[h+24>>2]=c[j+24>>2];c[h+28>>2]=c[j+28>>2];c[j+0>>2]=c[d+0>>2];c[j+4>>2]=c[d+4>>2];c[j+8>>2]=c[d+8>>2];c[j+12>>2]=c[d+12>>2];c[j+16>>2]=c[d+16>>2];c[j+20>>2]=c[d+20>>2];c[j+24>>2]=c[d+24>>2];c[j+28>>2]=c[d+28>>2]}else h=j;j=c[h+(g<<2)+36>>2]|0;if(!(c[j+40>>2]|0))break a;f=j+40|0;e=e+1&31}}while(0);if(!(Yx(a,j)|0))e=0;else e=c[a>>2]|0;Xx(a,e,j);c[a+16>>2]=(c[a+16>>2]|0)+1;b=b+ -1|0;if(!b)break;j=c[a>>2]|0}i=d;return}function Xx(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0,l=0.0,m=0.0,n=0.0,o=0,p=0.0,q=0,r=0,s=0.0;e=i;if(!(c[a>>2]|0)){c[a>>2]=d;c[d+32>>2]=0;i=e;return}f=c[b+40>>2]|0;if(f){l=+g[d>>2]+ +g[d+16>>2];j=+g[d+4>>2]+ +g[d+20>>2];h=+g[d+8>>2]+ +g[d+24>>2];do{r=c[b+36>>2]|0;p=+P(+(l-(+g[r>>2]+ +g[r+16>>2])))+ +P(+(j-(+g[r+4>>2]+ +g[r+20>>2])))+ +P(+(h-(+g[r+8>>2]+ +g[r+24>>2])));b=c[b+((!(p<+P(+(l-(+g[f>>2]+ +g[f+16>>2])))+ +P(+(j-(+g[f+4>>2]+ +g[f+20>>2])))+ +P(+(h-(+g[f+8>>2]+ +g[f+24>>2]))))&1)<<2)+36>>2]|0;f=c[b+40>>2]|0}while((f|0)!=0)}k=b+32|0;f=c[k>>2]|0;r=c[a+4>>2]|0;if(!r){c[5004]=(c[5004]|0)+1;r=fF(63)|0;if((r|0)!=0?(c[(r+19&-16)+ -4>>2]=r,(r+19&-16|0)!=0):0){o=(r+19&-16)+0|0;q=o+44|0;do{c[o>>2]=0;o=o+4|0}while((o|0)<(q|0));r=r+19&-16}else r=0}else c[a+4>>2]=0;c[r+32>>2]=f;o=r+36|0;c[o>>2]=0;q=r+40|0;c[q>>2]=0;s=+g[d>>2];p=+g[b>>2];p=s<p?s:p;g[r>>2]=p;s=+g[d+16>>2];l=+g[b+16>>2];l=s>l?s:l;g[r+16>>2]=l;s=+g[d+4>>2];n=+g[b+4>>2];n=s<n?s:n;g[r+4>>2]=n;s=+g[d+20>>2];j=+g[b+20>>2];j=s>j?s:j;g[r+20>>2]=j;s=+g[d+8>>2];m=+g[b+8>>2];m=s<m?s:m;g[r+8>>2]=m;s=+g[d+24>>2];h=+g[b+24>>2];h=s>h?s:h;g[r+24>>2]=h;if(!f){c[o>>2]=b;c[k>>2]=r;c[q>>2]=d;c[d+32>>2]=r;c[a>>2]=r;i=e;return}c[f+(((c[(c[k>>2]|0)+40>>2]|0)==(b|0)&1)<<2)+36>>2]=r;c[o>>2]=b;c[k>>2]=r;c[q>>2]=d;c[d+32>>2]=r;while(1){d=f+4|0;if(((((+g[f>>2]<=p?+g[d>>2]<=n:0)?+g[f+8>>2]<=m:0)?+g[f+16>>2]>=l:0)?+g[f+20>>2]>=j:0)?+g[f+24>>2]>=h:0){d=21;break}q=c[f+36>>2]|0;r=c[f+40>>2]|0;s=+g[q>>2];p=+g[r>>2];p=s<p?s:p;g[f>>2]=p;s=+g[q+16>>2];l=+g[r+16>>2];l=s>l?s:l;g[f+16>>2]=l;s=+g[q+4>>2];n=+g[r+4>>2];n=s<n?s:n;g[d>>2]=n;s=+g[q+20>>2];j=+g[r+20>>2];j=s>j?s:j;g[f+20>>2]=j;s=+g[q+8>>2];m=+g[r+8>>2];m=s<m?s:m;g[f+8>>2]=m;s=+g[q+24>>2];h=+g[r+24>>2];h=s>h?s:h;g[f+24>>2]=h;f=c[f+32>>2]|0;if(!f){d=21;break}}if((d|0)==21){i=e;return}}function Yx(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0,x=0,y=0,z=0,A=0;d=i;if((c[a>>2]|0)==(b|0)){c[a>>2]=0;b=0;i=d;return b|0}f=c[b+32>>2]|0;h=c[f+32>>2]|0;b=c[f+(((c[f+40>>2]|0)!=(b|0)&1)<<2)+36>>2]|0;if(!h){c[a>>2]=b;c[b+32>>2]=0;e=c[a+4>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[a+4>>2]=f;b=c[a>>2]|0;i=d;return b|0}c[h+(((c[h+40>>2]|0)==(f|0)&1)<<2)+36>>2]=b;c[b+32>>2]=h;b=c[a+4>>2]|0;if(b){c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0)}c[a+4>>2]=f;do{u=+g[h>>2];z=h+4|0;s=+g[z>>2];x=h+8|0;q=+g[x>>2];A=h+16|0;o=+g[A>>2];y=h+20|0;m=+g[y>>2];b=h+24|0;k=+g[b>>2];w=c[h+36>>2]|0;f=c[h+40>>2]|0;v=+g[w>>2];t=+g[f>>2];t=v<t?v:t;g[h>>2]=t;v=+g[w+16>>2];n=+g[f+16>>2];n=v>n?v:n;g[A>>2]=n;v=+g[w+4>>2];r=+g[f+4>>2];r=v<r?v:r;g[z>>2]=r;v=+g[w+20>>2];l=+g[f+20>>2];l=v>l?v:l;g[y>>2]=l;v=+g[w+8>>2];p=+g[f+8>>2];p=v<p?v:p;g[x>>2]=p;v=+g[w+24>>2];j=+g[f+24>>2];j=v>j?v:j;g[b>>2]=j;if(!(u!=t|s!=r|q!=p|o!=n)?!(m!=l|k!=j):0){e=14;break}h=c[h+32>>2]|0}while((h|0)!=0);if((e|0)==14){i=d;return h|0}A=c[a>>2]|0;i=d;return A|0}function Zx(b,d){b=b|0;d=d|0;var e=0,f=0;e=i;c[b>>2]=11432;f=b+4|0;do{a[f+36>>0]=1;c[f+32>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;a[f+56>>0]=1;c[f+52>>2]=0;c[f+44>>2]=0;c[f+48>>2]=0;c[f>>2]=0;c[f+4>>2]=0;c[f+8>>2]=-1;c[f+12>>2]=0;c[f+16>>2]=0;f=f+60|0}while((f|0)!=(b+124|0));a[b+193>>0]=0;a[b+194>>0]=1;a[b+192>>0]=(d|0)!=0^1;g[b+140>>2]=0.0;c[b+144>>2]=0;c[b+164>>2]=0;c[b+148>>2]=1;c[b+152>>2]=0;c[b+156>>2]=10;c[b+160>>2]=1;c[b+168>>2]=0;c[b+172>>2]=0;g[b+176>>2]=0.0;if(d){f=b+136|0;c[f>>2]=d;f=b+188|0;c[f>>2]=0;f=b+180|0;c[f>>2]=0;f=b+184|0;c[f>>2]=0;f=b+124|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;i=e;return}c[5004]=(c[5004]|0)+1;d=fF(95)|0;if((d|0)!=0?(c[(d+19&-16)+ -4>>2]=d,(d+19&-16|0)!=0):0){Yz(d+19&-16);d=d+19&-16}else d=0;f=b+136|0;c[f>>2]=d;f=b+188|0;c[f>>2]=0;f=b+180|0;c[f>>2]=0;f=b+184|0;c[f>>2]=0;f=b+124|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;i=e;return}function _x(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=11432;if((a[b+192>>0]|0)!=0?(e=c[b+136>>2]|0,Lb[c[c[e>>2]>>2]&511](e),e=c[b+136>>2]|0,(e|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=b+124|0;do{e=e+ -60|0;Ux(e)}while((e|0)!=(b+4|0));gF(b);i=d;return}function $x(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=11432;if((a[b+192>>0]|0)!=0?(e=c[b+136>>2]|0,Lb[c[c[e>>2]>>2]&511](e),e=c[b+136>>2]|0,(e|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=b+124|0;do{e=e+ -60|0;Ux(e)}while((e|0)!=(b+4|0));i=d;return}function ay(d,e,f,g,h,j,k,l,m){d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;m=i;i=i+48|0;c[5004]=(c[5004]|0)+1;g=fF(83)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}c[g>>2]=h;b[g+4>>1]=j;b[g+6>>1]=k;h=g+16|0;c[h+0>>2]=c[e+0>>2];c[h+4>>2]=c[e+4>>2];c[h+8>>2]=c[e+8>>2];c[h+12>>2]=c[e+12>>2];h=g+32|0;c[h+0>>2]=c[f+0>>2];c[h+4>>2]=c[f+4>>2];c[h+8>>2]=c[f+8>>2];c[h+12>>2]=c[f+12>>2];c[g+8>>2]=0;h=g+56|0;c[h>>2]=0;j=g+52|0;c[j>>2]=0;c[m+16>>2]=c[e+0>>2];c[m+20>>2]=c[e+4>>2];c[m+24>>2]=c[e+8>>2];c[m+28>>2]=c[e+12>>2];c[m+32>>2]=c[f+0>>2];c[m+36>>2]=c[f+4>>2];c[m+40>>2]=c[f+8>>2];c[m+44>>2]=c[f+12>>2];c[g+60>>2]=c[d+144>>2];e=(c[d+188>>2]|0)+1|0;c[d+188>>2]=e;c[g+12>>2]=e;e=c[d+8>>2]|0;if(!e){c[5004]=(c[5004]|0)+1;e=fF(63)|0;if((e|0)!=0?(c[(e+19&-16)+ -4>>2]=e,(e+19&-16|0)!=0):0){k=(e+19&-16)+0|0;f=k+44|0;do{c[k>>2]=0;k=k+4|0}while((k|0)<(f|0));e=e+19&-16}else e=0}else c[d+8>>2]=0;c[e+32>>2]=0;c[e+36>>2]=g;c[e+40>>2]=0;c[e+0>>2]=c[m+16>>2];c[e+4>>2]=c[m+20>>2];c[e+8>>2]=c[m+24>>2];c[e+12>>2]=c[m+28>>2];c[e+16>>2]=c[m+32>>2];c[e+20>>2]=c[m+36>>2];c[e+24>>2]=c[m+40>>2];c[e+28>>2]=c[m+44>>2];Xx(d+4|0,c[d+4>>2]|0,e);c[d+16>>2]=(c[d+16>>2]|0)+1;c[g+48>>2]=e;e=d+(c[d+144>>2]<<2)+124|0;c[j>>2]=0;c[h>>2]=c[e>>2];f=c[e>>2]|0;if(f)c[f+52>>2]=g;c[e>>2]=g;if(a[d+193>>0]|0){i=m;return g|0}c[m>>2]=11696;c[m+4>>2]=d;c[m+8>>2]=g;by(c[d+4>>2]|0,m+16|0,m);by(c[d+64>>2]|0,m+16|0,m);i=m;return g|0}function by(a,b,d){a=a|0;b=b|0;d=d|0;var e=0.0,f=0,h=0,j=0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0,s=0,t=0,u=0,v=0,w=0;h=i;if(!a){i=h;return}e=+g[b>>2];n=+g[b+4>>2];o=+g[b+8>>2];k=+g[b+16>>2];m=+g[b+20>>2];p=+g[b+24>>2];c[5004]=(c[5004]|0)+1;q=fF(275)|0;if(q){c[(q+19&-16)+ -4>>2]=q;b=q+19&-16;if(q+19&-16)c[b>>2]=a}else b=0;t=64;a=1;do{r=a+ -1|0;q=c[b+(r<<2)>>2]|0;do if(((((+g[q>>2]<=k?+g[q+16>>2]>=e:0)?+g[q+4>>2]<=m:0)?+g[q+20>>2]>=n:0)?+g[q+8>>2]<=p:0)?+g[q+24>>2]>=o:0){if(!(c[q+40>>2]|0)){Nb[c[(c[d>>2]|0)+12>>2]&127](d,q);a=r;break}s=c[q+36>>2]|0;if((r|0)==(t|0)?(f=(t|0)==0?1:t<<1,(a|0)<=(f|0)):0){if((f|0)!=0?(c[5004]=(c[5004]|0)+1,l=fF((f<<2|3)+16|0)|0,(l|0)!=0):0){c[(l+19&-16)+ -4>>2]=l;u=l+19&-16}else u=0;if((t|0)>0){w=0;do{v=u+(w<<2)|0;if(v)c[v>>2]=c[b+(w<<2)>>2];w=w+1|0}while((w|0)!=(t|0))}if(!b){t=f;b=u}else{c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);t=f;b=u}}r=b+(r<<2)|0;if(r)c[r>>2]=s;q=c[q+40>>2]|0;if((a|0)==(t|0)){t=(a|0)==0?1:a<<1;if((a|0)<(t|0)){if((t|0)!=0?(c[5004]=(c[5004]|0)+1,j=fF((t<<2|3)+16|0)|0,(j|0)!=0):0){c[(j+19&-16)+ -4>>2]=j;r=j+19&-16}else r=0;if((a|0)>0){s=0;do{u=r+(s<<2)|0;if(u)c[u>>2]=c[b+(s<<2)>>2];s=s+1|0}while((s|0)!=(a|0))}if(!b)b=r;else{c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);b=r}}else t=a}r=b+(a<<2)|0;if(r)c[r>>2]=q;a=a+1|0}else a=r;while(0)}while((a|0)>0);if(!b){i=h;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=h;return}function cy(a){a=a|0;return}function dy(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0;f=i;if((c[d+60>>2]|0)==2){g=c[d+48>>2]|0;Yx(b+64|0,g)|0;h=c[b+68>>2]|0;if(h){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+68>>2]=g;c[b+76>>2]=(c[b+76>>2]|0)+ -1}else{g=c[d+48>>2]|0;Yx(b+4|0,g)|0;h=c[b+8>>2]|0;if(h){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+8>>2]=g;c[b+16>>2]=(c[b+16>>2]|0)+ -1}h=c[d+52>>2]|0;g=c[d+56>>2]|0;if(!h)c[b+(c[d+60>>2]<<2)+124>>2]=g;else c[h+56>>2]=g;g=c[d+56>>2]|0;if(g)c[g+52>>2]=c[d+52>>2];h=c[b+136>>2]|0;rc[c[(c[h>>2]|0)+16>>2]&127](h,d,e);if(!d){h=b+194|0;a[h>>0]=1;i=f;return}c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0);h=b+194|0;a[h>>0]=1;i=f;return}function ey(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;a=i;c[d+0>>2]=c[b+16>>2];c[d+4>>2]=c[b+20>>2];c[d+8>>2]=c[b+24>>2];c[d+12>>2]=c[b+28>>2];c[e+0>>2]=c[b+32>>2];c[e+4>>2]=c[b+36>>2];c[e+8>>2]=c[b+40>>2];c[e+12>>2]=c[b+44>>2];i=a;return}function fy(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;d=i;i=i+16|0;c[d>>2]=11616;c[d+4>>2]=e;gy(a+4|0,c[a+4>>2]|0,b,e+4|0,e+20|0,+g[e+32>>2],f,h,d);gy(a+64|0,c[a+64>>2]|0,b,e+4|0,e+20|0,+g[e+32>>2],f,h,d);i=d;return}function gy(b,d,e,f,h,j,k,l,m){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=+j;k=k|0;l=l|0;m=m|0;var n=0.0,o=0,p=0.0,q=0.0,r=0.0,s=0,t=0,u=0,v=0,w=0,x=0.0,y=0.0,z=0.0,A=0.0,B=0,C=0,D=0,E=0.0;o=i;i=i+32|0;if(!d){i=o;return}s=c[b+44>>2]|0;if((s|0)<128){if((c[b+48>>2]|0)<128){c[5004]=(c[5004]|0)+1;t=fF(531)|0;if(!t)t=0;else{c[(t+19&-16)+ -4>>2]=t;t=t+19&-16}v=c[b+44>>2]|0;if((v|0)>0){u=0;do{w=t+(u<<2)|0;if(w)c[w>>2]=c[(c[b+52>>2]|0)+(u<<2)>>2];u=u+1|0}while((u|0)!=(v|0))}u=c[b+52>>2]|0;if(u){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[u+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=t;c[b+48>>2]=128;t=b+52|0}else t=b+52|0;do{u=(c[t>>2]|0)+(s<<2)|0;if(u)c[u>>2]=0;s=s+1|0}while((s|0)!=128);s=b+48|0}else s=b+48|0;c[b+44>>2]=128;c[c[b+52>>2]>>2]=d;d=1;v=126;do{t=d+ -1|0;w=c[b+52>>2]|0;u=c[w+(t<<2)>>2]|0;y=+g[u+4>>2]- +g[l+4>>2];x=+g[u+8>>2]- +g[l+8>>2];g[o>>2]=+g[u>>2]- +g[l>>2];g[o+4>>2]=y;g[o+8>>2]=x;g[o+12>>2]=0.0;x=+g[u+20>>2]- +g[k+4>>2];y=+g[u+24>>2]- +g[k+8>>2];g[o+16>>2]=+g[u+16>>2]- +g[k>>2];g[o+20>>2]=x;g[o+24>>2]=y;g[o+28>>2]=0.0;D=c[h>>2]|0;y=+g[e>>2];x=+g[f>>2];z=(+g[o+(D<<4)>>2]-y)*x;y=x*(+g[o+(1-D<<4)>>2]-y);D=c[h+4>>2]|0;x=+g[e+4>>2];E=+g[f+4>>2];A=(+g[o+(D<<4)+4>>2]-x)*E;x=E*(+g[o+(1-D<<4)+4>>2]-x);do if(((!(z>x|A>y)?(p=A>z?A:z,r=x<y?x:y,D=c[h+8>>2]|0,q=+g[e+8>>2],E=+g[f+8>>2],n=(+g[o+(D<<4)+8>>2]-q)*E,q=E*(+g[o+(1-D<<4)+8>>2]-q),!(p>q|n>r)):0)?(n>p?n:p)<j:0)?(q<r?q:r)>0.0:0){if(!(c[u+40>>2]|0)){Nb[c[(c[m>>2]|0)+12>>2]&127](m,u);d=t;break}if((t|0)>(v|0)){v=c[b+44>>2]|0;if((v|0)<(v<<1|0)){if((c[s>>2]|0)<(v<<1|0)){if(v){c[5004]=(c[5004]|0)+1;w=fF((v<<3|3)+16|0)|0;if(!w)w=0;else{c[(w+19&-16)+ -4>>2]=w;w=w+19&-16}C=c[b+44>>2]|0;if((C|0)>0){B=0;do{D=w+(B<<2)|0;if(D)c[D>>2]=c[(c[b+52>>2]|0)+(B<<2)>>2];B=B+1|0}while((B|0)!=(C|0))}}else w=0;B=c[b+52>>2]|0;if(B){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[B+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=w;c[s>>2]=v<<1;B=v}else B=v;do{w=w+(B<<2)|0;if(w)c[w>>2]=0;B=B+1|0;w=c[b+52>>2]|0}while((B|0)!=(v<<1|0))}c[b+44>>2]=v<<1;v=(v<<1)+ -2|0}c[w+(t<<2)>>2]=c[u+36>>2];c[(c[b+52>>2]|0)+(d<<2)>>2]=c[u+40>>2];d=d+1|0}else d=t;while(0)}while((d|0)!=0);i=o;return}function hy(a){a=a|0;return}function iy(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+48|0;c[f+32>>2]=11536;c[f+36>>2]=e;c[f+0>>2]=c[b+0>>2];c[f+4>>2]=c[b+4>>2];c[f+8>>2]=c[b+8>>2];c[f+12>>2]=c[b+12>>2];c[f+16>>2]=c[d+0>>2];c[f+20>>2]=c[d+4>>2];c[f+24>>2]=c[d+8>>2];c[f+28>>2]=c[d+12>>2];by(c[a+4>>2]|0,f,f+32|0);by(c[a+64>>2]|0,f,f+32|0);i=f;return}function jy(a){a=a|0;return}function ky(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0.0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0,E=0,F=0,G=0,H=0.0;h=i;i=i+16|0;r=+g[e>>2];p=+g[e+4>>2];n=+g[e+8>>2];k=+g[e+12>>2];q=+g[f>>2];o=+g[f+4>>2];m=+g[f+8>>2];j=+g[f+12>>2];do if((c[d+60>>2]|0)==2){D=c[d+48>>2]|0;Yx(b+64|0,D)|0;l=c[b+68>>2]|0;if(l){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[b+68>>2]=D;c[b+76>>2]=(c[b+76>>2]|0)+ -1;l=c[b+8>>2]|0;if(!l){c[5004]=(c[5004]|0)+1;D=fF(63)|0;if((D|0)!=0?(c[(D+19&-16)+ -4>>2]=D,(D+19&-16|0)!=0):0){E=(D+19&-16)+0|0;l=E+44|0;do{c[E>>2]=0;E=E+4|0}while((E|0)<(l|0));l=D+19&-16}else l=0}else c[b+8>>2]=0;c[l+32>>2]=0;c[l+36>>2]=d;c[l+40>>2]=0;g[l>>2]=r;g[l+4>>2]=p;g[l+8>>2]=n;g[l+12>>2]=k;g[l+16>>2]=q;g[l+20>>2]=o;g[l+24>>2]=m;g[l+28>>2]=j;Xx(b+4|0,c[b+4>>2]|0,l);c[b+16>>2]=(c[b+16>>2]|0)+1;c[d+48>>2]=l;l=1}else{c[b+168>>2]=(c[b+168>>2]|0)+1;l=c[d+48>>2]|0;y=+g[l>>2];if(((((y<=q?(s=+g[l+16>>2],s>=r):0)?(t=+g[l+4>>2],t<=o):0)?(w=+g[l+20>>2],w>=p):0)?(u=+g[l+8>>2],u<=m):0)?(v=+g[l+24>>2],v>=n):0){H=+g[d+16>>2];C=+g[d+20>>2];B=+g[d+24>>2];x=+g[b+140>>2];z=(+g[d+32>>2]-H)*.5*x;A=x*(+g[d+36>>2]-C)*.5;x=x*(+g[d+40>>2]-B)*.5;if(r-H<0.0)z=-z;if(p-C<0.0)A=-A;if(n-B<0.0)x=-x;if(!(!(y<=r)|!(t<=p)|!(u<=n)|!(s>=q)|!(w>=o)|!(v>=m))){l=0;break}if(z>0.0){r=r+-.05000000074505806;q=z+(q+.05000000074505806)}else{r=z+(r+-.05000000074505806);q=q+.05000000074505806}if(A>0.0){p=p+-.05000000074505806;o=A+(o+.05000000074505806)}else{p=A+(p+-.05000000074505806);o=o+.05000000074505806}if(x>0.0){n=n+-.05000000074505806;m=x+(m+.05000000074505806)}else{n=x+(n+-.05000000074505806);m=m+.05000000074505806}F=Yx(b+4|0,l)|0;a:do if(F){D=c[b+12>>2]|0;if((D|0)<=-1){F=c[b+4>>2]|0;break}if((D|0)>0){E=0;while(1){G=c[F+32>>2]|0;E=E+1|0;if(!G)break a;if((E|0)>=(D|0)){F=G;break}else F=G}}}else F=0;while(0);g[l>>2]=r;g[l+4>>2]=p;g[l+8>>2]=n;g[l+12>>2]=k;g[l+16>>2]=q;g[l+20>>2]=o;g[l+24>>2]=m;g[l+28>>2]=j;Xx(b+4|0,F,l);c[b+172>>2]=(c[b+172>>2]|0)+1;l=1;break}F=Yx(b+4|0,l)|0;b:do if(F){D=c[b+12>>2]|0;if((D|0)<=-1){F=c[b+4>>2]|0;break}if((D|0)>0){E=0;while(1){G=c[F+32>>2]|0;E=E+1|0;if(!G)break b;if((E|0)>=(D|0)){F=G;break}else F=G}}}else F=0;while(0);g[l>>2]=r;g[l+4>>2]=p;g[l+8>>2]=n;g[l+12>>2]=k;g[l+16>>2]=q;g[l+20>>2]=o;g[l+24>>2]=m;g[l+28>>2]=j;Xx(b+4|0,F,l);c[b+172>>2]=(c[b+172>>2]|0)+1;l=1}while(0);D=c[d+52>>2]|0;E=c[d+56>>2]|0;if(!D)c[b+(c[d+60>>2]<<2)+124>>2]=E;else c[D+56>>2]=E;D=c[d+56>>2]|0;if(D)c[D+52>>2]=c[d+52>>2];c[d+16>>2]=c[e+0>>2];c[d+20>>2]=c[e+4>>2];c[d+24>>2]=c[e+8>>2];c[d+28>>2]=c[e+12>>2];c[d+32>>2]=c[f+0>>2];c[d+36>>2]=c[f+4>>2];c[d+40>>2]=c[f+8>>2];c[d+44>>2]=c[f+12>>2];c[d+60>>2]=c[b+144>>2];f=b+(c[b+144>>2]<<2)+124|0;c[d+52>>2]=0;c[d+56>>2]=c[f>>2];e=c[f>>2]|0;if(e)c[e+52>>2]=d;c[f>>2]=d;if(!l){i=h;return}a[b+194>>0]=1;if(a[b+193>>0]|0){i=h;return}c[h>>2]=11696;c[h+4>>2]=b;ly(b+64|0,c[b+64>>2]|0,c[d+48>>2]|0,h);ly(b+4|0,c[b+4>>2]|0,c[d+48>>2]|0,h);i=h;return}function ly(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0;h=i;if((d|0)==0|(e|0)==0){i=h;return}if((c[b+24>>2]|0)<128?(c[b+28>>2]|0)<128:0){c[5004]=(c[5004]|0)+1;j=fF(1043)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}m=c[b+24>>2]|0;if((m|0)>0){l=0;do{k=j+(l<<3)|0;if(k){p=(c[b+32>>2]|0)+(l<<3)|0;q=c[p+4>>2]|0;c[k>>2]=c[p>>2];c[k+4>>2]=q}l=l+1|0}while((l|0)!=(m|0))}k=c[b+32>>2]|0;if(k){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=j;c[b+28>>2]=128;j=b+28|0}else j=b+28|0;c[b+24>>2]=128;m=c[b+32>>2]|0;c[m>>2]=d;c[m+4>>2]=e;e=1;m=124;do{l=e+ -1|0;o=c[b+32>>2]|0;k=c[o+(l<<3)>>2]|0;d=c[o+(l<<3)+4>>2]|0;if((l|0)>(m|0)){m=c[b+24>>2]|0;if((m|0)<(m<<1|0)?(c[j>>2]|0)<(m<<1|0):0){if(m){c[5004]=(c[5004]|0)+1;n=fF((m<<4|3)+16|0)|0;if(!n)q=0;else{c[(n+19&-16)+ -4>>2]=n;q=n+19&-16}o=c[b+24>>2]|0;if((o|0)>0){n=0;do{p=q+(n<<3)|0;if(p){s=(c[b+32>>2]|0)+(n<<3)|0;r=c[s+4>>2]|0;c[p>>2]=c[s>>2];c[p+4>>2]=r}n=n+1|0}while((n|0)!=(o|0));o=q}else o=q}else o=0;n=c[b+32>>2]|0;if(n){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[n+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=o;c[j>>2]=m<<1}c[b+24>>2]=m<<1;m=(m<<1)+ -4|0}do if((k|0)==(d|0))if(!(c[k+40>>2]|0))e=l;else{r=c[k+36>>2]|0;s=o+(l<<3)|0;c[s>>2]=r;c[s+4>>2]=r;s=c[k+40>>2]|0;r=(c[b+32>>2]|0)+(e<<3)|0;c[r>>2]=s;c[r+4>>2]=s;r=c[k+40>>2]|0;s=(c[b+32>>2]|0)+(e+1<<3)|0;c[s>>2]=c[k+36>>2];c[s+4>>2]=r;e=e+2|0}else if(((((+g[k>>2]<=+g[d+16>>2]?+g[k+16>>2]>=+g[d>>2]:0)?+g[k+4>>2]<=+g[d+20>>2]:0)?+g[k+20>>2]>=+g[d+4>>2]:0)?+g[k+8>>2]<=+g[d+24>>2]:0)?+g[k+24>>2]>=+g[d+8>>2]:0){n=(c[d+40>>2]|0)!=0;if(!(c[k+40>>2]|0))if(n){s=c[d+36>>2]|0;r=o+(l<<3)|0;c[r>>2]=k;c[r+4>>2]=s;r=c[d+40>>2]|0;s=(c[b+32>>2]|0)+(e<<3)|0;c[s>>2]=k;c[s+4>>2]=r;e=e+1|0;break}else{rc[c[(c[f>>2]|0)+8>>2]&127](f,k,d);e=l;break}else{l=o+(l<<3)|0;o=c[k+36>>2]|0;if(n){r=c[d+36>>2]|0;c[l>>2]=o;c[l+4>>2]=r;r=c[d+36>>2]|0;s=(c[b+32>>2]|0)+(e<<3)|0;c[s>>2]=c[k+40>>2];c[s+4>>2]=r;s=c[d+40>>2]|0;r=(c[b+32>>2]|0)+(e+1<<3)|0;c[r>>2]=c[k+36>>2];c[r+4>>2]=s;r=c[d+40>>2]|0;s=(c[b+32>>2]|0)+(e+2<<3)|0;c[s>>2]=c[k+40>>2];c[s+4>>2]=r;e=e+3|0;break}else{c[l>>2]=o;c[l+4>>2]=d;s=(c[b+32>>2]|0)+(e<<3)|0;c[s>>2]=c[k+40>>2];c[s+4>>2]=d;e=e+1|0;break}}}else e=l;while(0)}while((e|0)!=0);i=h;return}function my(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;e=i;i=i+48|0;Wx(b+4|0,((aa(c[b+152>>2]|0,c[b+16>>2]|0)|0)/100|0)+1|0);if(c[b+164>>2]|0){p=((aa(c[b+148>>2]|0,c[b+76>>2]|0)|0)/100|0)+1|0;Wx(b+64|0,p);p=(c[b+164>>2]|0)-p|0;c[b+164>>2]=(p|0)<0?0:p}l=((c[b+144>>2]|0)+1|0)%2|0;c[b+144>>2]=l;l=c[b+(l<<2)+124>>2]|0;if(l){do{m=l+56|0;k=l;l=c[m>>2]|0;n=c[k+52>>2]|0;if(!n)c[b+(c[k+60>>2]<<2)+124>>2]=l;else c[n+56>>2]=l;n=c[m>>2]|0;if(n)c[n+52>>2]=c[k+52>>2];c[k+52>>2]=0;c[m>>2]=c[b+132>>2];m=c[b+132>>2]|0;if(m)c[m+52>>2]=k;c[b+132>>2]=k;n=c[k+48>>2]|0;Yx(b+4|0,n)|0;m=c[b+8>>2]|0;if(m){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+8>>2]=n;c[b+16>>2]=(c[b+16>>2]|0)+ -1;c[e+16>>2]=c[k+16>>2];c[e+20>>2]=c[k+20>>2];c[e+24>>2]=c[k+24>>2];c[e+28>>2]=c[k+28>>2];c[e+32>>2]=c[k+32>>2];c[e+36>>2]=c[k+36>>2];c[e+40>>2]=c[k+40>>2];c[e+44>>2]=c[k+44>>2];m=c[b+68>>2]|0;if(!m){c[5004]=(c[5004]|0)+1;m=fF(63)|0;if((m|0)!=0?(c[(m+19&-16)+ -4>>2]=m,(m+19&-16|0)!=0):0){o=(m+19&-16)+0|0;n=o+44|0;do{c[o>>2]=0;o=o+4|0}while((o|0)<(n|0));m=m+19&-16}else m=0}else c[b+68>>2]=0;c[m+32>>2]=0;c[m+36>>2]=k;c[m+40>>2]=0;c[m+0>>2]=c[e+16>>2];c[m+4>>2]=c[e+20>>2];c[m+8>>2]=c[e+24>>2];c[m+12>>2]=c[e+28>>2];c[m+16>>2]=c[e+32>>2];c[m+20>>2]=c[e+36>>2];c[m+24>>2]=c[e+40>>2];c[m+28>>2]=c[e+44>>2];Xx(b+64|0,c[b+64>>2]|0,m);c[b+76>>2]=(c[b+76>>2]|0)+1;c[k+48>>2]=m;c[k+60>>2]=2}while((l|0)!=0);c[b+164>>2]=c[b+76>>2];a[b+194>>0]=1}c[e>>2]=11696;c[e+4>>2]=b;if((a[b+193>>0]|0)!=0?(ly(b+4|0,c[b+4>>2]|0,c[b+64>>2]|0,e),(a[b+193>>0]|0)!=0):0){p=c[b+4>>2]|0;ly(b+4|0,p,p,e)}do if((a[b+194>>0]|0)!=0?(h=c[b+136>>2]|0,h=Pb[c[(c[h>>2]|0)+28>>2]&127](h)|0,j=c[h+4>>2]|0,(j|0)>0):0){l=(aa(c[b+156>>2]|0,j)|0)/100|0;p=c[b+160>>2]|0;l=(p|0)>(l|0)?p:l;l=(j|0)<(l|0)?j:l;if((l|0)>0){k=0;do{n=((c[b+184>>2]|0)+k|0)%(j|0)|0;o=c[h+12>>2]|0;m=c[o+(n<<4)>>2]|0;n=c[o+(n<<4)+4>>2]|0;o=c[m+48>>2]|0;p=c[n+48>>2]|0;if(!(((((+g[o>>2]<=+g[p+16>>2]?+g[o+16>>2]>=+g[p>>2]:0)?+g[o+4>>2]<=+g[p+20>>2]:0)?+g[o+20>>2]>=+g[p+4>>2]:0)?+g[o+8>>2]<=+g[p+24>>2]:0)?+g[o+24>>2]>=+g[p+8>>2]:0)){j=c[b+136>>2]|0;Tb[c[(c[j>>2]|0)+12>>2]&31](j,m,n,d)|0;j=c[h+4>>2]|0;k=k+ -1|0;l=l+ -1|0}k=k+1|0}while((k|0)<(l|0));if((j|0)<=0){c[b+184>>2]=0;break}}c[b+184>>2]=((c[b+184>>2]|0)+l|0)%(j|0)|0}while(0);c[b+180>>2]=(c[b+180>>2]|0)+1;c[b+160>>2]=1;a[b+194>>0]=0;h=c[b+168>>2]|0;if(!h){g[b+176>>2]=0.0;j=c[b+172>>2]|0}else{j=c[b+172>>2]|0;g[b+176>>2]=+(j>>>0)/+(h>>>0)}c[b+172>>2]=j>>>1;c[b+168>>2]=h>>>1;p=c[b+136>>2]|0;if(!(Pb[c[(c[p>>2]|0)+56>>2]&127](p)|0)){i=e;return}h=c[b+136>>2]|0;h=Pb[c[(c[h>>2]|0)+28>>2]&127](h)|0;m=c[h+4>>2]|0;if((m|0)>1){os(h,0,m+ -1|0);o=0;l=0;j=0;k=0;f=45}else{l=0;o=0;j=0;k=0}while(1){if((f|0)==45)m=c[h+4>>2]|0;if((j|0)>=(m|0))break;n=c[h+12>>2]|0;m=n+(j<<4)|0;f=c[m>>2]|0;n=n+(j<<4)+4|0;p=c[n>>2]|0;if((f|0)==(l|0))if((p|0)==(o|0))f=55;else f=49;else{l=f;f=49}if((f|0)==49){f=0;q=c[l+48>>2]|0;o=c[p+48>>2]|0;if(((((+g[q>>2]<=+g[o+16>>2]?+g[q+16>>2]>=+g[o>>2]:0)?+g[q+4>>2]<=+g[o+20>>2]:0)?+g[q+20>>2]>=+g[o+4>>2]:0)?+g[q+8>>2]<=+g[o+24>>2]:0)?+g[q+24>>2]>=+g[o+8>>2]:0)o=p;else{o=p;f=55}}if((f|0)==55){q=c[b+136>>2]|0;rc[c[(c[q>>2]|0)+32>>2]&127](q,m,d);c[m>>2]=0;c[n>>2]=0;k=k+1|0}j=j+1|0;f=45}if((m|0)>1){os(h,0,m+ -1|0);m=c[h+4>>2]|0}b=m-k|0;if((k|0)<0){if((c[h+8>>2]|0)<(b|0)){if((m|0)==(k|0))d=0;else{c[5004]=(c[5004]|0)+1;d=fF((b<<4|3)+16|0)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}k=c[h+4>>2]|0}if((k|0)>0){f=0;do{q=c[h+12>>2]|0;c[d+(f<<4)>>2]=c[q+(f<<4)>>2];c[d+(f<<4)+4>>2]=c[q+(f<<4)+4>>2];c[d+(f<<4)+8>>2]=c[q+(f<<4)+8>>2];c[d+(f<<4)+12>>2]=c[q+(f<<4)+12>>2];f=f+1|0}while((f|0)!=(k|0))}f=c[h+12>>2]|0;if(f){if(a[h+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[h+12>>2]=0}a[h+16>>0]=1;c[h+12>>2]=d;c[h+8>>2]=b;d=h+12|0}else d=h+12|0;do{p=(c[d>>2]|0)+(m<<4)|0;m=m+1|0;q=(m|0)==(b|0);c[p+0>>2]=0;c[p+4>>2]=0;c[p+8>>2]=0;c[p+12>>2]=0}while(!q)}c[h+4>>2]=b;i=e;return}function ny(a){a=a|0;return c[a+136>>2]|0}function oy(a){a=a|0;return c[a+136>>2]|0}function py(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0;e=i;f=c[a+4>>2]|0;a=c[a+64>>2]|0;do if(!f)if(!a){h=0.0;j=0.0;o=0.0;n=0.0;m=0.0;l=0.0;k=0.0;p=0.0}else{h=+g[a>>2];j=+g[a+4>>2];o=+g[a+8>>2];n=+g[a+12>>2];m=+g[a+16>>2];l=+g[a+20>>2];k=+g[a+24>>2];p=+g[a+28>>2]}else{h=+g[f>>2];if(!a){j=+g[f+4>>2];o=+g[f+8>>2];n=+g[f+12>>2];m=+g[f+16>>2];l=+g[f+20>>2];k=+g[f+24>>2];p=+g[f+28>>2];break}else{t=+g[a>>2];r=+g[f+16>>2];m=+g[a+16>>2];s=+g[f+4>>2];j=+g[a+4>>2];q=+g[f+20>>2];l=+g[a+20>>2];n=+g[f+8>>2];o=+g[a+8>>2];p=+g[f+24>>2];k=+g[a+24>>2];h=h<t?h:t;j=s<j?s:j;o=n<o?n:o;n=0.0;m=r>m?r:m;l=q>l?q:l;k=p>k?p:k;p=0.0;break}}while(0);g[b>>2]=h;g[b+4>>2]=j;g[b+8>>2]=o;g[b+12>>2]=n;g[d>>2]=m;g[d+4>>2]=l;g[d+8>>2]=k;g[d+12>>2]=p;i=e;return}function qy(b,d){b=b|0;d=d|0;var e=0;d=i;if((c[b+16>>2]|0)!=(0-(c[b+76>>2]|0)|0)){i=d;return}e=c[b+4>>2]|0;if(e)Vx(b+4|0,e);e=c[b+8>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+8>>2]=0;c[b+12>>2]=-1;e=c[b+36>>2]|0;if(e){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+28>>2]=0;c[b+32>>2]=0;c[b+20>>2]=0;e=c[b+64>>2]|0;if(e)Vx(b+64|0,e);e=c[b+68>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+68>>2]=0;c[b+72>>2]=-1;e=c[b+96>>2]|0;if(e){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=0;c[b+88>>2]=0;c[b+92>>2]=0;c[b+80>>2]=0;a[b+193>>0]=0;a[b+194>>0]=1;c[b+144>>2]=0;c[b+164>>2]=0;c[b+148>>2]=1;c[b+152>>2]=0;c[b+156>>2]=10;c[b+160>>2]=1;c[b+124>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;c[b+168>>2]=0;c[b+172>>2]=0;c[b+176>>2]=0;c[b+180>>2]=0;c[b+184>>2]=0;c[b+188>>2]=0;i=d;return}function ry(a){a=a|0;return}function sy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ty(a,b){a=a|0;b=b|0;var d=0;d=i;a=c[a+4>>2]|0;gc[c[(c[a>>2]|0)+8>>2]&31](a,c[b+36>>2]|0)|0;i=d;return}function uy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function vy(a,b){a=a|0;b=b|0;var d=0;d=i;a=c[a+4>>2]|0;gc[c[(c[a>>2]|0)+8>>2]&31](a,c[b+36>>2]|0)|0;i=d;return}function wy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function xy(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0;e=i;if((b|0)==(d|0)){i=e;return}f=c[(c[a+4>>2]|0)+136>>2]|0;Yb[c[(c[f>>2]|0)+8>>2]&31](f,c[b+36>>2]|0,c[d+36>>2]|0)|0;d=(c[a+4>>2]|0)+160|0;c[d>>2]=(c[d>>2]|0)+1;i=e;return}function yy(a,b){a=a|0;b=b|0;var d=0;d=i;rc[c[(c[a>>2]|0)+8>>2]&127](a,b,c[(c[a+8>>2]|0)+48>>2]|0);i=d;return}function zy(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0;e=i;c[b>>2]=11776;c[5004]=(c[5004]|0)+1;k=fF(379)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}g[k+308>>2]=9999999747378752.0e-20;l=k+332|0;a[l>>0]=a[l>>0]&-16;c[b+24>>2]=k;k=(c[d+20>>2]|0)==0;c[5004]=(c[5004]|0)+1;l=fF(23)|0;if(!l)m=0;else{c[(l+19&-16)+ -4>>2]=l;m=l+19&-16}l=(m|0)==0;if(k){if(l)m=0;else c[m>>2]=14576;c[b+28>>2]=m}else{if(l)m=0;else c[m>>2]=13248;c[b+28>>2]=m}c[5004]=(c[5004]|0)+1;k=fF(43)|0;if((k|0)!=0?(j=k+19&-16,c[j+ -4>>2]=k,(k+19&-16|0)!=0):0){m=c[b+24>>2]|0;n=c[b+28>>2]|0;a[j+4>>0]=0;c[(k+19&-16)>>2]=18792;c[j+16>>2]=0;c[j+20>>2]=3;c[j+12>>2]=m;c[j+8>>2]=n;j=k+19&-16}else j=0;c[b+32>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12784;j=j+19&-16}else j=0;c[b+36>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12680;j=j+19&-16}else j=0;c[b+40>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12592;j=j+19&-16}else j=0;c[b+44>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12496;j=j+19&-16}else j=0;c[b+48>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12400;j=j+19&-16}else j=0;c[b+52>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12320;j=j+19&-16}else j=0;c[b+56>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12224;j=j+19&-16}else j=0;c[b+60>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12128;j=j+19&-16}else j=0;c[b+76>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12128;j=j+19&-16}else j=0;c[b+80>>2]=j;a[j+4>>0]=1;c[5004]=(c[5004]|0)+1;j=fF(27)|0;if((j|0)!=0?(c[(j+19&-16)+ -4>>2]=j,(j+19&-16|0)!=0):0){a[(j+19&-16)+4>>0]=0;c[(j+19&-16)>>2]=12040;j=j+19&-16}else j=0;c[b+72>>2]=j;c[5004]=(c[5004]|0)+1;j=fF(35)|0;if((j|0)!=0?(h=j+19&-16,c[h+ -4>>2]=j,(j+19&-16|0)!=0):0){a[h+4>>0]=0;c[(j+19&-16)>>2]=11904;c[h+8>>2]=1;c[h+12>>2]=0;h=j+19&-16}else h=0;c[b+88>>2]=h;c[5004]=(c[5004]|0)+1;h=fF(35)|0;if((h|0)!=0?(f=h+19&-16,c[f+ -4>>2]=h,(h+19&-16|0)!=0):0){a[f+4>>0]=0;c[(h+19&-16)>>2]=11904;c[f+8>>2]=1;c[f+12>>2]=0;f=h+19&-16}else f=0;c[b+84>>2]=f;a[f+4>>0]=1;f=c[d+16>>2]|0;f=(f|0)<36?36:f;f=(f|0)>80?f:80;f=(f|0)>44?f:44;h=c[d>>2]|0;if(!h){a[b+12>>0]=1;c[5004]=(c[5004]|0)+1;h=fF(39)|0;do if(!h)h=0;else{l=h+19&-16;c[l+ -4>>2]=h;if(!(h+19&-16)){h=0;break}j=c[d+8>>2]|0;c[(h+19&-16)>>2]=772;c[l+4>>2]=j;c[5004]=(c[5004]|0)+1;j=fF((j*772|3)+16|0)|0;if(!j)k=0;else{c[(j+19&-16)+ -4>>2]=j;k=j+19&-16}c[l+16>>2]=k;c[l+12>>2]=k;j=c[l+4>>2]|0;c[l+8>>2]=j;if(j+ -1|0){n=c[(h+19&-16)>>2]|0;m=j+ -1|0;l=k;do{o=l;l=l+n|0;c[o>>2]=l;m=m+ -1|0}while((m|0)!=0);k=k+(aa(n,j+ -1|0)|0)|0}c[k>>2]=0;h=h+19&-16}while(0);c[b+8>>2]=h}else{a[b+12>>0]=0;c[b+8>>2]=h}h=c[d+4>>2]|0;if(h){a[b+20>>0]=0;c[b+16>>2]=h;i=e;return}a[b+20>>0]=1;c[5004]=(c[5004]|0)+1;h=fF(39)|0;do if(!h)d=0;else{j=h+19&-16;c[j+ -4>>2]=h;if(!(h+19&-16)){d=0;break}d=c[d+12>>2]|0;c[(h+19&-16)>>2]=f;c[j+4>>2]=d;d=aa(d,f)|0;c[5004]=(c[5004]|0)+1;d=fF(d+19|0)|0;if(!d)f=0;else{c[(d+19&-16)+ -4>>2]=d;f=d+19&-16}c[j+16>>2]=f;c[j+12>>2]=f;d=c[j+4>>2]|0;c[j+8>>2]=d;if(d+ -1|0){k=c[(h+19&-16)>>2]|0;j=d+ -1|0;l=f;do{o=l;l=l+k|0;c[o>>2]=l;j=j+ -1|0}while((j|0)!=0);f=f+(aa(k,d+ -1|0)|0)|0}c[f>>2]=0;d=h+19&-16}while(0);c[b+16>>2]=d;i=e;return}function Ay(a){a=a|0;var b=0;b=i;By(a);gF(a);i=b;return}function By(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=11776;if(a[b+20>>0]|0){e=c[b+16>>2]|0;f=c[e+16>>2]|0;if(f){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0);e=c[b+16>>2]|0}if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}}if(a[b+12>>0]|0){e=c[b+8>>2]|0;f=c[e+16>>2]|0;if(f){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0);e=c[b+8>>2]|0}if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}}e=c[b+32>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+32>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+36>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+36>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+40>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+40>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+44>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+44>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+48>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+48>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+52>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+52>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+56>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+56>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+60>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+60>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+76>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+76>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+80>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+80>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+72>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+72>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+88>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+88>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+84>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+84>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+24>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}f=c[b+28>>2]|0;Lb[c[c[f>>2]>>2]&511](f);b=c[b+28>>2]|0;if(!b){i=d;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function Cy(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;do if(!((b|0)==8&(d|0)==8)){if((b|0)==8&(d|0)==1){a=a+76|0;break}if((b|0)==1&(d|0)==8){a=a+80|0;break}if(!(d|b)){a=a+72|0;break}if((b|0)<20&(d|0)==28){a=a+88|0;break}if((d|0)<20&(b|0)==28){a=a+84|0;break}if((b|0)<20){if((d|0)<20){a=a+32|0;break}if((d+ -21|0)>>>0<9){a=a+36|0;break}}else if((d|0)<20?(b+ -21|0)>>>0<9:0){a=a+40|0;break}if((b|0)==31)if((d|0)==31){a=a+48|0;break}else{a=a+44|0;break}else if((d|0)==31){a=a+52|0;break}else{a=a+56|0;break}}else a=a+60|0;while(0);i=e;return c[a>>2]|0}function Dy(a){a=a|0;return c[a+8>>2]|0}function Ey(a){a=a|0;return c[a+16>>2]|0}function Fy(a){a=a|0;return c[a+24>>2]|0}function Gy(a){a=a|0;return}function Hy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Iy(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0;g=i;h=c[d>>2]|0;h=gc[c[(c[h>>2]|0)+56>>2]&31](h,28)|0;if(!(a[b+4>>0]|0)){if(!h){f=0;i=g;return f|0}j=c[b+8>>2]|0;b=c[b+12>>2]|0;d=c[d>>2]|0;c[h+4>>2]=d;c[h>>2]=19408;a[h+8>>0]=0;c[h+12>>2]=0;a[h+16>>0]=0;c[h+20>>2]=j;c[h+24>>2]=b;if(!(Yb[c[(c[d>>2]|0)+24>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0)){j=h;i=g;return j|0}j=c[h+4>>2]|0;c[h+12>>2]=Yb[c[(c[j>>2]|0)+12>>2]&31](j,c[e+8>>2]|0,c[f+8>>2]|0)|0;a[h+8>>0]=1;j=h;i=g;return j|0}else{if(!h){j=0;i=g;return j|0}k=c[b+8>>2]|0;b=c[b+12>>2]|0;j=c[d>>2]|0;c[h+4>>2]=j;c[h>>2]=19408;a[h+8>>0]=0;c[h+12>>2]=0;a[h+16>>0]=1;c[h+20>>2]=k;c[h+24>>2]=b;if(!(Yb[c[(c[j>>2]|0)+24>>2]&31](j,c[f+8>>2]|0,c[e+8>>2]|0)|0)){k=h;i=g;return k|0}k=c[h+4>>2]|0;c[h+12>>2]=Yb[c[(c[k>>2]|0)+12>>2]&31](k,c[f+8>>2]|0,c[e+8>>2]|0)|0;a[h+8>>0]=1;k=h;i=g;return k|0}return 0}function Jy(a){a=a|0;return}function Ky(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Ly(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,16)|0;if(!g){g=0;i=b;return g|0}d=c[d>>2]|0;c[g+4>>2]=d;c[g>>2]=17896;a[g+8>>0]=0;c[g+12>>2]=0;if(!(Yb[c[(c[d>>2]|0)+24>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0)){i=b;return g|0}d=c[g+4>>2]|0;c[g+12>>2]=Yb[c[(c[d>>2]|0)+12>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0;a[g+8>>0]=1;i=b;return g|0}function My(a){a=a|0;return}function Ny(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Oy(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0;g=i;h=c[d>>2]|0;h=gc[c[(c[h>>2]|0)+56>>2]&31](h,20)|0;if(!h){b=0;i=g;return b|0}j=c[d+4>>2]|0;b=a[b+4>>0]|0;d=c[d>>2]|0;c[h+4>>2]=d;c[h>>2]=16904;a[h+8>>0]=0;c[h+12>>2]=j;a[h+16>>0]=b;if(j){j=h;i=g;return j|0}c[h+12>>2]=Yb[c[(c[d>>2]|0)+12>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0;a[h+8>>0]=1;j=h;i=g;return j|0}function Py(a){a=a|0;return}function Qy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Ry(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,16)|0;if(!g){g=0;i=b;return g|0}d=c[d>>2]|0;c[g+4>>2]=d;c[g>>2]=16816;a[g+8>>0]=0;c[g+12>>2]=0;c[g+12>>2]=Yb[c[(c[d>>2]|0)+12>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0;a[g+8>>0]=1;i=b;return g|0}function Sy(a){a=a|0;return}function Ty(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Uy(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;a=i;d=c[b>>2]|0;d=gc[c[(c[d>>2]|0)+56>>2]&31](d,8)|0;if(!d){e=0;i=a;return e|0}c[d+4>>2]=c[b>>2];c[d>>2]=12904;e=d;i=a;return e|0}function Vy(a){a=a|0;return}function Wy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Xy(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,44)|0;if(!g){g=0;i=b;return g|0}c[g+4>>2]=c[d>>2];c[g>>2]=18040;a[g+24>>0]=1;c[g+20>>2]=0;c[g+12>>2]=0;c[g+16>>2]=0;a[g+28>>0]=1;c[g+32>>2]=c[d+4>>2];a[g+36>>0]=0;c[g+40>>2]=c[(c[f+4>>2]|0)+68>>2];IC(g,e,f);i=b;return g|0}function Yy(a){a=a|0;return}function Zy(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function _y(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0;h=i;b=c[d>>2]|0;b=gc[c[(c[b>>2]|0)+56>>2]&31](b,48)|0;if(!b){m=0;i=h;return m|0}c[b+4>>2]=c[d>>2];c[b>>2]=18208;a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;c[b+20>>2]=0;c[b+32>>2]=c[d+4>>2];a[b+36>>0]=0;c[5004]=(c[5004]|0)+1;d=fF(87)|0;if((d|0)!=0?(g=d+19&-16,c[g+ -4>>2]=d,(d+19&-16|0)!=0):0){c[(d+19&-16)>>2]=19600;a[g+20>>0]=1;c[g+16>>2]=0;c[g+8>>2]=0;c[g+12>>2]=0;a[g+24>>0]=0;a[g+44>>0]=1;c[g+40>>2]=0;c[g+32>>2]=0;c[g+36>>2]=0;a[g+64>>0]=1;c[g+60>>2]=0;c[g+52>>2]=0;c[g+56>>2]=0;c[5004]=(c[5004]|0)+1;j=fF(43)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}k=c[g+8>>2]|0;if((k|0)>0){l=0;do{m=j+(l*12|0)|0;if(m){n=(c[g+16>>2]|0)+(l*12|0)|0;c[m+0>>2]=c[n+0>>2];c[m+4>>2]=c[n+4>>2];c[m+8>>2]=c[n+8>>2]}l=l+1|0}while((l|0)!=(k|0))}k=c[g+16>>2]|0;if(k){if(a[g+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[g+16>>2]=0}a[g+20>>0]=1;c[g+16>>2]=j;c[g+12>>2]=2;WD(d+19&-16);g=d+19&-16}else g=0;c[b+8>>2]=g;c[b+40>>2]=c[(c[e+4>>2]|0)+68>>2];c[b+44>>2]=c[(c[f+4>>2]|0)+68>>2];n=b;i=h;return n|0}function $y(a){a=a|0;return}function az(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function bz(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,44)|0;if(!g){g=0;i=b;return g|0}c[g+4>>2]=c[d>>2];c[g>>2]=18040;a[g+24>>0]=1;c[g+20>>2]=0;c[g+12>>2]=0;c[g+16>>2]=0;a[g+28>>0]=0;c[g+32>>2]=c[d+4>>2];a[g+36>>0]=0;c[g+40>>2]=c[(c[e+4>>2]|0)+68>>2];IC(g,e,f);i=b;return g|0}function cz(a){a=a|0;return}function dz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ez(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,80)|0;if(!g){g=0;i=b;return g|0}c[g+4>>2]=c[d>>2];c[g>>2]=18432;a[g+8>>0]=1;d=c[d>>2]|0;c[g+12>>2]=18464;c[g+60>>2]=d;c[g+64>>2]=0;c[g+16>>2]=f;c[g+20>>2]=e;e=Yb[c[(c[d>>2]|0)+12>>2]&31](d,c[f+8>>2]|0,c[e+8>>2]|0)|0;c[g+76>>2]=e;f=c[g+60>>2]|0;Nb[c[(c[f>>2]|0)+20>>2]&127](f,e);i=b;return g|0}function fz(a){a=a|0;return}function gz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function hz(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;b=i;g=c[d>>2]|0;g=gc[c[(c[g>>2]|0)+56>>2]&31](g,80)|0;if(!g){g=0;i=b;return g|0}c[g+4>>2]=c[d>>2];c[g>>2]=18432;a[g+8>>0]=0;d=c[d>>2]|0;c[g+12>>2]=18464;c[g+60>>2]=d;c[g+64>>2]=0;c[g+16>>2]=e;c[g+20>>2]=f;f=Yb[c[(c[d>>2]|0)+12>>2]&31](d,c[e+8>>2]|0,c[f+8>>2]|0)|0;c[g+76>>2]=f;e=c[g+60>>2]|0;Nb[c[(c[e>>2]|0)+20>>2]&127](e,f);i=b;return g|0}function iz(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return}function jz(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 1.0}function kz(a){a=a|0;return}function lz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function mz(a,b){a=a|0;b=b|0;return}function nz(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=13008;e=c[b+276>>2]|0;if(!e){a[b+280>>0]=1;c[b+276>>2]=0;c[b+268>>2]=0;c[b+272>>2]=0}else{if(a[b+280>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}a[b+280>>0]=1;c[b+276>>2]=0;c[b+268>>2]=0;c[b+272>>2]=0}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function oz(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=13008;e=c[b+276>>2]|0;if(e){if(a[b+280>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+276>>2]=0}a[b+280>>0]=1;c[b+276>>2]=0;c[b+268>>2]=0;c[b+272>>2]=0;i=d;return}function pz(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0;e=i;d=c[d>>2]|0;h=c[b+268>>2]|0;a:do if((h|0)>0){k=c[b+276>>2]|0;j=0;while(1){g=j+1|0;if((c[k+(j<<2)>>2]|0)==(d|0))break;if((g|0)<(h|0))j=g;else break a}if((j|0)!=(h|0)){i=e;return}}while(0);if((h|0)==(c[b+272>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[b+268>>2]|0}if((h|0)>0){k=0;do{j=g+(k<<2)|0;if(j)c[j>>2]=c[(c[b+276>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(h|0))}j=c[b+276>>2]|0;if(j){if(a[b+280>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[b+268>>2]|0}c[b+276>>2]=0}a[b+280>>0]=1;c[b+276>>2]=g;c[b+272>>2]=f}f=(c[b+276>>2]|0)+(h<<2)|0;if(f)c[f>>2]=d;c[b+268>>2]=h+1;i=e;return}function qz(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0;e=i;b=c[b>>2]|0;h=c[a+268>>2]|0;if((h|0)<=0){i=e;return}k=c[a+276>>2]|0;j=0;while(1){g=k+(j<<2)|0;d=j+1|0;if((c[g>>2]|0)==(b|0))break;if((d|0)<(h|0))j=d;else{f=7;break}}if((f|0)==7){i=e;return}if((j|0)>=(h|0)){i=e;return}c[g>>2]=c[k+(h+ -1<<2)>>2];c[a+268>>2]=h+ -1;i=e;return}function rz(a){a=a|0;var b=0;b=i;sz(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function sz(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=13056;e=c[b+284>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+284>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b>>2]=13008;e=c[b+276>>2]|0;if(!e){a[b+280>>0]=1;c[b+276>>2]=0;c[b+268>>2]=0;e=b+272|0;c[e>>2]=0;i=d;return}if(a[b+280>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+276>>2]=0;a[b+280>>0]=1;c[b+276>>2]=0;c[b+268>>2]=0;e=b+272|0;c[e>>2]=0;i=d;return}function tz(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;if(!e)e=c[b+188>>2]|0;g=c[d>>2]|0;k=c[b+268>>2]|0;a:do if((k|0)>0){m=c[b+276>>2]|0;j=0;while(1){l=j+1|0;if((c[m+(j<<2)>>2]|0)==(g|0))break;if((l|0)<(k|0))j=l;else break a}if((j|0)!=(k|0)){i=f;return}}while(0);if((k|0)==(c[b+272>>2]|0)?(h=(k|0)==0?1:k<<1,(k|0)<(h|0)):0){if(!h)j=0;else{c[5004]=(c[5004]|0)+1;j=fF((h<<2|3)+16|0)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}k=c[b+268>>2]|0}if((k|0)>0){m=0;do{l=j+(m<<2)|0;if(l)c[l>>2]=c[(c[b+276>>2]|0)+(m<<2)>>2];m=m+1|0}while((m|0)!=(k|0))}l=c[b+276>>2]|0;if(l){if(a[b+280>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0);k=c[b+268>>2]|0}c[b+276>>2]=0}a[b+280>>0]=1;c[b+276>>2]=j;c[b+272>>2]=h}h=(c[b+276>>2]|0)+(k<<2)|0;if(h)c[h>>2]=g;c[b+268>>2]=k+1;m=c[b+284>>2]|0;Yb[c[(c[m>>2]|0)+8>>2]&31](m,e,d)|0;i=f;return}function uz(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;h=i;f=c[b>>2]|0;if(!e)e=c[a+188>>2]|0;k=c[a+268>>2]|0;if((k|0)<=0){i=h;return}l=c[a+276>>2]|0;m=0;while(1){n=l+(m<<2)|0;j=m+1|0;if((c[n>>2]|0)==(f|0))break;if((j|0)<(k|0))m=j;else{g=9;break}}if((g|0)==9){i=h;return}if((m|0)>=(k|0)){i=h;return}c[n>>2]=c[l+(k+ -1<<2)>>2];c[a+268>>2]=k+ -1;n=c[a+284>>2]|0;Tb[c[(c[n>>2]|0)+12>>2]&31](n,e,b,d)|0;i=h;return}function vz(a,b,d,e,f,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=+h;var j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0,s=0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0.0,A=0.0,B=0,C=0,D=0,E=0,F=0.0,G=0.0,H=0.0,I=0.0,J=0,K=0.0,L=0.0,M=0.0;y=i;i=i+320|0;c[y+176>>2]=c[d+0>>2];c[y+180>>2]=c[d+4>>2];c[y+184>>2]=c[d+8>>2];c[y+188>>2]=c[d+12>>2];c[y+192>>2]=c[d+16>>2];c[y+196>>2]=c[d+20>>2];c[y+200>>2]=c[d+24>>2];c[y+204>>2]=c[d+28>>2];c[y+208>>2]=c[d+32>>2];c[y+212>>2]=c[d+36>>2];c[y+216>>2]=c[d+40>>2];c[y+220>>2]=c[d+44>>2];c[y+224>>2]=c[d+48>>2];c[y+228>>2]=c[d+52>>2];c[y+232>>2]=c[d+56>>2];c[y+236>>2]=c[d+60>>2];c[y+112>>2]=c[e+0>>2];c[y+116>>2]=c[e+4>>2];c[y+120>>2]=c[e+8>>2];c[y+124>>2]=c[e+12>>2];c[y+128>>2]=c[e+16>>2];c[y+132>>2]=c[e+20>>2];c[y+136>>2]=c[e+24>>2];c[y+140>>2]=c[e+28>>2];c[y+144>>2]=c[e+32>>2];c[y+148>>2]=c[e+36>>2];c[y+152>>2]=c[e+40>>2];c[y+156>>2]=c[e+44>>2];c[y+160>>2]=c[e+48>>2];c[y+164>>2]=c[e+52>>2];c[y+168>>2]=c[e+56>>2];c[y+172>>2]=c[e+60>>2];H=+g[y+164>>2]- +g[y+228>>2];M=+g[y+168>>2]- +g[y+232>>2];g[y+64>>2]=+g[y+160>>2]- +g[y+224>>2];g[y+68>>2]=H;g[y+72>>2]=M;g[y+76>>2]=0.0;Lo(y+176|0,y+112|0,y+248|0,y+240|0);M=+g[y+240>>2];H=M*+g[y+252>>2];F=M*+g[y+256>>2];g[y+48>>2]=+g[y+248>>2]*M;g[y+52>>2]=H;g[y+56>>2]=F;g[y+60>>2]=0.0;g[y+248>>2]=1.0;D=y+252|0;c[D+0>>2]=0;c[D+4>>2]=0;c[D+8>>2]=0;c[D+12>>2]=0;g[y+268>>2]=1.0;E=y+272|0;c[E+0>>2]=0;c[E+4>>2]=0;c[E+8>>2]=0;c[E+12>>2]=0;g[y+288>>2]=1.0;J=y+292|0;c[J+0>>2]=0;c[J+4>>2]=0;c[J+8>>2]=0;c[J+12>>2]=0;c[J+16>>2]=0;Hc(y+176|0,y+32|0);F=+g[y+32>>2];H=+g[y+36>>2];M=+g[y+40>>2];K=+g[y+44>>2];G=F*(2.0/(F*F+H*H+M*M+K*K));I=H*(2.0/(F*F+H*H+M*M+K*K));L=M*(2.0/(F*F+H*H+M*M+K*K));g[y+248>>2]=1.0-(H*I+M*L);g[D>>2]=F*I-K*L;g[y+256>>2]=F*L+K*I;g[y+260>>2]=0.0;g[y+264>>2]=F*I+K*L;g[y+268>>2]=1.0-(F*G+M*L);g[E>>2]=H*L-K*G;g[y+276>>2]=0.0;g[y+280>>2]=F*L-K*I;g[y+284>>2]=H*L+K*G;g[y+288>>2]=1.0-(F*G+H*I);g[J>>2]=0.0;wu(b,y+248|0,y+64|0,y+48|0,y+96|0,y+80|0);if((c[a+268>>2]|0)<=0){i=y;return}B=0;do{C=c[(c[a+276>>2]|0)+(B<<2)>>2]|0;if(gc[c[(c[f>>2]|0)+8>>2]&31](f,c[C+188>>2]|0)|0?(s=c[C+192>>2]|0,vc[c[(c[s>>2]|0)+8>>2]&127](s,C+4|0,y+16|0,y),z=+g[y+16>>2]+ +g[y+96>>2],v=+g[y+20>>2]+ +g[y+100>>2],p=+g[y+24>>2]+ +g[y+104>>2],g[y+16>>2]=z,g[y+20>>2]=v,g[y+24>>2]=p,g[y+28>>2]=0.0,j=+g[y>>2]+ +g[y+80>>2],u=+g[y+4>>2]+ +g[y+84>>2],o=+g[y+8>>2]+ +g[y+88>>2],g[y>>2]=j,g[y+4>>2]=u,g[y+8>>2]=o,g[y+12>>2]=0.0,x=+g[d+48>>2]-(j+z)*.5,t=+g[d+52>>2]-(u+v)*.5,n=+g[d+56>>2]-(o+p)*.5,A=+g[e+48>>2]-(j+z)*.5,w=+g[e+52>>2]-(u+v)*.5,q=+g[e+56>>2]-(o+p)*.5,s=x<-((j-z)*.5)|(x>(j-z)*.5?8:0)|(t>(u-v)*.5?16:0)|(t<-((u-v)*.5)?2:0)|(n>(o-p)*.5?32:0)|(n<-((o-p)*.5)?4:0),r=A<-((j-z)*.5)|(A>(j-z)*.5?8:0)|(w>(u-v)*.5?16:0)|(w<-((u-v)*.5)?2:0)|(q>(o-p)*.5?32:0)|(q<-((o-p)*.5)?4:0),(s&r|0)==0):0){G=1.0;D=1;E=0;H=0.0;F=1.0;while(1){if(!(D&s)){if((D&r|0)!=0?(m=(-x-F*(j-z)*.5)/(A-x),m<G):0)G=m}else{I=(-x-F*(j-z)*.5)/(A-x);if(H<=I)H=I}J=D<<1;if(!(J&s)){if((J&r|0)!=0?(l=(-t-F*(u-v)*.5)/(w-t),l<G):0)G=l}else{I=(-t-F*(u-v)*.5)/(w-t);if(H<=I)H=I}J=D<<2;if(!(J&s)){if((J&r|0)!=0?(k=(-n-F*(o-p)*.5)/(q-n),k<G):0)G=k}else{F=(-n-F*(o-p)*.5)/(q-n);if(H<=F)H=F}E=E+1|0;if((E|0)==2)break;else{D=D<<3;F=-1.0}}if(H<=G){J=c[C+192>>2]|0;c[y+248>>2]=0;c[y+252>>2]=J;c[y+256>>2]=C;c[y+260>>2]=C+4;c[y+264>>2]=-1;c[y+268>>2]=-1;Ku(b,y+176|0,y+112|0,y+248|0,f,h)}}B=B+1|0}while((B|0)<(c[a+268>>2]|0));i=y;return}function wz(b,d,e,f,h,j){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0,u=0,v=0.0;k=i;i=i+288|0;u=c[b+4>>2]|0;a[u+312>>0]=0;c[u>>2]=0;a[u+356>>0]=1;g[u+292>>2]=999999984306749400.0;g[u+296>>2]=999999984306749400.0;g[u+300>>2]=999999984306749400.0;g[u+304>>2]=0.0;c[u+336>>2]=0;c[u+340>>2]=0;c[u+344>>2]=0;c[u+348>>2]=0;a[u+352>>0]=0;a[u+332>>0]=a[u+332>>0]&-16;n=+g[e+48>>2]- +g[d+48>>2]-(+g[h+48>>2]- +g[f+48>>2]);m=+g[e+52>>2]- +g[d+52>>2]-(+g[h+52>>2]- +g[f+52>>2]);l=+g[e+56>>2]- +g[d+56>>2]-(+g[h+56>>2]- +g[f+56>>2]);c[k+216>>2]=10224;g[k+252>>2]=999999984306749400.0;a[k+256>>0]=0;u=c[b+8>>2]|0;t=c[b+12>>2]|0;b=c[b+4>>2]|0;c[k+136>>2]=13392;g[k+140>>2]=0.0;g[k+144>>2]=1.0;g[k+148>>2]=0.0;g[k+152>>2]=0.0;c[k+156>>2]=0;c[k+160>>2]=b;c[k+164>>2]=u;c[k+168>>2]=t;c[k+172>>2]=c[u+4>>2];c[k+176>>2]=c[t+4>>2];g[k+180>>2]=+$b[c[(c[u>>2]|0)+48>>2]&15](u);g[k+184>>2]=+$b[c[(c[t>>2]|0)+48>>2]&15](t);a[k+188>>0]=0;c[k+196>>2]=-1;c[k+208>>2]=1;c[k+212>>2]=1;g[k+128>>2]=999999984306749400.0;c[k+0>>2]=c[d+0>>2];c[k+4>>2]=c[d+4>>2];c[k+8>>2]=c[d+8>>2];c[k+12>>2]=c[d+12>>2];c[k+16>>2]=c[d+16>>2];c[k+20>>2]=c[d+20>>2];c[k+24>>2]=c[d+24>>2];c[k+28>>2]=c[d+28>>2];c[k+32>>2]=c[d+32>>2];c[k+36>>2]=c[d+36>>2];c[k+40>>2]=c[d+40>>2];c[k+44>>2]=c[d+44>>2];c[k+48>>2]=c[d+48>>2];c[k+52>>2]=c[d+52>>2];c[k+56>>2]=c[d+56>>2];c[k+60>>2]=c[d+60>>2];c[k+64>>2]=c[f+0>>2];c[k+68>>2]=c[f+4>>2];c[k+72>>2]=c[f+8>>2];c[k+76>>2]=c[f+12>>2];c[k+80>>2]=c[f+16>>2];c[k+84>>2]=c[f+20>>2];c[k+88>>2]=c[f+24>>2];c[k+92>>2]=c[f+28>>2];c[k+96>>2]=c[f+32>>2];c[k+100>>2]=c[f+36>>2];c[k+104>>2]=c[f+40>>2];c[k+108>>2]=c[f+44>>2];c[k+112>>2]=c[f+48>>2];c[k+116>>2]=c[f+52>>2];c[k+120>>2]=c[f+56>>2];c[k+124>>2]=c[f+60>>2];Az(k+136|0,k,k+216|0,0,0);t=(a[k+256>>0]|0)==0;b=k+236|0;c[k+264>>2]=c[b+0>>2];c[k+268>>2]=c[b+4>>2];c[k+272>>2]=c[b+8>>2];c[k+276>>2]=c[b+12>>2];if(t){u=0;i=k;return u|0}q=+g[k+252>>2];o=+g[k+220>>2];p=+g[k+224>>2];r=+g[k+228>>2];s=+g[k+232>>2];do if(q>.0010000000474974513){s=q;q=0.0;t=1;while(1){if((t|0)>32){j=0;e=13;break}v=q;q=q-s/(l*r+(m*p+n*o));if(!(!(q<0.0)&!(q>1.0)&!(q<=v))){j=0;e=13;break}Kb[c[c[j>>2]>>2]&31](j,q);v=1.0-q;g[k+48>>2]=v*+g[d+48>>2]+q*+g[e+48>>2];g[k+52>>2]=v*+g[d+52>>2]+q*+g[e+52>>2];g[k+56>>2]=v*+g[d+56>>2]+q*+g[e+56>>2];g[k+112>>2]=v*+g[f+48>>2]+q*+g[h+48>>2];g[k+116>>2]=v*+g[f+52>>2]+q*+g[h+52>>2];g[k+120>>2]=v*+g[f+56>>2]+q*+g[h+56>>2];Az(k+136|0,k,k+216|0,0,0);if(!(a[k+256>>0]|0)){j=0;e=13;break}s=+g[k+252>>2];if(s<0.0){e=8;break}c[k+264>>2]=c[b+0>>2];c[k+268>>2]=c[b+4>>2];c[k+272>>2]=c[b+8>>2];c[k+276>>2]=c[b+12>>2];o=+g[k+220>>2];p=+g[k+224>>2];r=+g[k+228>>2];if(!(s>.0010000000474974513)){e=10;break}else t=t+1|0}if((e|0)==8){g[j+164>>2]=q;r=+g[k+224>>2];s=+g[k+228>>2];v=+g[k+232>>2];g[j+132>>2]=+g[k+220>>2];g[j+136>>2]=r;g[j+140>>2]=s;g[j+144>>2]=v;c[j+148>>2]=c[b+0>>2];c[j+152>>2]=c[b+4>>2];c[j+156>>2]=c[b+8>>2];c[j+160>>2]=c[b+12>>2];u=1;i=k;return u|0}else if((e|0)==10){s=+g[k+232>>2];break}else if((e|0)==13){i=k;return j|0}}else q=0.0;while(0);if(l*r+(m*p+n*o)>=-+g[j+172>>2]){u=0;i=k;return u|0}g[j+164>>2]=q;g[j+132>>2]=o;g[j+136>>2]=p;g[j+140>>2]=r;g[j+144>>2]=s;c[j+148>>2]=c[k+264>>2];c[j+152>>2]=c[k+268>>2];c[j+156>>2]=c[k+272>>2];c[j+160>>2]=c[k+276>>2];u=1;i=k;return u|0}function xz(a){a=a|0;return}function yz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function zz(b,e,f,h,j,k,l,m,n,o){b=b|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;n=n|0;o=o|0;var p=0,q=0,r=0,s=0,t=0,u=0.0,v=0.0,w=0.0,x=0,y=0.0,z=0,A=0,B=0.0,C=0,D=0,E=0,F=0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0;b=i;i=i+10240|0;U=+g[k+52>>2]- +g[j+52>>2];H=+g[k+56>>2]- +g[j+56>>2];g[b>>2]=+g[k+48>>2]- +g[j+48>>2];g[b+4>>2]=U;g[b+8>>2]=H;g[b+12>>2]=0.0;c[b+10088>>2]=f;c[b+10092>>2]=h;H=+g[k>>2];U=+g[j>>2];G=+g[k+16>>2];y=+g[j+16>>2];B=+g[k+32>>2];V=+g[j+32>>2];L=+g[j+4>>2];W=+g[j+20>>2];M=+g[j+36>>2];v=+g[j+8>>2];K=+g[j+24>>2];I=+g[j+40>>2];T=+g[k+4>>2];S=+g[k+20>>2];R=+g[k+36>>2];P=+g[k+8>>2];O=+g[k+24>>2];N=+g[k+40>>2];g[b+10096>>2]=H*U+G*y+B*V;g[b+10100>>2]=H*L+G*W+B*M;g[b+10104>>2]=H*v+G*K+B*I;g[b+10108>>2]=0.0;g[b+10112>>2]=U*T+y*S+V*R;g[b+10116>>2]=L*T+W*S+M*R;g[b+10120>>2]=v*T+K*S+I*R;g[b+10124>>2]=0.0;g[b+10128>>2]=U*P+y*O+V*N;g[b+10132>>2]=L*P+W*O+M*N;g[b+10136>>2]=v*P+K*O+I*N;g[b+10140>>2]=0.0;I=+g[k+48>>2]- +g[j+48>>2];K=+g[k+52>>2]- +g[j+52>>2];v=+g[k+56>>2]- +g[j+56>>2];M=+g[j>>2];W=+g[k>>2];L=+g[j+16>>2];V=+g[k+16>>2];y=+g[j+32>>2];U=+g[k+32>>2];B=+g[j+4>>2];G=+g[j+20>>2];H=+g[j+36>>2];J=+g[j+8>>2];w=+g[j+24>>2];u=+g[j+40>>2];g[b+10144>>2]=M*W+L*V+y*U;g[b+10148>>2]=M*T+L*S+y*R;g[b+10152>>2]=M*P+L*O+y*N;g[b+10156>>2]=0.0;g[b+10160>>2]=W*B+V*G+U*H;g[b+10164>>2]=T*B+S*G+R*H;g[b+10168>>2]=P*B+O*G+N*H;g[b+10172>>2]=0.0;g[b+10176>>2]=W*J+V*w+U*u;g[b+10180>>2]=T*J+S*w+R*u;g[b+10184>>2]=P*J+O*w+N*u;g[b+10188>>2]=0.0;g[b+10192>>2]=I*M+K*L+v*y;g[b+10196>>2]=I*B+K*G+v*H;g[b+10200>>2]=I*J+K*w+v*u;g[b+10204>>2]=0.0;c[b+10208>>2]=70;c[b+10212>>2]=0;c[b+10072>>2]=0;c[b+9836>>2]=0;c[b+9840>>2]=0;c[b+9844>>2]=0;c[b+9848>>2]=0;c[b+10084>>2]=2;c[b+10076>>2]=0;g[b+9852>>2]=0.0;u=+g[b>>2];v=+g[b+4>>2];w=+g[b+8>>2];g[b+9328>>2]=-u;g[b+9332>>2]=-v;g[b+9336>>2]=-w;g[b+9340>>2]=0.0;do if((OD(b+9708|0,b+10088|0,b+9328|0)|0)==1){e=b+9296|0;r=b+9304|0;q=b+9308|0;c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[b+16>>2]=9;o=b+56|0;c[b+9292>>2]=0;c[o+0>>2]=0;c[o+4>>2]=0;c[o+8>>2]=0;c[o+12>>2]=0;c[o+16>>2]=0;s=0;do{t=128-s+ -1|0;c[b+16+(t*56|0)+2152>>2]=0;x=c[r>>2]|0;c[b+16+(t*56|0)+2156>>2]=x;if(x)c[x+44>>2]=b+16+(t*56|0)+2108;c[r>>2]=b+16+(t*56|0)+2108;c[q>>2]=(c[q>>2]|0)+1;s=s+1|0}while((s|0)!=128);s=c[b+10080>>2]|0;if((c[s+32>>2]|0)>>>0>1?PD(b+9708|0)|0:0){t=c[e>>2]|0;if(t){z=c[b+9300>>2]|0;x=c[q>>2]|0;do{C=t+48|0;D=c[C>>2]|0;A=t+44|0;if(D)c[D+44>>2]=c[A>>2];D=c[A>>2]|0;if(D)c[D+48>>2]=c[C>>2];if((c[e>>2]|0)==(t|0))c[e>>2]=c[C>>2];z=z+ -1|0;c[A>>2]=0;c[C>>2]=c[r>>2];A=c[r>>2]|0;if(A)c[A+44>>2]=t;c[r>>2]=t;x=x+1|0;t=c[e>>2]|0}while((t|0)!=0);c[b+9300>>2]=z;c[q>>2]=x}c[b+16>>2]=0;c[b+9292>>2]=0;z=c[s>>2]|0;A=c[s+12>>2]|0;W=+g[A+16>>2];N=+g[z+16>>2]-W;P=+g[A+20>>2];R=+g[z+20>>2]-P;T=+g[A+24>>2];U=+g[z+24>>2]-T;A=c[s+4>>2]|0;S=+g[A+16>>2]-W;V=+g[A+20>>2]-P;O=+g[A+24>>2]-T;x=c[s+8>>2]|0;W=+g[x+16>>2]-W;P=+g[x+20>>2]-P;T=+g[x+24>>2]-T;if(N*V*T+(R*O*W+U*S*P-N*O*P-R*S*T)-U*V*W<0.0){c[s>>2]=A;c[s+4>>2]=z;W=+g[s+16>>2];g[s+16>>2]=+g[s+20>>2];g[s+20>>2]=W;t=A}else{t=z;z=A}t=QD(b+16|0,t,z,x,1)|0;x=QD(b+16|0,c[s+4>>2]|0,c[s>>2]|0,c[s+12>>2]|0,1)|0;z=QD(b+16|0,c[s+8>>2]|0,c[s+4>>2]|0,c[s+12>>2]|0,1)|0;A=QD(b+16|0,c[s>>2]|0,c[s+8>>2]|0,c[s+12>>2]|0,1)|0;if((c[b+9300>>2]|0)==4){C=c[e>>2]|0;B=+g[C+16>>2];s=c[C+48>>2]|0;if(s){u=B*B;while(1){v=+g[s+16>>2];D=v*v<u;C=D?s:C;s=c[s+48>>2]|0;if(!s)break;else u=D?v*v:u}B=+g[C+16>>2]}y=+g[C>>2];w=+g[C+4>>2];u=+g[C+8>>2];v=+g[C+12>>2];E=c[C+20>>2]|0;F=c[C+24>>2]|0;s=c[C+28>>2]|0;a[t+52>>0]=0;c[t+32>>2]=x;a[x+52>>0]=0;c[x+32>>2]=t;a[t+53>>0]=0;c[t+36>>2]=z;a[z+52>>0]=1;c[z+32>>2]=t;a[t+54>>0]=0;c[t+40>>2]=A;a[A+52>>0]=2;c[A+32>>2]=t;a[x+53>>0]=2;c[x+36>>2]=A;a[A+54>>0]=1;c[A+40>>2]=x;a[x+54>>0]=1;c[x+40>>2]=z;a[z+53>>0]=2;c[z+36>>2]=x;a[z+54>>0]=1;c[z+40>>2]=A;a[A+53>>0]=2;c[A+36>>2]=z;c[b+16>>2]=0;A=E;z=F;x=s;t=0;s=1;while(1){D=c[b+9292>>2]|0;if(D>>>0>=64){p=48;break}c[b+10216>>2]=0;c[b+10220>>2]=0;c[b+10224>>2]=0;c[b+9292>>2]=D+1;a[C+55>>0]=s;E=C+4|0;F=C+8|0;RD(b+9708|0,+g[C>>2],+g[E>>2],+g[F>>2],b+16+(D<<5)+60|0);if(+g[C>>2]*+g[b+16+(D<<5)+76>>2]+ +g[E>>2]*+g[b+16+(D<<5)+80>>2]+ +g[F>>2]*+g[b+16+(D<<5)+84>>2]- +g[C+16>>2]>9999999747378752.0e-20){E=0;F=1}else{p=47;break}do{F=F&(SD(b+16|0,s,b+16+(D<<5)+60|0,c[C+(E<<2)+32>>2]|0,d[C+E+52>>0]|0,b+10216|0)|0);E=E+1|0}while(!(E>>>0>2|F^1));if(!F){p=46;break}if((c[b+10224>>2]|0)>>>0<=2){p=46;break}A=c[b+10216>>2]|0;z=c[b+10220>>2]|0;a[A+53>>0]=2;c[A+36>>2]=z;a[z+54>>0]=1;c[z+40>>2]=A;z=C+48|0;A=c[z>>2]|0;x=C+44|0;if(A)c[A+44>>2]=c[x>>2];A=c[x>>2]|0;if(A)c[A+48>>2]=c[z>>2];if((c[e>>2]|0)==(C|0))c[e>>2]=c[z>>2];c[b+9300>>2]=(c[b+9300>>2]|0)+ -1;c[x>>2]=0;c[z>>2]=c[r>>2];x=c[r>>2]|0;if(x)c[x+44>>2]=C;c[r>>2]=C;c[q>>2]=(c[q>>2]|0)+1;C=c[e>>2]|0;B=+g[C+16>>2];x=c[C+48>>2]|0;if(x){u=B*B;while(1){v=+g[x+16>>2];z=v*v<u;C=z?x:C;x=c[x+48>>2]|0;if(!x)break;else u=z?v*v:u}B=+g[C+16>>2]}y=+g[C>>2];w=+g[C+4>>2];u=+g[C+8>>2];v=+g[C+12>>2];A=c[C+20>>2]|0;z=c[C+24>>2]|0;x=c[C+28>>2]|0;t=t+1|0;if(t>>>0>=255)break;else s=s+1|0}if((p|0)==46)c[b+16>>2]=4;else if((p|0)==47)c[b+16>>2]=7;else if((p|0)==48)c[b+16>>2]=6;S=B*y;P=B*w;U=B*u;g[o>>2]=y;g[b+60>>2]=w;g[b+64>>2]=u;g[b+68>>2]=v;g[b+72>>2]=B;c[b+52>>2]=3;c[b+20>>2]=A;c[b+24>>2]=z;c[b+28>>2]=x;D=z+16|0;T=+g[D>>2]-S;E=z+20|0;N=+g[E>>2]-P;F=z+24|0;R=+g[F>>2]-U;C=x+16|0;M=+g[C>>2]-S;z=x+20|0;O=+g[z>>2]-P;x=x+24|0;V=+g[x>>2]-U;V=+Q(+((T*O-N*M)*(T*O-N*M)+((N*V-R*O)*(N*V-R*O)+(R*M-T*V)*(R*M-T*V))));g[b+36>>2]=V;T=+g[C>>2]-S;M=+g[z>>2]-P;R=+g[x>>2]-U;x=A+16|0;O=+g[x>>2]-S;z=A+20|0;N=+g[z>>2]-P;C=A+24|0;W=+g[C>>2]-U;W=+Q(+((T*N-M*O)*(T*N-M*O)+((M*W-R*N)*(M*W-R*N)+(R*O-T*W)*(R*O-T*W))));g[b+40>>2]=W;T=+g[x>>2]-S;O=+g[z>>2]-P;R=+g[C>>2]-U;S=+g[D>>2]-S;P=+g[E>>2]-P;U=+g[F>>2]-U;U=+Q(+((T*P-O*S)*(T*P-O*S)+((O*U-R*P)*(O*U-R*P)+(R*S-T*U)*(R*S-T*U))));g[b+36>>2]=V/(U+(V+W));g[b+40>>2]=W/(U+(V+W));g[b+44>>2]=U/(U+(V+W));if((c[b+16>>2]|0)==9){o=0;u=0.0;v=0.0;w=0.0;B=0.0;H=0.0;I=0.0;J=0.0;G=0.0;y=0.0;break}if(!(c[b+52>>2]|0)){y=0.0;B=0.0;w=0.0}else{e=b+52|0;p=54}}else p=49}else p=49;if((p|0)==49){c[b+16>>2]=8;g[o>>2]=u;g[b+60>>2]=v;g[b+64>>2]=w;g[b+68>>2]=0.0;y=+Q(+(u*u+v*v+w*w));if(y>0.0){w=1.0/y*w;v=1.0/y*v;u=1.0/y*u}else{w=0.0;v=0.0;u=1.0}g[o>>2]=u;g[b+60>>2]=v;g[b+64>>2]=w;g[b+68>>2]=0.0;g[b+72>>2]=0.0;c[b+52>>2]=1;c[b+20>>2]=c[s>>2];g[b+36>>2]=1.0;e=b+52|0;p=54}if((p|0)==54){w=0.0;u=0.0;v=0.0;p=0;do{r=c[b+10208>>2]|0;F=c[b+10212>>2]|0;q=(c[b+10088>>2]|0)+(F>>1)|0;if(F&1)r=c[(c[q>>2]|0)+r>>2]|0;rc[r&127](b+9312|0,q,c[b+16+(p<<2)+4>>2]|0);W=+g[b+16+(p<<2)+20>>2];w=w+ +g[b+9312>>2]*W;u=u+W*+g[b+9316>>2];v=v+W*+g[b+9320>>2];p=p+1|0}while(p>>>0<(c[e>>2]|0)>>>0);y=v;B=u}Y=+g[j>>2];X=+g[j+4>>2];K=+g[j+8>>2];M=+g[j+16>>2];N=+g[j+20>>2];O=+g[j+24>>2];R=+g[j+32>>2];T=+g[j+36>>2];V=+g[j+40>>2];L=+g[j+48>>2];H=+g[j+52>>2];I=+g[j+56>>2];J=+g[o>>2];U=+g[b+72>>2];G=+g[b+60>>2];W=+g[b+64>>2];P=w-J*U;S=B-U*G;U=y-U*W;o=1;u=w*Y+B*X+y*K+L;v=w*M+B*N+y*O+H;w=w*R+B*T+y*V+I;B=P*Y+S*X+U*K+L;H=P*M+S*N+U*O+H;I=P*R+S*T+U*V+I;J=-J;G=-G;y=-W}else{o=0;u=0.0;v=0.0;w=0.0;B=0.0;H=0.0;I=0.0;J=0.0;G=0.0;y=0.0}while(0);if(o){g[m>>2]=u;g[m+4>>2]=v;g[m+8>>2]=w;g[m+12>>2]=0.0;g[n>>2]=B;g[n+4>>2]=H;g[n+8>>2]=I;g[n+12>>2]=0.0;g[l>>2]=J;g[l+4>>2]=G;g[l+8>>2]=y;g[l+12>>2]=0.0;F=1;i=b;return F|0}c[b+9708>>2]=f;c[b+9712>>2]=h;w=+g[k>>2];M=+g[j>>2];y=+g[k+16>>2];N=+g[j+16>>2];B=+g[k+32>>2];O=+g[j+32>>2];P=+g[j+4>>2];R=+g[j+20>>2];S=+g[j+36>>2];U=+g[j+8>>2];W=+g[j+24>>2];Y=+g[j+40>>2];G=+g[k+4>>2];H=+g[k+20>>2];I=+g[k+36>>2];J=+g[k+8>>2];K=+g[k+24>>2];L=+g[k+40>>2];g[b+9716>>2]=w*M+y*N+B*O;g[b+9720>>2]=w*P+y*R+B*S;g[b+9724>>2]=w*U+y*W+B*Y;g[b+9728>>2]=0.0;g[b+9732>>2]=M*G+N*H+O*I;g[b+9736>>2]=P*G+R*H+S*I;g[b+9740>>2]=U*G+W*H+Y*I;g[b+9744>>2]=0.0;g[b+9748>>2]=M*J+N*K+O*L;g[b+9752>>2]=P*J+R*K+S*L;g[b+9756>>2]=U*J+W*K+Y*L;g[b+9760>>2]=0.0;T=+g[k+48>>2]- +g[j+48>>2];V=+g[k+52>>2]- +g[j+52>>2];X=+g[k+56>>2]- +g[j+56>>2];g[b+9764>>2]=w*M+y*N+B*O;g[b+9768>>2]=M*G+N*H+O*I;g[b+9772>>2]=M*J+N*K+O*L;g[b+9776>>2]=0.0;g[b+9780>>2]=w*P+y*R+B*S;g[b+9784>>2]=P*G+R*H+S*I;g[b+9788>>2]=P*J+R*K+S*L;g[b+9792>>2]=0.0;g[b+9796>>2]=w*U+y*W+B*Y;g[b+9800>>2]=U*G+W*H+Y*I;g[b+9804>>2]=U*J+W*K+Y*L;g[b+9808>>2]=0.0;g[b+9812>>2]=T*M+V*N+X*O;g[b+9816>>2]=T*P+V*R+X*S;g[b+9820>>2]=T*U+V*W+X*Y;g[b+9824>>2]=0.0;c[b+9828>>2]=71;c[b+9832>>2]=0;c[b+9692>>2]=0;c[b+9456>>2]=0;c[b+9460>>2]=0;c[b+9464>>2]=0;c[b+9468>>2]=0;c[b+9704>>2]=2;c[b+9696>>2]=0;g[b+9472>>2]=0.0;if(OD(b+9328|0,b+9708|0,b)|0){F=0;i=b;return F|0}k=c[b+9700>>2]|0;if(!(c[k+32>>2]|0)){H=0.0;G=0.0;B=0.0;u=0.0;v=0.0;y=0.0}else{B=0.0;G=0.0;H=0.0;y=0.0;v=0.0;u=0.0;f=0;do{w=+g[k+(f<<2)+16>>2];o=c[b+9828>>2]|0;F=c[b+9832>>2]|0;h=(c[b+9708>>2]|0)+(F>>1)|0;if(F&1)o=c[(c[h>>2]|0)+o>>2]|0;rc[o&127](b+9312|0,h,c[k+(f<<2)>>2]|0);B=B+w*+g[b+9312>>2];G=G+w*+g[b+9316>>2];H=H+w*+g[b+9320>>2];h=c[(c[b+9700>>2]|0)+(f<<2)>>2]|0;I=-+g[h>>2];J=-+g[h+4>>2];K=-+g[h+8>>2];h=c[b+9828>>2]|0;F=c[b+9832>>2]|0;k=(c[b+9712>>2]|0)+(F>>1)|0;if(F&1)h=c[(c[k>>2]|0)+h>>2]|0;X=+g[b+9732>>2]*I+ +g[b+9736>>2]*J+ +g[b+9740>>2]*K;W=+g[b+9748>>2]*I+ +g[b+9752>>2]*J+ +g[b+9756>>2]*K;g[b+10088>>2]=+g[b+9716>>2]*I+ +g[b+9720>>2]*J+ +g[b+9724>>2]*K;g[b+10092>>2]=X;g[b+10096>>2]=W;g[b+10100>>2]=0.0;rc[h&127](b+10216|0,k,b+10088|0);W=+g[b+10216>>2];X=+g[b+10220>>2];Y=+g[b+10224>>2];y=y+w*(W*+g[b+9764>>2]+X*+g[b+9768>>2]+Y*+g[b+9772>>2]+ +g[b+9812>>2]);v=v+w*(W*+g[b+9780>>2]+X*+g[b+9784>>2]+Y*+g[b+9788>>2]+ +g[b+9816>>2]);u=u+w*(W*+g[b+9796>>2]+X*+g[b+9800>>2]+Y*+g[b+9804>>2]+ +g[b+9820>>2]);f=f+1|0;k=c[b+9700>>2]|0}while(f>>>0<(c[k+32>>2]|0)>>>0)}I=+g[j>>2];J=+g[j+4>>2];K=+g[j+8>>2];M=+g[j+16>>2];N=+g[j+20>>2];O=+g[j+24>>2];R=+g[j+32>>2];S=+g[j+36>>2];T=+g[j+40>>2];L=+g[j+48>>2];P=+g[j+52>>2];U=+g[j+56>>2];V=B-y;W=G-v;Y=H-u;X=+Q(+(V*V+W*W+Y*Y));X=1.0/(X>9999999747378752.0e-20?X:1.0);g[m>>2]=B*I+G*J+H*K+L;g[m+4>>2]=B*M+G*N+H*O+P;g[m+8>>2]=B*R+G*S+H*T+U;g[m+12>>2]=0.0;g[n>>2]=y*I+v*J+u*K+L;g[n+4>>2]=y*M+v*N+u*O+P;g[n+8>>2]=y*R+v*S+u*T+U;g[n+12>>2]=0.0;g[l>>2]=X*V;g[l+4>>2]=X*W;g[l+8>>2]=X*Y;g[l+12>>2]=0.0;F=0;i=b;return F|0}function Az(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0,q=0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0,O=0,P=0.0,R=0.0;h=i;i=i+288|0;g[b+56>>2]=0.0;p=h+276|0;q=h+280|0;c[h+272>>2]=0;c[h+276>>2]=0;c[h+280>>2]=0;c[h+284>>2]=0;c[h+208>>2]=c[d+0>>2];c[h+212>>2]=c[d+4>>2];c[h+216>>2]=c[d+8>>2];c[h+220>>2]=c[d+12>>2];c[h+224>>2]=c[d+16>>2];c[h+228>>2]=c[d+20>>2];c[h+232>>2]=c[d+24>>2];c[h+236>>2]=c[d+28>>2];c[h+240>>2]=c[d+32>>2];c[h+244>>2]=c[d+36>>2];c[h+248>>2]=c[d+40>>2];c[h+252>>2]=c[d+44>>2];N=h+256|0;c[N+0>>2]=c[d+48>>2];c[N+4>>2]=c[d+52>>2];c[N+8>>2]=c[d+56>>2];c[N+12>>2]=c[d+60>>2];c[h+144>>2]=c[d+64>>2];c[h+148>>2]=c[d+68>>2];c[h+152>>2]=c[d+72>>2];c[h+156>>2]=c[d+76>>2];c[h+160>>2]=c[d+80>>2];c[h+164>>2]=c[d+84>>2];c[h+168>>2]=c[d+88>>2];c[h+172>>2]=c[d+92>>2];c[h+176>>2]=c[d+96>>2];c[h+180>>2]=c[d+100>>2];c[h+184>>2]=c[d+104>>2];c[h+188>>2]=c[d+108>>2];O=h+192|0;c[O+0>>2]=c[d+112>>2];c[O+4>>2]=c[d+116>>2];c[O+8>>2]=c[d+120>>2];c[O+12>>2]=c[d+124>>2];r=+g[N>>2];s=+g[O>>2];t=+g[h+260>>2];u=+g[h+196>>2];n=+g[h+264>>2];o=+g[h+200>>2];g[N>>2]=r-(r+s)*.5;g[h+260>>2]=t-(t+u)*.5;g[h+264>>2]=n-(n+o)*.5;g[O>>2]=s-(r+s)*.5;g[h+196>>2]=u-(t+u)*.5;g[h+200>>2]=o-(n+o)*.5;if(((c[(c[b+28>>2]|0)+4>>2]|0)+ -17|0)>>>0<2)y=((c[(c[b+32>>2]|0)+4>>2]|0)+ -17|0)>>>0<2;else y=0;w=+g[b+44>>2];v=+g[b+48>>2];c[3344]=(c[3344]|0)+1;O=(a[b+52>>0]|0)==0;v=O?v:0.0;c[b+64>>2]=0;g[b+4>>2]=0.0;g[b+8>>2]=1.0;g[b+12>>2]=0.0;g[b+16>>2]=0.0;c[b+68>>2]=0;c[b+60>>2]=-1;w=(O?w:0.0)+v;O=c[b+24>>2]|0;a[O+312>>0]=0;c[O>>2]=0;a[O+356>>0]=1;g[O+292>>2]=999999984306749400.0;g[O+296>>2]=999999984306749400.0;g[O+300>>2]=999999984306749400.0;g[O+304>>2]=0.0;c[O+336>>2]=0;c[O+340>>2]=0;c[O+344>>2]=0;c[O+348>>2]=0;a[O+352>>0]=0;a[O+332>>0]=a[O+332>>0]&-16;A=+g[b+4>>2];B=+g[b+8>>2];F=+g[b+12>>2];a:do if(y){z=999999984306749400.0;while(1){K=-A;L=-B;C=-F;M=+g[d+4>>2]*K+ +g[d+20>>2]*L+ +g[d+36>>2]*C;E=+g[d+8>>2]*K+ +g[d+24>>2]*L+ +g[d+40>>2]*C;g[h+128>>2]=+g[d>>2]*K+ +g[d+16>>2]*L+ +g[d+32>>2]*C;g[h+132>>2]=M;g[h+136>>2]=E;g[h+140>>2]=0.0;E=A*+g[d+68>>2]+B*+g[d+84>>2]+F*+g[d+100>>2];M=A*+g[d+72>>2]+B*+g[d+88>>2]+F*+g[d+104>>2];g[h+112>>2]=+g[d+64>>2]*A+ +g[d+80>>2]*B+ +g[d+96>>2]*F;g[h+116>>2]=E;g[h+120>>2]=M;g[h+124>>2]=0.0;$w(h+96|0,c[b+28>>2]|0,h+128|0);$w(h+80|0,c[b+32>>2]|0,h+112|0);F=+g[h+96>>2];M=+g[h+100>>2];B=+g[h+104>>2];E=F*+g[h+208>>2]+M*+g[h+212>>2]+B*+g[h+216>>2]+ +g[h+256>>2];B=F*+g[h+224>>2]+M*+g[h+228>>2]+B*+g[h+232>>2]+ +g[h+260>>2];M=+g[h+80>>2];F=+g[h+84>>2];C=+g[h+88>>2];A=M*+g[h+144>>2]+F*+g[h+148>>2]+C*+g[h+152>>2]+ +g[h+192>>2];C=M*+g[h+160>>2]+F*+g[h+164>>2]+C*+g[h+168>>2]+ +g[h+196>>2];F=+g[b+4>>2]*(E-A)+ +g[b+8>>2]*(B-C)+ +g[b+12>>2]*0.0;if(F>0.0?F*F>z*+g[d+128>>2]:0){j=22;break a}y=c[b+24>>2]|0;D=c[y>>2]|0;if((D|0)>0){G=+g[y+308>>2];O=0;N=0;do{K=E-A- +g[y+(N<<4)+4>>2];L=B-C- +g[y+(N<<4)+8>>2];M=0.0- +g[y+(N<<4)+12>>2];O=O|K*K+L*L+M*M<=G;N=N+1|0}while((N|0)!=(D|0))}else O=0;if((+g[y+304>>2]==0.0?+g[y+300>>2]==0.0:0)?B-C==+g[y+296>>2]:0)N=E-A==+g[y+292>>2];else N=0;if(N|O){j=31;break a}H=z-F;if(H<=z*9.999999974752427e-7){j=33;break a}g[y+292>>2]=E-A;g[y+296>>2]=B-C;g[y+300>>2]=0.0;g[y+304>>2]=0.0;a[y+356>>0]=1;g[y+(D<<4)+4>>2]=E-A;g[y+(D<<4)+8>>2]=B-C;g[y+(D<<4)+12>>2]=0.0;g[y+(D<<4)+16>>2]=0.0;N=c[y>>2]|0;g[y+(N<<4)+84>>2]=E;g[y+(N<<4)+88>>2]=B;g[y+(N<<4)+92>>2]=0.0;g[y+(N<<4)+96>>2]=0.0;N=c[y>>2]|0;g[y+(N<<4)+164>>2]=A;g[y+(N<<4)+168>>2]=C;g[y+(N<<4)+172>>2]=0.0;g[y+(N<<4)+176>>2]=0.0;c[y>>2]=(c[y>>2]|0)+1;N=c[b+24>>2]|0;O=vC(N)|0;A=+g[N+276>>2];B=+g[N+280>>2];F=+g[N+284>>2];E=+g[N+288>>2];if(!O){j=35;break a}C=z;z=A*A+B*B+F*F;if(z<9.999999974752427e-7){z=C;j=37;break a}if(C-z<=C*1.1920928955078125e-7){j=39;break a}g[b+4>>2]=A;g[b+8>>2]=B;g[b+12>>2]=F;g[b+16>>2]=E;O=c[b+64>>2]|0;c[b+64>>2]=O+1;if((O|0)>1e3){z=0.0;y=0;A=0.0;B=0.0;C=0.0;break a}if((c[c[b+24>>2]>>2]|0)==4){j=42;break}}}else{z=999999984306749400.0;while(1){G=-A;E=-B;C=-F;H=+g[d+4>>2]*G+ +g[d+20>>2]*E+ +g[d+36>>2]*C;M=+g[d+8>>2]*G+ +g[d+24>>2]*E+ +g[d+40>>2]*C;g[h+128>>2]=+g[d>>2]*G+ +g[d+16>>2]*E+ +g[d+32>>2]*C;g[h+132>>2]=H;g[h+136>>2]=M;g[h+140>>2]=0.0;M=A*+g[d+68>>2]+B*+g[d+84>>2]+F*+g[d+100>>2];H=A*+g[d+72>>2]+B*+g[d+88>>2]+F*+g[d+104>>2];g[h+112>>2]=+g[d+64>>2]*A+ +g[d+80>>2]*B+ +g[d+96>>2]*F;g[h+116>>2]=M;g[h+120>>2]=H;g[h+124>>2]=0.0;$w(h+96|0,c[b+28>>2]|0,h+128|0);$w(h+80|0,c[b+32>>2]|0,h+112|0);H=+g[h+96>>2];M=+g[h+100>>2];F=+g[h+104>>2];B=H*+g[h+208>>2]+M*+g[h+212>>2]+F*+g[h+216>>2]+ +g[h+256>>2];C=H*+g[h+224>>2]+M*+g[h+228>>2]+F*+g[h+232>>2]+ +g[h+260>>2];F=H*+g[h+240>>2]+M*+g[h+244>>2]+F*+g[h+248>>2]+ +g[h+264>>2];M=+g[h+80>>2];H=+g[h+84>>2];E=+g[h+88>>2];A=M*+g[h+144>>2]+H*+g[h+148>>2]+E*+g[h+152>>2]+ +g[h+192>>2];G=M*+g[h+160>>2]+H*+g[h+164>>2]+E*+g[h+168>>2]+ +g[h+196>>2];E=M*+g[h+176>>2]+H*+g[h+180>>2]+E*+g[h+184>>2]+ +g[h+200>>2];H=+g[b+4>>2]*(B-A)+ +g[b+8>>2]*(C-G)+ +g[b+12>>2]*(F-E);if(H>0.0?H*H>z*+g[d+128>>2]:0){j=22;break a}D=c[b+24>>2]|0;y=c[D>>2]|0;if((y|0)>0){I=+g[D+308>>2];O=0;N=0;do{K=B-A- +g[D+(N<<4)+4>>2];L=C-G- +g[D+(N<<4)+8>>2];M=F-E- +g[D+(N<<4)+12>>2];O=O|K*K+L*L+M*M<=I;N=N+1|0}while((N|0)!=(y|0))}else O=0;if((+g[D+304>>2]==0.0?F-E==+g[D+300>>2]:0)?C-G==+g[D+296>>2]:0)N=B-A==+g[D+292>>2];else N=0;if(N|O){j=31;break a}H=z-H;if(H<=z*9.999999974752427e-7){j=33;break a}g[D+292>>2]=B-A;g[D+296>>2]=C-G;g[D+300>>2]=F-E;g[D+304>>2]=0.0;a[D+356>>0]=1;g[D+(y<<4)+4>>2]=B-A;g[D+(y<<4)+8>>2]=C-G;g[D+(y<<4)+12>>2]=F-E;g[D+(y<<4)+16>>2]=0.0;N=c[D>>2]|0;g[D+(N<<4)+84>>2]=B;g[D+(N<<4)+88>>2]=C;g[D+(N<<4)+92>>2]=F;g[D+(N<<4)+96>>2]=0.0;N=c[D>>2]|0;g[D+(N<<4)+164>>2]=A;g[D+(N<<4)+168>>2]=G;g[D+(N<<4)+172>>2]=E;g[D+(N<<4)+176>>2]=0.0;c[D>>2]=(c[D>>2]|0)+1;N=c[b+24>>2]|0;O=vC(N)|0;A=+g[N+276>>2];B=+g[N+280>>2];F=+g[N+284>>2];E=+g[N+288>>2];if(!O){j=35;break a}C=z;z=A*A+B*B+F*F;if(z<9.999999974752427e-7){z=C;j=37;break a}if(C-z<=C*1.1920928955078125e-7){j=39;break a}g[b+4>>2]=A;g[b+8>>2]=B;g[b+12>>2]=F;g[b+16>>2]=E;O=c[b+64>>2]|0;c[b+64>>2]=O+1;if((O|0)>1e3){z=0.0;y=0;A=0.0;B=0.0;C=0.0;break a}if((c[c[b+24>>2]>>2]|0)==4){j=42;break}}}while(0);if((j|0)==22){c[b+68>>2]=10;j=43}else if((j|0)==31){c[b+68>>2]=1;j=43}else if((j|0)==33){c[b+68>>2]=!(H<=0.0)?11:2;j=43}else if((j|0)==35){c[b+68>>2]=3;j=43}else if((j|0)==37){g[b+4>>2]=A;g[b+8>>2]=B;g[b+12>>2]=F;g[b+16>>2]=E;c[b+68>>2]=6;j=43}else if((j|0)==39){c[b+68>>2]=12;j=43}else if((j|0)==42){c[b+68>>2]=13;z=0.0;y=0;A=0.0;B=0.0;C=0.0}do if((j|0)==43){O=c[b+24>>2]|0;vC(O)|0;A=+g[O+260>>2];B=+g[O+264>>2];C=+g[O+268>>2];c[h+272>>2]=c[b+4>>2];c[h+276>>2]=c[b+8>>2];c[h+280>>2]=c[b+12>>2];c[h+284>>2]=c[b+16>>2];G=+g[b+4>>2];F=+g[b+8>>2];E=+g[b+12>>2];if(G*G+F*F+E*E<1.0e-4)c[b+68>>2]=5;if(G*G+F*F+E*E>1.4210854715202004e-14){L=1.0/+Q(+(G*G+F*F+E*E));g[h+272>>2]=L*+g[h+272>>2];g[p>>2]=L*+g[p>>2];g[q>>2]=L*+g[q>>2];M=v/+Q(+z);c[b+60>>2]=1;z=1.0/L-w;y=1;A=M*G+A;B=M*F+B;C=M*E+C;break}else{c[b+60>>2]=2;z=0.0;y=0;break}}while(0);if(((c[b+72>>2]|0)!=0?(c[b+20>>2]|0)!=0:0)?(c[b+68>>2]|0)!=0:0)N=w+z<.01;else N=0;D=y^1;do if(N|D?(x=c[b+20>>2]|0,(x|0)!=0):0){c[3342]=(c[3342]|0)+1;c[b+4>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;c[b+16>>2]=0;if(!(Ob[c[(c[x>>2]|0)+8>>2]&3](x,c[b+24>>2]|0,c[b+28>>2]|0,c[b+32>>2]|0,h+208|0,h+144|0,b+4|0,h+64|0,h+48|0,f)|0)){I=+g[b+4>>2];H=+g[b+8>>2];E=+g[b+12>>2];if(!(I*I+H*H+E*E>0.0)){j=66;break}J=+g[h+48>>2];K=+g[h+64>>2]-J;G=+g[h+52>>2];L=+g[h+68>>2]-G;F=+g[h+56>>2];M=+g[h+72>>2]-F;w=+Q(+(K*K+L*L+M*M))-w;if(w<z|D){c[h+272>>2]=c[b+4>>2];c[h+276>>2]=c[b+8>>2];c[h+280>>2]=c[b+12>>2];c[h+284>>2]=c[b+16>>2];C=+g[h+272>>2];B=+g[p>>2];A=+g[q>>2];z=1.0/+Q(+(C*C+B*B+A*A));g[h+272>>2]=C*z;g[p>>2]=B*z;g[q>>2]=A*z;c[b+60>>2]=6;z=w;A=v*I+J;B=v*H+G;C=v*E+F;break}c[b+60>>2]=5;if(y)break;i=h;return}E=+g[h+48>>2];L=+g[h+64>>2];w=+g[h+52>>2];K=+g[h+68>>2];v=+g[h+56>>2];J=+g[h+72>>2];if(!((E-L)*(E-L)+(w-K)*(w-K)+(v-J)*(v-J)<=1.4210854715202004e-14)){H=v-J;G=w-K;I=E-L;F=0.0;M=(E-L)*(E-L)+(w-K)*(w-K)+(v-J)*(v-J)}else{R=+g[b+4>>2];P=+g[b+8>>2];M=+g[b+12>>2];H=M;G=P;I=R;F=+g[b+16>>2];M=R*R+P*P+M*M}if(!(M>1.4210854715202004e-14)){c[b+60>>2]=9;if(y)break;i=h;return}M=1.0/+Q(+M);J=-+Q(+((L-E)*(L-E)+(K-w)*(K-w)+(J-v)*(J-v)));if(z>J|D){g[h+272>>2]=I*M;g[p>>2]=G*M;g[q>>2]=H*M;g[h+284>>2]=F;c[b+60>>2]=3;z=J;A=E;B=w;C=v;break}c[b+60>>2]=8;if(!y){i=h;return}}else j=66;while(0);if((j|0)==66)if(!y){i=h;return}if(!(z<0.0)?!(z*z<+g[d+128>>2]):0){i=h;return}if((c[b+76>>2]|0)!=0?(O=c[b+28>>2]|0,vc[c[(c[O>>2]|0)+8>>2]&127](O,h+208|0,h+32|0,h+16|0),M=(+g[h+16>>2]+ +g[h+32>>2])*.5,P=(+g[h+20>>2]+ +g[h+36>>2])*.5,R=(+g[h+24>>2]+ +g[h+40>>2])*.5,O=c[b+32>>2]|0,vc[c[(c[O>>2]|0)+8>>2]&127](O,h+144|0,h+32|0,h+16|0),k=+g[h+272>>2],l=+g[p>>2],m=+g[q>>2],(M-(+g[h+32>>2]+ +g[h+16>>2])*.5)*k+(P-(+g[h+36>>2]+ +g[h+20>>2])*.5)*l+(R-(+g[h+40>>2]+ +g[h+24>>2])*.5)*m<0.0):0){g[h+272>>2]=k*-1.0;g[p>>2]=l*-1.0;g[q>>2]=m*-1.0}c[b+4>>2]=c[h+272>>2];c[b+8>>2]=c[h+276>>2];c[b+12>>2]=c[h+280>>2];c[b+16>>2]=c[h+284>>2];g[b+56>>2]=z;O=c[(c[e>>2]|0)+16>>2]|0;g[h>>2]=(r+s)*.5+A;g[h+4>>2]=(t+u)*.5+B;g[h+8>>2]=(n+o)*.5+C;g[h+12>>2]=0.0;qc[O&15](e,h+272|0,h,z);i=h;return}function Bz(a){a=a|0;return}function Cz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Dz(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0,j=0,k=0,l=0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0,y=0,z=0.0,A=0.0,B=0.0;l=i;i=i+192|0;h=c[b+4>>2]|0;if(+g[h+752>>2]<f){i=l;return}j=c[h+740>>2]|0;m=(c[b+8>>2]|0)+8|0;k=c[m>>2]|0;q=+g[e>>2];t=+g[d>>2]*f+q;o=+g[e+4>>2];r=+g[d+4>>2]*f+o;p=+g[e+8>>2];s=+g[d+8>>2]*f+p;if((j|0)!=(k|0)){n=c[b+12>>2]|0;y=c[n+8>>2]|0;B=t- +g[y+52>>2];v=r- +g[y+56>>2];w=s- +g[y+60>>2];A=q- +g[k+52>>2];z=o- +g[k+56>>2];u=p- +g[k+60>>2];q=B*+g[y+4>>2]+v*+g[y+20>>2]+w*+g[y+36>>2];o=B*+g[y+8>>2]+v*+g[y+24>>2]+w*+g[y+40>>2];p=B*+g[y+12>>2]+v*+g[y+28>>2]+w*+g[y+44>>2];w=A*+g[k+4>>2]+z*+g[k+20>>2]+u*+g[k+36>>2];v=A*+g[k+8>>2]+z*+g[k+24>>2]+u*+g[k+40>>2];u=A*+g[k+12>>2]+z*+g[k+28>>2]+u*+g[k+44>>2]}else{z=t- +g[j+52>>2];v=r- +g[j+56>>2];w=s- +g[j+60>>2];n=c[b+12>>2]|0;y=c[n+8>>2]|0;A=q- +g[y+52>>2];B=o- +g[y+56>>2];u=p- +g[y+60>>2];q=z*+g[j+4>>2]+v*+g[j+20>>2]+w*+g[j+36>>2];o=z*+g[j+8>>2]+v*+g[j+24>>2]+w*+g[j+40>>2];p=z*+g[j+12>>2]+v*+g[j+28>>2]+w*+g[j+44>>2];w=A*+g[y+4>>2]+B*+g[y+20>>2]+u*+g[y+36>>2];v=A*+g[y+8>>2]+B*+g[y+24>>2]+u*+g[y+40>>2];u=A*+g[y+12>>2]+B*+g[y+28>>2]+u*+g[y+44>>2]}g[l>>2]=q;g[l+4>>2]=o;g[l+8>>2]=p;g[l+12>>2]=0.0;g[l+16>>2]=w;g[l+20>>2]=v;g[l+24>>2]=u;g[l+28>>2]=0.0;c[l+64>>2]=c[d+0>>2];c[l+68>>2]=c[d+4>>2];c[l+72>>2]=c[d+8>>2];c[l+76>>2]=c[d+12>>2];g[l+80>>2]=f;g[l+84>>2]=0.0;g[l+88>>2]=0.0;g[l+92>>2]=0.0;c[l+112>>2]=0;a[l+116>>0]=0;c[l+120>>2]=0;c[l+124>>2]=0;c[l+128>>2]=0;c[l+132>>2]=0;c[l+136>>2]=0;c[l+140>>2]=0;c[l+144>>2]=0;c[l+148>>2]=0;g[l+48>>2]=t;g[l+52>>2]=r;g[l+56>>2]=s;g[l+60>>2]=0.0;c[l+32>>2]=c[e+0>>2];c[l+36>>2]=c[e+4>>2];c[l+40>>2]=c[e+8>>2];c[l+44>>2]=c[e+12>>2];r=+g[h+752>>2];d=c[h+748>>2]|0;if((d|0)>0){e=0;y=-1;f=r*r;while(1){r=+g[h+(e*184|0)+4>>2]-q;s=+g[h+(e*184|0)+8>>2]-o;t=+g[h+(e*184|0)+12>>2]-p;x=r*r+s*s+t*t<f;y=x?e:y;e=e+1|0;if((e|0)==(d|0))break;else f=x?r*r+s*s+t*t:f}}else y=-1;d=c[m>>2]|0;x=c[n+8>>2]|0;o=+g[d+224>>2]*+g[x+224>>2];o=o<-10.0?-10.0:o;g[l+84>>2]=o>10.0?10.0:o;g[l+92>>2]=+g[d+228>>2]*+g[x+228>>2];o=+g[d+232>>2]*+g[x+232>>2];o=o<-10.0?-10.0:o;g[l+88>>2]=o>10.0?10.0:o;o=+g[l+72>>2];if(+P(+o)>.7071067690849304){z=+g[l+68>>2];B=1.0/+Q(+(o*o+z*z));g[l+152>>2]=0.0;g[l+156>>2]=-(B*o);g[l+160>>2]=B*z;g[l+168>>2]=(o*o+z*z)*B;A=+g[l+64>>2];g[l+172>>2]=-(A*B*z);g[l+176>>2]=A*-(B*o)}else{z=+g[l+64>>2];A=+g[l+68>>2];B=1.0/+Q(+(z*z+A*A));g[l+152>>2]=-(A*B);g[l+156>>2]=B*z;g[l+160>>2]=0.0;g[l+168>>2]=-(o*B*z);g[l+172>>2]=o*-(A*B);g[l+176>>2]=(z*z+A*A)*B}if((j|0)!=(k|0)){c[l+96>>2]=c[b+20>>2];c[l+100>>2]=c[b+16>>2];c[l+104>>2]=c[b+28>>2];c[l+108>>2]=c[b+24>>2]}else{c[l+96>>2]=c[b+16>>2];c[l+100>>2]=c[b+20>>2];c[l+104>>2]=c[b+24>>2];c[l+108>>2]=c[b+28>>2]}if((y|0)>-1){x=h+(y*184|0)+152|0;d=c[x>>2]|0;m=h+(y*184|0)+124|0;z=+g[m>>2];n=h+(y*184|0)+128|0;A=+g[n>>2];e=h+(y*184|0)+132|0;B=+g[e>>2];k=h+(y*184|0)+116|0;j=c[k>>2]|0;mF(h+(y*184|0)+4|0,l|0,184)|0;c[k>>2]=j;g[m>>2]=z;g[n>>2]=A;g[e>>2]=B;c[x>>2]=d;i=l;return}else{wA(h,l)|0;i=l;return}}function Ez(b,d,e,f,h,j,k,l,m,n){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;l=l|0;m=m|0;n=n|0;var o=0,p=0.0,q=0.0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0,B=0,C=0,D=0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0;b=i;i=i+4256|0;if(((c[e+4>>2]|0)+ -17|0)>>>0<2)r=((c[f+4>>2]|0)+ -17|0)>>>0<2;else r=0;o=0;do{Fz();v=+g[13568+(o<<4)>>2];w=+g[13572+(o<<4)>>2];x=+g[13576+(o<<4)>>2];z=+g[h+4>>2]*-v+ +g[h+20>>2]*-w+ +g[h+36>>2]*-x;y=+g[h+8>>2]*-v+ +g[h+24>>2]*-w+ +g[h+40>>2]*-x;g[b+1280+(o<<4)>>2]=+g[h>>2]*-v+ +g[h+16>>2]*-w+ +g[h+32>>2]*-x;g[b+1280+(o<<4)+4>>2]=z;g[b+1280+(o<<4)+8>>2]=y;g[b+1280+(o<<4)+12>>2]=0.0;y=v*+g[j+4>>2]+w*+g[j+20>>2]+x*+g[j+36>>2];z=v*+g[j+8>>2]+w*+g[j+24>>2]+x*+g[j+40>>2];g[b+288+(o<<4)>>2]=v*+g[j>>2]+w*+g[j+16>>2]+x*+g[j+32>>2];g[b+288+(o<<4)+4>>2]=y;g[b+288+(o<<4)+8>>2]=z;g[b+288+(o<<4)+12>>2]=0.0;o=o+1|0}while((o|0)!=42);A=Pb[c[(c[e>>2]|0)+84>>2]&127](e)|0;if((A|0)>0){B=0;o=42;while(1){rc[c[(c[e>>2]|0)+88>>2]&127](e,B,b+272|0);y=+g[b+272>>2];z=+g[b+276>>2];x=+g[b+280>>2];w=y*+g[h+16>>2]+z*+g[h+20>>2]+x*+g[h+24>>2];v=y*+g[h+32>>2]+z*+g[h+36>>2]+x*+g[h+40>>2];g[b+272>>2]=+g[h>>2]*y+ +g[h+4>>2]*z+ +g[h+8>>2]*x;g[b+276>>2]=w;g[b+280>>2]=v;g[b+284>>2]=0.0;Fz();C=13568+(o<<4)|0;c[C+0>>2]=c[b+272>>2];c[C+4>>2]=c[b+276>>2];c[C+8>>2]=c[b+280>>2];c[C+12>>2]=c[b+284>>2];v=+g[b+272>>2];w=+g[b+276>>2];x=+g[b+280>>2];z=+g[h+4>>2]*-v+ +g[h+20>>2]*-w+ +g[h+36>>2]*-x;y=+g[h+8>>2]*-v+ +g[h+24>>2]*-w+ +g[h+40>>2]*-x;g[b+1280+(o<<4)>>2]=+g[h>>2]*-v+ +g[h+16>>2]*-w+ +g[h+32>>2]*-x;g[b+1280+(o<<4)+4>>2]=z;g[b+1280+(o<<4)+8>>2]=y;g[b+1280+(o<<4)+12>>2]=0.0;y=v*+g[j+4>>2]+w*+g[j+20>>2]+x*+g[j+36>>2];z=v*+g[j+8>>2]+w*+g[j+24>>2]+x*+g[j+40>>2];g[b+288+(o<<4)>>2]=+g[j>>2]*v+ +g[j+16>>2]*w+ +g[j+32>>2]*x;g[b+288+(o<<4)+4>>2]=y;g[b+288+(o<<4)+8>>2]=z;g[b+288+(o<<4)+12>>2]=0.0;B=B+1|0;if((B|0)==(A|0))break;else o=o+1|0}o=A+42|0}else o=42;C=Pb[c[(c[f>>2]|0)+84>>2]&127](f)|0;if((C|0)>0){B=0;A=o;while(1){rc[c[(c[f>>2]|0)+88>>2]&127](f,B,b+256|0);y=+g[b+256>>2];z=+g[b+260>>2];x=+g[b+264>>2];w=y*+g[j+16>>2]+z*+g[j+20>>2]+x*+g[j+24>>2];v=y*+g[j+32>>2]+z*+g[j+36>>2]+x*+g[j+40>>2];g[b+256>>2]=+g[j>>2]*y+ +g[j+4>>2]*z+ +g[j+8>>2]*x;g[b+260>>2]=w;g[b+264>>2]=v;g[b+268>>2]=0.0;Fz();D=13568+(A<<4)|0;c[D+0>>2]=c[b+256>>2];c[D+4>>2]=c[b+260>>2];c[D+8>>2]=c[b+264>>2];c[D+12>>2]=c[b+268>>2];v=+g[b+256>>2];w=+g[b+260>>2];x=+g[b+264>>2];z=+g[h+4>>2]*-v+ +g[h+20>>2]*-w+ +g[h+36>>2]*-x;y=+g[h+8>>2]*-v+ +g[h+24>>2]*-w+ +g[h+40>>2]*-x;g[b+1280+(A<<4)>>2]=+g[h>>2]*-v+ +g[h+16>>2]*-w+ +g[h+32>>2]*-x;g[b+1280+(A<<4)+4>>2]=z;g[b+1280+(A<<4)+8>>2]=y;g[b+1280+(A<<4)+12>>2]=0.0;y=v*+g[j+4>>2]+w*+g[j+20>>2]+x*+g[j+36>>2];z=v*+g[j+8>>2]+w*+g[j+24>>2]+x*+g[j+40>>2];g[b+288+(A<<4)>>2]=+g[j>>2]*v+ +g[j+16>>2]*w+ +g[j+32>>2]*x;g[b+288+(A<<4)+4>>2]=y;g[b+288+(A<<4)+8>>2]=z;g[b+288+(A<<4)+12>>2]=0.0;B=B+1|0;if((B|0)==(C|0))break;else A=A+1|0}o=C+o|0}vc[c[(c[e>>2]|0)+76>>2]&127](e,b+1280|0,b+3264|0,o);vc[c[(c[f>>2]|0)+76>>2]&127](f,b+288|0,b+2272|0,o);if((o|0)>0)if(r){v=0.0;w=0.0;x=0.0;r=0;s=999999984306749400.0;while(1){Fz();t=+g[13568+(r<<4)>>2];u=+g[13572+(r<<4)>>2];p=+g[13580+(r<<4)>>2];if(t*t+u*u+0.0>.01?(y=+g[b+3264+(r<<4)>>2],z=+g[b+3264+(r<<4)+4>>2],q=+g[b+3264+(r<<4)+8>>2],G=+g[b+2272+(r<<4)>>2],F=+g[b+2272+(r<<4)+4>>2],E=+g[b+2272+(r<<4)+8>>2],q=t*(G*+g[j>>2]+F*+g[j+4>>2]+E*+g[j+8>>2]+ +g[j+48>>2]-(y*+g[h>>2]+z*+g[h+4>>2]+q*+g[h+8>>2]+ +g[h+48>>2]))+u*(G*+g[j+16>>2]+F*+g[j+20>>2]+E*+g[j+24>>2]+ +g[j+52>>2]-(y*+g[h+16>>2]+z*+g[h+20>>2]+q*+g[h+24>>2]+ +g[h+52>>2]))+0.0,q<s):0)s=q;else{p=x;u=w;t=v}r=r+1|0;if((r|0)==(o|0)){q=0.0;break}else{v=t;w=u;x=p}}}else{t=0.0;x=0.0;y=0.0;z=0.0;r=0;s=999999984306749400.0;while(1){Fz();v=+g[13568+(r<<4)>>2];u=+g[13572+(r<<4)>>2];q=+g[13576+(r<<4)>>2];w=+g[13580+(r<<4)>>2];if(v*v+u*u+q*q>.01?(F=+g[b+3264+(r<<4)>>2],G=+g[b+3264+(r<<4)+4>>2],p=+g[b+3264+(r<<4)+8>>2],I=+g[b+2272+(r<<4)>>2],H=+g[b+2272+(r<<4)+4>>2],E=+g[b+2272+(r<<4)+8>>2],p=v*(I*+g[j>>2]+H*+g[j+4>>2]+E*+g[j+8>>2]+ +g[j+48>>2]-(F*+g[h>>2]+G*+g[h+4>>2]+p*+g[h+8>>2]+ +g[h+48>>2]))+u*(I*+g[j+16>>2]+H*+g[j+20>>2]+E*+g[j+24>>2]+ +g[j+52>>2]-(F*+g[h+16>>2]+G*+g[h+20>>2]+p*+g[h+24>>2]+ +g[h+52>>2]))+q*(I*+g[j+32>>2]+H*+g[j+36>>2]+E*+g[j+40>>2]+ +g[j+56>>2]-(F*+g[h+32>>2]+G*+g[h+36>>2]+p*+g[h+40>>2]+ +g[h+56>>2])),p<s):0){t=v;s=p}else{w=z;q=y;u=x}r=r+1|0;if((r|0)==(o|0)){p=w;break}else{x=u;y=q;z=w}}}else{p=0.0;q=0.0;u=0.0;t=0.0;s=999999984306749400.0}switch(c[e+4>>2]|0){case 4:case 5:case 10:case 11:case 13:case 1:case 0:case 8:break;default:+$b[c[(c[e>>2]|0)+48>>2]&15](e)}switch(c[f+4>>2]|0){case 4:case 5:case 10:case 11:case 13:case 1:case 0:case 8:break;default:+$b[c[(c[f>>2]|0)+48>>2]&15](f)}if(s<0.0){D=0;i=b;return D|0}switch(c[e+4>>2]|0){case 11:{v=+g[e+44>>2];break};case 10:{v=+g[e+44>>2];break};case 4:case 5:{v=+g[e+44>>2];break};case 8:{v=+g[e+28>>2]*+g[e+12>>2];break};case 0:{v=+g[e+44>>2];break};case 1:{v=+g[e+44>>2];break};case 13:{v=+g[e+44>>2];break};default:v=+$b[c[(c[e>>2]|0)+48>>2]&15](e)}o=c[f+4>>2]|0;switch(o|0){case 8:{w=+g[f+28>>2]*+g[f+12>>2];o=8;break};case 0:{w=+g[f+44>>2];o=0;break};case 1:{w=+g[f+44>>2];o=1;break};case 13:{w=+g[f+44>>2];o=13;break};case 11:{w=+g[f+44>>2];o=11;break};case 10:{w=+g[f+44>>2];o=10;break};case 4:case 5:{w=+g[f+44>>2];break};default:{w=+$b[c[(c[f>>2]|0)+48>>2]&15](f);o=c[f+4>>2]|0}}s=s+(v+w+.5);c[b+176>>2]=13392;g[b+180>>2]=0.0;g[b+184>>2]=1.0;g[b+188>>2]=0.0;g[b+192>>2]=0.0;c[b+196>>2]=0;c[b+200>>2]=d;c[b+204>>2]=e;c[b+208>>2]=f;c[b+212>>2]=c[e+4>>2];c[b+216>>2]=o;g[b+220>>2]=+$b[c[(c[e>>2]|0)+48>>2]&15](e);g[b+224>>2]=+$b[c[(c[f>>2]|0)+48>>2]&15](f);a[b+228>>0]=0;c[b+236>>2]=-1;c[b+248>>2]=1;c[b+252>>2]=1;G=+g[h+48>>2]+t*s;H=u*s+ +g[h+52>>2];I=q*s+ +g[h+56>>2];c[b+44>>2]=c[h+0>>2];c[b+48>>2]=c[h+4>>2];c[b+52>>2]=c[h+8>>2];c[b+56>>2]=c[h+12>>2];c[b+60>>2]=c[h+16>>2];c[b+64>>2]=c[h+20>>2];c[b+68>>2]=c[h+24>>2];c[b+72>>2]=c[h+28>>2];c[b+76>>2]=c[h+32>>2];c[b+80>>2]=c[h+36>>2];c[b+84>>2]=c[h+40>>2];c[b+88>>2]=c[h+44>>2];g[b+92>>2]=G;g[b+96>>2]=H;g[b+100>>2]=I;g[b+104>>2]=0.0;c[b+108>>2]=c[j+0>>2];c[b+112>>2]=c[j+4>>2];c[b+116>>2]=c[j+8>>2];c[b+120>>2]=c[j+12>>2];c[b+124>>2]=c[j+16>>2];c[b+128>>2]=c[j+20>>2];c[b+132>>2]=c[j+24>>2];c[b+136>>2]=c[j+28>>2];c[b+140>>2]=c[j+32>>2];c[b+144>>2]=c[j+36>>2];c[b+148>>2]=c[j+40>>2];c[b+152>>2]=c[j+44>>2];c[b+156>>2]=c[j+48>>2];c[b+160>>2]=c[j+52>>2];c[b+164>>2]=c[j+56>>2];c[b+168>>2]=c[j+60>>2];g[b+172>>2]=999999984306749400.0;c[b>>2]=14656;a[b+40>>0]=0;g[b+180>>2]=-t;g[b+184>>2]=-u;g[b+188>>2]=-q;g[b+192>>2]=0.0;Az(b+176|0,b+44|0,b,n,0);s=s- +g[b+36>>2];f=a[b+40>>0]|0;if(f<<24>>24){H=+g[b+24>>2]-u*s;I=+g[b+28>>2]-q*s;g[l>>2]=+g[b+20>>2]-t*s;g[l+4>>2]=H;g[l+8>>2]=I;g[l+12>>2]=0.0;c[m+0>>2]=c[b+20>>2];c[m+4>>2]=c[b+24>>2];c[m+8>>2]=c[b+28>>2];c[m+12>>2]=c[b+32>>2];g[k>>2]=t;g[k+4>>2]=u;g[k+8>>2]=q;g[k+12>>2]=p}D=f<<24>>24!=0;i=b;return D|0}function Fz(){var b=0;b=i;if(a[14560]|0){i=b;return}if(!(Ya(14560)|0)){i=b;return}g[3392]=0.0;g[3393]=-0.0;g[3394]=-1.0;g[3395]=0.0;g[3396]=.7236080169677734;g[3397]=-.5257250070571899;g[3398]=-.44721901416778564;g[3399]=0.0;g[3400]=-.2763879895210266;g[3401]=-.8506489992141724;g[3402]=-.44721901416778564;g[3403]=0.0;g[3404]=-.8944259881973267;g[3405]=-0.0;g[3406]=-.4472160041332245;g[3407]=0.0;g[3408]=-.2763879895210266;g[3409]=.8506489992141724;g[3410]=-.44721999764442444;g[3411]=0.0;g[3412]=.7236080169677734;g[3413]=.5257250070571899;g[3414]=-.44721901416778564;g[3415]=0.0;g[3416]=.2763879895210266;g[3417]=-.8506489992141724;g[3418]=.44721999764442444;g[3419]=0.0;g[3420]=-.7236080169677734;g[3421]=-.5257250070571899;g[3422]=.44721901416778564;g[3423]=0.0;g[3424]=-.7236080169677734;g[3425]=.5257250070571899;g[3426]=.44721901416778564;g[3427]=0.0;g[3428]=.2763879895210266;g[3429]=.8506489992141724;g[3430]=.44721901416778564;g[3431]=0.0;g[3432]=.8944259881973267;g[3433]=0.0;g[3434]=.4472160041332245;g[3435]=0.0;g[3436]=-0.0;g[3437]=0.0;g[3438]=1.0;g[3439]=0.0;g[3440]=.4253230094909668;g[3441]=-.3090110123157501;g[3442]=-.8506540060043335;g[3443]=0.0;g[3444]=-.16245600581169128;g[3445]=-.49999499320983887;g[3446]=-.8506540060043335;g[3447]=0.0;g[3448]=.2628690004348755;g[3449]=-.8090119957923889;g[3450]=-.525738000869751;g[3451]=0.0;g[3452]=.4253230094909668;g[3453]=.3090110123157501;g[3454]=-.8506540060043335;g[3455]=0.0;g[3456]=.8506479859352112;g[3457]=-0.0;g[3458]=-.5257359743118286;g[3459]=0.0;g[3460]=-.5257300138473511;g[3461]=-0.0;g[3462]=-.8506519794464111;g[3463]=0.0;g[3464]=-.6881899833679199;g[3465]=-.49999698996543884;g[3466]=-.5257359743118286;g[3467]=0.0;g[3468]=-.16245600581169128;g[3469]=.49999499320983887;g[3470]=-.8506540060043335;g[3471]=0.0;g[3472]=-.6881899833679199;g[3473]=.49999698996543884;g[3474]=-.5257359743118286;g[3475]=0.0;g[3476]=.2628690004348755;g[3477]=.8090119957923889;g[3478]=-.525738000869751;g[3479]=0.0;g[3480]=.9510579705238342;g[3481]=.3090130090713501;g[3482]=0.0;g[3483]=0.0;g[3484]=.9510579705238342;g[3485]=-.3090130090713501;g[3486]=0.0;g[3487]=0.0;g[3488]=.5877860188484192;g[3489]=-.80901700258255;g[3490]=0.0;g[3491]=0.0;g[3492]=0.0;g[3493]=-1.0;g[3494]=0.0;g[3495]=0.0;g[3496]=-.5877860188484192;g[3497]=-.80901700258255;g[3498]=0.0;g[3499]=0.0;g[3500]=-.9510579705238342;g[3501]=-.3090130090713501;g[3502]=-0.0;g[3503]=0.0;g[3504]=-.9510579705238342;g[3505]=.3090130090713501;g[3506]=-0.0;g[3507]=0.0;g[3508]=-.5877860188484192;g[3509]=.80901700258255;g[3510]=-0.0;g[3511]=0.0;g[3512]=-0.0;g[3513]=1.0;g[3514]=-0.0;g[3515]=0.0;g[3516]=.5877860188484192;g[3517]=.80901700258255;g[3518]=-0.0;g[3519]=0.0;g[3520]=.6881899833679199;g[3521]=-.49999698996543884;g[3522]=.5257359743118286;g[3523]=0.0;g[3524]=-.2628690004348755;g[3525]=-.8090119957923889;g[3526]=.525738000869751;g[3527]=0.0;g[3528]=-.8506479859352112;g[3529]=0.0;g[3530]=.5257359743118286;g[3531]=0.0;g[3532]=-.2628690004348755;g[3533]=.8090119957923889;g[3534]=.525738000869751;g[3535]=0.0;g[3536]=.6881899833679199;g[3537]=.49999698996543884;g[3538]=.5257359743118286;g[3539]=0.0;g[3540]=.5257300138473511;g[3541]=0.0;g[3542]=.8506519794464111;g[3543]=0.0;g[3544]=.16245600581169128;g[3545]=-.49999499320983887;g[3546]=.8506540060043335;g[3547]=0.0;g[3548]=-.4253230094909668;g[3549]=-.3090110123157501;g[3550]=.8506540060043335;g[3551]=0.0;g[3552]=-.4253230094909668;g[3553]=.3090110123157501;g[3554]=.8506540060043335;g[3555]=0.0;g[3556]=.16245600581169128;g[3557]=.49999499320983887;g[3558]=.8506540060043335;g[3559]=0.0;bb(14560);i=b;return}function Gz(a){a=a|0;return}function Hz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Iz(a){a=a|0;return}function Jz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Kz(a,b,c){a=a|0;b=b|0;c=c|0;return}function Lz(a,b,c){a=a|0;b=b|0;c=c|0;return}function Mz(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0;h=i;c[b+4>>2]=c[d+0>>2];c[b+8>>2]=c[d+4>>2];c[b+12>>2]=c[d+8>>2];c[b+16>>2]=c[d+12>>2];c[b+20>>2]=c[e+0>>2];c[b+24>>2]=c[e+4>>2];c[b+28>>2]=c[e+8>>2];c[b+32>>2]=c[e+12>>2];g[b+36>>2]=f;a[b+40>>0]=1;i=h;return}function Nz(a){a=a|0;var b=0;b=i;MA(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function Oz(a){a=a|0;var b=0;b=i;MA(a);i=b;return}function Pz(d,e,f,h,j){d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0,w=0,x=0,y=0;k=i;i=i+176|0;a[d+60>>0]=f&1;if(f){t=+g[h>>2]+-1.0;q=+g[h+4>>2]+-1.0;r=+g[h+8>>2]+-1.0;g[d+4>>2]=t;g[d+8>>2]=q;g[d+12>>2]=r;g[d+16>>2]=0.0;o=+g[j>>2]+1.0;m=+g[j+4>>2]+1.0;l=+g[j+8>>2]+1.0;g[d+20>>2]=o;g[d+24>>2]=m;g[d+28>>2]=l;g[d+32>>2]=0.0;g[d+36>>2]=65533.0/(o-t);g[d+40>>2]=65533.0/(m-q);g[d+44>>2]=65533.0/(l-r);g[d+48>>2]=0.0;a[d+60>>0]=1;n=t+ +(~~((t-t)*(65533.0/(o-t)))&65534)/(65533.0/(o-t))+-1.0;p=q+ +(~~((q-q)*(65533.0/(m-q)))&65534)/(65533.0/(m-q))+-1.0;s=r+ +(~~((r-r)*(65533.0/(l-r)))&65534)/(65533.0/(l-r))+-1.0;if(n<t)g[d+4>>2]=n;else n=t;if(p<q)g[d+8>>2]=p;else p=q;if(s<r)g[d+12>>2]=s;else s=r;u=n+ +((~~((o-n)*(65533.0/(o-t))+1.0)&65535|1)&65535)/(65533.0/(o-t))+1.0;t=p+ +((~~((m-p)*(65533.0/(m-q))+1.0)&65535|1)&65535)/(65533.0/(m-q))+1.0;q=s+ +((~~((l-s)*(65533.0/(l-r))+1.0)&65535|1)&65535)/(65533.0/(l-r))+1.0;if(o<u){g[d+20>>2]=u;o=u}if(m<t){g[d+24>>2]=t;m=t}if(l<q){g[d+28>>2]=q;l=q}g[d+36>>2]=65533.0/(o-n);g[d+40>>2]=65533.0/(m-p);g[d+44>>2]=65533.0/(l-s);g[d+48>>2]=0.0;c[k+152>>2]=15096;c[k+156>>2]=d+104;c[k+160>>2]=d;vc[c[(c[e>>2]|0)+8>>2]&127](e,k+152|0,d+4|0,d+20|0);e=c[d+108>>2]|0;c[k+136>>2]=0;c[k+140>>2]=0;c[k+144>>2]=0;c[k+148>>2]=0;j=c[d+128>>2]|0;if((j|0)<(e<<1|0)){if((c[d+132>>2]|0)<(e<<1|0)){if(!e){h=0;v=j}else{c[5004]=(c[5004]|0)+1;h=fF(e<<5|19)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}v=c[d+128>>2]|0}if((v|0)>0){f=0;do{y=h+(f<<4)|0;x=(c[d+136>>2]|0)+(f<<4)|0;c[y+0>>2]=c[x+0>>2];c[y+4>>2]=c[x+4>>2];c[y+8>>2]=c[x+8>>2];c[y+12>>2]=c[x+12>>2];f=f+1|0}while((f|0)!=(v|0))}f=c[d+136>>2]|0;if(f){if(a[d+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[d+136>>2]=0}a[d+140>>0]=1;c[d+136>>2]=h;c[d+132>>2]=e<<1;h=d+136|0}else h=d+136|0;do{y=(c[h>>2]|0)+(j<<4)|0;c[y+0>>2]=c[k+136>>2];c[y+4>>2]=c[k+140>>2];c[y+8>>2]=c[k+144>>2];c[y+12>>2]=c[k+148>>2];j=j+1|0}while((j|0)!=(e<<1|0))}c[d+128>>2]=e<<1}else{c[k+128>>2]=14960;c[k+132>>2]=d+64;g[k+112>>2]=-999999984306749400.0;g[k+116>>2]=-999999984306749400.0;g[k+120>>2]=-999999984306749400.0;g[k+124>>2]=0.0;g[k+96>>2]=999999984306749400.0;g[k+100>>2]=999999984306749400.0;g[k+104>>2]=999999984306749400.0;g[k+108>>2]=0.0;vc[c[(c[e>>2]|0)+8>>2]&127](e,k+128|0,k+112|0,k+96|0);e=c[d+68>>2]|0;h=k+32|0;v=h+64|0;do{c[h>>2]=0;h=h+4|0}while((h|0)<(v|0));j=c[d+88>>2]|0;if((j|0)<(e<<1|0)){if((c[d+92>>2]|0)<(e<<1|0)){if(!e){w=0;x=j}else{c[5004]=(c[5004]|0)+1;h=fF(e<<7|19)|0;if(!h)w=0;else{c[(h+19&-16)+ -4>>2]=h;w=h+19&-16}x=c[d+88>>2]|0}if((x|0)>0){y=0;do{h=w+(y<<6)+0|0;f=(c[d+96>>2]|0)+(y<<6)+0|0;v=h+64|0;do{c[h>>2]=c[f>>2];h=h+4|0;f=f+4|0}while((h|0)<(v|0));y=y+1|0}while((y|0)!=(x|0))}h=c[d+96>>2]|0;if(h){if(a[d+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[d+96>>2]=0}a[d+100>>0]=1;c[d+96>>2]=w;c[d+92>>2]=e<<1;w=d+96|0}else w=d+96|0;do{h=(c[w>>2]|0)+(j<<6)+0|0;f=k+32|0;v=h+64|0;do{c[h>>2]=c[f>>2];h=h+4|0;f=f+4|0}while((h|0)<(v|0));j=j+1|0}while((j|0)!=(e<<1|0))}c[d+88>>2]=e<<1}c[d+56>>2]=0;KA(d,0,e);if((a[d+60>>0]|0)!=0?(c[d+152>>2]|0)==0:0){if(!(c[d+156>>2]|0)){c[5004]=(c[5004]|0)+1;e=fF(51)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}h=c[d+152>>2]|0;if((h|0)>0){j=0;do{y=e+(j<<5)|0;x=(c[d+160>>2]|0)+(j<<5)|0;c[y+0>>2]=c[x+0>>2];c[y+4>>2]=c[x+4>>2];c[y+8>>2]=c[x+8>>2];c[y+12>>2]=c[x+12>>2];c[y+16>>2]=c[x+16>>2];c[y+20>>2]=c[x+20>>2];c[y+24>>2]=c[x+24>>2];c[y+28>>2]=c[x+28>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+160>>2]|0;if(j){if(a[d+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[d+160>>2]=0}a[d+164>>0]=1;c[d+160>>2]=e;c[d+156>>2]=1;j=(c[d+152>>2]|0)+1|0}else{j=1;e=c[d+160>>2]|0}c[d+152>>2]=j;c[e+0>>2]=c[k+0>>2];c[e+4>>2]=c[k+4>>2];c[e+8>>2]=c[k+8>>2];c[e+12>>2]=c[k+12>>2];c[e+16>>2]=c[k+16>>2];c[e+20>>2]=c[k+20>>2];c[e+24>>2]=c[k+24>>2];c[e+28>>2]=c[k+28>>2];y=c[d+160>>2]|0;x=c[d+136>>2]|0;b[y>>1]=b[x>>1]|0;b[y+2>>1]=b[x+2>>1]|0;b[y+4>>1]=b[x+4>>1]|0;b[y+6>>1]=b[x+6>>1]|0;b[y+8>>1]=b[x+8>>1]|0;b[y+10>>1]=b[x+10>>1]|0;c[y+12>>2]=0;x=c[x+12>>2]|0;c[y+16>>2]=(x|0)>-1?1:0-x|0}c[d+168>>2]=c[d+152>>2];e=c[d+116>>2]|0;if(e){if(a[d+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[d+116>>2]=0}a[d+120>>0]=1;c[d+116>>2]=0;c[d+108>>2]=0;c[d+112>>2]=0;e=c[d+76>>2]|0;if(!e){a[d+80>>0]=1;c[d+76>>2]=0;c[d+68>>2]=0;y=d+72|0;c[y>>2]=0;i=k;return}if(a[d+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[d+76>>2]=0;a[d+80>>0]=1;c[d+76>>2]=0;c[d+68>>2]=0;y=d+72|0;c[y>>2]=0;i=k;return}function Qz(a){a=a|0;return 84}function Rz(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0;e=i;QA(a,b,c,d)|0;i=e;return 1}function Sz(a){a=a|0;return}function Tz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Uz(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0.0,s=0,t=0,u=0,v=0,w=0,x=0.0,y=0.0,z=0.0,A=0.0;l=i;i=i+32|0;m=+g[d>>2];h=m<999999984306749400.0?m:999999984306749400.0;n=+g[d+4>>2];j=n<999999984306749400.0?n:999999984306749400.0;o=+g[d+8>>2];k=o<999999984306749400.0?o:999999984306749400.0;p=+g[d+12>>2];r=p<0.0?p:0.0;m=m>-999999984306749400.0?m:-999999984306749400.0;n=n>-999999984306749400.0?n:-999999984306749400.0;o=o>-999999984306749400.0?o:-999999984306749400.0;p=p>0.0?p:0.0;x=+g[d+16>>2];h=x<h?x:h;y=+g[d+20>>2];j=y<j?y:j;z=+g[d+24>>2];k=z<k?z:k;A=+g[d+28>>2];r=A<r?A:r;m=m<x?x:m;n=n<y?y:n;o=o<z?z:o;p=p<A?A:p;A=+g[d+32>>2];h=A<h?A:h;z=+g[d+36>>2];j=z<j?z:j;y=+g[d+40>>2];k=y<k?y:k;x=+g[d+44>>2];r=x<r?x:r;m=m<A?A:m;n=n<z?z:n;o=o<y?y:o;p=p<x?x:p;b=c[b+4>>2]|0;v=c[b+4>>2]|0;if((v|0)==(c[b+8>>2]|0)?(q=(v|0)==0?1:v<<1,(v|0)<(q|0)):0){if(!q)d=0;else{c[5004]=(c[5004]|0)+1;d=fF(q<<6|19)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}v=c[b+4>>2]|0}if((v|0)>0){w=0;do{s=d+(w<<6)+0|0;t=(c[b+12>>2]|0)+(w<<6)+0|0;u=s+64|0;do{c[s>>2]=c[t>>2];s=s+4|0;t=t+4|0}while((s|0)<(u|0));w=w+1|0}while((w|0)!=(v|0))}s=c[b+12>>2]|0;if(s){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[s+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=d;c[b+8>>2]=q;v=c[b+4>>2]|0}w=c[b+12>>2]|0;g[w+(v<<6)>>2]=h;g[w+(v<<6)+4>>2]=j;g[w+(v<<6)+8>>2]=k;g[w+(v<<6)+12>>2]=r;g[w+(v<<6)+16>>2]=m;g[w+(v<<6)+20>>2]=n;g[w+(v<<6)+24>>2]=o;g[w+(v<<6)+28>>2]=p;c[w+(v<<6)+32>>2]=-1;c[w+(v<<6)+36>>2]=e;c[w+(v<<6)+40>>2]=f;w=w+(v<<6)+44|0;c[w+0>>2]=c[l+0>>2];c[w+4>>2]=c[l+4>>2];c[w+8>>2]=c[l+8>>2];c[w+12>>2]=c[l+12>>2];c[w+16>>2]=c[l+16>>2];c[b+4>>2]=(c[b+4>>2]|0)+1;i=l;return}function Vz(a){a=a|0;return}function Wz(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function Xz(d,e,f,h){d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0.0,r=0.0,s=0.0,t=0,u=0.0,v=0.0,w=0.0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0,G=0;j=i;q=+g[e>>2];v=q<999999984306749400.0?q:999999984306749400.0;r=+g[e+4>>2];w=r<999999984306749400.0?r:999999984306749400.0;s=+g[e+8>>2];u=s<999999984306749400.0?s:999999984306749400.0;q=q>-999999984306749400.0?q:-999999984306749400.0;r=r>-999999984306749400.0?r:-999999984306749400.0;s=s>-999999984306749400.0?s:-999999984306749400.0;z=+g[e+16>>2];v=z<v?z:v;A=+g[e+20>>2];w=A<w?A:w;B=+g[e+24>>2];u=B<u?B:u;q=q<z?z:q;r=r<A?A:r;s=s<B?B:s;B=+g[e+32>>2];v=B<v?B:v;A=+g[e+36>>2];w=A<w?A:w;z=+g[e+40>>2];u=z<u?z:u;q=q<B?B:q;r=r<A?A:r;s=s<z?z:s;if(q-v<.0020000000949949026){q=q+.0010000000474974513;v=v+-.0010000000474974513}if(r-w<.0020000000949949026){r=r+.0010000000474974513;w=w+-.0010000000474974513}if(s-u<.0020000000949949026){s=s+.0010000000474974513;u=u+-.0010000000474974513}e=c[d+8>>2]|0;E=+g[e+4>>2];C=+g[e+8>>2];A=+g[e+12>>2];D=+g[e+36>>2];z=+g[e+40>>2];B=+g[e+44>>2];e=~~((v-E)*D)&65534;l=~~((w-C)*z)&65534;m=~~((u-A)*B)&65534;n=(~~((q-E)*D+1.0)&65535|1)&65535;o=(~~((r-C)*z+1.0)&65535|1)&65535;p=(~~((s-A)*B+1.0)&65535|1)&65535;d=c[d+4>>2]|0;y=c[d+4>>2]|0;if((y|0)==(c[d+8>>2]|0)?(k=(y|0)==0?1:y<<1,(y|0)<(k|0)):0){if(!k)t=0;else{c[5004]=(c[5004]|0)+1;t=fF((k<<4|3)+16|0)|0;if(!t)t=0;else{c[(t+19&-16)+ -4>>2]=t;t=t+19&-16}y=c[d+4>>2]|0}if((y|0)>0){x=0;do{F=t+(x<<4)|0;G=(c[d+12>>2]|0)+(x<<4)|0;c[F+0>>2]=c[G+0>>2];c[F+4>>2]=c[G+4>>2];c[F+8>>2]=c[G+8>>2];c[F+12>>2]=c[G+12>>2];x=x+1|0}while((x|0)!=(y|0))}x=c[d+12>>2]|0;if(x){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0)}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=t;c[d+8>>2]=k;y=c[d+4>>2]|0}G=c[d+12>>2]|0;b[G+(y<<4)>>1]=e;b[G+(y<<4)+2>>1]=l;b[G+(y<<4)+4>>1]=m;b[G+(y<<4)+6>>1]=n;b[G+(y<<4)+8>>1]=o;b[G+(y<<4)+10>>1]=p;c[G+(y<<4)+12>>2]=f<<21|h;c[d+4>>2]=(c[d+4>>2]|0)+1;i=j;return}function Yz(b){b=b|0;var d=0,e=0,f=0,g=0,h=0;d=i;c[b>>2]=15272;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;c[b+24>>2]=0;a[b+28>>0]=0;a[b+48>>0]=1;c[b+44>>2]=0;c[b+36>>2]=0;c[b+40>>2]=0;a[b+68>>0]=1;c[b+64>>2]=0;c[b+56>>2]=0;c[b+60>>2]=0;c[b+72>>2]=0;c[5004]=(c[5004]|0)+1;e=fF(51)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}f=c[b+8>>2]|0;if((f|0)>0){g=0;do{h=c[b+16>>2]|0;c[e+(g<<4)>>2]=c[h+(g<<4)>>2];c[e+(g<<4)+4>>2]=c[h+(g<<4)+4>>2];c[e+(g<<4)+8>>2]=c[h+(g<<4)+8>>2];c[e+(g<<4)+12>>2]=c[h+(g<<4)+12>>2];g=g+1|0}while((g|0)!=(f|0))}f=c[b+16>>2]|0;if(!f){a[b+20>>0]=1;c[b+16>>2]=e;c[b+12>>2]=2;Zz(b);i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=e;c[b+12>>2]=2;Zz(b);i=d;return}function Zz(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0;e=i;f=c[b+12>>2]|0;d=c[b+36>>2]|0;if((d|0)>=(f|0)){i=e;return}if((d|0)<=(f|0)){if((c[b+40>>2]|0)<(f|0)){if(!f){g=0;j=d}else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}j=c[b+36>>2]|0}if((j|0)>0){h=0;do{k=g+(h<<2)|0;if(k)c[k>>2]=c[(c[b+44>>2]|0)+(h<<2)>>2];h=h+1|0}while((h|0)!=(j|0))}h=c[b+44>>2]|0;if(h){if(a[b+48>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+44>>2]=0}a[b+48>>0]=1;c[b+44>>2]=g;c[b+40>>2]=f}else g=c[b+44>>2]|0;h=d;do{j=g+(h<<2)|0;if(j)c[j>>2]=0;h=h+1|0}while((h|0)!=(f|0))}c[b+36>>2]=f;g=c[b+56>>2]|0;if((g|0)<(f|0)){if((c[b+60>>2]|0)<(f|0)){if(!f){h=0;j=g}else{c[5004]=(c[5004]|0)+1;h=fF((f<<2|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+56>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<2)|0;if(l)c[l>>2]=c[(c[b+64>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(j|0))}j=c[b+64>>2]|0;if(j){if(a[b+68>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[b+64>>2]=0}a[b+68>>0]=1;c[b+64>>2]=h;c[b+60>>2]=f}else h=c[b+64>>2]|0;do{j=h+(g<<2)|0;if(j)c[j>>2]=0;g=g+1|0}while((g|0)!=(f|0))}c[b+56>>2]=f;if((f|0)>0){jF(c[b+44>>2]|0,-1,f<<2|0)|0;jF(c[b+64>>2]|0,-1,f<<2|0)|0}if((d|0)<=0){i=e;return}h=c[b+16>>2]|0;g=c[b+44>>2]|0;f=c[b+64>>2]|0;j=0;do{l=c[(c[h+(j<<4)+4>>2]|0)+12>>2]<<16|c[(c[h+(j<<4)>>2]|0)+12>>2];l=(l+~(l<<15)>>10^l+~(l<<15))*9|0;l=g+((((l>>6^l)+~((l>>6^l)<<11)>>16^(l>>6^l)+~((l>>6^l)<<11))&(c[b+12>>2]|0)+ -1)<<2)|0;c[f+(j<<2)>>2]=c[l>>2];c[l>>2]=j;j=j+1|0}while((j|0)!=(d|0));i=e;return}function _z(a){a=a|0;var b=0;b=i;$z(a);gF(a);i=b;return}function $z(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=15272;e=c[b+64>>2]|0;if(e){if(a[b+68>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+64>>2]=0}a[b+68>>0]=1;c[b+64>>2]=0;c[b+56>>2]=0;c[b+60>>2]=0;e=c[b+44>>2]|0;if(e){if(a[b+48>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+44>>2]=0}a[b+48>>0]=1;c[b+44>>2]=0;c[b+36>>2]=0;c[b+40>>2]=0;e=c[b+16>>2]|0;if(!e){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}function aA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;a=i;e=c[b+8>>2]|0;if((e|0)==0|(d|0)==0){i=a;return}Lb[c[c[e>>2]>>2]&511](e);Nb[c[(c[d>>2]|0)+60>>2]&127](d,c[b+8>>2]|0);c[b+8>>2]=0;i=a;return}function bA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;i=i+16|0;c[e>>2]=15576;c[e+4>>2]=b;c[e+8>>2]=a;c[e+12>>2]=d;rc[c[(c[a>>2]|0)+48>>2]&127](a,e,d);i=e;return}function cA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;i=i+16|0;c[e>>2]=15400;c[e+4>>2]=b;rc[c[(c[a>>2]|0)+48>>2]&127](a,e,d);i=e;return}function dA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0;f=i;c[3814]=(c[3814]|0)+1;h=(c[b+12>>2]|0)>(c[d+12>>2]|0);g=c[(h?d:b)+12>>2]|0;b=c[(h?b:d)+12>>2]|0;d=((b<<16|g)+~((b<<16|g)<<15)>>10^(b<<16|g)+~((b<<16|g)<<15))*9|0;d=((d>>6^d)+~((d>>6^d)<<11)>>16^(d>>6^d)+~((d>>6^d)<<11))&(c[a+12>>2]|0)+ -1;if((d|0)>=(c[a+36>>2]|0)){h=0;i=f;return h|0}h=c[(c[a+44>>2]|0)+(d<<2)>>2]|0;if((h|0)==-1){h=0;i=f;return h|0}d=c[a+16>>2]|0;while(1){if((c[(c[d+(h<<4)>>2]|0)+12>>2]|0)==(g|0)?(c[(c[d+(h<<4)+4>>2]|0)+12>>2]|0)==(b|0):0)break;h=c[(c[a+64>>2]|0)+(h<<2)>>2]|0;if((h|0)==-1){g=0;e=8;break}}if((e|0)==8){i=f;return g|0}h=d+(h<<4)|0;i=f;return h|0}function eA(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0;f=i;d=c[b+4>>2]|0;if((d|0)!=(c[b+8>>2]|0)){j=d;j=j+1|0;c[b+4>>2]=j;j=b+12|0;j=c[j>>2]|0;j=j+(d<<4)|0;i=f;return j|0}e=(d|0)==0?1:d<<1;if((d|0)>=(e|0)){j=d;j=j+1|0;c[b+4>>2]=j;j=b+12|0;j=c[j>>2]|0;j=j+(d<<4)|0;i=f;return j|0}if(!e){g=0;h=d}else{c[5004]=(c[5004]|0)+1;g=fF((e<<4|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[b+4>>2]|0}if((h|0)>0){j=0;do{k=c[b+12>>2]|0;c[g+(j<<4)>>2]=c[k+(j<<4)>>2];c[g+(j<<4)+4>>2]=c[k+(j<<4)+4>>2];c[g+(j<<4)+8>>2]=c[k+(j<<4)+8>>2];c[g+(j<<4)+12>>2]=c[k+(j<<4)+12>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[b+12>>2]|0;if(j){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[b+4>>2]|0}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=g;c[b+8>>2]=e;k=h;k=k+1|0;c[b+4>>2]=k;k=b+12|0;k=c[k>>2]|0;k=k+(d<<4)|0;i=f;return k|0}function fA(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0;g=i;c[3810]=(c[3810]|0)+1;j=(c[b+12>>2]|0)>(c[d+12>>2]|0);h=j?d:b;j=j?b:d;l=c[h+12>>2]|0;d=c[j+12>>2]|0;k=((d<<16|l)+~((d<<16|l)<<15)>>10^(d<<16|l)+~((d<<16|l)<<15))*9|0;k=((k>>6^k)+~((k>>6^k)<<11)>>16^(k>>6^k)+~((k>>6^k)<<11))&(c[a+12>>2]|0)+ -1;m=c[(c[a+44>>2]|0)+(k<<2)>>2]|0;if((m|0)==-1){o=0;i=g;return o|0}b=c[a+16>>2]|0;while(1){if((c[(c[b+(m<<4)>>2]|0)+12>>2]|0)==(l|0)?(c[(c[b+(m<<4)+4>>2]|0)+12>>2]|0)==(d|0):0)break;m=c[(c[a+64>>2]|0)+(m<<2)>>2]|0;if((m|0)==-1){a=0;f=24;break}}if((f|0)==24){i=g;return a|0}d=b+(m<<4)|0;if(!d){o=0;i=g;return o|0}rc[c[(c[a>>2]|0)+32>>2]&127](a,d,e);b=c[b+(m<<4)+12>>2]|0;d=d-(c[a+16>>2]|0)>>4;k=(c[a+44>>2]|0)+(k<<2)|0;l=c[k>>2]|0;m=c[a+64>>2]|0;if((l|0)!=(d|0)){while(1){n=m+(l<<2)|0;o=c[n>>2]|0;if((o|0)==(d|0))break;else l=o}m=c[m+(d<<2)>>2]|0;if((l|0)==-1)f=12;else c[n>>2]=m}else{m=c[m+(d<<2)>>2]|0;f=12}if((f|0)==12)c[k>>2]=m;k=(c[a+8>>2]|0)+ -1|0;l=c[a+72>>2]|0;if(l)Tb[c[(c[l>>2]|0)+12>>2]&31](l,h,j,e)|0;if((k|0)==(d|0)){c[a+8>>2]=(c[a+8>>2]|0)+ -1;o=b;i=g;return o|0}j=c[a+16>>2]|0;h=c[(c[j+(k<<4)+4>>2]|0)+12>>2]<<16|c[(c[j+(k<<4)>>2]|0)+12>>2];h=(h+~(h<<15)>>10^h+~(h<<15))*9|0;h=((h>>6^h)+~((h>>6^h)<<11)>>16^(h>>6^h)+~((h>>6^h)<<11))&(c[a+12>>2]|0)+ -1;e=(c[a+44>>2]|0)+(h<<2)|0;m=c[e>>2]|0;n=c[a+64>>2]|0;if((m|0)!=(k|0)){while(1){l=n+(m<<2)|0;o=c[l>>2]|0;if((o|0)==(k|0))break;else m=o}n=c[n+(k<<2)>>2]|0;if((m|0)==-1)f=22;else c[l>>2]=n}else{n=c[n+(k<<2)>>2]|0;f=22}if((f|0)==22)c[e>>2]=n;c[j+(d<<4)+0>>2]=c[j+(k<<4)+0>>2];c[j+(d<<4)+4>>2]=c[j+(k<<4)+4>>2];c[j+(d<<4)+8>>2]=c[j+(k<<4)+8>>2];c[j+(d<<4)+12>>2]=c[j+(k<<4)+12>>2];o=(c[a+44>>2]|0)+(h<<2)|0;c[(c[a+64>>2]|0)+(d<<2)>>2]=c[o>>2];c[o>>2]=d;c[a+8>>2]=(c[a+8>>2]|0)+ -1;o=b;i=g;return o|0}function gA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0;e=i;if((c[a+8>>2]|0)<=0){i=e;return}f=0;a:while(1){while(1){h=c[a+16>>2]|0;g=h+(f<<4)|0;if(!(gc[c[(c[b>>2]|0)+8>>2]&31](b,g)|0))break;Tb[c[(c[a>>2]|0)+12>>2]&31](a,c[g>>2]|0,c[h+(f<<4)+4>>2]|0,d)|0;c[3808]=(c[3808]|0)+ -1;if((f|0)>=(c[a+8>>2]|0)){a=7;break a}}f=f+1|0;if((f|0)>=(c[a+8>>2]|0)){a=7;break}}if((a|0)==7){i=e;return}}function hA(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;e=i;i=i+32|0;a[e+16>>0]=1;c[e+12>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;m=c[b+8>>2]|0;if((m|0)>0){k=0;f=0;l=0;g=0;while(1){h=c[b+16>>2]|0;if((f|0)==(l|0)){j=(l|0)==0?1:l<<1;if((l|0)<(j|0)){if(j){c[5004]=(c[5004]|0)+1;k=fF((j<<4|3)+16|0)|0;if(!k){k=0;l=f}else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16;l=f}}else k=0;if((l|0)>0){m=0;do{n=c[e+12>>2]|0;c[k+(m<<4)>>2]=c[n+(m<<4)>>2];c[k+(m<<4)+4>>2]=c[n+(m<<4)+4>>2];c[k+(m<<4)+8>>2]=c[n+(m<<4)+8>>2];c[k+(m<<4)+12>>2]=c[n+(m<<4)+12>>2];m=m+1|0}while((m|0)!=(l|0))}m=c[e+12>>2]|0;if(!m)f=l;else{c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0);c[e+12>>2]=0}a[e+16>>0]=1;c[e+12>>2]=k;c[e+8>>2]=j;m=c[b+8>>2]|0;l=f}else j=l}else{j=l;l=f}c[k+(l<<4)>>2]=c[h+(g<<4)>>2];c[k+(l<<4)+4>>2]=c[h+(g<<4)+4>>2];c[k+(l<<4)+8>>2]=c[h+(g<<4)+8>>2];c[k+(l<<4)+12>>2]=c[h+(g<<4)+12>>2];f=l+1|0;g=g+1|0;if((g|0)>=(m|0))break;else l=j}c[e+4>>2]=f;if((l|0)>-1){g=0;do{Tb[c[(c[b>>2]|0)+12>>2]&31](b,c[k+(g<<4)>>2]|0,c[k+(g<<4)+4>>2]|0,d)|0;g=g+1|0}while((g|0)<(f|0))}}else f=0;if((c[b+56>>2]|0)>0){d=c[b+64>>2]|0;g=0;do{c[d+(g<<2)>>2]=-1;g=g+1|0}while((g|0)<(c[b+56>>2]|0))}if((f|0)>1){os(e,0,f+ -1|0);f=c[e+4>>2]|0}if((f|0)>0){d=c[e+12>>2]|0;g=0;do{Yb[c[(c[b>>2]|0)+8>>2]&31](b,c[d+(g<<4)>>2]|0,c[d+(g<<4)+4>>2]|0)|0;g=g+1|0}while((g|0)<(f|0))}else d=c[e+12>>2]|0;if(!d){i=e;return}if(a[e+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}c[e+12>>2]=0;i=e;return}function iA(a,d,e){a=a|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;c[3812]=(c[3812]|0)+1;g=c[a+24>>2]|0;if(!g){if(!((b[e+6>>1]&b[d+4>>1])<<16>>16)){m=0;i=f;return m|0}if(!((b[d+6>>1]&b[e+4>>1])<<16>>16)){m=0;i=f;return m|0}}else if(!(Yb[c[(c[g>>2]|0)+8>>2]&31](g,d,e)|0)){m=0;i=f;return m|0}j=(c[d+12>>2]|0)>(c[e+12>>2]|0);g=j?e:d;e=j?d:e;j=c[g+12>>2]|0;l=c[e+12>>2]|0;d=((l<<16|j)+~((l<<16|j)<<15)>>10^(l<<16|j)+~((l<<16|j)<<15))*9|0;d=(d>>6^d)+~((d>>6^d)<<11)>>16^(d>>6^d)+~((d>>6^d)<<11);h=c[a+12>>2]|0;m=c[(c[a+44>>2]|0)+((d&h+ -1)<<2)>>2]|0;a:do if((m|0)!=-1){k=c[a+16>>2]|0;while(1){if((c[(c[k+(m<<4)>>2]|0)+12>>2]|0)==(j|0)?(c[(c[k+(m<<4)+4>>2]|0)+12>>2]|0)==(l|0):0)break;m=c[(c[a+64>>2]|0)+(m<<2)>>2]|0;if((m|0)==-1)break a}j=k+(m<<4)|0;if(j){m=j;i=f;return m|0}}while(0);k=c[a+8>>2]|0;j=eA(a+4|0)|0;l=c[a+72>>2]|0;if(l)Yb[c[(c[l>>2]|0)+8>>2]&31](l,g,e)|0;if((h|0)<(c[a+12>>2]|0)){Zz(a);d=(c[a+12>>2]|0)+ -1&d}else d=d&h+ -1;if((c[g+12>>2]|0)<(c[e+12>>2]|0)){c[j>>2]=g;c[j+4>>2]=e}else{c[j>>2]=e;c[j+4>>2]=g}c[j+8>>2]=0;c[j+12>>2]=0;m=(c[a+44>>2]|0)+(d<<2)|0;c[(c[a+64>>2]|0)+(k<<2)>>2]=c[m>>2];c[m>>2]=k;m=j;i=f;return m|0}function jA(a){a=a|0;return c[a+16>>2]|0}function kA(a){a=a|0;return c[a+16>>2]|0}function lA(a){a=a|0;return a+4|0}function mA(a){a=a|0;return c[a+8>>2]|0}function nA(a,b){a=a|0;b=b|0;c[a+24>>2]=b;return}function oA(a){a=a|0;return 0}function pA(a,b){a=a|0;b=b|0;c[a+72>>2]=b;return}function qA(a){a=a|0;return}function rA(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function sA(a,b){a=a|0;b=b|0;var d=0;d=i;a=c[a+4>>2]|0;if((c[b>>2]|0)==(a|0)){a=1;i=d;return a|0}a=(c[b+4>>2]|0)==(a|0);i=d;return a|0}function tA(a){a=a|0;return}function uA(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function vA(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;e=c[a+4>>2]|0;if((c[b>>2]|0)!=(e|0)?(c[b+4>>2]|0)!=(e|0):0){i=d;return 0}e=c[a+8>>2]|0;rc[c[(c[e>>2]|0)+32>>2]&127](e,b,c[a+12>>2]|0);i=d;return 0}function wA(a,b){a=a|0;b=b|0;var d=0,e=0.0,f=0,h=0.0,j=0.0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0;d=i;f=c[a+748>>2]|0;if((f|0)!=4){c[a+748>>2]=f+1;z=f;l=(z|0)<0;z=l?0:z;l=a+(z*184|0)+4|0;mF(l|0,b|0,184)|0;i=d;return z|0}e=+g[b+80>>2];y=+g[a+84>>2];x=y<e?y:e;w=+g[a+268>>2];v=w<x?w:x;u=+g[a+452>>2];l=+g[a+636>>2]<(u<v?u:v);z=l?3:u<v?2:w<x?1:(y<e^1)<<31>>31;e=+g[b>>2];if(z){m=+g[a+188>>2];p=+g[b+4>>2];n=+g[a+192>>2];k=+g[b+8>>2];o=+g[a+196>>2];u=+g[a+556>>2];t=+g[a+372>>2];w=+g[a+560>>2];v=+g[a+376>>2];q=+g[a+564>>2];s=+g[a+380>>2];h=((e-m)*(w-v)-(p-n)*(u-t))*((e-m)*(w-v)-(p-n)*(u-t))+(((p-n)*(q-s)-(k-o)*(w-v))*((p-n)*(q-s)-(k-o)*(w-v))+((k-o)*(u-t)-(e-m)*(q-s))*((k-o)*(u-t)-(e-m)*(q-s)));if((z|0)==1){j=+g[a+12>>2];y=q;q=0.0;r=+g[a+4>>2];x=+g[a+8>>2];f=7}else{y=q;f=6}}else{m=+g[a+188>>2];n=+g[a+192>>2];o=+g[a+196>>2];h=0.0;p=+g[b+4>>2];k=+g[b+8>>2];t=+g[a+372>>2];u=+g[a+556>>2];v=+g[a+376>>2];w=+g[a+560>>2];s=+g[a+380>>2];y=+g[a+564>>2];f=6}if((f|0)==6){r=+g[a+4>>2];x=+g[a+8>>2];D=p-x;j=+g[a+12>>2];B=k-j;A=u-t;C=w-v;q=y-s;q=((e-r)*C-D*A)*((e-r)*C-D*A)+((D*q-B*C)*(D*q-B*C)+(B*A-(e-r)*q)*(B*A-(e-r)*q));if((z|0)==2){u=x;w=0.0;f=8}else f=7}if((f|0)==7){D=e-r;E=p-x;B=k-j;C=u-m;A=w-n;w=y-o;w=(D*A-E*C)*(D*A-E*C)+((E*w-B*A)*(E*w-B*A)+(B*C-D*w)*(B*C-D*w));if(l)e=0.0;else{u=x;f=8}}if((f|0)==8){E=e-r;A=p-u;C=k-j;D=t-m;B=v-n;e=s-o;e=(E*B-A*D)*(E*B-A*D)+((A*e-C*B)*(A*e-C*B)+(C*D-E*e)*(C*D-E*e))}E=+P(+h);C=+P(+q);A=+P(+w);y=+P(+e);D=E>-999999984306749400.0?E:-999999984306749400.0;B=C>D?C:D;z=y>(A>B?A:B)?3:A>B?2:C>D?1:(E>-999999984306749400.0^1)<<31>>31;l=(z|0)<0;z=l?0:z;l=a+(z*184|0)+4|0;mF(l|0,b|0,184)|0;i=d;return z|0}function xA(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0.0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0;f=i;h=c[b+748>>2]|0;if((h|0)<=0){i=f;return}do{h=h+ -1|0;q=+g[b+(h*184|0)+4>>2];r=+g[b+(h*184|0)+8>>2];j=+g[b+(h*184|0)+12>>2];p=q*+g[d>>2]+r*+g[d+4>>2]+j*+g[d+8>>2]+ +g[d+48>>2];n=q*+g[d+16>>2]+r*+g[d+20>>2]+j*+g[d+24>>2]+ +g[d+52>>2];j=q*+g[d+32>>2]+r*+g[d+36>>2]+j*+g[d+40>>2]+ +g[d+56>>2];g[b+(h*184|0)+52>>2]=p;g[b+(h*184|0)+56>>2]=n;g[b+(h*184|0)+60>>2]=j;g[b+(h*184|0)+64>>2]=0.0;r=+g[b+(h*184|0)+20>>2];q=+g[b+(h*184|0)+24>>2];k=+g[b+(h*184|0)+28>>2];o=r*+g[e>>2]+q*+g[e+4>>2]+k*+g[e+8>>2]+ +g[e+48>>2];m=r*+g[e+16>>2]+q*+g[e+20>>2]+k*+g[e+24>>2]+ +g[e+52>>2];k=r*+g[e+32>>2]+q*+g[e+36>>2]+k*+g[e+40>>2]+ +g[e+56>>2];g[b+(h*184|0)+36>>2]=o;g[b+(h*184|0)+40>>2]=m;g[b+(h*184|0)+44>>2]=k;g[b+(h*184|0)+48>>2]=0.0;g[b+(h*184|0)+84>>2]=(p-o)*+g[b+(h*184|0)+68>>2]+(n-m)*+g[b+(h*184|0)+72>>2]+(j-k)*+g[b+(h*184|0)+76>>2];l=b+(h*184|0)+152|0;c[l>>2]=(c[l>>2]|0)+1}while((h|0)>0);d=c[b+748>>2]|0;if((d|0)<=0){i=f;return}e=d;do{d=d+ -1|0;h=b+(d*184|0)+4|0;k=+g[b+(d*184|0)+84>>2];j=+g[b+752>>2];if(k<=j){p=+g[b+(d*184|0)+36>>2]-(+g[b+(d*184|0)+52>>2]- +g[b+(d*184|0)+68>>2]*k);q=+g[b+(d*184|0)+40>>2]-(+g[b+(d*184|0)+56>>2]-k*+g[b+(d*184|0)+72>>2]);r=+g[b+(d*184|0)+44>>2]-(+g[b+(d*184|0)+60>>2]-k*+g[b+(d*184|0)+76>>2]);if(p*p+q*q+r*r>j*j){l=e+ -1|0;if((l|0)!=(d|0)){mF(h|0,b+(l*184|0)+4|0,184)|0;c[b+(l*184|0)+116>>2]=0;g[b+(l*184|0)+124>>2]=0.0;a[b+(l*184|0)+120>>0]=0;g[b+(l*184|0)+128>>2]=0.0;g[b+(l*184|0)+132>>2]=0.0;c[b+(l*184|0)+152>>2]=0;e=c[b+748>>2]|0}e=e+ -1|0;c[b+748>>2]=e}}else{l=e+ -1|0;if((l|0)!=(d|0)){mF(h|0,b+(l*184|0)+4|0,184)|0;c[b+(l*184|0)+116>>2]=0;g[b+(l*184|0)+124>>2]=0.0;a[b+(l*184|0)+120>>0]=0;g[b+(l*184|0)+128>>2]=0.0;g[b+(l*184|0)+132>>2]=0.0;c[b+(l*184|0)+152>>2]=0;e=c[b+748>>2]|0}e=e+ -1|0;c[b+748>>2]=e}}while((d|0)>0);i=f;return}function yA(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(d){Lb[c[c[d>>2]>>2]&511](d);d=c[a+52>>2]|0;if(d){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}if(!a){i=b;return}}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function zA(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(!d){i=b;return}Lb[c[c[d>>2]>>2]&511](d);a=c[a+52>>2]|0;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}



function AA(d,f){d=d|0;f=f|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0,D=0,E=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0,$=0,aa=0,ba=0.0,ca=0.0,da=0,ea=0;h=i;i=i+336|0;m=c[d+52>>2]|0;if((m|0)!=0?(Lb[c[c[m>>2]>>2]&511](m),j=c[d+52>>2]|0,(j|0)!=0):0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[5004]=(c[5004]|0)+1;j=fF(151)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}c[j>>2]=19496;a[j+20>>0]=1;c[j+16>>2]=0;c[j+8>>2]=0;c[j+12>>2]=0;a[j+40>>0]=1;c[j+36>>2]=0;c[j+28>>2]=0;c[j+32>>2]=0;a[j+60>>0]=1;c[j+56>>2]=0;c[j+48>>2]=0;c[j+52>>2]=0;c[d+52>>2]=j;s=0;m=0;v=0;j=0;while(1){if((s|0)>=(Pb[c[(c[d>>2]|0)+96>>2]&127](d)|0))break;if((m|0)==(v|0)){w=(v|0)==0?1:v<<1;if((v|0)<(w|0)){if((w|0)!=0?(c[5004]=(c[5004]|0)+1,p=fF((w<<4|3)+16|0)|0,(p|0)!=0):0){c[(p+19&-16)+ -4>>2]=p;u=p+19&-16}else u=0;if((v|0)>0){t=0;do{aa=u+(t<<4)|0;$=j+(t<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];t=t+1|0}while((t|0)!=(v|0))}if(!j){t=v;v=w;j=u}else{c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);t=v;v=w;j=u}}else t=v}else t=m;aa=j+(m<<4)|0;c[aa+0>>2]=c[h+256>>2];c[aa+4>>2]=c[h+260>>2];c[aa+8>>2]=c[h+264>>2];c[aa+12>>2]=c[h+268>>2];rc[c[(c[d>>2]|0)+108>>2]&127](d,s,aa);s=s+1|0;m=t+1|0}a[h+212>>0]=1;c[h+208>>2]=0;c[h+200>>2]=0;c[h+204>>2]=0;a[h+232>>0]=1;c[h+228>>2]=0;c[h+220>>2]=0;c[h+224>>2]=0;a[h+252>>0]=1;c[h+248>>2]=0;c[h+240>>2]=0;c[h+244>>2]=0;if(f){if((m|0)>0){f=0;C=0;E=0;F=0;while(1){t=f;f=f+1|0;if((f|0)<(m|0)){s=j+(t<<4)|0;p=j+(t<<4)+4|0;t=j+(t<<4)+8|0;u=f;do{x=u;u=u+1|0;if((u|0)<(m|0)){w=j+(x<<4)|0;v=j+(x<<4)+4|0;x=j+(x<<4)+8|0;y=u;do{A=+g[s>>2];U=+g[w>>2]-A;T=+g[p>>2];R=+g[v>>2]-T;B=+g[t>>2];S=+g[x>>2]-B;A=+g[j+(y<<4)>>2]-A;T=+g[j+(y<<4)+4>>2]-T;B=+g[j+(y<<4)+8>>2]-B;X=1.0;D=0;while(1){V=(R*B-S*T)*X;W=(S*A-U*B)*X;X=(U*T-R*A)*X;a:do if(X*X+(V*V+W*W)>9999999747378752.0e-20){Y=1.0/+Q(+(X*X+(V*V+W*W)));if((C|0)>0){G=0;do{if(V*Y*+g[F+(G<<4)>>2]+W*Y*+g[F+(G<<4)+4>>2]+X*Y*+g[F+(G<<4)+8>>2]>.9990000128746033)break a;G=G+1|0}while((G|0)<(C|0))}Z=V*Y*+g[s>>2]+W*Y*+g[p>>2]+X*Y*+g[t>>2];G=0;do{if(V*Y*+g[j+(G<<4)>>2]+W*Y*+g[j+(G<<4)+4>>2]+X*Y*+g[j+(G<<4)+8>>2]-Z+-.009999999776482582>0.0)break a;G=G+1|0}while((G|0)<(m|0));do if((C|0)==(E|0)){H=(E|0)==0?1:E<<1;if((E|0)<(H|0)){do if(!H)I=0;else{c[5004]=(c[5004]|0)+1;G=fF((H<<4|3)+16|0)|0;if(!G){I=0;break}c[(G+19&-16)+ -4>>2]=G;I=G+19&-16}while(0);if((E|0)>0){G=0;do{aa=I+(G<<4)|0;$=F+(G<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];G=G+1|0}while((G|0)!=(E|0))}if(!F){G=E;E=H;F=I;break}c[5006]=(c[5006]|0)+1;gF(c[F+ -4>>2]|0);G=E;E=H;F=I}else G=E}else G=C;while(0);g[F+(G<<4)>>2]=V*Y;g[F+(G<<4)+4>>2]=W*Y;g[F+(G<<4)+8>>2]=X*Y;g[F+(G<<4)+12>>2]=-Z;C=C+1|0}while(0);D=D+1|0;if((D|0)==2)break;else X=-1.0}y=y+1|0}while((y|0)!=(m|0))}}while((u|0)!=(m|0))}if((f|0)==(m|0)){m=F;break}}if((C|0)>0){p=0;f=0;s=0;v=0;while(1){aa=m+(p<<4)|0;c[h+184>>2]=c[aa+0>>2];c[h+188>>2]=c[aa+4>>2];c[h+192>>2]=c[aa+8>>2];A=+g[m+(p<<4)+12>>2];A=A- +$b[c[(c[d>>2]|0)+48>>2]&15](d);if((f|0)==(s|0)){w=(s|0)==0?1:s<<1;if((s|0)<(w|0)){if((w|0)!=0?(c[5004]=(c[5004]|0)+1,l=fF((w<<4|3)+16|0)|0,(l|0)!=0):0){c[(l+19&-16)+ -4>>2]=l;t=l+19&-16}else t=0;if((s|0)>0){u=0;do{aa=t+(u<<4)|0;$=v+(u<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];u=u+1|0}while((u|0)!=(s|0))}if(!v){u=s;s=w}else{c[5006]=(c[5006]|0)+1;gF(c[v+ -4>>2]|0);u=s;s=w}}else{u=s;t=v}}else{u=f;t=v}aa=t+(u<<4)|0;c[aa+0>>2]=c[h+184>>2];c[aa+4>>2]=c[h+188>>2];c[aa+8>>2]=c[h+192>>2];g[t+(u<<4)+12>>2]=A;f=f+1|0;p=p+1|0;if((p|0)>=(C|0)){l=t;break}else v=t}if((f|0)>0){p=0;w=0;x=0;y=0;do{t=p;p=p+1|0;if((p|0)<(f|0)){s=p;do{u=s;s=s+1|0;if((s|0)<(f|0)){v=s;do{S=+g[l+(u<<4)+4>>2];Y=+g[l+(v<<4)+8>>2];B=+g[l+(u<<4)+8>>2];T=+g[l+(v<<4)+4>>2];W=+g[l+(v<<4)>>2];U=+g[l+(u<<4)>>2];X=+g[l+(t<<4)+8>>2];R=+g[l+(t<<4)+4>>2];V=+g[l+(t<<4)>>2];b:do if((((T*U-S*W)*(T*U-S*W)+((S*Y-B*T)*(S*Y-B*T)+(B*W-Y*U)*(B*W-Y*U))>9999999747378752.0e-20?(W*R-T*V)*(W*R-T*V)+((T*X-Y*R)*(T*X-Y*R)+(Y*V-W*X)*(Y*V-W*X))>9999999747378752.0e-20:0)?(S*V-U*R)*(S*V-U*R)+((B*R-S*X)*(B*R-S*X)+(U*X-B*V)*(U*X-B*V))>9999999747378752.0e-20:0)?(z=X*(T*U-S*W)+(R*(B*W-Y*U)+(S*Y-B*T)*V),+P(+z)>9.999999974752427e-7):0){ba=+g[l+(t<<4)+12>>2];Z=+g[l+(u<<4)+12>>2];ca=+g[l+(v<<4)+12>>2];A=-1.0/z*((B*R-S*X)*ca+((S*Y-B*T)*ba+(T*X-Y*R)*Z));B=-1.0/z*((U*X-B*V)*ca+((B*W-Y*U)*ba+(Y*V-W*X)*Z));R=-1.0/z*((S*V-U*R)*ca+((T*U-S*W)*ba+(W*R-T*V)*Z));C=0;do{if(+g[l+(C<<4)+12>>2]+(A*+g[l+(C<<4)>>2]+B*+g[l+(C<<4)+4>>2]+R*+g[l+(C<<4)+8>>2])+-.009999999776482582>0.0)break b;C=C+1|0}while((C|0)<(f|0));do if((w|0)==(x|0)){D=(x|0)==0?1:x<<1;if((x|0)>=(D|0)){C=x;break}do if(!D)E=0;else{c[5004]=(c[5004]|0)+1;C=fF((D<<4|3)+16|0)|0;if(!C){E=0;break}c[(C+19&-16)+ -4>>2]=C;E=C+19&-16}while(0);if((x|0)>0){C=0;do{aa=E+(C<<4)|0;$=y+(C<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];C=C+1|0}while((C|0)!=(x|0))}if(!y){C=x;x=D;y=E;break}c[5006]=(c[5006]|0)+1;gF(c[y+ -4>>2]|0);C=x;x=D;y=E}else C=w;while(0);g[y+(C<<4)>>2]=A;g[y+(C<<4)+4>>2]=B;g[y+(C<<4)+8>>2]=R;g[y+(C<<4)+12>>2]=0.0;w=w+1|0}while(0);v=v+1|0}while((v|0)!=(f|0))}}while((s|0)!=(f|0))}}while((p|0)!=(f|0))}else{w=0;y=0}}else{l=0;w=0;y=0}}else{m=0;l=0;w=0;y=0}uE(h+196|0,y,w);if(y){c[5006]=(c[5006]|0)+1;gF(c[y+ -4>>2]|0)}if(l){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}if(m){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}}else uE(h+196|0,j,m);s=c[h+240>>2]|0;if((s|0)>0&((s|0)<0^1)){c[5004]=(c[5004]|0)+1;l=fF((s<<4|3)+16|0)|0;if(!l)m=0;else{c[(l+19&-16)+ -4>>2]=l;m=l+19&-16}l=0;do{aa=m+(l<<4)|0;c[aa+0>>2]=c[h+168>>2];c[aa+4>>2]=c[h+172>>2];c[aa+8>>2]=c[h+176>>2];c[aa+12>>2]=c[h+180>>2];l=l+1|0}while((l|0)!=(s|0))}else m=0;a[h+164>>0]=1;f=h+160|0;c[f>>2]=0;l=h+152|0;c[l>>2]=0;c[h+156>>2]=0;p=h+112|0;t=p+36|0;do{c[p>>2]=0;p=p+4|0}while((p|0)<(t|0));a[h+128>>0]=1;c[h+124>>2]=0;c[h+116>>2]=0;c[h+120>>2]=0;if((s|0)<0)Gb();if((s|0)>0){GA(h+148|0,s);p=c[f>>2]|0;t=0;do{u=p+(t*36|0)|0;if(u){IA(u,h+112|0);c[u+20>>2]=c[h+132>>2];c[u+24>>2]=c[h+136>>2];c[u+28>>2]=c[h+140>>2];c[u+32>>2]=c[h+144>>2]}t=t+1|0}while((t|0)!=(s|0));t=c[h+124>>2]|0;c[l>>2]=s;if(t){if(a[h+128>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[t+ -4>>2]|0)}c[h+124>>2]=0}}else{c[l>>2]=s;p=0}a[h+128>>0]=1;c[h+124>>2]=0;c[h+116>>2]=0;c[h+120>>2]=0;t=c[h+200>>2]|0;u=c[d+52>>2]|0;v=c[u+8>>2]|0;if((v|0)<(t|0)){if((c[u+12>>2]|0)<(t|0)){if(!t){w=0;y=v}else{c[5004]=(c[5004]|0)+1;w=fF((t<<4|3)+16|0)|0;if(!w)w=0;else{c[(w+19&-16)+ -4>>2]=w;w=w+19&-16}y=c[u+8>>2]|0}if((y|0)>0){x=0;do{aa=w+(x<<4)|0;$=(c[u+16>>2]|0)+(x<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];x=x+1|0}while((x|0)!=(y|0))}x=c[u+16>>2]|0;if(x){if(a[u+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0)}c[u+16>>2]=0}a[u+20>>0]=1;c[u+16>>2]=w;c[u+12>>2]=t;w=u+16|0}else w=u+16|0;do{aa=(c[w>>2]|0)+(v<<4)|0;c[aa+0>>2]=c[h+96>>2];c[aa+4>>2]=c[h+100>>2];c[aa+8>>2]=c[h+104>>2];c[aa+12>>2]=c[h+108>>2];v=v+1|0}while((v|0)!=(t|0))}c[u+8>>2]=t;if((t|0)>0){v=c[h+208>>2]|0;u=0;do{aa=(c[(c[d+52>>2]|0)+16>>2]|0)+(u<<4)|0;$=v+(u<<4)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];u=u+1|0}while((u|0)!=(t|0))}if((s|0)>0){t=0;do{u=(c[h+228>>2]|0)+((c[(c[h+248>>2]|0)+(t<<2)>>2]|0)*12|0)|0;x=p+(t*36|0)+4|0;v=p+(t*36|0)+8|0;w=p+(t*36|0)+12|0;y=p+(t*36|0)+16|0;p=u;D=0;do{C=p+4|0;E=c[p+((c[C>>2]|0)*12|0)+8>>2]|0;H=c[x>>2]|0;if((H|0)==(c[v>>2]|0)?(r=(H|0)==0?1:H<<1,(H|0)<(r|0)):0){if(!r)F=0;else{c[5004]=(c[5004]|0)+1;F=fF((r<<2|3)+16|0)|0;if(!F)F=0;else{c[(F+19&-16)+ -4>>2]=F;F=F+19&-16}H=c[x>>2]|0}if((H|0)>0){G=0;do{I=F+(G<<2)|0;if(I)c[I>>2]=c[(c[w>>2]|0)+(G<<2)>>2];G=G+1|0}while((G|0)!=(H|0))}G=c[w>>2]|0;if(G){if(a[y>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[G+ -4>>2]|0)}c[w>>2]=0}a[y>>0]=1;c[w>>2]=F;c[v>>2]=r;H=c[x>>2]|0}F=(c[w>>2]|0)+(H<<2)|0;if(F){c[F>>2]=E;H=c[x>>2]|0}c[x>>2]=H+1;$=c[p+8>>2]|0;aa=c[h+208>>2]|0;z=+g[aa+($<<4)>>2]- +g[aa+(E<<4)>>2];A=+g[aa+($<<4)+4>>2]- +g[aa+(E<<4)+4>>2];R=+g[aa+($<<4)+8>>2]- +g[aa+(E<<4)+8>>2];B=1.0/+Q(+(z*z+A*A+R*R));if((D|0)<2){g[h+288+(D<<4)>>2]=z*B;g[h+288+(D<<4)+4>>2]=A*B;g[h+288+(D<<4)+8>>2]=R*B;g[h+288+(D<<4)+12>>2]=0.0;D=D+1|0}aa=c[C>>2]|0;p=p+(((c[p+(aa*12|0)>>2]|0)+aa|0)*12|0)|0}while((p|0)!=(u|0));w=m+(t<<4)|0;if((D|0)==2){X=+g[h+292>>2];Y=+g[h+312>>2];Z=+g[h+296>>2];ba=+g[h+308>>2];W=+g[h+304>>2];V=+g[h+288>>2];$=m+(t<<4)+4|0;aa=m+(t<<4)+8|0;g[m+(t<<4)+12>>2]=0.0;ca=1.0/+Q(+((X*Y-Z*ba)*(X*Y-Z*ba)+(Z*W-Y*V)*(Z*W-Y*V)+(ba*V-X*W)*(ba*V-X*W)));g[w>>2]=(X*Y-Z*ba)*ca;g[$>>2]=(Z*W-Y*V)*ca;g[aa>>2]=(ba*V-X*W)*ca;p=c[f>>2]|0;g[p+(t*36|0)+20>>2]=(X*Y-Z*ba)*ca;g[p+(t*36|0)+24>>2]=+g[$>>2];g[p+(t*36|0)+28>>2]=+g[aa>>2];g[p+(t*36|0)+32>>2]=1.0000000150474662e+30}else{c[w+0>>2]=0;c[w+4>>2]=0;c[w+8>>2]=0;c[w+12>>2]=0;p=c[f>>2]|0}u=c[p+(t*36|0)+4>>2]|0;if((u|0)>0){v=c[(c[d+52>>2]|0)+16>>2]|0;B=+g[w>>2];z=+g[m+(t<<4)+4>>2];A=+g[m+(t<<4)+8>>2];x=c[p+(t*36|0)+12>>2]|0;R=1.0000000150474662e+30;w=0;do{aa=c[x+(w<<2)>>2]|0;ca=+g[v+(aa<<4)>>2]*B+ +g[v+(aa<<4)+4>>2]*z+ +g[v+(aa<<4)+8>>2]*A;R=R>ca?ca:R;w=w+1|0}while((w|0)<(u|0))}else R=1.0000000150474662e+30;g[p+(t*36|0)+32>>2]=-R;t=t+1|0}while((t|0)<(s|0));s=c[l>>2]|0;if((s|0)>0){t=0;r=0;w=0;do{if((w|0)==(t|0)){t=(w|0)==0?1:w<<1;if((w|0)<(t|0)){if((t|0)!=0?(c[5004]=(c[5004]|0)+1,q=fF((t<<2|3)+16|0)|0,(q|0)!=0):0){c[(q+19&-16)+ -4>>2]=q;u=q+19&-16}else u=0;if((w|0)>0){x=0;do{v=u+(x<<2)|0;if(v)c[v>>2]=c[r+(x<<2)>>2];x=x+1|0}while((x|0)!=(w|0))}if(!r)r=u;else{c[5006]=(c[5006]|0)+1;gF(c[r+ -4>>2]|0);r=u}}else t=w}u=r+(w<<2)|0;if(u){c[u>>2]=w;s=c[l>>2]|0}w=w+1|0}while((w|0)<(s|0));if(!w)o=r;else{q=h+88|0;u=h+84|0;t=h+76|0;s=h+32|0;v=h+308|0;B=0.0;A=0.0;z=0.0;while(1){C=w+ -1|0;w=c[r+(C<<2)>>2]|0;c[5004]=(c[5004]|0)+1;y=fF(23)|0;if(y){c[(y+19&-16)+ -4>>2]=y;x=y+19&-16;if(y+19&-16)c[x>>2]=w}else x=0;S=+g[p+(w*36|0)+20>>2];R=+g[p+(w*36|0)+24>>2];T=+g[p+(w*36|0)+28>>2];w=C;F=1;y=1;D=C;c:while(1){C=(w|0)>0;d:while(1){do{aa=D;D=D+ -1|0;if((aa|0)<=0)break c;E=c[r+(D<<2)>>2]|0}while(!(S*+g[p+(E*36|0)+20>>2]+R*+g[p+(E*36|0)+24>>2]+T*+g[p+(E*36|0)+28>>2]>.9990000128746033));do if((y|0)==(F|0)?(o=(F|0)==0?1:F<<1,(F|0)<(o|0)):0){do if(!o)G=0;else{c[5004]=(c[5004]|0)+1;G=fF((o<<2|3)+16|0)|0;if(!G){G=0;break}c[(G+19&-16)+ -4>>2]=G;G=G+19&-16}while(0);if((F|0)>0){H=0;do{I=G+(H<<2)|0;if(I)c[I>>2]=c[x+(H<<2)>>2];H=H+1|0}while((H|0)!=(F|0))}if(!x){F=o;x=G;break}c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0);F=o;x=G}while(0);G=x+(y<<2)|0;if(G)c[G>>2]=E;y=y+1|0;if(C)I=0;else continue;while(1){H=r+(I<<2)|0;G=I+1|0;if((c[H>>2]|0)==(E|0))break;if((G|0)<(w|0))I=G;else continue d}if((I|0)<(w|0))break}aa=w+ -1|0;$=r+(aa<<2)|0;c[H>>2]=c[$>>2];c[$>>2]=E;w=aa}if((y|0)>1){a[q>>0]=1;c[u>>2]=0;c[t>>2]=0;c[h+80>>2]=0;G=0;B=0.0;A=0.0;z=0.0;C=0;do{E=c[x+(C<<2)>>2]|0;B=+g[p+(E*36|0)+20>>2]+B;A=+g[p+(E*36|0)+24>>2]+A;z=+g[p+(E*36|0)+28>>2]+z;D=p+(E*36|0)+4|0;H=c[D>>2]|0;if((H|0)>0){E=p+(E*36|0)+12|0;J=G;F=0;while(1){G=c[(c[E>>2]|0)+(F<<2)>>2]|0;aa=(c[(c[d+52>>2]|0)+16>>2]|0)+(G<<4)|0;c[h+56>>2]=c[aa+0>>2];c[h+60>>2]=c[aa+4>>2];c[h+64>>2]=c[aa+8>>2];c[h+68>>2]=c[aa+12>>2];e:do if((J|0)>0){I=c[u>>2]|0;K=0;while(1){if((c[I+(K*24|0)+20>>2]|0)==(G|0)){G=J;break e}K=K+1|0;if((K|0)>=(J|0)){n=207;break}}}else n=207;while(0);if((n|0)==207){n=0;c[h+0>>2]=c[h+56>>2];c[h+4>>2]=c[h+60>>2];c[h+8>>2]=c[h+64>>2];c[h+12>>2]=c[h+68>>2];do if((J|0)==(c[h+80>>2]|0)){H=(J|0)==0?1:J<<1;if((J|0)>=(H|0))break;if(!H)I=0;else{c[5004]=(c[5004]|0)+1;I=fF((H*24|3)+16|0)|0;if(!I)I=0;else{c[(I+19&-16)+ -4>>2]=I;I=I+19&-16}J=c[t>>2]|0}K=c[u>>2]|0;if((J|0)<=0){if(K)n=216}else{n=0;do{aa=I+(n*24|0)|0;$=K+(n*24|0)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];c[aa+16>>2]=c[$+16>>2];c[aa+20>>2]=c[$+20>>2];n=n+1|0}while((n|0)!=(J|0));n=216}if((n|0)==216){n=0;if(!((a[q>>0]|0)==0|(K|0)==0)){c[5006]=(c[5006]|0)+1;gF(c[K+ -4>>2]|0);J=c[t>>2]|0}c[u>>2]=0}a[q>>0]=1;c[u>>2]=I;c[h+80>>2]=H}while(0);H=c[u>>2]|0;aa=H+(J*24|0)|0;c[aa+0>>2]=c[h+0>>2];c[aa+4>>2]=c[h+4>>2];c[aa+8>>2]=c[h+8>>2];c[aa+12>>2]=c[h+12>>2];c[aa+16>>2]=c[h+16>>2];c[H+(J*24|0)+20>>2]=G;G=(c[t>>2]|0)+1|0;c[t>>2]=G;H=c[D>>2]|0}F=F+1|0;if((F|0)>=(H|0))break;else J=G}}C=C+1|0}while((C|0)<(y|0));a[h+36>>0]=1;c[s>>2]=0;c[h+24>>2]=0;c[h+28>>2]=0;aa=p+((c[x>>2]|0)*9<<2)+20|0;c[h+40>>2]=c[aa+0>>2];c[h+44>>2]=c[aa+4>>2];c[h+48>>2]=c[aa+8>>2];c[h+52>>2]=c[aa+12>>2];ca=1.0/+Q(+(B*B+A*A+z*z));B=B*ca;A=A*ca;z=z*ca;if(+P(+z)>.7071067690849304){S=1.0/+Q(+(z*z+A*A));T=0.0;R=-(z*S);S=A*S}else{R=1.0/+Q(+(B*B+A*A));T=-(A*R);R=B*R;S=0.0}f:do if((G|0)<2)if((G|0)>0){D=0;J=0;C=0;n=1;while(1){E=c[u>>2]|0;do if((D|0)==(J|0)){F=(J|0)==0?1:J<<1;if((J|0)>=(F|0)){I=J;F=J;break}do if(!F)H=0;else{c[5004]=(c[5004]|0)+1;G=fF((F*24|3)+16|0)|0;if(!G){H=0;J=D;break}c[(G+19&-16)+ -4>>2]=G;H=G+19&-16;J=D}while(0);if((J|0)>0){G=0;do{aa=H+(G*24|0)|0;$=C+(G*24|0)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];c[aa+16>>2]=c[$+16>>2];c[aa+20>>2]=c[$+20>>2];G=G+1|0}while((G|0)!=(J|0))}if(C){c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0)}I=D;G=c[t>>2]|0;C=H}else{I=D;F=J}while(0);aa=C+(I*24|0)|0;c[aa+0>>2]=c[E+0>>2];c[aa+4>>2]=c[E+4>>2];c[aa+8>>2]=c[E+8>>2];c[aa+12>>2]=c[E+12>>2];c[aa+16>>2]=c[E+16>>2];c[aa+20>>2]=c[E+20>>2];D=D+1|0;if((n|0)>=(G|0)){n=272;break f}J=F;n=n+1|0}}else{C=0;n=307}else{n=c[u>>2]|0;C=G;D=0;do{if(T*+g[n+(D*24|0)>>2]+R*+g[n+(D*24|0)+4>>2]+S*+g[n+(D*24|0)+8>>2]<T*+g[n>>2]+R*+g[n+4>>2]+S*+g[n+8>>2]){c[h+288>>2]=c[n+0>>2];c[h+292>>2]=c[n+4>>2];c[h+296>>2]=c[n+8>>2];c[h+300>>2]=c[n+12>>2];c[h+304>>2]=c[n+16>>2];c[h+308>>2]=c[n+20>>2];C=n+(D*24|0)|0;c[n+0>>2]=c[C+0>>2];c[n+4>>2]=c[C+4>>2];c[n+8>>2]=c[C+8>>2];c[n+12>>2]=c[C+12>>2];c[n+16>>2]=c[C+16>>2];c[n+20>>2]=c[C+20>>2];C=n+(D*24|0)|0;c[C+0>>2]=c[h+288>>2];c[C+4>>2]=c[h+292>>2];c[C+8>>2]=c[h+296>>2];c[C+12>>2]=c[h+300>>2];c[C+16>>2]=c[h+304>>2];c[C+20>>2]=c[h+308>>2];C=G}D=D+1|0}while((D|0)<(C|0));g[n+16>>2]=-1.0000000150474662e+30;if((C|0)>1){U=+g[n+4>>2];D=1;do{Z=+g[n+(D*24|0)>>2]- +g[n>>2];ba=+g[n+(D*24|0)+4>>2]-U;ca=+g[n+(D*24|0)+8>>2]- +g[n+8>>2];g[n+(D*24|0)+16>>2]=((T*ba-R*Z)*z+(B*(R*ca-S*ba)+A*(S*Z-T*ca)))/+Q(+(Z*Z+ba*ba+ca*ca));D=D+1|0}while((D|0)<(C|0))}c[h+272>>2]=c[n+0>>2];c[h+276>>2]=c[n+4>>2];c[h+280>>2]=c[n+8>>2];c[h+284>>2]=c[n+12>>2];JA(h+72|0,h+272|0,1,C+ -1|0);C=c[u>>2]|0;c[5004]=(c[5004]|0)+1;n=fF(43)|0;if(!n)n=0;else{c[(n+19&-16)+ -4>>2]=n;n=n+19&-16}D=c[u>>2]|0;c[n+0>>2]=c[C+0>>2];c[n+4>>2]=c[C+4>>2];c[n+8>>2]=c[C+8>>2];c[n+12>>2]=c[C+12>>2];c[n+16>>2]=c[C+16>>2];c[n+20>>2]=c[C+20>>2];c[5004]=(c[5004]|0)+1;C=fF(67)|0;if(!C)C=0;else{c[(C+19&-16)+ -4>>2]=C;C=C+19&-16}E=0;while(1){aa=C+(E*24|0)|0;$=n+(E*24|0)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];c[aa+16>>2]=c[$+16>>2];c[aa+20>>2]=c[$+20>>2];if(!E)break;else E=E+1|0}if(n){c[5006]=(c[5006]|0)+1;gF(c[n+ -4>>2]|0)}G=C+24|0;c[G+0>>2]=c[D+24>>2];c[G+4>>2]=c[D+28>>2];c[G+8>>2]=c[D+32>>2];c[G+12>>2]=c[D+36>>2];c[G+16>>2]=c[D+40>>2];c[G+20>>2]=c[D+44>>2];G=c[t>>2]|0;if((G|0)==2){D=2;n=273;break}else{H=2;D=2;F=2;n=2}while(1){g:do if((H|0)>1){aa=c[u>>2]|0;E=aa+(n*24|0)|0;R=+g[E>>2];S=+g[aa+(n*24|0)+4>>2];T=+g[aa+(n*24|0)+8>>2];while(1){aa=H+ -2|0;I=H+ -1|0;Z=+g[C+(aa*24|0)>>2];ba=Z- +g[C+(I*24|0)>>2];X=+g[C+(aa*24|0)+4>>2];W=X- +g[C+(I*24|0)+4>>2];ca=+g[C+(aa*24|0)+8>>2];Y=ca- +g[C+(I*24|0)+8>>2];if((ba*(X-S)-W*(Z-R))*z+(B*(W*(ca-T)-Y*(X-S))+A*(Y*(Z-R)-ba*(ca-T)))>0.0)break;if((I|0)>1){H=I;D=I}else{H=I;D=I;break g}}do if((H|0)==(F|0)){I=(F|0)==0?1:F<<1;if((F|0)>=(I|0)){H=F;break}do if(!I)J=0;else{c[5004]=(c[5004]|0)+1;F=fF((I*24|3)+16|0)|0;if(!F){J=0;F=D;break}c[(F+19&-16)+ -4>>2]=F;J=F+19&-16;F=D}while(0);if((F|0)>0){G=0;do{aa=J+(G*24|0)|0;$=C+(G*24|0)|0;c[aa+0>>2]=c[$+0>>2];c[aa+4>>2]=c[$+4>>2];c[aa+8>>2]=c[$+8>>2];c[aa+12>>2]=c[$+12>>2];c[aa+16>>2]=c[$+16>>2];c[aa+20>>2]=c[$+20>>2];G=G+1|0}while((G|0)!=(F|0))}if(C){c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0)}G=c[t>>2]|0;H=D;F=I;C=J}while(0);H=C+(H*24|0)|0;c[H+0>>2]=c[E+0>>2];c[H+4>>2]=c[E+4>>2];c[H+8>>2]=c[E+8>>2];c[H+12>>2]=c[E+12>>2];c[H+16>>2]=c[E+16>>2];c[H+20>>2]=c[E+20>>2];D=D+1|0;H=D}while(0);n=n+1|0;if((n|0)==(G|0)){n=272;break}}}while(0);if((n|0)==272)if((D|0)>0)n=273;else n=295;if((n|0)==273){H=0;G=0;F=0;n=0;do{E=C+(n*24|0)+20|0;do if((H|0)==(G|0)){I=(G|0)==0?1:G<<1;if((G|0)>=(I|0)){H=G;break}do if(!I)H=0;else{c[5004]=(c[5004]|0)+1;H=fF((I<<2|3)+16|0)|0;if(!H){H=0;break}c[(H+19&-16)+ -4>>2]=H;H=H+19&-16}while(0);if((G|0)>0){J=0;do{K=H+(J<<2)|0;if(K)c[K>>2]=c[F+(J<<2)>>2];J=J+1|0}while((J|0)!=(G|0))}if(F){c[5006]=(c[5006]|0)+1;gF(c[F+ -4>>2]|0);c[s>>2]=0}a[h+36>>0]=1;c[s>>2]=H;c[h+28>>2]=I;F=H;H=G;G=I}while(0);I=F+(H<<2)|0;if(I){c[I>>2]=c[E>>2];H=c[h+24>>2]|0}H=H+1|0;c[h+24>>2]=H;J=c[t>>2]|0;h:do if((J|0)>0){I=c[u>>2]|0;E=c[E>>2]|0;K=0;while(1){L=I+(K*24|0)+20|0;K=K+1|0;if((c[L>>2]|0)==(E|0))break;if((K|0)>=(J|0))break h}c[L>>2]=-1}while(0);n=n+1|0}while((n|0)<(D|0));G=c[t>>2]|0;n=295}i:do if((n|0)==295){n=0;if((G|0)>0){H=c[u>>2]|0;I=c[l>>2]|0;F=0;while(1){E=c[H+(F*24|0)+20>>2]|0;if(!((E|0)==-1|(I|0)<1)){D=0;do{J=0;while(1){if((c[x+(J<<2)>>2]|0)==(D|0))break;J=J+1|0;if((J|0)>=(y|0)){n=303;break}}do if((n|0)==303){n=0;J=c[p+(D*36|0)+4>>2]|0;if((J|0)<=0)break;K=c[p+(D*36|0)+12>>2]|0;L=0;do{if((c[K+(L<<2)>>2]|0)==(E|0)){D=1;break i}L=L+1|0}while((L|0)<(J|0))}while(0);D=D+1|0}while((D|0)<(I|0))}F=F+1|0;if((F|0)>=(G|0)){n=307;break}}}else n=307}while(0);if((n|0)==307){n=0;D=c[d+52>>2]|0;E=c[D+28>>2]|0;if((E|0)==(c[D+32>>2]|0)){GA(D+24|0,(E|0)==0?1:E<<1);E=c[D+28>>2]|0}F=(c[D+36>>2]|0)+(E*36|0)|0;if(F){IA(F,h+20|0);c[F+20>>2]=c[h+40>>2];c[F+24>>2]=c[h+44>>2];c[F+28>>2]=c[h+48>>2];c[F+32>>2]=c[h+52>>2];E=c[D+28>>2]|0}c[D+28>>2]=E+1;D=0}if(C){c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0)}C=c[s>>2]|0;if(C){if(a[h+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0)}c[s>>2]=0}C=c[u>>2]|0;if(C){if(a[q>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[C+ -4>>2]|0)}c[u>>2]=0}a[q>>0]=1;c[u>>2]=0;c[t>>2]=0;c[h+80>>2]=0;if(D&(y|0)>0)n=324}else if((y|0)>0)n=324;if((n|0)==324){n=0;C=0;do{D=c[x+(C<<2)>>2]|0;IA(h+288|0,p+(D*36|0)|0);D=p+(D*36|0)+20|0;c[v+0>>2]=c[D+0>>2];c[v+4>>2]=c[D+4>>2];c[v+8>>2]=c[D+8>>2];c[v+12>>2]=c[D+12>>2];D=c[d+52>>2]|0;E=c[D+28>>2]|0;if((E|0)==(c[D+32>>2]|0)){GA(D+24|0,(E|0)==0?1:E<<1);E=c[D+28>>2]|0}F=(c[D+36>>2]|0)+(E*36|0)|0;if(F){IA(F,h+288|0);c[F+20>>2]=c[v+0>>2];c[F+24>>2]=c[v+4>>2];c[F+28>>2]=c[v+8>>2];c[F+32>>2]=c[v+12>>2];E=c[D+28>>2]|0}c[D+28>>2]=E+1;D=c[h+300>>2]|0;if(D){if(a[h+304>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[D+ -4>>2]|0)}c[h+300>>2]=0}C=C+1|0}while((C|0)<(y|0))}if(x){c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0)}if(!w){o=r;break}}}}else o=0}else o=0;d=c[d+52>>2]|0;c[d+64>>2]=0;c[d+68>>2]=0;c[d+72>>2]=0;c[d+76>>2]=0;r=c[d+28>>2]|0;if((r|0)>0){s=r;w=0;u=0;G=0;L=0;H=0;K=0;J=0;I=0;F=0;y=0;E=0;x=0;q=0;while(1){C=c[d+36>>2]|0;r=c[C+(q*36|0)+4>>2]|0;if((r|0)>0){t=q&65535;s=q|-65536;D=0;while(1){v=D+1|0;M=c[C+(q*36|0)+12>>2]|0;O=c[M+(D<<2)>>2]&65535;M=c[M+(((v|0)==(r|0)?0:v)<<2)>>2]&65535;D=O<<16>>16<M<<16>>16?O:M;C=O<<16>>16<M<<16>>16?M:O;_=O<<16>>16<M<<16>>16?O:M;O=O<<16>>16<M<<16>>16?M:O;M=G+ -1|0;j:do if((((_&65535)<<16)+(O<<16>>16)&M)>>>0<w>>>0?(k=c[F+((((_&65535)<<16)+(O<<16>>16)&M)<<2)>>2]|0,(k|0)!=-1):0){N=k;while(1){if(O<<16>>16==(b[J+(N<<2)>>1]|0)?_<<16>>16==(b[J+(N<<2)+2>>1]|0):0)break;N=c[x+(N<<2)>>2]|0;if((N|0)==-1){N=0;break j}}if((N|0)!=-1)N=L+(N<<2)|0;else N=0}else N=0;while(0);aa=c[d+16>>2]|0;A=+g[aa+(_<<16>>16<<4)>>2]- +g[aa+(O<<16>>16<<4)>>2];z=+g[aa+(_<<16>>16<<4)+4>>2]- +g[aa+(O<<16>>16<<4)+4>>2];B=+g[aa+(_<<16>>16<<4)+8>>2]- +g[aa+(O<<16>>16<<4)+8>>2];R=1.0/+Q(+(A*A+z*z+B*B));_=c[d+48>>2]|0;k:do if((_|0)>0){O=c[d+56>>2]|0;$=0;while(1){S=+g[O+($<<4)>>2];T=+g[O+($<<4)+8>>2];do if(!(+P(+(S-A*R))>1.0e-6)){if(+P(+(+g[O+($<<4)+4>>2]-z*R))>1.0e-6)break;if(!(+P(+(T-B*R))>1.0e-6))break k}while(0);do if(!(+P(+(A*R+S))>1.0e-6)){if(+P(+(z*R+ +g[O+($<<4)+4>>2]))>1.0e-6)break;if(!(+P(+(B*R+T))>1.0e-6))break k}while(0);$=$+1|0;if(($|0)>=(_|0)){n=359;break}}}else n=359;while(0);if((n|0)==359){n=0;do if((_|0)==(c[d+52>>2]|0)){O=(_|0)==0?1:_<<1;if((_|0)>=(O|0))break;if(!O)$=0;else{c[5004]=(c[5004]|0)+1;_=fF((O<<4|3)+16|0)|0;if(!_)$=0;else{c[(_+19&-16)+ -4>>2]=_;$=_+19&-16}_=c[d+48>>2]|0}if((_|0)>0){aa=0;do{da=$+(aa<<4)|0;ea=(c[d+56>>2]|0)+(aa<<4)|0;c[da+0>>2]=c[ea+0>>2];c[da+4>>2]=c[ea+4>>2];c[da+8>>2]=c[ea+8>>2];c[da+12>>2]=c[ea+12>>2];aa=aa+1|0}while((aa|0)!=(_|0))}_=c[d+56>>2]|0;if(_){if(a[d+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[_+ -4>>2]|0)}c[d+56>>2]=0}a[d+60>>0]=1;c[d+56>>2]=$;c[d+52>>2]=O;_=c[d+48>>2]|0}while(0);ea=c[d+56>>2]|0;g[ea+(_<<4)>>2]=A*R;g[ea+(_<<4)+4>>2]=z*R;g[ea+(_<<4)+8>>2]=B*R;g[ea+(_<<4)+12>>2]=0.0;c[d+48>>2]=(c[d+48>>2]|0)+1}l:do if(!N){O=((D&65535)<<16)+(C<<16>>16)&M;m:do if(O>>>0<w>>>0){M=c[F+(O<<2)>>2]|0;if((M|0)==-1)break;while(1){if(C<<16>>16==(b[J+(M<<2)>>1]|0)?D<<16>>16==(b[J+(M<<2)+2>>1]|0):0)break;M=c[x+(M<<2)>>2]|0;if((M|0)==-1)break m}if((M|0)==-1)break;ea=L+(M<<2)|0;b[ea>>1]=s;b[ea+2>>1]=s>>>16;break l}while(0);do if((u|0)==(G|0)){M=(G|0)==0?1:G<<1;if((G|0)>=(M|0)){_=G;M=G;break}do if(!M)N=0;else{c[5004]=(c[5004]|0)+1;N=fF((M<<2|3)+16|0)|0;if(!N){N=0;break}c[(N+19&-16)+ -4>>2]=N;N=N+19&-16}while(0);if((G|0)>0){_=0;do{$=N+(_<<2)|0;if($){ea=L+(_<<2)|0;ea=e[ea>>1]|e[ea+2>>1]<<16;b[$>>1]=ea;b[$+2>>1]=ea>>>16}_=_+1|0}while((_|0)!=(G|0))}if(!L){_=G;L=N;break}c[5006]=(c[5006]|0)+1;gF(c[L+ -4>>2]|0);_=G;L=N}else{_=u;M=G}while(0);N=L+(_<<2)|0;if(N){b[N>>1]=s;b[N+2>>1]=s>>>16;_=u}N=_+1|0;do if((H|0)==(K|0)){K=(H|0)==0?1:H<<1;if((H|0)>=(K|0)){K=H;break}do if(!K)_=0;else{c[5004]=(c[5004]|0)+1;_=fF((K<<2|3)+16|0)|0;if(!_){_=0;break}c[(_+19&-16)+ -4>>2]=_;_=_+19&-16}while(0);if((H|0)>0){aa=0;do{$=_+(aa<<2)|0;if($){ea=J+(aa<<2)|0;ea=e[ea>>1]|e[ea+2>>1]<<16;b[$>>1]=ea;b[$+2>>1]=ea>>>16}aa=aa+1|0}while((aa|0)!=(H|0))}if(!J){J=_;break}c[5006]=(c[5006]|0)+1;gF(c[J+ -4>>2]|0);J=_}while(0);_=J+(H<<2)|0;if(_){b[_>>1]=(D&65535)<<16|C&65535;b[_+2>>1]=((D&65535)<<16|C&65535)>>>16}H=H+1|0;if((G|0)<(M|0)){do if((w|0)<(M|0)){if((w|0)<=(M|0)){do if((I|0)<(M|0)){do if(!M)G=0;else{c[5004]=(c[5004]|0)+1;G=fF((M<<2|3)+16|0)|0;if(!G){G=0;break}c[(G+19&-16)+ -4>>2]=G;G=G+19&-16}while(0);if((w|0)>0){I=0;do{O=G+(I<<2)|0;if(O)c[O>>2]=c[F+(I<<2)>>2];I=I+1|0}while((I|0)!=(w|0))}if(!F){I=M;F=G;break}c[5006]=(c[5006]|0)+1;gF(c[F+ -4>>2]|0);I=M;F=G}while(0);O=w;do{G=F+(O<<2)|0;if(G)c[G>>2]=0;O=O+1|0}while((O|0)!=(M|0))}if((y|0)<(M|0)){do if((E|0)<(M|0)){do if(!M)G=0;else{c[5004]=(c[5004]|0)+1;E=fF((M<<2|3)+16|0)|0;if(!E){G=0;break}c[(E+19&-16)+ -4>>2]=E;G=E+19&-16}while(0);if((y|0)>0){E=0;do{O=G+(E<<2)|0;if(O)c[O>>2]=c[x+(E<<2)>>2];E=E+1|0}while((E|0)!=(y|0))}if(!x){E=M;x=G;break}c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0);E=M;x=G}while(0);do{G=x+(y<<2)|0;if(G)c[G>>2]=0;y=y+1|0}while((y|0)!=(M|0))}if((M|0)>0){ea=M<<2;jF(F|0,-1,ea|0)|0;jF(x|0,-1,ea|0)|0}if((w|0)<=0){w=M;y=M;break}G=M+ -1|0;y=0;do{ea=F+(((e[J+(y<<2)+2>>1]<<16)+(b[J+(y<<2)>>1]|0)&G)<<2)|0;c[x+(y<<2)>>2]=c[ea>>2];c[ea>>2]=y;y=y+1|0}while((y|0)!=(w|0));w=M;y=M}while(0);O=((D&65535)<<16)+(C<<16>>16)&M+ -1}G=F+(O<<2)|0;c[x+(u<<2)>>2]=c[G>>2];c[G>>2]=u;u=N;G=M}else b[N+2>>1]=t;while(0);if((v|0)>=(r|0))break;C=c[d+36>>2]|0;D=v}r=c[d+28>>2]|0}else r=s;q=q+1|0;if((q|0)>=(r|0))break;else s=r}if((r|0)>0){n=c[d+36>>2]|0;q=c[d+16>>2]|0;R=0.0;k=0;do{u=c[n+(k*36|0)+4>>2]|0;t=c[n+(k*36|0)+12>>2]|0;s=c[t>>2]|0;if((u+ -2|0)>=1){B=+g[d+64>>2];A=+g[d+68>>2];z=+g[d+72>>2];v=1;do{da=c[t+(v<<2)>>2]|0;v=v+1|0;ea=c[t+(((v|0)%(u|0)|0)<<2)>>2]|0;S=+g[q+(s<<4)>>2];T=+g[q+(da<<4)>>2];V=+g[q+(s<<4)+4>>2];W=+g[q+(da<<4)+4>>2];Y=+g[q+(s<<4)+8>>2];Z=+g[q+(da<<4)+8>>2];U=+g[q+(ea<<4)>>2];X=+g[q+(ea<<4)+4>>2];ba=+g[q+(ea<<4)+8>>2];ca=+Q(+(((S-T)*(V-X)-(V-W)*(S-U))*((S-T)*(V-X)-(V-W)*(S-U))+(((V-W)*(Y-ba)-(Y-Z)*(V-X))*((V-W)*(Y-ba)-(Y-Z)*(V-X))+((Y-Z)*(S-U)-(S-T)*(Y-ba))*((Y-Z)*(S-U)-(S-T)*(Y-ba)))))*.5;B=B+(S+T+U)*.3333333432674408*ca;g[d+64>>2]=B;A=(V+W+X)*.3333333432674408*ca+A;g[d+68>>2]=A;z=ca*(Y+Z+ba)*.3333333432674408+z;g[d+72>>2]=z;R=R+ca}while((v|0)!=(u+ -1|0))}k=k+1|0}while((k|0)<(r|0))}else R=0.0}else{R=0.0;L=0;J=0;F=0;x=0}A=1.0/R;R=A*+g[d+64>>2];g[d+64>>2]=R;B=A*+g[d+68>>2];g[d+68>>2]=B;A=A*+g[d+72>>2];g[d+72>>2]=A;g[d+96>>2]=3.4028234663852886e+38;if((r|0)>0){n=c[d+36>>2]|0;S=3.4028234663852886e+38;k=0;while(1){z=+P(+(+g[n+(k*36|0)+32>>2]+(+g[n+(k*36|0)+20>>2]*R+ +g[n+(k*36|0)+24>>2]*B+ +g[n+(k*36|0)+28>>2]*A)));if(z<S)g[d+96>>2]=z;else z=S;k=k+1|0;if((k|0)>=(r|0))break;else S=z}}else z=3.4028234663852886e+38;k=c[d+8>>2]|0;if((k|0)>0){n=c[d+16>>2]|0;S=-3.4028234663852886e+38;T=-3.4028234663852886e+38;U=-3.4028234663852886e+38;R=3.4028234663852886e+38;B=3.4028234663852886e+38;A=3.4028234663852886e+38;q=0;do{ca=+g[n+(q<<4)>>2];R=ca<R?ca:R;S=ca>S?ca:S;ca=+g[n+(q<<4)+4>>2];B=ca<B?ca:B;T=ca>T?ca:T;ca=+g[n+(q<<4)+8>>2];A=ca<A?ca:A;U=ca>U?ca:U;q=q+1|0}while((q|0)<(k|0))}else{S=-3.4028234663852886e+38;T=-3.4028234663852886e+38;U=-3.4028234663852886e+38;R=3.4028234663852886e+38;B=3.4028234663852886e+38;A=3.4028234663852886e+38}g[d+100>>2]=S+R;g[d+104>>2]=T+B;g[d+108>>2]=A+U;g[d+112>>2]=0.0;R=S-R;B=T-B;A=U-A;g[d+116>>2]=R;g[d+120>>2]=B;g[d+124>>2]=A;g[d+128>>2]=0.0;z=z/1.7320507764816284;if(R<B)k=B<A?2:1;else k=R<A?2:0;n=d+(k<<2)+116|0;A=(+g[n>>2]*.5-z)*.0009765625;g[d+88>>2]=z;g[d+84>>2]=z;g[d+80>>2]=z;B=+g[n>>2]*.5;n=d+(k<<2)+80|0;g[n>>2]=B;q=0;while(1){if(MD(d)|0){n=470;break}B=B-A;g[n>>2]=B;q=q+1|0;if((q|0)>=1024){n=469;break}}n:do if((n|0)==469){g[d+88>>2]=z;g[d+84>>2]=z;g[d+80>>2]=z}else if((n|0)==470){z=(+g[d+96>>2]-z)*.0009765625;k=1<<k&3;R=+g[d+((1<<k&3)<<2)+80>>2];n=0;while(1){A=+g[d+(k<<2)+80>>2];g[d+(k<<2)+80>>2]=z+A;B=z+ +g[d+((1<<k&3)<<2)+80>>2];g[d+((1<<k&3)<<2)+80>>2]=B;n=n+1|0;if(!(MD(d)|0))break;if((n|0)>=1024)break n;else R=B}g[d+(k<<2)+80>>2]=A;g[d+((1<<k&3)<<2)+80>>2]=R}while(0);if(J){c[5006]=(c[5006]|0)+1;gF(c[J+ -4>>2]|0)}if(L){c[5006]=(c[5006]|0)+1;gF(c[L+ -4>>2]|0)}if(x){c[5006]=(c[5006]|0)+1;gF(c[x+ -4>>2]|0)}if(F){c[5006]=(c[5006]|0)+1;gF(c[F+ -4>>2]|0)}if(o){c[5006]=(c[5006]|0)+1;gF(c[o+ -4>>2]|0)}o=c[l>>2]|0;if((o|0)>0){q=0;do{k=p+(q*36|0)+4|0;n=p+(q*36|0)+12|0;r=c[n>>2]|0;d=p+(q*36|0)+16|0;if(r){if(a[d>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[r+ -4>>2]|0)}c[n>>2]=0}a[d>>0]=1;c[n>>2]=0;c[k>>2]=0;c[p+(q*36|0)+8>>2]=0;q=q+1|0}while((q|0)!=(o|0));p=c[f>>2]|0}if(p){if(a[h+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[p+ -4>>2]|0)}c[f>>2]=0}a[h+164>>0]=1;c[f>>2]=0;c[l>>2]=0;c[h+156>>2]=0;if(m){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}HA(h+196|0);if(!j){i=h;return 1}c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);i=h;return 1}function BA(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0,n=0,o=0,p=0.0,q=0.0,r=0;e=i;i=i+2048|0;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;h=+g[d>>2];j=+g[d+4>>2];k=+g[d+8>>2];if(h*h+j*j+k*k<9999999747378752.0e-20){h=1.0;j=0.0;k=0.0}else{p=1.0/+Q(+(h*h+j*j+k*k));h=h*p;j=j*p;k=k*p}if((Pb[c[(c[b>>2]|0)+96>>2]&127](b)|0)<=0){i=e;return}d=0;l=-999999984306749400.0;do{if(((Pb[c[(c[b>>2]|0)+96>>2]&127](b)|0)-d|0)<128){m=(Pb[c[(c[b>>2]|0)+96>>2]&127](b)|0)-d|0;if((m|0)>0)f=7;else{p=-3.4028234663852886e+38;o=-1}}else{m=128;f=7}if((f|0)==7){f=0;n=0;do{rc[c[(c[b>>2]|0)+108>>2]&127](b,n,e+(n<<4)|0);n=n+1|0}while((n|0)!=(m|0));n=0;p=-3.4028234663852886e+38;o=-1;do{q=h*+g[e+(n<<4)>>2]+j*+g[e+(n<<4)+4>>2]+k*+g[e+(n<<4)+8>>2];r=q>p;o=r?n:o;p=r?q:p;n=n+1|0}while((n|0)!=(m|0))}if(p>l){r=e+(o<<4)|0;c[a+0>>2]=c[r+0>>2];c[a+4>>2]=c[r+4>>2];c[a+8>>2]=c[r+8>>2];c[a+12>>2]=c[r+12>>2];l=p}d=d+128|0}while((d|0)<(Pb[c[(c[b>>2]|0)+96>>2]&127](b)|0));i=e;return}function CA(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0.0,s=0,t=0.0,u=0,v=0.0,w=0.0,x=0.0,y=0;h=i;i=i+2048|0;if((e|0)>0)j=0;else{i=h;return}do{g[d+(j<<4)+12>>2]=-999999984306749400.0;j=j+1|0}while((j|0)!=(e|0));k=0;do{if((Pb[c[(c[a>>2]|0)+96>>2]&127](a)|0)>0){o=b+(k<<4)|0;p=b+(k<<4)+4|0;j=b+(k<<4)+8|0;m=d+(k<<4)+12|0;l=d+(k<<4)|0;n=0;do{if(((Pb[c[(c[a>>2]|0)+96>>2]&127](a)|0)-n|0)<128){q=(Pb[c[(c[a>>2]|0)+96>>2]&127](a)|0)-n|0;if((q|0)>0)f=8;else{w=-3.4028234663852886e+38;s=-1}}else{q=128;f=8}if((f|0)==8){f=0;s=0;do{rc[c[(c[a>>2]|0)+108>>2]&127](a,s,h+(s<<4)|0);s=s+1|0}while((s|0)!=(q|0));t=+g[o>>2];r=+g[p>>2];v=+g[j>>2];u=0;w=-3.4028234663852886e+38;s=-1;do{x=t*+g[h+(u<<4)>>2]+r*+g[h+(u<<4)+4>>2]+v*+g[h+(u<<4)+8>>2];y=x>w;s=y?u:s;w=y?x:w;u=u+1|0}while((u|0)!=(q|0))}if(w>+g[m>>2]){y=h+(s<<4)|0;c[l+0>>2]=c[y+0>>2];c[l+4>>2]=c[y+4>>2];c[l+8>>2]=c[y+8>>2];c[l+12>>2]=c[y+12>>2];g[m>>2]=w}n=n+128|0}while((n|0)<(Pb[c[(c[a>>2]|0)+96>>2]&127](a)|0))}k=k+1|0}while((k|0)!=(e|0));i=h;return}function DA(a,b,d){a=a|0;b=+b;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0;e=i;i=i+96|0;j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);g[e+32>>2]=1.0;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=1.0;c[e+56>>2]=0;c[e+60>>2]=0;c[e+64>>2]=0;c[e+68>>2]=0;g[e+72>>2]=1.0;k=e+76|0;c[k+0>>2]=0;c[k+4>>2]=0;c[k+8>>2]=0;c[k+12>>2]=0;c[k+16>>2]=0;vc[c[(c[a>>2]|0)+8>>2]&127](a,e+32|0,e+16|0,e);h=(j+(+g[e>>2]- +g[e+16>>2])*.5)*2.0;f=(j+(+g[e+4>>2]- +g[e+20>>2])*.5)*2.0;j=(j+(+g[e+8>>2]- +g[e+24>>2])*.5)*2.0;g[d>>2]=b*.0833333283662796*(f*f+j*j);g[d+4>>2]=b*.0833333283662796*(h*h+j*j);g[d+8>>2]=b*.0833333283662796*(h*h+f*f);g[d+12>>2]=0.0;i=e;return}function EA(b){b=b|0;var d=0,e=0,f=0,h=0.0;d=i;i=i+96|0;a[b+88>>0]=1;if((a[15960]|0)==0?(Ya(15960)|0)!=0:0){g[3966]=1.0;c[3967]=0;c[3968]=0;c[3969]=0;c[3970]=0;g[3971]=1.0;c[3972]=0;c[3973]=0;c[3974]=0;c[3975]=0;g[3976]=1.0;g[3977]=0.0;g[3978]=-1.0;c[3979]=0;c[3980]=0;c[3981]=0;c[3982]=0;g[3983]=-1.0;c[3984]=0;c[3985]=0;c[3986]=0;c[3987]=0;g[3988]=-1.0;g[3989]=0.0;bb(15960)}f=d+0|0;e=f+96|0;do{c[f>>2]=0;f=f+4|0}while((f|0)<(e|0));vc[c[(c[b>>2]|0)+76>>2]&127](b,15864,d,6);h=+g[b+44>>2];g[b+72>>2]=+g[d>>2]+h;g[b+56>>2]=+g[d+48>>2]-h;g[b+76>>2]=+g[d+20>>2]+h;g[b+60>>2]=+g[d+68>>2]-h;g[b+80>>2]=+g[d+40>>2]+h;g[b+64>>2]=+g[d+88>>2]-h;i=d;return}function FA(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0;f=i;q=+$b[c[(c[a>>2]|0)+48>>2]&15](a);w=+g[a+72>>2];v=+g[a+56>>2];t=+g[a+76>>2];s=+g[a+60>>2];p=+g[a+80>>2];o=+g[a+64>>2];G=+g[b>>2];A=+P(+G);F=+g[b+4>>2];z=+P(+F);m=+g[b+8>>2];n=+P(+m);E=+g[b+16>>2];y=+P(+E);D=+g[b+20>>2];x=+P(+D);k=+g[b+24>>2];l=+P(+k);C=+g[b+32>>2];u=+P(+C);B=+g[b+36>>2];r=+P(+B);h=+g[b+40>>2];j=+P(+h);m=(w+v)*.5*G+(t+s)*.5*F+(p+o)*.5*m+ +g[b+48>>2];k=(w+v)*.5*E+(t+s)*.5*D+(p+o)*.5*k+ +g[b+52>>2];h=(w+v)*.5*C+(t+s)*.5*B+(p+o)*.5*h+ +g[b+56>>2];n=(q+(w-v)*.5)*A+(q+(t-s)*.5)*z+(q+(p-o)*.5)*n;l=(q+(w-v)*.5)*y+(q+(t-s)*.5)*x+(q+(p-o)*.5)*l;j=(q+(w-v)*.5)*u+(q+(t-s)*.5)*r+(q+(p-o)*.5)*j;g[d>>2]=m-n;g[d+4>>2]=k-l;g[d+8>>2]=h-j;g[d+12>>2]=0.0;g[e>>2]=n+m;g[e+4>>2]=l+k;g[e+8>>2]=j+h;g[e+12>>2]=0.0;i=f;return}function GA(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;e=i;if((c[b+8>>2]|0)>=(d|0)){i=e;return}if((d|0)!=0?(c[5004]=(c[5004]|0)+1,f=fF((d*36|3)+16|0)|0,(f|0)!=0):0){c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}else f=0;j=c[b+4>>2]|0;if((j|0)>0){h=0;do{g=f+(h*36|0)|0;if(g){n=c[b+12>>2]|0;IA(g,n+(h*36|0)|0);n=n+(h*36|0)+20|0;c[g+20>>2]=c[n+0>>2];c[g+24>>2]=c[n+4>>2];c[g+28>>2]=c[n+8>>2];c[g+32>>2]=c[n+12>>2]}h=h+1|0}while((h|0)!=(j|0));n=c[b+4>>2]|0;if((n|0)>0){m=0;do{l=c[b+12>>2]|0;h=l+(m*36|0)+4|0;j=l+(m*36|0)+12|0;g=c[j>>2]|0;k=l+(m*36|0)+16|0;if(g){if(a[k>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[g+ -4>>2]|0)}c[j>>2]=0}a[k>>0]=1;c[j>>2]=0;c[h>>2]=0;c[l+(m*36|0)+8>>2]=0;m=m+1|0}while((m|0)!=(n|0));g=b+12|0}else g=b+12|0}else g=b+12|0;h=c[g>>2]|0;if(h){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[g>>2]=0}a[b+16>>0]=1;c[g>>2]=f;c[b+8>>2]=d;i=e;return}function HA(b){b=b|0;var d=0,e=0;d=i;e=c[b+52>>2]|0;if(e){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;e=c[b+12>>2]|0;if(!e){a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;e=b+8|0;c[e>>2]=0;i=d;return}if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+12>>2]=0;a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;e=b+8|0;c[e>>2]=0;i=d;return}function IA(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;f=i;a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;e=c[d+4>>2]|0;if((e|0)<=0){c[b+4>>2]=e;i=f;return}c[5004]=(c[5004]|0)+1;g=fF((e<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}j=c[b+4>>2]|0;if((j|0)>0){h=0;do{k=g+(h<<2)|0;if(k)c[k>>2]=c[(c[b+12>>2]|0)+(h<<2)>>2];h=h+1|0}while((h|0)!=(j|0))}h=c[b+12>>2]|0;if(h){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=g;c[b+8>>2]=e;h=0;do{j=g+(h<<2)|0;if(j)c[j>>2]=0;h=h+1|0}while((h|0)!=(e|0));c[b+4>>2]=e;b=0;do{h=g+(b<<2)|0;if(h)c[h>>2]=c[(c[d+12>>2]|0)+(b<<2)>>2];b=b+1|0}while((b|0)!=(e|0));i=f;return}function JA(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0,m=0.0,n=0,o=0,p=0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0;f=i;i=i+32|0;n=c[a+12>>2]|0;h=+g[n+(((e+d|0)/2|0)*24|0)>>2];j=+g[n+(((e+d|0)/2|0)*24|0)+4>>2];k=+g[n+(((e+d|0)/2|0)*24|0)+8>>2];m=+g[n+(((e+d|0)/2|0)*24|0)+16>>2];l=c[n+(((e+d|0)/2|0)*24|0)+20>>2]|0;o=d;p=e;while(1){a:while(1){q=+g[n+(o*24|0)+16>>2];do if(q!=m){if(!(q<m))break a}else{s=+g[b>>2];v=+g[n+(o*24|0)>>2]-s;r=+g[b+4>>2];u=+g[n+(o*24|0)+4>>2]-r;q=+g[b+8>>2];t=+g[n+(o*24|0)+8>>2]-q;if(v*v+u*u+t*t!=(h-s)*(h-s)+(j-r)*(j-r)+(k-q)*(k-q))if(v*v+u*u+t*t<(h-s)*(h-s)+(j-r)*(j-r)+(k-q)*(k-q))break;else break a;else if((c[n+(o*24|0)+20>>2]|0)<(l|0))break;else break a}while(0);o=o+1|0}b:while(1){q=+g[n+(p*24|0)+16>>2];do if(m!=q){if(!(m<q))break b}else{r=+g[b>>2];t=+g[b+4>>2];q=+g[b+8>>2];s=+g[n+(p*24|0)>>2]-r;u=+g[n+(p*24|0)+4>>2]-t;v=+g[n+(p*24|0)+8>>2]-q;if((h-r)*(h-r)+(j-t)*(j-t)+(k-q)*(k-q)!=s*s+u*u+v*v)if((h-r)*(h-r)+(j-t)*(j-t)+(k-q)*(k-q)<s*s+u*u+v*v)break;else break b;else if((l|0)<(c[n+(p*24|0)+20>>2]|0))break;else break b}while(0);p=p+ -1|0}if((o|0)<=(p|0)){w=n+(o*24|0)|0;c[f+0>>2]=c[w+0>>2];c[f+4>>2]=c[w+4>>2];c[f+8>>2]=c[w+8>>2];c[f+12>>2]=c[w+12>>2];c[f+16>>2]=c[w+16>>2];c[f+20>>2]=c[w+20>>2];n=n+(p*24|0)|0;c[w+0>>2]=c[n+0>>2];c[w+4>>2]=c[n+4>>2];c[w+8>>2]=c[n+8>>2];c[w+12>>2]=c[n+12>>2];c[w+16>>2]=c[n+16>>2];c[w+20>>2]=c[n+20>>2];n=(c[a+12>>2]|0)+(p*24|0)|0;c[n+0>>2]=c[f+0>>2];c[n+4>>2]=c[f+4>>2];c[n+8>>2]=c[f+8>>2];c[n+12>>2]=c[f+12>>2];c[n+16>>2]=c[f+16>>2];c[n+20>>2]=c[f+20>>2];o=o+1|0;p=p+ -1|0}if((o|0)>(p|0))break;n=c[a+12>>2]|0}if((p|0)>(d|0))JA(a,b,d,p);if((o|0)>=(e|0)){i=f;return}JA(a,b,o,e);i=f;return}function KA(d,f,h){d=d|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0.0,t=0.0,u=0.0,v=0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0,F=0.0,G=0,H=0,I=0,J=0,K=0,L=0,M=0.0,N=0.0,O=0.0;j=i;i=i+128|0;m=c[d+56>>2]|0;if((h-f|0)==1){if(!(a[d+60>>0]|0)){E=(c[d+96>>2]|0)+(m<<6)+0|0;v=(c[d+76>>2]|0)+(f<<6)+0|0;r=E+64|0;do{c[E>>2]=c[v>>2];E=E+4|0;v=v+4|0}while((E|0)<(r|0))}else{L=(c[d+136>>2]|0)+(m<<4)|0;K=(c[d+116>>2]|0)+(f<<4)|0;c[L+0>>2]=c[K+0>>2];c[L+4>>2]=c[K+4>>2];c[L+8>>2]=c[K+8>>2];c[L+12>>2]=c[K+12>>2]}c[d+56>>2]=(c[d+56>>2]|0)+1;i=j;return}if((f|0)<(h|0)){o=(a[d+60>>0]|0)==0;t=0.0;u=0.0;A=0.0;p=f;do{if(o){L=c[d+76>>2]|0;y=+g[L+(p<<6)>>2];z=+g[L+(p<<6)+16>>2];w=+g[L+(p<<6)+4>>2];x=+g[L+(p<<6)+20>>2];B=+g[L+(p<<6)+8>>2];s=+g[L+(p<<6)+24>>2]}else{L=c[d+116>>2]|0;w=+g[d+36>>2];B=+g[d+40>>2];F=+g[d+44>>2];z=+g[d+4>>2];x=+g[d+8>>2];s=+g[d+12>>2];y=+(e[L+(p<<4)>>1]|0)/w+z;z=+(e[L+(p<<4)+6>>1]|0)/w+z;w=+(e[L+(p<<4)+2>>1]|0)/B+x;x=+(e[L+(p<<4)+8>>1]|0)/B+x;B=+(e[L+(p<<4)+4>>1]|0)/F+s;s=+(e[L+(p<<4)+10>>1]|0)/F+s}A=A+(z+y)*.5;t=t+(x+w)*.5;u=u+(s+B)*.5;p=p+1|0}while((p|0)!=(h|0));F=1.0/+(h-f|0);s=A*F;t=t*F;u=u*F;if(o){o=c[d+76>>2]|0;w=0.0;z=0.0;F=0.0;p=f;do{B=(+g[o+(p<<6)+16>>2]+ +g[o+(p<<6)>>2])*.5-s;C=(+g[o+(p<<6)+20>>2]+ +g[o+(p<<6)+4>>2])*.5-t;D=(+g[o+(p<<6)+24>>2]+ +g[o+(p<<6)+8>>2])*.5-u;w=w+B*B;z=z+C*C;F=F+D*D;p=p+1|0}while((p|0)!=(h|0));s=+(h-f|0)}else{p=c[d+116>>2]|0;y=+g[d+36>>2];B=+g[d+40>>2];D=+g[d+44>>2];A=+g[d+4>>2];C=+g[d+8>>2];x=+g[d+12>>2];w=0.0;z=0.0;F=0.0;o=f;do{O=(+(e[p+(o<<4)+6>>1]|0)/y+A+(+(e[p+(o<<4)>>1]|0)/y+A))*.5-s;N=(+(e[p+(o<<4)+8>>1]|0)/B+C+(+(e[p+(o<<4)+2>>1]|0)/B+C))*.5-t;M=(+(e[p+(o<<4)+10>>1]|0)/D+x+(+(e[p+(o<<4)+4>>1]|0)/D+x))*.5-u;w=w+O*O;z=z+N*N;F=F+M*M;o=o+1|0}while((o|0)!=(h|0));s=+(h-f|0)}}else{F=0.0;z=0.0;w=0.0;s=+(h-f|0)}u=1.0/(s+-1.0);s=w*u;t=z*u;u=F*u;if(s<t)o=t<u?2:1;else o=s<u?2:0;c[j+16>>2]=0;c[j+20>>2]=0;c[j+24>>2]=0;c[j+28>>2]=0;if((f|0)<(h|0)){q=(a[d+60>>0]|0)==0;u=0.0;t=0.0;s=0.0;p=f;do{if(q){L=c[d+76>>2]|0;z=+g[L+(p<<6)>>2];y=+g[L+(p<<6)+16>>2];w=+g[L+(p<<6)+4>>2];A=+g[L+(p<<6)+20>>2];x=+g[L+(p<<6)+8>>2];B=+g[L+(p<<6)+24>>2]}else{L=c[d+116>>2]|0;w=+g[d+36>>2];x=+g[d+40>>2];O=+g[d+44>>2];y=+g[d+4>>2];A=+g[d+8>>2];B=+g[d+12>>2];z=+(e[L+(p<<4)>>1]|0)/w+y;y=+(e[L+(p<<4)+6>>1]|0)/w+y;w=+(e[L+(p<<4)+2>>1]|0)/x+A;A=+(e[L+(p<<4)+8>>1]|0)/x+A;x=+(e[L+(p<<4)+4>>1]|0)/O+B;B=+(e[L+(p<<4)+10>>1]|0)/O+B}u=u+(y+z)*.5;t=(A+w)*.5+t;s=(B+x)*.5+s;p=p+1|0}while((p|0)!=(h|0));g[j+16>>2]=u;g[j+20>>2]=t;g[j+24>>2]=s}else{u=0.0;t=0.0;s=0.0}g[j+16>>2]=1.0/+(h-f|0)*u;g[j+20>>2]=1.0/+(h-f|0)*t;g[j+24>>2]=1.0/+(h-f|0)*s;s=+g[j+16+(o<<2)>>2];if((f|0)<(h|0)){o=j+(o<<2)|0;q=f;p=f;do{r=(a[d+60>>0]|0)==0;if(r){L=c[d+76>>2]|0;x=+g[L+(q<<6)>>2];y=+g[L+(q<<6)+16>>2];u=+g[L+(q<<6)+4>>2];w=+g[L+(q<<6)+20>>2];t=+g[L+(q<<6)+8>>2];z=+g[L+(q<<6)+24>>2]}else{L=c[d+116>>2]|0;u=+g[d+36>>2];t=+g[d+40>>2];O=+g[d+44>>2];y=+g[d+4>>2];w=+g[d+8>>2];z=+g[d+12>>2];x=+(e[L+(q<<4)>>1]|0)/u+y;y=+(e[L+(q<<4)+6>>1]|0)/u+y;u=+(e[L+(q<<4)+2>>1]|0)/t+w;w=+(e[L+(q<<4)+8>>1]|0)/t+w;t=+(e[L+(q<<4)+4>>1]|0)/O+z;z=+(e[L+(q<<4)+10>>1]|0)/O+z}g[j>>2]=(y+x)*.5;g[j+4>>2]=(w+u)*.5;g[j+8>>2]=(z+t)*.5;g[j+12>>2]=0.0;if(+g[o>>2]>s){if(r){G=c[d+76>>2]|0;H=G+(q<<6)|0;E=j+32|0;v=H+0|0;r=E+64|0;do{c[E>>2]=c[v>>2];E=E+4|0;v=v+4|0}while((E|0)<(r|0));E=H+0|0;v=G+(p<<6)+0|0;r=E+64|0;do{c[E>>2]=c[v>>2];E=E+4|0;v=v+4|0}while((E|0)<(r|0));E=(c[d+76>>2]|0)+(p<<6)+0|0;v=j+32|0;r=E+64|0;do{c[E>>2]=c[v>>2];E=E+4|0;v=v+4|0}while((E|0)<(r|0))}else{K=c[d+116>>2]|0;L=K+(q<<4)|0;c[j+96>>2]=c[L+0>>2];c[j+100>>2]=c[L+4>>2];c[j+104>>2]=c[L+8>>2];c[j+108>>2]=c[L+12>>2];K=K+(p<<4)|0;c[L+0>>2]=c[K+0>>2];c[L+4>>2]=c[K+4>>2];c[L+8>>2]=c[K+8>>2];c[L+12>>2]=c[K+12>>2];L=(c[d+116>>2]|0)+(p<<4)|0;c[L+0>>2]=c[j+96>>2];c[L+4>>2]=c[j+100>>2];c[L+8>>2]=c[j+104>>2];c[L+12>>2]=c[j+108>>2]}p=p+1|0}q=q+1|0}while((q|0)!=(h|0))}else p=f;if(!((p|0)>(((h-f|0)/3|0)+f|0)?(p|0)<(h+ -1-((h-f|0)/3|0)|0):0))p=(h-f>>1)+f|0;o=c[d+56>>2]|0;do if(!(a[d+60>>0]|0)){q=(c[d+96>>2]|0)+(o<<6)|0;c[q+0>>2]=c[d+20>>2];c[q+4>>2]=c[d+24>>2];c[q+8>>2]=c[d+28>>2];c[q+12>>2]=c[d+32>>2];q=c[d+56>>2]|0;if(!(a[d+60>>0]|0)){q=(c[d+96>>2]|0)+(q<<6)+16|0;c[q+0>>2]=c[d+4>>2];c[q+4>>2]=c[d+8>>2];c[q+8>>2]=c[d+12>>2];c[q+12>>2]=c[d+16>>2];q=c[d+56>>2]|0;break}else{r=c[d+136>>2]|0;v=d+4|0;x=+g[d+8>>2];t=+g[d+12>>2];w=+g[d+36>>2];s=+g[d+40>>2];u=+g[d+44>>2];n=46;break}}else{r=c[d+136>>2]|0;x=+g[d+8>>2];t=+g[d+12>>2];w=+g[d+36>>2];s=+g[d+40>>2];N=(+g[d+24>>2]-x)*s;u=+g[d+44>>2];O=(+g[d+28>>2]-t)*u;b[r+(o<<4)>>1]=~~((+g[d+20>>2]- +g[d+4>>2])*w)&65534;b[r+(o<<4)+2>>1]=~~N&65534;b[r+(o<<4)+4>>1]=~~O&65534;q=o;v=d+4|0;n=46}while(0);if((n|0)==46){O=+g[v>>2];b[r+(q<<4)+6>>1]=~~((O-O)*w+1.0)&65535|1;b[r+(q<<4)+8>>1]=~~((x-x)*s+1.0)&65535|1;b[r+(q<<4)+10>>1]=~~((t-t)*u+1.0)&65535|1}if((f|0)<(h|0)){n=a[d+60>>0]|0;r=f;do{if(!(n<<24>>24)){v=c[d+76>>2]|0;A=+g[v+(r<<6)>>2];z=+g[v+(r<<6)+4>>2];y=+g[v+(r<<6)+8>>2];x=+g[v+(r<<6)+12>>2];w=+g[v+(r<<6)+16>>2];u=+g[v+(r<<6)+20>>2];t=+g[v+(r<<6)+24>>2];s=+g[v+(r<<6)+28>>2];v=c[d+96>>2]|0;E=v+(q<<6)|0;if(A<+g[E>>2])g[E>>2]=A;E=v+(q<<6)+4|0;if(z<+g[E>>2])g[E>>2]=z;E=v+(q<<6)+8|0;if(y<+g[E>>2])g[E>>2]=y;E=v+(q<<6)+12|0;if(x<+g[E>>2])g[E>>2]=x;E=v+(q<<6)+16|0;if(+g[E>>2]<w)g[E>>2]=w;E=v+(q<<6)+20|0;if(+g[E>>2]<u)g[E>>2]=u;E=v+(q<<6)+24|0;if(+g[E>>2]<t)g[E>>2]=t;v=v+(q<<6)+28|0;if(+g[v>>2]<s)g[v>>2]=s}else{v=c[d+116>>2]|0;w=+g[d+36>>2];A=+g[d+40>>2];F=+g[d+44>>2];x=+g[d+4>>2];B=+g[d+8>>2];M=+g[d+12>>2];y=+g[d+4>>2];C=+g[d+8>>2];N=+g[d+12>>2];z=+g[d+36>>2];D=+g[d+40>>2];O=+g[d+44>>2];K=~~((+(e[v+(r<<4)>>1]|0)/w+x-y)*z)&65534;I=~~((+(e[v+(r<<4)+2>>1]|0)/A+B-C)*D)&65534;G=~~((+(e[v+(r<<4)+4>>1]|0)/F+M-N)*O)&65534;J=(~~((+(e[v+(r<<4)+6>>1]|0)/w+x-y)*z+1.0)&65535|1)&65535;H=(~~((+(e[v+(r<<4)+8>>1]|0)/A+B-C)*D+1.0)&65535|1)&65535;v=(~~((+(e[v+(r<<4)+10>>1]|0)/F+M-N)*O+1.0)&65535|1)&65535;E=c[d+136>>2]|0;L=E+(q<<4)|0;if((e[L>>1]|0)>(K&65535))b[L>>1]=K;K=E+(q<<4)+6|0;if((e[K>>1]|0)<(J&65535))b[K>>1]=J;J=E+(q<<4)+2|0;if((e[J>>1]|0)>(I&65535))b[J>>1]=I;I=E+(q<<4)+8|0;if((e[I>>1]|0)<(H&65535))b[I>>1]=H;H=E+(q<<4)+4|0;if((e[H>>1]|0)>(G&65535))b[H>>1]=G;E=E+(q<<4)+10|0;if((e[E>>1]|0)<(v&65535))b[E>>1]=v}r=r+1|0}while((r|0)!=(h|0))}q=q+1|0;c[d+56>>2]=q;KA(d,f,p);f=c[d+56>>2]|0;KA(d,p,h);h=(c[d+56>>2]|0)-m|0;do if(a[d+60>>0]|0){if((h<<4|0)>2048){m=c[d+136>>2]|0;p=c[m+(q<<4)+12>>2]|0;p=(p|0)>-1?1:0-p|0;n=c[m+(f<<4)+12>>2]|0;n=(n|0)>-1?1:0-n|0;if((p<<4|0)<2049){r=c[d+152>>2]|0;if((r|0)==(c[d+156>>2]|0)?(l=(r|0)==0?1:r<<1,(r|0)<(l|0)):0){if(!l){v=0;G=r}else{c[5004]=(c[5004]|0)+1;v=fF(l<<5|19)|0;if(!v)v=0;else{c[(v+19&-16)+ -4>>2]=v;v=v+19&-16}G=c[d+152>>2]|0}if((G|0)>0){E=0;do{L=v+(E<<5)|0;K=(c[d+160>>2]|0)+(E<<5)|0;c[L+0>>2]=c[K+0>>2];c[L+4>>2]=c[K+4>>2];c[L+8>>2]=c[K+8>>2];c[L+12>>2]=c[K+12>>2];c[L+16>>2]=c[K+16>>2];c[L+20>>2]=c[K+20>>2];c[L+24>>2]=c[K+24>>2];c[L+28>>2]=c[K+28>>2];E=E+1|0}while((E|0)!=(G|0))}E=c[d+160>>2]|0;if(E){if(a[d+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[E+ -4>>2]|0)}c[d+160>>2]=0}a[d+164>>0]=1;c[d+160>>2]=v;c[d+156>>2]=l;l=c[d+152>>2]|0}else l=r;c[d+152>>2]=l+1;l=(c[d+160>>2]|0)+(r<<5)|0;c[l+0>>2]=c[j+96>>2];c[l+4>>2]=c[j+100>>2];c[l+8>>2]=c[j+104>>2];c[l+12>>2]=c[j+108>>2];c[l+16>>2]=c[j+112>>2];c[l+20>>2]=c[j+116>>2];c[l+24>>2]=c[j+120>>2];c[l+28>>2]=c[j+124>>2];l=c[d+160>>2]|0;b[l+(r<<5)>>1]=b[m+(q<<4)>>1]|0;b[l+(r<<5)+2>>1]=b[m+(q<<4)+2>>1]|0;b[l+(r<<5)+4>>1]=b[m+(q<<4)+4>>1]|0;b[l+(r<<5)+6>>1]=b[m+(q<<4)+6>>1]|0;b[l+(r<<5)+8>>1]=b[m+(q<<4)+8>>1]|0;b[l+(r<<5)+10>>1]=b[m+(q<<4)+10>>1]|0;c[l+(r<<5)+12>>2]=q;c[l+(r<<5)+16>>2]=p;l=d+152|0}else l=d+152|0;if((n<<4|0)<2049){p=c[l>>2]|0;if((p|0)==(c[d+156>>2]|0)?(k=(p|0)==0?1:p<<1,(p|0)<(k|0)):0){if(!k){q=0;v=p}else{c[5004]=(c[5004]|0)+1;q=fF(k<<5|19)|0;if(!q)q=0;else{c[(q+19&-16)+ -4>>2]=q;q=q+19&-16}v=c[l>>2]|0}if((v|0)>0){r=0;do{L=q+(r<<5)|0;K=(c[d+160>>2]|0)+(r<<5)|0;c[L+0>>2]=c[K+0>>2];c[L+4>>2]=c[K+4>>2];c[L+8>>2]=c[K+8>>2];c[L+12>>2]=c[K+12>>2];c[L+16>>2]=c[K+16>>2];c[L+20>>2]=c[K+20>>2];c[L+24>>2]=c[K+24>>2];c[L+28>>2]=c[K+28>>2];r=r+1|0}while((r|0)!=(v|0))}r=c[d+160>>2]|0;if(r){if(a[d+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[r+ -4>>2]|0)}c[d+160>>2]=0}a[d+164>>0]=1;c[d+160>>2]=q;c[d+156>>2]=k;k=c[l>>2]|0}else k=p;c[l>>2]=k+1;L=(c[d+160>>2]|0)+(p<<5)|0;c[L+0>>2]=c[j+32>>2];c[L+4>>2]=c[j+36>>2];c[L+8>>2]=c[j+40>>2];c[L+12>>2]=c[j+44>>2];c[L+16>>2]=c[j+48>>2];c[L+20>>2]=c[j+52>>2];c[L+24>>2]=c[j+56>>2];c[L+28>>2]=c[j+60>>2];L=c[d+160>>2]|0;b[L+(p<<5)>>1]=b[m+(f<<4)>>1]|0;b[L+(p<<5)+2>>1]=b[m+(f<<4)+2>>1]|0;b[L+(p<<5)+4>>1]=b[m+(f<<4)+4>>1]|0;b[L+(p<<5)+6>>1]=b[m+(f<<4)+6>>1]|0;b[L+(p<<5)+8>>1]=b[m+(f<<4)+8>>1]|0;b[L+(p<<5)+10>>1]=b[m+(f<<4)+10>>1]|0;c[L+(p<<5)+12>>2]=f;c[L+(p<<5)+16>>2]=n}c[d+168>>2]=c[l>>2];if(!(a[d+60>>0]|0))break;else d=d+136|0}else d=d+136|0;c[(c[d>>2]|0)+(o<<4)+12>>2]=0-h;i=j;return}while(0);c[(c[d+96>>2]|0)+(o<<6)+32>>2]=h;i=j;return}function LA(a){a=a|0;var b=0;b=i;MA(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function MA(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=16080;e=c[b+160>>2]|0;if(e){if(a[b+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+160>>2]=0}a[b+164>>0]=1;c[b+160>>2]=0;c[b+152>>2]=0;c[b+156>>2]=0;e=c[b+136>>2]|0;if(e){if(a[b+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+136>>2]=0}a[b+140>>0]=1;c[b+136>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;e=c[b+116>>2]|0;if(e){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=0;c[b+108>>2]=0;c[b+112>>2]=0;e=c[b+96>>2]|0;if(e){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=0;c[b+88>>2]=0;c[b+92>>2]=0;e=c[b+76>>2]|0;if(!e){a[b+80>>0]=1;c[b+76>>2]=0;c[b+68>>2]=0;e=b+72|0;c[e>>2]=0;i=d;return}if(a[b+80>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+76>>2]=0;a[b+80>>0]=1;c[b+76>>2]=0;c[b+68>>2]=0;e=b+72|0;c[e>>2]=0;i=d;return}function NA(a,b,d,f){a=a|0;b=b|0;d=d|0;f=f|0;var g=0,h=0,j=0;g=i;while(1){j=c[a+12>>2]|0;if(!(((e[f>>1]|0)>=(e[a>>1]|0)?(e[d>>1]|0)<=(e[a+6>>1]|0):0)&(e[d+4>>1]|0)<=(e[a+10>>1]|0)&(e[f+4>>1]|0)>=(e[a+4>>1]|0)&(e[d+2>>1]|0)<=(e[a+8>>1]|0)&(e[f+2>>1]|0)>=(e[a+2>>1]|0))){h=8;break}if((j|0)>-1)break;NA(a+16|0,b,d,f);j=c[a+28>>2]|0;if((j|0)>-1){a=a+32|0;continue}else{a=a+(1-j<<4)|0;continue}}if((h|0)==8){i=g;return}rc[c[(c[b>>2]|0)+8>>2]&127](b,j>>21,j&2097151);i=g;return}function OA(a,b,d,e,f,h,j,k){a=a|0;b=b|0;d=d|0;e=+e;f=+f;h=+h;j=j|0;k=k|0;var l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0,L=0,M=0,N=0,O=0.0,P=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0,W=0,X=0,Y=0;l=i;i=i+32|0;o=+g[d>>2];p=+g[d+4>>2];I=+g[d+8>>2];U=+g[j>>2];u=(o>e?e:o)+U;O=+g[j+4>>2];q=(p>f?f:p)+O;P=+g[j+8>>2];s=(I>h?h:I)+P;R=+g[k>>2];v=(o<e?e:o)+R;S=+g[k+4>>2];r=(p<f?f:p)+S;T=+g[k+8>>2];t=(I<h?h:I)+T;n=1.0/+Q(+((e-o)*(e-o)+(f-p)*(f-p)+(h-I)*(h-I)));if((e-o)*n==0.0)B=999999984306749400.0;else B=1.0/((e-o)*n);if((f-p)*n==0.0)A=999999984306749400.0;else A=1.0/((f-p)*n);if((h-I)*n==0.0)z=999999984306749400.0;else z=1.0/((h-I)*n);x=B<0.0&1;w=A<0.0&1;y=z<0.0&1;K=c[a+56>>2]|0;a:do if((K|0)>0){N=0;M=c[a+96>>2]|0;L=1;while(1){c[l+0>>2]=c[M+0>>2];c[l+4>>2]=c[M+4>>2];c[l+8>>2]=c[M+8>>2];c[l+12>>2]=c[M+12>>2];Y=M+16|0;c[l+16>>2]=c[Y+0>>2];c[l+20>>2]=c[Y+4>>2];c[l+24>>2]=c[Y+8>>2];c[l+28>>2]=c[Y+12>>2];g[l>>2]=+g[l>>2]-R;g[l+4>>2]=+g[l+4>>2]-S;g[l+8>>2]=+g[l+8>>2]-T;g[l+16>>2]=+g[l+16>>2]-U;g[l+20>>2]=+g[l+20>>2]-O;g[l+24>>2]=+g[l+24>>2]-P;if(!(u>+g[Y>>2])?!(v<+g[M>>2]):0)V=1;else V=0;if(!(!(s>+g[M+24>>2])?!(t<+g[M+8>>2]):0))V=0;if((((!(q>+g[M+20>>2])?!(r<+g[M+4>>2]|V^1):0)?(J=+g[d>>2],H=B*(+g[l+(x<<4)>>2]-J),J=B*(+g[l+((x^1)<<4)>>2]-J),m=+g[d+4>>2],G=A*(+g[l+(w<<4)+4>>2]-m),m=A*(+g[l+((w^1)<<4)+4>>2]-m),!(H>m|G>J)):0)?(F=G>H?G:H,D=m<J?m:J,C=+g[d+8>>2],E=z*(+g[l+(y<<4)+8>>2]-C),C=z*(+g[l+((y^1)<<4)+8>>2]-C),!(F>C|E>D)):0)?(E>F?E:F)<(h-I)*(h-I)*n+((e-o)*(e-o)*n+(f-p)*(f-p)*n):0){Y=(C<D?C:D)>0.0;W=c[M+32>>2]|0;if((W|0)==-1&Y){rc[c[(c[b>>2]|0)+8>>2]&127](b,c[M+36>>2]|0,c[M+40>>2]|0);K=c[a+56>>2]|0;V=24}else{X=(W|0)==-1;V=23}}else{W=c[M+32>>2]|0;X=(W|0)==-1;Y=0;V=23}if((V|0)==23){V=0;if(Y|X)V=24;else{N=W+N|0;M=M+(W<<6)|0}}if((V|0)==24){N=N+1|0;M=M+64|0}if((N|0)>=(K|0))break a;O=+g[j+4>>2];P=+g[j+8>>2];R=+g[k>>2];S=+g[k+4>>2];T=+g[k+8>>2];U=+g[j>>2];L=L+1|0}}else L=0;while(0);if((c[4028]|0)>=(L|0)){i=l;return}c[4028]=L;i=l;return}function PA(a,d,f,h,j,k,l,m,n){a=a|0;d=d|0;f=f|0;h=+h;j=+j;k=+k;l=l|0;m=m|0;n=n|0;var o=0,p=0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0,F=0.0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0.0,ca=0.0,da=0.0,ea=0.0,fa=0.0,ga=0.0,ha=0.0,ia=0.0,ja=0.0,ka=0.0,la=0.0;o=i;i=i+32|0;r=+g[f>>2];s=+g[f+4>>2];F=+g[f+8>>2];q=1.0/+Q(+((h-r)*(h-r)+(j-s)*(j-s)+(k-F)*(k-F)));if((h-r)*q==0.0)B=999999984306749400.0;else B=1.0/((h-r)*q);if((j-s)*q==0.0)C=999999984306749400.0;else C=1.0/((j-s)*q);if((k-F)*q==0.0)D=999999984306749400.0;else D=1.0/((k-F)*q);p=B<0.0&1;G=C<0.0&1;E=D<0.0&1;la=(r>h?h:r)+ +g[l>>2];ka=(s>j?j:s)+ +g[l+4>>2];ja=(F>k?k:F)+ +g[l+8>>2];ha=(r<h?h:r)+ +g[m>>2];da=(s<j?j:s)+ +g[m+4>>2];$=(F<k?k:F)+ +g[m+8>>2];ga=+g[a+4>>2];la=la<ga?ga:la;ca=+g[a+8>>2];ka=ka<ca?ca:ka;_=+g[a+12>>2];ja=ja<_?_:ja;ia=+g[a+20>>2];ea=+g[a+24>>2];aa=+g[a+28>>2];fa=+g[a+36>>2];ba=+g[a+40>>2];Z=+g[a+44>>2];I=~~(((ia<la?ia:la)-ga)*fa)&65534;L=~~(((ea<ka?ea:ka)-ca)*ba)&65534;J=~~(((aa<ja?aa:ja)-_)*Z)&65534;ha=ha<ga?ga:ha;da=da<ca?ca:da;$=$<_?_:$;H=(~~(((ia<ha?ia:ha)-ga)*fa+1.0)&65535|1)&65535;M=(~~(((ea<da?ea:da)-ca)*ba+1.0)&65535|1)&65535;K=(~~(((aa<$?aa:$)-_)*Z+1.0)&65535|1)&65535;if((n|0)>0){N=0;P=c[a+136>>2]|0;O=0;do{O=O+1|0;T=P+6|0;X=b[P>>1]|0;Y=P+10|0;V=b[P+4>>1]|0;U=P+8|0;W=b[P+2>>1]|0;R=P+12|0;S=(c[R>>2]|0)>-1;if(((((H&65535)>=(X&65535)?(I&65535)<=(e[T>>1]|0):0)&(J&65535)<=(e[Y>>1]|0)&(K&65535)>=(V&65535)&(L&65535)<=(e[U>>1]|0)&(M&65535)>=(W&65535)?(ha=+g[a+36>>2],ja=+g[a+40>>2],la=+g[a+44>>2],ia=+g[a+4>>2],ka=+g[a+8>>2],x=+g[a+12>>2],g[o+12>>2]=0.0,z=+(e[T>>1]|0)/ha+ia,y=+(e[U>>1]|0)/ja+ka,A=+(e[Y>>1]|0)/la+x,g[o+28>>2]=0.0,g[o>>2]=+(X&65535)/ha+ia- +g[m>>2],g[o+4>>2]=+(W&65535)/ja+ka- +g[m+4>>2],g[o+8>>2]=+(V&65535)/la+x- +g[m+8>>2],g[o+16>>2]=z- +g[l>>2],g[o+20>>2]=y- +g[l+4>>2],g[o+24>>2]=A- +g[l+8>>2],A=+g[f>>2],y=B*(+g[o+(p<<4)>>2]-A),A=B*(+g[o+((p^1)<<4)>>2]-A),z=+g[f+4>>2],x=C*(+g[o+(G<<4)+4>>2]-z),z=C*(+g[o+((G^1)<<4)+4>>2]-z),!(y>z|x>A)):0)?(w=x>y?x:y,u=z<A?z:A,t=+g[f+8>>2],v=D*(+g[o+(E<<4)+8>>2]-t),t=D*(+g[o+((E^1)<<4)+8>>2]-t),!(w>t|v>u)):0)?(v>w?v:w)<(k-F)*(k-F)*q+((h-r)*(h-r)*q+(j-s)*(j-s)*q):0){U=!((t<u?t:u)>0.0);if(U|S^1)T=15;else{T=c[R>>2]|0;rc[c[(c[d>>2]|0)+8>>2]&127](d,T>>21,T&2097151);T=16}}else{U=1;T=15}if((T|0)==15){T=0;if(S|U^1)T=16;else{Y=c[R>>2]|0;N=N-Y|0;P=P+(0-Y<<4)|0}}if((T|0)==16){N=N+1|0;P=P+16|0}}while((N|0)<(n|0))}else O=0;if((c[4028]|0)>=(O|0)){i=o;return}c[4028]=O;i=o;return}function QA(d,f,h,j){d=d|0;f=f|0;h=h|0;j=j|0;var k=0,l=0,m=0,n=0,o=0,p=0,q=0;h=i;c[d+168>>2]=c[d+152>>2];c[f>>2]=16080;c[f+52>>2]=282;a[f+60>>0]=0;a[f+80>>0]=1;c[f+76>>2]=0;c[f+68>>2]=0;c[f+72>>2]=0;a[f+100>>0]=1;c[f+96>>2]=0;c[f+88>>2]=0;c[f+92>>2]=0;a[f+120>>0]=1;c[f+116>>2]=0;c[f+108>>2]=0;c[f+112>>2]=0;a[f+140>>0]=1;c[f+136>>2]=0;c[f+128>>2]=0;c[f+132>>2]=0;c[f+144>>2]=0;a[f+164>>0]=1;c[f+160>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+168>>2]=0;g[f+4>>2]=-3.4028234663852886e+38;g[f+8>>2]=-3.4028234663852886e+38;g[f+12>>2]=-3.4028234663852886e+38;g[f+16>>2]=0.0;g[f+20>>2]=3.4028234663852886e+38;g[f+24>>2]=3.4028234663852886e+38;g[f+28>>2]=3.4028234663852886e+38;g[f+32>>2]=0.0;k=c[d+56>>2]|0;if(j){c[f+56>>2]=oF(k|0)|0;a[f+4>>0]=a[d+7>>0]|0;a[f+5>>0]=a[d+6>>0]|0;a[f+6>>0]=a[d+5>>0]|0;a[f+7>>0]=a[d+4>>0]|0;a[f+8>>0]=a[d+11>>0]|0;a[f+9>>0]=a[d+10>>0]|0;a[f+10>>0]=a[d+9>>0]|0;a[f+11>>0]=a[d+8>>0]|0;a[f+12>>0]=a[d+15>>0]|0;a[f+13>>0]=a[d+14>>0]|0;a[f+14>>0]=a[d+13>>0]|0;a[f+15>>0]=a[d+12>>0]|0;a[f+16>>0]=a[d+19>>0]|0;a[f+17>>0]=a[d+18>>0]|0;a[f+18>>0]=a[d+17>>0]|0;a[f+19>>0]=a[d+16>>0]|0;a[f+20>>0]=a[d+23>>0]|0;a[f+21>>0]=a[d+22>>0]|0;a[f+22>>0]=a[d+21>>0]|0;a[f+23>>0]=a[d+20>>0]|0;a[f+24>>0]=a[d+27>>0]|0;a[f+25>>0]=a[d+26>>0]|0;a[f+26>>0]=a[d+25>>0]|0;a[f+27>>0]=a[d+24>>0]|0;a[f+28>>0]=a[d+31>>0]|0;a[f+29>>0]=a[d+30>>0]|0;a[f+30>>0]=a[d+29>>0]|0;a[f+31>>0]=a[d+28>>0]|0;a[f+32>>0]=a[d+35>>0]|0;a[f+33>>0]=a[d+34>>0]|0;a[f+34>>0]=a[d+33>>0]|0;a[f+35>>0]=a[d+32>>0]|0;a[f+36>>0]=a[d+39>>0]|0;a[f+37>>0]=a[d+38>>0]|0;a[f+38>>0]=a[d+37>>0]|0;a[f+39>>0]=a[d+36>>0]|0;a[f+40>>0]=a[d+43>>0]|0;a[f+41>>0]=a[d+42>>0]|0;a[f+42>>0]=a[d+41>>0]|0;a[f+43>>0]=a[d+40>>0]|0;a[f+44>>0]=a[d+47>>0]|0;a[f+45>>0]=a[d+46>>0]|0;a[f+46>>0]=a[d+45>>0]|0;a[f+47>>0]=a[d+44>>0]|0;a[f+48>>0]=a[d+51>>0]|0;a[f+49>>0]=a[d+50>>0]|0;a[f+50>>0]=a[d+49>>0]|0;a[f+51>>0]=a[d+48>>0]|0;c[f+144>>2]=oF(c[d+144>>2]|0)|0;k=oF(c[d+168>>2]|0)|0}else{c[f+56>>2]=k;c[f+4>>2]=c[d+4>>2];c[f+8>>2]=c[d+8>>2];c[f+12>>2]=c[d+12>>2];c[f+16>>2]=c[d+16>>2];c[f+20>>2]=c[d+20>>2];c[f+24>>2]=c[d+24>>2];c[f+28>>2]=c[d+28>>2];c[f+32>>2]=c[d+32>>2];c[f+36>>2]=c[d+36>>2];c[f+40>>2]=c[d+40>>2];c[f+44>>2]=c[d+44>>2];c[f+48>>2]=c[d+48>>2];c[f+144>>2]=c[d+144>>2];k=c[d+168>>2]|0}c[f+168>>2]=k;a[f+60>>0]=a[d+60>>0]|0;k=c[d+56>>2]|0;if(!(a[d+60>>0]|0)){l=c[f+96>>2]|0;if(l){if(a[f+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[f+96>>2]=0}c[f+88>>2]=0;c[f+92>>2]=0;c[f+96>>2]=0;a[f+100>>0]=0;c[f+96>>2]=f+172;c[f+88>>2]=k;c[f+92>>2]=k;if(j)if((k|0)>0){l=c[d+96>>2]|0;n=f+172|0;m=0;do{o=l+(m<<6)|0;q=n+(m<<6)|0;a[q>>0]=a[o+3>>0]|0;a[q+1>>0]=a[o+2>>0]|0;a[q+2>>0]=a[o+1>>0]|0;a[q+3>>0]=a[o>>0]|0;q=l+(m<<6)+4|0;o=n+(m<<6)+4|0;a[o>>0]=a[q+3>>0]|0;a[o+1>>0]=a[q+2>>0]|0;a[o+2>>0]=a[q+1>>0]|0;a[o+3>>0]=a[q>>0]|0;o=l+(m<<6)+8|0;q=n+(m<<6)+8|0;a[q>>0]=a[o+3>>0]|0;a[q+1>>0]=a[o+2>>0]|0;a[q+2>>0]=a[o+1>>0]|0;a[q+3>>0]=a[o>>0]|0;q=l+(m<<6)+12|0;n=n+(m<<6)+12|0;a[n>>0]=a[q+3>>0]|0;a[n+1>>0]=a[q+2>>0]|0;a[n+2>>0]=a[q+1>>0]|0;a[n+3>>0]=a[q>>0]|0;n=c[d+96>>2]|0;q=n+(m<<6)+16|0;o=c[f+96>>2]|0;p=o+(m<<6)+16|0;a[p>>0]=a[q+3>>0]|0;a[p+1>>0]=a[q+2>>0]|0;a[p+2>>0]=a[q+1>>0]|0;a[p+3>>0]=a[q>>0]|0;p=n+(m<<6)+20|0;q=o+(m<<6)+20|0;a[q>>0]=a[p+3>>0]|0;a[q+1>>0]=a[p+2>>0]|0;a[q+2>>0]=a[p+1>>0]|0;a[q+3>>0]=a[p>>0]|0;q=n+(m<<6)+24|0;p=o+(m<<6)+24|0;a[p>>0]=a[q+3>>0]|0;a[p+1>>0]=a[q+2>>0]|0;a[p+2>>0]=a[q+1>>0]|0;a[p+3>>0]=a[q>>0]|0;n=n+(m<<6)+28|0;o=o+(m<<6)+28|0;a[o>>0]=a[n+3>>0]|0;a[o+1>>0]=a[n+2>>0]|0;a[o+2>>0]=a[n+1>>0]|0;a[o+3>>0]=a[n>>0]|0;l=c[d+96>>2]|0;o=oF(c[l+(m<<6)+32>>2]|0)|0;n=c[f+96>>2]|0;c[n+(m<<6)+32>>2]=o;c[n+(m<<6)+36>>2]=oF(c[l+(m<<6)+36>>2]|0)|0;c[n+(m<<6)+40>>2]=oF(c[l+(m<<6)+40>>2]|0)|0;m=m+1|0}while((m|0)!=(k|0))}else n=f+172|0;else if((k|0)>0){n=f+172|0;l=c[d+96>>2]|0;m=0;do{n=n+(m<<6)|0;q=l+(m<<6)|0;c[n+0>>2]=c[q+0>>2];c[n+4>>2]=c[q+4>>2];c[n+8>>2]=c[q+8>>2];c[n+12>>2]=c[q+12>>2];n=(c[f+96>>2]|0)+(m<<6)+16|0;q=(c[d+96>>2]|0)+(m<<6)+16|0;c[n+0>>2]=c[q+0>>2];c[n+4>>2]=c[q+4>>2];c[n+8>>2]=c[q+8>>2];c[n+12>>2]=c[q+12>>2];l=c[d+96>>2]|0;n=c[f+96>>2]|0;c[n+(m<<6)+32>>2]=c[l+(m<<6)+32>>2];c[n+(m<<6)+36>>2]=c[l+(m<<6)+36>>2];c[n+(m<<6)+40>>2]=c[l+(m<<6)+40>>2];m=m+1|0}while((m|0)!=(k|0))}else n=f+172|0;if(n){if(a[f+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[n+ -4>>2]|0)}c[f+96>>2]=0}c[f+88>>2]=0;c[f+92>>2]=0;c[f+96>>2]=0;a[f+100>>0]=0;k=k<<6}else{l=c[f+136>>2]|0;if(l){if(a[f+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[f+136>>2]=0}c[f+128>>2]=0;c[f+132>>2]=0;c[f+136>>2]=0;a[f+140>>0]=0;c[f+136>>2]=f+172;c[f+128>>2]=k;c[f+132>>2]=k;if(j){if((k|0)>0){l=c[d+136>>2]|0;m=0;do{q=e[l+(m<<4)>>1]|0;b[f+172+(m<<4)>>1]=q>>>8|q<<8;q=e[l+(m<<4)+2>>1]|0;b[f+172+(m<<4)+2>>1]=q>>>8|q<<8;q=e[l+(m<<4)+4>>1]|0;b[f+172+(m<<4)+4>>1]=q>>>8|q<<8;q=e[l+(m<<4)+6>>1]|0;b[f+172+(m<<4)+6>>1]=q>>>8|q<<8;q=e[l+(m<<4)+8>>1]|0;b[f+172+(m<<4)+8>>1]=q>>>8|q<<8;q=e[l+(m<<4)+10>>1]|0;b[f+172+(m<<4)+10>>1]=q>>>8|q<<8;c[f+172+(m<<4)+12>>2]=oF(c[l+(m<<4)+12>>2]|0)|0;m=m+1|0}while((m|0)!=(k|0))}}else if((k|0)>0){l=c[d+136>>2]|0;m=0;do{b[f+172+(m<<4)>>1]=b[l+(m<<4)>>1]|0;b[f+172+(m<<4)+2>>1]=b[l+(m<<4)+2>>1]|0;b[f+172+(m<<4)+4>>1]=b[l+(m<<4)+4>>1]|0;b[f+172+(m<<4)+6>>1]=b[l+(m<<4)+6>>1]|0;b[f+172+(m<<4)+8>>1]=b[l+(m<<4)+8>>1]|0;b[f+172+(m<<4)+10>>1]=b[l+(m<<4)+10>>1]|0;c[f+172+(m<<4)+12>>2]=c[l+(m<<4)+12>>2];m=m+1|0}while((m|0)!=(k|0))}c[f+128>>2]=0;c[f+132>>2]=0;c[f+136>>2]=0;a[f+140>>0]=0;k=k<<4}k=f+(k+172)|0;m=c[d+168>>2]|0;l=c[f+160>>2]|0;if(l){if(a[f+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[f+160>>2]=0}c[f+152>>2]=0;c[f+156>>2]=0;c[f+160>>2]=0;a[f+164>>0]=0;c[f+160>>2]=k;c[f+152>>2]=m;c[f+156>>2]=m;l=(c[d+168>>2]|0)>0;if(j){if(!l){c[f>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+160>>2]=0;a[f+164>>0]=0;i=h;return 1}l=c[d+160>>2]|0;j=0;do{q=e[l+(j<<5)>>1]|0;b[k+(j<<5)>>1]=q>>>8|q<<8;q=e[l+(j<<5)+2>>1]|0;b[k+(j<<5)+2>>1]=q>>>8|q<<8;q=e[l+(j<<5)+4>>1]|0;b[k+(j<<5)+4>>1]=q>>>8|q<<8;q=e[l+(j<<5)+6>>1]|0;b[k+(j<<5)+6>>1]=q>>>8|q<<8;q=e[l+(j<<5)+8>>1]|0;b[k+(j<<5)+8>>1]=q>>>8|q<<8;q=e[l+(j<<5)+10>>1]|0;b[k+(j<<5)+10>>1]=q>>>8|q<<8;c[k+(j<<5)+12>>2]=oF(c[l+(j<<5)+12>>2]|0)|0;c[k+(j<<5)+16>>2]=oF(c[l+(j<<5)+16>>2]|0)|0;j=j+1|0}while((j|0)<(c[d+168>>2]|0));c[f>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+160>>2]=0;a[f+164>>0]=0;i=h;return 1}else{if(!l){c[f>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+160>>2]=0;a[f+164>>0]=0;i=h;return 1}j=c[d+160>>2]|0;l=0;do{b[k+(l<<5)>>1]=b[j+(l<<5)>>1]|0;b[k+(l<<5)+2>>1]=b[j+(l<<5)+2>>1]|0;b[k+(l<<5)+4>>1]=b[j+(l<<5)+4>>1]|0;b[k+(l<<5)+6>>1]=b[j+(l<<5)+6>>1]|0;b[k+(l<<5)+8>>1]=b[j+(l<<5)+8>>1]|0;b[k+(l<<5)+10>>1]=b[j+(l<<5)+10>>1]|0;c[k+(l<<5)+12>>2]=c[j+(l<<5)+12>>2];c[k+(l<<5)+16>>2]=c[j+(l<<5)+16>>2];c[k+(l<<5)+20>>2]=0;c[k+(l<<5)+24>>2]=0;c[k+(l<<5)+28>>2]=0;l=l+1|0}while((l|0)<(c[d+168>>2]|0));c[f>>2]=0;c[f+152>>2]=0;c[f+156>>2]=0;c[f+160>>2]=0;a[f+164>>0]=0;i=h;return 1}return 0}function RA(d,e){d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f=i;i=i+112|0;g[d+20>>2]=+g[e+16>>2];g[d+24>>2]=+g[e+20>>2];g[d+28>>2]=+g[e+24>>2];g[d+32>>2]=+g[e+28>>2];g[d+4>>2]=+g[e>>2];g[d+8>>2]=+g[e+4>>2];g[d+12>>2]=+g[e+8>>2];g[d+16>>2]=+g[e+12>>2];g[d+36>>2]=+g[e+32>>2];g[d+40>>2]=+g[e+36>>2];g[d+44>>2]=+g[e+40>>2];g[d+48>>2]=+g[e+44>>2];c[d+56>>2]=c[e+48>>2];a[d+60>>0]=(c[e+52>>2]|0)!=0&1;h=c[e+56>>2]|0;l=f+48|0;m=l+64|0;do{c[l>>2]=0;l=l+4|0}while((l|0)<(m|0));j=c[d+88>>2]|0;if((j|0)<(h|0)){if((c[d+92>>2]|0)<(h|0)){if(!h){n=0;o=j}else{c[5004]=(c[5004]|0)+1;k=fF(h<<6|19)|0;if(!k)n=0;else{c[(k+19&-16)+ -4>>2]=k;n=k+19&-16}o=c[d+88>>2]|0}if((o|0)>0){p=0;do{l=n+(p<<6)+0|0;k=(c[d+96>>2]|0)+(p<<6)+0|0;m=l+64|0;do{c[l>>2]=c[k>>2];l=l+4|0;k=k+4|0}while((l|0)<(m|0));p=p+1|0}while((p|0)!=(o|0))}k=c[d+96>>2]|0;if(k){if(a[d+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[d+96>>2]=0}a[d+100>>0]=1;c[d+96>>2]=n;c[d+92>>2]=h;n=d+96|0}else n=d+96|0;do{l=(c[n>>2]|0)+(j<<6)+0|0;k=f+48|0;m=l+64|0;do{c[l>>2]=c[k>>2];l=l+4|0;k=k+4|0}while((l|0)<(m|0));j=j+1|0}while((j|0)!=(h|0))}c[d+88>>2]=h;if((h|0)>0){l=c[d+96>>2]|0;j=0;k=c[e+64>>2]|0;while(1){g[l+(j<<6)+16>>2]=+g[k+16>>2];g[l+(j<<6)+20>>2]=+g[k+20>>2];g[l+(j<<6)+24>>2]=+g[k+24>>2];g[l+(j<<6)+28>>2]=+g[k+28>>2];g[l+(j<<6)>>2]=+g[k>>2];g[l+(j<<6)+4>>2]=+g[k+4>>2];g[l+(j<<6)+8>>2]=+g[k+8>>2];g[l+(j<<6)+12>>2]=+g[k+12>>2];c[l+(j<<6)+32>>2]=c[k+32>>2];c[l+(j<<6)+36>>2]=c[k+36>>2];c[l+(j<<6)+40>>2]=c[k+40>>2];j=j+1|0;if((j|0)==(h|0))break;else k=k+48|0}}h=c[e+60>>2]|0;c[f+32>>2]=0;c[f+36>>2]=0;c[f+40>>2]=0;c[f+44>>2]=0;j=c[d+128>>2]|0;if((j|0)<(h|0)){if((c[d+132>>2]|0)<(h|0)){if(!h){k=0;l=j}else{c[5004]=(c[5004]|0)+1;k=fF((h<<4|3)+16|0)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}l=c[d+128>>2]|0}if((l|0)>0){m=0;do{p=k+(m<<4)|0;o=(c[d+136>>2]|0)+(m<<4)|0;c[p+0>>2]=c[o+0>>2];c[p+4>>2]=c[o+4>>2];c[p+8>>2]=c[o+8>>2];c[p+12>>2]=c[o+12>>2];m=m+1|0}while((m|0)!=(l|0))}l=c[d+136>>2]|0;if(l){if(a[d+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[d+136>>2]=0}a[d+140>>0]=1;c[d+136>>2]=k;c[d+132>>2]=h;k=d+136|0}else k=d+136|0;do{p=(c[k>>2]|0)+(j<<4)|0;c[p+0>>2]=c[f+32>>2];c[p+4>>2]=c[f+36>>2];c[p+8>>2]=c[f+40>>2];c[p+12>>2]=c[f+44>>2];j=j+1|0}while((j|0)!=(h|0))}c[d+128>>2]=h;if((h|0)>0){k=c[d+136>>2]|0;j=0;l=c[e+68>>2]|0;while(1){c[k+(j<<4)+12>>2]=c[l+12>>2];b[k+(j<<4)+6>>1]=b[l+6>>1]|0;b[k+(j<<4)+8>>1]=b[l+8>>1]|0;b[k+(j<<4)+10>>1]=b[l+10>>1]|0;b[k+(j<<4)>>1]=b[l>>1]|0;b[k+(j<<4)+2>>1]=b[l+2>>1]|0;b[k+(j<<4)+4>>1]=b[l+4>>1]|0;j=j+1|0;if((j|0)==(h|0))break;else l=l+16|0}}c[d+144>>2]=c[e+76>>2];h=c[e+80>>2]|0;j=c[d+152>>2]|0;if((j|0)<(h|0)){if((c[d+156>>2]|0)<(h|0)){if(!h){k=0;l=j}else{c[5004]=(c[5004]|0)+1;k=fF(h<<5|19)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}l=c[d+152>>2]|0}if((l|0)>0){m=0;do{p=k+(m<<5)|0;o=(c[d+160>>2]|0)+(m<<5)|0;c[p+0>>2]=c[o+0>>2];c[p+4>>2]=c[o+4>>2];c[p+8>>2]=c[o+8>>2];c[p+12>>2]=c[o+12>>2];c[p+16>>2]=c[o+16>>2];c[p+20>>2]=c[o+20>>2];c[p+24>>2]=c[o+24>>2];c[p+28>>2]=c[o+28>>2];m=m+1|0}while((m|0)!=(l|0))}l=c[d+160>>2]|0;if(l){if(a[d+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[d+160>>2]=0}a[d+164>>0]=1;c[d+160>>2]=k;c[d+156>>2]=h;k=d+160|0}else k=d+160|0;do{p=(c[k>>2]|0)+(j<<5)|0;c[p+0>>2]=c[f+0>>2];c[p+4>>2]=c[f+4>>2];c[p+8>>2]=c[f+8>>2];c[p+12>>2]=c[f+12>>2];c[p+16>>2]=c[f+16>>2];c[p+20>>2]=c[f+20>>2];c[p+24>>2]=c[f+24>>2];c[p+28>>2]=c[f+28>>2];j=j+1|0}while((j|0)!=(h|0))}c[d+152>>2]=h;if((h|0)<=0){i=f;return}j=c[d+160>>2]|0;d=0;e=c[e+72>>2]|0;while(1){b[j+(d<<5)+6>>1]=b[e+14>>1]|0;b[j+(d<<5)+8>>1]=b[e+16>>1]|0;b[j+(d<<5)+10>>1]=b[e+18>>1]|0;b[j+(d<<5)>>1]=b[e+8>>1]|0;b[j+(d<<5)+2>>1]=b[e+10>>1]|0;b[j+(d<<5)+4>>1]=b[e+12>>1]|0;c[j+(d<<5)+12>>2]=c[e>>2];c[j+(d<<5)+16>>2]=c[e+4>>2];d=d+1|0;if((d|0)==(h|0))break;else e=e+20|0}i=f;return}function SA(d,e){d=d|0;e=e|0;var f=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0;f=i;i=i+112|0;g[d+20>>2]=+h[e+32>>3];g[d+24>>2]=+h[e+40>>3];g[d+28>>2]=+h[e+48>>3];g[d+32>>2]=+h[e+56>>3];g[d+4>>2]=+h[e>>3];g[d+8>>2]=+h[e+8>>3];g[d+12>>2]=+h[e+16>>3];g[d+16>>2]=+h[e+24>>3];g[d+36>>2]=+h[e+64>>3];g[d+40>>2]=+h[e+72>>3];g[d+44>>2]=+h[e+80>>3];g[d+48>>2]=+h[e+88>>3];c[d+56>>2]=c[e+96>>2];a[d+60>>0]=(c[e+100>>2]|0)!=0&1;j=c[e+104>>2]|0;m=f+48|0;n=m+64|0;do{c[m>>2]=0;m=m+4|0}while((m|0)<(n|0));k=c[d+88>>2]|0;if((k|0)<(j|0)){if((c[d+92>>2]|0)<(j|0)){if(!j){o=0;p=k}else{c[5004]=(c[5004]|0)+1;l=fF(j<<6|19)|0;if(!l)o=0;else{c[(l+19&-16)+ -4>>2]=l;o=l+19&-16}p=c[d+88>>2]|0}if((p|0)>0){q=0;do{m=o+(q<<6)+0|0;l=(c[d+96>>2]|0)+(q<<6)+0|0;n=m+64|0;do{c[m>>2]=c[l>>2];m=m+4|0;l=l+4|0}while((m|0)<(n|0));q=q+1|0}while((q|0)!=(p|0))}l=c[d+96>>2]|0;if(l){if(a[d+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[d+96>>2]=0}a[d+100>>0]=1;c[d+96>>2]=o;c[d+92>>2]=j;o=d+96|0}else o=d+96|0;do{m=(c[o>>2]|0)+(k<<6)+0|0;l=f+48|0;n=m+64|0;do{c[m>>2]=c[l>>2];m=m+4|0;l=l+4|0}while((m|0)<(n|0));k=k+1|0}while((k|0)!=(j|0))}c[d+88>>2]=j;if((j|0)>0){m=c[d+96>>2]|0;k=0;l=c[e+112>>2]|0;while(1){g[m+(k<<6)+16>>2]=+h[l+32>>3];g[m+(k<<6)+20>>2]=+h[l+40>>3];g[m+(k<<6)+24>>2]=+h[l+48>>3];g[m+(k<<6)+28>>2]=+h[l+56>>3];g[m+(k<<6)>>2]=+h[l>>3];g[m+(k<<6)+4>>2]=+h[l+8>>3];g[m+(k<<6)+8>>2]=+h[l+16>>3];g[m+(k<<6)+12>>2]=+h[l+24>>3];c[m+(k<<6)+32>>2]=c[l+64>>2];c[m+(k<<6)+36>>2]=c[l+68>>2];c[m+(k<<6)+40>>2]=c[l+72>>2];k=k+1|0;if((k|0)==(j|0))break;else l=l+80|0}}j=c[e+108>>2]|0;c[f+32>>2]=0;c[f+36>>2]=0;c[f+40>>2]=0;c[f+44>>2]=0;k=c[d+128>>2]|0;if((k|0)<(j|0)){if((c[d+132>>2]|0)<(j|0)){if(!j){l=0;m=k}else{c[5004]=(c[5004]|0)+1;l=fF((j<<4|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}m=c[d+128>>2]|0}if((m|0)>0){n=0;do{q=l+(n<<4)|0;p=(c[d+136>>2]|0)+(n<<4)|0;c[q+0>>2]=c[p+0>>2];c[q+4>>2]=c[p+4>>2];c[q+8>>2]=c[p+8>>2];c[q+12>>2]=c[p+12>>2];n=n+1|0}while((n|0)!=(m|0))}m=c[d+136>>2]|0;if(m){if(a[d+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[d+136>>2]=0}a[d+140>>0]=1;c[d+136>>2]=l;c[d+132>>2]=j;l=d+136|0}else l=d+136|0;do{q=(c[l>>2]|0)+(k<<4)|0;c[q+0>>2]=c[f+32>>2];c[q+4>>2]=c[f+36>>2];c[q+8>>2]=c[f+40>>2];c[q+12>>2]=c[f+44>>2];k=k+1|0}while((k|0)!=(j|0))}c[d+128>>2]=j;if((j|0)>0){l=c[d+136>>2]|0;k=0;m=c[e+116>>2]|0;while(1){c[l+(k<<4)+12>>2]=c[m+12>>2];b[l+(k<<4)+6>>1]=b[m+6>>1]|0;b[l+(k<<4)+8>>1]=b[m+8>>1]|0;b[l+(k<<4)+10>>1]=b[m+10>>1]|0;b[l+(k<<4)>>1]=b[m>>1]|0;b[l+(k<<4)+2>>1]=b[m+2>>1]|0;b[l+(k<<4)+4>>1]=b[m+4>>1]|0;k=k+1|0;if((k|0)==(j|0))break;else m=m+16|0}}c[d+144>>2]=c[e+120>>2];j=c[e+124>>2]|0;k=c[d+152>>2]|0;if((k|0)<(j|0)){if((c[d+156>>2]|0)<(j|0)){if(!j){l=0;m=k}else{c[5004]=(c[5004]|0)+1;l=fF(j<<5|19)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}m=c[d+152>>2]|0}if((m|0)>0){n=0;do{q=l+(n<<5)|0;p=(c[d+160>>2]|0)+(n<<5)|0;c[q+0>>2]=c[p+0>>2];c[q+4>>2]=c[p+4>>2];c[q+8>>2]=c[p+8>>2];c[q+12>>2]=c[p+12>>2];c[q+16>>2]=c[p+16>>2];c[q+20>>2]=c[p+20>>2];c[q+24>>2]=c[p+24>>2];c[q+28>>2]=c[p+28>>2];n=n+1|0}while((n|0)!=(m|0))}m=c[d+160>>2]|0;if(m){if(a[d+164>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[d+160>>2]=0}a[d+164>>0]=1;c[d+160>>2]=l;c[d+156>>2]=j;l=d+160|0}else l=d+160|0;do{q=(c[l>>2]|0)+(k<<5)|0;c[q+0>>2]=c[f+0>>2];c[q+4>>2]=c[f+4>>2];c[q+8>>2]=c[f+8>>2];c[q+12>>2]=c[f+12>>2];c[q+16>>2]=c[f+16>>2];c[q+20>>2]=c[f+20>>2];c[q+24>>2]=c[f+24>>2];c[q+28>>2]=c[f+28>>2];k=k+1|0}while((k|0)!=(j|0))}c[d+152>>2]=j;if((j|0)<=0){i=f;return}k=c[d+160>>2]|0;d=0;e=c[e+128>>2]|0;while(1){b[k+(d<<5)+6>>1]=b[e+14>>1]|0;b[k+(d<<5)+8>>1]=b[e+16>>1]|0;b[k+(d<<5)+10>>1]=b[e+18>>1]|0;b[k+(d<<5)>>1]=b[e+8>>1]|0;b[k+(d<<5)+2>>1]=b[e+10>>1]|0;b[k+(d<<5)+4>>1]=b[e+12>>1]|0;c[k+(d<<5)+12>>2]=c[e>>2];c[k+(d<<5)+16>>2]=c[e+4>>2];d=d+1|0;if((d|0)==(j|0))break;else e=e+20|0}i=f;return}function TA(a,e,f){a=a|0;e=e|0;f=f|0;var h=0,j=0,k=0,l=0,m=0,n=0;h=i;g[e+16>>2]=+g[a+20>>2];g[e+20>>2]=+g[a+24>>2];g[e+24>>2]=+g[a+28>>2];g[e+28>>2]=+g[a+32>>2];g[e>>2]=+g[a+4>>2];g[e+4>>2]=+g[a+8>>2];g[e+8>>2]=+g[a+12>>2];g[e+12>>2]=+g[a+16>>2];g[e+32>>2]=+g[a+36>>2];g[e+36>>2]=+g[a+40>>2];g[e+40>>2]=+g[a+44>>2];g[e+44>>2]=+g[a+48>>2];c[e+48>>2]=c[a+56>>2];c[e+52>>2]=d[a+60>>0];c[e+56>>2]=c[a+88>>2];if(c[a+88>>2]|0){n=gc[c[(c[f>>2]|0)+28>>2]&31](f,c[a+96>>2]|0)|0;c[e+64>>2]=n;if(n){n=c[a+88>>2]|0;j=Yb[c[(c[f>>2]|0)+16>>2]&31](f,48,n)|0;if((n|0)>0){k=c[a+96>>2]|0;m=0;l=c[j+8>>2]|0;while(1){g[l+16>>2]=+g[k+(m<<6)+16>>2];g[l+20>>2]=+g[k+(m<<6)+20>>2];g[l+24>>2]=+g[k+(m<<6)+24>>2];g[l+28>>2]=+g[k+(m<<6)+28>>2];g[l>>2]=+g[k+(m<<6)>>2];g[l+4>>2]=+g[k+(m<<6)+4>>2];g[l+8>>2]=+g[k+(m<<6)+8>>2];g[l+12>>2]=+g[k+(m<<6)+12>>2];c[l+32>>2]=c[k+(m<<6)+32>>2];c[l+36>>2]=c[k+(m<<6)+36>>2];c[l+40>>2]=c[k+(m<<6)+40>>2];m=m+1|0;if((m|0)==(n|0))break;else l=l+48|0}}else k=c[a+96>>2]|0;Jb[c[(c[f>>2]|0)+20>>2]&31](f,j,16120,1497453121,k)}}else c[e+64>>2]=0;c[e+60>>2]=c[a+128>>2];if(c[a+128>>2]|0){n=gc[c[(c[f>>2]|0)+28>>2]&31](f,c[a+136>>2]|0)|0;c[e+68>>2]=n;if(n){k=c[a+128>>2]|0;j=Yb[c[(c[f>>2]|0)+16>>2]&31](f,16,k)|0;if((k|0)>0){l=c[a+136>>2]|0;n=0;m=c[j+8>>2]|0;while(1){c[m+12>>2]=c[l+(n<<4)+12>>2];b[m+6>>1]=b[l+(n<<4)+6>>1]|0;b[m+8>>1]=b[l+(n<<4)+8>>1]|0;b[m+10>>1]=b[l+(n<<4)+10>>1]|0;b[m>>1]=b[l+(n<<4)>>1]|0;b[m+2>>1]=b[l+(n<<4)+2>>1]|0;b[m+4>>1]=b[l+(n<<4)+4>>1]|0;n=n+1|0;if((n|0)==(k|0))break;else m=m+16|0}}else l=c[a+136>>2]|0;Jb[c[(c[f>>2]|0)+20>>2]&31](f,j,16144,1497453121,l)}}else c[e+68>>2]=0;c[e+76>>2]=c[a+144>>2];c[e+80>>2]=c[a+152>>2];if(!(c[a+152>>2]|0)){c[e+72>>2]=0;i=h;return 16192}n=gc[c[(c[f>>2]|0)+28>>2]&31](f,c[a+160>>2]|0)|0;c[e+72>>2]=n;if(!n){i=h;return 16192}j=c[a+152>>2]|0;e=Yb[c[(c[f>>2]|0)+16>>2]&31](f,20,j)|0;if((j|0)>0){a=c[a+160>>2]|0;l=0;k=c[e+8>>2]|0;while(1){b[k+14>>1]=b[a+(l<<5)+6>>1]|0;b[k+16>>1]=b[a+(l<<5)+8>>1]|0;b[k+18>>1]=b[a+(l<<5)+10>>1]|0;b[k+8>>1]=b[a+(l<<5)>>1]|0;b[k+10>>1]=b[a+(l<<5)+2>>1]|0;b[k+12>>1]=b[a+(l<<5)+4>>1]|0;c[k>>2]=c[a+(l<<5)+12>>2];c[k+4>>2]=c[a+(l<<5)+16>>2];l=l+1|0;if((l|0)==(j|0))break;else k=k+20|0}}else a=c[a+160>>2]|0;Jb[c[(c[f>>2]|0)+20>>2]&31](f,e,16168,1497453121,a);i=h;return 16192}function UA(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0;f=i;i=i+32|0;C=+g[b+16>>2];s=+g[b>>2];B=+g[b+20>>2];u=+g[b+4>>2];y=+g[b+24>>2];x=+g[b+8>>2];v=+g[b+32>>2];o=+g[b+36>>2];p=+g[b+40>>2];m=(B-u)*(p-x)-(y-x)*(o-u);k=(y-x)*(v-s)-(C-s)*(p-x);l=(C-s)*(o-u)-(B-u)*(v-s);g[f+16>>2]=m;g[f+20>>2]=k;g[f+24>>2]=l;g[f+28>>2]=0.0;z=+g[a+4>>2];w=+g[a+8>>2];q=+g[a+12>>2];h=m*z+k*w+l*q-(s*m+u*k+x*l);A=+g[a+20>>2];t=+g[a+24>>2];r=+g[a+28>>2];if(h*(m*A+k*t+l*r-(s*m+u*k+x*l))>=0.0){i=f;return}b=c[a+36>>2]|0;if(!((b&1|0)==0|!(h<=0.0))){i=f;return}j=h/(h-(m*A+k*t+l*r-(s*m+u*k+x*l)));if(!(j<+g[a+40>>2])){i=f;return}n=(m*m+k*k+l*l)*-9999999747378752.0e-20;s=s-(A*j+z*(1.0-j));u=u-(t*j+w*(1.0-j));x=x-(r*j+q*(1.0-j));C=C-(A*j+z*(1.0-j));B=B-(t*j+w*(1.0-j));y=y-(r*j+q*(1.0-j));if(!(l*(s*B-u*C)+(m*(u*y-x*B)+k*(x*C-s*y))>=n)){i=f;return}v=v-(A*j+z*(1.0-j));o=o-(t*j+w*(1.0-j));p=p-(r*j+q*(1.0-j));if(!(l*(C*o-B*v)+(m*(B*p-y*o)+k*(y*v-C*p))>=n)){i=f;return}if(!(l*(u*v-s*o)+(m*(x*o-u*p)+k*(s*p-x*v))>=n)){i=f;return}n=1.0/+Q(+(m*m+k*k+l*l));g[f+16>>2]=m*n;g[f+20>>2]=k*n;g[f+24>>2]=l*n;D=c[(c[a>>2]|0)+12>>2]|0;if((b&2|0)!=0|!(h<=0.0)){g[a+40>>2]=+nc[D&3](a,f+16|0,j,d,e);i=f;return}else{g[f>>2]=-(m*n);g[f+4>>2]=-(k*n);g[f+8>>2]=-(l*n);g[f+12>>2]=0.0;g[a+40>>2]=+nc[D&3](a,f,j,d,e);i=f;return}}function VA(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;h=i;i=i+672|0;c[h+576>>2]=0;g[h+580>>2]=1.0;g[h+584>>2]=1.0;g[h+588>>2]=1.0;g[h+592>>2]=0.0;c[h+620>>2]=0;c[h+568>>2]=16376;c[h+572>>2]=1;c[h+624>>2]=c[d+0>>2];c[h+628>>2]=c[d+4>>2];c[h+632>>2]=c[d+8>>2];c[h+636>>2]=c[d+12>>2];c[h+640>>2]=c[d+16>>2];c[h+644>>2]=c[d+20>>2];c[h+648>>2]=c[d+24>>2];c[h+652>>2]=c[d+28>>2];c[h+656>>2]=c[d+32>>2];c[h+660>>2]=c[d+36>>2];c[h+664>>2]=c[d+40>>2];c[h+668>>2]=c[d+44>>2];g[h+612>>2]=+g[b+204>>2];g[h+516>>2]=9999999747378752.0e-20;a[h+540>>0]=0;c[h+200>>2]=13248;d=c[b+4>>2]|0;c[h+176>>2]=10152;c[h+180>>2]=h+208;c[h+184>>2]=h+200;c[h+188>>2]=d;c[h+192>>2]=h+568;c[h+196>>2]=0;c[h>>2]=9440;c[h+168>>2]=0;g[h+164>>2]=1.0;g[h+172>>2]=+g[b+208>>2];if((xw(h+176|0,b+8|0,b+72|0,b+136|0,b+136|0,h)|0?(j=+g[h+132>>2],l=+g[h+136>>2],m=+g[h+140>>2],j*j+l*l+m*m>9999999747378752.0e-20):0)?(k=+g[h+164>>2],k<+g[b+200>>2]):0){n=1.0/+Q(+(j*j+l*l+m*m));g[h+132>>2]=j*n;g[h+136>>2]=l*n;g[h+140>>2]=m*n;+bc[c[(c[b>>2]|0)+12>>2]&3](b,h+132|0,h+148|0,k,e,f)}c[h+568>>2]=15736;e=c[h+620>>2]|0;if(!e){i=h;return}Lb[c[c[e>>2]>>2]&511](e);e=c[h+620>>2]|0;if(!e){i=h;return}c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);i=h;return}function WA(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(!d){i=b;return}Lb[c[c[d>>2]>>2]&511](d);a=c[a+52>>2]|0;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function XA(a){a=a|0;return}function YA(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ZA(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=15736;d=c[a+52>>2]|0;if(d){Lb[c[c[d>>2]>>2]&511](d);d=c[a+52>>2]|0;if(d){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}if(!a){i=b;return}}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function _A(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+80>>2]&127](a,b,d,e);i=f;return}function $A(a,b,d){a=a|0;b=+b;d=d|0;a=i;c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;i=a;return}function aB(a){a=a|0;return 16544}function bB(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;l=+g[d>>2];k=+g[d+4>>2];f=+g[d+8>>2];j=l*+g[b+56>>2]+k*+g[b+60>>2]+f*+g[b+64>>2];h=l*+g[b+72>>2]+k*+g[b+76>>2]+f*+g[b+80>>2];f=l*+g[b+88>>2]+k*+g[b+92>>2]+f*+g[b+96>>2];if(j<h)d=h<f?2:1;else d=j<f?2:0;d=b+(d<<4)+56|0;c[a+0>>2]=c[d+0>>2];c[a+4>>2]=c[d+4>>2];c[a+8>>2]=c[d+8>>2];c[a+12>>2]=c[d+12>>2];i=e;return}function cB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0.0,l=0.0,m=0.0,n=0,o=0.0,p=0.0;h=i;if((e|0)<=0){i=h;return}f=0;do{p=+g[b+(f<<4)>>2];o=+g[b+(f<<4)+4>>2];k=+g[b+(f<<4)+8>>2];m=p*+g[a+56>>2]+o*+g[a+60>>2]+k*+g[a+64>>2];l=p*+g[a+72>>2]+o*+g[a+76>>2]+k*+g[a+80>>2];k=p*+g[a+88>>2]+o*+g[a+92>>2]+k*+g[a+96>>2];j=d+(f<<4)|0;if(m<l)n=l<k?2:1;else n=m<k?2:0;n=a+(n<<4)+56|0;c[j+0>>2]=c[n+0>>2];c[j+4>>2]=c[n+4>>2];c[j+8>>2]=c[n+8>>2];c[j+12>>2]=c[n+12>>2];f=f+1|0}while((f|0)!=(e|0));i=h;return}function dB(a){a=a|0;return 2}function eB(a,b,c){a=a|0;b=b|0;c=c|0;var d=0.0,e=0.0,f=0.0,h=0,j=0.0,k=0.0,l=0.0,m=0.0;h=i;k=+g[a+56>>2];f=+g[a+72>>2]-k;j=+g[a+60>>2];e=+g[a+76>>2]-j;l=+g[a+64>>2];d=+g[a+80>>2]-l;k=+g[a+88>>2]-k;j=+g[a+92>>2]-j;l=+g[a+96>>2]-l;g[c+12>>2]=0.0;m=1.0/+Q(+((f*j-e*k)*(f*j-e*k)+((e*l-d*j)*(e*l-d*j)+(d*k-f*l)*(d*k-f*l))));g[c>>2]=m*(e*l-d*j);g[c+4>>2]=m*(d*k-f*l);g[c+8>>2]=(f*j-e*k)*m;if(!b){i=h;return}g[c>>2]=m*(e*l-d*j)*-1.0;g[c+4>>2]=m*(d*k-f*l)*-1.0;g[c+8>>2]=(f*j-e*k)*m*-1.0;i=h;return}function fB(a){a=a|0;return 3}function gB(a){a=a|0;return 3}function hB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;rc[c[(c[a>>2]|0)+108>>2]&127](a,b,d);rc[c[(c[a>>2]|0)+108>>2]&127](a,(b+1|0)%3|0,e);i=f;return}function iB(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;c[d+0>>2]=c[a+(b<<4)+56>>2];c[d+4>>2]=c[a+(b<<4)+60>>2];c[d+8>>2]=c[a+(b<<4)+64>>2];c[d+12>>2]=c[a+(b<<4)+68>>2];i=e;return}function jB(a){a=a|0;return 1}function kB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;vc[c[(c[a>>2]|0)+124>>2]&127](a,e,b,d);i=f;return}function lB(a,b,d){a=a|0;b=b|0;d=+d;var e=0,f=0.0,h=0.0,j=0.0,k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0;e=i;i=i+32|0;n=+g[a+56>>2];r=+g[a+72>>2]-n;m=+g[a+60>>2];p=+g[a+76>>2]-m;l=+g[a+64>>2];s=+g[a+80>>2]-l;o=+g[a+88>>2]-n;q=+g[a+92>>2]-m;f=+g[a+96>>2]-l;j=1.0/+Q(+((r*q-p*o)*(r*q-p*o)+((p*f-s*q)*(p*f-s*q)+(s*o-r*f)*(s*o-r*f))));h=j*(p*f-s*q);f=j*(s*o-r*f);j=(r*q-p*o)*j;l=+g[b>>2]*h+ +g[b+4>>2]*f+j*+g[b+8>>2]-(h*n+f*m+j*l);if(!(l>=-d)|!(l<=d)){k=0;i=e;return k|0}k=0;while(1){vc[c[(c[a>>2]|0)+104>>2]&127](a,k,e+16|0,e);n=+g[e+16>>2];s=+g[e>>2]-n;p=+g[e+20>>2];o=+g[e+4>>2]-p;m=+g[e+24>>2];r=+g[e+8>>2]-m;q=1.0/+Q(+((f*s-h*o)*(f*s-h*o)+((j*o-f*r)*(j*o-f*r)+(h*r-j*s)*(h*r-j*s))));k=k+1|0;if(+g[b>>2]*q*(j*o-f*r)+ +g[b+4>>2]*q*(h*r-j*s)+(f*s-h*o)*q*+g[b+8>>2]-(m*(f*s-h*o)*q+(n*q*(j*o-f*r)+p*q*(h*r-j*s)))<-d){b=0;a=5;break}if((k|0)>=3){b=1;a=5;break}}if((a|0)==5){i=e;return b|0}return 0}function mB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0;b=i;h=+g[a+56>>2];l=+g[a+72>>2]-h;k=+g[a+60>>2];j=+g[a+76>>2]-k;m=+g[a+64>>2];n=+g[a+80>>2]-m;h=+g[a+88>>2]-h;k=+g[a+92>>2]-k;m=+g[a+96>>2]-m;g[d+12>>2]=0.0;f=1.0/+Q(+((l*k-j*h)*(l*k-j*h)+((j*m-n*k)*(j*m-n*k)+(n*h-l*m)*(n*h-l*m))));g[d>>2]=f*(j*m-n*k);g[d+4>>2]=f*(n*h-l*m);g[d+8>>2]=(l*k-j*h)*f;c[e+0>>2]=c[a+56>>2];c[e+4>>2]=c[a+60>>2];c[e+8>>2]=c[a+64>>2];c[e+12>>2]=c[a+68>>2];i=b;return}function nB(a){a=a|0;var b=0;b=i;oB(a);gF(a);i=b;return}function oB(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=16568;e=c[b+56>>2]|0;if(e){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=0;c[b+48>>2]=0;c[b+52>>2]=0;e=c[b+36>>2]|0;if(e){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+28>>2]=0;c[b+32>>2]=0;e=c[b+16>>2]|0;if(!e){e=b+12|0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;c[e>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;e=b+12|0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;c[e>>2]=0;i=d;return}function pB(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0;e=i;if((c[d+8>>2]|0)>0){h=c[d+16>>2]|0;j=0;f=0;do{k=c[h+(j<<2)>>2]|0;if(!(c[k+204>>2]&3)){c[k+208>>2]=f;f=f+1|0}c[k+212>>2]=-1;g[k+244>>2]=1.0;j=j+1|0}while((j|0)<(c[d+8>>2]|0))}else f=0;h=c[b+8>>2]|0;if((h|0)<(f|0)){if((c[b+12>>2]|0)<(f|0)){if(!f){j=0;m=h}else{c[5004]=(c[5004]|0)+1;j=fF((f<<3|3)+16|0)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}m=c[b+8>>2]|0}if((m|0)>0){l=0;do{k=j+(l<<3)|0;if(k){o=(c[b+16>>2]|0)+(l<<3)|0;n=c[o+4>>2]|0;c[k>>2]=c[o>>2];c[k+4>>2]=n}l=l+1|0}while((l|0)!=(m|0))}k=c[b+16>>2]|0;if(k){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=j;c[b+12>>2]=f;j=b+16|0}else j=b+16|0;do{k=(c[j>>2]|0)+(h<<3)|0;if(k){c[k>>2]=0;c[k+4>>2]=0}h=h+1|0}while((h|0)!=(f|0))}c[b+8>>2]=f;if((f|0)>0){j=c[b+16>>2]|0;h=0;do{c[j+(h<<3)>>2]=h;c[j+(h<<3)+4>>2]=1;h=h+1|0}while((h|0)!=(f|0))}f=c[d+68>>2]|0;f=Pb[c[(c[f>>2]|0)+36>>2]&127](f)|0;d=Pb[c[(c[f>>2]|0)+36>>2]&127](f)|0;if(!d){i=e;return}h=Pb[c[(c[f>>2]|0)+20>>2]&127](f)|0;if((d|0)<=0){i=e;return}f=0;do{k=c[c[h+(f<<4)>>2]>>2]|0;j=c[c[h+(f<<4)+4>>2]>>2]|0;if(((k|0)!=0?!((j|0)==0?1:(c[k+204>>2]&7|0)!=0):0)?(c[j+204>>2]&7|0)==0:0){l=c[k+208>>2]|0;k=c[j+208>>2]|0;j=c[b+16>>2]|0;m=c[j+(l<<3)>>2]|0;if((m|0)!=(l|0)){n=j+(l<<3)|0;do{l=j+(m<<3)|0;c[n>>2]=c[l>>2];l=c[l>>2]|0;n=j+(l<<3)|0;m=c[n>>2]|0}while((l|0)!=(m|0))}m=c[j+(k<<3)>>2]|0;if((m|0)!=(k|0)){n=j+(k<<3)|0;do{k=j+(m<<3)|0;c[n>>2]=c[k>>2];k=c[k>>2]|0;n=j+(k<<3)|0;m=c[n>>2]|0}while((k|0)!=(m|0))}if((l|0)!=(k|0)){c[j+(l<<3)>>2]=k;o=j+(k<<3)+4|0;c[o>>2]=(c[o>>2]|0)+(c[j+(l<<3)+4>>2]|0)}}f=f+1|0}while((f|0)!=(d|0));i=e;return}function qB(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0;f=i;if((c[b+8>>2]|0)<=0){i=f;return}d=c[b+16>>2]|0;e=0;g=0;do{h=c[d+(e<<2)>>2]|0;if(!(c[h+204>>2]&3)){j=c[a+16>>2]|0;l=j+(g<<3)|0;k=c[l>>2]|0;if((k|0)==(g|0))m=g;else do{m=j+(k<<3)|0;c[l>>2]=c[m>>2];m=c[m>>2]|0;l=j+(m<<3)|0;k=c[l>>2]|0}while((m|0)!=(k|0));c[h+208>>2]=m;c[j+(g<<3)+4>>2]=e;c[h+212>>2]=-1;g=g+1|0}else{c[h+208>>2]=-1;c[h+212>>2]=-2}e=e+1|0}while((e|0)<(c[b+8>>2]|0));i=f;return}function rB(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;e=i;while(1){f=c[a+12>>2]|0;g=c[f+(((b+d|0)/2|0)<<2)>>2]|0;l=b;k=d;while(1){h=c[(c[g+740>>2]|0)+208>>2]|0;if((h|0)>-1)while(1){j=c[f+(l<<2)>>2]|0;m=c[(c[j+740>>2]|0)+208>>2]|0;if((m|0)<=-1)m=c[(c[j+744>>2]|0)+208>>2]|0;if((m|0)<(h|0))l=l+1|0;else break}else{m=c[(c[g+744>>2]|0)+208>>2]|0;while(1){j=c[f+(l<<2)>>2]|0;n=c[(c[j+740>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[j+744>>2]|0)+208>>2]|0;if((n|0)<(m|0))l=l+1|0;else break}}if((h|0)>-1)while(1){m=c[f+(k<<2)>>2]|0;n=c[(c[m+740>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[m+744>>2]|0)+208>>2]|0;if((h|0)<(n|0))k=k+ -1|0;else break}else{h=c[(c[g+744>>2]|0)+208>>2]|0;while(1){m=c[f+(k<<2)>>2]|0;n=c[(c[m+740>>2]|0)+208>>2]|0;if((n|0)<=-1)n=c[(c[m+744>>2]|0)+208>>2]|0;if((h|0)<(n|0))k=k+ -1|0;else break}}if((l|0)<=(k|0)){c[f+(l<<2)>>2]=m;c[(c[a+12>>2]|0)+(k<<2)>>2]=j;l=l+1|0;k=k+ -1|0}if((l|0)>(k|0))break;f=c[a+12>>2]|0}if((k|0)>(b|0))rB(a,b,k);if((l|0)<(d|0))b=l;else break}i=e;return}function sB(a,b,d){a=a|0;b=b|0;d=d|0;d=i;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;i=d;return}function tB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0;a=i;if((e|0)>0)b=0;else{i=a;return}do{g=d+(b<<4)|0;b=b+1|0;f=(b|0)==(e|0);c[g+0>>2]=0;c[g+4>>2]=0;c[g+8>>2]=0;c[g+12>>2]=0}while(!f);i=a;return}function uB(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;rc[c[(c[b>>2]|0)+68>>2]&127](a,b,d);l=+g[d>>2];j=+g[d+4>>2];h=+g[d+8>>2];f=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:h;k=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:j;l=l*l+j*j+h*h<1.4210854715202004e-14?-1.0:l;h=1.0/+Q(+(f*f+(l*l+k*k)));j=+$b[c[(c[b>>2]|0)+48>>2]&15](b);g[a>>2]=h*l*j+ +g[a>>2];g[a+4>>2]=j*h*k+ +g[a+4>>2];g[a+8>>2]=j*h*f+ +g[a+8>>2];i=e;return}function vB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0;f=i;k=+$b[c[(c[a>>2]|0)+48>>2]&15](a);j=+$b[c[(c[a>>2]|0)+48>>2]&15](a);h=+$b[c[(c[a>>2]|0)+48>>2]&15](a);m=+g[b+52>>2]-j;l=+g[b+56>>2]-h;g[d>>2]=+g[b+48>>2]-k;g[d+4>>2]=m;g[d+8>>2]=l;g[d+12>>2]=0.0;j=j+ +g[b+52>>2];h=h+ +g[b+56>>2];g[e>>2]=k+ +g[b+48>>2];g[e+4>>2]=j;g[e+8>>2]=h;g[e+12>>2]=0.0;i=f;return}function wB(a,b,d){a=a|0;b=+b;d=d|0;var e=0;e=i;b=b*.4000000059604645*+$b[c[(c[a>>2]|0)+48>>2]&15](a);b=b*+$b[c[(c[a>>2]|0)+48>>2]&15](a);g[d>>2]=b;g[d+4>>2]=b;g[d+8>>2]=b;g[d+12>>2]=0.0;i=e;return}function xB(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=16816;if((a[b+8>>0]|0)!=0?(e=c[b+12>>2]|0,(e|0)!=0):0){f=c[b+4>>2]|0;Nb[c[(c[f>>2]|0)+16>>2]&127](f,e)}gF(b);i=d;return}function yB(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=16816;if(!(a[b+8>>0]|0)){i=d;return}e=c[b+12>>2]|0;if(!e){i=d;return}b=c[b+4>>2]|0;Nb[c[(c[b>>2]|0)+16>>2]&127](b,e);i=d;return}function zB(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0,p=0,q=0.0;e=i;i=i+32|0;a=c[a+12>>2]|0;if(!a){i=e;return}c[f+4>>2]=a;o=c[b+4>>2]|0;p=c[d+4>>2]|0;b=c[b+12>>2]|0;d=c[d+12>>2]|0;m=+g[b+48>>2]- +g[d+48>>2];n=+g[b+52>>2]- +g[d+52>>2];l=+g[b+56>>2]- +g[d+56>>2];j=+Q(+(m*m+n*n+l*l));h=+g[p+28>>2]*+g[p+12>>2];k=+g[o+28>>2]*+g[o+12>>2]+h;if(j>k){if(!(c[a+748>>2]|0)){i=e;return}d=c[a+740>>2]|0;b=c[(c[f+8>>2]|0)+8>>2]|0;if((d|0)==(b|0)){xA(a,d+4|0,(c[(c[f+12>>2]|0)+8>>2]|0)+4|0);i=e;return}else{xA(a,(c[(c[f+12>>2]|0)+8>>2]|0)+4|0,b+4|0);i=e;return}}g[e+16>>2]=1.0;g[e+20>>2]=0.0;g[e+24>>2]=0.0;g[e+28>>2]=0.0;if(j>1.1920928955078125e-7){g[e+16>>2]=m*(1.0/j);g[e+20>>2]=n*(1.0/j);g[e+24>>2]=l*(1.0/j);g[e+28>>2]=0.0;m=m*(1.0/j);n=n*(1.0/j);l=l*(1.0/j)}else{m=1.0;n=0.0;l=0.0}q=h*n+ +g[d+52>>2];n=h*l+ +g[d+56>>2];g[e>>2]=h*m+ +g[d+48>>2];g[e+4>>2]=q;g[e+8>>2]=n;g[e+12>>2]=0.0;qc[c[(c[f>>2]|0)+16>>2]&15](f,e+16|0,e,j-k);a=c[f+4>>2]|0;if(!(c[a+748>>2]|0)){i=e;return}d=c[a+740>>2]|0;b=c[(c[f+8>>2]|0)+8>>2]|0;if((d|0)==(b|0)){xA(a,d+4|0,(c[(c[f+12>>2]|0)+8>>2]|0)+4|0);i=e;return}else{xA(a,(c[(c[f+12>>2]|0)+8>>2]|0)+4|0,b+4|0);i=e;return}}function AB(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 1.0}function BB(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+12>>2]|0)){i=e;return}if(!(a[b+8>>0]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+12>>2];c[d+4>>2]=h+1;i=e;return}function CB(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=16904;if((a[b+8>>0]|0)!=0?(e=c[b+12>>2]|0,(e|0)!=0):0){f=c[b+4>>2]|0;Nb[c[(c[f>>2]|0)+16>>2]&127](f,e)}gF(b);i=d;return}function DB(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=16904;if(!(a[b+8>>0]|0)){i=d;return}e=c[b+12>>2]|0;if(!e){i=d;return}b=c[b+4>>2]|0;Nb[c[(c[b>>2]|0)+16>>2]&127](b,e);i=d;return}function EB(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0.0,o=0;j=i;i=i+160|0;k=c[b+12>>2]|0;if(!k){i=j;return}l=(a[b+16>>0]|0)!=0;m=l?e:d;d=l?d:e;o=c[m+4>>2]|0;e=c[d+4>>2]|0;c[h+4>>2]=k;n=+g[(c[b+12>>2]|0)+752>>2];c[j+136>>2]=17768;c[j+140>>2]=o;c[j+144>>2]=e;g[j+148>>2]=n;g[j+128>>2]=999999984306749400.0;e=c[m+12>>2]|0;c[j+0>>2]=c[e+0>>2];c[j+4>>2]=c[e+4>>2];c[j+8>>2]=c[e+8>>2];c[j+12>>2]=c[e+12>>2];c[j+16>>2]=c[e+16>>2];c[j+20>>2]=c[e+20>>2];c[j+24>>2]=c[e+24>>2];c[j+28>>2]=c[e+28>>2];c[j+32>>2]=c[e+32>>2];c[j+36>>2]=c[e+36>>2];c[j+40>>2]=c[e+40>>2];c[j+44>>2]=c[e+44>>2];c[j+48>>2]=c[e+48>>2];c[j+52>>2]=c[e+52>>2];c[j+56>>2]=c[e+56>>2];c[j+60>>2]=c[e+60>>2];d=c[d+12>>2]|0;c[j+64>>2]=c[d+0>>2];c[j+68>>2]=c[d+4>>2];c[j+72>>2]=c[d+8>>2];c[j+76>>2]=c[d+12>>2];c[j+80>>2]=c[d+16>>2];c[j+84>>2]=c[d+20>>2];c[j+88>>2]=c[d+24>>2];c[j+92>>2]=c[d+28>>2];c[j+96>>2]=c[d+32>>2];c[j+100>>2]=c[d+36>>2];c[j+104>>2]=c[d+40>>2];c[j+108>>2]=c[d+44>>2];c[j+112>>2]=c[d+48>>2];c[j+116>>2]=c[d+52>>2];c[j+120>>2]=c[d+56>>2];c[j+124>>2]=c[d+60>>2];xC(j+136|0,j,h,c[f+20>>2]|0,l);if(!(a[b+8>>0]|0)){i=j;return}b=c[h+4>>2]|0;if(!(c[b+748>>2]|0)){i=j;return}k=c[b+740>>2]|0;e=c[(c[h+8>>2]|0)+8>>2]|0;if((k|0)==(e|0)){xA(b,k+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=j;return}else{xA(b,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,e+4|0);i=j;return}}function FB(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 1.0}function GB(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+12>>2]|0)){i=e;return}if(!(a[b+8>>0]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+12>>2];c[d+4>>2]=h+1;i=e;return}function HB(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function IB(a){a=a|0;return}function JB(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;g[c>>2]=-999999984306749400.0;g[c+4>>2]=-999999984306749400.0;g[c+8>>2]=-999999984306749400.0;g[c+12>>2]=0.0;g[d>>2]=999999984306749400.0;g[d+4>>2]=999999984306749400.0;g[d+8>>2]=999999984306749400.0;g[d+12>>2]=0.0;return}function KB(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0;f=i;i=i+48|0;k=+g[e>>2];l=+g[d>>2];h=+g[e+4>>2];j=+g[d+4>>2];m=+g[e+8>>2];o=+g[d+8>>2];t=+Q(+((k-l)*.5*(k-l)*.5+(h-j)*.5*(h-j)*.5+(m-o)*.5*(m-o)*.5));p=+g[a+56>>2];if(+P(+p)>.7071067690849304){n=+g[a+52>>2];s=1.0/+Q(+(p*p+n*n));y=+g[a+48>>2];q=y;x=n;r=0.0;w=-(p*s);v=n*s;u=(p*p+n*n)*s;n=-(y*n*s);s=y*-(p*s)}else{z=+g[a+48>>2];y=+g[a+52>>2];s=1.0/+Q(+(z*z+y*y));q=z;x=y;r=-(y*s);w=z*s;v=0.0;u=-(p*z*s);n=p*-(y*s);s=(z*z+y*y)*s}z=(k+l)*.5*q+(h+j)*.5*x+(m+o)*.5*p- +g[a+64>>2];j=(h+j)*.5-x*z;q=(k+l)*.5-q*z;r=t*r;w=t*w;y=t*v;u=t*u;v=t*n;x=t*s;g[f>>2]=u+(r+q);g[f+4>>2]=v+(w+j);g[f+8>>2]=x+(y+((m+o)*.5-p*z));g[f+12>>2]=0.0;g[f+16>>2]=r+q-u;g[f+20>>2]=w+j-v;g[f+24>>2]=y+((m+o)*.5-p*z)-x;g[f+28>>2]=0.0;g[f+32>>2]=q-r-u;g[f+36>>2]=j-w-v;g[f+40>>2]=(m+o)*.5-p*z-y-x;g[f+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,f,0,0);g[f>>2]=q-r-u;g[f+4>>2]=j-w-v;g[f+8>>2]=(m+o)*.5-p*z-y-x;g[f+12>>2]=0.0;g[f+16>>2]=u+(q-r);g[f+20>>2]=v+(j-w);g[f+24>>2]=x+((m+o)*.5-p*z-y);g[f+28>>2]=0.0;g[f+32>>2]=u+(r+q);g[f+36>>2]=v+(w+j);g[f+40>>2]=x+(y+((m+o)*.5-p*z));g[f+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,f,0,1);i=f;return}function LB(a,b,d){a=a|0;b=+b;d=d|0;a=i;c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;i=a;return}function MB(a,b){a=a|0;b=b|0;var d=0;d=i;c[a+68>>2]=c[b+0>>2];c[a+72>>2]=c[b+4>>2];c[a+76>>2]=c[b+8>>2];c[a+80>>2]=c[b+12>>2];i=d;return}function NB(a){a=a|0;return a+68|0}function OB(a){a=a|0;return 17128}function PB(a){a=a|0;return 52}function QB(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0;e=i;f=gc[c[(c[d>>2]|0)+40>>2]&31](d,a)|0;h=gc[c[(c[d>>2]|0)+28>>2]&31](d,f)|0;c[b>>2]=h;if(h)Nb[c[(c[d>>2]|0)+48>>2]&127](d,f);c[b+4>>2]=c[a+4>>2];g[b+12>>2]=+g[a+68>>2];g[b+16>>2]=+g[a+72>>2];g[b+20>>2]=+g[a+76>>2];g[b+24>>2]=+g[a+80>>2];g[b+28>>2]=+g[a+48>>2];g[b+32>>2]=+g[a+52>>2];g[b+36>>2]=+g[a+56>>2];g[b+40>>2]=+g[a+60>>2];g[b+44>>2]=+g[a+64>>2];i=e;return 17104}function RB(b,d,e,f,h,j){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0,ca=0,da=0,ea=0.0,fa=0,ga=0.0;k=i;i=i+128|0;fa=c[b+4>>2]|0;a[fa+312>>0]=0;c[fa>>2]=0;a[fa+356>>0]=1;g[fa+292>>2]=999999984306749400.0;g[fa+296>>2]=999999984306749400.0;g[fa+300>>2]=999999984306749400.0;g[fa+304>>2]=0.0;c[fa+336>>2]=0;c[fa+340>>2]=0;c[fa+344>>2]=0;c[fa+348>>2]=0;a[fa+352>>0]=0;a[fa+332>>0]=a[fa+332>>0]&-16;O=+g[d+48>>2];V=+g[d+52>>2];R=+g[d+56>>2];Y=+g[f+48>>2];W=+g[f+52>>2];P=+g[f+56>>2];D=+g[d>>2];p=+g[d+4>>2];r=+g[d+8>>2];E=+g[d+16>>2];z=+g[d+20>>2];s=+g[d+24>>2];w=+g[d+32>>2];q=+g[d+36>>2];t=+g[d+40>>2];u=+g[f>>2];x=+g[f+4>>2];A=+g[f+8>>2];v=+g[f+16>>2];y=+g[f+20>>2];B=+g[f+24>>2];F=+g[f+32>>2];o=+g[f+36>>2];C=+g[f+40>>2];m=+g[e+48>>2]-O-(+g[h+48>>2]-Y);l=+g[e+52>>2]-V-(+g[h+52>>2]-W);n=+g[e+56>>2]-R-(+g[h+56>>2]-P);fa=c[b+8>>2]|0;da=c[(c[fa>>2]|0)+64>>2]|0;g[k+96>>2]=D*-m+E*-l+w*-n;g[k+100>>2]=p*-m+z*-l+q*-n;g[k+104>>2]=r*-m+s*-l+t*-n;g[k+108>>2]=0.0;rc[da&127](k+112|0,fa,k+96|0);aa=+g[k+112>>2];ea=+g[k+116>>2];X=+g[k+120>>2];Z=aa*+g[d>>2]+ea*+g[d+4>>2]+X*+g[d+8>>2]+ +g[d+48>>2];_=aa*+g[d+16>>2]+ea*+g[d+20>>2]+X*+g[d+24>>2]+ +g[d+52>>2];X=aa*+g[d+32>>2]+ea*+g[d+36>>2]+X*+g[d+40>>2]+ +g[d+56>>2];fa=c[b+12>>2]|0;da=c[(c[fa>>2]|0)+64>>2]|0;ea=m*+g[f+4>>2]+l*+g[f+20>>2]+n*+g[f+36>>2];aa=m*+g[f+8>>2]+l*+g[f+24>>2]+n*+g[f+40>>2];g[k+64>>2]=m*+g[f>>2]+l*+g[f+16>>2]+n*+g[f+32>>2];g[k+68>>2]=ea;g[k+72>>2]=aa;g[k+76>>2]=0.0;rc[da&127](k+80|0,fa,k+64|0);aa=+g[k+80>>2];ea=+g[k+84>>2];$=+g[k+88>>2];Z=Z-(aa*+g[f>>2]+ea*+g[f+4>>2]+$*+g[f+8>>2]+ +g[f+48>>2]);_=_-(aa*+g[f+16>>2]+ea*+g[f+20>>2]+$*+g[f+24>>2]+ +g[f+52>>2]);$=X-(aa*+g[f+32>>2]+ea*+g[f+36>>2]+$*+g[f+40>>2]+ +g[f+56>>2]);a:do if(Z*Z+_*_+$*$>9999999747378752.0e-20){S=0.0;U=0.0;X=0.0;T=0.0;H=0.0;G=32;aa=0.0;while(1){if(!G)break a;G=G+ -1|0;fa=c[b+8>>2]|0;da=c[(c[fa>>2]|0)+64>>2]|0;I=-Z;ga=-_;ea=-$;g[k+32>>2]=D*I+E*ga+w*ea;g[k+36>>2]=p*I+z*ga+q*ea;g[k+40>>2]=r*I+s*ga+t*ea;g[k+44>>2]=0.0;rc[da&127](k+48|0,fa,k+32|0);ea=+g[k+48>>2];ga=+g[k+52>>2];I=+g[k+56>>2];J=O+(D*ea+p*ga+r*I);L=V+(E*ea+z*ga+s*I);I=R+(w*ea+q*ga+t*I);fa=c[b+12>>2]|0;da=c[(c[fa>>2]|0)+64>>2]|0;g[k>>2]=u*Z+v*_+F*$;g[k+4>>2]=x*Z+y*_+o*$;g[k+8>>2]=A*Z+B*_+C*$;g[k+12>>2]=0.0;rc[da&127](k+16|0,fa,k);ga=+g[k+16>>2];ea=+g[k+20>>2];M=+g[k+24>>2];K=Y+(u*ga+x*ea+A*M);N=W+(v*ga+y*ea+B*M);M=P+(F*ga+o*ea+C*M);ea=Z*(J-K)+_*(L-N)+$*(I-M);if(H>1.0){j=0;h=24;break}if(ea>0.0){O=m*Z+l*_+n*$;if(O>=-1.4210854715202004e-14){j=0;h=24;break}H=H-ea/O;R=(1.0-H)*+g[d+56>>2]+H*+g[e+56>>2];V=(1.0-H)*+g[d+52>>2]+H*+g[e+52>>2];O=+g[d+48>>2]*(1.0-H)+H*+g[e+48>>2];P=(1.0-H)*+g[f+56>>2]+H*+g[h+56>>2];W=(1.0-H)*+g[f+52>>2]+H*+g[h+52>>2];Y=(1.0-H)*+g[f+48>>2]+H*+g[h+48>>2];T=aa;X=$;U=_;S=Z}ba=c[b+4>>2]|0;ca=c[ba>>2]|0;if((ca|0)>0){Z=+g[ba+308>>2];fa=0;da=0;do{aa=J-K- +g[ba+(da<<4)+4>>2];ea=L-N- +g[ba+(da<<4)+8>>2];ga=I-M- +g[ba+(da<<4)+12>>2];fa=fa|aa*aa+ea*ea+ga*ga<=Z;da=da+1|0}while((da|0)!=(ca|0))}else fa=0;if((+g[ba+304>>2]==0.0?I-M==+g[ba+300>>2]:0)?L-N==+g[ba+296>>2]:0)da=J-K==+g[ba+292>>2];else da=0;if(!(da|fa)){g[ba+292>>2]=J-K;g[ba+296>>2]=L-N;g[ba+300>>2]=I-M;g[ba+304>>2]=0.0;a[ba+356>>0]=1;g[ba+(ca<<4)+4>>2]=J-K;g[ba+(ca<<4)+8>>2]=L-N;g[ba+(ca<<4)+12>>2]=I-M;g[ba+(ca<<4)+16>>2]=0.0;fa=c[ba>>2]|0;g[ba+(fa<<4)+84>>2]=J;g[ba+(fa<<4)+88>>2]=L;g[ba+(fa<<4)+92>>2]=I;g[ba+(fa<<4)+96>>2]=0.0;fa=c[ba>>2]|0;g[ba+(fa<<4)+164>>2]=K;g[ba+(fa<<4)+168>>2]=N;g[ba+(fa<<4)+172>>2]=M;g[ba+(fa<<4)+176>>2]=0.0;c[ba>>2]=(c[ba>>2]|0)+1;ba=c[b+4>>2]|0}fa=vC(ba)|0;Z=+g[ba+276>>2];_=+g[ba+280>>2];$=+g[ba+284>>2];if(!fa)break a;if(!(Z*Z+_*_+$*$>9999999747378752.0e-20))break a;else aa=+g[ba+288>>2]}if((h|0)==24){i=k;return j|0}}else{T=0.0;X=0.0;U=0.0;S=0.0;H=0.0}while(0);g[j+164>>2]=H;o=X*X+(U*U+S*S);if(!(o>=1.4210854715202004e-14)){c[j+132>>2]=0;c[j+136>>2]=0;c[j+140>>2]=0;c[j+144>>2]=0;o=0.0;q=0.0;p=0.0}else{p=1.0/+Q(+o);o=S*p;q=U*p;p=X*p;g[j+132>>2]=o;g[j+136>>2]=q;g[j+140>>2]=p;g[j+144>>2]=T}if(m*o+l*q+n*p>=-+g[j+172>>2]){fa=0;i=k;return fa|0}fa=c[b+4>>2]|0;vC(fa)|0;nF(j+148|0,fa+260|0,16)|0;fa=1;i=k;return fa|0}function SB(a){a=a|0;return}function TB(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function UB(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0;f=i;g[b+4>>2]=1.0;g[b+8>>2]=1.0;g[b+12>>2]=1.0;g[b+16>>2]=0.0;a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;c[b+48>>2]=0;c[b>>2]=17304;a[b+100>>0]=1;c[b+96>>2]=0;c[b+88>>2]=0;c[b+92>>2]=0;a[b+120>>0]=1;c[b+116>>2]=0;c[b+108>>2]=0;c[b+112>>2]=0;a[b+140>>0]=1;c[b+136>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;a[b+160>>0]=1;c[b+156>>2]=0;c[b+148>>2]=0;c[b+152>>2]=0;a[b+164>>0]=d&1;a[b+165>>0]=e&1;g[b+168>>2]=0.0;c[5004]=(c[5004]|0)+1;e=fF(51)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}d=c[b+24>>2]|0;if((d|0)>0){h=0;do{j=e+(h<<5)|0;k=(c[b+32>>2]|0)+(h<<5)|0;c[j+0>>2]=c[k+0>>2];c[j+4>>2]=c[k+4>>2];c[j+8>>2]=c[k+8>>2];c[j+12>>2]=c[k+12>>2];c[j+16>>2]=c[k+16>>2];c[j+20>>2]=c[k+20>>2];c[j+24>>2]=c[k+24>>2];c[j+28>>2]=c[k+28>>2];h=h+1|0}while((h|0)!=(d|0))}d=c[b+32>>2]|0;if(d){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[d+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=e;c[b+28>>2]=1;k=c[b+24>>2]|0;c[e+(k<<5)>>2]=0;c[e+(k<<5)+4>>2]=0;c[e+(k<<5)+8>>2]=12;c[e+(k<<5)+12>>2]=0;c[e+(k<<5)+16>>2]=0;c[e+(k<<5)+20>>2]=16;c[e+(k<<5)+24>>2]=2;c[e+(k<<5)+28>>2]=0;c[b+24>>2]=(c[b+24>>2]|0)+1;if(!(a[b+164>>0]|0)){e=c[b+32>>2]|0;c[e>>2]=(c[b+148>>2]|0)/3|0;c[e+4>>2]=0;e=c[b+32>>2]|0;c[e+24>>2]=3;c[e+8>>2]=6}else{e=c[b+32>>2]|0;c[e>>2]=(c[b+128>>2]|0)/3|0;c[e+4>>2]=0;e=c[b+32>>2]|0;c[e+24>>2]=2;c[e+8>>2]=12}if(!(a[b+165>>0]|0)){c[e+12>>2]=(c[b+108>>2]|0)/3|0;c[e+16>>2]=0;c[(c[b+32>>2]|0)+20>>2]=12;i=f;return}else{c[e+12>>2]=c[b+88>>2];c[e+16>>2]=0;c[(c[b+32>>2]|0)+20>>2]=16;i=f;return}}function VB(d,e){d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0;f=i;if(!(a[d+164>>0]|0)){j=c[d+148>>2]|0;if((j|0)==(c[d+152>>2]|0)?(g=(j|0)==0?1:j<<1,(j|0)<(g|0)):0){if(!g)h=0;else{c[5004]=(c[5004]|0)+1;h=fF((g<<1)+19|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[d+148>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<1)|0;if(l)b[l>>1]=b[(c[d+156>>2]|0)+(k<<1)>>1]|0;k=k+1|0}while((k|0)!=(j|0))}k=c[d+156>>2]|0;if(k){if(a[d+160>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0);j=c[d+148>>2]|0}c[d+156>>2]=0}a[d+160>>0]=1;c[d+156>>2]=h;c[d+152>>2]=g}g=c[d+156>>2]|0;h=g+(j<<1)|0;if(h)b[h>>1]=e;c[d+148>>2]=j+1;c[(c[d+32>>2]|0)+4>>2]=g;i=f;return}else{l=c[d+128>>2]|0;if((l|0)==(c[d+132>>2]|0)?(h=(l|0)==0?1:l<<1,(l|0)<(h|0)):0){if(!h)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((h<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}l=c[d+128>>2]|0}if((l|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+136>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(l|0))}j=c[d+136>>2]|0;if(j){if(a[d+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[d+136>>2]=0}a[d+140>>0]=1;c[d+136>>2]=g;c[d+132>>2]=h;l=c[d+128>>2]|0}g=c[d+136>>2]|0;h=g+(l<<2)|0;if(h){c[h>>2]=e;l=c[d+128>>2]|0}c[d+128>>2]=l+1;c[(c[d+32>>2]|0)+4>>2]=g;i=f;return}}function WB(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0.0,s=0.0,t=0.0;f=i;if(a[b+165>>0]|0){a:do if(e?(j=c[b+88>>2]|0,(j|0)>0):0){e=c[b+96>>2]|0;o=+g[d>>2];p=+g[d+4>>2];m=+g[d+8>>2];n=+g[b+168>>2];k=0;while(1){t=+g[e+(k<<4)>>2]-o;s=+g[e+(k<<4)+4>>2]-p;r=+g[e+(k<<4)+8>>2]-m;if(t*t+s*s+r*r<=n)break;k=k+1|0;if((k|0)>=(j|0))break a}i=f;return k|0}while(0);e=(c[b+32>>2]|0)+12|0;c[e>>2]=(c[e>>2]|0)+1;e=c[b+88>>2]|0;if((e|0)==(c[b+92>>2]|0)?(h=(e|0)==0?1:e<<1,(e|0)<(h|0)):0){if(!h)j=0;else{c[5004]=(c[5004]|0)+1;j=fF((h<<4|3)+16|0)|0;if(!j)j=0;else{c[(j+19&-16)+ -4>>2]=j;j=j+19&-16}e=c[b+88>>2]|0}if((e|0)>0){k=0;do{q=j+(k<<4)|0;l=(c[b+96>>2]|0)+(k<<4)|0;c[q+0>>2]=c[l+0>>2];c[q+4>>2]=c[l+4>>2];c[q+8>>2]=c[l+8>>2];c[q+12>>2]=c[l+12>>2];k=k+1|0}while((k|0)!=(e|0))}e=c[b+96>>2]|0;if(e){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=j;c[b+92>>2]=h;e=c[b+88>>2]|0}q=(c[b+96>>2]|0)+(e<<4)|0;c[q+0>>2]=c[d+0>>2];c[q+4>>2]=c[d+4>>2];c[q+8>>2]=c[d+8>>2];c[q+12>>2]=c[d+12>>2];q=c[b+88>>2]|0;c[b+88>>2]=q+1;c[(c[b+32>>2]|0)+16>>2]=c[b+96>>2];i=f;return q|0}j=c[b+108>>2]|0;b:do if((j|0)>0&e){e=c[b+116>>2]|0;m=+g[d>>2];n=+g[d+4>>2];o=+g[d+8>>2];p=+g[b+168>>2];h=0;while(1){r=+g[e+(h<<2)>>2]-m;s=+g[e+(h+1<<2)>>2]-n;t=+g[e+(h+2<<2)>>2]-o;k=h+3|0;if(r*r+s*s+t*t<=p)break;if((k|0)<(j|0))h=k;else{h=d;break b}}q=(h|0)/3|0;i=f;return q|0}else h=d;while(0);e=c[b+112>>2]|0;if((j|0)==(e|0)){e=(j|0)==0?1:j<<1;if((j|0)<(e|0)){if(!e)k=0;else{c[5004]=(c[5004]|0)+1;j=fF((e<<2|3)+16|0)|0;if(!j)k=0;else{c[(j+19&-16)+ -4>>2]=j;k=j+19&-16}j=c[b+108>>2]|0}if((j|0)>0){l=0;do{q=k+(l<<2)|0;if(q)g[q>>2]=+g[(c[b+116>>2]|0)+(l<<2)>>2];l=l+1|0}while((l|0)!=(j|0))}l=c[b+116>>2]|0;if(l){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0);j=c[b+108>>2]|0}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=k;c[b+112>>2]=e;l=j}else{l=j;e=j}}else l=j;k=c[b+116>>2]|0;j=k+(l<<2)|0;if(j)g[j>>2]=+g[h>>2];j=l+1|0;c[b+108>>2]=j;if((j|0)==(e|0)){h=(e|0)==0?1:e<<1;if((e|0)<(h|0)){if(!h)k=0;else{c[5004]=(c[5004]|0)+1;j=fF((h<<2|3)+16|0)|0;if(!j)k=0;else{c[(j+19&-16)+ -4>>2]=j;k=j+19&-16}e=c[b+108>>2]|0}if((e|0)>0){j=0;do{l=k+(j<<2)|0;if(l)g[l>>2]=+g[(c[b+116>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(e|0))}j=c[b+116>>2]|0;if(j){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);e=c[b+108>>2]|0}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=k;c[b+112>>2]=h;j=e}else{j=e;h=e}}else h=e;e=k+(j<<2)|0;if(e)g[e>>2]=+g[d+4>>2];j=j+1|0;c[b+108>>2]=j;if((j|0)==(h|0)){j=(h|0)==0?1:h<<1;if((h|0)<(j|0)){if(!j)k=0;else{c[5004]=(c[5004]|0)+1;h=fF((j<<2|3)+16|0)|0;if(!h)k=0;else{c[(h+19&-16)+ -4>>2]=h;k=h+19&-16}h=c[b+108>>2]|0}if((h|0)>0){e=0;do{l=k+(e<<2)|0;if(l)g[l>>2]=+g[(c[b+116>>2]|0)+(e<<2)>>2];e=e+1|0}while((e|0)!=(h|0))}e=c[b+116>>2]|0;if(e){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);h=c[b+108>>2]|0}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=k;c[b+112>>2]=j}}else h=j;j=k+(h<<2)|0;if(j)g[j>>2]=+g[d+8>>2];c[b+108>>2]=h+1;q=c[b+32>>2]|0;c[q+12>>2]=(c[q+12>>2]|0)+1;c[q+16>>2]=k;q=((c[b+108>>2]|0)/3|0)+ -1|0;i=f;return q|0}function XB(b,d){b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0;e=i;if(a[b+165>>0]|0){if((c[b+92>>2]|0)>=(d|0)){i=e;return}if((d|0)!=0?(c[5004]=(c[5004]|0)+1,h=fF((d<<4|3)+16|0)|0,(h|0)!=0):0){c[(h+19&-16)+ -4>>2]=h;f=h+19&-16}else f=0;h=c[b+88>>2]|0;if((h|0)>0){j=0;do{k=f+(j<<4)|0;l=(c[b+96>>2]|0)+(j<<4)|0;c[k+0>>2]=c[l+0>>2];c[k+4>>2]=c[l+4>>2];c[k+8>>2]=c[l+8>>2];c[k+12>>2]=c[l+12>>2];j=j+1|0}while((j|0)!=(h|0))}h=c[b+96>>2]|0;if(h){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=f;c[b+92>>2]=d;i=e;return}if((c[b+112>>2]|0)>=(d|0)){i=e;return}if((d|0)!=0?(c[5004]=(c[5004]|0)+1,f=fF((d<<2|3)+16|0)|0,(f|0)!=0):0){c[(f+19&-16)+ -4>>2]=f;f=f+19&-16}else f=0;h=c[b+108>>2]|0;if((h|0)>0){k=0;do{j=f+(k<<2)|0;if(j)g[j>>2]=+g[(c[b+116>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(h|0))}h=c[b+116>>2]|0;if(h){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=f;c[b+112>>2]=d;i=e;return}function YB(d,e){d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0;f=i;if(!(a[d+164>>0]|0)){if((c[d+152>>2]|0)>=(e|0)){i=f;return}if((e|0)!=0?(c[5004]=(c[5004]|0)+1,h=fF((e<<1)+19|0)|0,(h|0)!=0):0){c[(h+19&-16)+ -4>>2]=h;g=h+19&-16}else g=0;h=c[d+148>>2]|0;if((h|0)>0){k=0;do{j=g+(k<<1)|0;if(j)b[j>>1]=b[(c[d+156>>2]|0)+(k<<1)>>1]|0;k=k+1|0}while((k|0)!=(h|0))}h=c[d+156>>2]|0;if(h){if(a[d+160>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[d+156>>2]=0}a[d+160>>0]=1;c[d+156>>2]=g;c[d+152>>2]=e;i=f;return}else{if((c[d+132>>2]|0)>=(e|0)){i=f;return}if((e|0)!=0?(c[5004]=(c[5004]|0)+1,g=fF((e<<2|3)+16|0)|0,(g|0)!=0):0){c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}else g=0;k=c[d+128>>2]|0;if((k|0)>0){j=0;do{h=g+(j<<2)|0;if(h)c[h>>2]=c[(c[d+136>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(k|0))}h=c[d+136>>2]|0;if(h){if(a[d+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[d+136>>2]=0}a[d+140>>0]=1;c[d+136>>2]=g;c[d+132>>2]=e;i=f;return}}function ZB(a){a=a|0;var b=0;b=i;dC(a);i=b;return}function _B(a){a=a|0;var b=0;b=i;dC(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function $B(a,b){a=a|0;b=b|0;return}function aC(a,b){a=a|0;b=b|0;return}function bC(a){a=a|0;return c[a+24>>2]|0}function cC(a){a=a|0;return 28}function dC(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=17304;e=c[b+156>>2]|0;if(e){if(a[b+160>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+156>>2]=0}a[b+160>>0]=1;c[b+156>>2]=0;c[b+148>>2]=0;c[b+152>>2]=0;e=c[b+136>>2]|0;if(e){if(a[b+140>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+136>>2]=0}a[b+140>>0]=1;c[b+136>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;e=c[b+116>>2]|0;if(e){if(a[b+120>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+116>>2]=0}a[b+120>>0]=1;c[b+116>>2]=0;c[b+108>>2]=0;c[b+112>>2]=0;e=c[b+96>>2]|0;if(e){if(a[b+100>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+96>>2]=0}a[b+100>>0]=1;c[b+96>>2]=0;c[b+88>>2]=0;c[b+92>>2]=0;c[b>>2]=19904;e=c[b+32>>2]|0;if(!e){a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;e=b+28|0;c[e>>2]=0;i=d;return}if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0;a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;e=b+28|0;c[e>>2]=0;i=d;return}function eC(a){a=a|0;var b=0;b=i;if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function fC(a){a=a|0;return}function gC(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0;f=i;q=(+g[a+32>>2]- +g[a+16>>2])*.5;n=(+g[a+36>>2]- +g[a+20>>2])*.5;k=(+g[a+40>>2]- +g[a+24>>2])*.5;p=+$b[c[(c[a>>2]|0)+48>>2]&15](a);m=+$b[c[(c[a>>2]|0)+48>>2]&15](a);k=k+ +$b[c[(c[a>>2]|0)+48>>2]&15](a);D=(+g[a+32>>2]+ +g[a+16>>2])*.5;B=(+g[a+36>>2]+ +g[a+20>>2])*.5;z=(+g[a+40>>2]+ +g[a+24>>2])*.5;H=+g[b>>2];y=+P(+H);G=+g[b+4>>2];x=+P(+G);v=+g[b+8>>2];w=+P(+v);F=+g[b+16>>2];u=+P(+F);E=+g[b+20>>2];t=+P(+E);r=+g[b+24>>2];s=+P(+r);C=+g[b+32>>2];o=+P(+C);A=+g[b+36>>2];l=+P(+A);h=+g[b+40>>2];j=+P(+h);v=D*H+B*G+z*v+ +g[b+48>>2];r=D*F+B*E+z*r+ +g[b+52>>2];h=D*C+B*A+z*h+ +g[b+56>>2];g[d>>2]=v-((q+p)*y+(n+m)*x+k*w);g[d+4>>2]=r-((q+p)*u+(n+m)*t+k*s);g[d+8>>2]=h-((q+p)*o+(n+m)*l+k*j);g[d+12>>2]=0.0;g[e>>2]=(q+p)*y+(n+m)*x+k*w+v;g[e+4>>2]=(q+p)*u+(n+m)*t+k*s+r;g[e+8>>2]=(q+p)*o+(n+m)*l+k*j+h;g[e+12>>2]=0.0;i=f;return}function hC(a,b){a=a|0;b=b|0;var d=0,e=0;d=i;i=i+48|0;e=(c[a+48>>2]|0)+4|0;c[e+0>>2]=c[b+0>>2];c[e+4>>2]=c[b+4>>2];c[e+8>>2]=c[b+8>>2];c[e+12>>2]=c[b+12>>2];c[d+32>>2]=0;c[d+36>>2]=0;c[d+40>>2]=0;c[d+44>>2]=0;g[d+32>>2]=1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d+16|0,a,d+32|0);g[a+32>>2]=+g[d+16>>2]+ +g[a+12>>2];g[d+32>>2]=-1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d,a,d+32|0);c[d+16>>2]=c[d+0>>2];c[d+20>>2]=c[d+4>>2];c[d+24>>2]=c[d+8>>2];c[d+28>>2]=c[d+12>>2];g[a+16>>2]=+g[d+16>>2]- +g[a+12>>2];c[d+32>>2]=0;c[d+36>>2]=0;c[d+40>>2]=0;c[d+44>>2]=0;g[d+36>>2]=1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d+16|0,a,d+32|0);g[a+36>>2]=+g[d+20>>2]+ +g[a+12>>2];g[d+36>>2]=-1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d,a,d+32|0);c[d+16>>2]=c[d+0>>2];c[d+20>>2]=c[d+4>>2];c[d+24>>2]=c[d+8>>2];c[d+28>>2]=c[d+12>>2];g[a+20>>2]=+g[d+20>>2]- +g[a+12>>2];c[d+32>>2]=0;c[d+36>>2]=0;c[d+40>>2]=0;c[d+44>>2]=0;g[d+40>>2]=1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d+16|0,a,d+32|0);g[a+40>>2]=+g[d+24>>2]+ +g[a+12>>2];g[d+40>>2]=-1.0;rc[c[(c[a>>2]|0)+68>>2]&127](d,a,d+32|0);c[d+16>>2]=c[d+0>>2];c[d+20>>2]=c[d+4>>2];c[d+24>>2]=c[d+8>>2];c[d+28>>2]=c[d+12>>2];g[a+24>>2]=+g[d+24>>2]- +g[a+12>>2];i=d;return}function iC(a){a=a|0;return(c[a+48>>2]|0)+4|0}function jC(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+48|0;c[f>>2]=17624;c[f+4>>2]=b;c[f+8>>2]=c[d+0>>2];c[f+12>>2]=c[d+4>>2];c[f+16>>2]=c[d+8>>2];c[f+20>>2]=c[d+12>>2];c[f+24>>2]=c[e+0>>2];c[f+28>>2]=c[e+4>>2];c[f+32>>2]=c[e+8>>2];c[f+36>>2]=c[e+12>>2];b=c[a+48>>2]|0;vc[c[(c[b>>2]|0)+8>>2]&127](b,f,d,e);i=f;return}function kC(a,b,d){a=a|0;b=+b;d=d|0;a=i;c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;i=a;return}function lC(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;i=i+176|0;c[e+160>>2]=0;c[e+164>>2]=0;c[e+168>>2]=0;c[e+172>>2]=0;c[e+136>>2]=0;c[e+140>>2]=0;c[e+144>>2]=0;c[e+148>>2]=0;c[e+152>>2]=0;c[e+32>>2]=17560;c[e+36>>2]=0;c[e+40>>2]=0;c[e+44>>2]=0;c[e+48>>2]=0;g[e+52>>2]=1.0;c[e+56>>2]=c[e+160>>2];c[e+60>>2]=c[e+164>>2];c[e+64>>2]=c[e+168>>2];c[e+68>>2]=0;g[e+72>>2]=1.0;c[e+76>>2]=0;c[e+80>>2]=0;c[e+84>>2]=0;c[e+88>>2]=0;g[e+92>>2]=1.0;g[e+96>>2]=0.0;c[e+100>>2]=c[e+140>>2];c[e+104>>2]=c[e+144>>2];c[e+108>>2]=c[e+148>>2];c[e+112>>2]=c[e+152>>2];g[e+116>>2]=-999999984306749400.0;l=+g[d>>2];k=+g[d+4>>2];j=+g[d+8>>2];h=l*+g[e+56>>2]+k+j*0.0;f=l*+g[e+60>>2]+k*0.0+j;g[e+120>>2]=l+k*0.0+j*0.0;g[e+124>>2]=h;g[e+128>>2]=f;g[e+132>>2]=0.0;g[e+16>>2]=999999984306749400.0;g[e+20>>2]=999999984306749400.0;g[e+24>>2]=999999984306749400.0;g[e+28>>2]=0.0;d=c[(c[b>>2]|0)+64>>2]|0;g[e>>2]=-999999984306749400.0;g[e+4>>2]=-999999984306749400.0;g[e+8>>2]=-999999984306749400.0;g[e+12>>2]=0.0;vc[d&127](b,e+32|0,e,e+16|0);c[a+0>>2]=c[e+36>>2];c[a+4>>2]=c[e+40>>2];c[a+8>>2]=c[e+44>>2];c[a+12>>2]=c[e+48>>2];i=e;return}function mC(a){a=a|0;return}function nC(a){a=a|0;return 17536}function oC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function pC(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,j=0.0,k=0.0,l=0.0;e=i;f=+g[a+88>>2];j=+g[a+92>>2];h=+g[a+96>>2];k=f*+g[b>>2]+j*+g[b+4>>2]+h*+g[b+8>>2];l=+g[a+84>>2];if(k>l){g[a+84>>2]=k;c[a+4>>2]=c[b+0>>2];c[a+8>>2]=c[b+4>>2];c[a+12>>2]=c[b+8>>2];c[a+16>>2]=c[b+12>>2]}else k=l;l=f*+g[b+16>>2]+j*+g[b+20>>2]+h*+g[b+24>>2];if(l>k){g[a+84>>2]=l;c[a+4>>2]=c[b+16>>2];c[a+8>>2]=c[b+20>>2];c[a+12>>2]=c[b+24>>2];c[a+16>>2]=c[b+28>>2];k=l}f=f*+g[b+32>>2]+j*+g[b+36>>2]+h*+g[b+40>>2];if(!(f>k)){i=e;return}g[a+84>>2]=f;c[a+4>>2]=c[b+32>>2];c[a+8>>2]=c[b+36>>2];c[a+12>>2]=c[b+40>>2];c[a+16>>2]=c[b+44>>2];i=e;return}function qC(a){a=a|0;return}function rC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function sC(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0.0,j=0.0,k=0.0,l=0.0,m=0;f=i;k=+g[b>>2];j=+g[b+16>>2];l=k<j?k:j;h=+g[b+32>>2];if((l<h?l:h)>+g[a+24>>2]){i=f;return}m=k>j?b:b+16|0;if(+g[(+g[m>>2]>h?m:b+32|0)>>2]<+g[a+8>>2]){i=f;return}h=+g[b+8>>2];j=+g[b+24>>2];l=h<j?h:j;k=+g[b+40>>2];if((l<k?l:k)>+g[a+32>>2]){i=f;return}m=h>j?b+8|0:b+24|0;if(+g[(+g[m>>2]>k?m:b+40|0)>>2]<+g[a+16>>2]){i=f;return}h=+g[b+4>>2];j=+g[b+20>>2];l=h<j?h:j;k=+g[b+36>>2];if((l<k?l:k)>+g[a+28>>2]){i=f;return}m=h>j?b+4|0:b+20|0;if(+g[(+g[m>>2]>k?m:b+36|0)>>2]<+g[a+12>>2]){i=f;return}m=c[a+4>>2]|0;vc[c[(c[m>>2]|0)+8>>2]&127](m,b,d,e);i=f;return}function tC(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0;e=i;while(1){f=c[a+12>>2]|0;g=c[f+(((b+d|0)/2|0)<<3)>>2]|0;k=b;h=d;while(1){while(1){l=k+1|0;if((c[f+(k<<3)>>2]|0)<(g|0))k=l;else{j=h;break}}while(1){m=f+(j<<3)|0;h=j+ -1|0;if((g|0)<(c[m>>2]|0))j=h;else break}if((k|0)>(j|0))h=j;else{k=f+(k<<3)|0;n=c[k>>2]|0;f=c[k+4>>2]|0;o=c[m+4>>2]|0;c[k>>2]=c[m>>2];c[k+4>>2]=o;k=(c[a+12>>2]|0)+(j<<3)|0;c[k>>2]=n;c[k+4>>2]=f;k=l}if((k|0)>(h|0))break;f=c[a+12>>2]|0}if((h|0)>(b|0))tC(a,b,h);if((k|0)<(d|0))b=k;else break}i=e;return}function uC(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0;e=i;h=c[b>>2]|0;if((h|0)>3){g=a[d>>0]|0;if(!(g&8)){c[b>>2]=h+ -1;f=b+(h+ -1<<4)+4|0;c[b+52>>2]=c[f+0>>2];c[b+56>>2]=c[f+4>>2];c[b+60>>2]=c[f+8>>2];c[b+64>>2]=c[f+12>>2];f=b+(h+ -1<<4)+84|0;c[b+132>>2]=c[f+0>>2];c[b+136>>2]=c[f+4>>2];c[b+140>>2]=c[f+8>>2];c[b+144>>2]=c[f+12>>2];f=b+(h+ -1<<4)+164|0;c[b+212>>2]=c[f+0>>2];c[b+216>>2]=c[f+4>>2];c[b+220>>2]=c[f+8>>2];c[b+224>>2]=c[f+12>>2];h=h+ -1|0;f=4}else f=6}else f=4;if((f|0)==4)if((h|0)>2){g=a[d>>0]|0;f=6}else g=h;if((f|0)==6)if(!(g&4)){g=h+ -1|0;c[b>>2]=g;c[b+36>>2]=c[b+(g<<4)+4>>2];c[b+40>>2]=c[b+(g<<4)+8>>2];c[b+44>>2]=c[b+(g<<4)+12>>2];c[b+48>>2]=c[b+(g<<4)+16>>2];c[b+116>>2]=c[b+(g<<4)+84>>2];c[b+120>>2]=c[b+(g<<4)+88>>2];c[b+124>>2]=c[b+(g<<4)+92>>2];c[b+128>>2]=c[b+(g<<4)+96>>2];c[b+196>>2]=c[b+(g<<4)+164>>2];c[b+200>>2]=c[b+(g<<4)+168>>2];c[b+204>>2]=c[b+(g<<4)+172>>2];c[b+208>>2]=c[b+(g<<4)+176>>2]}else g=h;if((g|0)>1){h=a[d>>0]|0;if(!(h&2)){g=g+ -1|0;c[b>>2]=g;c[b+20>>2]=c[b+(g<<4)+4>>2];c[b+24>>2]=c[b+(g<<4)+8>>2];c[b+28>>2]=c[b+(g<<4)+12>>2];c[b+32>>2]=c[b+(g<<4)+16>>2];c[b+100>>2]=c[b+(g<<4)+84>>2];c[b+104>>2]=c[b+(g<<4)+88>>2];c[b+108>>2]=c[b+(g<<4)+92>>2];c[b+112>>2]=c[b+(g<<4)+96>>2];c[b+180>>2]=c[b+(g<<4)+164>>2];c[b+184>>2]=c[b+(g<<4)+168>>2];c[b+188>>2]=c[b+(g<<4)+172>>2];c[b+192>>2]=c[b+(g<<4)+176>>2];f=11}else d=h}else f=11;do if((f|0)==11)if((g|0)>0){d=a[d>>0]|0;break}else{i=e;return}while(0);if(d&1){i=e;return}h=g+ -1|0;c[b>>2]=h;c[b+4>>2]=c[b+(h<<4)+4>>2];c[b+8>>2]=c[b+(h<<4)+8>>2];c[b+12>>2]=c[b+(h<<4)+12>>2];c[b+16>>2]=c[b+(h<<4)+16>>2];c[b+84>>2]=c[b+(h<<4)+84>>2];c[b+88>>2]=c[b+(h<<4)+88>>2];c[b+92>>2]=c[b+(h<<4)+92>>2];c[b+96>>2]=c[b+(h<<4)+96>>2];c[b+164>>2]=c[b+(h<<4)+164>>2];c[b+168>>2]=c[b+(h<<4)+168>>2];c[b+172>>2]=c[b+(h<<4)+172>>2];c[b+176>>2]=c[b+(h<<4)+176>>2];i=e;return}function vC(b){b=b|0;var d=0,e=0.0,f=0.0,h=0.0,j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0,K=0.0,L=0.0,M=0,N=0,O=0.0,P=0.0,Q=0.0,R=0.0,S=0,T=0;d=i;i=i+80|0;if(!(a[b+356>>0]|0)){T=a[b+312>>0]|0;T=T<<24>>24!=0;i=d;return T|0}c[b+336>>2]=0;c[b+340>>2]=0;c[b+344>>2]=0;c[b+348>>2]=0;a[b+352>>0]=0;J=a[b+332>>0]|0;a[b+332>>0]=J&-16;a[b+356>>0]=0;switch(c[b>>2]|0){case 1:{c[b+244>>2]=c[b+84>>2];c[b+248>>2]=c[b+88>>2];c[b+252>>2]=c[b+92>>2];c[b+256>>2]=c[b+96>>2];c[b+260>>2]=c[b+164>>2];c[b+264>>2]=c[b+168>>2];c[b+268>>2]=c[b+172>>2];c[b+272>>2]=c[b+176>>2];Q=+g[b+248>>2]- +g[b+264>>2];R=+g[b+252>>2]- +g[b+268>>2];g[b+276>>2]=+g[b+244>>2]- +g[b+260>>2];g[b+280>>2]=Q;g[b+284>>2]=R;g[b+288>>2]=0.0;c[b+336>>2]=0;c[b+340>>2]=0;c[b+344>>2]=0;c[b+348>>2]=0;a[b+352>>0]=0;a[b+332>>0]=J&-16;g[b+336>>2]=1.0;g[b+340>>2]=0.0;g[b+344>>2]=0.0;g[b+348>>2]=0.0;a[b+312>>0]=1;T=1;T=T<<24>>24!=0;i=d;return T|0};case 4:{c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;j=d+48|0;a[j>>0]=0;c[b+316>>2]=c[d+0>>2];c[b+320>>2]=c[d+4>>2];c[b+324>>2]=c[d+8>>2];c[b+328>>2]=c[d+12>>2];a[b+332>>0]=J|15;G=+g[b+20>>2];P=+g[b+4>>2];C=+g[b+24>>2];Q=+g[b+8>>2];E=+g[b+28>>2];O=+g[b+12>>2];F=+g[b+36>>2];L=+g[b+40>>2];I=+g[b+44>>2];H=+g[b+52>>2];K=+g[b+56>>2];D=+g[b+60>>2];R=(H-P)*((C-Q)*(I-O)-(E-O)*(L-Q))+(K-Q)*((E-O)*(F-P)-(G-P)*(I-O))+((G-P)*(L-Q)-(C-Q)*(F-P))*(D-O);if(R*R<9.99999905104687e-9)N=-1;else N=R*(((E-O)*(F-P)-(G-P)*(I-O))*(0.0-Q)+((C-Q)*(I-O)-(E-O)*(L-Q))*(0.0-P)+((G-P)*(L-Q)-(C-Q)*(F-P))*(0.0-O))<0.0&1;R=(G-P)*((L-Q)*(D-O)-(I-O)*(K-Q))+(C-Q)*((I-O)*(H-P)-(F-P)*(D-O))+((F-P)*(K-Q)-(L-Q)*(H-P))*(E-O);if(R*R<9.99999905104687e-9)M=-1;else M=R*(((I-O)*(H-P)-(F-P)*(D-O))*(0.0-Q)+((L-Q)*(D-O)-(I-O)*(K-Q))*(0.0-P)+((F-P)*(K-Q)-(L-Q)*(H-P))*(0.0-O))<0.0&1;R=(F-P)*((K-Q)*(E-O)-(D-O)*(C-Q))+(L-Q)*((D-O)*(G-P)-(H-P)*(E-O))+((H-P)*(C-Q)-(K-Q)*(G-P))*(I-O);if(R*R<9.99999905104687e-9)J=-1;else J=R*(((D-O)*(G-P)-(H-P)*(E-O))*(0.0-Q)+((K-Q)*(E-O)-(D-O)*(C-Q))*(0.0-P)+((H-P)*(C-Q)-(K-Q)*(G-P))*(0.0-O))<0.0&1;O=(P-G)*((K-C)*(I-E)-(D-E)*(L-C))+(Q-C)*((D-E)*(F-G)-(H-G)*(I-E))+((H-G)*(L-C)-(K-C)*(F-G))*(O-E);if(O*O<9.99999905104687e-9)S=-1;else S=O*(((D-E)*(F-G)-(H-G)*(I-E))*(0.0-C)+((K-C)*(I-E)-(D-E)*(L-C))*(0.0-G)+((H-G)*(L-C)-(K-C)*(F-G))*(0.0-E))<0.0&1;if((M|N|J|S|0)<0){a[b+352>>0]=1;a[b+312>>0]=0;T=0;T=T<<24>>24!=0;i=d;return T|0}T=(N|0)!=0;N=(M|0)==0;J=(J|0)==0;M=(S|0)==0;if(N&(T^1)&J&M){a[b+312>>0]=1;c[b+276>>2]=0;c[b+280>>2]=0;c[b+284>>2]=0;c[b+288>>2]=0;T=1;T=T<<24>>24!=0;i=d;return T|0}if(T?(wC(d,b+4|0,b+20|0,b+36|0,d+32|0),B=+g[d+32>>2],w=+g[d+36>>2],x=+g[d+40>>2],y=B- +g[d>>2],z=w- +g[d+4>>2],A=x- +g[d+8>>2],y*y+z*z+A*A<3.4028234663852886e+38):0){R=+g[d+44>>2];g[b+316>>2]=B;g[b+320>>2]=w;g[b+324>>2]=x;g[b+328>>2]=R;T=a[j>>0]|0;a[b+332>>0]=T&1|a[b+332>>0]&-16|T&2|T&4;R=+g[d+56>>2];w=+g[d+60>>2];g[b+336>>2]=+g[d+52>>2];g[b+340>>2]=R;g[b+344>>2]=w;g[b+348>>2]=0.0;w=y*y+z*z+A*A}else w=3.4028234663852886e+38;if(!N?(wC(d,b+4|0,b+36|0,b+52|0,d+32|0),r=+g[d+32>>2],u=+g[d+36>>2],q=+g[d+40>>2],v=r- +g[d>>2],s=u- +g[d+4>>2],t=q- +g[d+8>>2],v*v+s*s+t*t<w):0){R=+g[d+44>>2];g[b+316>>2]=r;g[b+320>>2]=u;g[b+324>>2]=q;g[b+328>>2]=R;T=a[j>>0]|0;a[b+332>>0]=T<<1&4|(T&1|a[b+332>>0]&-16)|T<<1&8;R=+g[d+56>>2];w=+g[d+60>>2];g[b+336>>2]=+g[d+52>>2];g[b+340>>2]=0.0;g[b+344>>2]=R;g[b+348>>2]=w;w=v*v+s*s+t*t}if(!J?(wC(d,b+4|0,b+52|0,b+20|0,d+32|0),k=+g[d+32>>2],l=+g[d+36>>2],m=+g[d+40>>2],n=k- +g[d>>2],o=l- +g[d+4>>2],p=m- +g[d+8>>2],n*n+o*o+p*p<w):0){R=+g[d+44>>2];g[b+316>>2]=k;g[b+320>>2]=l;g[b+324>>2]=m;g[b+328>>2]=R;T=a[j>>0]|0;a[b+332>>0]=(T&255)>>>1&2|(T&1|a[b+332>>0]&-16)|T<<2&8;R=+g[d+60>>2];w=+g[d+56>>2];g[b+336>>2]=+g[d+52>>2];g[b+340>>2]=R;g[b+344>>2]=0.0;g[b+348>>2]=w;w=n*n+o*o+p*p}if(!M?(wC(d,b+20|0,b+52|0,b+36|0,d+32|0),f=+g[d+32>>2],e=+g[d+36>>2],h=+g[d+40>>2],P=f- +g[d>>2],Q=e- +g[d+4>>2],R=h- +g[d+8>>2],P*P+Q*Q+R*R<w):0){P=+g[d+44>>2];g[b+316>>2]=f;g[b+320>>2]=e;g[b+324>>2]=h;g[b+328>>2]=P;T=a[j>>0]|0;a[b+332>>0]=T<<1&2|a[b+332>>0]&-16|T&4|T<<2&8;P=+g[d+52>>2];Q=+g[d+60>>2];R=+g[d+56>>2];g[b+336>>2]=0.0;g[b+340>>2]=P;g[b+344>>2]=Q;g[b+348>>2]=R}G=+g[b+336>>2];H=+g[b+340>>2];I=+g[b+344>>2];R=+g[b+348>>2];K=+g[b+84>>2]*G+ +g[b+100>>2]*H+ +g[b+116>>2]*I+ +g[b+132>>2]*R;O=G*+g[b+88>>2]+H*+g[b+104>>2]+I*+g[b+120>>2]+R*+g[b+136>>2];Q=G*+g[b+92>>2]+H*+g[b+108>>2]+I*+g[b+124>>2]+R*+g[b+140>>2];g[b+244>>2]=K;g[b+248>>2]=O;g[b+252>>2]=Q;g[b+256>>2]=0.0;L=+g[b+164>>2]*G+ +g[b+180>>2]*H+ +g[b+196>>2]*I+ +g[b+212>>2]*R;P=G*+g[b+168>>2]+H*+g[b+184>>2]+I*+g[b+200>>2]+R*+g[b+216>>2];R=G*+g[b+172>>2]+H*+g[b+188>>2]+I*+g[b+204>>2]+R*+g[b+220>>2];g[b+260>>2]=L;g[b+264>>2]=P;g[b+268>>2]=R;g[b+272>>2]=0.0;g[b+276>>2]=K-L;g[b+280>>2]=O-P;g[b+284>>2]=Q-R;g[b+288>>2]=0.0;uC(b,b+332|0);if((+g[b+336>>2]>=0.0?+g[b+340>>2]>=0.0:0)?+g[b+344>>2]>=0.0:0)j=+g[b+348>>2]>=0.0&1;else j=0;a[b+312>>0]=j;T=j;T=T<<24>>24!=0;i=d;return T|0};case 2:{k=+g[b+4>>2];f=+g[b+8>>2];m=+g[b+12>>2];e=+g[b+20>>2]-k;h=+g[b+24>>2]-f;l=+g[b+28>>2]-m;do if((0.0-k)*e+(0.0-f)*h+(0.0-m)*l>0.0)if((0.0-k)*e+(0.0-f)*h+(0.0-m)*l<e*e+h*h+l*l){a[b+332>>0]=J&-16|3;e=((0.0-k)*e+(0.0-f)*h+(0.0-m)*l)/(e*e+h*h+l*l);break}else{a[b+332>>0]=J&-16|2;e=1.0;break}else{a[b+332>>0]=J&-16|1;e=0.0}while(0);g[b+336>>2]=1.0-e;g[b+340>>2]=e;g[b+344>>2]=0.0;g[b+348>>2]=0.0;K=+g[b+84>>2];O=+g[b+88>>2];Q=+g[b+92>>2];K=K+e*(+g[b+100>>2]-K);O=O+e*(+g[b+104>>2]-O);Q=Q+e*(+g[b+108>>2]-Q);g[b+244>>2]=K;g[b+248>>2]=O;g[b+252>>2]=Q;g[b+256>>2]=0.0;L=+g[b+164>>2];P=+g[b+168>>2];R=+g[b+172>>2];L=L+e*(+g[b+180>>2]-L);P=P+e*(+g[b+184>>2]-P);R=R+e*(+g[b+188>>2]-R);g[b+260>>2]=L;g[b+264>>2]=P;g[b+268>>2]=R;g[b+272>>2]=0.0;g[b+276>>2]=K-L;g[b+280>>2]=O-P;g[b+284>>2]=Q-R;g[b+288>>2]=0.0;uC(b,b+332|0);if((+g[b+336>>2]>=0.0?+g[b+340>>2]>=0.0:0)?+g[b+344>>2]>=0.0:0)j=+g[b+348>>2]>=0.0&1;else j=0;a[b+312>>0]=j;T=j;T=T<<24>>24!=0;i=d;return T|0};case 0:{a[b+312>>0]=0;T=0;T=T<<24>>24!=0;i=d;return T|0};case 3:{c[d+16>>2]=0;c[d+20>>2]=0;c[d+24>>2]=0;c[d+28>>2]=0;wC(d+16|0,b+4|0,b+20|0,b+36|0,b+316|0);H=+g[b+336>>2];I=+g[b+340>>2];R=+g[b+344>>2];K=+g[b+84>>2]*H+ +g[b+100>>2]*I+ +g[b+116>>2]*R;O=H*+g[b+88>>2]+I*+g[b+104>>2]+R*+g[b+120>>2];Q=H*+g[b+92>>2]+I*+g[b+108>>2]+R*+g[b+124>>2];g[b+244>>2]=K;g[b+248>>2]=O;g[b+252>>2]=Q;g[b+256>>2]=0.0;L=+g[b+164>>2]*H+ +g[b+180>>2]*I+ +g[b+196>>2]*R;P=H*+g[b+168>>2]+I*+g[b+184>>2]+R*+g[b+200>>2];R=H*+g[b+172>>2]+I*+g[b+188>>2]+R*+g[b+204>>2];g[b+260>>2]=L;g[b+264>>2]=P;g[b+268>>2]=R;g[b+272>>2]=0.0;g[b+276>>2]=K-L;g[b+280>>2]=O-P;g[b+284>>2]=Q-R;g[b+288>>2]=0.0;uC(b,b+332|0);if((+g[b+336>>2]>=0.0?+g[b+340>>2]>=0.0:0)?+g[b+344>>2]>=0.0:0)j=+g[b+348>>2]>=0.0&1;else j=0;a[b+312>>0]=j;T=j;T=T<<24>>24!=0;i=d;return T|0};default:{a[b+312>>0]=0;T=0;T=T<<24>>24!=0;i=d;return T|0}}return 0}function wC(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0,p=0.0,q=0.0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0;r=i;o=a[h+16>>0]&-16;a[h+16>>0]=o;l=+g[e>>2];k=+g[d>>2];n=+g[e+4>>2];m=+g[d+4>>2];p=+g[e+8>>2];j=+g[d+8>>2];q=+g[f>>2];s=+g[f+4>>2];t=+g[f+8>>2];u=+g[b>>2];v=+g[b+4>>2];y=+g[b+8>>2];w=(l-k)*(u-k)+(n-m)*(v-m)+(p-j)*(y-j);x=(q-k)*(u-k)+(s-m)*(v-m)+(t-j)*(y-j);if(!(!(w<=0.0)|!(x<=0.0))){c[h+0>>2]=c[d+0>>2];c[h+4>>2]=c[d+4>>2];c[h+8>>2]=c[d+8>>2];c[h+12>>2]=c[d+12>>2];a[h+16>>0]=o|1;g[h+20>>2]=1.0;g[h+24>>2]=0.0;g[h+28>>2]=0.0;g[h+32>>2]=0.0;i=r;return}z=(l-k)*(u-l)+(n-m)*(v-n)+(p-j)*(y-p);A=(q-k)*(u-l)+(s-m)*(v-n)+(t-j)*(y-p);if(!(!(z>=0.0)|!(A<=z))){c[h+0>>2]=c[e+0>>2];c[h+4>>2]=c[e+4>>2];c[h+8>>2]=c[e+8>>2];c[h+12>>2]=c[e+12>>2];a[h+16>>0]=o|2;g[h+20>>2]=0.0;g[h+24>>2]=1.0;g[h+28>>2]=0.0;g[h+32>>2]=0.0;i=r;return}if(!((w>=0.0?!(w*A-z*x<=0.0):1)|!(z<=0.0))){g[h>>2]=k+(l-k)*(w/(w-z));g[h+4>>2]=m+(n-m)*(w/(w-z));g[h+8>>2]=j+(p-j)*(w/(w-z));g[h+12>>2]=0.0;a[h+16>>0]=o|3;g[h+20>>2]=1.0-w/(w-z);g[h+24>>2]=w/(w-z);g[h+28>>2]=0.0;g[h+32>>2]=0.0;i=r;return}B=(l-k)*(u-q)+(n-m)*(v-s)+(p-j)*(y-t);u=(q-k)*(u-q)+(s-m)*(v-s)+(t-j)*(y-t);if(!(!(u>=0.0)|!(B<=u))){c[h+0>>2]=c[f+0>>2];c[h+4>>2]=c[f+4>>2];c[h+8>>2]=c[f+8>>2];c[h+12>>2]=c[f+12>>2];a[h+16>>0]=o|4;g[h+20>>2]=0.0;g[h+24>>2]=0.0;g[h+28>>2]=1.0;g[h+32>>2]=0.0;i=r;return}if(!((x>=0.0?!(B*x-w*u<=0.0):1)|!(u<=0.0))){g[h>>2]=k+(q-k)*(x/(x-u));g[h+4>>2]=m+(s-m)*(x/(x-u));g[h+8>>2]=j+(t-j)*(x/(x-u));g[h+12>>2]=0.0;a[h+16>>0]=o|5;g[h+20>>2]=1.0-x/(x-u);g[h+24>>2]=0.0;g[h+28>>2]=x/(x-u);g[h+32>>2]=0.0;i=r;return}if((z*u-B*A<=0.0?A-z>=0.0:0)?B-u>=0.0:0){B=(A-z)/(A-z+(B-u));g[h>>2]=l+(q-l)*B;g[h+4>>2]=n+(s-n)*B;g[h+8>>2]=p+(t-p)*B;g[h+12>>2]=0.0;a[h+16>>0]=o|6;g[h+20>>2]=0.0;g[h+24>>2]=1.0-B;g[h+28>>2]=B;g[h+32>>2]=0.0;i=r;return}v=1.0/(w*A-z*x+(z*u-B*A+(B*x-w*u)));y=(B*x-w*u)*v;B=(w*A-z*x)*v;g[h>>2]=(q-k)*B+(k+(l-k)*y);g[h+4>>2]=(s-m)*B+(m+(n-m)*y);g[h+8>>2]=(t-j)*B+((p-j)*y+j);g[h+12>>2]=0.0;a[h+16>>0]=o|7;g[h+20>>2]=1.0-y-B;g[h+24>>2]=y;g[h+28>>2]=B;g[h+32>>2]=0.0;i=r;return}function xC(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0,r=0.0,s=0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0;e=i;i=i+96|0;p=+g[b+48>>2]- +g[b+112>>2];j=+g[b+52>>2]- +g[b+116>>2];k=+g[b+56>>2]- +g[b+120>>2];n=p*+g[b+64>>2]+j*+g[b+80>>2]+k*+g[b+96>>2];m=p*+g[b+68>>2]+j*+g[b+84>>2]+k*+g[b+100>>2];k=p*+g[b+72>>2]+j*+g[b+88>>2]+k*+g[b+104>>2];q=c[a+8>>2]|0;s=c[a+4>>2]|0;j=+g[s+28>>2]*+g[s+12>>2];p=j+ +g[a+12>>2];w=+g[q+72>>2];u=+g[q+56>>2];t=+g[q+76>>2];B=+g[q+60>>2];v=+g[q+80>>2];x=+g[q+64>>2];y=+g[q+88>>2];z=+g[q+92>>2];A=+g[q+96>>2];C=(t-B)*(A-x)-(v-x)*(z-B);l=(v-x)*(y-u)-(w-u)*(A-x);h=(w-u)*(z-B)-(t-B)*(y-u);o=1.0/+Q(+(h*h+(C*C+l*l)));r=(n-u)*o*C+o*l*(m-B)+o*h*(k-x);if(r<0.0){r=r*-1.0;h=o*h*-1.0;l=o*l*-1.0;o=o*C*-1.0}else{h=o*h;l=o*l;o=o*C}if(!(r<p)){i=e;return}C=(k-x)*((w-u)*l-(t-B)*o)+((n-u)*((t-B)*h-(v-x)*l)+(m-B)*((v-x)*o-(w-u)*h));D=(k-v)*((y-w)*l-(z-t)*o)+((n-w)*((z-t)*h-(A-v)*l)+(m-t)*((A-v)*o-(y-w)*h));E=(k-A)*((u-y)*l-(B-z)*o)+((n-y)*((B-z)*h-(x-A)*l)+(m-z)*((x-A)*o-(u-y)*h));if(!(C>0.0&D>0.0&E>0.0)?!(C<=0.0)|!(D<=0.0)|!(E<=0.0):0){if((Pb[c[(c[q>>2]|0)+100>>2]&127](q)|0)<=0){i=e;return}r=0.0;t=0.0;y=0.0;s=0;q=0;do{F=c[a+8>>2]|0;vc[c[(c[F>>2]|0)+104>>2]&127](F,q,e+80|0,e+64|0);w=+g[e+80>>2];z=+g[e+84>>2];D=+g[e+88>>2];v=+g[e+64>>2]-w;x=+g[e+68>>2]-z;E=+g[e+72>>2]-D;do if((n-w)*v+(m-z)*x+(k-D)*E>0.0)if((n-w)*v+(m-z)*x+(k-D)*E<v*v+x*x+E*E){u=((n-w)*v+(m-z)*x+(k-D)*E)/(v*v+x*x+E*E);A=n-w-v*u;B=m-z-x*u;C=k-D-E*u;break}else{A=n-w-v;B=m-z-x;C=k-D-E;u=1.0;break}else{A=n-w;B=m-z;C=k-D;u=0.0}while(0);if(C*C+(B*B+A*A)<p*p){y=D+E*u;t=z+x*u;r=w+v*u;s=1}q=q+1|0;F=c[a+8>>2]|0}while((q|0)<(Pb[c[(c[F>>2]|0)+100>>2]&127](F)|0));if(!(s&1)){i=e;return}else{u=p*p;p=r}}else{u=p*p;p=n-o*r;t=m-l*r;y=k-h*r}n=n-p;m=m-t;k=k-y;if(!(n*n+m*m+k*k<u)){i=e;return}if(n*n+m*m+k*k>1.1920928955078125e-7){h=+Q(+(n*n+m*m+k*k));j=j-h;o=n*(1.0/h);l=m*(1.0/h);h=k*(1.0/h)}j=-j;if(f){z=+g[b+64>>2];A=+g[b+68>>2];B=+g[b+72>>2];C=z*o+A*l+B*h;n=+g[b+80>>2];r=+g[b+84>>2];u=+g[b+88>>2];D=o*n+l*r+h*u;v=+g[b+96>>2];w=+g[b+100>>2];x=+g[b+104>>2];E=o*v+l*w+h*x;g[e+48>>2]=-C;g[e+52>>2]=-D;g[e+56>>2]=-E;g[e+60>>2]=0.0;D=p*n+t*r+y*u+ +g[b+116>>2]+D*j;E=p*v+t*w+y*x+ +g[b+120>>2]+E*j;g[e+32>>2]=p*z+t*A+y*B+ +g[b+112>>2]+C*j;g[e+36>>2]=D;g[e+40>>2]=E;g[e+44>>2]=0.0;qc[c[(c[d>>2]|0)+16>>2]&15](d,e+48|0,e+32|0,j);i=e;return}else{F=c[(c[d>>2]|0)+16>>2]|0;A=+g[b+64>>2];B=+g[b+68>>2];C=+g[b+72>>2];v=+g[b+80>>2];w=+g[b+84>>2];D=+g[b+88>>2];x=+g[b+96>>2];z=+g[b+100>>2];E=+g[b+104>>2];g[e+16>>2]=A*o+B*l+C*h;g[e+20>>2]=o*v+l*w+h*D;g[e+24>>2]=o*x+l*z+h*E;g[e+28>>2]=0.0;D=p*v+t*w+y*D+ +g[b+116>>2];E=p*x+t*z+y*E+ +g[b+120>>2];g[e>>2]=p*A+t*B+y*C+ +g[b+112>>2];g[e+4>>2]=D;g[e+8>>2]=E;g[e+12>>2]=0.0;qc[F&15](d,e+16|0,e,j);i=e;return}}function yC(a){a=a|0;return}function zC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function AC(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=17896;if((a[b+8>>0]|0)!=0?(e=c[b+12>>2]|0,(e|0)!=0):0){f=c[b+4>>2]|0;Nb[c[(c[f>>2]|0)+16>>2]&127](f,e)}gF(b);i=d;return}function BC(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=17896;if(!(a[b+8>>0]|0)){i=d;return}e=c[b+12>>2]|0;if(!e){i=d;return}b=c[b+4>>2]|0;Nb[c[(c[b>>2]|0)+16>>2]&127](b,e);i=d;return}function CC(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0;j=i;i=i+144|0;k=c[b+12>>2]|0;if(!k){i=j;return}m=c[d+4>>2]|0;l=c[e+4>>2]|0;c[h+4>>2]=k;g[j+140>>2]=999999984306749400.0;k=c[d+12>>2]|0;c[j+12>>2]=c[k+0>>2];c[j+16>>2]=c[k+4>>2];c[j+20>>2]=c[k+8>>2];c[j+24>>2]=c[k+12>>2];c[j+28>>2]=c[k+16>>2];c[j+32>>2]=c[k+20>>2];c[j+36>>2]=c[k+24>>2];c[j+40>>2]=c[k+28>>2];c[j+44>>2]=c[k+32>>2];c[j+48>>2]=c[k+36>>2];c[j+52>>2]=c[k+40>>2];c[j+56>>2]=c[k+44>>2];c[j+60>>2]=c[k+48>>2];c[j+64>>2]=c[k+52>>2];c[j+68>>2]=c[k+56>>2];c[j+72>>2]=c[k+60>>2];e=c[e+12>>2]|0;c[j+76>>2]=c[e+0>>2];c[j+80>>2]=c[e+4>>2];c[j+84>>2]=c[e+8>>2];c[j+88>>2]=c[e+12>>2];c[j+92>>2]=c[e+16>>2];c[j+96>>2]=c[e+20>>2];c[j+100>>2]=c[e+24>>2];c[j+104>>2]=c[e+28>>2];c[j+108>>2]=c[e+32>>2];c[j+112>>2]=c[e+36>>2];c[j+116>>2]=c[e+40>>2];c[j+120>>2]=c[e+44>>2];c[j+124>>2]=c[e+48>>2];c[j+128>>2]=c[e+52>>2];c[j+132>>2]=c[e+56>>2];c[j+136>>2]=c[e+60>>2];c[j>>2]=17976;c[j+4>>2]=m;c[j+8>>2]=l;FC(j,j+12|0,h,c[f+20>>2]|0,0);if(!(a[b+8>>0]|0)){i=j;return}d=c[h+4>>2]|0;if(!(c[d+748>>2]|0)){i=j;return}k=c[d+740>>2]|0;e=c[(c[h+8>>2]|0)+8>>2]|0;if((k|0)==(e|0)){xA(d,k+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=j;return}else{xA(d,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,e+4|0);i=j;return}}function DC(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 1.0}function EC(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+12>>2]|0)){i=e;return}if(!(a[b+8>>0]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+12>>2];c[d+4>>2]=h+1;i=e;return}function FC(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0,X=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0.0,ca=0.0,da=0.0,ea=0.0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=0,la=0,ma=0.0,na=0.0,oa=0.0,pa=0,qa=0.0,ra=0.0,sa=0,ta=0,ua=0,va=0.0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0,Da=0;e=i;i=i+656|0;g[e+48>>2]=+g[b>>2];g[e>>2]=+g[b+64>>2];f=e+52|0;g[f>>2]=+g[b+4>>2];g[e+4>>2]=+g[b+68>>2];g[e+56>>2]=+g[b+8>>2];g[e+8>>2]=+g[b+72>>2];g[e+64>>2]=+g[b+16>>2];g[e+16>>2]=+g[b+80>>2];g[e+68>>2]=+g[b+20>>2];g[e+20>>2]=+g[b+84>>2];g[e+72>>2]=+g[b+24>>2];g[e+24>>2]=+g[b+88>>2];g[e+80>>2]=+g[b+32>>2];g[e+32>>2]=+g[b+96>>2];g[e+84>>2]=+g[b+36>>2];g[e+36>>2]=+g[b+100>>2];g[e+88>>2]=+g[b+40>>2];g[e+40>>2]=+g[b+104>>2];Da=c[a+4>>2]|0;A=+g[Da+28>>2];B=+g[Da+32>>2];E=+g[Da+36>>2];C=+$b[c[(c[Da>>2]|0)+48>>2]&15](Da);D=+$b[c[(c[Da>>2]|0)+48>>2]&15](Da);E=(E+ +$b[c[(c[Da>>2]|0)+48>>2]&15](Da))*2.0;Da=c[a+8>>2]|0;w=+g[Da+28>>2];y=+g[Da+32>>2];q=+g[Da+36>>2];v=+$b[c[(c[Da>>2]|0)+48>>2]&15](Da);x=+$b[c[(c[Da>>2]|0)+48>>2]&15](Da);q=(q+ +$b[c[(c[Da>>2]|0)+48>>2]&15](Da))*2.0;R=+g[b+112>>2]- +g[b+48>>2];S=+g[b+116>>2]- +g[b+52>>2];O=+g[b+120>>2]- +g[b+56>>2];k=+g[e+48>>2];j=+g[e+64>>2];h=+g[e+80>>2];I=+g[f>>2];J=+g[e+68>>2];H=+g[e+84>>2];G=+g[e+56>>2];F=+g[e+72>>2];z=+g[e+88>>2];g[e+548>>2]=(A+C)*2.0*.5;g[e+552>>2]=(B+D)*2.0*.5;g[e+556>>2]=E*.5;g[e+536>>2]=(w+v)*2.0*.5;g[e+540>>2]=(y+x)*2.0*.5;g[e+544>>2]=q*.5;p=+g[e>>2];u=+g[e+16>>2];r=+g[e+32>>2];o=+g[e+4>>2];t=+g[e+20>>2];s=+g[e+36>>2];n=+g[e+8>>2];m=+g[e+24>>2];l=+g[e+40>>2];X=+P(+(k*p+j*u+h*r));T=+P(+(k*o+j*t+h*s));K=+P(+(k*n+j*m+h*l));Z=+P(+(p*I+u*J+r*H));V=+P(+(o*I+t*J+s*H));N=+P(+(n*I+m*J+l*H));L=+P(+(p*G+u*F+r*z));M=+P(+(o*G+t*F+s*z));U=+P(+(n*G+m*F+l*z));$=+P(+(R*k+S*j+O*h))-(q*.5*K+((A+C)*2.0*.5+X*(w+v)*2.0*.5+T*(y+x)*2.0*.5));if($>0.0){i=e;return}if($>-3.4028234663852886e+38){ga=1;W=R*k+S*j+O*h<0.0&1;a=e+48|0}else{ga=0;W=0;a=0;$=-3.4028234663852886e+38}_=+P(+(R*I+S*J+O*H))-((B+D)*2.0*.5+Z*(w+v)*2.0*.5+V*(y+x)*2.0*.5+N*q*.5);if(_>0.0){i=e;return}if(_>$){ga=2;W=R*I+S*J+O*H<0.0&1;a=f}else _=$;$=+P(+(R*G+S*F+O*z))-(E*.5+L*(w+v)*2.0*.5+M*(y+x)*2.0*.5+U*q*.5);if($>0.0){i=e;return}if($>_){ga=3;W=R*G+S*F+O*z<0.0&1;a=e+56|0;_=$}$=+P(+(R*p+S*u+O*r))-((w+v)*2.0*.5+(X*(A+C)*2.0*.5+Z*(B+D)*2.0*.5+L*E*.5));if($>0.0){i=e;return}if($>_){ga=4;W=R*p+S*u+O*r<0.0&1;a=e;_=$}$=+P(+(R*o+S*t+O*s))-((y+x)*2.0*.5+(T*(A+C)*2.0*.5+V*(B+D)*2.0*.5+M*E*.5));if($>0.0){i=e;return}if($>_){ga=5;W=R*o+S*t+O*s<0.0&1;a=e+4|0;_=$}qa=+P(+(R*n+S*m+O*l))-(q*.5+(K*(A+C)*2.0*.5+N*(B+D)*2.0*.5+U*E*.5));if(qa>0.0){i=e;return}if(qa>_){ga=6;W=R*n+S*m+O*l<0.0&1;a=e+8|0}else qa=_;ba=(R*G+S*F+O*z)*(p*I+u*J+r*H)-(R*I+S*J+O*H)*(p*G+u*F+r*z);$=+P(+ba)-((L+9999999747378752.0e-21)*(B+D)*2.0*.5+(Z+9999999747378752.0e-21)*E*.5+(K+9999999747378752.0e-21)*(y+x)*2.0*.5+(T+9999999747378752.0e-21)*q*.5);if($>1.1920928955078125e-7){i=e;return}da=(p*G+u*F+r*z)*(p*G+u*F+r*z)+0.0;aa=(p*I+u*J+r*H)*(p*I+u*J+r*H);_=+Q(+(aa+da));if(_>1.1920928955078125e-7?$/_*1.0499999523162842>qa:0){oa=(p*I+u*J+r*H)/_;na=-(p*G+u*F+r*z)/_;ma=0.0/_;ga=7;W=ba<0.0&1;a=0;qa=$/_}else{oa=0.0;na=0.0;ma=0.0}ca=(R*G+S*F+O*z)*(o*I+t*J+s*H)-(R*I+S*J+O*H)*(o*G+t*F+s*z);$=+P(+ca)-((M+9999999747378752.0e-21)*(B+D)*2.0*.5+(V+9999999747378752.0e-21)*E*.5+(K+9999999747378752.0e-21)*(w+v)*2.0*.5+(X+9999999747378752.0e-21)*q*.5);if($>1.1920928955078125e-7){i=e;return}ea=(o*G+t*F+s*z)*(o*G+t*F+s*z)+0.0;_=(o*I+t*J+s*H)*(o*I+t*J+s*H);ba=+Q(+(_+ea));if(ba>1.1920928955078125e-7?$/ba*1.0499999523162842>qa:0){oa=(o*I+t*J+s*H)/ba;na=-(o*G+t*F+s*z)/ba;ma=0.0/ba;ga=8;W=ca<0.0&1;a=0;qa=$/ba}va=(R*G+S*F+O*z)*(n*I+m*J+l*H)-(R*I+S*J+O*H)*(n*G+m*F+l*z);ba=+P(+va)-((U+9999999747378752.0e-21)*(B+D)*2.0*.5+(N+9999999747378752.0e-21)*E*.5+(T+9999999747378752.0e-21)*(w+v)*2.0*.5+(X+9999999747378752.0e-21)*(y+x)*2.0*.5);if(ba>1.1920928955078125e-7){i=e;return}ca=(n*G+m*F+l*z)*(n*G+m*F+l*z)+0.0;$=(n*I+m*J+l*H)*(n*I+m*J+l*H);ra=+Q(+($+ca));if(ra>1.1920928955078125e-7?ba/ra*1.0499999523162842>qa:0){oa=(n*I+m*J+l*H)/ra;na=-(n*G+m*F+l*z)/ra;ma=0.0/ra;ga=9;W=va<0.0&1;a=0;qa=ba/ra}va=(R*k+S*j+O*h)*(p*G+u*F+r*z)-(R*G+S*F+O*z)*(k*p+j*u+h*r);ra=+P(+va)-((L+9999999747378752.0e-21)*(A+C)*2.0*.5+(X+9999999747378752.0e-21)*E*.5+(N+9999999747378752.0e-21)*(y+x)*2.0*.5+(V+9999999747378752.0e-21)*q*.5);if(ra>1.1920928955078125e-7){i=e;return}ba=(k*p+j*u+h*r)*(k*p+j*u+h*r);da=+Q(+(ba+da));do if(da>1.1920928955078125e-7){if(!(ra/da*1.0499999523162842>qa))break;oa=-(k*p+j*u+h*r)/da;na=0.0/da;ma=(p*G+u*F+r*z)/da;ga=10;W=va<0.0&1;a=0;qa=ra/da}while(0);va=(R*k+S*j+O*h)*(o*G+t*F+s*z)-(R*G+S*F+O*z)*(k*o+j*t+h*s);ra=+P(+va)-((M+9999999747378752.0e-21)*(A+C)*2.0*.5+(T+9999999747378752.0e-21)*E*.5+(N+9999999747378752.0e-21)*(w+v)*2.0*.5+(Z+9999999747378752.0e-21)*q*.5);if(ra>1.1920928955078125e-7){i=e;return}da=(k*o+j*t+h*s)*(k*o+j*t+h*s);ea=+Q(+(da+ea));do if(ea>1.1920928955078125e-7){if(!(ra/ea*1.0499999523162842>qa))break;oa=-(k*o+j*t+h*s)/ea;na=0.0/ea;ma=(o*G+t*F+s*z)/ea;ga=11;W=va<0.0&1;a=0;qa=ra/ea}while(0);va=(R*k+S*j+O*h)*(n*G+m*F+l*z)-(R*G+S*F+O*z)*(k*n+j*m+h*l);ra=+P(+va)-((U+9999999747378752.0e-21)*(A+C)*2.0*.5+(K+9999999747378752.0e-21)*E*.5+(V+9999999747378752.0e-21)*(w+v)*2.0*.5+(Z+9999999747378752.0e-21)*(y+x)*2.0*.5);if(ra>1.1920928955078125e-7){i=e;return}ea=(k*n+j*m+h*l)*(k*n+j*m+h*l);ca=+Q(+(ea+ca));do if(ca>1.1920928955078125e-7){if(!(ra/ca*1.0499999523162842>qa))break;oa=-(k*n+j*m+h*l)/ca;na=0.0/ca;ma=(n*G+m*F+l*z)/ca;ga=12;W=va<0.0&1;a=0;qa=ra/ca}while(0);ca=(R*I+S*J+O*H)*(k*p+j*u+h*r)-(R*k+S*j+O*h)*(p*I+u*J+r*H);X=+P(+ca)-((Z+9999999747378752.0e-21)*(A+C)*2.0*.5+(X+9999999747378752.0e-21)*(B+D)*2.0*.5+(U+9999999747378752.0e-21)*(y+x)*2.0*.5+(M+9999999747378752.0e-21)*q*.5);if(X>1.1920928955078125e-7){i=e;return}Z=+Q(+(ba+aa+0.0));do if(Z>1.1920928955078125e-7){if(!(X/Z*1.0499999523162842>qa))break;oa=0.0/Z;na=(k*p+j*u+h*r)/Z;ma=-(p*I+u*J+r*H)/Z;ga=13;W=ca<0.0&1;a=0;qa=X/Z}while(0);X=(R*I+S*J+O*H)*(k*o+j*t+h*s)-(R*k+S*j+O*h)*(o*I+t*J+s*H);T=+P(+X)-((V+9999999747378752.0e-21)*(A+C)*2.0*.5+(T+9999999747378752.0e-21)*(B+D)*2.0*.5+(U+9999999747378752.0e-21)*(w+v)*2.0*.5+(L+9999999747378752.0e-21)*q*.5);if(T>1.1920928955078125e-7){i=e;return}U=+Q(+(da+_+0.0));do if(U>1.1920928955078125e-7){if(!(T/U*1.0499999523162842>qa)){fa=a;break}oa=0.0/U;na=(k*o+j*t+h*s)/U;ma=-(o*I+t*J+s*H)/U;ga=14;W=X<0.0&1;fa=0;qa=T/U}else fa=a;while(0);O=(R*I+S*J+O*H)*(k*n+j*m+h*l)-(R*k+S*j+O*h)*(n*I+m*J+l*H);K=+P(+O)-((N+9999999747378752.0e-21)*(A+C)*2.0*.5+(K+9999999747378752.0e-21)*(B+D)*2.0*.5+(M+9999999747378752.0e-21)*(w+v)*2.0*.5+(L+9999999747378752.0e-21)*(y+x)*2.0*.5);if(K>1.1920928955078125e-7){i=e;return}L=+Q(+(ea+$+0.0));do if(L>1.1920928955078125e-7){if(!(K/L*1.0499999523162842>qa)){a=55;break}ma=-(n*I+m*J+l*H)/L;na=(k*n+j*m+h*l)/L;oa=0.0/L;ga=15;W=O<0.0&1;qa=K/L;a=58}else a=55;while(0);do if((a|0)==55){if(!ga){i=e;return}if(!fa){a=58;break}h=+g[fa>>2];j=+g[fa+16>>2];k=+g[fa+32>>2]}while(0);if((a|0)==58){h=ma*+g[e+48>>2]+na*+g[f>>2]+oa*G;j=ma*+g[e+64>>2]+na*+g[e+68>>2]+oa*F;k=ma*+g[e+80>>2]+na*+g[e+84>>2]+oa*z}if(W){h=-h;j=-j;k=-k}if((ga|0)>6){ca=+g[e+48>>2];da=+g[e+64>>2];na=+g[e+80>>2];ma=(h*ca+j*da+k*na>0.0?1.0:-1.0)*(A+C)*2.0*.5;A=+g[f>>2];ea=+g[e+68>>2];ra=+g[e+84>>2];oa=(h*A+j*ea+k*ra>0.0?1.0:-1.0)*(B+D)*2.0*.5;va=(h*G+j*F+k*z>0.0?1.0:-1.0)*E*.5;A=+g[b+48>>2]+ma*ca+oa*A+va*G;B=+g[b+52>>2]+ma*da+oa*ea+va*F;z=+g[b+56>>2]+ma*na+oa*ra+va*z;c[e+520>>2]=c[b+112>>2];c[e+524>>2]=c[b+116>>2];c[e+528>>2]=c[b+120>>2];w=(h*p+j*u+k*r>0.0?-1.0:1.0)*(w+v)*2.0*.5;x=(h*o+j*t+k*s>0.0?-1.0:1.0)*(y+x)*2.0*.5;t=+g[e+524>>2]+w*u+x*t;r=+g[e+528>>2]+w*r+x*s;q=(h*n+j*m+k*l>0.0?-1.0:1.0)*q*.5;n=+g[e+520>>2]+w*p+x*o+q*n;g[e+520>>2]=n;g[e+524>>2]=t+q*m;g[e+528>>2]=r+q*l;Da=ga+ -7|0;u=+g[e+48+(((Da|0)/3|0)<<2)>>2];x=+g[e+48+(((Da|0)/3|0)+4<<2)>>2];w=+g[e+48+(((Da|0)/3|0)+8<<2)>>2];s=+g[e+(((Da|0)%3|0)<<2)>>2];p=+g[e+(((Da|0)%3|0)+4<<2)>>2];o=+g[e+(((Da|0)%3|0)+8<<2)>>2];v=1.0-(u*s+x*p+w*o)*(u*s+x*p+w*o);if(!(v<=9999999747378752.0e-20))u=(((n-A)*u+(t+q*m-B)*x+(r+q*l-z)*w)*(u*s+x*p+w*o)-((n-A)*s+(t+q*m-B)*p+(r+q*l-z)*o))*(1.0/v);else u=0.0;g[e+520>>2]=n+u*s;g[e+524>>2]=t+q*m+u*p;g[e+528>>2]=r+q*l+u*o;Da=c[(c[d>>2]|0)+16>>2]|0;g[e+504>>2]=-h;g[e+508>>2]=-j;g[e+512>>2]=-k;g[e+516>>2]=0.0;qc[Da&15](d,e+504|0,e+520|0,qa);i=e;return}W=(ga|0)<4;if(W){l=h;m=j;n=k;ha=e+48|0;ta=e;fa=e+548|0;pa=e+536|0;f=b+48|0;b=b+112|0}else{l=-h;m=-j;n=-k;ha=e;ta=e+48|0;fa=e+536|0;pa=e+548|0;f=b+112|0;b=b+48|0}o=l*+g[ta>>2]+m*+g[ta+16>>2]+n*+g[ta+32>>2];g[e+488>>2]=o;q=l*+g[ta+4>>2]+m*+g[ta+20>>2]+n*+g[ta+36>>2];g[e+492>>2]=q;p=l*+g[ta+8>>2]+m*+g[ta+24>>2]+n*+g[ta+40>>2];g[e+496>>2]=p;o=+P(+o);q=+P(+q);p=+P(+p);if(q>o){ja=q>p;sa=0;ia=q>p?1:2}else{ja=o>p;sa=o>p&1;ia=o>p?0:2}ua=ja?2:1;q=+g[pa+(ia<<2)>>2];p=+g[b>>2]- +g[f>>2];o=q*+g[ta+(ia<<2)>>2];if(+g[e+488+(ia<<2)>>2]<0.0){o=p+o;p=+g[b+4>>2]- +g[f+4>>2]+q*+g[ta+((ia|4)<<2)>>2];q=+g[b+8>>2]- +g[f+8>>2]+q*+g[ta+((ia|8)<<2)>>2]}else{o=p-o;p=+g[b+4>>2]- +g[f+4>>2]-q*+g[ta+((ia|4)<<2)>>2];q=+g[b+8>>2]- +g[f+8>>2]-q*+g[ta+((ia|8)<<2)>>2]}la=(W?-1:-4)+ga|0;if(!la){wa=1;xa=2}else if((la|0)==1){wa=0;xa=2}else{wa=0;xa=1}t=+g[ha+(wa<<2)>>2];u=+g[ha+((wa|4)<<2)>>2];v=+g[ha+((wa|8)<<2)>>2];r=o*t+p*u+q*v;w=+g[ha+(xa<<2)>>2];s=+g[ha+((xa|4)<<2)>>2];y=+g[ha+((xa|8)<<2)>>2];A=o*w+p*s+q*y;ka=ta+(sa<<2)|0;x=+g[ka>>2];ia=ta+((sa|4)<<2)|0;C=+g[ia>>2];b=ta+((sa|8)<<2)|0;D=+g[b>>2];ja=ta+(ua<<2)|0;z=+g[ja>>2];ha=ta+((ua|4)<<2)|0;B=+g[ha>>2];ga=ta+((ua|8)<<2)|0;E=+g[ga>>2];ra=+g[pa+(sa<<2)>>2];va=+g[pa+(ua<<2)>>2];qa=(t*z+u*B+v*E)*va;va=(w*z+s*B+y*E)*va;g[e+456>>2]=r-(t*x+u*C+v*D)*ra-qa;g[e+460>>2]=A-(w*x+s*C+y*D)*ra-va;g[e+464>>2]=r-(t*x+u*C+v*D)*ra+qa;g[e+468>>2]=A-(w*x+s*C+y*D)*ra+va;g[e+472>>2]=r+(t*x+u*C+v*D)*ra+qa;g[e+476>>2]=A+(w*x+s*C+y*D)*ra+va;g[e+480>>2]=r+(t*x+u*C+v*D)*ra-qa;g[e+484>>2]=A+(w*x+s*C+y*D)*ra-va;g[e+448>>2]=+g[fa+(wa<<2)>>2];g[e+452>>2]=+g[fa+(xa<<2)>>2];ua=0;za=4;xa=e+456|0;ta=e+384|0;a:while(1){sa=e+448+(ua<<2)|0;pa=1-ua|0;wa=-1;while(1){if((za|0)>0){F=+(wa|0);Ba=0;ya=xa;Aa=ta;while(1){Ca=ya+(ua<<2)|0;G=+g[Ca>>2];H=+g[sa>>2];if(F*G<H){g[Aa>>2]=+g[ya>>2];g[Aa+4>>2]=+g[ya+4>>2];Ba=Ba+1|0;if(Ba&8){za=Ba;break a}G=+g[Ca>>2];H=+g[sa>>2];Aa=Aa+8|0}Ca=ya;ya=ya+8|0;Da=(za|0)>1?ya:xa;I=+g[Da+(ua<<2)>>2];if(F*G<H^F*I<H){va=+g[Ca+(pa<<2)>>2];g[Aa+(pa<<2)>>2]=va+(F*H-G)*((+g[Da+(pa<<2)>>2]-va)/(I-G));g[Aa+(ua<<2)>>2]=F*+g[sa>>2];Ba=Ba+1|0;if(!(Ba&8))Aa=Aa+8|0;else{za=Ba;break a}}za=za+ -1|0;if((za|0)<=0){za=Ba;break}}}else za=0;ya=(ta|0)==(e+384|0)?e+592|0:e+384|0;if((wa|0)<0){xa=ta;ta=ya;wa=wa+2|0}else break}ua=ua+1|0;if((ua|0)<2){xa=ta;ta=ya}else break}if((ta|0)!=(e+384|0))mF(e+384|0,ta|0,za<<3|0)|0;if((za|0)<1){i=e;return}F=1.0/((t*x+u*C+v*D)*(w*z+s*B+y*E)-(w*x+s*C+y*D)*(t*z+u*B+v*E));G=+g[fa+(la<<2)>>2];H=+g[ka>>2];I=+g[ja>>2];J=+g[ia>>2];K=+g[ha>>2];L=+g[b>>2];M=+g[ga>>2];b=0;fa=0;do{Da=fa<<1;O=+g[e+384+(Da<<2)>>2];N=+g[e+384+((Da|1)<<2)>>2];oa=(w*z+s*B+y*E)*F*(O-r)-(t*z+u*B+v*E)*F*(N-A);va=(t*x+u*C+v*D)*F*(N-A)-(w*x+s*C+y*D)*F*(O-r);Da=b*3|0;qa=o+oa*H+va*I;g[e+288+(Da<<2)>>2]=qa;ra=p+oa*J+va*K;g[e+288+(Da+1<<2)>>2]=ra;va=q+oa*L+va*M;g[e+288+(Da+2<<2)>>2]=va;va=G-(l*qa+m*ra+n*va);g[e+256+(b<<2)>>2]=va;if(va>=0.0){Da=b<<1;g[e+384+(Da<<2)>>2]=O;g[e+384+((Da|1)<<2)>>2]=N;b=b+1|0}fa=fa+1|0}while((fa|0)!=(za|0));if((b|0)<1){i=e;return}fa=(b|0)<4?b:4;fa=(fa|0)<1?1:fa;if((b|0)<=(fa|0)){a=(b|0)>0;if(W){if(!a){i=e;return}a=f+4|0;W=f+8|0;h=-h;j=-j;k=-k;fa=0;do{Da=fa*3|0;g[e+240>>2]=+g[e+288+(Da<<2)>>2]+ +g[f>>2];g[e+244>>2]=+g[e+288+(Da+1<<2)>>2]+ +g[a>>2];g[e+248>>2]=+g[e+288+(Da+2<<2)>>2]+ +g[W>>2];Da=c[(c[d>>2]|0)+16>>2]|0;g[e+224>>2]=h;g[e+228>>2]=j;g[e+232>>2]=k;g[e+236>>2]=0.0;qc[Da&15](d,e+224|0,e+240|0,-+g[e+256+(fa<<2)>>2]);fa=fa+1|0}while((fa|0)!=(b|0));i=e;return}else{if(!a){i=e;return}W=f+4|0;fa=f+8|0;l=-h;n=-j;m=-k;a=0;do{Da=a*3|0;va=+g[e+256+(a<<2)>>2];g[e+208>>2]=+g[e+288+(Da<<2)>>2]+ +g[f>>2]-h*va;g[e+212>>2]=+g[e+288+(Da+1<<2)>>2]+ +g[W>>2]-j*va;g[e+216>>2]=+g[e+288+(Da+2<<2)>>2]+ +g[fa>>2]-k*va;Da=c[(c[d>>2]|0)+16>>2]|0;g[e+192>>2]=l;g[e+196>>2]=n;g[e+200>>2]=m;g[e+204>>2]=0.0;qc[Da&15](d,e+192|0,e+208|0,-va);a=a+1|0}while((a|0)!=(b|0));i=e;return}}if((b|0)>1){ha=1;ga=0;l=+g[e+256>>2];while(1){m=+g[e+256+(ha<<2)>>2];ia=m>l;ga=ia?ha:ga;ha=ha+1|0;if((ha|0)==(b|0))break;else l=ia?m:l}}else ga=0;if((b|0)==1){q=+g[e+384>>2];l=+g[e+388>>2];a=115}else if((b|0)!=2){ha=b+ -1|0;if((ha|0)>0){r=0.0;q=0.0;p=0.0;ia=0;do{Da=ia<<1;oa=+g[e+384+(Da<<2)>>2];qa=+g[e+384+(Da+3<<2)>>2];ra=+g[e+384+(Da+2<<2)>>2];va=+g[e+384+((Da|1)<<2)>>2];r=r+(oa*qa-ra*va);q=q+(oa+ra)*(oa*qa-ra*va);p=p+(qa+va)*(oa*qa-ra*va);ia=ia+1|0}while((ia|0)!=(ha|0))}else{r=0.0;q=0.0;p=0.0}Da=b<<1;o=+g[e+384+(Da+ -2<<2)>>2];n=+g[e+388>>2];m=+g[e+384>>2];l=+g[e+384+(Da+ -1<<2)>>2];r=r+(o*n-m*l);if(+P(+r)>1.1920928955078125e-7)r=1.0/(r*3.0);else r=999999984306749400.0;if((b|0)>0){q=r*(q+(o*n-m*l)*(o+m));l=r*(p+(o*n-m*l)*(l+n));a=115}else ha=0}else{q=(+g[e+384>>2]+ +g[e+392>>2])*.5;l=(+g[e+388>>2]+ +g[e+396>>2])*.5;a=115}if((a|0)==115){a=0;do{Da=a<<1;g[e+592+(a<<2)>>2]=+Y(+(+g[e+384+((Da|1)<<2)>>2]-l),+(+g[e+384+(Da<<2)>>2]-q));a=a+1|0}while((a|0)!=(b|0));a=0;do{c[e+560+(a<<2)>>2]=1;a=a+1|0}while((a|0)!=(b|0));ha=1}a=e+560+(ga<<2)|0;c[a>>2]=0;c[e+160>>2]=ga;b:do if((fa|0)>1){l=+g[e+592+(ga<<2)>>2];if(ha){ha=e+164|0;a=1}else{ha=e+164|0;b=1;while(1){c[ha>>2]=ga;c[a>>2]=0;b=b+1|0;if((b|0)==(fa|0))break b;else ha=ha+4|0}}while(1){m=+(a|0)*(6.2831854820251465/+(fa|0))+l;if(m>3.1415927410125732)m=m+-6.2831854820251465;c[ha>>2]=ga;ja=ga;ia=0;n=1.0e9;do{do if(c[e+560+(ia<<2)>>2]|0){o=+P(+(+g[e+592+(ia<<2)>>2]-m));if(o>3.1415927410125732)o=6.2831854820251465-o;if(!(o<n))break;c[ha>>2]=ia;ja=ia;n=o}while(0);ia=ia+1|0}while((ia|0)!=(b|0));c[e+560+(ja<<2)>>2]=0;a=a+1|0;if((a|0)==(fa|0))break;else ha=ha+4|0}}while(0);if((fa|0)<=0){i=e;return}a=f+4|0;b=f+8|0;m=-k;l=-j;n=-h;if(W){W=0;do{Da=c[e+160+(W<<2)>>2]|0;g[e+144>>2]=+g[e+288+(Da*3<<2)>>2]+ +g[f>>2];g[e+148>>2]=+g[e+288+((Da*3|0)+1<<2)>>2]+ +g[a>>2];g[e+152>>2]=+g[e+288+((Da*3|0)+2<<2)>>2]+ +g[b>>2];Ca=c[(c[d>>2]|0)+16>>2]|0;g[e+128>>2]=n;g[e+132>>2]=l;g[e+136>>2]=m;g[e+140>>2]=0.0;qc[Ca&15](d,e+128|0,e+144|0,-+g[e+256+(Da<<2)>>2]);W=W+1|0}while((W|0)<(fa|0));i=e;return}else{W=0;do{Ca=c[e+160+(W<<2)>>2]|0;oa=+g[e+288+(Ca*3<<2)>>2]+ +g[f>>2];g[e+144>>2]=oa;qa=+g[e+288+((Ca*3|0)+1<<2)>>2]+ +g[a>>2];g[e+148>>2]=qa;ra=+g[e+288+((Ca*3|0)+2<<2)>>2]+ +g[b>>2];g[e+152>>2]=ra;Da=c[(c[d>>2]|0)+16>>2]|0;g[e+112>>2]=n;g[e+116>>2]=l;g[e+120>>2]=m;g[e+124>>2]=0.0;va=+g[e+256+(Ca<<2)>>2];g[e+96>>2]=oa-h*va;g[e+100>>2]=qa-va*j;g[e+104>>2]=ra-va*k;g[e+108>>2]=0.0;qc[Da&15](d,e+112|0,e+96|0,-va);W=W+1|0}while((W|0)<(fa|0));i=e;return}}function GC(a){a=a|0;return}function HC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function IC(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0;g=i;i=i+32|0;h=(a[b+28>>0]|0)!=0;f=h?e:d;e=h?d:e;d=c[f+4>>2]|0;h=c[d+16>>2]|0;j=c[b+12>>2]|0;if((j|0)<(h|0)){if((c[b+16>>2]|0)<(h|0)){if(!h){k=0;m=j}else{c[5004]=(c[5004]|0)+1;k=fF((h<<2|3)+16|0)|0;if(!k)k=0;else{c[(k+19&-16)+ -4>>2]=k;k=k+19&-16}m=c[b+12>>2]|0}if((m|0)>0){l=0;do{n=k+(l<<2)|0;if(n)c[n>>2]=c[(c[b+20>>2]|0)+(l<<2)>>2];l=l+1|0}while((l|0)!=(m|0))}l=c[b+20>>2]|0;if(l){if(a[b+24>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[l+ -4>>2]|0)}c[b+20>>2]=0}a[b+24>>0]=1;c[b+20>>2]=k;c[b+16>>2]=h;k=b+20|0}else k=b+20|0;do{l=(c[k>>2]|0)+(j<<2)|0;if(l)c[l>>2]=0;j=j+1|0}while((j|0)!=(h|0))}c[b+12>>2]=h;if((h|0)<=0){i=g;return}j=0;do{if(!(c[d+64>>2]|0)){l=c[(c[d+24>>2]|0)+(j*80|0)+64>>2]|0;m=c[f+8>>2]|0;n=c[f+12>>2]|0;c[g>>2]=f;c[g+4>>2]=l;c[g+8>>2]=m;c[g+12>>2]=n;c[g+16>>2]=-1;c[g+20>>2]=j;n=c[b+4>>2]|0;n=Tb[c[(c[n>>2]|0)+8>>2]&31](n,g,e,c[b+32>>2]|0)|0;c[(c[b+20>>2]|0)+(j<<2)>>2]=n}else c[(c[b+20>>2]|0)+(j<<2)>>2]=0;j=j+1|0}while((j|0)!=(h|0));i=g;return}function JC(a){a=a|0;var b=0;b=i;KC(a);gF(a);i=b;return}function KC(b){b=b|0;var d=0,e=0,f=0,g=0;d=i;c[b>>2]=18040;e=c[b+12>>2]|0;if((e|0)>0){f=0;do{g=c[(c[b+20>>2]|0)+(f<<2)>>2]|0;if(g){Lb[c[c[g>>2]>>2]&511](g);g=c[b+4>>2]|0;Nb[c[(c[g>>2]|0)+60>>2]&127](g,c[(c[b+20>>2]|0)+(f<<2)>>2]|0)}f=f+1|0}while((f|0)!=(e|0))}e=c[b+20>>2]|0;if(!e){a[b+24>>0]=1;c[b+20>>2]=0;c[b+12>>2]=0;g=b+16|0;c[g>>2]=0;i=d;return}if(a[b+24>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+20>>2]=0;a[b+24>>0]=1;c[b+20>>2]=0;c[b+12>>2]=0;g=b+16|0;c[g>>2]=0;i=d;return}function LC(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,Q=0.0;j=i;i=i+320|0;k=(a[b+28>>0]|0)!=0;m=k?e:d;k=k?d:e;l=c[m+4>>2]|0;if((c[l+68>>2]|0)!=(c[b+40>>2]|0)){p=c[b+12>>2]|0;if((p|0)>0){o=0;do{n=c[(c[b+20>>2]|0)+(o<<2)>>2]|0;if(n){Lb[c[c[n>>2]>>2]&511](n);s=c[b+4>>2]|0;Nb[c[(c[s>>2]|0)+60>>2]&127](s,c[(c[b+20>>2]|0)+(o<<2)>>2]|0)}o=o+1|0}while((o|0)!=(p|0))}IC(b,d,e)}d=c[l+64>>2]|0;n=c[b+4>>2]|0;q=c[b+20>>2]|0;o=c[b+32>>2]|0;c[j+280>>2]=18120;c[j+284>>2]=m;c[j+288>>2]=k;c[j+292>>2]=n;c[j+296>>2]=f;c[j+300>>2]=h;c[j+304>>2]=q;c[j+308>>2]=o;f=j+272|0;a[f>>0]=1;o=j+268|0;c[o>>2]=0;n=j+260|0;c[n>>2]=0;c[j+264>>2]=0;e=c[b+12>>2]|0;if((e|0)>0){p=0;while(1){q=c[q+(p<<2)>>2]|0;if(q){Nb[c[(c[q>>2]|0)+16>>2]&127](q,j+256|0);e=c[n>>2]|0;if((e|0)>0){r=e;e=0;do{q=c[(c[o>>2]|0)+(e<<2)>>2]|0;if(c[q+748>>2]|0){c[h+4>>2]=q;s=c[q+740>>2]|0;r=c[(c[h+8>>2]|0)+8>>2]|0;if((s|0)==(r|0))xA(q,s+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);else xA(q,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,r+4|0);c[h+4>>2]=0;r=c[n>>2]|0}e=e+1|0}while((e|0)<(r|0));e=r}if((e|0)<0){if((c[j+264>>2]|0)<0){r=c[o>>2]|0;if((e|0)>0){q=0;do{if(q)c[0+(q<<2)>>2]=c[r+(q<<2)>>2];q=q+1|0}while((q|0)!=(e|0))}if(r){if(a[f>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[r+ -4>>2]|0)}c[o>>2]=0}a[f>>0]=1;c[o>>2]=0;c[j+264>>2]=0}do{q=(c[o>>2]|0)+(e<<2)|0;if(q)c[q>>2]=0;e=e+1|0}while((e|0)!=0)}c[n>>2]=0;e=c[b+12>>2]|0}p=p+1|0;if((p|0)>=(e|0))break;q=c[b+20>>2]|0}h=c[o>>2]|0;if(h){if(a[f>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[o>>2]=0}}a[f>>0]=1;c[o>>2]=0;c[n>>2]=0;c[j+264>>2]=0;if(!d){h=c[b+12>>2]|0;if((h|0)>0){d=0;do{MC(j+280|0,c[(c[l+24>>2]|0)+(d*80|0)+64>>2]|0,d);d=d+1|0}while((d|0)<(h|0))}else{i=j;return}}else{s=c[m+12>>2]|0;H=+g[s>>2];G=+g[s+16>>2];F=+g[s+32>>2];E=+g[s+4>>2];D=+g[s+20>>2];C=+g[s+36>>2];y=+g[s+8>>2];w=+g[s+24>>2];u=+g[s+40>>2];B=-+g[s+48>>2];A=-+g[s+52>>2];z=-+g[s+56>>2];s=c[k+12>>2]|0;Q=+g[s>>2];P=+g[s+16>>2];O=+g[s+32>>2];N=+g[s+4>>2];M=+g[s+20>>2];L=+g[s+36>>2];K=+g[s+8>>2];J=+g[s+24>>2];I=+g[s+40>>2];x=+g[s+48>>2];v=+g[s+52>>2];t=+g[s+56>>2];g[j+160>>2]=H*Q+G*P+F*O;g[j+164>>2]=H*N+G*M+F*L;g[j+168>>2]=H*K+G*J+F*I;g[j+172>>2]=0.0;g[j+176>>2]=E*Q+D*P+C*O;g[j+180>>2]=E*N+D*M+C*L;g[j+184>>2]=E*K+D*J+C*I;g[j+188>>2]=0.0;g[j+192>>2]=y*Q+w*P+u*O;g[j+196>>2]=y*N+w*M+u*L;g[j+200>>2]=y*K+w*J+u*I;g[j+204>>2]=0.0;g[j+208>>2]=H*B+G*A+F*z+(H*x+G*v+F*t);g[j+212>>2]=E*B+D*A+C*z+(E*x+D*v+C*t);g[j+216>>2]=y*B+w*A+u*z+(y*x+w*v+u*t);g[j+220>>2]=0.0;s=c[k+4>>2]|0;vc[c[(c[s>>2]|0)+8>>2]&127](s,j+160|0,j+240|0,j+224|0);c[j+128>>2]=c[j+240>>2];c[j+132>>2]=c[j+244>>2];c[j+136>>2]=c[j+248>>2];c[j+140>>2]=c[j+252>>2];c[j+144>>2]=c[j+224>>2];c[j+148>>2]=c[j+228>>2];c[j+152>>2]=c[j+232>>2];c[j+156>>2]=c[j+236>>2];by(c[d>>2]|0,j+128|0,j+280|0)}h=c[b+12>>2]|0;if((h|0)<=0){i=j;return}d=0;do{do if(c[(c[b+20>>2]|0)+(d<<2)>>2]|0){q=c[l+24>>2]|0;s=c[q+(d*80|0)+64>>2]|0;r=c[m+12>>2]|0;w=+g[r>>2];x=+g[r+4>>2];y=+g[r+8>>2];z=+g[r+16>>2];A=+g[r+20>>2];B=+g[r+24>>2];I=+g[r+32>>2];K=+g[r+36>>2];M=+g[r+40>>2];C=+g[q+(d*80|0)>>2];D=+g[q+(d*80|0)+16>>2];E=+g[q+(d*80|0)+32>>2];F=+g[q+(d*80|0)+4>>2];G=+g[q+(d*80|0)+20>>2];H=+g[q+(d*80|0)+36>>2];J=+g[q+(d*80|0)+8>>2];L=+g[q+(d*80|0)+24>>2];N=+g[q+(d*80|0)+40>>2];u=+g[q+(d*80|0)+48>>2];v=+g[q+(d*80|0)+52>>2];Q=+g[q+(d*80|0)+56>>2];O=+g[r+48>>2]+(w*u+x*v+y*Q);P=+g[r+52>>2]+(z*u+A*v+B*Q);Q=+g[r+56>>2]+(I*u+K*v+M*Q);g[j+64>>2]=w*C+x*D+y*E;g[j+68>>2]=w*F+x*G+y*H;g[j+72>>2]=w*J+x*L+y*N;g[j+76>>2]=0.0;g[j+80>>2]=z*C+A*D+B*E;g[j+84>>2]=z*F+A*G+B*H;g[j+88>>2]=z*J+A*L+B*N;g[j+92>>2]=0.0;g[j+96>>2]=I*C+K*D+M*E;g[j+100>>2]=I*F+K*G+M*H;g[j+104>>2]=I*J+K*L+M*N;g[j+108>>2]=0.0;g[j+112>>2]=O;g[j+116>>2]=P;g[j+120>>2]=Q;g[j+124>>2]=0.0;vc[c[(c[s>>2]|0)+8>>2]&127](s,j+64|0,j+48|0,j+32|0);s=c[k+4>>2]|0;vc[c[(c[s>>2]|0)+8>>2]&127](s,c[k+12>>2]|0,j+16|0,j);if(!(+g[j+48>>2]>+g[j>>2])?!(+g[j+32>>2]<+g[j+16>>2]):0)f=1;else f=0;if(!(!(+g[j+56>>2]>+g[j+8>>2])?!(+g[j+40>>2]<+g[j+24>>2]):0))f=0;if(!(+g[j+52>>2]>+g[j+4>>2])?!(+g[j+36>>2]<+g[j+20>>2]|f^1):0)break;s=c[(c[b+20>>2]|0)+(d<<2)>>2]|0;Lb[c[c[s>>2]>>2]&511](s);s=c[b+4>>2]|0;Nb[c[(c[s>>2]|0)+60>>2]&127](s,c[(c[b+20>>2]|0)+(d<<2)>>2]|0);c[(c[b+20>>2]|0)+(d<<2)>>2]=0}while(0);d=d+1|0}while((d|0)<(h|0));i=j;return}function MC(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0;e=i;i=i+160|0;f=c[a+4>>2]|0;h=c[f+12>>2]|0;D=+g[h>>2];C=+g[h+4>>2];B=+g[h+8>>2];A=+g[h+16>>2];z=+g[h+20>>2];y=+g[h+24>>2];r=+g[h+32>>2];p=+g[h+36>>2];n=+g[h+40>>2];f=c[(c[f+4>>2]|0)+24>>2]|0;x=+g[f+(d*80|0)>>2];w=+g[f+(d*80|0)+16>>2];v=+g[f+(d*80|0)+32>>2];u=+g[f+(d*80|0)+4>>2];t=+g[f+(d*80|0)+20>>2];s=+g[f+(d*80|0)+36>>2];q=+g[f+(d*80|0)+8>>2];o=+g[f+(d*80|0)+24>>2];m=+g[f+(d*80|0)+40>>2];F=+g[f+(d*80|0)+48>>2];E=+g[f+(d*80|0)+52>>2];j=+g[f+(d*80|0)+56>>2];l=+g[h+48>>2]+(D*F+C*E+B*j);k=+g[h+52>>2]+(A*F+z*E+y*j);j=+g[h+56>>2]+(r*F+p*E+n*j);g[e+88>>2]=D*x+C*w+B*v;g[e+92>>2]=D*u+C*t+B*s;g[e+96>>2]=D*q+C*o+B*m;g[e+100>>2]=0.0;g[e+104>>2]=A*x+z*w+y*v;g[e+108>>2]=A*u+z*t+y*s;g[e+112>>2]=A*q+z*o+y*m;g[e+116>>2]=0.0;g[e+120>>2]=r*x+p*w+n*v;g[e+124>>2]=r*u+p*t+n*s;g[e+128>>2]=r*q+p*o+n*m;g[e+132>>2]=0.0;g[e+136>>2]=l;g[e+140>>2]=k;g[e+144>>2]=j;g[e+148>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,e+88|0,e+72|0,e+56|0);h=c[a+8>>2]|0;f=c[h+4>>2]|0;vc[c[(c[f>>2]|0)+8>>2]&127](f,c[h+12>>2]|0,e+40|0,e+24|0);if(!(+g[e+72>>2]>+g[e+24>>2])?!(+g[e+56>>2]<+g[e+40>>2]):0)f=1;else f=0;if(!(!(+g[e+80>>2]>+g[e+32>>2])?!(+g[e+64>>2]<+g[e+48>>2]):0))f=0;if(+g[e+76>>2]>+g[e+28>>2]){i=e;return}if(+g[e+60>>2]<+g[e+44>>2]|f^1){i=e;return}f=c[a+4>>2]|0;h=c[f+8>>2]|0;c[e>>2]=f;c[e+4>>2]=b;c[e+8>>2]=h;c[e+12>>2]=e+88;c[e+16>>2]=-1;c[e+20>>2]=d;if(!(c[(c[a+24>>2]|0)+(d<<2)>>2]|0)){b=c[a+12>>2]|0;b=Tb[c[(c[b>>2]|0)+8>>2]&31](b,e,c[a+8>>2]|0,c[a+28>>2]|0)|0;c[(c[a+24>>2]|0)+(d<<2)>>2]=b;b=c[a+4>>2]|0}else b=f;h=c[a+20>>2]|0;f=c[h+8>>2]|0;if((c[f+8>>2]|0)==(c[b+8>>2]|0)){c[h+8>>2]=e;h=c[a+20>>2]|0;rc[c[(c[h>>2]|0)+8>>2]&127](h,-1,d)}else{f=c[h+12>>2]|0;c[h+12>>2]=e;h=c[a+20>>2]|0;rc[c[(c[h>>2]|0)+12>>2]&127](h,-1,d)}d=c[(c[a+24>>2]|0)+(d<<2)>>2]|0;Jb[c[(c[d>>2]|0)+8>>2]&31](d,e,c[a+8>>2]|0,c[a+16>>2]|0,c[a+20>>2]|0);d=c[a+20>>2]|0;if((c[(c[d+8>>2]|0)+8>>2]|0)==(c[(c[a+4>>2]|0)+8>>2]|0)){c[d+8>>2]=f;i=e;return}else{c[d+12>>2]=f;i=e;return}}function NC(a){a=a|0;return}function OC(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0.0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,Q=0.0,R=0.0;j=i;t=(a[b+28>>0]|0)!=0;k=t?e:d;d=t?d:e;t=c[b+12>>2]|0;if((t|0)<=0){E=1.0;i=j;return+E}n=(c[k+192>>2]|0)+24|0;o=+g[k+4>>2];p=+g[k+8>>2];q=+g[k+12>>2];A=+g[k+16>>2];r=+g[k+20>>2];s=+g[k+24>>2];l=+g[k+28>>2];B=+g[k+32>>2];u=+g[k+36>>2];v=+g[k+40>>2];w=+g[k+44>>2];C=+g[k+48>>2];x=+g[k+52>>2];y=+g[k+56>>2];z=+g[k+60>>2];D=+g[k+64>>2];e=c[k+260>>2]|0;E=1.0;m=0;do{G=c[n>>2]|0;R=+g[G+(m*80|0)>>2];Q=+g[G+(m*80|0)+16>>2];P=+g[G+(m*80|0)+32>>2];O=+g[G+(m*80|0)+4>>2];N=+g[G+(m*80|0)+20>>2];M=+g[G+(m*80|0)+36>>2];L=+g[G+(m*80|0)+8>>2];K=+g[G+(m*80|0)+24>>2];J=+g[G+(m*80|0)+40>>2];I=+g[G+(m*80|0)+48>>2];H=+g[G+(m*80|0)+52>>2];F=+g[G+(m*80|0)+56>>2];c[k+260>>2]=e+1;g[k+4>>2]=o*R+p*Q+q*P;g[k+8>>2]=o*O+p*N+q*M;g[k+12>>2]=o*L+p*K+q*J;g[k+16>>2]=0.0;g[k+20>>2]=r*R+s*Q+l*P;g[k+24>>2]=r*O+s*N+l*M;g[k+28>>2]=r*L+s*K+l*J;g[k+32>>2]=0.0;g[k+36>>2]=u*R+v*Q+w*P;g[k+40>>2]=u*O+v*N+w*M;g[k+44>>2]=u*L+v*K+w*J;g[k+48>>2]=0.0;g[k+52>>2]=x+(o*I+p*H+q*F);g[k+56>>2]=y+(r*I+s*H+l*F);g[k+60>>2]=z+(u*I+v*H+w*F);g[k+64>>2]=0.0;G=c[(c[b+20>>2]|0)+(m<<2)>>2]|0;F=+Xb[c[(c[G>>2]|0)+12>>2]&15](G,k,d,f,h);E=F<E?F:E;e=(c[k+260>>2]|0)+1|0;c[k+260>>2]=e;g[k+4>>2]=o;g[k+8>>2]=p;g[k+12>>2]=q;g[k+16>>2]=A;g[k+20>>2]=r;g[k+24>>2]=s;g[k+28>>2]=l;g[k+32>>2]=B;g[k+36>>2]=u;g[k+40>>2]=v;g[k+44>>2]=w;g[k+48>>2]=C;g[k+52>>2]=x;g[k+56>>2]=y;g[k+60>>2]=z;g[k+64>>2]=D;m=m+1|0}while((m|0)!=(t|0));i=j;return+E}function PC(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0;d=i;f=c[a+12>>2]|0;if((f|0)<=0){i=d;return}e=0;do{g=c[(c[a+20>>2]|0)+(e<<2)>>2]|0;if(g){Nb[c[(c[g>>2]|0)+16>>2]&127](g,b);f=c[a+12>>2]|0}e=e+1|0}while((e|0)<(f|0));i=d;return}function QC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function RC(a,b){a=a|0;b=b|0;var d=0;d=i;b=c[b+36>>2]|0;MC(a,c[(c[(c[(c[a+4>>2]|0)+4>>2]|0)+24>>2]|0)+(b*80|0)+64>>2]|0,b);i=d;return}function SC(a){a=a|0;var b=0;b=i;TC(a);gF(a);i=b;return}function TC(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0;d=i;c[b>>2]=18208;f=c[b+8>>2]|0;e=c[f+8>>2]|0;if((e|0)>0){g=0;do{h=c[(c[f+16>>2]|0)+(g*12|0)+8>>2]|0;if(h){Lb[c[c[h>>2]>>2]&511](h);j=c[b+4>>2]|0;Nb[c[(c[j>>2]|0)+60>>2]&127](j,h)}g=g+1|0}while((g|0)!=(e|0));f=c[b+8>>2]|0}ZD(f);e=c[b+8>>2]|0;Lb[c[c[e>>2]>>2]&511](e);e=c[b+8>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}e=c[b+24>>2]|0;if(!e){a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;j=b+20|0;c[j>>2]=0;i=d;return}if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+24>>2]=0;a[b+28>>0]=1;c[b+24>>2]=0;c[b+16>>2]=0;j=b+20|0;c[j>>2]=0;i=d;return}function UC(a,b){a=a|0;b=b|0;var d=0,e=0,f=0,g=0;d=i;a=c[a+8>>2]|0;f=c[a+8>>2]|0;if((f|0)<=0){i=d;return}e=0;do{g=c[(c[a+16>>2]|0)+(e*12|0)+8>>2]|0;if(g){Nb[c[(c[g>>2]|0)+16>>2]&127](g,b);f=c[a+8>>2]|0}e=e+1|0}while((e|0)<(f|0));i=d;return}function VC(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,Q=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0,X=0,Y=0,Z=0,_=0,$=0,aa=0,ba=0,ca=0,da=0.0,ea=0.0,fa=0.0,ga=0.0,ha=0.0,ia=0.0,ja=0.0,ka=0.0,la=0.0,ma=0.0,na=0.0,oa=0;j=i;i=i+192|0;k=c[d+4>>2]|0;m=c[e+4>>2]|0;if((c[k+68>>2]|0)==(c[b+40>>2]|0)?(c[m+68>>2]|0)==(c[b+44>>2]|0):0)n=b+8|0;else{n=c[b+8>>2]|0;Y=c[n+8>>2]|0;if((Y|0)>0){X=0;do{W=c[(c[n+16>>2]|0)+(X*12|0)+8>>2]|0;if(W){Lb[c[c[W>>2]>>2]&511](W);ca=c[b+4>>2]|0;Nb[c[(c[ca>>2]|0)+60>>2]&127](ca,W)}X=X+1|0}while((X|0)!=(Y|0));n=c[b+8>>2]|0}ZD(n);n=b+8|0}W=j+180|0;a[W>>0]=1;X=j+176|0;c[X>>2]=0;Y=j+168|0;c[Y>>2]=0;c[j+172>>2]=0;Z=c[n>>2]|0;$=c[Z+8>>2]|0;if(($|0)>0){_=0;do{aa=c[(c[Z+16>>2]|0)+(_*12|0)+8>>2]|0;if(aa){Nb[c[(c[aa>>2]|0)+16>>2]&127](aa,j+164|0);ba=c[Y>>2]|0;if((ba|0)>0){$=0;do{aa=c[(c[X>>2]|0)+($<<2)>>2]|0;if(c[aa+748>>2]|0){c[h+4>>2]=aa;ba=c[aa+740>>2]|0;ca=c[(c[h+8>>2]|0)+8>>2]|0;if((ba|0)==(ca|0))xA(aa,ba+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);else xA(aa,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,ca+4|0);c[h+4>>2]=0;ba=c[Y>>2]|0}$=$+1|0}while(($|0)<(ba|0))}if((ba|0)<0){if((c[j+172>>2]|0)<0){$=c[X>>2]|0;if((ba|0)>0){aa=0;do{if(aa)c[0+(aa<<2)>>2]=c[$+(aa<<2)>>2];aa=aa+1|0}while((aa|0)!=(ba|0))}if($){if(a[W>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[$+ -4>>2]|0)}c[X>>2]=0}a[W>>0]=1;c[X>>2]=0;c[j+172>>2]=0}do{$=(c[X>>2]|0)+(ba<<2)|0;if($)c[$>>2]=0;ba=ba+1|0}while((ba|0)!=0)}c[Y>>2]=0;$=c[Z+8>>2]|0}_=_+1|0}while((_|0)<($|0));Z=c[X>>2]|0;if(Z){if(a[W>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[Z+ -4>>2]|0)}c[X>>2]=0}}a[W>>0]=1;c[X>>2]=0;c[Y>>2]=0;c[j+172>>2]=0;ba=c[k+64>>2]|0;ca=c[m+64>>2]|0;_=c[b+4>>2]|0;$=c[n>>2]|0;aa=c[b+32>>2]|0;c[j+128>>2]=18296;c[j+132>>2]=0;c[j+136>>2]=d;c[j+140>>2]=e;c[j+144>>2]=_;c[j+148>>2]=f;c[j+152>>2]=h;c[j+156>>2]=$;c[j+160>>2]=aa;f=c[d+12>>2]|0;z=+g[f>>2];B=+g[f+16>>2];D=+g[f+32>>2];t=+g[f+4>>2];s=+g[f+20>>2];r=+g[f+36>>2];q=+g[f+8>>2];p=+g[f+24>>2];o=+g[f+40>>2];A=-+g[f+48>>2];C=-+g[f+52>>2];E=-+g[f+56>>2];f=c[e+12>>2]|0;I=+g[f>>2];J=+g[f+16>>2];K=+g[f+32>>2];L=+g[f+4>>2];y=+g[f+20>>2];x=+g[f+36>>2];w=+g[f+8>>2];v=+g[f+24>>2];u=+g[f+40>>2];F=+g[f+48>>2];G=+g[f+52>>2];H=+g[f+56>>2];f=c[ba>>2]|0;h=c[ca>>2]|0;if(!((f|0)==0|(h|0)==0)){c[5004]=(c[5004]|0)+1;_=fF(1043)|0;c[(_+19&-16)+ -4>>2]=_;c[(_+19&-16)>>2]=f;c[(_+19&-16)+4>>2]=h;V=+P(+(z*I+B*J+D*K));U=+P(+(z*L+B*y+D*x));T=+P(+(z*w+B*v+D*u));M=+P(+(t*I+s*J+r*K));S=+P(+(t*L+s*y+r*x));R=+P(+(t*w+s*v+r*u));Q=+P(+(q*I+p*J+o*K));O=+P(+(q*L+p*y+o*x));N=+P(+(q*w+p*v+o*u));_=_+19&-16;Y=128;$=128;f=1;Z=124;do{h=f+ -1|0;X=c[_+(h<<3)>>2]|0;W=c[_+(h<<3)+4>>2]|0;na=+g[W+16>>2];ma=+g[W>>2];la=+g[W+20>>2];ka=+g[W+4>>2];ja=+g[W+24>>2];da=+g[W+8>>2];ia=z*A+B*C+D*E+(z*F+B*G+D*H)+((z*I+B*J+D*K)*(na+ma)*.5+(z*L+B*y+D*x)*(la+ka)*.5+(z*w+B*v+D*u)*(ja+da)*.5);ga=t*A+s*C+r*E+(t*F+s*G+r*H)+((t*I+s*J+r*K)*(na+ma)*.5+(t*L+s*y+r*x)*(la+ka)*.5+(t*w+s*v+r*u)*(ja+da)*.5);ea=q*A+p*C+o*E+(q*F+p*G+o*H)+((q*I+p*J+o*K)*(na+ma)*.5+(q*L+p*y+o*x)*(la+ka)*.5+(q*w+p*v+o*u)*(ja+da)*.5);ha=((na-ma)*.5+0.0)*V+((la-ka)*.5+0.0)*U+((ja-da)*.5+0.0)*T;fa=((na-ma)*.5+0.0)*M+((la-ka)*.5+0.0)*S+((ja-da)*.5+0.0)*R;da=((na-ma)*.5+0.0)*Q+((la-ka)*.5+0.0)*O+((ja-da)*.5+0.0)*N;do if(((((+g[X>>2]<=ha+ia?+g[X+16>>2]>=ia-ha:0)?+g[X+4>>2]<=ga+fa:0)?+g[X+20>>2]>=ga-fa:0)?+g[X+8>>2]<=ea+da:0)?+g[X+24>>2]>=ea-da:0){if((h|0)>(Z|0)){Z=Y<<1;if((Y|0)<(Z|0)&($|0)<(Z|0)){if(Y){c[5004]=(c[5004]|0)+1;$=fF((Y<<4|3)+16|0)|0;if(!$)$=0;else{c[($+19&-16)+ -4>>2]=$;$=$+19&-16}if((Y|0)>0){aa=0;do{ba=$+(aa<<3)|0;if(ba){oa=_+(aa<<3)|0;ca=c[oa+4>>2]|0;c[ba>>2]=c[oa>>2];c[ba+4>>2]=ca}aa=aa+1|0}while((aa|0)!=(Y|0))}}else $=0;if(!_){_=$;$=Z}else{c[5006]=(c[5006]|0)+1;gF(c[_+ -4>>2]|0);_=$;$=Z}}Y=Z;Z=Z+ -4|0}aa=(c[W+40>>2]|0)!=0;if(!(c[X+40>>2]|0))if(aa){oa=c[W+36>>2]|0;ca=_+(h<<3)|0;c[ca>>2]=X;c[ca+4>>2]=oa;ca=c[W+40>>2]|0;oa=_+(f<<3)|0;c[oa>>2]=X;c[oa+4>>2]=ca;f=f+1|0;break}else{rc[c[(c[j+128>>2]|0)+8>>2]&127](j+128|0,X,W);f=h;break}else{h=_+(h<<3)|0;ba=c[X+36>>2]|0;if(aa){ca=c[W+36>>2]|0;c[h>>2]=ba;c[h+4>>2]=ca;ca=c[W+36>>2]|0;oa=_+(f<<3)|0;c[oa>>2]=c[X+40>>2];c[oa+4>>2]=ca;oa=c[W+40>>2]|0;ca=_+(f+1<<3)|0;c[ca>>2]=c[X+36>>2];c[ca+4>>2]=oa;ca=c[W+40>>2]|0;oa=_+(f+2<<3)|0;c[oa>>2]=c[X+40>>2];c[oa+4>>2]=ca;f=f+3|0;break}else{c[h>>2]=ba;c[h+4>>2]=W;oa=_+(f<<3)|0;c[oa>>2]=c[X+40>>2];c[oa+4>>2]=W;f=f+1|0;break}}}else f=h;while(0)}while((f|0)!=0);if(_){c[5006]=(c[5006]|0)+1;gF(c[_+ -4>>2]|0)}}f=c[n>>2]|0;if((c[f+8>>2]|0)>0){h=0;do{X=c[f+16>>2]|0;W=c[X+(h*12|0)+8>>2]|0;do if(W){oa=c[X+(h*12|0)>>2]|0;ca=c[k+24>>2]|0;ba=c[ca+(oa*80|0)+64>>2]|0;aa=c[d+12>>2]|0;na=+g[aa>>2];K=+g[aa+4>>2];J=+g[aa+8>>2];ka=+g[aa+16>>2];ia=+g[aa+20>>2];ga=+g[aa+24>>2];ja=+g[aa+32>>2];fa=+g[aa+36>>2];Q=+g[aa+40>>2];ea=+g[ca+(oa*80|0)>>2];da=+g[ca+(oa*80|0)+16>>2];V=+g[ca+(oa*80|0)+32>>2];U=+g[ca+(oa*80|0)+4>>2];T=+g[ca+(oa*80|0)+20>>2];S=+g[ca+(oa*80|0)+36>>2];ha=+g[ca+(oa*80|0)+8>>2];R=+g[ca+(oa*80|0)+24>>2];O=+g[ca+(oa*80|0)+40>>2];ma=+g[ca+(oa*80|0)+48>>2];la=+g[ca+(oa*80|0)+52>>2];L=+g[ca+(oa*80|0)+56>>2];N=+g[aa+48>>2]+(na*ma+K*la+J*L);M=+g[aa+52>>2]+(ka*ma+ia*la+ga*L);L=+g[aa+56>>2]+(ja*ma+fa*la+Q*L);g[j>>2]=na*ea+K*da+J*V;g[j+4>>2]=na*U+K*T+J*S;g[j+8>>2]=na*ha+K*R+J*O;g[j+12>>2]=0.0;g[j+16>>2]=ka*ea+ia*da+ga*V;g[j+20>>2]=ka*U+ia*T+ga*S;g[j+24>>2]=ka*ha+ia*R+ga*O;g[j+28>>2]=0.0;g[j+32>>2]=ja*ea+fa*da+Q*V;g[j+36>>2]=ja*U+fa*T+Q*S;g[j+40>>2]=ja*ha+fa*R+Q*O;g[j+44>>2]=0.0;g[j+48>>2]=N;g[j+52>>2]=M;g[j+56>>2]=L;g[j+60>>2]=0.0;vc[c[(c[ba>>2]|0)+8>>2]&127](ba,j,j+112|0,j+96|0);ba=c[(c[f+16>>2]|0)+(h*12|0)+4>>2]|0;aa=c[m+24>>2]|0;oa=c[aa+(ba*80|0)+64>>2]|0;ca=c[e+12>>2]|0;L=+g[ca>>2];M=+g[ca+4>>2];N=+g[ca+8>>2];O=+g[ca+16>>2];Q=+g[ca+20>>2];R=+g[ca+24>>2];fa=+g[ca+32>>2];ha=+g[ca+36>>2];ja=+g[ca+40>>2];S=+g[aa+(ba*80|0)>>2];T=+g[aa+(ba*80|0)+16>>2];U=+g[aa+(ba*80|0)+32>>2];V=+g[aa+(ba*80|0)+4>>2];da=+g[aa+(ba*80|0)+20>>2];ea=+g[aa+(ba*80|0)+36>>2];ga=+g[aa+(ba*80|0)+8>>2];ia=+g[aa+(ba*80|0)+24>>2];ka=+g[aa+(ba*80|0)+40>>2];J=+g[aa+(ba*80|0)+48>>2];K=+g[aa+(ba*80|0)+52>>2];na=+g[aa+(ba*80|0)+56>>2];la=+g[ca+48>>2]+(L*J+M*K+N*na);ma=+g[ca+52>>2]+(O*J+Q*K+R*na);na=+g[ca+56>>2]+(fa*J+ha*K+ja*na);g[j>>2]=L*S+M*T+N*U;g[j+4>>2]=L*V+M*da+N*ea;g[j+8>>2]=L*ga+M*ia+N*ka;g[j+12>>2]=0.0;g[j+16>>2]=O*S+Q*T+R*U;g[j+20>>2]=O*V+Q*da+R*ea;g[j+24>>2]=O*ga+Q*ia+R*ka;g[j+28>>2]=0.0;g[j+32>>2]=fa*S+ha*T+ja*U;g[j+36>>2]=fa*V+ha*da+ja*ea;g[j+40>>2]=fa*ga+ha*ia+ja*ka;g[j+44>>2]=0.0;g[j+48>>2]=la;g[j+52>>2]=ma;g[j+56>>2]=na;g[j+60>>2]=0.0;vc[c[(c[oa>>2]|0)+8>>2]&127](oa,j,j+80|0,j+64|0);if(!(+g[j+112>>2]>+g[j+64>>2])?!(+g[j+96>>2]<+g[j+80>>2]):0)X=1;else X=0;if(!(!(+g[j+120>>2]>+g[j+72>>2])?!(+g[j+104>>2]<+g[j+88>>2]):0))X=0;if(!(+g[j+116>>2]>+g[j+68>>2])?!(+g[j+100>>2]<+g[j+84>>2]|X^1):0)break;Lb[c[c[W>>2]>>2]&511](W);X=c[b+4>>2]|0;Nb[c[(c[X>>2]|0)+60>>2]&127](X,W);X=c[f+16>>2]|0;W=c[X+(h*12|0)>>2]|0;X=c[X+(h*12|0)+4>>2]|0;$=c[b+16>>2]|0;if(($|0)==(c[b+20>>2]|0)?(l=($|0)==0?1:$<<1,($|0)<(l|0)):0){if(!l)Y=0;else{c[5004]=(c[5004]|0)+1;Y=fF((l*12|3)+16|0)|0;if(!Y)Y=0;else{c[(Y+19&-16)+ -4>>2]=Y;Y=Y+19&-16}$=c[b+16>>2]|0}if(($|0)>0){_=0;do{Z=Y+(_*12|0)|0;if(Z){oa=(c[b+24>>2]|0)+(_*12|0)|0;c[Z+0>>2]=c[oa+0>>2];c[Z+4>>2]=c[oa+4>>2];c[Z+8>>2]=c[oa+8>>2]}_=_+1|0}while((_|0)!=($|0))}Z=c[b+24>>2]|0;if(Z){if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[Z+ -4>>2]|0)}c[b+24>>2]=0}a[b+28>>0]=1;c[b+24>>2]=Y;c[b+20>>2]=l;$=c[b+16>>2]|0}Z=c[b+24>>2]|0;Y=Z+($*12|0)|0;if(Y){c[Y>>2]=W;c[Z+($*12|0)+4>>2]=X;c[Z+($*12|0)+8>>2]=0;$=c[b+16>>2]|0}c[b+16>>2]=$+1}while(0);h=h+1|0}while((h|0)<(c[f+8>>2]|0));d=b+24|0;e=b+16|0}else{d=b+24|0;e=b+16|0}if((c[e>>2]|0)>0){k=0;do{ca=c[n>>2]|0;oa=c[d>>2]|0;Yb[c[(c[ca>>2]|0)+8>>2]&31](ca,c[oa+(k*12|0)>>2]|0,c[oa+(k*12|0)+4>>2]|0)|0;k=k+1|0}while((k|0)<(c[e>>2]|0))}k=c[d>>2]|0;if(!k){a[b+28>>0]=1;c[d>>2]=0;c[e>>2]=0;oa=b+20|0;c[oa>>2]=0;i=j;return}if(a[b+28>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[k+ -4>>2]|0)}c[d>>2]=0;a[b+28>>0]=1;c[d>>2]=0;c[e>>2]=0;oa=b+20|0;c[oa>>2]=0;i=j;return}function WC(a){a=a|0;return}function XC(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 0.0}function YC(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function ZC(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,h=0,j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0,K=0;f=i;i=i+240|0;c[a+4>>2]=(c[a+4>>2]|0)+1;b=c[b+36>>2]|0;d=c[d+36>>2]|0;l=c[a+8>>2]|0;K=c[(c[l+4>>2]|0)+24>>2]|0;j=c[K+(b*80|0)+64>>2]|0;J=(c[(c[a+12>>2]|0)+4>>2]|0)+24|0;k=c[(c[J>>2]|0)+(d*80|0)+64>>2]|0;l=c[l+12>>2]|0;m=+g[l>>2];H=+g[l+4>>2];I=+g[l+8>>2];p=+g[l+16>>2];r=+g[l+20>>2];t=+g[l+24>>2];q=+g[l+32>>2];u=+g[l+36>>2];C=+g[l+40>>2];v=+g[K+(b*80|0)>>2];w=+g[K+(b*80|0)+16>>2];x=+g[K+(b*80|0)+32>>2];y=+g[K+(b*80|0)+4>>2];z=+g[K+(b*80|0)+20>>2];A=+g[K+(b*80|0)+36>>2];s=+g[K+(b*80|0)+8>>2];B=+g[K+(b*80|0)+24>>2];D=+g[K+(b*80|0)+40>>2];n=+g[K+(b*80|0)+48>>2];o=+g[K+(b*80|0)+52>>2];G=+g[K+(b*80|0)+56>>2];E=+g[l+48>>2]+(m*n+H*o+I*G);F=+g[l+52>>2]+(p*n+r*o+t*G);G=+g[l+56>>2]+(q*n+u*o+C*G);g[f+176>>2]=m*v+H*w+I*x;g[f+180>>2]=m*y+H*z+I*A;g[f+184>>2]=m*s+H*B+I*D;g[f+188>>2]=0.0;g[f+192>>2]=p*v+r*w+t*x;g[f+196>>2]=p*y+r*z+t*A;g[f+200>>2]=p*s+r*B+t*D;g[f+204>>2]=0.0;g[f+208>>2]=q*v+u*w+C*x;g[f+212>>2]=q*y+u*z+C*A;g[f+216>>2]=q*s+u*B+C*D;g[f+220>>2]=0.0;g[f+224>>2]=E;g[f+228>>2]=F;g[f+232>>2]=G;g[f+236>>2]=0.0;l=c[(c[a+12>>2]|0)+12>>2]|0;G=+g[l>>2];F=+g[l+4>>2];E=+g[l+8>>2];D=+g[l+16>>2];C=+g[l+20>>2];B=+g[l+24>>2];u=+g[l+32>>2];s=+g[l+36>>2];q=+g[l+40>>2];J=c[J>>2]|0;A=+g[J+(d*80|0)>>2];z=+g[J+(d*80|0)+16>>2];y=+g[J+(d*80|0)+32>>2];x=+g[J+(d*80|0)+4>>2];w=+g[J+(d*80|0)+20>>2];v=+g[J+(d*80|0)+36>>2];t=+g[J+(d*80|0)+8>>2];r=+g[J+(d*80|0)+24>>2];p=+g[J+(d*80|0)+40>>2];I=+g[J+(d*80|0)+48>>2];H=+g[J+(d*80|0)+52>>2];m=+g[J+(d*80|0)+56>>2];o=+g[l+48>>2]+(G*I+F*H+E*m);n=+g[l+52>>2]+(D*I+C*H+B*m);m=+g[l+56>>2]+(u*I+s*H+q*m);g[f+112>>2]=G*A+F*z+E*y;g[f+116>>2]=G*x+F*w+E*v;g[f+120>>2]=G*t+F*r+E*p;g[f+124>>2]=0.0;g[f+128>>2]=D*A+C*z+B*y;g[f+132>>2]=D*x+C*w+B*v;g[f+136>>2]=D*t+C*r+B*p;g[f+140>>2]=0.0;g[f+144>>2]=u*A+s*z+q*y;g[f+148>>2]=u*x+s*w+q*v;g[f+152>>2]=u*t+s*r+q*p;g[f+156>>2]=0.0;g[f+160>>2]=o;g[f+164>>2]=n;g[f+168>>2]=m;g[f+172>>2]=0.0;vc[c[(c[j>>2]|0)+8>>2]&127](j,f+176|0,f+96|0,f+80|0);vc[c[(c[k>>2]|0)+8>>2]&127](k,f+112|0,f+64|0,f+48|0);if(!(+g[f+96>>2]>+g[f+48>>2])?!(+g[f+80>>2]<+g[f+64>>2]):0)l=1;else l=0;if(!(!(+g[f+104>>2]>+g[f+56>>2])?!(+g[f+88>>2]<+g[f+72>>2]):0))l=0;if(+g[f+100>>2]>+g[f+52>>2]){i=f;return}if(+g[f+84>>2]<+g[f+68>>2]|l^1){i=f;return}J=c[a+8>>2]|0;K=c[J+8>>2]|0;c[f+24>>2]=J;c[f+28>>2]=j;c[f+32>>2]=K;c[f+36>>2]=f+176;c[f+40>>2]=-1;c[f+44>>2]=b;K=c[a+12>>2]|0;j=c[K+8>>2]|0;c[f>>2]=K;c[f+4>>2]=k;c[f+8>>2]=j;c[f+12>>2]=f+112;c[f+16>>2]=-1;c[f+20>>2]=d;j=c[a+28>>2]|0;c[4896]=(c[4896]|0)+1;k=((d<<16|b)+~((d<<16|b)<<15)>>10^(d<<16|b)+~((d<<16|b)<<15))*9|0;k=(c[j+12>>2]|0)+ -1&((k>>6^k)+~((k>>6^k)<<11)>>16^(k>>6^k)+~((k>>6^k)<<11));a:do if((k|0)<(c[j+32>>2]|0)?(h=c[(c[j+40>>2]|0)+(k<<2)>>2]|0,(h|0)!=-1):0){k=c[j+16>>2]|0;while(1){if((c[k+(h*12|0)>>2]|0)==(b|0)?(c[k+(h*12|0)+4>>2]|0)==(d|0):0)break;h=c[(c[j+60>>2]|0)+(h<<2)>>2]|0;if((h|0)==-1){e=17;break a}}if(k+(h*12|0)|0)h=c[k+(h*12|0)+8>>2]|0;else e=17}else e=17;while(0);if((e|0)==17){h=c[a+16>>2]|0;h=Tb[c[(c[h>>2]|0)+8>>2]&31](h,f+24|0,f,c[a+32>>2]|0)|0;K=c[a+28>>2]|0;c[(Yb[c[(c[K>>2]|0)+12>>2]&31](K,b,d)|0)+8>>2]=h}l=c[a+24>>2]|0;J=c[l+8>>2]|0;K=c[l+12>>2]|0;c[l+8>>2]=f+24;c[(c[a+24>>2]|0)+12>>2]=f;l=c[a+24>>2]|0;rc[c[(c[l>>2]|0)+8>>2]&127](l,-1,b);l=c[a+24>>2]|0;rc[c[(c[l>>2]|0)+12>>2]&127](l,-1,d);Jb[c[(c[h>>2]|0)+8>>2]&31](h,f+24|0,f,c[a+20>>2]|0,c[a+24>>2]|0);c[(c[a+24>>2]|0)+8>>2]=J;c[(c[a+24>>2]|0)+12>>2]=K;i=f;return}function _C(a,b){a=a|0;b=b|0;return}function $C(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=18432;c[a+12>>2]=18464;d=c[a+60>>2]|0;Nb[c[(c[d>>2]|0)+20>>2]&127](d,c[a+76>>2]|0);d=c[a+60>>2]|0;Nb[c[(c[d>>2]|0)+16>>2]&127](d,c[a+76>>2]|0);gF(a);i=b;return}function aD(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=18432;c[a+12>>2]=18464;d=c[a+60>>2]|0;Nb[c[(c[d>>2]|0)+20>>2]&127](d,c[a+76>>2]|0);d=c[a+60>>2]|0;Nb[c[(c[d>>2]|0)+16>>2]&127](d,c[a+76>>2]|0);i=b;return}function bD(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+76>>2]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+76>>2];c[d+4>>2]=h+1;i=e;return}function cD(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=18464;d=c[a+48>>2]|0;Nb[c[(c[d>>2]|0)+20>>2]&127](d,c[a+64>>2]|0);d=c[a+48>>2]|0;Nb[c[(c[d>>2]|0)+16>>2]&127](d,c[a+64>>2]|0);gF(a);i=b;return}function dD(a){a=a|0;var b=0,d=0;b=i;c[a>>2]=18464;d=c[a+48>>2]|0;Nb[c[(c[d>>2]|0)+20>>2]&127](d,c[a+64>>2]|0);d=c[a+48>>2]|0;Nb[c[(c[d>>2]|0)+16>>2]&127](d,c[a+64>>2]|0);i=b;return}function eD(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0.0,k=0.0,l=0.0,m=0,n=0,o=0.0,p=0;f=i;i=i+128|0;l=+g[b>>2];j=+g[b+16>>2];o=l<j?l:j;k=+g[b+32>>2];if((o<k?o:k)>+g[a+28>>2]){i=f;return}n=l>j?b:b+16|0;if(+g[(+g[n>>2]>k?n:b+32|0)>>2]<+g[a+12>>2]){i=f;return}j=+g[b+8>>2];k=+g[b+24>>2];o=j<k?j:k;l=+g[b+40>>2];if((o<l?o:l)>+g[a+36>>2]){i=f;return}n=j>k?b+8|0:b+24|0;if(+g[(+g[n>>2]>l?n:b+40|0)>>2]<+g[a+20>>2]){i=f;return}l=+g[b+4>>2];j=+g[b+20>>2];o=l<j?l:j;k=+g[b+36>>2];if((o<k?o:k)>+g[a+32>>2]){i=f;return}n=l>j?b+4|0:b+20|0;if(+g[(+g[n>>2]>k?n:b+36|0)>>2]<+g[a+16>>2]){i=f;return}h=c[a+48>>2]|0;m=c[a+4>>2]|0;if((c[(c[m+4>>2]|0)+4>>2]|0)>=20){i=f;return}c[f+32>>2]=0;g[f+36>>2]=1.0;g[f+40>>2]=1.0;g[f+44>>2]=1.0;g[f+48>>2]=0.0;c[f+76>>2]=0;c[f+24>>2]=16376;c[f+28>>2]=1;c[f+80>>2]=c[b+0>>2];c[f+84>>2]=c[b+4>>2];c[f+88>>2]=c[b+8>>2];c[f+92>>2]=c[b+12>>2];c[f+96>>2]=c[b+16>>2];c[f+100>>2]=c[b+20>>2];c[f+104>>2]=c[b+24>>2];c[f+108>>2]=c[b+28>>2];c[f+112>>2]=c[b+32>>2];c[f+116>>2]=c[b+36>>2];c[f+120>>2]=c[b+40>>2];c[f+124>>2]=c[b+44>>2];g[f+68>>2]=+g[a+56>>2];p=c[a+8>>2]|0;n=c[p+8>>2]|0;b=c[p+12>>2]|0;c[f>>2]=p;c[f+4>>2]=f+24;c[f+8>>2]=n;c[f+12>>2]=b;c[f+16>>2]=d;c[f+20>>2]=e;b=Tb[c[(c[h>>2]|0)+8>>2]&31](h,m,f,c[a+64>>2]|0)|0;m=c[a+44>>2]|0;n=c[m+8>>2]|0;if((c[n+8>>2]|0)==(c[(c[a+8>>2]|0)+8>>2]|0)){c[m+8>>2]=f;p=c[a+44>>2]|0;rc[c[(c[p>>2]|0)+8>>2]&127](p,d,e)}else{n=c[m+12>>2]|0;c[m+12>>2]=f;p=c[a+44>>2]|0;rc[c[(c[p>>2]|0)+12>>2]&127](p,d,e)}Jb[c[(c[b>>2]|0)+8>>2]&31](b,c[a+4>>2]|0,f,c[a+52>>2]|0,c[a+44>>2]|0);d=c[a+44>>2]|0;if((c[(c[d+8>>2]|0)+8>>2]|0)==(c[(c[a+8>>2]|0)+8>>2]|0))c[d+8>>2]=n;else c[d+12>>2]=n;Lb[c[c[b>>2]>>2]&511](b);Nb[c[(c[h>>2]|0)+60>>2]&127](h,b);c[f+24>>2]=15736;a=c[f+76>>2]|0;if(!a){i=f;return}Lb[c[c[a>>2]>>2]&511](a);a=c[f+76>>2]|0;if(!a){i=f;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=f;return}function fD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0;j=i;i=i+64|0;l=(a[b+8>>0]|0)!=0;k=l?e:d;e=l?d:e;d=c[e+4>>2]|0;if(((c[d+4>>2]|0)+ -21|0)>>>0>=9){i=j;return}if((c[(c[k+4>>2]|0)+4>>2]|0)>=20){i=j;return}m=+$b[c[(c[d>>2]|0)+48>>2]&15](d);c[h+4>>2]=c[b+76>>2];c[b+16>>2]=k;c[b+20>>2]=e;c[b+64>>2]=f;g[b+68>>2]=m;c[b+56>>2]=h;l=c[e+12>>2]|0;B=+g[l>>2];A=+g[l+16>>2];z=+g[l+32>>2];y=+g[l+4>>2];x=+g[l+20>>2];w=+g[l+36>>2];s=+g[l+8>>2];q=+g[l+24>>2];o=+g[l+40>>2];v=-+g[l+48>>2];u=-+g[l+52>>2];t=-+g[l+56>>2];l=c[k+12>>2]|0;K=+g[l>>2];J=+g[l+16>>2];I=+g[l+32>>2];H=+g[l+4>>2];G=+g[l+20>>2];F=+g[l+36>>2];E=+g[l+8>>2];D=+g[l+24>>2];C=+g[l+40>>2];r=+g[l+48>>2];p=+g[l+52>>2];n=+g[l+56>>2];g[j>>2]=B*K+A*J+z*I;g[j+4>>2]=B*H+A*G+z*F;g[j+8>>2]=B*E+A*D+z*C;g[j+12>>2]=0.0;g[j+16>>2]=y*K+x*J+w*I;g[j+20>>2]=y*H+x*G+w*F;g[j+24>>2]=y*E+x*D+w*C;g[j+28>>2]=0.0;g[j+32>>2]=s*K+q*J+o*I;g[j+36>>2]=s*H+q*G+o*F;g[j+40>>2]=s*E+q*D+o*C;g[j+44>>2]=0.0;g[j+48>>2]=B*v+A*u+z*t+(B*r+A*p+z*n);g[j+52>>2]=y*v+x*u+w*t+(y*r+x*p+w*n);g[j+56>>2]=s*v+q*u+o*t+(s*r+q*p+o*n);g[j+60>>2]=0.0;l=c[(c[b+16>>2]|0)+4>>2]|0;vc[c[(c[l>>2]|0)+8>>2]&127](l,j,b+24|0,b+40|0);g[b+40>>2]=+g[b+40>>2]+m;g[b+44>>2]=+g[b+44>>2]+m;g[b+48>>2]=+g[b+48>>2]+m;g[b+24>>2]=+g[b+24>>2]-m;g[b+28>>2]=+g[b+28>>2]-m;g[b+32>>2]=+g[b+32>>2]-m;l=c[b+76>>2]|0;e=c[e+8>>2]|0;c[l+740>>2]=c[k+8>>2];c[l+744>>2]=e;vc[c[(c[d>>2]|0)+64>>2]&127](d,b+12|0,b+24|0,b+40|0);k=c[h+4>>2]|0;do if(c[k+748>>2]|0){f=c[k+740>>2]|0;e=c[(c[h+8>>2]|0)+8>>2]|0;if((f|0)==(e|0)){xA(k,f+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);break}else{xA(k,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,e+4|0);break}}while(0);c[b+16>>2]=0;c[b+20>>2]=0;i=j;return}function gD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0,K=0.0,L=0.0,M=0.0,N=0.0,O=0.0,P=0.0,Q=0.0,R=0.0,S=0.0,T=0.0,U=0.0,V=0.0,W=0.0;h=i;i=i+240|0;f=(a[b+8>>0]|0)!=0;b=f?e:d;d=f?d:e;S=+g[b+116>>2]- +g[b+52>>2];T=+g[b+120>>2]- +g[b+56>>2];U=+g[b+124>>2]- +g[b+60>>2];V=+g[b+252>>2];if(S*S+T*T+U*U<V*V){V=1.0;i=h;return+V}n=+g[d+4>>2];p=+g[d+20>>2];r=+g[d+36>>2];z=+g[d+8>>2];A=+g[d+24>>2];B=+g[d+40>>2];j=+g[d+12>>2];C=+g[d+28>>2];E=+g[d+44>>2];R=-+g[d+52>>2];S=-+g[d+56>>2];T=-+g[d+60>>2];o=+g[b+4>>2];q=+g[b+20>>2];s=+g[b+36>>2];t=+g[b+8>>2];u=+g[b+24>>2];v=+g[b+40>>2];w=+g[b+12>>2];x=+g[b+28>>2];y=+g[b+44>>2];J=+g[b+52>>2];I=+g[b+56>>2];H=+g[b+60>>2];F=n*R+p*S+r*T+(n*J+p*I+r*H);G=z*R+A*S+B*T+(z*J+A*I+B*H);H=j*R+C*S+E*T+(j*J+C*I+E*H);I=+g[b+68>>2];J=+g[b+84>>2];K=+g[b+100>>2];L=+g[b+72>>2];M=+g[b+88>>2];N=+g[b+104>>2];O=+g[b+76>>2];P=+g[b+92>>2];m=+g[b+108>>2];U=+g[b+116>>2];V=+g[b+120>>2];D=+g[b+124>>2];l=n*R+p*S+r*T+(n*U+p*V+r*D);k=z*R+A*S+B*T+(z*U+A*V+B*D);D=j*R+C*S+E*T+(j*U+C*V+E*D);d=c[d+192>>2]|0;if(((c[d+4>>2]|0)+ -21|0)>>>0>=9){V=1.0;i=h;return+V}g[h+224>>2]=F;g[h+228>>2]=G;g[h+232>>2]=H;g[h+236>>2]=0.0;if(l<F){g[h+224>>2]=l;T=l}else T=F;if(k<G){g[h+228>>2]=k;U=k}else U=G;if(D<H){g[h+232>>2]=D;V=D}else V=H;g[h+208>>2]=F;g[h+212>>2]=G;g[h+216>>2]=H;g[h+220>>2]=0.0;if(F<l){g[h+208>>2]=l;Q=l}else Q=F;if(G<k){g[h+212>>2]=k;R=k}else R=G;if(H<D){g[h+216>>2]=D;S=D}else S=H;W=+g[b+248>>2];g[h+224>>2]=T-W;g[h+228>>2]=U-W;g[h+232>>2]=V-W;g[h+208>>2]=W+Q;g[h+212>>2]=W+R;g[h+216>>2]=W+S;c[h>>2]=18592;g[h+4>>2]=n*o+p*q+r*s;g[h+8>>2]=n*t+p*u+r*v;g[h+12>>2]=n*w+p*x+r*y;g[h+16>>2]=0.0;g[h+20>>2]=z*o+A*q+B*s;g[h+24>>2]=z*t+A*u+B*v;g[h+28>>2]=z*w+A*x+B*y;g[h+32>>2]=0.0;g[h+36>>2]=j*o+C*q+E*s;g[h+40>>2]=j*t+C*u+E*v;g[h+44>>2]=j*w+C*x+E*y;g[h+48>>2]=0.0;g[h+52>>2]=F;g[h+56>>2]=G;g[h+60>>2]=H;g[h+64>>2]=0.0;g[h+68>>2]=n*I+p*J+r*K;g[h+72>>2]=n*L+p*M+r*N;g[h+76>>2]=n*O+p*P+r*m;g[h+80>>2]=0.0;g[h+84>>2]=z*I+A*J+B*K;g[h+88>>2]=z*L+A*M+B*N;g[h+92>>2]=z*O+A*P+B*m;g[h+96>>2]=0.0;g[h+100>>2]=j*I+C*J+E*K;g[h+104>>2]=j*L+C*M+E*N;g[h+108>>2]=j*O+C*P+E*m;g[h+112>>2]=0.0;g[h+116>>2]=l;g[h+120>>2]=k;g[h+124>>2]=D;g[h+128>>2]=0.0;g[h+196>>2]=W;g[h+200>>2]=+g[b+244>>2];if(!d){W=1.0;i=h;return+W}vc[c[(c[d>>2]|0)+64>>2]&127](d,h,h+224|0,h+208|0);j=+g[h+200>>2];if(!(j<+g[b+244>>2])){W=1.0;i=h;return+W}g[b+244>>2]=j;W=j;i=h;return+W}function hD(a){a=a|0;return}function iD(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function jD(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0;e=i;i=i+784|0;g[e+712>>2]=1.0;c[e+716>>2]=0;c[e+720>>2]=0;c[e+724>>2]=0;c[e+728>>2]=0;g[e+732>>2]=1.0;c[e+736>>2]=0;c[e+740>>2]=0;c[e+744>>2]=0;c[e+748>>2]=0;g[e+752>>2]=1.0;f=e+756|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;c[e+536>>2]=9440;c[e+704>>2]=0;g[e+708>>2]=0.0;g[e+700>>2]=+g[b+200>>2];j=+g[b+196>>2];c[e+488>>2]=0;g[e+492>>2]=1.0;g[e+496>>2]=1.0;g[e+500>>2]=1.0;g[e+504>>2]=0.0;c[e+480>>2]=16680;c[e+484>>2]=8;g[e+508>>2]=j;g[e+524>>2]=j;c[e+384>>2]=0;g[e+388>>2]=1.0;g[e+392>>2]=1.0;g[e+396>>2]=1.0;g[e+400>>2]=0.0;g[e+420>>2]=.03999999910593033;c[e+428>>2]=0;c[e+376>>2]=16376;c[e+380>>2]=1;c[e+432>>2]=c[d+0>>2];c[e+436>>2]=c[d+4>>2];c[e+440>>2]=c[d+8>>2];c[e+444>>2]=c[d+12>>2];c[e+448>>2]=c[d+16>>2];c[e+452>>2]=c[d+20>>2];c[e+456>>2]=c[d+24>>2];c[e+460>>2]=c[d+28>>2];c[e+464>>2]=c[d+32>>2];c[e+468>>2]=c[d+36>>2];c[e+472>>2]=c[d+40>>2];c[e+476>>2]=c[d+44>>2];g[e+324>>2]=9999999747378752.0e-20;a[e+348>>0]=0;c[e>>2]=17152;c[e+4>>2]=e+16;c[e+8>>2]=e+480;c[e+12>>2]=e+376;if(RB(e,b+4|0,b+68|0,e+712|0,e+712|0,e+536|0)|0?(h=+g[e+700>>2],+g[b+200>>2]>h):0)g[b+200>>2]=h;c[e+376>>2]=15736;b=c[e+428>>2]|0;if(!b){i=e;return}Lb[c[c[b>>2]>>2]&511](b);b=c[e+428>>2]|0;if(!b){i=e;return}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=e;return}function kD(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function lD(a){a=a|0;return}function mD(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=18816;if((a[b+16>>0]|0)!=0?(e=c[b+20>>2]|0,(e|0)!=0):0){f=c[b+4>>2]|0;Nb[c[(c[f>>2]|0)+16>>2]&127](f,e)}gF(b);i=d;return}function nD(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=18816;if(!(a[b+16>>0]|0)){i=d;return}e=c[b+20>>2]|0;if(!e){i=d;return}b=c[b+4>>2]|0;Nb[c[(c[b>>2]|0)+16>>2]&127](b,e);i=d;return}function oD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0,m=0.0,n=0,o=0.0,p=0.0,q=0.0,r=0,s=0,t=0,u=0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0,J=0,K=0.0,L=0.0,M=0.0,N=0.0,O=0,R=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0,ca=0.0,da=0.0,ea=0.0,fa=0.0,ga=0.0,ha=0.0,ia=0.0,ja=0.0,ka=0.0,la=0.0,ma=0,na=0,oa=0,pa=0.0,qa=0.0,ra=0.0,sa=0,ta=0,ua=0,va=0,wa=0,xa=0,ya=0,za=0,Aa=0,Ba=0,Ca=0;j=i;i=i+832|0;r=c[b+20>>2]|0;if(!r){r=c[b+4>>2]|0;r=Yb[c[(c[r>>2]|0)+12>>2]&31](r,c[d+8>>2]|0,c[e+8>>2]|0)|0;c[b+20>>2]=r;a[b+16>>0]=1}c[h+4>>2]=r;l=c[d+4>>2]|0;k=c[e+4>>2]|0;u=c[l+4>>2]|0;if((u|0)==10?(c[k+4>>2]|0)==10:0){m=+g[(c[b+20>>2]|0)+752>>2];za=c[l+52>>2]|0;B=+g[l+(za<<2)+28>>2];o=+g[l+(((za+2|0)%3|0)<<2)+28>>2];Aa=c[k+52>>2]|0;C=+g[k+(Aa<<2)+28>>2];p=+g[k+(((Aa+2|0)%3|0)<<2)+28>>2];Ba=c[d+12>>2]|0;b=c[e+12>>2]|0;v=+g[Ba+(za<<2)>>2];q=+g[Ba+(za<<2)+16>>2];w=+g[Ba+(za<<2)+32>>2];D=+g[b+(Aa<<2)>>2];E=+g[b+(Aa<<2)+16>>2];A=+g[b+(Aa<<2)+32>>2];z=+g[b+48>>2]- +g[Ba+48>>2];y=+g[b+52>>2]- +g[Ba+52>>2];x=+g[b+56>>2]- +g[Ba+56>>2];F=1.0-(v*D+q*E+w*A)*(v*D+q*E+w*A);if(!(F==0.0)){G=(v*z+q*y+w*x-(v*D+q*E+w*A)*(D*z+E*y+A*x))/F;if(!(G<-B)){if(G>B)G=B}else G=-B}else G=0.0;F=(v*D+q*E+w*A)*G-(D*z+E*y+A*x);if(F<-C){F=(v*D+q*E+w*A)*-C+(v*z+q*y+w*x);if(!(F<-B))if(F>B)C=-C;else{B=F;C=-C}else{B=-B;C=-C}}else if(F>C){F=C*(v*D+q*E+w*A)+(v*z+q*y+w*x);if(!(F<-B)){if(!(F>B))B=F}else B=-B}else{B=G;C=F}D=D*C;E=E*C;A=A*C;z=D+(z-v*B);y=E+(y-q*B);B=A+(x-w*B);x=+Q(+(B*B+(z*z+y*y)));if(!(x-o-p>m)){do if(B*B+(z*z+y*y)<=1.4210854715202004e-14)if(+P(+w)>.7071067690849304){ra=1.0/+Q(+(q*q+w*w));g[j+320>>2]=0.0;g[j+324>>2]=-(w*ra);g[j+328>>2]=q*ra;z=0.0;v=-(w*ra);q=q*ra;break}else{ra=1.0/+Q(+(v*v+q*q));g[j+320>>2]=-(q*ra);g[j+324>>2]=v*ra;g[j+328>>2]=0.0;z=-(q*ra);v=v*ra;q=0.0;break}else{g[j+320>>2]=z*-(1.0/x);g[j+324>>2]=y*-(1.0/x);g[j+328>>2]=B*-(1.0/x);g[j+332>>2]=0.0;z=z*-(1.0/x);v=y*-(1.0/x);q=B*-(1.0/x)}while(0);qa=p*v+(E+ +g[b+52>>2]);ra=p*q+(A+ +g[b+56>>2]);g[j+304>>2]=p*z+(D+ +g[b+48>>2]);g[j+308>>2]=qa;g[j+312>>2]=ra;g[j+316>>2]=0.0}if(x-o-p<m){qc[c[(c[h>>2]|0)+16>>2]&15](h,j+320|0,j+304|0,x-o-p);r=c[h+4>>2]|0}if(!(c[r+748>>2]|0)){i=j;return}d=c[r+740>>2]|0;b=c[(c[h+8>>2]|0)+8>>2]|0;if((d|0)==(b|0)){xA(r,d+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=j;return}else{xA(r,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,b+4|0);i=j;return}}else ta=k+4|0;g[j+296>>2]=999999984306749400.0;J=c[b+8>>2]|0;O=c[b+12>>2]|0;c[j+88>>2]=13392;g[j+92>>2]=0.0;g[j+96>>2]=1.0;g[j+100>>2]=0.0;g[j+104>>2]=0.0;c[j+108>>2]=O;c[j+112>>2]=J;c[j+116>>2]=l;c[j+120>>2]=k;c[j+124>>2]=u;c[j+128>>2]=c[ta>>2];g[j+132>>2]=+$b[c[(c[l>>2]|0)+48>>2]&15](l);g[j+136>>2]=+$b[c[(c[k>>2]|0)+48>>2]&15](k);a[j+140>>0]=0;c[j+148>>2]=-1;c[j+160>>2]=1;c[j+164>>2]=1;c[j+116>>2]=l;c[j+120>>2]=k;qa=+$b[c[(c[l>>2]|0)+48>>2]&15](l);ra=+$b[c[(c[k>>2]|0)+48>>2]&15](k);ra=qa+ra+ +g[(c[b+20>>2]|0)+752>>2];g[j+296>>2]=ra*ra;J=c[d+12>>2]|0;c[j+168>>2]=c[J+0>>2];c[j+172>>2]=c[J+4>>2];c[j+176>>2]=c[J+8>>2];c[j+180>>2]=c[J+12>>2];O=j+184|0;c[O+0>>2]=c[J+16>>2];c[O+4>>2]=c[J+20>>2];c[O+8>>2]=c[J+24>>2];c[O+12>>2]=c[J+28>>2];I=j+200|0;c[I+0>>2]=c[J+32>>2];c[I+4>>2]=c[J+36>>2];c[I+8>>2]=c[J+40>>2];c[I+12>>2]=c[J+44>>2];na=j+216|0;c[na+0>>2]=c[J+48>>2];c[na+4>>2]=c[J+52>>2];c[na+8>>2]=c[J+56>>2];c[na+12>>2]=c[J+60>>2];J=j+232|0;r=c[e+12>>2]|0;c[J+0>>2]=c[r+0>>2];c[J+4>>2]=c[r+4>>2];c[J+8>>2]=c[r+8>>2];c[J+12>>2]=c[r+12>>2];ba=j+248|0;c[ba+0>>2]=c[r+16>>2];c[ba+4>>2]=c[r+20>>2];c[ba+8>>2]=c[r+24>>2];c[ba+12>>2]=c[r+28>>2];ma=j+264|0;c[ma+0>>2]=c[r+32>>2];c[ma+4>>2]=c[r+36>>2];c[ma+8>>2]=c[r+40>>2];c[ma+12>>2]=c[r+44>>2];u=j+280|0;c[u+0>>2]=c[r+48>>2];c[u+4>>2]=c[r+52>>2];c[u+8>>2]=c[r+56>>2];c[u+12>>2]=c[r+60>>2];r=c[l+4>>2]|0;do if((r|0)<7?(s=c[ta>>2]|0,(s|0)<7):0){c[j+80>>2]=19224;if(!r)q=0.0;else{q=+$b[c[(c[l>>2]|0)+48>>2]&15](l);s=c[ta>>2]|0}if(!s)x=0.0;else x=+$b[c[(c[k>>2]|0)+48>>2]&15](k);c[j+40>>2]=19032;c[j+44>>2]=h;g[j+64>>2]=q;g[j+68>>2]=x;a[j+76>>0]=0;s=c[l+52>>2]|0;if(s){r=c[k+52>>2]|0;if(!r){if((c[ta>>2]|0)!=1)break;u=j+32|0;a[u>>0]=1;r=j+28|0;c[r>>2]=0;s=j+20|0;c[s>>2]=0;n=j+24|0;c[n>>2]=0;I=c[e+12>>2]|0;qa=+g[k+56>>2];ra=+g[k+60>>2];p=+g[k+64>>2];m=qa*+g[I>>2]+ra*+g[I+4>>2]+p*+g[I+8>>2]+ +g[I+48>>2];o=qa*+g[I+16>>2]+ra*+g[I+20>>2]+p*+g[I+24>>2]+ +g[I+52>>2];p=qa*+g[I+32>>2]+ra*+g[I+36>>2]+p*+g[I+40>>2]+ +g[I+56>>2];c[5004]=(c[5004]|0)+1;I=fF(35)|0;if(!I)I=0;else{c[(I+19&-16)+ -4>>2]=I;I=I+19&-16}J=c[r>>2]|0;if(J){if(a[u>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[J+ -4>>2]|0)}c[r>>2]=0}a[u>>0]=1;c[r>>2]=I;c[n>>2]=1;J=c[s>>2]|0;g[I+(J<<4)>>2]=m;g[I+(J<<4)+4>>2]=o;g[I+(J<<4)+8>>2]=p;g[I+(J<<4)+12>>2]=0.0;J=c[s>>2]|0;c[s>>2]=J+1;I=c[e+12>>2]|0;qa=+g[k+72>>2];ra=+g[k+76>>2];o=+g[k+80>>2];m=qa*+g[I>>2]+ra*+g[I+4>>2]+o*+g[I+8>>2]+ +g[I+48>>2];p=qa*+g[I+16>>2]+ra*+g[I+20>>2]+o*+g[I+24>>2]+ +g[I+52>>2];o=qa*+g[I+32>>2]+ra*+g[I+36>>2]+o*+g[I+40>>2]+ +g[I+56>>2];I=c[n>>2]|0;if((J+1|0)==(I|0)){I=(J+1|0)==0?1:J+1<<1;if((J+1|0)<(I|0)){if((I|0)!=0?(c[5004]=(c[5004]|0)+1,sa=fF((I<<4|3)+16|0)|0,(sa|0)!=0):0){c[(sa+19&-16)+ -4>>2]=sa;O=sa+19&-16}else O=0;if((J|0)>-1){ba=0;do{Ba=O+(ba<<4)|0;Aa=(c[r>>2]|0)+(ba<<4)|0;c[Ba+0>>2]=c[Aa+0>>2];c[Ba+4>>2]=c[Aa+4>>2];c[Ba+8>>2]=c[Aa+8>>2];c[Ba+12>>2]=c[Aa+12>>2];ba=ba+1|0}while((ba|0)!=(J+1|0))}J=c[r>>2]|0;if(J){if(a[u>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[J+ -4>>2]|0)}c[r>>2]=0}a[u>>0]=1;c[r>>2]=O;c[n>>2]=I;O=c[s>>2]|0}else{O=J+1|0;I=J+1|0}}else O=J+1|0;J=c[r>>2]|0;g[J+(O<<4)>>2]=m;g[J+(O<<4)+4>>2]=p;g[J+(O<<4)+8>>2]=o;g[J+(O<<4)+12>>2]=0.0;O=O+1|0;c[s>>2]=O;Ba=c[e+12>>2]|0;qa=+g[k+88>>2];ra=+g[k+92>>2];o=+g[k+96>>2];p=qa*+g[Ba>>2]+ra*+g[Ba+4>>2]+o*+g[Ba+8>>2]+ +g[Ba+48>>2];m=qa*+g[Ba+16>>2]+ra*+g[Ba+20>>2]+o*+g[Ba+24>>2]+ +g[Ba+52>>2];o=qa*+g[Ba+32>>2]+ra*+g[Ba+36>>2]+o*+g[Ba+40>>2]+ +g[Ba+56>>2];if((O|0)==(I|0)){e=(I|0)==0?1:I<<1;if((I|0)<(e|0)){if((e|0)!=0?(c[5004]=(c[5004]|0)+1,oa=fF((e<<4|3)+16|0)|0,(oa|0)!=0):0){c[(oa+19&-16)+ -4>>2]=oa;J=oa+19&-16}else J=0;if((I|0)>0){O=0;do{Ba=J+(O<<4)|0;Aa=(c[r>>2]|0)+(O<<4)|0;c[Ba+0>>2]=c[Aa+0>>2];c[Ba+4>>2]=c[Aa+4>>2];c[Ba+8>>2]=c[Aa+8>>2];c[Ba+12>>2]=c[Aa+12>>2];O=O+1|0}while((O|0)!=(I|0))}I=c[r>>2]|0;if(I){if(a[u>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[I+ -4>>2]|0)}c[r>>2]=0}a[u>>0]=1;c[r>>2]=J;c[n>>2]=e;I=c[s>>2]|0}}else I=O;g[J+(I<<4)>>2]=p;g[J+(I<<4)+4>>2]=m;g[J+(I<<4)+8>>2]=o;g[J+(I<<4)+12>>2]=0.0;c[s>>2]=(c[s>>2]|0)+1;m=+g[(c[b+20>>2]|0)+752>>2];Az(j+88|0,j+168|0,j+80|0,c[f+20>>2]|0,0);o=+g[j+92>>2];q=+g[j+96>>2];p=+g[j+100>>2];if(o*o+q*q+p*p>1.1920928955078125e-7){qa=1.0/(o*o+q*q+p*p);g[j>>2]=o*qa;g[j+4>>2]=q*qa;g[j+8>>2]=p*qa;g[j+12>>2]=0.0;qa=+g[j+144>>2];ra=+$b[c[(c[l>>2]|0)+48>>2]&15](l);ra=qa-ra- +$b[c[(c[k>>2]|0)+48>>2]&15](k);cE(j,c[l+52>>2]|0,c[d+12>>2]|0,j+16|0,ra-m,m,h)}do if((a[b+16>>0]|0)!=0?(t=c[h+4>>2]|0,(c[t+748>>2]|0)!=0):0){d=c[t+740>>2]|0;b=c[(c[h+8>>2]|0)+8>>2]|0;if((d|0)==(b|0)){xA(t,d+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);break}else{xA(t,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,b+4|0);break}}while(0);h=c[r>>2]|0;if(h){if(a[u>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[r>>2]=0}a[u>>0]=1;c[r>>2]=0;c[s>>2]=0;c[n>>2]=0;i=j;return}m=+g[(c[b+20>>2]|0)+752>>2];if(!(a[f+24>>0]|0)){Az(j+88|0,j+168|0,j+40|0,c[f+20>>2]|0,0);o=+g[j+72>>2];if((a[j+76>>0]|0)!=0&o<0.0){L=+g[j+48>>2];M=+g[j+52>>2];H=+g[j+56>>2];K=+g[j+60>>2];n=105}}else{f=c[d+12>>2]|0;t=c[e+12>>2]|0;c[4920]=(c[4920]|0)+1;ka=+g[s+64>>2];la=+g[s+68>>2];y=+g[f+4>>2];pa=+g[s+72>>2];z=+g[f+8>>2];A=+g[f+16>>2];B=+g[f+20>>2];D=+g[f+24>>2];C=+g[f+32>>2];E=+g[f+36>>2];F=+g[f+40>>2];qa=+g[r+64>>2];ra=+g[r+68>>2];o=+g[r+72>>2];q=ka*+g[f>>2]+la*y+pa*z+ +g[f+48>>2]-(qa*+g[t>>2]+ra*+g[t+4>>2]+o*+g[t+8>>2]+ +g[t+48>>2]);p=ka*A+la*B+pa*D+ +g[f+52>>2]-(qa*+g[t+16>>2]+ra*+g[t+20>>2]+o*+g[t+24>>2]+ +g[t+52>>2]);o=ka*C+la*E+pa*F+ +g[f+56>>2]-(qa*+g[t+32>>2]+ra*+g[t+36>>2]+o*+g[t+40>>2]+ +g[t+56>>2]);u=c[s+28>>2]|0;a:do if((u|0)>0){x=0.0;R=3.4028234663852886e+38;I=0;L=0.0;M=0.0;H=0.0;K=0.0;while(1){Ba=c[s+36>>2]|0;pa=+g[Ba+(I*36|0)+20>>2];qa=+g[Ba+(I*36|0)+24>>2];ra=+g[Ba+(I*36|0)+28>>2];y=pa*+g[f>>2]+qa*y+ra*z;z=pa*A+qa*B+ra*D;A=pa*C+qa*E+ra*F;g[j+400>>2]=y;g[j+404>>2]=z;g[j+408>>2]=A;g[j+412>>2]=0.0;if(q*y+p*z+o*A<0.0){g[j+400>>2]=y*-1.0;g[j+404>>2]=z*-1.0;g[j+408>>2]=A*-1.0;y=y*-1.0;z=z*-1.0;A=A*-1.0}c[4916]=(c[4916]|0)+1;if(bE(f,t,q,p,o,y,z,A,s,r,R)|0){c[4918]=(c[4918]|0)+1;ND(s,f,j+400|0,j+808|0,j+784|0,j+464|0,j+448|0);ND(r,t,j+400|0,j+720|0,j+480|0,j+432|0,j+416|0);z=+g[j+784>>2];y=+g[j+720>>2];if(!(z<y)?(w=+g[j+480>>2],v=+g[j+808>>2],!(w<v)):0){J=1;y=z-y<w-v?z-y:w-v}else{J=0;y=x}if(!J){r=0;break a}if(y<R){x=y;R=y;L=+g[j+400>>2];M=+g[j+404>>2];H=+g[j+408>>2];K=+g[j+412>>2]}else x=y}I=I+1|0;if((I|0)>=(u|0)){n=52;break a}y=+g[f+4>>2];z=+g[f+8>>2];A=+g[f+16>>2];B=+g[f+20>>2];D=+g[f+24>>2];C=+g[f+32>>2];E=+g[f+36>>2];F=+g[f+40>>2]}}else{R=3.4028234663852886e+38;L=0.0;M=0.0;H=0.0;K=0.0;n=52}while(0);b:do if((n|0)==52){u=c[r+28>>2]|0;if((u|0)>0){v=0.0;I=0;do{Ba=c[r+36>>2]|0;qa=+g[Ba+(I*36|0)+20>>2];ra=+g[Ba+(I*36|0)+24>>2];x=+g[Ba+(I*36|0)+28>>2];w=qa*+g[t>>2]+ra*+g[t+4>>2]+x*+g[t+8>>2];y=qa*+g[t+16>>2]+ra*+g[t+20>>2]+x*+g[t+24>>2];x=qa*+g[t+32>>2]+ra*+g[t+36>>2]+x*+g[t+40>>2];g[j+384>>2]=w;g[j+388>>2]=y;g[j+392>>2]=x;g[j+396>>2]=0.0;if(q*w+p*y+o*x<0.0){g[j+384>>2]=w*-1.0;g[j+388>>2]=y*-1.0;g[j+392>>2]=x*-1.0;w=w*-1.0;y=y*-1.0;x=x*-1.0}c[4916]=(c[4916]|0)+1;do if(bE(f,t,q,p,o,w,y,x,s,r,R)|0){c[4918]=(c[4918]|0)+1;ND(s,f,j+384|0,j+808|0,j+784|0,j+464|0,j+448|0);ND(r,t,j+384|0,j+720|0,j+480|0,j+432|0,j+416|0);y=+g[j+784>>2];x=+g[j+720>>2];do if(y<x){J=0;w=v}else{w=+g[j+480>>2];z=+g[j+808>>2];if(w<z){J=0;w=v;break}J=1;w=y-x<w-z?y-x:w-z}while(0);if(!J){r=0;break b}if(!(w<R)){v=w;break}v=w;R=w;L=+g[j+384>>2];M=+g[j+388>>2];H=+g[j+392>>2];K=+g[j+396>>2]}while(0);I=I+1|0}while((I|0)<(u|0))}J=c[s+48>>2]|0;if((J|0)>0){y=0.0;z=0.0;A=0.0;B=0.0;C=0.0;D=0.0;F=0.0;E=0.0;G=0.0;N=0.0;W=0.0;Y=0.0;Z=0.0;X=0.0;V=0.0;U=0.0;_=0.0;$=0.0;aa=0.0;ba=c[r+48>>2]|0;u=0;O=-1;I=-1;while(1){Ba=c[s+56>>2]|0;qa=+g[Ba+(u<<4)>>2];ra=+g[Ba+(u<<4)+4>>2];w=+g[Ba+(u<<4)+8>>2];x=qa*+g[f>>2]+ra*+g[f+4>>2]+w*+g[f+8>>2];v=qa*+g[f+16>>2]+ra*+g[f+20>>2]+w*+g[f+24>>2];w=qa*+g[f+32>>2]+ra*+g[f+36>>2]+w*+g[f+40>>2];if((ba|0)>0){J=0;do{Ba=c[r+56>>2]|0;qa=+g[Ba+(J<<4)>>2];ra=+g[Ba+(J<<4)+4>>2];ha=+g[Ba+(J<<4)+8>>2];ea=qa*+g[t>>2]+ra*+g[t+4>>2]+ha*+g[t+8>>2];ga=qa*+g[t+16>>2]+ra*+g[t+20>>2]+ha*+g[t+24>>2];ha=qa*+g[t+32>>2]+ra*+g[t+36>>2]+ha*+g[t+40>>2];g[j+368>>2]=v*ha-w*ga;g[j+372>>2]=w*ea-x*ha;g[j+376>>2]=x*ga-v*ea;g[j+380>>2]=0.0;do if(!(+P(+(v*ha-w*ga))>1.0e-6)){if(+P(+(w*ea-x*ha))>1.0e-6){n=70;break}if(+P(+(x*ga-v*ea))>1.0e-6)n=70}else n=70;while(0);do if((n|0)==70){n=0;ca=1.0/+Q(+((v*ha-w*ga)*(v*ha-w*ga)+(w*ea-x*ha)*(w*ea-x*ha)+(x*ga-v*ea)*(x*ga-v*ea)));da=(v*ha-w*ga)*ca;g[j+368>>2]=da;fa=(w*ea-x*ha)*ca;g[j+372>>2]=fa;ca=(x*ga-v*ea)*ca;g[j+376>>2]=ca;if(q*da+p*fa+o*ca<0.0){g[j+368>>2]=da*-1.0;g[j+372>>2]=fa*-1.0;g[j+376>>2]=ca*-1.0;da=da*-1.0;fa=fa*-1.0;ca=ca*-1.0}c[4916]=(c[4916]|0)+1;if(!(bE(f,t,q,p,o,da,fa,ca,s,r,R)|0))break;c[4918]=(c[4918]|0)+1;ND(s,f,j+368|0,j+808|0,j+784|0,j+464|0,j+448|0);ND(r,t,j+368|0,j+720|0,j+480|0,j+432|0,j+416|0);ka=+g[j+784>>2];qa=+g[j+720>>2];do if(!(ka<qa)){pa=+g[j+480>>2];ra=+g[j+808>>2];if(pa<ra){ba=0;la=Z;ja=Y;ia=W;fa=F;ca=D;da=C;ka=y;break}if(ka-qa<pa-ra){ba=1;la=+g[j+456>>2];ja=+g[j+452>>2];ia=+g[j+448>>2];fa=+g[j+440>>2];ca=+g[j+436>>2];da=+g[j+432>>2];ka=ka-qa;break}else{ba=1;la=+g[j+472>>2];ja=+g[j+468>>2];ia=+g[j+464>>2];fa=+g[j+424>>2];ca=+g[j+420>>2];da=+g[j+416>>2];ka=pa-ra;break}}else{ba=0;la=Z;ja=Y;ia=W;fa=F;ca=D;da=C;ka=y}while(0);if(!ba){r=0;break b}if(!(ka<R)){Z=la;Y=ja;W=ia;F=fa;D=ca;C=da;y=ka;break}aa=w;$=v;_=x;U=ha;V=ga;X=ea;Z=la;Y=ja;W=ia;N=la;G=ja;E=ia;F=fa;D=ca;C=da;B=fa;A=ca;z=da;y=ka;R=ka;O=u;I=J;L=+g[j+368>>2];M=+g[j+372>>2];H=+g[j+376>>2];K=+g[j+380>>2]}while(0);J=J+1|0;ba=c[r+48>>2]|0}while((J|0)<(ba|0));v=aa;w=$;x=_;J=c[s+48>>2]|0}else{v=aa;w=$;x=_}u=u+1|0;if((u|0)>=(J|0))break;else{_=x;$=w;aa=v}}}else{v=0.0;w=0.0;x=0.0;U=0.0;V=0.0;X=0.0;N=0.0;G=0.0;E=0.0;B=0.0;A=0.0;z=0.0;O=-1;I=-1}if((I|O|0)>-1){C=z-E;D=A-G;y=B-N;N=x*X+w*V+v*U;F=x*C+w*D+v*y;G=X*C+V*D+U*y;do if(!(1.0-N*N==0.0))if((F-N*G)/(1.0-N*N)<-1.0000000150474662e+30)E=-1.0000000150474662e+30;else{if(!((F-N*G)/(1.0-N*N)>1.0000000150474662e+30)){E=(F-N*G)/(1.0-N*N);break}E=1.0000000150474662e+30}else E=0.0;while(0);G=N*E-G;do if(G<-1.0000000150474662e+30){if(N*-1.0000000150474662e+30+F<-1.0000000150474662e+30){E=-1.0000000150474662e+30;N=-1.0000000150474662e+30;break}if(!(N*-1.0000000150474662e+30+F>1.0000000150474662e+30)){E=N*-1.0000000150474662e+30+F;N=-1.0000000150474662e+30;break}E=1.0000000150474662e+30;N=-1.0000000150474662e+30}else{if(!(G>1.0000000150474662e+30)){N=G;break}if(N*1.0000000150474662e+30+F<-1.0000000150474662e+30){E=-1.0000000150474662e+30;N=1.0000000150474662e+30;break}if(!(N*1.0000000150474662e+30+F>1.0000000150474662e+30)){E=N*1.0000000150474662e+30+F;N=1.0000000150474662e+30;break}E=1.0000000150474662e+30;N=1.0000000150474662e+30}while(0);F=X*N;G=N*V;N=N*U;x=C-x*E+F;w=D-E*w+G;y=y-E*v+N;g[j+352>>2]=x;g[j+356>>2]=w;g[j+360>>2]=y;g[j+364>>2]=0.0;if(x*x+w*w+y*y>1.1920928955078125e-7){v=+Q(+(x*x+w*w+y*y));g[j+352>>2]=x*(1.0/v);g[j+356>>2]=1.0/v*w;g[j+360>>2]=1.0/v*y;if(x*(1.0/v)*q+1.0/v*w*p+1.0/v*y*o<0.0){g[j+352>>2]=x*(1.0/v)*-1.0;g[j+356>>2]=1.0/v*w*-1.0;g[j+360>>2]=1.0/v*y*-1.0}g[j+336>>2]=z+F;g[j+340>>2]=A+G;g[j+344>>2]=B+N;g[j+348>>2]=0.0;qc[c[(c[h>>2]|0)+16>>2]&15](h,j+352|0,j+336|0,-v)}}if(q*L+p*M+o*H<0.0){r=1;L=-L;M=-M;H=-H;K=0.0}else r=1}while(0);if(r){o=-1.0000000150474662e+30;n=105}}if((n|0)==105){l=c[l+52>>2]|0;k=c[k+52>>2]|0;d=c[d+12>>2]|0;e=c[e+12>>2]|0;o=o-m;v=1.0/+Q(+(L*L+M*M+H*H));p=L*v;q=M*v;v=H*v;g[j+808>>2]=p;g[j+812>>2]=q;g[j+816>>2]=v;g[j+820>>2]=K;f=c[k+28>>2]|0;n=c[k+36>>2]|0;if((f|0)>0){w=+g[e>>2];x=+g[e+4>>2];A=+g[e+8>>2];D=+g[e+16>>2];E=+g[e+20>>2];H=+g[e+24>>2];G=+g[e+32>>2];C=+g[e+36>>2];B=+g[e+40>>2];t=-1;K=-3.4028234663852886e+38;r=0;while(1){y=+g[n+(r*36|0)+20>>2];z=+g[n+(r*36|0)+24>>2];F=+g[n+(r*36|0)+28>>2];s=(y*w+z*x+F*A)*p+(y*D+z*E+F*H)*q+(y*G+z*C+F*B)*v>K;t=s?r:t;r=r+1|0;if((r|0)>=(f|0)){s=t;break}else K=s?(y*w+z*x+F*A)*p+(y*D+z*E+F*H)*q+(y*G+z*C+F*B)*v:K}}else s=-1;a[j+800>>0]=1;r=j+796|0;c[r>>2]=0;c[j+788>>2]=0;c[j+792>>2]=0;f=c[n+(s*36|0)+4>>2]|0;c:do if((f|0)>0){n=n+(s*36|0)+12|0;O=0;J=0;u=0;t=0;while(1){Ba=c[(c[n>>2]|0)+(t<<2)>>2]|0;Aa=c[k+16>>2]|0;qa=+g[Aa+(Ba<<4)>>2];ra=+g[Aa+(Ba<<4)+4>>2];v=+g[Aa+(Ba<<4)+8>>2];p=qa*+g[e>>2]+ra*+g[e+4>>2]+v*+g[e+8>>2]+ +g[e+48>>2];q=qa*+g[e+16>>2]+ra*+g[e+20>>2]+v*+g[e+24>>2]+ +g[e+52>>2];v=qa*+g[e+32>>2]+ra*+g[e+36>>2]+v*+g[e+40>>2]+ +g[e+56>>2];if((O|0)==(u|0)){I=(u|0)==0?1:u<<1;if((u|0)<(I|0)){do if(!I)J=0;else{c[5004]=(c[5004]|0)+1;J=fF((I<<4|3)+16|0)|0;if(!J){J=0;break}c[(J+19&-16)+ -4>>2]=J;J=J+19&-16}while(0);if((u|0)>0){O=0;do{Ba=J+(O<<4)|0;Aa=(c[r>>2]|0)+(O<<4)|0;c[Ba+0>>2]=c[Aa+0>>2];c[Ba+4>>2]=c[Aa+4>>2];c[Ba+8>>2]=c[Aa+8>>2];c[Ba+12>>2]=c[Aa+12>>2];O=O+1|0}while((O|0)!=(u|0))}u=c[r>>2]|0;if(u){if(a[j+800>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[u+ -4>>2]|0)}c[r>>2]=0}a[j+800>>0]=1;c[r>>2]=J;c[j+792>>2]=I;I=J;u=c[j+788>>2]|0}else I=J}else{I=J;u=O}g[I+(u<<4)>>2]=p;g[I+(u<<4)+4>>2]=q;g[I+(u<<4)+8>>2]=v;g[I+(u<<4)+12>>2]=0.0;O=(c[j+788>>2]|0)+1|0;c[j+788>>2]=O;t=t+1|0;if((t|0)>=(f|0))break c;J=I;u=c[j+792>>2]|0}}else I=0;while(0);if((s|0)>-1){cE(j+808|0,l,d,j+784|0,o,m,h);I=c[r>>2]|0}if(I){if(a[j+800>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[I+ -4>>2]|0)}c[r>>2]=0}}if(!(a[b+16>>0]|0)){i=j;return}e=c[h+4>>2]|0;if(!(c[e+748>>2]|0)){i=j;return}d=c[e+740>>2]|0;b=c[(c[h+8>>2]|0)+8>>2]|0;if((d|0)==(b|0)){xA(e,d+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=j;return}else{xA(e,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,b+4|0);i=j;return}}}while(0);Az(j+88|0,j+168|0,h,c[f+20>>2]|0,0);if(((c[b+28>>2]|0)!=0?(c[(c[h+4>>2]|0)+748>>2]|0)<(c[b+32>>2]|0):0)?(p=+g[j+92>>2],m=+g[j+96>>2],o=+g[j+100>>2],p*p+m*m+o*o>1.1920928955078125e-7):0){q=1.0/(p*p+m*m+o*o);if(+P(+(o*q))>.7071067690849304){z=1.0/+Q(+(o*q*o*q+m*q*m*q));x=0.0;y=-(o*q*z);z=m*q*z}else{y=1.0/+Q(+(p*q*p*q+m*q*m*q));x=-(m*q*y);y=p*q*y;z=0.0}v=+$b[c[(c[l>>2]|0)+16>>2]&15](l);w=+$b[c[(c[k>>2]|0)+16>>2]&15](k);A=.019999999552965164/(v<w?v:w);if(v<w){c[j+720>>2]=c[j+168>>2];c[j+724>>2]=c[j+172>>2];c[j+728>>2]=c[j+176>>2];c[j+732>>2]=c[j+180>>2];c[j+736>>2]=c[O+0>>2];c[j+740>>2]=c[O+4>>2];c[j+744>>2]=c[O+8>>2];c[j+748>>2]=c[O+12>>2];c[j+752>>2]=c[I+0>>2];c[j+756>>2]=c[I+4>>2];c[j+760>>2]=c[I+8>>2];c[j+764>>2]=c[I+12>>2];c[j+768>>2]=c[na+0>>2];c[j+772>>2]=c[na+4>>2];c[j+776>>2]=c[na+8>>2];c[j+780>>2]=c[na+12>>2]}else{c[j+720>>2]=c[J+0>>2];c[j+724>>2]=c[J+4>>2];c[j+728>>2]=c[J+8>>2];c[j+732>>2]=c[J+12>>2];c[j+736>>2]=c[ba+0>>2];c[j+740>>2]=c[ba+4>>2];c[j+744>>2]=c[ba+8>>2];c[j+748>>2]=c[ba+12>>2];c[j+752>>2]=c[ma+0>>2];c[j+756>>2]=c[ma+4>>2];c[j+760>>2]=c[ma+8>>2];c[j+764>>2]=c[ma+12>>2];c[j+768>>2]=c[u+0>>2];c[j+772>>2]=c[u+4>>2];c[j+776>>2]=c[u+8>>2];c[j+780>>2]=c[u+12>>2]}Aa=c[b+28>>2]|0;if((Aa|0)>0){B=z*z+(y*y+x*x);A=A>.39269909262657166?.19634954631328583:A*.5;ya=j+516|0;va=j+532|0;xa=j+548|0;oa=j+564|0;wa=j+580|0;k=j+596|0;n=j+612|0;r=j+628|0;t=j+644|0;ta=j+660|0;l=j+736|0;s=j+676|0;ua=j+752|0;sa=j+692|0;za=j+768|0;if(B>1.1920928955078125e-7){B=+T(+A)/+Q(+B);x=x*B;y=y*B;z=z*B;B=+S(+A);A=+Q(+(o*q*o*q+(p*q*p*q+m*q*m*q)));if(v<w){Ba=0;do{aa=+(Ba|0)*(6.2831854820251465/+(Aa|0))*.5;la=+T(+aa)/A;aa=+S(+aa);ha=z*-(m*q*la)+(x*aa+B*-(p*q*la))-y*-(o*q*la);qa=x*-(o*q*la)+(y*aa+B*-(m*q*la))-z*-(p*q*la);ia=y*-(p*q*la)+(z*aa+B*-(o*q*la))-x*-(m*q*la);$=B*aa-x*-(p*q*la)-y*-(m*q*la)-z*-(o*q*la);ka=o*q*la*qa+(p*q*la*$+aa*ha)-m*q*la*ia;pa=p*q*la*ia+(aa*qa+m*q*la*$)-o*q*la*ha;_=m*q*la*ha+(o*q*la*$+aa*ia)-p*q*la*qa;ia=aa*$-p*q*la*ha-m*q*la*qa-o*q*la*ia;la=ka*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));qa=pa*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));ha=_*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));Ca=c[d+12>>2]|0;$=+g[Ca>>2];aa=+g[Ca+16>>2];ca=+g[Ca+32>>2];da=+g[Ca+4>>2];ea=+g[Ca+20>>2];fa=+g[Ca+36>>2];ga=+g[Ca+8>>2];ja=+g[Ca+24>>2];ra=+g[Ca+40>>2];g[j+168>>2]=(ka*ha+ia*qa)*ca+(aa*(ka*qa-ia*ha)+$*(1.0-(pa*qa+_*ha)));g[j+172>>2]=(1.0-(pa*qa+_*ha))*da+(ka*qa-ia*ha)*ea+(ka*ha+ia*qa)*fa;g[j+176>>2]=(1.0-(pa*qa+_*ha))*ga+(ka*qa-ia*ha)*ja+(ka*ha+ia*qa)*ra;g[j+180>>2]=0.0;g[j+184>>2]=(pa*ha-ia*la)*ca+($*(ka*qa+ia*ha)+aa*(1.0-(ka*la+_*ha)));g[j+188>>2]=(ka*qa+ia*ha)*da+(1.0-(ka*la+_*ha))*ea+(pa*ha-ia*la)*fa;g[j+192>>2]=(ka*qa+ia*ha)*ga+(1.0-(ka*la+_*ha))*ja+(pa*ha-ia*la)*ra;g[j+196>>2]=0.0;g[j+200>>2]=$*(ka*ha-ia*qa)+aa*(pa*ha+ia*la)+ca*(1.0-(ka*la+pa*qa));g[j+204>>2]=(ka*ha-ia*qa)*da+(pa*ha+ia*la)*ea+(1.0-(ka*la+pa*qa))*fa;g[j+208>>2]=(ka*ha-ia*qa)*ga+(pa*ha+ia*la)*ja+(1.0-(ka*la+pa*qa))*ra;g[j+212>>2]=0.0;Ca=c[e+12>>2]|0;c[J+0>>2]=c[Ca+0>>2];c[J+4>>2]=c[Ca+4>>2];c[J+8>>2]=c[Ca+8>>2];c[J+12>>2]=c[Ca+12>>2];c[ba+0>>2]=c[Ca+16>>2];c[ba+4>>2]=c[Ca+20>>2];c[ba+8>>2]=c[Ca+24>>2];c[ba+12>>2]=c[Ca+28>>2];c[ma+0>>2]=c[Ca+32>>2];c[ma+4>>2]=c[Ca+36>>2];c[ma+8>>2]=c[Ca+40>>2];c[ma+12>>2]=c[Ca+44>>2];c[u+0>>2]=c[Ca+48>>2];c[u+4>>2]=c[Ca+52>>2];c[u+8>>2]=c[Ca+56>>2];c[u+12>>2]=c[Ca+60>>2];Ca=c[f+20>>2]|0;c[j+480>>2]=18952;c[j+512>>2]=h;c[ya+0>>2]=c[j+168>>2];c[ya+4>>2]=c[j+172>>2];c[ya+8>>2]=c[j+176>>2];c[ya+12>>2]=c[j+180>>2];c[va+0>>2]=c[O+0>>2];c[va+4>>2]=c[O+4>>2];c[va+8>>2]=c[O+8>>2];c[va+12>>2]=c[O+12>>2];c[xa+0>>2]=c[I+0>>2];c[xa+4>>2]=c[I+4>>2];c[xa+8>>2]=c[I+8>>2];c[xa+12>>2]=c[I+12>>2];c[oa+0>>2]=c[na+0>>2];c[oa+4>>2]=c[na+4>>2];c[oa+8>>2]=c[na+8>>2];c[oa+12>>2]=c[na+12>>2];c[wa+0>>2]=c[J+0>>2];c[wa+4>>2]=c[J+4>>2];c[wa+8>>2]=c[J+8>>2];c[wa+12>>2]=c[J+12>>2];c[k+0>>2]=c[ba+0>>2];c[k+4>>2]=c[ba+4>>2];c[k+8>>2]=c[ba+8>>2];c[k+12>>2]=c[ba+12>>2];c[n+0>>2]=c[ma+0>>2];c[n+4>>2]=c[ma+4>>2];c[n+8>>2]=c[ma+8>>2];c[n+12>>2]=c[ma+12>>2];c[r+0>>2]=c[u+0>>2];c[r+4>>2]=c[u+4>>2];c[r+8>>2]=c[u+8>>2];c[r+12>>2]=c[u+12>>2];c[t+0>>2]=c[j+720>>2];c[t+4>>2]=c[j+724>>2];c[t+8>>2]=c[j+728>>2];c[t+12>>2]=c[j+732>>2];c[ta+0>>2]=c[l+0>>2];c[ta+4>>2]=c[l+4>>2];c[ta+8>>2]=c[l+8>>2];c[ta+12>>2]=c[l+12>>2];c[s+0>>2]=c[ua+0>>2];c[s+4>>2]=c[ua+4>>2];c[s+8>>2]=c[ua+8>>2];c[s+12>>2]=c[ua+12>>2];c[sa+0>>2]=c[za+0>>2];c[sa+4>>2]=c[za+4>>2];c[sa+8>>2]=c[za+8>>2];c[sa+12>>2]=c[za+12>>2];a[j+708>>0]=v<w&1;c[j+712>>2]=Ca;Az(j+88|0,j+168|0,j+480|0,Ca,0);Aa=c[b+28>>2]|0;Ba=Ba+1|0}while((Ba|0)<(Aa|0))}else{Ba=0;do{aa=+(Ba|0)*(6.2831854820251465/+(Aa|0))*.5;la=+T(+aa)/A;aa=+S(+aa);Ca=c[d+12>>2]|0;c[j+168>>2]=c[Ca+0>>2];c[j+172>>2]=c[Ca+4>>2];c[j+176>>2]=c[Ca+8>>2];c[j+180>>2]=c[Ca+12>>2];c[O+0>>2]=c[Ca+16>>2];c[O+4>>2]=c[Ca+20>>2];c[O+8>>2]=c[Ca+24>>2];c[O+12>>2]=c[Ca+28>>2];c[I+0>>2]=c[Ca+32>>2];c[I+4>>2]=c[Ca+36>>2];c[I+8>>2]=c[Ca+40>>2];c[I+12>>2]=c[Ca+44>>2];c[na+0>>2]=c[Ca+48>>2];c[na+4>>2]=c[Ca+52>>2];c[na+8>>2]=c[Ca+56>>2];c[na+12>>2]=c[Ca+60>>2];ha=z*-(m*q*la)+(x*aa+B*-(p*q*la))-y*-(o*q*la);qa=x*-(o*q*la)+(y*aa+B*-(m*q*la))-z*-(p*q*la);ia=y*-(p*q*la)+(z*aa+B*-(o*q*la))-x*-(m*q*la);$=B*aa-x*-(p*q*la)-y*-(m*q*la)-z*-(o*q*la);ka=o*q*la*qa+(p*q*la*$+aa*ha)-m*q*la*ia;pa=p*q*la*ia+(aa*qa+m*q*la*$)-o*q*la*ha;_=m*q*la*ha+(o*q*la*$+aa*ia)-p*q*la*qa;ia=aa*$-p*q*la*ha-m*q*la*qa-o*q*la*ia;la=ka*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));qa=pa*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));ha=_*(2.0/(ia*ia+(_*_+(ka*ka+pa*pa))));Ca=c[e+12>>2]|0;$=+g[Ca>>2];aa=+g[Ca+16>>2];ca=+g[Ca+32>>2];da=+g[Ca+4>>2];ea=+g[Ca+20>>2];fa=+g[Ca+36>>2];ga=+g[Ca+8>>2];ja=+g[Ca+24>>2];ra=+g[Ca+40>>2];g[j+232>>2]=(ka*ha+ia*qa)*ca+(aa*(ka*qa-ia*ha)+$*(1.0-(pa*qa+_*ha)));g[j+236>>2]=(1.0-(pa*qa+_*ha))*da+(ka*qa-ia*ha)*ea+(ka*ha+ia*qa)*fa;g[j+240>>2]=(1.0-(pa*qa+_*ha))*ga+(ka*qa-ia*ha)*ja+(ka*ha+ia*qa)*ra;g[j+244>>2]=0.0;g[j+248>>2]=(pa*ha-ia*la)*ca+($*(ka*qa+ia*ha)+aa*(1.0-(ka*la+_*ha)));g[j+252>>2]=(ka*qa+ia*ha)*da+(1.0-(ka*la+_*ha))*ea+(pa*ha-ia*la)*fa;g[j+256>>2]=(ka*qa+ia*ha)*ga+(1.0-(ka*la+_*ha))*ja+(pa*ha-ia*la)*ra;g[j+260>>2]=0.0;g[j+264>>2]=$*(ka*ha-ia*qa)+aa*(pa*ha+ia*la)+ca*(1.0-(ka*la+pa*qa));g[j+268>>2]=(ka*ha-ia*qa)*da+(pa*ha+ia*la)*ea+(1.0-(ka*la+pa*qa))*fa;g[j+272>>2]=(ka*ha-ia*qa)*ga+(pa*ha+ia*la)*ja+(1.0-(ka*la+pa*qa))*ra;g[j+276>>2]=0.0;Ca=c[f+20>>2]|0;c[j+480>>2]=18952;c[j+512>>2]=h;c[ya+0>>2]=c[j+168>>2];c[ya+4>>2]=c[j+172>>2];c[ya+8>>2]=c[j+176>>2];c[ya+12>>2]=c[j+180>>2];c[va+0>>2]=c[O+0>>2];c[va+4>>2]=c[O+4>>2];c[va+8>>2]=c[O+8>>2];c[va+12>>2]=c[O+12>>2];c[xa+0>>2]=c[I+0>>2];c[xa+4>>2]=c[I+4>>2];c[xa+8>>2]=c[I+8>>2];c[xa+12>>2]=c[I+12>>2];c[oa+0>>2]=c[na+0>>2];c[oa+4>>2]=c[na+4>>2];c[oa+8>>2]=c[na+8>>2];c[oa+12>>2]=c[na+12>>2];c[wa+0>>2]=c[J+0>>2];c[wa+4>>2]=c[J+4>>2];c[wa+8>>2]=c[J+8>>2];c[wa+12>>2]=c[J+12>>2];c[k+0>>2]=c[ba+0>>2];c[k+4>>2]=c[ba+4>>2];c[k+8>>2]=c[ba+8>>2];c[k+12>>2]=c[ba+12>>2];c[n+0>>2]=c[ma+0>>2];c[n+4>>2]=c[ma+4>>2];c[n+8>>2]=c[ma+8>>2];c[n+12>>2]=c[ma+12>>2];c[r+0>>2]=c[u+0>>2];c[r+4>>2]=c[u+4>>2];c[r+8>>2]=c[u+8>>2];c[r+12>>2]=c[u+12>>2];c[t+0>>2]=c[j+720>>2];c[t+4>>2]=c[j+724>>2];c[t+8>>2]=c[j+728>>2];c[t+12>>2]=c[j+732>>2];c[ta+0>>2]=c[l+0>>2];c[ta+4>>2]=c[l+4>>2];c[ta+8>>2]=c[l+8>>2];c[ta+12>>2]=c[l+12>>2];c[s+0>>2]=c[ua+0>>2];c[s+4>>2]=c[ua+4>>2];c[s+8>>2]=c[ua+8>>2];c[s+12>>2]=c[ua+12>>2];c[sa+0>>2]=c[za+0>>2];c[sa+4>>2]=c[za+4>>2];c[sa+8>>2]=c[za+8>>2];c[sa+12>>2]=c[za+12>>2];a[j+708>>0]=v<w&1;c[j+712>>2]=Ca;Az(j+88|0,j+168|0,j+480|0,Ca,0);Aa=c[b+28>>2]|0;Ba=Ba+1|0}while((Ba|0)<(Aa|0))}}else if(v<w){d=0;do d=d+1|0;while((d|0)<(Aa|0))}else{d=0;do d=d+1|0;while((d|0)<(Aa|0))}}}if(!(a[b+16>>0]|0)){i=j;return}b=c[h+4>>2]|0;if(!(c[b+748>>2]|0)){i=j;return}d=c[b+740>>2]|0;e=c[(c[h+8>>2]|0)+8>>2]|0;if((d|0)==(e|0)){xA(b,d+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=j;return}else{xA(b,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,e+4|0);i=j;return}}function pD(a){a=a|0;return}function qD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0;f=i;i=i+624|0;p=+g[d+116>>2]- +g[d+52>>2];o=+g[d+120>>2]- +g[d+56>>2];n=+g[d+124>>2]- +g[d+60>>2];l=+g[e+116>>2]- +g[e+52>>2];k=+g[e+120>>2]- +g[e+56>>2];j=+g[e+124>>2]- +g[e+60>>2];m=+g[d+252>>2];if(p*p+o*o+n*n<m*m?(p=+g[e+252>>2],l*l+k*k+j*j<p*p):0){p=1.0;i=f;return+p}b=c[d+192>>2]|0;p=+g[e+248>>2];c[f+576>>2]=0;g[f+580>>2]=1.0;g[f+584>>2]=1.0;g[f+588>>2]=1.0;g[f+592>>2]=0.0;c[f+568>>2]=16680;c[f+572>>2]=8;g[f+596>>2]=p;g[f+612>>2]=p;c[f+392>>2]=9440;g[f+556>>2]=999999984306749400.0;c[f+560>>2]=0;g[f+564>>2]=0.0;g[f+340>>2]=9999999747378752.0e-20;a[f+364>>0]=0;c[f+16>>2]=13184;c[f+20>>2]=f+32;c[f+24>>2]=b;c[f+28>>2]=f+568;if(wz(f+16|0,d+4|0,d+68|0,e+4|0,e+68|0,f+392|0)|0){k=+g[f+556>>2];if(+g[d+244>>2]>k)g[d+244>>2]=k;if(+g[e+244>>2]>k)g[e+244>>2]=k;if(!(k<1.0))k=1.0}else k=1.0;b=c[e+192>>2]|0;p=+g[d+248>>2];c[f+576>>2]=0;g[f+580>>2]=1.0;g[f+584>>2]=1.0;g[f+588>>2]=1.0;g[f+592>>2]=0.0;c[f+568>>2]=16680;c[f+572>>2]=8;g[f+596>>2]=p;g[f+612>>2]=p;c[f+392>>2]=9440;g[f+556>>2]=999999984306749400.0;c[f+560>>2]=0;g[f+564>>2]=0.0;g[f+340>>2]=9999999747378752.0e-20;a[f+364>>0]=a[f+364>>0]&-16;c[f>>2]=13184;c[f+4>>2]=f+32;c[f+8>>2]=f+568;c[f+12>>2]=b;if(!(wz(f,d+4|0,d+68|0,e+4|0,e+68|0,f+392|0)|0)){p=k;i=f;return+p}j=+g[f+556>>2];if(+g[d+244>>2]>j)g[d+244>>2]=j;if(+g[e+244>>2]>j)g[e+244>>2]=j;if(!(k>j)){p=k;i=f;return+p}p=j;i=f;return+p}function rD(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+20>>2]|0)){i=e;return}if(!(a[b+16>>0]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+20>>2];c[d+4>>2]=h+1;i=e;return}function sD(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0;e=i;f=c[d>>2]|0;f=gc[c[(c[f>>2]|0)+56>>2]&31](f,36)|0;if(!f){f=0;i=e;return f|0}h=c[d+4>>2]|0;k=c[b+12>>2]|0;j=c[b+8>>2]|0;g=c[b+16>>2]|0;b=c[b+20>>2]|0;c[f+4>>2]=c[d>>2];c[f>>2]=18816;c[f+8>>2]=k;c[f+12>>2]=j;a[f+16>>0]=0;c[f+20>>2]=h;a[f+24>>0]=0;c[f+28>>2]=g;c[f+32>>2]=b;i=e;return f|0}function tD(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function uD(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0.0,j=0.0,k=0.0,l=0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0.0;l=i;i=i+16|0;n=+g[d>>2];h=+g[d+4>>2];j=+g[d+8>>2];m=+g[e>>2];k=+g[e+4>>2];o=+g[e+8>>2];if(!(a[b+228>>0]|0)){z=+g[b+100>>2];w=+g[b+116>>2];C=+g[b+132>>2];y=+g[b+104>>2];u=+g[b+120>>2];B=+g[b+136>>2];x=+g[b+108>>2];s=+g[b+124>>2];A=+g[b+140>>2];F=-+g[b+148>>2];E=-+g[b+152>>2];D=-+g[b+156>>2];I=+g[b+164>>2];r=+g[b+168>>2];J=+g[b+172>>2];H=+g[b+180>>2];G=+g[b+184>>2];q=+g[b+188>>2];v=+g[b+196>>2];t=+g[b+200>>2];p=+g[b+204>>2];r=o*(C*I+B*r+A*J)+(m*(z*I+y*r+x*J)+k*(w*I+u*r+s*J))+((x*F+s*E+A*D)*J+(I*(z*F+w*E+C*D)+r*(y*F+u*E+B*D))+ +g[b+212>>2]);q=o*(C*H+B*G+A*q)+(m*(z*H+y*G+x*q)+k*(w*H+u*G+s*q))+((z*F+w*E+C*D)*H+(y*F+u*E+B*D)*G+(x*F+s*E+A*D)*q+ +g[b+216>>2]);p=(z*F+w*E+C*D)*v+(y*F+u*E+B*D)*t+(x*F+s*E+A*D)*p+ +g[b+220>>2]+(o*(C*v+B*t+A*p)+(m*(z*v+y*t+x*p)+k*(w*v+u*t+s*p)));g[l>>2]=r;g[l+4>>2]=q;g[l+8>>2]=p;g[l+12>>2]=0.0;o=(n*f+m-r)*+g[d>>2]+(h*f+k-q)*+g[d+4>>2]+(j*f+o-p)*+g[d+8>>2];e=b+32|0;e=c[e>>2]|0;b=c[e>>2]|0;b=b+16|0;b=c[b>>2]|0;qc[b&15](e,d,l,o);i=l;return}else{z=+g[b+36>>2];C=+g[b+52>>2];w=+g[b+68>>2];A=+g[b+40>>2];E=+g[b+56>>2];x=+g[b+72>>2];B=+g[b+44>>2];G=+g[b+60>>2];y=+g[b+76>>2];t=-+g[b+84>>2];u=-+g[b+88>>2];v=-+g[b+92>>2];q=+g[b+164>>2];H=+g[b+168>>2];p=+g[b+172>>2];r=+g[b+180>>2];s=+g[b+184>>2];I=+g[b+188>>2];D=+g[b+196>>2];F=+g[b+200>>2];J=+g[b+204>>2];H=(j*f+o)*(w*q+x*H+y*p)+((n*f+m)*(z*q+A*H+B*p)+(h*f+k)*(C*q+E*H+G*p))+((B*t+G*u+y*v)*p+(q*(z*t+C*u+w*v)+H*(A*t+E*u+x*v))+ +g[b+212>>2]);I=(j*f+o)*(w*r+x*s+y*I)+((n*f+m)*(z*r+A*s+B*I)+(h*f+k)*(C*r+E*s+G*I))+((z*t+C*u+w*v)*r+(A*t+E*u+x*v)*s+(B*t+G*u+y*v)*I+ +g[b+216>>2]);J=(z*t+C*u+w*v)*D+(A*t+E*u+x*v)*F+(B*t+G*u+y*v)*J+ +g[b+220>>2]+((j*f+o)*(w*D+x*F+y*J)+((n*f+m)*(z*D+A*F+B*J)+(h*f+k)*(C*D+E*F+G*J)));g[l>>2]=H+n*(n*(H-m)+h*(I-k)+j*(J-o));g[l+4>>2]=I+h*(n*(H-m)+h*(I-k)+j*(J-o));g[l+8>>2]=J+j*(n*(H-m)+h*(I-k)+j*(J-o));g[l+12>>2]=0.0;J=n*(H-m)+h*(I-k)+j*(J-o);e=b+32|0;e=c[e>>2]|0;b=c[e>>2]|0;b=b+16|0;b=c[b>>2]|0;qc[b&15](e,d,l,J);i=l;return}}function vD(a){a=a|0;return}function wD(a){a=a|0;return}function xD(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function yD(a,b,c){a=a|0;b=b|0;c=c|0;return}function zD(a,b,c){a=a|0;b=b|0;c=c|0;return}function AD(b,d,e,f){b=b|0;d=d|0;e=e|0;f=+f;var h=0,j=0.0,k=0.0,l=0.0;h=i;i=i+16|0;g[b+32>>2]=f;c[b+8>>2]=c[d+0>>2];c[b+12>>2]=c[d+4>>2];c[b+16>>2]=c[d+8>>2];c[b+20>>2]=c[d+12>>2];j=+g[b+28>>2];l=+g[e+4>>2]-j*+g[d+4>>2];k=+g[e+8>>2]-j*+g[d+8>>2];g[h>>2]=+g[e>>2]- +g[d>>2]*j;g[h+4>>2]=l;g[h+8>>2]=k;g[h+12>>2]=0.0;f=+g[b+24>>2]+j+f;g[b+32>>2]=f;if(!(f<0.0)){e=b+4|0;e=c[e>>2]|0;b=c[e>>2]|0;b=b+16|0;b=c[b>>2]|0;qc[b&15](e,d,h,f);i=h;return}a[b+36>>0]=1;e=b+4|0;e=c[e>>2]|0;b=c[e>>2]|0;b=b+16|0;b=c[b>>2]|0;qc[b&15](e,d,h,f);i=h;return}function BD(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function CD(a,b,c){a=a|0;b=b|0;c=c|0;return}function DD(a,b,c){a=a|0;b=b|0;c=c|0;return}function ED(a,b,c,d){a=a|0;b=b|0;c=c|0;d=+d;return}function FD(b){b=b|0;var d=0,e=0,f=0;d=i;c[b>>2]=19408;if((a[b+8>>0]|0)!=0?(e=c[b+12>>2]|0,(e|0)!=0):0){f=c[b+4>>2]|0;Nb[c[(c[f>>2]|0)+16>>2]&127](f,e)}gF(b);i=d;return}function GD(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=19408;if(!(a[b+8>>0]|0)){i=d;return}e=c[b+12>>2]|0;if(!e){i=d;return}b=c[b+4>>2]|0;Nb[c[(c[b>>2]|0)+16>>2]&127](b,e);i=d;return}function HD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0.0,l=0.0,m=0.0,n=0.0,o=0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0,C=0,D=0.0,E=0.0,F=0.0,G=0.0,H=0.0,I=0.0,J=0,K=0,L=0.0,M=0.0,N=0.0,O=0.0,R=0.0,U=0.0,V=0.0,W=0.0,X=0.0,Y=0.0,Z=0.0,_=0.0,$=0,aa=0.0,ba=0.0,ca=0.0,da=0.0,ea=0.0,fa=0.0,ga=0.0;f=i;i=i+128|0;if(!(c[b+12>>2]|0)){i=f;return}C=(a[b+16>>0]|0)!=0;K=C?e:d;C=C?d:e;o=c[K+4>>2]|0;j=c[C+4>>2]|0;K=c[K+12>>2]|0;q=+g[K>>2];D=+g[K+16>>2];z=+g[K+32>>2];t=+g[K+4>>2];s=+g[K+20>>2];r=+g[K+36>>2];p=+g[K+8>>2];n=+g[K+24>>2];y=+g[K+40>>2];F=+g[K+48>>2];G=+g[K+52>>2];H=+g[K+56>>2];K=c[C+12>>2]|0;O=+g[K>>2];N=+g[K+16>>2];k=+g[K+32>>2];M=+g[K+4>>2];L=+g[K+20>>2];x=+g[K+36>>2];m=+g[K+8>>2];B=+g[K+24>>2];v=+g[K+40>>2];I=-+g[K+48>>2];E=-+g[K+52>>2];u=-+g[K+56>>2];K=c[(c[o>>2]|0)+64>>2]|0;A=-+g[j+48>>2];l=-+g[j+52>>2];w=-+g[j+56>>2];g[f+32>>2]=(q*O+D*N+z*k)*A+(q*M+D*L+z*x)*l+(q*m+D*B+z*v)*w;g[f+36>>2]=(t*O+s*N+r*k)*A+(t*M+s*L+r*x)*l+(t*m+s*B+r*v)*w;g[f+40>>2]=(p*O+n*N+y*k)*A+(p*M+n*L+y*x)*l+(p*m+n*B+y*v)*w;g[f+44>>2]=0.0;rc[K&127](f+48|0,o,f+32|0);w=+g[f+48>>2];l=+g[f+52>>2];A=+g[f+56>>2];k=F*O+G*N+H*k+(O*I+N*E+k*u)+((q*O+D*N+z*k)*w+(t*O+s*N+r*k)*l+(p*O+n*N+y*k)*A);x=F*M+G*L+H*x+(M*I+L*E+x*u)+((q*M+D*L+z*x)*w+(t*M+s*L+r*x)*l+(p*M+n*L+y*x)*A);A=F*m+G*B+H*v+(m*I+B*E+v*u)+((q*m+D*B+z*v)*w+(t*m+s*B+r*v)*l+(p*m+n*B+y*v)*A);v=+g[j+48>>2];y=+g[j+52>>2];B=+g[j+56>>2];n=B*A+(v*k+y*x)- +g[j+64>>2];K=c[C+12>>2]|0;m=+g[K>>2];p=+g[K+4>>2];l=+g[K+8>>2];r=+g[K+16>>2];s=+g[K+20>>2];t=+g[K+24>>2];w=+g[K+32>>2];z=+g[K+36>>2];D=+g[K+40>>2];q=+g[K+48>>2];u=+g[K+52>>2];E=+g[K+56>>2];K=c[b+12>>2]|0;J=n<+g[K+752>>2];c[h+4>>2]=K;if(J){K=c[C+12>>2]|0;N=v*+g[K+16>>2]+y*+g[K+20>>2]+B*+g[K+24>>2];O=v*+g[K+32>>2]+y*+g[K+36>>2]+B*+g[K+40>>2];g[f+16>>2]=+g[K>>2]*v+ +g[K+4>>2]*y+ +g[K+8>>2]*B;g[f+20>>2]=N;g[f+24>>2]=O;g[f+28>>2]=0.0;g[f>>2]=l*(A-B*n)+(m*(k-v*n)+p*(x-y*n))+q;g[f+4>>2]=(k-v*n)*r+(x-y*n)*s+(A-B*n)*t+u;g[f+8>>2]=(k-v*n)*w+(x-y*n)*z+(A-B*n)*D+E;g[f+12>>2]=0.0;qc[c[(c[h>>2]|0)+16>>2]&15](h,f+16|0,f,n)}if((c[o+4>>2]|0)<7?(c[(c[h+4>>2]|0)+748>>2]|0)<(c[b+24>>2]|0):0){l=+g[j+56>>2];if(+P(+l)>.7071067690849304){O=+g[j+52>>2];m=1.0/+Q(+(l*l+O*O));k=0.0;l=-(l*m);m=O*m}else{m=+g[j+48>>2];k=+g[j+52>>2];l=1.0/+Q(+(m*m+k*k));k=-(k*l);l=m*l;m=0.0}O=.019999999552965164/+$b[c[(c[o>>2]|0)+16>>2]&15](o);n=+Q(+(m*m+(l*l+k*k)));O=O>.39269909262657166?.19634954631328583:O*.5;n=+T(+O)/n;k=k*n;l=l*n;n=m*n;m=+S(+O);C=c[b+20>>2]|0;if((C|0)>0){o=0;do{q=+g[j+48>>2];O=+g[j+52>>2];p=+g[j+56>>2];x=+(o|0)*(6.2831854820251465/+(C|0))*.5;N=+T(+x)/+Q(+(q*q+O*O+p*p));x=+S(+x);z=n*-(O*N)+(k*x+m*-(q*N))-l*-(p*N);s=k*-(p*N)+(l*x+m*-(O*N))-n*-(q*N);fa=l*-(q*N)+(n*x+m*-(p*N))-k*-(O*N);A=m*x-k*-(q*N)-l*-(O*N)-n*-(p*N);E=p*N*s+(q*N*A+x*z)-O*N*fa;D=q*N*fa+(x*s+O*N*A)-p*N*z;ba=O*N*z+(p*N*A+x*fa)-q*N*s;fa=x*A-q*N*z-O*N*s-p*N*fa;C=(a[b+16>>0]|0)!=0;$=C?e:d;C=C?d:e;K=c[$+4>>2]|0;J=c[C+4>>2]|0;$=c[$+12>>2]|0;N=+g[$>>2];p=+g[$+4>>2];s=+g[$+8>>2];O=+g[$+16>>2];z=+g[$+20>>2];q=+g[$+24>>2];A=+g[$+32>>2];x=+g[$+36>>2];H=+g[$+40>>2];W=+g[$+48>>2];V=+g[$+52>>2];U=+g[$+56>>2];$=c[C+12>>2]|0;_=+g[$>>2];Z=+g[$+16>>2];u=+g[$+32>>2];Y=+g[$+4>>2];X=+g[$+20>>2];w=+g[$+36>>2];r=+g[$+8>>2];F=+g[$+24>>2];G=+g[$+40>>2];R=-+g[$+48>>2];L=-+g[$+52>>2];M=-+g[$+56>>2];t=E*(2.0/(E*E+D*D+ba*ba+fa*fa));I=D*(2.0/(E*E+D*D+ba*ba+fa*fa));ga=ba*(2.0/(E*E+D*D+ba*ba+fa*fa));da=s*(E*ga-fa*I)+(p*(E*I+fa*ga)+N*(1.0-(D*I+ba*ga)));aa=s*(D*ga+fa*t)+(N*(E*I-fa*ga)+p*(1.0-(E*t+ba*ga)));y=N*(E*ga+fa*I)+p*(D*ga-fa*t)+s*(1.0-(E*t+D*I));ca=q*(E*ga-fa*I)+(z*(E*I+fa*ga)+O*(1.0-(D*I+ba*ga)));B=q*(D*ga+fa*t)+(O*(E*I-fa*ga)+z*(1.0-(E*t+ba*ga)));v=O*(E*ga+fa*I)+z*(D*ga-fa*t)+q*(1.0-(E*t+D*I));ea=H*(E*ga-fa*I)+(x*(E*I+fa*ga)+A*(1.0-(D*I+ba*ga)));ba=H*(D*ga+fa*t)+(A*(E*I-fa*ga)+x*(1.0-(E*t+ba*ga)));I=A*(E*ga+fa*I)+x*(D*ga-fa*t)+H*(1.0-(E*t+D*I));$=c[(c[K>>2]|0)+64>>2]|0;D=-+g[J+48>>2];t=-+g[J+52>>2];E=-+g[J+56>>2];g[f+96>>2]=(G*ea+(r*da+F*ca))*E+((u*ea+(_*da+Z*ca))*D+(w*ea+(Y*da+X*ca))*t);g[f+100>>2]=(G*ba+(r*aa+F*B))*E+((u*ba+(_*aa+Z*B))*D+(w*ba+(Y*aa+X*B))*t);g[f+104>>2]=(G*I+(r*y+F*v))*E+((u*I+(_*y+Z*v))*D+(w*I+(Y*y+X*v))*t);g[f+108>>2]=0.0;rc[$&127](f+112|0,K,f+96|0);t=+g[f+112>>2];v=+g[f+116>>2];y=+g[f+120>>2];I=+g[J+48>>2];D=+g[J+52>>2];E=+g[J+56>>2];B=E*(W*r+V*F+U*G+(r*R+F*L+G*M)+((N*r+O*F+A*G)*t+(p*r+z*F+x*G)*v+(s*r+q*F+H*G)*y))+(I*(W*_+V*Z+U*u+(_*R+Z*L+u*M)+((N*_+O*Z+A*u)*t+(p*_+z*Z+x*u)*v+(s*_+q*Z+H*u)*y))+D*(W*Y+V*X+U*w+(Y*R+X*L+w*M)+((N*Y+O*X+A*w)*t+(p*Y+z*X+x*w)*v+(s*Y+q*X+H*w)*y)))- +g[J+64>>2];u=W*_+V*Z+U*u+(_*R+Z*L+u*M)+((N*_+O*Z+A*u)*t+(p*_+z*Z+x*u)*v+(s*_+q*Z+H*u)*y)-I*B;w=W*Y+V*X+U*w+(Y*R+X*L+w*M)+((N*Y+O*X+A*w)*t+(p*Y+z*X+x*w)*v+(s*Y+q*X+H*w)*y)-D*B;y=W*r+V*F+U*G+(r*R+F*L+G*M)+((N*r+O*F+A*G)*t+(p*r+z*F+x*G)*v+(s*r+q*F+H*G)*y)-E*B;J=c[C+12>>2]|0;G=+g[J>>2];H=+g[J+4>>2];F=+g[J+8>>2];q=+g[J+16>>2];r=+g[J+20>>2];s=+g[J+24>>2];v=+g[J+32>>2];x=+g[J+36>>2];z=+g[J+40>>2];p=+g[J+48>>2];t=+g[J+52>>2];A=+g[J+56>>2];J=c[b+12>>2]|0;K=B<+g[J+752>>2];c[h+4>>2]=J;if(K){$=c[C+12>>2]|0;fa=I*+g[$+16>>2]+D*+g[$+20>>2]+E*+g[$+24>>2];ga=I*+g[$+32>>2]+D*+g[$+36>>2]+E*+g[$+40>>2];g[f+80>>2]=+g[$>>2]*I+ +g[$+4>>2]*D+ +g[$+8>>2]*E;g[f+84>>2]=fa;g[f+88>>2]=ga;g[f+92>>2]=0.0;g[f+64>>2]=F*y+(G*u+H*w)+p;g[f+68>>2]=u*q+w*r+y*s+t;g[f+72>>2]=u*v+w*x+y*z+A;g[f+76>>2]=0.0;qc[c[(c[h>>2]|0)+16>>2]&15](h,f+80|0,f+64|0,B)}o=o+1|0;C=c[b+20>>2]|0}while((o|0)<(C|0))}}if(!(a[b+8>>0]|0)){i=f;return}if(!(c[(c[b+12>>2]|0)+748>>2]|0)){i=f;return}b=c[h+4>>2]|0;if(!(c[b+748>>2]|0)){i=f;return}d=c[b+740>>2]|0;e=c[(c[h+8>>2]|0)+8>>2]|0;if((d|0)==(e|0)){xA(b,d+4|0,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0);i=f;return}else{xA(b,(c[(c[h+12>>2]|0)+8>>2]|0)+4|0,e+4|0);i=f;return}}function ID(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return 1.0}function JD(b,d){b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0;e=i;if(!(c[b+12>>2]|0)){i=e;return}if(!(a[b+8>>0]|0)){i=e;return}h=c[d+4>>2]|0;if((h|0)==(c[d+8>>2]|0)?(f=(h|0)==0?1:h<<1,(h|0)<(f|0)):0){if(!f)g=0;else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}h=c[d+4>>2]|0}if((h|0)>0){j=0;do{k=g+(j<<2)|0;if(k)c[k>>2]=c[(c[d+12>>2]|0)+(j<<2)>>2];j=j+1|0}while((j|0)!=(h|0))}j=c[d+12>>2]|0;if(j){if(a[d+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0);h=c[d+4>>2]|0}c[d+12>>2]=0}a[d+16>>0]=1;c[d+12>>2]=g;c[d+8>>2]=f}f=(c[d+12>>2]|0)+(h<<2)|0;if(f)c[f>>2]=c[b+12>>2];c[d+4>>2]=h+1;i=e;return}function KD(a){a=a|0;var b=0;b=i;LD(a);if(!a){i=b;return}c[5006]=(c[5006]|0)+1;gF(c[a+ -4>>2]|0);i=b;return}function LD(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0;d=i;c[b>>2]=19496;e=c[b+56>>2]|0;if(e){if(a[b+60>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+56>>2]=0}a[b+60>>0]=1;c[b+56>>2]=0;c[b+48>>2]=0;c[b+52>>2]=0;f=c[b+28>>2]|0;if((f|0)>0){g=0;do{h=c[b+36>>2]|0;l=h+(g*36|0)+4|0;k=h+(g*36|0)+12|0;e=c[k>>2]|0;j=h+(g*36|0)+16|0;if(e){if(a[j>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[k>>2]=0}a[j>>0]=1;c[k>>2]=0;c[l>>2]=0;c[h+(g*36|0)+8>>2]=0;g=g+1|0}while((g|0)!=(f|0))}e=c[b+36>>2]|0;if(e){if(a[b+40>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+36>>2]=0}a[b+40>>0]=1;c[b+36>>2]=0;c[b+28>>2]=0;c[b+32>>2]=0;e=c[b+16>>2]|0;if(!e){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;l=b+12|0;c[l>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;l=b+12|0;c[l>>2]=0;i=d;return}function MD(a){a=a|0;var b=0,d=0,e=0,f=0,h=0.0,j=0.0,k=0.0,l=0;b=i;d=c[a+28>>2]|0;if((d|0)<=0){a=0;do a=a+1|0;while((a|0)<8);d=1;i=b;return d|0}e=c[a+36>>2]|0;k=0.0;j=0.0;h=0.0;f=0;a:while(1){switch(f|0){case 1:{h=+g[a+72>>2]- +g[a+88>>2];j=+g[a+84>>2]+ +g[a+68>>2];k=+g[a+80>>2]+ +g[a+64>>2];break};case 4:{h=+g[a+88>>2]+ +g[a+72>>2];j=+g[a+84>>2]+ +g[a+68>>2];k=+g[a+64>>2]- +g[a+80>>2];break};case 2:{h=+g[a+88>>2]+ +g[a+72>>2];j=+g[a+68>>2]- +g[a+84>>2];k=+g[a+80>>2]+ +g[a+64>>2];break};case 0:{h=+g[a+88>>2]+ +g[a+72>>2];j=+g[a+84>>2]+ +g[a+68>>2];k=+g[a+80>>2]+ +g[a+64>>2];break};case 3:{h=+g[a+72>>2]- +g[a+88>>2];j=+g[a+68>>2]- +g[a+84>>2];k=+g[a+80>>2]+ +g[a+64>>2];break};case 6:{h=+g[a+88>>2]+ +g[a+72>>2];j=+g[a+68>>2]- +g[a+84>>2];k=+g[a+64>>2]- +g[a+80>>2];break};case 7:{h=+g[a+72>>2]- +g[a+88>>2];j=+g[a+68>>2]- +g[a+84>>2];k=+g[a+64>>2]- +g[a+80>>2];break};case 5:{h=+g[a+72>>2]- +g[a+88>>2];j=+g[a+84>>2]+ +g[a+68>>2];k=+g[a+64>>2]- +g[a+80>>2];break};default:{}}l=0;do{if(+g[e+(l*36|0)+32>>2]+(k*+g[e+(l*36|0)+20>>2]+j*+g[e+(l*36|0)+24>>2]+h*+g[e+(l*36|0)+28>>2])>0.0){d=0;a=17;break a}l=l+1|0}while((l|0)<(d|0));f=f+1|0;if((f|0)>=8){d=1;a=17;break}}if((a|0)==17){i=b;return d|0}return 0}function ND(a,b,d,e,f,h,j){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;j=j|0;var k=0,l=0.0,m=0,n=0,o=0.0,p=0.0,q=0.0,r=0.0,s=0;k=i;i=i+16|0;g[e>>2]=3.4028234663852886e+38;g[f>>2]=-3.4028234663852886e+38;m=c[a+8>>2]|0;if((m|0)>0){n=0;do{s=c[a+16>>2]|0;r=+g[s+(n<<4)>>2];q=+g[s+(n<<4)+4>>2];l=+g[s+(n<<4)+8>>2];p=r*+g[b>>2]+q*+g[b+4>>2]+l*+g[b+8>>2]+ +g[b+48>>2];o=r*+g[b+16>>2]+q*+g[b+20>>2]+l*+g[b+24>>2]+ +g[b+52>>2];l=r*+g[b+32>>2]+q*+g[b+36>>2]+l*+g[b+40>>2]+ +g[b+56>>2];q=p*+g[d>>2]+o*+g[d+4>>2]+l*+g[d+8>>2];if(q<+g[e>>2]){g[e>>2]=q;g[h>>2]=p;g[h+4>>2]=o;g[h+8>>2]=l;g[h+12>>2]=0.0}if(q>+g[f>>2]){g[f>>2]=q;g[j>>2]=p;g[j+4>>2]=o;g[j+8>>2]=l;g[j+12>>2]=0.0}n=n+1|0}while((n|0)!=(m|0));o=+g[f>>2]}else o=-3.4028234663852886e+38;l=+g[e>>2];if(!(l>o)){i=k;return}g[e>>2]=o;g[f>>2]=l;c[k+0>>2]=c[h+0>>2];c[k+4>>2]=c[h+4>>2];c[k+8>>2]=c[h+8>>2];c[k+12>>2]=c[h+12>>2];c[h+0>>2]=c[j+0>>2];c[h+4>>2]=c[j+4>>2];c[h+8>>2]=c[j+8>>2];c[h+12>>2]=c[j+12>>2];c[j+0>>2]=c[k+0>>2];c[j+4>>2]=c[k+4>>2];c[j+8>>2]=c[k+8>>2];c[j+12>>2]=c[k+12>>2];i=k;return}function OD(b,e,f){b=b|0;e=e|0;f=f|0;var h=0,j=0.0,k=0,l=0,m=0.0,n=0.0,o=0,p=0,q=0,r=0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0,z=0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0.0,G=0;h=i;i=i+176|0;c[b+348>>2]=b+220;c[b+352>>2]=b+252;c[b+356>>2]=b+284;c[b+360>>2]=b+316;c[b+364>>2]=4;c[b+368>>2]=0;c[b+376>>2]=0;y=c[e+4>>2]|0;c[b>>2]=c[e>>2];c[b+4>>2]=y;c[b+8>>2]=c[e+8>>2];c[b+12>>2]=c[e+12>>2];c[b+16>>2]=c[e+16>>2];c[b+20>>2]=c[e+20>>2];c[b+24>>2]=c[e+24>>2];c[b+28>>2]=c[e+28>>2];c[b+32>>2]=c[e+32>>2];c[b+36>>2]=c[e+36>>2];c[b+40>>2]=c[e+40>>2];c[b+44>>2]=c[e+44>>2];c[b+48>>2]=c[e+48>>2];c[b+52>>2]=c[e+52>>2];c[b+56>>2]=c[e+56>>2];c[b+60>>2]=c[e+60>>2];c[b+64>>2]=c[e+64>>2];c[b+68>>2]=c[e+68>>2];c[b+72>>2]=c[e+72>>2];c[b+76>>2]=c[e+76>>2];c[b+80>>2]=c[e+80>>2];c[b+84>>2]=c[e+84>>2];c[b+88>>2]=c[e+88>>2];c[b+92>>2]=c[e+92>>2];c[b+96>>2]=c[e+96>>2];c[b+100>>2]=c[e+100>>2];c[b+104>>2]=c[e+104>>2];c[b+108>>2]=c[e+108>>2];c[b+112>>2]=c[e+112>>2];c[b+116>>2]=c[e+116>>2];y=d[e+120>>0]|d[e+121>>0]<<8|d[e+122>>0]<<16|d[e+123>>0]<<24;z=d[e+124>>0]|d[e+125>>0]<<8|d[e+126>>0]<<16|d[e+127>>0]<<24;a[b+120>>0]=y;a[b+121>>0]=y>>8;a[b+122>>0]=y>>16;a[b+123>>0]=y>>24;a[b+124>>0]=z;a[b+125>>0]=z>>8;a[b+126>>0]=z>>16;a[b+127>>0]=z>>24;g[b+144>>2]=0.0;c[b+180>>2]=0;c[b+128>>2]=c[f+0>>2];c[b+132>>2]=c[f+4>>2];c[b+136>>2]=c[f+8>>2];c[b+140>>2]=c[f+12>>2];s=+g[b+128>>2];t=+g[b+132>>2];n=+g[b+136>>2];if(s*s+t*t+n*n>0.0){v=-s;m=-t;u=-n}else{v=1.0;m=0.0;u=0.0}g[b+164>>2]=0.0;c[b+364>>2]=3;c[b+148>>2]=b+316;c[b+180>>2]=1;RD(b,v,m,u,b+316|0);g[b+164>>2]=1.0;e=(c[b+148>>2]|0)+16|0;c[b+128>>2]=c[e+0>>2];c[b+132>>2]=c[e+4>>2];c[b+136>>2]=c[e+8>>2];c[b+140>>2]=c[e+12>>2];c[h+72>>2]=c[e+0>>2];c[h+76>>2]=c[e+4>>2];c[h+80>>2]=c[e+8>>2];c[h+84>>2]=c[e+12>>2];c[h+56>>2]=c[e+0>>2];c[h+60>>2]=c[e+4>>2];c[h+64>>2]=c[e+8>>2];c[h+68>>2]=c[e+12>>2];c[h+40>>2]=c[e+0>>2];c[h+44>>2]=c[e+4>>2];c[h+48>>2]=c[e+8>>2];c[h+52>>2]=c[e+12>>2];c[h+24>>2]=c[e+0>>2];c[h+28>>2]=c[e+4>>2];c[h+32>>2]=c[e+8>>2];c[h+36>>2]=c[e+12>>2];m=0.0;e=1;f=1;A=s*s+t*t+n*n;a:while(1){l=c[b+368>>2]|0;u=+g[b+128>>2];t=+g[b+132>>2];s=+g[b+136>>2];n=+Q(+(u*u+t*t+s*s));if(n<9999999747378752.0e-20){k=5;break}g[b+(l*36|0)+(c[b+(l*36|0)+180>>2]<<2)+164>>2]=0.0;o=(c[b+364>>2]|0)+ -1|0;c[b+364>>2]=o;c[b+(l*36|0)+(c[b+(l*36|0)+180>>2]<<2)+148>>2]=c[b+(o<<2)+348>>2];o=c[b+(l*36|0)+180>>2]|0;c[b+(l*36|0)+180>>2]=o+1;RD(b,-u,-t,-s,c[b+(l*36|0)+(o<<2)+148>>2]|0);o=c[b+(l*36|0)+180>>2]|0;q=c[b+(l*36|0)+(o+ -1<<2)+148>>2]|0;s=+g[q+16>>2];u=+g[q+20>>2];t=+g[q+24>>2];p=0;do{v=s- +g[h+24+(p<<4)>>2];w=u- +g[h+24+(p<<4)+4>>2];x=t- +g[h+24+(p<<4)+8>>2];p=p+1|0;if(v*v+w*w+x*x<9999999747378752.0e-20){k=9;break a}}while(p>>>0<4);z=h+24+(e<<4)|0;c[z+0>>2]=c[q+16>>2];c[z+4>>2]=c[q+20>>2];c[z+8>>2]=c[q+24>>2];c[z+12>>2]=c[q+28>>2];x=(+g[b+128>>2]*s+ +g[b+132>>2]*u+ +g[b+136>>2]*t)/n;m=x>m?x:m;if(n-m-n*9999999747378752.0e-20<=0.0){k=11;break}c[h>>2]=0;if((o|0)==4){q=c[b+(l*36|0)+148>>2]|0;r=c[b+(l*36|0)+152>>2]|0;p=c[b+(l*36|0)+156>>2]|0;o=c[b+(l*36|0)+160>>2]|0;c[h+152>>2]=q+16;c[h+156>>2]=r+16;c[h+160>>2]=p+16;c[h+164>>2]=o+16;u=+g[q+16>>2];v=+g[o+16>>2];s=+g[q+20>>2];w=+g[o+20>>2];t=+g[q+24>>2];x=+g[o+24>>2];g[h+104>>2]=u-v;g[h+108>>2]=s-w;g[h+112>>2]=t-x;g[h+116>>2]=0.0;C=+g[r+16>>2];E=+g[r+20>>2];A=+g[r+24>>2];g[h+120>>2]=C-v;g[h+124>>2]=E-w;g[h+128>>2]=A-x;g[h+132>>2]=0.0;B=+g[p+16>>2];F=+g[p+20>>2];D=+g[p+24>>2];g[h+136>>2]=B-v;g[h+140>>2]=F-w;g[h+144>>2]=D-x;g[h+148>>2]=0.0;n=(s-w)*(A-x)*(B-v)+(t-x)*(C-v)*(F-w)-(F-w)*(A-x)*(u-v)-(s-w)*(C-v)*(D-x)+(D-x)*(u-v)*(E-w)-(B-v)*(t-x)*(E-w);if(!(!(n*(t*((C-B)*(s-E)-(E-F)*(u-C))+(u*((E-F)*(t-A)-(A-D)*(s-E))+s*((A-D)*(u-C)-(C-B)*(t-A))))<=0.0)|(n!=n|0.0!=0.0|n==0.0))){c[h+92>>2]=0;c[h+96>>2]=0;c[h+100>>2]=0;c[h+88>>2]=0;s=s-w;t=t-x;u=u-v;y=0;A=-1.0;while(1){z=c[19552+(y<<2)>>2]|0;D=+g[h+104+(z<<4)+8>>2];E=+g[h+104+(z<<4)+4>>2];F=+g[h+104+(z<<4)>>2];if(n*((s*D-t*E)*v+w*(t*F-D*u)+(E*u-s*F)*x)>0.0?(j=+VD(c[h+152+(y<<2)>>2]|0,c[h+152+(z<<2)>>2]|0,o+16|0,h+92|0,h+88|0),A<0.0|j<A):0){G=c[h+88>>2]|0;c[h>>2]=((G&2|0)==0?0:1<<z)+(G<<1&8)+((G&1|0)==0?0:1<<y);g[h+8+(y<<2)>>2]=+g[h+92>>2];g[h+8+(z<<2)>>2]=+g[h+96>>2];g[h+8+(c[19552+(z<<2)>>2]<<2)>>2]=0.0;g[h+20>>2]=+g[h+100>>2];A=j}y=y+1|0;if((y|0)==3)break;s=+g[h+104+(y<<4)+4>>2];t=+g[h+104+(y<<4)+8>>2];u=+g[h+104+(y<<4)>>2];v=+g[o+16>>2];w=+g[o+20>>2];x=+g[o+24>>2]}if(A<0.0){c[h>>2]=15;A=+g[p+20>>2];s=+g[r+24>>2];E=+g[o+16>>2];w=+g[p+24>>2];t=+g[r+16>>2];v=+g[o+20>>2];B=+g[p+16>>2];C=+g[o+24>>2];u=+g[r+20>>2];g[h+8>>2]=(A*s*E+w*t*v-v*s*B-A*t*C+C*B*u-E*w*u)/n;x=+g[q+20>>2];F=+g[q+24>>2];D=+g[q+16>>2];g[h+12>>2]=(x*w*E+F*B*v-v*w*D-x*B*C+C*D*A-E*F*A)/n;g[h+16>>2]=(u*F*E+s*D*v-v*F*t-u*D*C+C*t*x-E*s*x)/n;g[h+20>>2]=1.0-((u*F*E+s*D*v-v*F*t-u*D*C+C*t*x-E*s*x)/n+((A*s*E+w*t*v-v*s*B-A*t*C+C*B*u-E*w*u)/n+(x*w*E+F*B*v-v*w*D-x*B*C+C*D*A-E*F*A)/n));A=0.0}}else A=-1.0}else if((o|0)==3)A=+VD((c[b+(l*36|0)+148>>2]|0)+16|0,(c[b+(l*36|0)+152>>2]|0)+16|0,(c[b+(l*36|0)+156>>2]|0)+16|0,h+8|0,h);else if((o|0)==2)A=+UD((c[b+(l*36|0)+148>>2]|0)+16|0,(c[b+(l*36|0)+152>>2]|0)+16|0,h+8|0,h);if(!(A>=0.0)){k=32;break}c[b+((1-l|0)*36|0)+180>>2]=0;c[b+128>>2]=0;c[b+132>>2]=0;c[b+136>>2]=0;c[b+140>>2]=0;c[b+368>>2]=1-l;y=c[b+(l*36|0)+180>>2]|0;o=c[h>>2]|0;if(y){r=0;do{q=b+(l*36|0)+(r<<2)+148|0;p=c[q>>2]|0;if(!(o&1<<r)){G=c[b+364>>2]|0;c[b+364>>2]=G+1;c[b+(G<<2)+348>>2]=p}else{c[b+((1-l|0)*36|0)+(c[b+((1-l|0)*36|0)+180>>2]<<2)+148>>2]=p;D=+g[h+8+(r<<2)>>2];G=c[b+((1-l|0)*36|0)+180>>2]|0;c[b+((1-l|0)*36|0)+180>>2]=G+1;g[b+((1-l|0)*36|0)+(G<<2)+164>>2]=D;G=c[q>>2]|0;E=D*+g[G+20>>2];F=D*+g[G+24>>2];g[b+128>>2]=+g[G+16>>2]*D+ +g[b+128>>2];g[b+132>>2]=E+ +g[b+132>>2];g[b+136>>2]=F+ +g[b+136>>2]}r=r+1|0}while((r|0)!=(y|0))}if((o|0)==15)c[b+376>>2]=1;if(f>>>0>=128){k=34;break}if(c[b+376>>2]|0)break;e=e+1&3;f=f+1|0}if((k|0)==5)c[b+376>>2]=1;else if((k|0)==9){G=c[b+368>>2]|0;z=(c[b+(G*36|0)+180>>2]|0)+ -1|0;c[b+(G*36|0)+180>>2]=z;z=c[b+(G*36|0)+(z<<2)+148>>2]|0;G=c[b+364>>2]|0;c[b+364>>2]=G+1;c[b+(G<<2)+348>>2]=z}else if((k|0)==11){G=c[b+368>>2]|0;z=(c[b+(G*36|0)+180>>2]|0)+ -1|0;c[b+(G*36|0)+180>>2]=z;z=c[b+(G*36|0)+(z<<2)+148>>2]|0;G=c[b+364>>2]|0;c[b+364>>2]=G+1;c[b+(G<<2)+348>>2]=z}else if((k|0)==32){G=c[b+368>>2]|0;z=(c[b+(G*36|0)+180>>2]|0)+ -1|0;c[b+(G*36|0)+180>>2]=z;z=c[b+(G*36|0)+(z<<2)+148>>2]|0;G=c[b+364>>2]|0;c[b+364>>2]=G+1;c[b+(G<<2)+348>>2]=z}else if((k|0)==34)c[b+376>>2]=2;c[b+372>>2]=b+((c[b+368>>2]|0)*36|0)+148;k=c[b+376>>2]|0;if((k|0)==1){g[b+144>>2]=0.0;i=h;return k|0}else if(!k){D=+g[b+128>>2];E=+g[b+132>>2];F=+g[b+136>>2];g[b+144>>2]=+Q(+(D*D+E*E+F*F));i=h;return k|0}else{i=h;return k|0}return 0}function PD(a){a=a|0;var b=0,d=0,e=0.0,f=0.0,h=0.0,j=0.0,k=0.0,l=0.0,m=0,n=0,o=0,p=0.0,q=0.0,r=0.0;b=i;i=i+32|0;d=c[a+372>>2]|0;m=c[d+32>>2]|0;a:do if((m|0)==2){n=c[d+4>>2]|0;d=c[d>>2]|0;h=+g[n+16>>2]- +g[d+16>>2];e=+g[n+20>>2]- +g[d+20>>2];f=+g[n+24>>2]- +g[d+24>>2];d=0;while(1){n=b+(d<<2)|0;c[b+0>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;g[n>>2]=1.0;j=+g[b+8>>2];k=+g[b+4>>2];l=+g[b>>2];if((e*j-f*k)*(e*j-f*k)+(f*l-h*j)*(f*l-h*j)+(h*k-e*l)*(h*k-e*l)>0.0){m=c[a+372>>2]|0;g[m+(c[m+32>>2]<<2)+16>>2]=0.0;n=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=n;c[m+(c[m+32>>2]<<2)>>2]=c[a+(n<<2)+348>>2];n=c[m+32>>2]|0;c[m+32>>2]=n+1;RD(a,e*j-f*k,f*l-h*j,h*k-e*l,c[m+(n<<2)>>2]|0);if(PD(a)|0){d=1;a=19;break}m=c[a+372>>2]|0;n=(c[m+32>>2]|0)+ -1|0;c[m+32>>2]=n;n=c[m+(n<<2)>>2]|0;m=c[a+364>>2]|0;c[a+364>>2]=m+1;c[a+(m<<2)+348>>2]=n;m=c[a+372>>2]|0;g[m+(c[m+32>>2]<<2)+16>>2]=0.0;n=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=n;c[m+(c[m+32>>2]<<2)>>2]=c[a+(n<<2)+348>>2];n=c[m+32>>2]|0;c[m+32>>2]=n+1;RD(a,-(e*j-f*k),-(f*l-h*j),-(h*k-e*l),c[m+(n<<2)>>2]|0);if(PD(a)|0){d=1;a=19;break}n=c[a+372>>2]|0;m=(c[n+32>>2]|0)+ -1|0;c[n+32>>2]=m;m=c[n+(m<<2)>>2]|0;n=c[a+364>>2]|0;c[a+364>>2]=n+1;c[a+(n<<2)+348>>2]=m}d=d+1|0;if(d>>>0>=3)break a}if((a|0)==19){i=b;return d|0}}else if((m|0)==1){n=1;m=0;while(1){o=b+16+(m<<2)|0;c[b+16>>2]=0;c[b+20>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;g[o>>2]=1.0;o=d+32|0;g[d+(n<<2)+16>>2]=0.0;n=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=n;c[d+(c[o>>2]<<2)>>2]=c[a+(n<<2)+348>>2];n=c[o>>2]|0;c[o>>2]=n+1;h=+g[b+16>>2];e=+g[b+20>>2];f=+g[b+24>>2];RD(a,h,e,f,c[d+(n<<2)>>2]|0);if(PD(a)|0){d=1;a=19;break}n=c[a+372>>2]|0;o=(c[n+32>>2]|0)+ -1|0;c[n+32>>2]=o;o=c[n+(o<<2)>>2]|0;n=c[a+364>>2]|0;c[a+364>>2]=n+1;c[a+(n<<2)+348>>2]=o;n=c[a+372>>2]|0;g[n+(c[n+32>>2]<<2)+16>>2]=0.0;o=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=o;c[n+(c[n+32>>2]<<2)>>2]=c[a+(o<<2)+348>>2];o=c[n+32>>2]|0;c[n+32>>2]=o+1;RD(a,-h,-e,-f,c[n+(o<<2)>>2]|0);if(PD(a)|0){d=1;a=19;break}o=c[a+372>>2]|0;n=(c[o+32>>2]|0)+ -1|0;c[o+32>>2]=n;n=c[o+(n<<2)>>2]|0;o=c[a+364>>2]|0;c[a+364>>2]=o+1;c[a+(o<<2)+348>>2]=n;m=m+1|0;if(m>>>0>=3)break a;d=c[a+372>>2]|0;n=c[d+32>>2]|0}if((a|0)==19){i=b;return d|0}}else if((m|0)==3){o=c[d+4>>2]|0;n=c[d>>2]|0;e=+g[n+16>>2];j=+g[o+16>>2]-e;f=+g[n+20>>2];l=+g[o+20>>2]-f;k=+g[n+24>>2];h=+g[o+24>>2]-k;o=c[d+8>>2]|0;e=+g[o+16>>2]-e;f=+g[o+20>>2]-f;k=+g[o+24>>2]-k;if((l*k-h*f)*(l*k-h*f)+(h*e-j*k)*(h*e-j*k)+(j*f-l*e)*(j*f-l*e)>0.0){g[d+28>>2]=0.0;o=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=o;c[d+(c[d+32>>2]<<2)>>2]=c[a+(o<<2)+348>>2];o=c[d+32>>2]|0;c[d+32>>2]=o+1;RD(a,l*k-h*f,h*e-j*k,j*f-l*e,c[d+(o<<2)>>2]|0);if(PD(a)|0){o=1;i=b;return o|0}n=c[a+372>>2]|0;o=(c[n+32>>2]|0)+ -1|0;c[n+32>>2]=o;o=c[n+(o<<2)>>2]|0;n=c[a+364>>2]|0;c[a+364>>2]=n+1;c[a+(n<<2)+348>>2]=o;n=c[a+372>>2]|0;g[n+(c[n+32>>2]<<2)+16>>2]=0.0;o=(c[a+364>>2]|0)+ -1|0;c[a+364>>2]=o;c[n+(c[n+32>>2]<<2)>>2]=c[a+(o<<2)+348>>2];o=c[n+32>>2]|0;c[n+32>>2]=o+1;RD(a,-(l*k-h*f),-(h*e-j*k),-(j*f-l*e),c[n+(o<<2)>>2]|0);if(PD(a)|0){o=1;i=b;return o|0}else{o=c[a+372>>2]|0;n=(c[o+32>>2]|0)+ -1|0;c[o+32>>2]=n;n=c[o+(n<<2)>>2]|0;o=c[a+364>>2]|0;c[a+364>>2]=o+1;c[a+(o<<2)+348>>2]=n;break}}}else if((m|0)==4?(o=c[d>>2]|0,n=c[d+12>>2]|0,l=+g[n+16>>2],r=+g[o+16>>2]-l,p=+g[n+20>>2],e=+g[o+20>>2]-p,h=+g[n+24>>2],j=+g[o+24>>2]-h,o=c[d+4>>2]|0,f=+g[o+16>>2]-l,k=+g[o+20>>2]-p,q=+g[o+24>>2]-h,o=c[d+8>>2]|0,l=+g[o+16>>2]-l,p=+g[o+20>>2]-p,h=+g[o+24>>2]-h,!((0.0!=0.0?1:r*k*h+(e*q*l+j*f*p-r*q*p-e*f*h)-j*k*l!=r*k*h+(e*q*l+j*f*p-r*q*p-e*f*h)-j*k*l)|r*k*h+(e*q*l+j*f*p-r*q*p-e*f*h)-j*k*l==0.0)):0){o=1;i=b;return o|0}while(0);o=0;i=b;return o|0}function QD(b,d,e,f,h){b=b|0;d=d|0;e=e|0;f=f|0;h=h|0;var j=0,k=0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0;k=i;j=c[b+9288>>2]|0;if(!j){c[b>>2]=5;s=0;i=k;return s|0}s=c[j+48>>2]|0;if(s)c[s+44>>2]=c[j+44>>2];s=c[j+44>>2]|0;if(s)c[s+48>>2]=c[j+48>>2];if((c[b+9288>>2]|0)==(j|0))c[b+9288>>2]=c[j+48>>2];c[b+9292>>2]=(c[b+9292>>2]|0)+ -1;c[j+44>>2]=0;c[j+48>>2]=c[b+9280>>2];s=c[b+9280>>2]|0;if(s)c[s+44>>2]=j;c[b+9280>>2]=j;c[b+9284>>2]=(c[b+9284>>2]|0)+1;a[j+55>>0]=0;c[j+20>>2]=d;c[j+24>>2]=e;c[j+28>>2]=f;p=+g[d+16>>2];n=+g[e+16>>2]-p;r=+g[d+20>>2];q=+g[e+20>>2]-r;m=+g[d+24>>2];l=+g[e+24>>2]-m;p=+g[f+16>>2]-p;r=+g[f+20>>2]-r;m=+g[f+24>>2]-m;g[j>>2]=q*m-l*r;g[j+4>>2]=l*p-n*m;g[j+8>>2]=n*r-q*p;g[j+12>>2]=0.0;o=+Q(+((q*m-l*r)*(q*m-l*r)+(l*p-n*m)*(l*p-n*m)+(n*r-q*p)*(n*r-q*p)));do if(o>9999999747378752.0e-20){if((!(TD(q*m-l*r,l*p-n*m,n*r-q*p,+g[d+16>>2],+g[d+20>>2],+g[d+24>>2],+g[e+16>>2],+g[e+20>>2],+g[e+24>>2],j+16|0)|0)?!(TD(+g[j>>2],+g[j+4>>2],+g[j+8>>2],+g[e+16>>2],+g[e+20>>2],+g[e+24>>2],+g[f+16>>2],+g[f+20>>2],+g[f+24>>2],j+16|0)|0):0)?!(TD(+g[j>>2],+g[j+4>>2],+g[j+8>>2],+g[f+16>>2],+g[f+20>>2],+g[f+24>>2],+g[d+16>>2],+g[d+20>>2],+g[d+24>>2],j+16|0)|0):0)g[j+16>>2]=(+g[d+16>>2]*+g[j>>2]+ +g[d+20>>2]*+g[j+4>>2]+ +g[d+24>>2]*+g[j+8>>2])/o;g[j>>2]=1.0/o*+g[j>>2];g[j+4>>2]=1.0/o*+g[j+4>>2];g[j+8>>2]=1.0/o*+g[j+8>>2];if(h){s=j;i=k;return s|0}if(!(+g[j+16>>2]>=-9999999747378752.0e-21)){c[b>>2]=3;break}else{s=j;i=k;return s|0}}else c[b>>2]=2;while(0);h=c[j+48>>2]|0;if(h)c[h+44>>2]=c[j+44>>2];h=c[j+44>>2]|0;if(h)c[h+48>>2]=c[j+48>>2];if((c[b+9280>>2]|0)==(j|0))c[b+9280>>2]=c[j+48>>2];c[b+9284>>2]=(c[b+9284>>2]|0)+ -1;c[j+44>>2]=0;c[j+48>>2]=c[b+9288>>2];h=c[b+9288>>2]|0;if(h)c[h+44>>2]=j;c[b+9288>>2]=j;c[b+9292>>2]=(c[b+9292>>2]|0)+1;s=0;i=k;return s|0}function RD(a,b,e,f,h){a=a|0;b=+b;e=+e;f=+f;h=h|0;var j=0,k=0,l=0,m=0,n=0.0,o=0.0;j=i;i=i+48|0;n=1.0/+Q(+(b*b+e*e+f*f));g[h>>2]=n*b;g[h+4>>2]=n*e;g[h+8>>2]=n*f;g[h+12>>2]=0.0;l=d[a+120>>0]|d[a+121>>0]<<8|d[a+122>>0]<<16|d[a+123>>0]<<24;m=d[a+124>>0]|d[a+125>>0]<<8|d[a+126>>0]<<16|d[a+127>>0]<<24;k=(c[a>>2]|0)+(m>>1)|0;if(m&1)l=c[(c[k>>2]|0)+l>>2]|0;rc[l&127](j,k,h);e=-+g[h>>2];f=-+g[h+4>>2];b=-+g[h+8>>2];l=d[a+120>>0]|d[a+121>>0]<<8|d[a+122>>0]<<16|d[a+123>>0]<<24;m=d[a+124>>0]|d[a+125>>0]<<8|d[a+126>>0]<<16|d[a+127>>0]<<24;k=(c[a+4>>2]|0)+(m>>1)|0;if(m&1)l=c[(c[k>>2]|0)+l>>2]|0;n=+g[a+24>>2]*e+ +g[a+28>>2]*f+ +g[a+32>>2]*b;o=+g[a+40>>2]*e+ +g[a+44>>2]*f+ +g[a+48>>2]*b;g[j+16>>2]=+g[a+8>>2]*e+ +g[a+12>>2]*f+ +g[a+16>>2]*b;g[j+20>>2]=n;g[j+24>>2]=o;g[j+28>>2]=0.0;rc[l&127](j+32|0,k,j+16|0);o=+g[j+32>>2];e=+g[j+36>>2];f=+g[j+40>>2];b=+g[j+4>>2]-(o*+g[a+72>>2]+e*+g[a+76>>2]+f*+g[a+80>>2]+ +g[a+108>>2]);n=+g[j+8>>2]-(o*+g[a+88>>2]+e*+g[a+92>>2]+f*+g[a+96>>2]+ +g[a+112>>2]);g[h+16>>2]=+g[j>>2]-(o*+g[a+56>>2]+e*+g[a+60>>2]+f*+g[a+64>>2]+ +g[a+104>>2]);g[h+20>>2]=b;g[h+24>>2]=n;g[h+28>>2]=0.0;i=j;return}function SD(b,e,f,h,j,k){b=b|0;e=e|0;f=f|0;h=h|0;j=j|0;k=k|0;var l=0,m=0;l=i;if((d[h+55>>0]|0|0)==(e|0)){j=0;i=l;return j|0}m=c[19552+(j<<2)>>2]|0;if(+g[h>>2]*+g[f+16>>2]+ +g[h+4>>2]*+g[f+20>>2]+ +g[h+8>>2]*+g[f+24>>2]- +g[h+16>>2]<-9999999747378752.0e-21){b=QD(b,c[h+(m<<2)+20>>2]|0,c[h+(j<<2)+20>>2]|0,f,0)|0;if(!b){j=0;i=l;return j|0}a[b+52>>0]=j;c[b+32>>2]=h;a[h+j+52>>0]=0;c[h+(j<<2)+32>>2]=b;h=c[k>>2]|0;if(!h)c[k+4>>2]=b;else{a[h+53>>0]=2;c[h+36>>2]=b;a[b+54>>0]=1;c[b+40>>2]=h}c[k>>2]=b;c[k+8>>2]=(c[k+8>>2]|0)+1;j=1;i=l;return j|0}j=c[19536+(j<<2)>>2]|0;a[h+55>>0]=e;if(!(SD(b,e,f,c[h+(m<<2)+32>>2]|0,d[h+m+52>>0]|0,k)|0)){j=0;i=l;return j|0}if(!(SD(b,e,f,c[h+(j<<2)+32>>2]|0,d[h+j+52>>0]|0,k)|0)){j=0;i=l;return j|0}k=c[h+48>>2]|0;if(k)c[k+44>>2]=c[h+44>>2];k=c[h+44>>2]|0;if(k)c[k+48>>2]=c[h+48>>2];if((c[b+9280>>2]|0)==(h|0))c[b+9280>>2]=c[h+48>>2];c[b+9284>>2]=(c[b+9284>>2]|0)+ -1;c[h+44>>2]=0;c[h+48>>2]=c[b+9288>>2];k=c[b+9288>>2]|0;if(k)c[k+44>>2]=h;c[b+9288>>2]=h;c[b+9292>>2]=(c[b+9292>>2]|0)+1;j=1;i=l;return j|0}function TD(a,b,c,d,e,f,h,j,k,l){a=+a;b=+b;c=+c;d=+d;e=+e;f=+f;h=+h;j=+j;k=+k;l=l|0;var m=0;m=i;if(!(((h-d)*b-(j-e)*a)*f+(((j-e)*c-(k-f)*b)*d+((k-f)*a-(h-d)*c)*e)<0.0)){l=0;i=m;return l|0}if((h-d)*d+(j-e)*e+(k-f)*f>0.0){g[l>>2]=+Q(+(d*d+e*e+f*f));l=1;i=m;return l|0}if((h-d)*h+(j-e)*j+(k-f)*k<0.0){g[l>>2]=+Q(+(h*h+j*j+k*k));l=1;i=m;return l|0}else{b=((h*h+j*j+k*k)*(d*d+e*e+f*f)-(h*d+j*e+k*f)*(h*d+j*e+k*f))/((h-d)*(h-d)+(j-e)*(j-e)+(k-f)*(k-f));g[l>>2]=+Q(+(b>0.0?b:0.0));l=1;i=m;return l|0}return 0}function UD(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0.0,h=0.0,j=0.0,k=0,l=0.0,m=0.0,n=0.0;k=i;l=+g[a>>2];f=+g[b>>2]-l;m=+g[a+4>>2];h=+g[b+4>>2]-m;n=+g[a+8>>2];j=+g[b+8>>2]-n;if(!(f*f+h*h+j*j>0.0)){n=-1.0;i=k;return+n}l=-(l*f+m*h+n*j)/(f*f+h*h+j*j);if(l>=1.0){g[d>>2]=0.0;g[d+4>>2]=1.0;c[e>>2]=2;l=+g[b>>2];m=+g[b+4>>2];n=+g[b+8>>2];n=l*l+m*m+n*n;i=k;return+n}if(!(l<=0.0)){g[d+4>>2]=l;g[d>>2]=1.0-l;c[e>>2]=3;f=f*l+ +g[a>>2];m=h*l+ +g[a+4>>2];n=j*l+ +g[a+8>>2];n=f*f+m*m+n*n;i=k;return+n}else{g[d>>2]=1.0;g[d+4>>2]=0.0;c[e>>2]=1;l=+g[a>>2];m=+g[a+4>>2];n=+g[a+8>>2];n=l*l+m*m+n*n;i=k;return+n}return 0.0}function VD(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var h=0.0,j=0.0,k=0.0,l=0.0,m=0.0,n=0.0,o=0.0,p=0.0,q=0.0,r=0.0,s=0.0,t=0.0,u=0,v=0,w=0.0,x=0.0,y=0.0,z=0,A=0.0,B=0.0,C=0.0,D=0.0,E=0,F=0.0;u=i;i=i+80|0;c[u+64>>2]=a;c[u+68>>2]=b;c[u+72>>2]=d;r=+g[a>>2];l=+g[b>>2];s=+g[a+4>>2];n=+g[b+4>>2];t=+g[a+8>>2];p=+g[b+8>>2];g[u+16>>2]=r-l;g[u+20>>2]=s-n;g[u+24>>2]=t-p;g[u+28>>2]=0.0;m=+g[d>>2];o=+g[d+4>>2];q=+g[d+8>>2];g[u+32>>2]=l-m;g[u+36>>2]=n-o;g[u+40>>2]=p-q;g[u+44>>2]=0.0;g[u+48>>2]=m-r;g[u+52>>2]=o-s;g[u+56>>2]=q-t;g[u+60>>2]=0.0;j=(s-n)*(p-q)-(t-p)*(n-o);k=(t-p)*(l-m)-(p-q)*(r-l);h=(n-o)*(r-l)-(s-n)*(l-m);if(!(h*h+(j*j+k*k)>0.0)){F=-1.0;i=u;return+F}c[u>>2]=0;c[u+4>>2]=0;c[u+8>>2]=0;B=s-n;D=t-p;C=r-l;x=r;y=s;A=t;z=a;E=0;F=-1.0;while(1){if(x*(h*B-k*D)+y*(j*D-h*C)+(k*C-j*B)*A>0.0?(v=c[19552+(E<<2)>>2]|0,w=+UD(z,c[u+64+(v<<2)>>2]|0,u,u+8|0),F<0.0|w<F):0){z=c[u+8>>2]|0;c[f>>2]=((z&1|0)==0?0:1<<E)+((z&2|0)==0?0:1<<v);g[e+(E<<2)>>2]=+g[u>>2];g[e+(v<<2)>>2]=+g[u+4>>2];g[e+(c[19552+(v<<2)>>2]<<2)>>2]=0.0;F=w}E=E+1|0;if((E|0)==3)break;z=c[u+64+(E<<2)>>2]|0;B=+g[u+16+(E<<4)+4>>2];D=+g[u+16+(E<<4)+8>>2];C=+g[u+16+(E<<4)>>2];x=+g[z>>2];y=+g[z+4>>2];A=+g[z+8>>2]}if(!(F<0.0)){i=u;return+F}C=+Q(+(h*h+(j*j+k*k)));F=(j*+g[a>>2]+k*+g[a+4>>2]+h*+g[a+8>>2])/(h*h+(j*j+k*k));c[f>>2]=7;A=+g[b>>2]-j*F;y=+g[b+4>>2]-k*F;D=+g[b+8>>2]-h*F;D=+Q(+((y*(l-m)-A*(n-o))*(y*(l-m)-A*(n-o))+(((n-o)*D-y*(p-q))*((n-o)*D-y*(p-q))+(A*(p-q)-D*(l-m))*(A*(p-q)-D*(l-m)))))/C;g[e>>2]=D;A=+g[d>>2]-j*F;y=+g[d+4>>2]-k*F;B=+g[d+8>>2]-h*F;C=+Q(+((y*(m-r)-A*(o-s))*(y*(m-r)-A*(o-s))+(((o-s)*B-y*(q-t))*((o-s)*B-y*(q-t))+(A*(q-t)-B*(m-r))*(A*(q-t)-B*(m-r)))))/C;g[e+4>>2]=C;g[e+8>>2]=1.0-(C+D);F=h*F*h*F+(j*F*j*F+k*F*k*F);i=u;return+F}function WD(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0;e=i;f=c[b+12>>2]|0;d=c[b+32>>2]|0;if((d|0)>=(f|0)){i=e;return}if((d|0)<=(f|0)){if((c[b+36>>2]|0)<(f|0)){if(!f){g=0;j=d}else{c[5004]=(c[5004]|0)+1;g=fF((f<<2|3)+16|0)|0;if(!g)g=0;else{c[(g+19&-16)+ -4>>2]=g;g=g+19&-16}j=c[b+32>>2]|0}if((j|0)>0){h=0;do{k=g+(h<<2)|0;if(k)c[k>>2]=c[(c[b+40>>2]|0)+(h<<2)>>2];h=h+1|0}while((h|0)!=(j|0))}h=c[b+40>>2]|0;if(h){if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+40>>2]=0}a[b+44>>0]=1;c[b+40>>2]=g;c[b+36>>2]=f}else g=c[b+40>>2]|0;h=d;do{j=g+(h<<2)|0;if(j)c[j>>2]=0;h=h+1|0}while((h|0)!=(f|0))}c[b+32>>2]=f;g=c[b+52>>2]|0;if((g|0)<(f|0)){if((c[b+56>>2]|0)<(f|0)){if(!f){h=0;j=g}else{c[5004]=(c[5004]|0)+1;h=fF((f<<2|3)+16|0)|0;if(!h)h=0;else{c[(h+19&-16)+ -4>>2]=h;h=h+19&-16}j=c[b+52>>2]|0}if((j|0)>0){k=0;do{l=h+(k<<2)|0;if(l)c[l>>2]=c[(c[b+60>>2]|0)+(k<<2)>>2];k=k+1|0}while((k|0)!=(j|0))}j=c[b+60>>2]|0;if(j){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[j+ -4>>2]|0)}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=h;c[b+56>>2]=f}else h=c[b+60>>2]|0;do{j=h+(g<<2)|0;if(j)c[j>>2]=0;g=g+1|0}while((g|0)!=(f|0))}c[b+52>>2]=f;if((f|0)>0){jF(c[b+40>>2]|0,-1,f<<2|0)|0;jF(c[b+60>>2]|0,-1,f<<2|0)|0}if((d|0)<=0){i=e;return}h=c[b+16>>2]|0;g=c[b+40>>2]|0;f=c[b+60>>2]|0;j=0;do{l=c[h+(j*12|0)+4>>2]<<16|c[h+(j*12|0)>>2];l=(l+~(l<<15)>>10^l+~(l<<15))*9|0;l=g+((((l>>6^l)+~((l>>6^l)<<11)>>16^(l>>6^l)+~((l>>6^l)<<11))&(c[b+12>>2]|0)+ -1)<<2)|0;c[f+(j<<2)>>2]=c[l>>2];c[l>>2]=j;j=j+1|0}while((j|0)!=(d|0));i=e;return}function XD(a){a=a|0;var b=0;b=i;YD(a);gF(a);i=b;return}function YD(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=19600;e=c[b+60>>2]|0;if(e){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=0;c[b+52>>2]=0;c[b+56>>2]=0;e=c[b+40>>2]|0;if(e){if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+40>>2]=0}a[b+44>>0]=1;c[b+40>>2]=0;c[b+32>>2]=0;c[b+36>>2]=0;e=c[b+16>>2]|0;if(!e){a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0;a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;e=b+12|0;c[e>>2]=0;i=d;return}function ZD(b){b=b|0;var d=0,e=0,f=0,g=0,h=0,j=0;d=i;e=c[b+16>>2]|0;if(e){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;e=c[b+40>>2]|0;if(e){if(a[b+44>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+40>>2]=0}a[b+44>>0]=1;c[b+40>>2]=0;c[b+32>>2]=0;c[b+36>>2]=0;e=c[b+60>>2]|0;if(e){if(a[b+64>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+60>>2]=0}a[b+64>>0]=1;c[b+60>>2]=0;c[b+52>>2]=0;c[b+56>>2]=0;if((c[b+12>>2]|0)>=2){WD(b);i=d;return}c[5004]=(c[5004]|0)+1;e=fF(43)|0;if(!e)e=0;else{c[(e+19&-16)+ -4>>2]=e;e=e+19&-16}f=c[b+8>>2]|0;if((f|0)>0){h=0;do{g=e+(h*12|0)|0;if(g){j=(c[b+16>>2]|0)+(h*12|0)|0;c[g+0>>2]=c[j+0>>2];c[g+4>>2]=c[j+4>>2];c[g+8>>2]=c[j+8>>2]}h=h+1|0}while((h|0)!=(f|0))}f=c[b+16>>2]|0;if(f){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=e;c[b+12>>2]=2;WD(b);i=d;return}function _D(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0;e=i;c[4892]=(c[4892]|0)+1;k=((d<<16|b)+~((d<<16|b)<<15)>>10^(d<<16|b)+~((d<<16|b)<<15))*9|0;g=c[a+40>>2]|0;k=g+(((c[a+12>>2]|0)+ -1&((k>>6^k)+~((k>>6^k)<<11)>>16^(k>>6^k)+~((k>>6^k)<<11)))<<2)|0;l=c[k>>2]|0;if((l|0)==-1){o=0;i=e;return o|0}h=c[a+16>>2]|0;j=l;while(1){if((c[h+(j*12|0)>>2]|0)==(b|0)?(c[h+(j*12|0)+4>>2]|0)==(d|0):0)break;j=c[(c[a+60>>2]|0)+(j<<2)>>2]|0;if((j|0)==-1){a=0;f=22;break}}if((f|0)==22){i=e;return a|0}if(!(h+(j*12|0)|0)){o=0;i=e;return o|0}b=c[h+(j*12|0)+8>>2]|0;j=(j*12|0)/12|0;d=c[a+60>>2]|0;if((l|0)!=(j|0)){while(1){m=d+(l<<2)|0;n=c[m>>2]|0;if((n|0)==(j|0))break;else l=n}n=c[d+(j<<2)>>2]|0;if((l|0)==-1)f=12;else c[m>>2]=n}else{n=c[d+(l<<2)>>2]|0;f=12}if((f|0)==12)c[k>>2]=n;l=(c[a+8>>2]|0)+ -1|0;if((l|0)==(j|0)){c[a+8>>2]=j;o=b;i=e;return o|0}k=c[h+(l*12|0)+4>>2]<<16|c[h+(l*12|0)>>2];k=(k+~(k<<15)>>10^k+~(k<<15))*9|0;k=((k>>6^k)+~((k>>6^k)<<11)>>16^(k>>6^k)+~((k>>6^k)<<11))&(c[a+12>>2]|0)+ -1;n=c[g+(k<<2)>>2]|0;if((n|0)!=(l|0)){while(1){m=d+(n<<2)|0;o=c[m>>2]|0;if((o|0)==(l|0))break;else n=o}d=c[d+(l<<2)>>2]|0;if((n|0)==-1)f=20;else c[m>>2]=d}else{d=c[d+(l<<2)>>2]|0;f=20}if((f|0)==20)c[g+(k<<2)>>2]=d;c[h+(j*12|0)+0>>2]=c[h+(l*12|0)+0>>2];c[h+(j*12|0)+4>>2]=c[h+(l*12|0)+4>>2];c[h+(j*12|0)+8>>2]=c[h+(l*12|0)+8>>2];o=(c[a+40>>2]|0)+(k<<2)|0;c[(c[a+60>>2]|0)+(j<<2)>>2]=c[o>>2];c[o>>2]=j;c[a+8>>2]=(c[a+8>>2]|0)+ -1;o=b;i=e;return o|0}function $D(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;f=i;c[4894]=(c[4894]|0)+1;h=((e<<16|d)+~((e<<16|d)<<15)>>10^(e<<16|d)+~((e<<16|d)<<15))*9|0;h=(h>>6^h)+~((h>>6^h)<<11)>>16^(h>>6^h)+~((h>>6^h)<<11);g=c[b+12>>2]|0;k=c[(c[b+40>>2]|0)+((g+ -1&h)<<2)>>2]|0;a:do if((k|0)!=-1){j=c[b+16>>2]|0;while(1){if((c[j+(k*12|0)>>2]|0)==(d|0)?(c[j+(k*12|0)+4>>2]|0)==(e|0):0)break;k=c[(c[b+60>>2]|0)+(k<<2)>>2]|0;if((k|0)==-1)break a}j=j+(k*12|0)|0;if(j){o=j;i=f;return o|0}}while(0);j=c[b+8>>2]|0;if((j|0)==(g|0)){k=(g|0)==0?1:g<<1;if((g|0)<(k|0)){if(!k){l=0;o=g}else{c[5004]=(c[5004]|0)+1;l=fF((k*12|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}o=c[b+8>>2]|0}if((o|0)>0){n=0;do{m=l+(n*12|0)|0;if(m){p=(c[b+16>>2]|0)+(n*12|0)|0;c[m+0>>2]=c[p+0>>2];c[m+4>>2]=c[p+4>>2];c[m+8>>2]=c[p+8>>2]}n=n+1|0}while((n|0)!=(o|0))}m=c[b+16>>2]|0;if(m){if(a[b+20>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+16>>2]=0}a[b+20>>0]=1;c[b+16>>2]=l;c[b+12>>2]=k;l=c[b+8>>2]|0}else{l=g;k=g}}else{l=j;k=g}c[b+8>>2]=l+1;l=c[b+16>>2]|0;if((g|0)<(k|0)){WD(b);g=(c[b+12>>2]|0)+ -1&h}else g=g+ -1&h;if(!(l+(j*12|0)|0))d=0;else{c[l+(j*12|0)>>2]=d;c[l+(j*12|0)+4>>2]=e;c[l+(j*12|0)+8>>2]=0;d=l+(j*12|0)|0}c[d+8>>2]=0;p=(c[b+40>>2]|0)+(g<<2)|0;c[(c[b+60>>2]|0)+(j<<2)>>2]=c[p>>2];c[p>>2]=j;p=d;i=f;return p|0}function aE(a){a=a|0;return c[a+16>>2]|0}function bE(a,b,c,d,e,f,h,j,k,l,m){a=a|0;b=b|0;c=+c;d=+d;e=+e;f=+f;h=+h;j=+j;k=k|0;l=l|0;m=+m;var n=0.0,o=0.0,p=0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0.0,A=0.0,B=0.0;p=i;o=+g[a>>2]*f+ +g[a+16>>2]*h+ +g[a+32>>2]*j;n=+g[a+4>>2]*f+ +g[a+20>>2]*h+ +g[a+36>>2]*j;r=+g[a+8>>2]*f+ +g[a+24>>2]*h+ +g[a+40>>2]*j;q=+g[b>>2]*f+ +g[b+16>>2]*h+ +g[b+32>>2]*j;s=+g[b+4>>2]*f+ +g[b+20>>2]*h+ +g[b+36>>2]*j;t=+g[b+8>>2]*f+ +g[b+24>>2]*h+ +g[b+40>>2]*j;u=+g[k+80>>2];if(o<0.0)u=-u;v=+g[k+84>>2];if(n<0.0)v=-v;w=+g[k+88>>2];if(r<0.0)w=-w;x=+g[l+80>>2];if(q<0.0)x=-x;y=+g[l+84>>2];if(s<0.0)y=-y;z=+g[l+88>>2];if(!(t<0.0)){A=z;z=o*u;v=n*v;v=z+v;z=r*w;z=v+z;x=q*x;y=s*y;y=x+y;x=t*A;x=y+x;a=k+96|0;y=+g[a>>2];a=z>y;y=a?z:y;a=l+96|0;z=+g[a>>2];a=x>z;z=a?x:z;z=y+z;y=c*f+d*h+e*j+z;z=z-(c*f+d*h+e*j);a=y<z;z=a?y:z;a=!(z>m);i=p;return a|0}B=-z;A=o*u;z=n*v;z=A+z;A=r*w;A=z+A;x=q*x;z=s*y;z=x+z;y=t*B;y=z+y;a=k+96|0;z=+g[a>>2];a=A>z;z=a?A:z;a=l+96|0;A=+g[a>>2];a=y>A;A=a?y:A;A=z+A;z=c*f+d*h+e*j+A;A=A-(c*f+d*h+e*j);a=z<A;A=a?z:A;a=!(A>m);i=p;return a|0}function cE(b,d,e,f,h,j,k){b=b|0;d=d|0;e=e|0;f=f|0;h=+h;j=+j;k=k|0;var l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0.0,A=0.0,B=0.0,C=0.0,D=0.0,E=0.0,F=0,G=0.0,H=0,I=0,J=0,K=0,L=0,M=0,N=0.0,O=0.0,P=0.0,Q=0.0,R=0,S=0.0,T=0.0,U=0.0,V=0.0,W=0,X=0,Y=0,Z=0.0,_=0.0,$=0.0,aa=0.0,ba=0.0,ca=0,da=0;l=i;i=i+64|0;a[l+48>>0]=1;c[l+44>>2]=0;c[l+36>>2]=0;c[l+40>>2]=0;m=c[f+4>>2]|0;if((m|0)>0){c[5004]=(c[5004]|0)+1;n=fF((m<<4|3)+16|0)|0;if(!n)u=0;else{c[(n+19&-16)+ -4>>2]=n;u=n+19&-16}a[l+48>>0]=1;c[l+44>>2]=u;c[l+40>>2]=m}else u=0;t=c[d+28>>2]|0;if((t|0)>0){n=c[d+36>>2]|0;G=+g[e>>2];N=+g[e+4>>2];O=+g[e+8>>2];E=+g[e+16>>2];D=+g[e+20>>2];C=+g[e+24>>2];B=+g[e+32>>2];A=+g[e+36>>2];z=+g[e+40>>2];V=+g[b>>2];U=+g[b+4>>2];Z=+g[b+8>>2];m=-1;T=3.4028234663852886e+38;v=0;while(1){S=+g[n+(v*36|0)+20>>2];Q=+g[n+(v*36|0)+24>>2];P=+g[n+(v*36|0)+28>>2];s=(S*G+Q*N+P*O)*V+(S*E+Q*D+P*C)*U+(S*B+Q*A+P*z)*Z<T;m=s?v:m;v=v+1|0;if((v|0)>=(t|0))break;else T=s?(S*G+Q*N+P*O)*V+(S*E+Q*D+P*C)*U+(S*B+Q*A+P*z)*Z:T}if((m|0)>=0){v=c[n+(m*36|0)+4>>2]|0;if((v|0)>0){w=n+(m*36|0)+12|0;s=n+(m*36|0)+20|0;u=n+(m*36|0)+24|0;t=n+(m*36|0)+28|0;P=E;Q=D;S=C;T=B;U=A;V=z;y=l+32|0;x=0;while(1){F=c[w>>2]|0;Y=c[F+(x<<2)>>2]|0;M=c[d+16>>2]|0;x=x+1|0;F=c[F+(((x|0)==(v|0)?0:x)<<2)>>2]|0;$=+g[M+(Y<<4)>>2];aa=$- +g[M+(F<<4)>>2];_=+g[M+(Y<<4)+4>>2];ba=_- +g[M+(F<<4)+4>>2];Z=+g[M+(Y<<4)+8>>2];C=Z- +g[M+(F<<4)+8>>2];B=aa*G+ba*N+C*O;A=aa*P+ba*Q+C*S;C=aa*T+ba*U+C*V;ba=+g[s>>2];aa=+g[u>>2];z=+g[t>>2];E=G*ba+N*aa+O*z;D=P*ba+Q*aa+S*z;z=T*ba+U*aa+V*z;G=($*G+_*N+Z*O+ +g[e+48>>2])*-(A*z-C*D)+($*P+_*Q+Z*S+ +g[e+52>>2])*-(C*E-B*z)+($*T+_*U+Z*V+ +g[e+56>>2])*-(B*D-A*E);F=f+4|0;M=c[F>>2]|0;if((M|0)>=2){L=f+12|0;W=c[L>>2]|0;aa=+g[W+(M+ -1<<4)>>2];ba=+g[W+(M+ -1<<4)+4>>2];Z=+g[W+(M+ -1<<4)+8>>2];J=y+4|0;H=y+8|0;K=y+12|0;I=y+16|0;T=aa;U=ba;V=Z;Z=aa*-(A*z-C*D)+ba*-(C*E-B*z)+Z*-(B*D-A*E)-G;R=0;while(1){O=+g[W+(R<<4)>>2];P=+g[W+(R<<4)+4>>2];Q=+g[W+(R<<4)+8>>2];S=+g[W+(R<<4)+12>>2];N=O*-(A*z-C*D)+P*-(C*E-B*z)+Q*-(B*D-A*E)-G;do if(Z<0.0)if(N<0.0){X=c[J>>2]|0;if((X|0)==(c[H>>2]|0)?(r=(X|0)==0?1:X<<1,(X|0)<(r|0)):0){if(!r)W=0;else{c[5004]=(c[5004]|0)+1;W=fF((r<<4|3)+16|0)|0;if(!W)W=0;else{c[(W+19&-16)+ -4>>2]=W;W=W+19&-16}X=c[J>>2]|0}if((X|0)>0){Y=0;do{ca=W+(Y<<4)|0;da=(c[K>>2]|0)+(Y<<4)|0;c[ca+0>>2]=c[da+0>>2];c[ca+4>>2]=c[da+4>>2];c[ca+8>>2]=c[da+8>>2];c[ca+12>>2]=c[da+12>>2];Y=Y+1|0}while((Y|0)!=(X|0))}X=c[K>>2]|0;if(X){if(a[I>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[X+ -4>>2]|0)}c[K>>2]=0}a[I>>0]=1;c[K>>2]=W;c[H>>2]=r;X=c[J>>2]|0}da=c[K>>2]|0;g[da+(X<<4)>>2]=O;g[da+(X<<4)+4>>2]=P;g[da+(X<<4)+8>>2]=Q;g[da+(X<<4)+12>>2]=S;c[J>>2]=(c[J>>2]|0)+1;break}else{ba=Z/(Z-N);S=T+(O-T)*ba;T=U+(P-U)*ba;U=V+(Q-V)*ba;Y=c[J>>2]|0;if((Y|0)==(c[H>>2]|0)?(p=(Y|0)==0?1:Y<<1,(Y|0)<(p|0)):0){if(!p)W=0;else{c[5004]=(c[5004]|0)+1;W=fF((p<<4|3)+16|0)|0;if(!W)W=0;else{c[(W+19&-16)+ -4>>2]=W;W=W+19&-16}Y=c[J>>2]|0}if((Y|0)>0){X=0;do{da=W+(X<<4)|0;ca=(c[K>>2]|0)+(X<<4)|0;c[da+0>>2]=c[ca+0>>2];c[da+4>>2]=c[ca+4>>2];c[da+8>>2]=c[ca+8>>2];c[da+12>>2]=c[ca+12>>2];X=X+1|0}while((X|0)!=(Y|0))}X=c[K>>2]|0;if(X){if(a[I>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[X+ -4>>2]|0)}c[K>>2]=0}a[I>>0]=1;c[K>>2]=W;c[H>>2]=p;Y=c[J>>2]|0}da=c[K>>2]|0;g[da+(Y<<4)>>2]=S;g[da+(Y<<4)+4>>2]=T;g[da+(Y<<4)+8>>2]=U;g[da+(Y<<4)+12>>2]=0.0;c[J>>2]=(c[J>>2]|0)+1;break}else if(N<0.0){ba=Z/(Z-N);T=T+(O-T)*ba;U=U+(P-U)*ba;V=V+(Q-V)*ba;X=c[J>>2]|0;if((X|0)==(c[H>>2]|0)?(o=(X|0)==0?1:X<<1,(X|0)<(o|0)):0){if(!o)W=0;else{c[5004]=(c[5004]|0)+1;W=fF((o<<4|3)+16|0)|0;if(!W)W=0;else{c[(W+19&-16)+ -4>>2]=W;W=W+19&-16}X=c[J>>2]|0}if((X|0)>0){Y=0;do{da=W+(Y<<4)|0;ca=(c[K>>2]|0)+(Y<<4)|0;c[da+0>>2]=c[ca+0>>2];c[da+4>>2]=c[ca+4>>2];c[da+8>>2]=c[ca+8>>2];c[da+12>>2]=c[ca+12>>2];Y=Y+1|0}while((Y|0)!=(X|0))}X=c[K>>2]|0;if(X){if(a[I>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[X+ -4>>2]|0)}c[K>>2]=0}a[I>>0]=1;c[K>>2]=W;c[H>>2]=o;X=c[J>>2]|0}da=c[K>>2]|0;g[da+(X<<4)>>2]=T;g[da+(X<<4)+4>>2]=U;g[da+(X<<4)+8>>2]=V;g[da+(X<<4)+12>>2]=0.0;X=(c[J>>2]|0)+1|0;c[J>>2]=X;if((X|0)==(c[H>>2]|0)?(q=(X|0)==0?1:X<<1,(X|0)<(q|0)):0){if(!q)W=0;else{c[5004]=(c[5004]|0)+1;W=fF((q<<4|3)+16|0)|0;if(!W)W=0;else{c[(W+19&-16)+ -4>>2]=W;W=W+19&-16}X=c[J>>2]|0}if((X|0)>0){Y=0;do{da=W+(Y<<4)|0;ca=(c[K>>2]|0)+(Y<<4)|0;c[da+0>>2]=c[ca+0>>2];c[da+4>>2]=c[ca+4>>2];c[da+8>>2]=c[ca+8>>2];c[da+12>>2]=c[ca+12>>2];Y=Y+1|0}while((Y|0)!=(X|0))}X=c[K>>2]|0;if(X){if(a[I>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[X+ -4>>2]|0)}c[K>>2]=0}a[I>>0]=1;c[K>>2]=W;c[H>>2]=q;X=c[J>>2]|0}da=c[K>>2]|0;g[da+(X<<4)>>2]=O;g[da+(X<<4)+4>>2]=P;g[da+(X<<4)+8>>2]=Q;g[da+(X<<4)+12>>2]=S;c[J>>2]=(c[J>>2]|0)+1}while(0);R=R+1|0;if((R|0)==(M|0))break;W=c[L>>2]|0;T=O;U=P;V=Q;Z=N}M=c[F>>2]|0}if((M|0)<0){K=f+8|0;H=f+12|0;if((c[K>>2]|0)<0){I=c[H>>2]|0;J=f+16|0;if(I){if(a[J>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[I+ -4>>2]|0)}c[H>>2]=0}a[J>>0]=1;c[H>>2]=0;c[K>>2]=0}do{da=(c[H>>2]|0)+(M<<4)|0;c[da+0>>2]=c[l+16>>2];c[da+4>>2]=c[l+20>>2];c[da+8>>2]=c[l+24>>2];c[da+12>>2]=c[l+28>>2];M=M+1|0}while((M|0)!=0)}c[F>>2]=0;G=+g[e>>2];N=+g[e+4>>2];O=+g[e+8>>2];E=+g[e+16>>2];D=+g[e+20>>2];C=+g[e+24>>2];B=+g[e+32>>2];A=+g[e+36>>2];z=+g[e+40>>2];if((x|0)>=(v|0)){f=y;o=e+48|0;d=e+52|0;e=e+56|0;break}else{da=y;P=E;Q=D;S=C;T=B;U=A;V=z;y=f;f=da}}}else{u=n+(m*36|0)+24|0;t=n+(m*36|0)+28|0;o=e+48|0;d=e+52|0;e=e+56|0;s=n+(m*36|0)+20|0}$=+g[s>>2];aa=+g[u>>2];ba=+g[t>>2];G=$*G+aa*N+ba*O;C=$*E+aa*D+ba*C;z=$*B+aa*A+ba*z;A=+g[n+(m*36|0)+32>>2]-(G*+g[o>>2]+C*+g[d>>2]+z*+g[e>>2]);m=f+4|0;d=c[m>>2]|0;if((d|0)>0){n=f+12|0;e=0;do{da=c[n>>2]|0;o=da+(e<<4)|0;B=A+(G*+g[o>>2]+C*+g[da+(e<<4)+4>>2]+z*+g[da+(e<<4)+8>>2]);B=!(B<=h)?B:h;if(B<=j){c[l+0>>2]=c[o+0>>2];c[l+4>>2]=c[o+4>>2];c[l+8>>2]=c[o+8>>2];c[l+12>>2]=c[o+12>>2];qc[c[(c[k>>2]|0)+16>>2]&15](k,b,l,B);d=c[m>>2]|0}e=e+1|0}while((e|0)<(d|0))}u=c[l+44>>2]|0}}if(!u){i=l;return}if(a[l+48>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[u+ -4>>2]|0)}c[l+44>>2]=0;i=l;return}function dE(a,b,f,j){a=a|0;b=b|0;f=f|0;j=j|0;var k=0.0,l=0.0,m=0.0,n=0,o=0,p=0.0,q=0.0,r=0,s=0,t=0,u=0,v=0;n=i;i=i+80|0;f=Pb[c[(c[a>>2]|0)+28>>2]&127](a)|0;m=+g[a+4>>2];k=+g[a+8>>2];l=+g[a+12>>2];if((f|0)<=0){i=n;return}j=0;do{fc[c[(c[a>>2]|0)+16>>2]&3](a,n+76|0,n+52|0,n+64|0,n+56|0,n+72|0,n+68|0,n+48|0,n+60|0,j);o=c[n+64>>2]|0;do if(!o){o=c[n+60>>2]|0;if((o|0)==5){if((c[n+48>>2]|0)>0)o=0;else break;do{u=c[n+72>>2]|0;t=aa(c[n+68>>2]|0,o)|0;s=c[n+76>>2]|0;r=c[n+56>>2]|0;v=aa(d[u+t>>0]|0,r)|0;q=k*+g[s+(v+4)>>2];p=l*+g[s+(v+8)>>2];g[n>>2]=m*+g[s+v>>2];g[n+4>>2]=q;g[n+8>>2]=p;g[n+12>>2]=0.0;v=aa(d[u+(t+1)>>0]|0,r)|0;p=k*+g[s+(v+4)>>2];q=l*+g[s+(v+8)>>2];g[n+16>>2]=m*+g[s+v>>2];g[n+20>>2]=p;g[n+24>>2]=q;g[n+28>>2]=0.0;r=aa(d[u+(t+2)>>0]|0,r)|0;q=k*+g[s+(r+4)>>2];p=l*+g[s+(r+8)>>2];g[n+32>>2]=m*+g[s+r>>2];g[n+36>>2]=q;g[n+40>>2]=p;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else if((o|0)==2){if((c[n+48>>2]|0)>0)o=0;else break;do{t=c[n+72>>2]|0;v=aa(c[n+68>>2]|0,o)|0;u=c[n+76>>2]|0;s=c[n+56>>2]|0;r=aa(s,c[t+v>>2]|0)|0;p=k*+g[u+(r+4)>>2];q=l*+g[u+(r+8)>>2];g[n>>2]=m*+g[u+r>>2];g[n+4>>2]=p;g[n+8>>2]=q;g[n+12>>2]=0.0;r=aa(s,c[t+(v+4)>>2]|0)|0;q=k*+g[u+(r+4)>>2];p=l*+g[u+(r+8)>>2];g[n+16>>2]=m*+g[u+r>>2];g[n+20>>2]=q;g[n+24>>2]=p;g[n+28>>2]=0.0;v=aa(s,c[t+(v+8)>>2]|0)|0;p=k*+g[u+(v+4)>>2];q=l*+g[u+(v+8)>>2];g[n+32>>2]=m*+g[u+v>>2];g[n+36>>2]=p;g[n+40>>2]=q;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else if((o|0)==3){if((c[n+48>>2]|0)>0)o=0;else break;do{s=c[n+72>>2]|0;t=aa(c[n+68>>2]|0,o)|0;u=c[n+76>>2]|0;v=c[n+56>>2]|0;r=aa(e[s+t>>1]|0,v)|0;p=k*+g[u+(r+4)>>2];q=l*+g[u+(r+8)>>2];g[n>>2]=m*+g[u+r>>2];g[n+4>>2]=p;g[n+8>>2]=q;g[n+12>>2]=0.0;r=aa(e[s+(t+2)>>1]|0,v)|0;q=k*+g[u+(r+4)>>2];p=l*+g[u+(r+8)>>2];g[n+16>>2]=m*+g[u+r>>2];g[n+20>>2]=q;g[n+24>>2]=p;g[n+28>>2]=0.0;v=aa(e[s+(t+4)>>1]|0,v)|0;p=k*+g[u+(v+4)>>2];q=l*+g[u+(v+8)>>2];g[n+32>>2]=m*+g[u+v>>2];g[n+36>>2]=p;g[n+40>>2]=q;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else break}else if((o|0)==1){o=c[n+60>>2]|0;if((o|0)==3){if((c[n+48>>2]|0)>0)o=0;else break;do{s=c[n+72>>2]|0;t=aa(c[n+68>>2]|0,o)|0;u=c[n+76>>2]|0;v=c[n+56>>2]|0;r=aa(e[s+t>>1]|0,v)|0;p=k*+h[u+(r+8)>>3];q=l*+h[u+(r+16)>>3];g[n>>2]=m*+h[u+r>>3];g[n+4>>2]=p;g[n+8>>2]=q;g[n+12>>2]=0.0;r=aa(e[s+(t+2)>>1]|0,v)|0;q=k*+h[u+(r+8)>>3];p=l*+h[u+(r+16)>>3];g[n+16>>2]=m*+h[u+r>>3];g[n+20>>2]=q;g[n+24>>2]=p;g[n+28>>2]=0.0;v=aa(e[s+(t+4)>>1]|0,v)|0;p=k*+h[u+(v+8)>>3];q=l*+h[u+(v+16)>>3];g[n+32>>2]=m*+h[u+v>>3];g[n+36>>2]=p;g[n+40>>2]=q;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else if((o|0)==2){if((c[n+48>>2]|0)>0)o=0;else break;do{t=c[n+72>>2]|0;v=aa(c[n+68>>2]|0,o)|0;u=c[n+76>>2]|0;s=c[n+56>>2]|0;r=aa(s,c[t+v>>2]|0)|0;p=k*+h[u+(r+8)>>3];q=l*+h[u+(r+16)>>3];g[n>>2]=m*+h[u+r>>3];g[n+4>>2]=p;g[n+8>>2]=q;g[n+12>>2]=0.0;r=aa(s,c[t+(v+4)>>2]|0)|0;q=k*+h[u+(r+8)>>3];p=l*+h[u+(r+16)>>3];g[n+16>>2]=m*+h[u+r>>3];g[n+20>>2]=q;g[n+24>>2]=p;g[n+28>>2]=0.0;v=aa(s,c[t+(v+8)>>2]|0)|0;p=k*+h[u+(v+8)>>3];q=l*+h[u+(v+16)>>3];g[n+32>>2]=m*+h[u+v>>3];g[n+36>>2]=p;g[n+40>>2]=q;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else if((o|0)==5){if((c[n+48>>2]|0)>0)o=0;else break;do{s=c[n+72>>2]|0;t=aa(c[n+68>>2]|0,o)|0;u=c[n+76>>2]|0;v=c[n+56>>2]|0;r=aa(d[s+t>>0]|0,v)|0;p=k*+h[u+(r+8)>>3];q=l*+h[u+(r+16)>>3];g[n>>2]=m*+h[u+r>>3];g[n+4>>2]=p;g[n+8>>2]=q;g[n+12>>2]=0.0;r=aa(d[s+(t+1)>>0]|0,v)|0;q=k*+h[u+(r+8)>>3];p=l*+h[u+(r+16)>>3];g[n+16>>2]=m*+h[u+r>>3];g[n+20>>2]=q;g[n+24>>2]=p;g[n+28>>2]=0.0;v=aa(d[s+(t+2)>>0]|0,v)|0;p=k*+h[u+(v+8)>>3];q=l*+h[u+(v+16)>>3];g[n+32>>2]=m*+h[u+v>>3];g[n+36>>2]=p;g[n+40>>2]=q;g[n+44>>2]=0.0;vc[c[(c[b>>2]|0)+8>>2]&127](b,n,j,o);o=o+1|0}while((o|0)<(c[n+48>>2]|0))}else break}while(0);Nb[c[(c[a>>2]|0)+24>>2]&127](a,j);j=j+1|0}while((j|0)!=(f|0));i=n;return}function eE(d,e,f){d=d|0;e=e|0;f=f|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0.0,y=0;j=i;i=i+32|0;m=Pb[c[(c[d>>2]|0)+28>>2]&127](d)|0;c[e+20>>2]=m;c[e>>2]=0;if(!m){w=e+4|0;v=d+4|0;x=+g[v>>2];g[w>>2]=x;w=d+8|0;x=+g[w>>2];w=e+8|0;g[w>>2]=x;w=d+12|0;x=+g[w>>2];w=e+12|0;g[w>>2]=x;w=d+16|0;x=+g[w>>2];w=e+16|0;g[w>>2]=x;i=j;return 19824}m=Yb[c[(c[f>>2]|0)+16>>2]&31](f,32,m)|0;p=c[m+8>>2]|0;c[e>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,p)|0;n=Pb[c[(c[d>>2]|0)+28>>2]&127](d)|0;if((n|0)>0){o=0;while(1){fc[c[(c[d>>2]|0)+16>>2]&3](d,j+28|0,j+4|0,j+16|0,j+8|0,j+24|0,j+20|0,j,j+12|0,o);c[p+24>>2]=c[j>>2];c[p+28>>2]=c[j+4>>2];s=p+8|0;t=p+12|0;r=p+16|0;q=p+4|0;c[p+0>>2]=0;c[p+4>>2]=0;c[p+8>>2]=0;c[p+12>>2]=0;c[p+16>>2]=0;c[p+20>>2]=0;u=c[j+12>>2]|0;if((u|0)==2){r=c[j>>2]|0;if(r){r=Yb[c[(c[f>>2]|0)+16>>2]&31](f,4,r*3|0)|0;t=c[r+8>>2]|0;c[s>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,t)|0;if((c[j>>2]|0)>0){u=c[j+24>>2]|0;s=0;do{v=aa(c[j+20>>2]|0,s)|0;w=s*3|0;c[t+(w<<2)>>2]=c[u+v>>2];c[t+(w+1<<2)>>2]=c[u+(v+4)>>2];c[t+(w+2<<2)>>2]=c[u+(v+8)>>2];s=s+1|0}while((s|0)<(c[j>>2]|0))}Jb[c[(c[f>>2]|0)+20>>2]&31](f,r,19688,1497453121,c[r+8>>2]|0)}}else if((u|0)==5){s=c[j>>2]|0;if(s){t=Yb[c[(c[f>>2]|0)+16>>2]&31](f,4,s)|0;s=c[t+8>>2]|0;c[r>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,s)|0;if((c[j>>2]|0)>0){r=0;do{v=c[j+24>>2]|0;w=aa(c[j+20>>2]|0,r)|0;a[s+(r<<2)>>0]=a[v+w>>0]|0;a[s+(r<<2)+1>>0]=a[v+(w+1)>>0]|0;a[s+(r<<2)+2>>0]=a[v+(w+2)>>0]|0;r=r+1|0}while((r|0)<(c[j>>2]|0))}Jb[c[(c[f>>2]|0)+20>>2]&31](f,t,19736,1497453121,c[t+8>>2]|0)}}else if((u|0)==3?(k=c[j>>2]|0,(k|0)!=0):0){s=Yb[c[(c[f>>2]|0)+16>>2]&31](f,8,k)|0;r=c[s+8>>2]|0;c[t>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,r)|0;t=c[j>>2]|0;if((t|0)>0){v=c[j+24>>2]|0;u=c[j+20>>2]|0;w=0;do{y=aa(u,w)|0;b[r+(w<<3)>>1]=b[v+y>>1]|0;b[r+(w<<3)+2>>1]=b[v+(y+2)>>1]|0;b[r+(w<<3)+4>>1]=b[v+(y+4)>>1]|0;w=w+1|0}while((w|0)<(t|0))}Jb[c[(c[f>>2]|0)+20>>2]&31](f,s,19704,1497453121,c[s+8>>2]|0)}r=c[j+16>>2]|0;if(!r){q=c[j+4>>2]|0;if(q){u=Yb[c[(c[f>>2]|0)+16>>2]&31](f,16,q)|0;t=c[u+8>>2]|0;c[p>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,t)|0;s=c[j+4>>2]|0;if((s|0)>0){q=c[j+28>>2]|0;r=c[j+8>>2]|0;v=0;do{y=aa(r,v)|0;g[t+(v<<4)>>2]=+g[q+y>>2];g[t+(v<<4)+4>>2]=+g[q+(y+4)>>2];g[t+(v<<4)+8>>2]=+g[q+(y+8)>>2];v=v+1|0}while((v|0)<(s|0))}Jb[c[(c[f>>2]|0)+20>>2]&31](f,u,19760,1497453121,c[u+8>>2]|0)}}else if((r|0)==1?(l=c[j+4>>2]|0,(l|0)!=0):0){r=Yb[c[(c[f>>2]|0)+16>>2]&31](f,32,l)|0;s=c[r+8>>2]|0;c[q>>2]=gc[c[(c[f>>2]|0)+28>>2]&31](f,s)|0;t=c[j+4>>2]|0;if((t|0)>0){q=c[j+28>>2]|0;u=c[j+8>>2]|0;v=0;do{y=aa(u,v)|0;h[s+(v<<5)>>3]=+h[q+y>>3];h[s+(v<<5)+8>>3]=+h[q+(y+8)>>3];h[s+(v<<5)+16>>3]=+h[q+(y+16)>>3];v=v+1|0}while((v|0)<(t|0))}Jb[c[(c[f>>2]|0)+20>>2]&31](f,r,19784,1497453121,c[r+8>>2]|0)}Nb[c[(c[d>>2]|0)+24>>2]&127](d,o);o=o+1|0;if((o|0)==(n|0)){k=f;break}else p=p+32|0}}else k=f;Jb[c[(c[k>>2]|0)+20>>2]&31](f,m,19808,1497453121,c[m+8>>2]|0);y=e+4|0;w=d+4|0;x=+g[w>>2];g[y>>2]=x;y=d+8|0;x=+g[y>>2];y=e+8|0;g[y>>2]=x;y=d+12|0;x=+g[y>>2];y=e+12|0;g[y>>2]=x;y=d+16|0;x=+g[y>>2];y=e+16|0;g[y>>2]=x;i=j;return 19824}function fE(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=19904;e=c[b+32>>2]|0;if(!e){a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0}else{if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0}c[5006]=(c[5006]|0)+1;gF(c[b+ -4>>2]|0);i=d;return}function gE(b){b=b|0;var d=0,e=0;d=i;c[b>>2]=19904;e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;i=d;return}function hE(a,b,d,e,f,g,h,i,j,k){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;k=k|0;a=c[a+32>>2]|0;c[d>>2]=c[a+(k<<5)+12>>2];c[b>>2]=c[a+(k<<5)+16>>2];c[e>>2]=c[a+(k<<5)+28>>2];c[f>>2]=c[a+(k<<5)+20>>2];c[i>>2]=c[a+(k<<5)>>2];c[g>>2]=c[a+(k<<5)+4>>2];c[h>>2]=c[a+(k<<5)+8>>2];c[j>>2]=c[a+(k<<5)+24>>2];return}function iE(a,b,d,e,f,g,h,i,j,k){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;k=k|0;a=c[a+32>>2]|0;c[d>>2]=c[a+(k<<5)+12>>2];c[b>>2]=c[a+(k<<5)+16>>2];c[e>>2]=c[a+(k<<5)+28>>2];c[f>>2]=c[a+(k<<5)+20>>2];c[i>>2]=c[a+(k<<5)>>2];c[g>>2]=c[a+(k<<5)+4>>2];c[h>>2]=c[a+(k<<5)+8>>2];c[j>>2]=c[a+(k<<5)+24>>2];return}function jE(a){a=a|0;return(c[a+48>>2]|0)==1|0}function kE(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;c[a+52>>2]=c[b+0>>2];c[a+56>>2]=c[b+4>>2];c[a+60>>2]=c[b+8>>2];c[a+64>>2]=c[b+12>>2];c[a+68>>2]=c[d+0>>2];c[a+72>>2]=c[d+4>>2];c[a+76>>2]=c[d+8>>2];c[a+80>>2]=c[d+12>>2];c[a+48>>2]=1;i=e;return}function lE(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;c[b+0>>2]=c[a+52>>2];c[b+4>>2]=c[a+56>>2];c[b+8>>2]=c[a+60>>2];c[b+12>>2]=c[a+64>>2];c[d+0>>2]=c[a+68>>2];c[d+4>>2]=c[a+72>>2];c[d+8>>2]=c[a+76>>2];c[d+12>>2]=c[a+80>>2];i=e;return}function mE(a,b){a=a|0;b=b|0;return}function nE(a,b){a=a|0;b=b|0;return}function oE(a,b,d,e,f,g){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;h=i;j=c[g+16>>2]|0;if((j|0)!=(f|0)){l=f-j|0;i=h;return l|0}if(!f){l=0;i=h;return l|0}l=c[g+8>>2]|0;n=c[g+12>>2]|0;k=xF(l|0,0,a|0,0)|0;j=E;p=xF(n|0,0,a|0,0)|0;m=E;l=xF(l|0,0,b|0,0)|0;a=E;n=xF(n|0,0,b|0,0)|0;o=E;b=lF(p|0,0,l|0,0)|0;l=E;o=lF(m|0,0,n|0,o|0)|0;a=lF(o|0,E|0,a|0,0)|0;l=lF(a|0,E|0,l|0,0)|0;a=E;j=lF(0,b|0,k|0,j|0)|0;k=E;b=lF(l|0,a|0,(k>>>0<b>>>0|(k|0)==(b|0)&j>>>0<0)&1|0,0)|0;a=E;l=c[g>>2]|0;o=c[g+4>>2]|0;n=xF(l|0,0,d|0,0)|0;g=E;m=xF(o|0,0,d|0,0)|0;p=E;l=xF(l|0,0,e|0,0)|0;d=E;o=xF(o|0,0,e|0,0)|0;e=E;l=lF(m|0,0,l|0,0)|0;m=E;e=lF(p|0,0,o|0,e|0)|0;e=lF(e|0,E|0,d|0,0)|0;m=lF(e|0,E|0,m|0,0)|0;e=E;g=lF(0,l|0,n|0,g|0)|0;d=E;l=lF(m|0,e|0,(d>>>0<l>>>0|(d|0)==(l|0)&g>>>0<0)&1|0,0)|0;e=E;if(!(a>>>0<e>>>0|(a|0)==(e|0)&b>>>0<l>>>0))if(!(a>>>0>e>>>0|(a|0)==(e|0)&b>>>0>l>>>0))if(k>>>0<d>>>0|(k|0)==(d|0)&j>>>0<g>>>0)a=-1;else a=(k>>>0>d>>>0|(k|0)==(d|0)&j>>>0>g>>>0)&1;else a=1;else a=-1;p=aa(a,f)|0;i=h;return p|0}function pE(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0;b=i;e=c[a+8>>2]|0;if(!e){g=c[a+4>>2]|0;if(!g){c[5004]=(c[5004]|0)+1;e=fF(31)|0;if((e|0)!=0?(d=e+19&-16,c[d+ -4>>2]=e,(e+19&-16|0)!=0):0){g=c[a+12>>2]|0;c[d+4>>2]=g;c[d+8>>2]=0;c[5004]=(c[5004]|0)+1;d=fF((g*24|3)+16|0)|0;if(!d)d=0;else{c[(d+19&-16)+ -4>>2]=d;d=d+19&-16}c[(e+19&-16)>>2]=d;g=e+19&-16}else g=0;c[g+8>>2]=c[a>>2];c[a>>2]=g}else c[a+4>>2]=c[g+8>>2];f=c[g+4>>2]|0;if((f|0)>0){d=0;e=c[g>>2]|0;do{d=d+1|0;h=e;e=e+24|0;c[h>>2]=(d|0)<(f|0)?e:0}while((d|0)!=(f|0))}e=c[g>>2]|0;c[a+8>>2]=c[e>>2];if(!e){h=0;i=b;return h|0}}else c[a+8>>2]=c[e>>2];c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;c[e+16>>2]=0;c[e+20>>2]=0;h=e;i=b;return h|0}function qE(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,F=0,G=0,H=0,I=0,J=0;f=i;i=i+144|0;do if((d-b|0)==1)g=c[(c[a+92>>2]|0)+(b<<2)>>2]|0;else if((d-b|0)==2){g=c[(c[a+92>>2]|0)+(b<<2)>>2]|0;h=c[g+88>>2]|0;d=c[g+200>>2]|0;b=c[g+92>>2]|0;k=c[g+204>>2]|0;if((h|0)==(d|0)){if((b|0)==(k|0))if((c[g+96>>2]|0)==(c[g+208>>2]|0))break;else j=b;else j=k;if((b|0)==(j|0)){J=(c[g+96>>2]|0)>(c[g+208>>2]|0);h=J?g+112|0:g;c[h>>2]=h;c[h+4>>2]=h;c[e>>2]=h;c[e+4>>2]=h;c[e+8>>2]=h;c[e+12>>2]=h;g=J?g:g+112|0}else{k=0;s=9}}else{j=k;k=(b|0)==(k|0);s=9}do if((s|0)==9){b=b-j|0;c[g>>2]=g+112;c[g+4>>2]=g+112;c[g+112>>2]=g;c[g+116>>2]=g;if((h-d|0)>=0?!((h|0)==(d|0)&(b|0)<0):0){c[e>>2]=g+112;c[e+4>>2]=g}else{c[e>>2]=g;c[e+4>>2]=g+112}if((b|0)<0|k&(h-d|0)<0){c[e+8>>2]=g;c[e+12>>2]=g+112;h=g;g=g+112|0;break}else{c[e+8>>2]=g+112;c[e+12>>2]=g;h=g;g=g+112|0;break}}while(0);b=pE(a+48|0)|0;d=pE(a+48|0)|0;c[b+8>>2]=d;c[d+8>>2]=b;c[b+20>>2]=c[a+100>>2];c[d+20>>2]=c[a+100>>2];c[b+12>>2]=g;c[d+12>>2]=h;c[b+16>>2]=0;c[d+16>>2]=0;d=c[a+116>>2]|0;c[a+116>>2]=d+1;if((d|0)>=(c[a+120>>2]|0))c[a+120>>2]=d+1;c[b>>2]=b;c[b+4>>2]=b;c[h+8>>2]=b;J=c[b+8>>2]|0;c[J>>2]=J;c[J+4>>2]=J;c[g+8>>2]=J;i=f;return}else if(!(d-b|0)){c[e+0>>2]=0;c[e+4>>2]=0;c[e+8>>2]=0;c[e+12>>2]=0;i=f;return}else{r=((d-b|0)/2|0)+b|0;u=c[a+92>>2]|0;v=c[u+(r+ -1<<2)>>2]|0;y=c[v+88>>2]|0;x=c[v+92>>2]|0;v=c[v+96>>2]|0;a:do if((r|0)<(d|0)){w=r;while(1){z=c[u+(w<<2)>>2]|0;if((c[z+88>>2]|0)!=(y|0)){t=w;break a}if((c[z+92>>2]|0)!=(x|0)){t=w;break a}t=w+1|0;if((c[z+96>>2]|0)!=(v|0)){t=w;break a}if((t|0)<(d|0))w=t;else break}}else t=r;while(0);qE(a,b,r,e);c[f+96>>2]=0;c[f+100>>2]=0;c[f+104>>2]=0;c[f+108>>2]=0;qE(a,t,d,f+96|0);r=f+100|0;v=c[r>>2]|0;if(!v){i=f;return}if(!(c[e+4>>2]|0)){c[e+0>>2]=c[f+96>>2];c[e+4>>2]=c[f+100>>2];c[e+8>>2]=c[f+104>>2];c[e+12>>2]=c[f+108>>2];i=f;return}c[a+100>>2]=(c[a+100>>2]|0)+ -1;b=c[e+12>>2]|0;d=c[f+104>>2]|0;u=c[b+88>>2]|0;b:do if((u|0)==(c[d+88>>2]|0)?(c[b+92>>2]|0)==(c[d+92>>2]|0):0){t=c[d+4>>2]|0;if((t|0)==(d|0)){e=c[d+8>>2]|0;if(e){d=c[e+12>>2]|0;u=c[d+88>>2]|0}w=c[d+96>>2]|0;t=u+1|0;break}b=c[d>>2]|0;c[t>>2]=b;c[b+4>>2]=t;c:do if((d|0)==(c[f+96>>2]|0)){s=c[b+88>>2]|0;u=c[t+88>>2]|0;do if((s|0)>=(u|0)){if((s|0)==(u|0)?(c[b+92>>2]|0)<(c[t+92>>2]|0):0)break;c[f+96>>2]=t;break c}while(0);c[f+96>>2]=b}while(0);v=c[r>>2]|0;if((d|0)==(v|0)){d=c[b+88>>2]|0;s=c[t+88>>2]|0;do if((d|0)<=(s|0)){if((d|0)==(s|0)?(c[b+92>>2]|0)>(c[t+92>>2]|0):0)break;c[r>>2]=t;v=t;s=45;break b}while(0);c[r>>2]=b;v=b;s=45}else s=45}else s=45;while(0);if((s|0)==45){s=c[f+96>>2]|0;u=0;t=1;w=e+4|0;b=0;d=0;d:while(1){z=c[w>>2]|0;while(1){w=c[z+88>>2]|0;y=aa((c[v+88>>2]|0)-w|0,t)|0;e:do if((y|0)<=0){if((y|0)>=0){A=c[z+92>>2]|0;x=(u|0)!=0;f:do if(x){y=z;while(1){B=c[y>>2]|0;if((B|0)==(z|0)){z=y;break f}if((c[B+88>>2]|0)!=(w|0)){z=y;break f}J=A;A=c[B+92>>2]|0;if((A|0)>(J|0)){z=y;break}else y=B}}else{y=z;while(1){B=c[y+4>>2]|0;if((B|0)==(z|0)){z=y;break f}if((c[B+88>>2]|0)!=(w|0)){z=y;break f}J=A;A=c[B+92>>2]|0;if((A|0)>(J|0)){z=y;break}else y=B}}while(0);y=c[v+92>>2]|0;if(x){x=v;while(1){A=c[x+4>>2]|0;if((A|0)==(v|0))break e;if((c[A+88>>2]|0)!=(w|0))break e;J=y;y=c[A+92>>2]|0;if((y|0)<(J|0))break e;else x=A}}else{x=v;while(1){A=c[x>>2]|0;if((A|0)==(v|0))break e;if((c[A+88>>2]|0)!=(w|0))break e;J=y;y=c[A+92>>2]|0;if((y|0)<(J|0))break e;else x=A}}}w=c[v+92>>2]|0;C=c[z+92>>2]|0;if(!u)while(1){B=c[v>>2]|0;x=(B|0)==(v|0);A=v+88|0;while(1){G=z+88|0;D=w-C|0;if(!x?(p=c[B+88>>2]|0,n=aa(p-(c[A>>2]|0)|0,t)|0,o=c[B+92>>2]|0,j=o-w|0,(j|0)>-1):0){if(!n)break;if((n|0)<0?(aa(j,y)|0)<=(aa(n,D)|0):0)break}F=c[z>>2]|0;if((F|0)==(z|0)){x=v;break e}J=c[F+88>>2]|0;H=aa(J-(c[G>>2]|0)|0,t)|0;G=c[F+92>>2]|0;I=G-C|0;C=y;y=aa((c[A>>2]|0)-J|0,t)|0;if(!((y|0)<0&(I|0)>0)){x=v;break e}if(!H){C=G;z=F;continue}if((H|0)>=0){x=v;break e}if((aa(I,C)|0)>=(aa(H,D)|0)){x=v;break e}else{C=G;z=F}}w=o;y=aa(p-(c[G>>2]|0)|0,t)|0;v=B}else while(1){x=c[v+4>>2]|0;B=(x|0)==(v|0);A=v+88|0;while(1){G=z+88|0;D=w-C|0;if(!B?(m=c[x+88>>2]|0,q=aa(m-(c[A>>2]|0)|0,t)|0,l=c[x+92>>2]|0,k=l-w|0,(k|0)>-1):0){if(!q)break;if((q|0)<0?(aa(k,y)|0)<=(aa(q,D)|0):0)break}F=c[z+4>>2]|0;if((F|0)==(z|0)){x=v;break e}J=c[F+88>>2]|0;G=aa(J-(c[G>>2]|0)|0,t)|0;H=c[F+92>>2]|0;C=H-C|0;I=y;y=aa((c[A>>2]|0)-J|0,t)|0;if(!((y|0)<0&(C|0)>0)){x=v;break e}if(!G){C=H;z=F;continue}if((G|0)>=0){x=v;break e}if((aa(C,I)|0)>=(aa(G,D)|0)){x=v;break e}else{C=H;z=F}}w=l;y=aa(m-(c[G>>2]|0)|0,t)|0;v=x}}else{w=(u|0)!=0;x=c[v+92>>2]|0;C=z;while(1){z=v+88|0;D=C+88|0;B=c[C+92>>2]|0;G=x-B|0;A=c[(w?C:C+4|0)>>2]|0;g:do if((A|0)==(C|0)){B=D;D=G;F=y;A=C}else{F=y;while(1){J=c[A+88>>2]|0;I=aa(J-(c[D>>2]|0)|0,t)|0;H=B;B=c[A+92>>2]|0;H=B-H|0;if((H|0)>=1){B=D;D=G;A=C;break g}if(I){if((I|0)>=0){B=D;D=G;A=C;break g}if((aa(H,F)|0)>(aa(I,G)|0)){B=D;D=G;A=C;break g}}F=aa((c[z>>2]|0)-J|0,t)|0;D=A+88|0;G=x-B|0;C=c[(w?A:A+4|0)>>2]|0;if((C|0)==(A|0)){B=D;D=G;break}else{J=A;A=C;C=J}}}while(0);G=c[(w?v:v+4|0)>>2]|0;if((G|0)==(v|0)){z=A;x=v;break e}y=c[G+88>>2]|0;C=aa(y-(c[z>>2]|0)|0,t)|0;z=x;x=c[G+92>>2]|0;z=x-z|0;y=aa(y-(c[B>>2]|0)|0,t)|0;if(!((y|0)>0&(z|0)<0)){z=A;x=v;break e}if(!C){C=A;v=G;continue}if((C|0)>=0){z=A;x=v;break e}if((aa(z,F)|0)>=(aa(C,D)|0)){z=A;x=v;break}else{C=A;v=G}}}while(0);if(!u){u=1;t=-1;w=e;b=z;v=s;d=x;continue d}u=u+1|0;if((u|0)==2)break d;else v=x}}c[z+4>>2]=x;c[x>>2]=z;c[b>>2]=d;c[d+4>>2]=b;j=c[f+96>>2]|0;if((c[j+88>>2]|0)<(c[(c[e>>2]|0)+88>>2]|0))c[e>>2]=j;j=c[r>>2]|0;if((c[j+88>>2]|0)>=(c[(c[e+4>>2]|0)+88>>2]|0))c[e+4>>2]=j;c[e+12>>2]=c[f+108>>2];k=c[d+88>>2]|0;y=c[b+88>>2]|0;l=c[d+92>>2]|0;e=c[b+92>>2]|0;o=c[d+96>>2]|0;z=c[b+96>>2]|0;t=((l-e|0)<0)<<31>>31;j=0-(k-y)|0;s=iF(0,0,j|0,((j|0)<0)<<31>>31|0)|0;s=xF(o-z|0,((o-z|0)<0)<<31>>31|0,s|0,E|0)|0;r=E;q=xF(o-z|0,((o-z|0)<0)<<31>>31|0,l-e|0,t|0)|0;p=E;x=xF(k-y|0,((k-y|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;m=E;n=xF(l-e|0,t|0,l-e|0,t|0)|0;n=iF(x|0,m|0,n|0,E|0)|0;m=E;x=c[b+8>>2]|0;c[f+140>>2]=0;if(!x)A=0;else{u=iF(0,0,l-e|0,t|0)|0;w=E;A=0;v=x;do{C=c[v+12>>2]|0;F=c[C+88>>2]|0;B=c[C+92>>2]|0;C=c[C+96>>2]|0;H=xF(B-e|0,((B-e|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;J=E;I=xF(F-y|0,((F-y|0)<0)<<31>>31|0,u|0,w|0)|0;do if((H|0)==(I|0)&(J|0)==(E|0)?(I=xF(F-y|0,((F-y|0)<0)<<31>>31|0,s|0,r|0)|0,H=E,J=xF(B-e|0,((B-e|0)<0)<<31>>31|0,q|0,p|0)|0,H=lF(J|0,E|0,I|0,H|0)|0,I=E,J=xF(C-z|0,((C-z|0)<0)<<31>>31|0,n|0,m|0)|0,J=lF(H|0,I|0,J|0,E|0)|0,I=E,(I|0)>0|(I|0)==0&J>>>0>0):0){if(A){D=(c[A+4>>2]|0)==(v|0);if((c[A>>2]|0)==(v|0)){if(!D)break;H=c[A+12>>2]|0;G=c[(c[v+8>>2]|0)+12>>2]|0;J=c[G+88>>2]|0;I=c[G+92>>2]|0;G=c[G+96>>2]|0;D=(c[H+96>>2]|0)-G|0;I=(aa(C-G|0,(c[H+92>>2]|0)-I|0)|0)-(aa(D,B-I|0)|0)|0;B=(aa(D,F-J|0)|0)-(aa(C-G|0,(c[H+88>>2]|0)-J|0)|0)|0;I=xF(I|0,((I|0)<0)<<31>>31|0,l-e|0,t|0)|0;J=E;B=xF(B|0,((B|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;B=lF(I|0,J|0,B|0,E|0)|0;J=E;B=(J|0)>0|(J|0)==0&B>>>0>0?2:1}else B=D&1;if((B|0)!=1)break}c[f+140>>2]=v;A=v}while(0);v=c[v>>2]|0}while((v|0)!=(x|0))}w=c[d+8>>2]|0;c[f+136>>2]=0;if(!w)z=0;else{u=iF(0,0,l-e|0,t|0)|0;v=E;z=0;x=w;do{y=c[x+12>>2]|0;B=c[y+88>>2]|0;C=c[y+92>>2]|0;y=c[y+96>>2]|0;H=xF(C-l|0,((C-l|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;J=E;I=xF(B-k|0,((B-k|0)<0)<<31>>31|0,u|0,v|0)|0;do if((H|0)==(I|0)&(J|0)==(E|0)?(I=xF(B-k|0,((B-k|0)<0)<<31>>31|0,s|0,r|0)|0,H=E,J=xF(C-l|0,((C-l|0)<0)<<31>>31|0,q|0,p|0)|0,H=lF(J|0,E|0,I|0,H|0)|0,I=E,J=xF(y-o|0,((y-o|0)<0)<<31>>31|0,n|0,m|0)|0,J=lF(H|0,I|0,J|0,E|0)|0,I=E,(I|0)>0|(I|0)==0&J>>>0>0):0){if(z){if((c[z>>2]|0)!=(x|0))break;if((c[z+4>>2]|0)==(x|0)?(I=c[z+12>>2]|0,G=c[(c[x+8>>2]|0)+12>>2]|0,J=c[G+88>>2]|0,H=c[G+92>>2]|0,G=c[G+96>>2]|0,F=(c[I+96>>2]|0)-G|0,H=(aa(y-G|0,(c[I+92>>2]|0)-H|0)|0)-(aa(F,C-H|0)|0)|0,J=(aa(F,B-J|0)|0)-(aa(y-G|0,(c[I+88>>2]|0)-J|0)|0)|0,H=xF(H|0,((H|0)<0)<<31>>31|0,l-e|0,t|0)|0,I=E,J=xF(J|0,((J|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0,J=lF(H|0,I|0,J|0,E|0)|0,I=E,!((I|0)>0|(I|0)==0&J>>>0>0)):0)break}c[f+136>>2]=x;z=x}while(0);x=c[x>>2]|0}while((x|0)!=(w|0))}if(!((A|0)==0&(z|0)==0)){sE(a,b,d,f+140|0,f+136|0);e=c[f+140>>2]|0;if(e)b=c[e+12>>2]|0;e=c[f+136>>2]|0;if(e)d=c[e+12>>2]|0}w=(c[d+96>>2]|0)+1|0;t=c[d+88>>2]|0}u=c[d+92>>2]|0;s=u;e=b;m=d;j=0;q=0;z=1;n=0;v=0;o=0;x=0;k=0;p=0;while(1){y=e+88|0;G=(c[m+88>>2]|0)-(c[y>>2]|0)|0;J=e+92|0;l=s-(c[J>>2]|0)|0;F=e+96|0;C=(c[m+96>>2]|0)-(c[F>>2]|0)|0;c[f+120>>2]=G;c[f+124>>2]=l;c[f+128>>2]=C;c[f+132>>2]=-1;y=t-(c[y>>2]|0)|0;J=u-(c[J>>2]|0)|0;F=w-(c[F>>2]|0)|0;D=(aa(C,J)|0)-(aa(l,F)|0)|0;F=(aa(G,F)|0)-(aa(C,y)|0)|0;J=(aa(l,y)|0)-(aa(G,J)|0)|0;c[f+72>>2]=D;c[f+76>>2]=((D|0)<0)<<31>>31;c[f+80>>2]=F;c[f+84>>2]=((F|0)<0)<<31>>31;c[f+88>>2]=J;c[f+92>>2]=((J|0)<0)<<31>>31;y=xF(J|0,((J|0)<0)<<31>>31|0,l|0,((l|0)<0)<<31>>31|0)|0;I=E;H=xF(C|0,((C|0)<0)<<31>>31|0,F|0,((F|0)<0)<<31>>31|0)|0;H=iF(y|0,I|0,H|0,E|0)|0;I=E;C=xF(D|0,((D|0)<0)<<31>>31|0,C|0,((C|0)<0)<<31>>31|0)|0;y=E;J=xF(G|0,((G|0)<0)<<31>>31|0,J|0,((J|0)<0)<<31>>31|0)|0;J=iF(C|0,y|0,J|0,E|0)|0;y=E;F=xF(G|0,((G|0)<0)<<31>>31|0,F|0,((F|0)<0)<<31>>31|0)|0;G=E;l=xF(D|0,((D|0)<0)<<31>>31|0,l|0,((l|0)<0)<<31>>31|0)|0;l=iF(F|0,G|0,l|0,E|0)|0;c[f+48>>2]=H;c[f+52>>2]=I;c[f+56>>2]=J;c[f+60>>2]=y;c[f+64>>2]=l;c[f+68>>2]=E;c[f+24>>2]=0;c[f+28>>2]=0;c[f+32>>2]=0;c[f+36>>2]=0;c[f+40>>2]=0;l=rE(a,0,e,f+120|0,f+72|0,f+48|0,f+24|0)|0;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;c[f+12>>2]=0;c[f+16>>2]=0;y=rE(a,1,m,f+120|0,f+72|0,f+48|0,f)|0;if((y|0)==0&((l|0)!=0^1)){s=138;break}if((y|0)==0|(l|0)!=0^1)r=(l|0)!=0?-1:1;else r=oE(c[f+24>>2]|0,c[f+28>>2]|0,c[f+32>>2]|0,c[f+36>>2]|0,c[f+40>>2]|0,f)|0;do if(!z){if((r|0)>-1){if((c[f+16>>2]|0)>=0){s=150;break}if((c[f+8>>2]|0)==0&(c[f+12>>2]|0)==0){s=157;break}else{s=150;break}}if((c[f+40>>2]|0)<0?(c[f+32>>2]|0)==0&(c[f+36>>2]|0)==0:0){c[f+116>>2]=l;c[f+112>>2]=y;y=l;r=v;v=x;s=179}else s=150}else s=150;while(0);if((s|0)==150){s=pE(a+48|0)|0;z=pE(a+48|0)|0;c[s+8>>2]=z;c[z+8>>2]=s;c[s+20>>2]=c[a+100>>2];c[z+20>>2]=c[a+100>>2];c[s+12>>2]=m;c[z+12>>2]=e;c[s+16>>2]=0;c[z+16>>2]=0;z=c[a+116>>2]|0;c[a+116>>2]=z+1;if((z|0)>=(c[a+120>>2]|0))c[a+120>>2]=z+1;if(!o)n=s;else c[o+4>>2]=s;c[s>>2]=o;z=c[s+8>>2]|0;if(!x)v=z;else c[x>>2]=z;c[z+4>>2]=x;o=s;x=z;s=157}do if((s|0)==157){s=0;c[f+116>>2]=l;c[f+112>>2]=y;if(r)if((r|0)>-1)z=y;else{y=l;r=v;v=x;s=179;break}else{sE(a,e,m,f+116|0,f+112|0);z=c[f+112>>2]|0}if(z){t=(p|0)!=0;if(t?(g=c[p>>2]|0,(g|0)!=(y|0)):0){B=g;do{A=B;B=c[B>>2]|0;w=c[A+8>>2]|0;if((B|0)==(A|0))c[(c[w+12>>2]|0)+8>>2]=0;else{c[B+4>>2]=c[A+4>>2];c[c[A+4>>2]>>2]=B;c[(c[w+12>>2]|0)+8>>2]=B}u=c[w>>2]|0;if((u|0)==(w|0))c[(c[A+12>>2]|0)+8>>2]=0;else{c[u+4>>2]=c[w+4>>2];c[c[w+4>>2]>>2]=u;c[(c[A+12>>2]|0)+8>>2]=u}c[A+0>>2]=0;c[A+4>>2]=0;c[A+8>>2]=0;c[A+12>>2]=0;c[A+16>>2]=0;c[A>>2]=c[a+56>>2];c[a+56>>2]=A;c[w+0>>2]=0;c[w+4>>2]=0;c[w+8>>2]=0;c[w+12>>2]=0;c[w+16>>2]=0;c[w>>2]=c[a+56>>2];c[a+56>>2]=w;c[a+116>>2]=(c[a+116>>2]|0)+ -1}while((B|0)!=(y|0))}if(!x){p=z;q=t?q:y}else{if(t){c[p>>2]=v;c[v+4>>2]=p;p=y+4|0}else{p=c[y+4>>2]|0;c[p>>2]=v;c[v+4>>2]=p;p=y+4|0;q=v}c[x>>2]=y;c[p>>2]=x;p=c[f+112>>2]|0;v=0}w=c[m+96>>2]|0;u=c[m+92>>2]|0;t=c[m+88>>2]|0;m=c[p+12>>2]|0;x=0;p=c[p+8>>2]|0}if((r|0)<1){y=c[f+116>>2]|0;r=v;v=x;s=179}else{l=v;r=x}}while(0);if((s|0)==179){s=0;if(!y){l=r;r=v}else{t=(k|0)!=0;if(t?(h=c[k+4>>2]|0,(h|0)!=(l|0)):0){x=h;do{A=x+4|0;u=x;x=c[A>>2]|0;z=c[u>>2]|0;w=c[u+8>>2]|0;if((z|0)==(u|0))c[(c[w+12>>2]|0)+8>>2]=0;else{c[z+4>>2]=x;c[c[A>>2]>>2]=z;c[(c[w+12>>2]|0)+8>>2]=z}z=c[w>>2]|0;if((z|0)==(w|0))c[(c[u+12>>2]|0)+8>>2]=0;else{c[z+4>>2]=c[w+4>>2];c[c[w+4>>2]>>2]=z;c[(c[u+12>>2]|0)+8>>2]=z}c[u+0>>2]=0;c[u+4>>2]=0;c[u+8>>2]=0;c[u+12>>2]=0;c[u+16>>2]=0;c[u>>2]=c[a+56>>2];c[a+56>>2]=u;c[w+0>>2]=0;c[w+4>>2]=0;c[w+8>>2]=0;c[w+12>>2]=0;c[w+16>>2]=0;c[w>>2]=c[a+56>>2];c[a+56>>2]=w;c[a+116>>2]=(c[a+116>>2]|0)+ -1}while((x|0)!=(l|0))}if(!o)j=t?j:l;else{if(t){c[n>>2]=k;c[k+4>>2]=n;k=l}else{k=c[l>>2]|0;c[n>>2]=k;c[k+4>>2]=n;k=l;j=n}c[k>>2]=o;c[o+4>>2]=l;y=c[f+116>>2]|0;n=0}w=c[e+96>>2]|0;u=c[e+92>>2]|0;t=c[e+88>>2]|0;e=c[y+12>>2]|0;l=r;o=0;r=v;k=c[y+8>>2]|0}}if((e|0)==(b|0)&(m|0)==(d|0))break;s=c[m+92>>2]|0;z=0;v=l;x=r}if((s|0)==138){h=pE(a+48|0)|0;g=pE(a+48|0)|0;c[h+8>>2]=g;c[g+8>>2]=h;c[h+20>>2]=c[a+100>>2];c[g+20>>2]=c[a+100>>2];c[h+12>>2]=m;c[g+12>>2]=e;c[h+16>>2]=0;c[g+16>>2]=0;g=c[a+116>>2]|0;c[a+116>>2]=g+1;if((g|0)>=(c[a+120>>2]|0))c[a+120>>2]=g+1;c[h>>2]=h;c[h+4>>2]=h;c[e+8>>2]=h;J=c[h+8>>2]|0;c[J>>2]=J;c[J+4>>2]=J;c[m+8>>2]=J;i=f;return}if(k){g=k+4|0;e=c[g>>2]|0;if((e|0)!=(j|0))do{s=e+4|0;h=e;e=c[s>>2]|0;m=c[h>>2]|0;b=c[h+8>>2]|0;if((m|0)==(h|0))c[(c[b+12>>2]|0)+8>>2]=0;else{c[m+4>>2]=e;c[c[s>>2]>>2]=m;c[(c[b+12>>2]|0)+8>>2]=m}m=c[b>>2]|0;if((m|0)==(b|0))c[(c[h+12>>2]|0)+8>>2]=0;else{c[m+4>>2]=c[b+4>>2];c[c[b+4>>2]>>2]=m;c[(c[h+12>>2]|0)+8>>2]=m}c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;c[h+16>>2]=0;c[h>>2]=c[a+56>>2];c[a+56>>2]=h;c[b+0>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;c[b+12>>2]=0;c[b+16>>2]=0;c[b>>2]=c[a+56>>2];c[a+56>>2]=b;c[a+116>>2]=(c[a+116>>2]|0)+ -1}while((e|0)!=(j|0));if(o){c[n>>2]=k;c[g>>2]=n;c[j>>2]=o;c[o+4>>2]=j}}else{c[n>>2]=o;c[o+4>>2]=n;c[b+8>>2]=o}if(!p){c[r>>2]=l;c[l+4>>2]=r;c[d+8>>2]=r;i=f;return}g=c[p>>2]|0;if((g|0)!=(q|0))do{d=g;g=c[g>>2]|0;h=c[d+8>>2]|0;if((g|0)==(d|0))c[(c[h+12>>2]|0)+8>>2]=0;else{c[g+4>>2]=c[d+4>>2];c[c[d+4>>2]>>2]=g;c[(c[h+12>>2]|0)+8>>2]=g}b=c[h>>2]|0;if((b|0)==(h|0))c[(c[d+12>>2]|0)+8>>2]=0;else{c[b+4>>2]=c[h+4>>2];c[c[h+4>>2]>>2]=b;c[(c[d+12>>2]|0)+8>>2]=b}c[d+0>>2]=0;c[d+4>>2]=0;c[d+8>>2]=0;c[d+12>>2]=0;c[d+16>>2]=0;c[d>>2]=c[a+56>>2];c[a+56>>2]=d;c[h+0>>2]=0;c[h+4>>2]=0;c[h+8>>2]=0;c[h+12>>2]=0;c[h+16>>2]=0;c[h>>2]=c[a+56>>2];c[a+56>>2]=h;c[a+116>>2]=(c[a+116>>2]|0)+ -1}while((g|0)!=(q|0));if(!r){i=f;return}c[p>>2]=l;c[l+4>>2]=p;c[r>>2]=q;c[q+4>>2]=r;i=f;return}while(0);c[g+8>>2]=0;c[g>>2]=g;c[g+4>>2]=g;c[e>>2]=g;c[e+4>>2]=g;c[e+8>>2]=g;c[e+12>>2]=g;i=f;return}function rE(a,b,d,e,f,g,h){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;var j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0;j=i;k=c[d+8>>2]|0;if(!k){y=0;i=j;return y|0}l=0;do{do if((c[k+20>>2]|0)>(c[a+100>>2]|0)){p=c[k+12>>2]|0;r=c[p+88>>2]|0;o=r-(c[d+88>>2]|0)|0;q=c[p+92>>2]|0;m=q-(c[d+92>>2]|0)|0;p=c[p+96>>2]|0;n=p-(c[d+96>>2]|0)|0;u=xF(o|0,((o|0)<0)<<31>>31|0,c[g>>2]|0,c[g+4>>2]|0)|0;w=E;s=xF(m|0,((m|0)<0)<<31>>31|0,c[g+8>>2]|0,c[g+12>>2]|0)|0;w=lF(s|0,E|0,u|0,w|0)|0;u=E;s=xF(n|0,((n|0)<0)<<31>>31|0,c[g+16>>2]|0,c[g+20>>2]|0)|0;s=lF(w|0,u|0,s|0,E|0)|0;u=E;w=xF(c[f>>2]|0,c[f+4>>2]|0,o|0,((o|0)<0)<<31>>31|0)|0;y=E;x=xF(c[f+8>>2]|0,c[f+12>>2]|0,m|0,((m|0)<0)<<31>>31|0)|0;y=lF(x|0,E|0,w|0,y|0)|0;w=E;x=xF(c[f+16>>2]|0,c[f+20>>2]|0,n|0,((n|0)<0)<<31>>31|0)|0;x=lF(y|0,w|0,x|0,E|0)|0;w=E;if((u|0)>0|(u|0)==0&s>>>0>0){v=1;t=u;u=1}else{s=iF(0,0,s|0,u|0)|0;v=(u|0)<0?-1:0;s=(u|0)<0?s:0;t=(u|0)<0?E:0;u=(u|0)<0?-1:0}if(!((w|0)>0|(w|0)==0&x>>>0>0)){if((w|0)<0){u=0-v|0;z=iF(0,0,x|0,w|0)|0;v=u;y=(x|0)==0&(w|0)==0;x=z;w=E}else{y=1;x=0;w=0}if((v|0)==0&y)break;else v=x}else v=x;if(!l){c[h>>2]=s;c[h+4>>2]=t;c[h+8>>2]=v;c[h+12>>2]=w;c[h+16>>2]=u;l=k;break}x=oE(s,t,v,w,u,h)|0;if((x|0)<0){c[h>>2]=s;c[h+4>>2]=t;c[h+8>>2]=v;c[h+12>>2]=w;c[h+16>>2]=u;l=k;break}if(!x){s=(c[l+4>>2]|0)==(k|0);if((c[l>>2]|0)==(k|0))if(s){z=c[e+8>>2]|0;w=aa(z,m)|0;u=c[e+4>>2]|0;w=w-(aa(u,n)|0)|0;y=c[e>>2]|0;z=(aa(y,n)|0)-(aa(o,z)|0)|0;y=(aa(o,u)|0)-(aa(y,m)|0)|0;o=c[l+12>>2]|0;m=c[(c[k+8>>2]|0)+12>>2]|0;u=c[m+88>>2]|0;t=(c[o+88>>2]|0)-u|0;s=c[m+92>>2]|0;v=(c[o+92>>2]|0)-s|0;m=c[m+96>>2]|0;o=(c[o+96>>2]|0)-m|0;x=(aa(p-m|0,v)|0)-(aa(q-s|0,o)|0)|0;m=(aa(r-u|0,o)|0)-(aa(p-m|0,t)|0)|0;v=(aa(q-s|0,t)|0)-(aa(r-u|0,v)|0)|0;w=xF(x|0,((x|0)<0)<<31>>31|0,w|0,((w|0)<0)<<31>>31|0)|0;x=E;z=xF(m|0,((m|0)<0)<<31>>31|0,z|0,((z|0)<0)<<31>>31|0)|0;m=E;y=xF(v|0,((v|0)<0)<<31>>31|0,y|0,((y|0)<0)<<31>>31|0)|0;y=lF(w|0,x|0,y|0,E|0)|0;m=lF(y|0,E|0,z|0,m|0)|0;z=E;m=(z|0)>0|(z|0)==0&m>>>0>0?2:1}else m=2;else m=s&1;l=(m|0)==2^b?l:k}}while(0);k=c[k>>2]|0}while((k|0)!=(c[d+8>>2]|0));i=j;return l|0}function sE(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,F=0,G=0,H=0,I=0,J=0,K=0,L=0,M=0,N=0,O=0,P=0,Q=0,R=0,S=0,T=0,U=0,V=0,W=0,X=0,Y=0,Z=0;g=i;i=i+96|0;s=c[e>>2]|0;h=c[f>>2]|0;if(s)j=c[s+12>>2]|0;else j=b;x=c[j+88>>2]|0;w=c[j+92>>2]|0;v=c[j+96>>2]|0;if(!h)j=d;else j=c[h+12>>2]|0;B=c[j+88>>2]|0;A=c[j+92>>2]|0;z=c[j+96>>2]|0;r=c[b+88>>2]|0;j=(c[d+88>>2]|0)-r|0;C=c[b+92>>2]|0;k=(c[d+92>>2]|0)-C|0;G=c[b+96>>2]|0;p=(c[d+96>>2]|0)-G|0;d=c[((s|0)!=0?s:h)+12>>2]|0;o=(c[d+88>>2]|0)-r|0;u=(c[d+92>>2]|0)-C|0;d=(c[d+96>>2]|0)-G|0;q=(aa(u,p)|0)-(aa(d,k)|0)|0;d=(aa(d,j)|0)-(aa(o,p)|0)|0;u=(aa(o,k)|0)-(aa(u,j)|0)|0;r=xF(q|0,((q|0)<0)<<31>>31|0,r|0,((r|0)<0)<<31>>31|0)|0;o=E;C=xF(d|0,((d|0)<0)<<31>>31|0,C|0,((C|0)<0)<<31>>31|0)|0;D=E;G=xF(u|0,((u|0)<0)<<31>>31|0,G|0,((G|0)<0)<<31>>31|0)|0;G=lF(r|0,o|0,G|0,E|0)|0;D=lF(G|0,E|0,C|0,D|0)|0;C=E;G=xF(u|0,((u|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0;o=E;r=xF(d|0,((d|0)<0)<<31>>31|0,p|0,((p|0)<0)<<31>>31|0)|0;r=iF(G|0,o|0,r|0,E|0)|0;o=E;G=xF(q|0,((q|0)<0)<<31>>31|0,p|0,((p|0)<0)<<31>>31|0)|0;l=E;b=xF(u|0,((u|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;b=iF(G|0,l|0,b|0,E|0)|0;l=E;G=xF(d|0,((d|0)<0)<<31>>31|0,j|0,((j|0)<0)<<31>>31|0)|0;n=E;m=xF(q|0,((q|0)<0)<<31>>31|0,k|0,((k|0)<0)<<31>>31|0)|0;m=iF(G|0,n|0,m|0,E|0)|0;n=E;G=xF(r|0,o|0,x|0,((x|0)<0)<<31>>31|0)|0;Z=E;F=xF(b|0,l|0,w|0,((w|0)<0)<<31>>31|0)|0;Z=lF(F|0,E|0,G|0,Z|0)|0;G=E;F=xF(m|0,n|0,v|0,((v|0)<0)<<31>>31|0)|0;F=lF(Z|0,G|0,F|0,E|0)|0;G=E;if((s|0)!=0?(c[s+12>>2]|0)!=0:0){y=s;while(1){y=c[(c[y+8>>2]|0)+4>>2]|0;J=y+12|0;I=c[J>>2]|0;K=c[I+88>>2]|0;Y=xF(K|0,((K|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0;X=E;H=c[I+92>>2]|0;Z=xF(H|0,((H|0)<0)<<31>>31|0,d|0,((d|0)<0)<<31>>31|0)|0;X=lF(Z|0,E|0,Y|0,X|0)|0;Y=E;I=c[I+96>>2]|0;Z=xF(I|0,((I|0)<0)<<31>>31|0,u|0,((u|0)<0)<<31>>31|0)|0;Z=lF(X|0,Y|0,Z|0,E|0)|0;Y=E;if((Y|0)<(C|0)|(Y|0)==(C|0)&Z>>>0<D>>>0)break;if((c[y+20>>2]|0)==(c[a+100>>2]|0))break;Y=xF(K|0,((K|0)<0)<<31>>31|0,r|0,o|0)|0;Z=E;H=xF(H|0,((H|0)<0)<<31>>31|0,b|0,l|0)|0;Z=lF(H|0,E|0,Y|0,Z|0)|0;H=E;I=xF(I|0,((I|0)<0)<<31>>31|0,m|0,n|0)|0;I=lF(Z|0,H|0,I|0,E|0)|0;H=E;if(!((H|0)>(G|0)|(H|0)==(G|0)&I>>>0>F>>>0))break;c[e>>2]=y;Z=c[J>>2]|0;x=c[Z+88>>2]|0;w=c[Z+92>>2]|0;v=c[Z+96>>2]|0;if(!Z){F=I;G=H;break}else{G=H;F=I}}y=c[f>>2]|0}else y=h;H=xF(r|0,o|0,B|0,((B|0)<0)<<31>>31|0)|0;Z=E;I=xF(b|0,l|0,A|0,((A|0)<0)<<31>>31|0)|0;Z=lF(I|0,E|0,H|0,Z|0)|0;H=E;I=xF(m|0,n|0,z|0,((z|0)<0)<<31>>31|0)|0;I=lF(Z|0,H|0,I|0,E|0)|0;H=E;a:do if(y)if(!(c[y+12>>2]|0))C=I;else while(1){J=c[c[y+8>>2]>>2]|0;M=c[J+12>>2]|0;K=c[M+88>>2]|0;Y=xF(K|0,((K|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0;X=E;L=c[M+92>>2]|0;Z=xF(L|0,((L|0)<0)<<31>>31|0,d|0,((d|0)<0)<<31>>31|0)|0;X=lF(Z|0,E|0,Y|0,X|0)|0;Y=E;M=c[M+96>>2]|0;Z=xF(M|0,((M|0)<0)<<31>>31|0,u|0,((u|0)<0)<<31>>31|0)|0;Z=lF(X|0,Y|0,Z|0,E|0)|0;Y=E;if((Y|0)<(C|0)|(Y|0)==(C|0)&Z>>>0<D>>>0){C=I;break a}if((c[J+20>>2]|0)==(c[a+100>>2]|0)){C=I;break a}K=xF(K|0,((K|0)<0)<<31>>31|0,r|0,o|0)|0;Z=E;L=xF(L|0,((L|0)<0)<<31>>31|0,b|0,l|0)|0;Z=lF(L|0,E|0,K|0,Z|0)|0;K=E;L=xF(M|0,((M|0)<0)<<31>>31|0,m|0,n|0)|0;L=lF(Z|0,K|0,L|0,E|0)|0;K=E;if(!((K|0)>(H|0)|(K|0)==(H|0)&L>>>0>I>>>0)){C=I;break a}c[f>>2]=J;Z=c[J+12>>2]|0;B=c[Z+88>>2]|0;A=c[Z+92>>2]|0;z=c[Z+96>>2]|0;if(!Z){C=L;H=K;y=J;break}else{y=J;H=K;I=L}}else{C=I;y=0}while(0);D=iF(C|0,H|0,F|0,G|0)|0;C=E;if((C|0)>0|(C|0)==0&D>>>0>0){I=iF(0,0,u|0,((u|0)<0)<<31>>31|0)|0;J=E;H=v;G=w;F=x;N=z;O=A;P=B;L=D;K=C;b:while(1){c:while(1){M=(aa(O-G|0,k)|0)+(aa(N-H|0,p)|0)+(aa(P-F|0,j)|0)|0;Q=c[e>>2]|0;do if(((Q|0)!=0?(c[Q+12>>2]|0)!=0:0)?(t=c[(c[Q>>2]|0)+8>>2]|0,(c[t+20>>2]|0)>(c[a+100>>2]|0)):0){T=c[t+12>>2]|0;R=c[T+88>>2]|0;Z=R-F|0;U=c[T+92>>2]|0;X=U-G|0;T=c[T+96>>2]|0;V=T-H|0;W=xF(Z|0,((Z|0)<0)<<31>>31|0,r|0,o|0)|0;S=E;Y=xF(X|0,((X|0)<0)<<31>>31|0,b|0,l|0)|0;S=lF(Y|0,E|0,W|0,S|0)|0;W=E;Y=xF(V|0,((V|0)<0)<<31>>31|0,m|0,n|0)|0;Y=lF(S|0,W|0,Y|0,E|0)|0;W=E;V=(aa(X,k)|0)+(aa(Z,j)|0)+(aa(V,p)|0)|0;if((Y|0)==0&(W|0)==0)if((V|0)<0)break c;else break;if((W|0)<0){if((V|0)>0){X=1;Z=1;S=V;V=((V|0)<0)<<31>>31}else{S=iF(0,0,V|0,((V|0)<0)<<31>>31|0)|0;X=(V|0)<0?-1:0;Z=(V|0)<0?-1:0;S=(V|0)<0?S:0;V=(V|0)<0?E:0}if(!((W|0)>0|(W|0)==0&Y>>>0>0)){Y=iF(0,0,Y|0,W|0)|0;X=0-Z|0;W=E}do if((M|0)<=0)if((M|0)<0){c[g+88>>2]=-1;Z=iF(0,0,M|0,((M|0)<0)<<31>>31|0)|0;c[g+72>>2]=Z;c[g+76>>2]=E;Z=-1;break}else{c[g+88>>2]=0;c[g+72>>2]=0;c[g+76>>2]=0;Z=0;break}else{c[g+88>>2]=1;c[g+72>>2]=M;c[g+76>>2]=((M|0)<0)<<31>>31;Z=1}while(0);do if(!((K|0)>0|(K|0)==0&L>>>0>0))if((K|0)<0){c[g+88>>2]=0-Z;Z=iF(0,0,L|0,K|0)|0;c[g+80>>2]=Z;c[g+84>>2]=E;break}else{c[g+80>>2]=0;c[g+84>>2]=0;break}else{c[g+80>>2]=L;c[g+84>>2]=K}while(0);if((oE(S,V,Y,W,X,g+72|0)|0)>-1)break c}}while(0);Q=c[f>>2]|0;if(!Q){s=117;break b}if(!(c[Q+12>>2]|0)){s=117;break b}Q=c[c[Q+8>>2]>>2]|0;if((c[Q+20>>2]|0)<=(c[a+100>>2]|0)){s=117;break b}U=c[Q+12>>2]|0;R=c[U+88>>2]|0;S=R-P|0;P=c[U+92>>2]|0;T=P-O|0;U=c[U+96>>2]|0;V=U-N|0;Z=xF(S|0,((S|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0;X=E;Y=xF(T|0,((T|0)<0)<<31>>31|0,d|0,((d|0)<0)<<31>>31|0)|0;X=lF(Y|0,E|0,Z|0,X|0)|0;Z=E;Y=xF(V|0,((V|0)<0)<<31>>31|0,I|0,J|0)|0;if(!((X|0)==(Y|0)&(Z|0)==(E|0))){s=117;break b}N=xF(S|0,((S|0)<0)<<31>>31|0,r|0,o|0)|0;Y=E;O=xF(T|0,((T|0)<0)<<31>>31|0,b|0,l|0)|0;Y=lF(O|0,E|0,N|0,Y|0)|0;N=E;O=xF(V|0,((V|0)<0)<<31>>31|0,m|0,n|0)|0;O=lF(Y|0,N|0,O|0,E|0)|0;N=E;T=(aa(T,k)|0)+(aa(S,j)|0)+(aa(V,p)|0)|0;R=R-F|0;Y=P-G|0;S=U-H|0;R=xF(R|0,((R|0)<0)<<31>>31|0,r|0,o|0)|0;Z=E;Y=xF(Y|0,((Y|0)<0)<<31>>31|0,b|0,l|0)|0;Z=lF(Y|0,E|0,R|0,Z|0)|0;R=E;S=xF(S|0,((S|0)<0)<<31>>31|0,m|0,n|0)|0;S=lF(Z|0,R|0,S|0,E|0)|0;R=E;if(!((R|0)>0|(R|0)==0&S>>>0>0)){s=117;break b}if((O|0)==0&(N|0)==0){if((T|0)>=0){s=117;break b}}else{if((N|0)>=0){s=117;break b}if((T|0)>0){U=1;V=1;P=T;T=((T|0)<0)<<31>>31}else{P=iF(0,0,T|0,((T|0)<0)<<31>>31|0)|0;U=(T|0)<0?-1:0;V=(T|0)<0?-1:0;P=(T|0)<0?P:0;T=(T|0)<0?E:0}if(!((N|0)>0|(N|0)==0&O>>>0>0)){O=iF(0,0,O|0,N|0)|0;U=0-V|0;N=E}do if((M|0)<=0)if((M|0)<0){c[g+64>>2]=-1;M=iF(0,0,M|0,((M|0)<0)<<31>>31|0)|0;c[g+48>>2]=M;c[g+52>>2]=E;M=-1;break}else{c[g+64>>2]=0;c[g+48>>2]=0;c[g+52>>2]=0;M=0;break}else{c[g+64>>2]=1;c[g+48>>2]=M;c[g+52>>2]=((M|0)<0)<<31>>31;M=1}while(0);do if(!((K|0)>0|(K|0)==0&L>>>0>0))if((K|0)<0){c[g+64>>2]=0-M;Z=iF(0,0,L|0,K|0)|0;c[g+56>>2]=Z;c[g+60>>2]=E;break}else{c[g+56>>2]=0;c[g+60>>2]=0;break}else{c[g+56>>2]=L;c[g+60>>2]=K}while(0);if((oE(P,T,O,N,U,g+48|0)|0)<=0){s=117;break b}}c[f>>2]=Q;N=c[Q+12>>2]|0;P=c[N+88>>2]|0;O=c[N+92>>2]|0;N=c[N+96>>2]|0;K=R;L=S}H=P-R|0;F=O-U|0;L=N-T|0;H=xF(H|0,((H|0)<0)<<31>>31|0,r|0,o|0)|0;G=E;F=xF(F|0,((F|0)<0)<<31>>31|0,b|0,l|0)|0;G=lF(F|0,E|0,H|0,G|0)|0;H=E;L=xF(L|0,((L|0)<0)<<31>>31|0,m|0,n|0)|0;L=lF(G|0,H|0,L|0,E|0)|0;c[e>>2]=(Q|0)==(s|0)?0:t;H=T;G=U;F=R;K=E}if((s|0)==117){i=g;return}}if((C|0)>=0){i=g;return}s=iF(0,0,u|0,((u|0)<0)<<31>>31|0)|0;t=E;while(1){F=(aa(A-w|0,k)|0)+(aa(z-v|0,p)|0)+(aa(B-x|0,j)|0)|0;d:do if(!y){u=F;y=F;F=((F|0)<0)<<31>>31}else{u=F;G=F;F=((F|0)<0)<<31>>31;while(1){if(!(c[y+12>>2]|0)){y=G;break d}K=c[(c[y+4>>2]|0)+8>>2]|0;if((c[K+20>>2]|0)<=(c[a+100>>2]|0)){y=G;break d}J=c[K+12>>2]|0;H=c[J+88>>2]|0;Z=H-B|0;I=c[J+92>>2]|0;Y=I-A|0;J=c[J+96>>2]|0;M=J-z|0;N=xF(Z|0,((Z|0)<0)<<31>>31|0,r|0,o|0)|0;X=E;P=xF(Y|0,((Y|0)<0)<<31>>31|0,b|0,l|0)|0;X=lF(P|0,E|0,N|0,X|0)|0;N=E;P=xF(M|0,((M|0)<0)<<31>>31|0,m|0,n|0)|0;P=lF(X|0,N|0,P|0,E|0)|0;N=E;M=(aa(Y,k)|0)+(aa(Z,j)|0)+(aa(M,p)|0)|0;if((P|0)==0&(N|0)==0){if((M|0)<=0){y=G;break d}}else{if((N|0)>=0){y=G;break d}if((M|0)>0){O=1;Q=1;L=M;M=((M|0)<0)<<31>>31}else{L=iF(0,0,M|0,((M|0)<0)<<31>>31|0)|0;O=(M|0)<0?-1:0;Q=(M|0)<0?-1:0;L=(M|0)<0?L:0;M=(M|0)<0?E:0}if(!((N|0)>0|(N|0)==0&P>>>0>0)){P=iF(0,0,P|0,N|0)|0;O=0-Q|0;N=E}do if((u|0)<=0)if((u|0)<0){c[g+40>>2]=-1;Q=iF(0,0,G|0,F|0)|0;c[g+24>>2]=Q;c[g+28>>2]=E;Q=-1;break}else{c[g+40>>2]=0;c[g+24>>2]=0;c[g+28>>2]=0;Q=0;break}else{c[g+40>>2]=1;c[g+24>>2]=G;c[g+28>>2]=F;Q=1}while(0);do if(!((C|0)>0|(C|0)==0&D>>>0>0))if((C|0)<0){c[g+40>>2]=0-Q;Z=iF(0,0,D|0,C|0)|0;c[g+32>>2]=Z;c[g+36>>2]=E;break}else{c[g+32>>2]=0;c[g+36>>2]=0;break}else{c[g+32>>2]=D;c[g+36>>2]=C}while(0);if((oE(L,M,P,N,O,g+24|0)|0)>=1){y=G;break d}}F=H-x|0;Y=I-w|0;Z=J-v|0;C=xF(F|0,((F|0)<0)<<31>>31|0,r|0,o|0)|0;X=E;D=xF(Y|0,((Y|0)<0)<<31>>31|0,b|0,l|0)|0;X=lF(D|0,E|0,C|0,X|0)|0;C=E;D=xF(Z|0,((Z|0)<0)<<31>>31|0,m|0,n|0)|0;D=lF(X|0,C|0,D|0,E|0)|0;C=E;y=(y|0)==(h|0)?0:K;c[f>>2]=y;F=(aa(Y,k)|0)+(aa(Z,p)|0)+(aa(F,j)|0)|0;if(!y){z=J;A=I;B=H;u=F;y=F;F=((F|0)<0)<<31>>31;break}else{B=H;A=I;z=J;u=F;G=F;F=((F|0)<0)<<31>>31}}}while(0);G=c[e>>2]|0;if(!G){s=117;break}if(!(c[G+12>>2]|0)){s=117;break}G=c[(c[G+8>>2]|0)+4>>2]|0;if((c[G+20>>2]|0)<=(c[a+100>>2]|0)){s=117;break}K=c[G+12>>2]|0;H=c[K+88>>2]|0;I=H-x|0;x=c[K+92>>2]|0;J=x-w|0;K=c[K+96>>2]|0;L=K-v|0;Z=xF(I|0,((I|0)<0)<<31>>31|0,q|0,((q|0)<0)<<31>>31|0)|0;X=E;Y=xF(J|0,((J|0)<0)<<31>>31|0,d|0,((d|0)<0)<<31>>31|0)|0;X=lF(Y|0,E|0,Z|0,X|0)|0;Z=E;Y=xF(L|0,((L|0)<0)<<31>>31|0,s|0,t|0)|0;if(!((X|0)==(Y|0)&(Z|0)==(E|0))){s=117;break}v=xF(I|0,((I|0)<0)<<31>>31|0,r|0,o|0)|0;Y=E;w=xF(J|0,((J|0)<0)<<31>>31|0,b|0,l|0)|0;Y=lF(w|0,E|0,v|0,Y|0)|0;v=E;w=xF(L|0,((L|0)<0)<<31>>31|0,m|0,n|0)|0;w=lF(Y|0,v|0,w|0,E|0)|0;v=E;J=(aa(J,k)|0)+(aa(I,j)|0)+(aa(L,p)|0)|0;H=B-H|0;Y=A-x|0;I=z-K|0;H=xF(H|0,((H|0)<0)<<31>>31|0,r|0,o|0)|0;Z=E;Y=xF(Y|0,((Y|0)<0)<<31>>31|0,b|0,l|0)|0;Z=lF(Y|0,E|0,H|0,Z|0)|0;H=E;I=xF(I|0,((I|0)<0)<<31>>31|0,m|0,n|0)|0;I=lF(Z|0,H|0,I|0,E|0)|0;H=E;if((H|0)>=0){s=117;break}if((w|0)==0&(v|0)==0){if((J|0)<=0){s=117;break}}else{if((v|0)>=0){s=117;break}if((J|0)>0){K=1;L=1;x=J;J=((J|0)<0)<<31>>31}else{x=iF(0,0,J|0,((J|0)<0)<<31>>31|0)|0;K=(J|0)<0?-1:0;L=(J|0)<0?-1:0;x=(J|0)<0?x:0;J=(J|0)<0?E:0}if(!((v|0)>0|(v|0)==0&w>>>0>0)){w=iF(0,0,w|0,v|0)|0;K=0-L|0;v=E}do if((u|0)<=0)if((u|0)<0){c[g+16>>2]=-1;u=iF(0,0,y|0,F|0)|0;c[g>>2]=u;c[g+4>>2]=E;u=-1;break}else{c[g+16>>2]=0;c[g>>2]=0;c[g+4>>2]=0;u=0;break}else{c[g+16>>2]=1;c[g>>2]=y;c[g+4>>2]=F;u=1}while(0);do if(!((C|0)>0|(C|0)==0&D>>>0>0))if((C|0)<0){c[g+16>>2]=0-u;Z=iF(0,0,D|0,C|0)|0;c[g+8>>2]=Z;c[g+12>>2]=E;break}else{c[g+8>>2]=0;c[g+12>>2]=0;break}else{c[g+8>>2]=D;c[g+12>>2]=C}while(0);if((oE(x,J,w,v,K,g)|0)>=0){s=117;break}}c[e>>2]=G;x=c[G+12>>2]|0;v=c[x+96>>2]|0;w=c[x+92>>2]|0;x=c[x+88>>2]|0;y=c[f>>2]|0;D=I;C=H}if((s|0)==117){i=g;return}}function tE(a){a=a|0;var b=0,d=0,e=0,f=0.0,g=0,h=0,j=0;b=i;i=i+16|0;e=c[a+8>>2]|0;d=c[a+12>>2]|0;if((d|0)>-1|(d|0)==-1&e>>>0>4294967295){f=(+(e>>>0)+4294967296.0*+(d>>>0))*18446744073709552000.0+(+((c[a>>2]|0)>>>0)+4294967296.0*+((c[a+4>>2]|0)>>>0));i=b;return+f}else{j=c[a>>2]|0;h=c[a+4>>2]|0;g=iF(0,0,j|0,h|0)|0;a=E;e=lF((j|0)==0&(h|0)==0&1|0,0,~e|0,~d|0)|0;c[b>>2]=g;c[b+4>>2]=a;c[b+8>>2]=e;c[b+12>>2]=E;f=-+tE(b);i=b;return+f}return 0.0}function uE(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0.0,r=0.0,s=0.0,t=0.0,u=0.0,v=0.0,w=0.0,x=0.0,y=0.0,z=0,A=0,B=0,C=0,D=0,E=0;f=i;i=i+256|0;if((e|0)<1){e=c[b+12>>2]|0;if(e){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=0;c[b+4>>2]=0;c[b+8>>2]=0;e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+24>>2]=0;c[b+28>>2]=0;e=c[b+52>>2]|0;if(e){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=0;c[b+44>>2]=0;c[b+48>>2]=0;i=f;return}c[f+88>>2]=0;c[f+92>>2]=0;h=f+96|0;c[h>>2]=0;c[f+100>>2]=256;c[f+104>>2]=0;c[f+108>>2]=0;c[f+112>>2]=0;c[f+116>>2]=256;c[f+120>>2]=0;c[f+124>>2]=0;c[f+128>>2]=0;c[f+132>>2]=256;a[f+152>>0]=1;j=f+148|0;c[j>>2]=0;c[f+140>>2]=0;c[f+144>>2]=0;t=1.0000000150474662e+30;x=1.0000000150474662e+30;u=1.0000000150474662e+30;y=-1.0000000150474662e+30;w=-1.0000000150474662e+30;v=-1.0000000150474662e+30;n=0;m=d;while(1){q=+g[m>>2];r=+g[m+4>>2];s=+g[m+8>>2];t=q<t?q:t;x=r<x?r:x;u=s<u?s:u;y=y<q?q:y;w=w<r?r:w;v=v<s?s:v;n=n+1|0;if((n|0)==(e|0))break;else m=m+16|0}q=y-t;r=w-x;s=v-u;if(q<r){c[f+168>>2]=r<s?2:1;m=q<s?0:2;p=f+168|0}else{c[f+168>>2]=q<s?2:0;m=r<s?1:2;p=f+168|0}c[f+160>>2]=m;n=c[p>>2]|0;if((m|0)==(n|0)){m=((m+1|0)>>>0)%3|0;c[f+160>>2]=m;n=c[p>>2]|0}E=3-n-m|0;c[f+164>>2]=E;if(((E+1|0)%3|0|0)==(c[p>>2]|0)){q=q*9788566967472434.0e-20;r=r*9788566967472434.0e-20;s=s*9788566967472434.0e-20}else{q=q*9788566967472434.0e-20*-1.0;r=r*9788566967472434.0e-20*-1.0;s=s*9788566967472434.0e-20*-1.0}g[f+56>>2]=q;g[f+60>>2]=r;g[f+64>>2]=s;g[f+68>>2]=0.0;if(q!=0.0)q=1.0/q;if(r!=0.0)r=1.0/r;if(s!=0.0)s=1.0/s;g[f+72>>2]=(t+y)*.5;g[f+76>>2]=(x+w)*.5;g[f+80>>2]=(u+v)*.5;g[f+84>>2]=0.0;m=f+248|0;a[m>>0]=1;n=f+244|0;c[n>>2]=0;o=f+236|0;c[o>>2]=0;c[f+240>>2]=0;if((e|0)>0){c[5004]=(c[5004]|0)+1;z=fF((e<<4|3)+16|0)|0;if(!z)z=0;else{c[(z+19&-16)+ -4>>2]=z;z=z+19&-16}C=c[o>>2]|0;if((C|0)>0){A=0;do{B=z+(A<<4)|0;if(B){E=(c[n>>2]|0)+(A<<4)|0;c[B+0>>2]=c[E+0>>2];c[B+4>>2]=c[E+4>>2];c[B+8>>2]=c[E+8>>2];c[B+12>>2]=c[E+12>>2]}A=A+1|0}while((A|0)!=(C|0))}A=c[n>>2]|0;if(A){if(a[m>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[A+ -4>>2]|0)}c[n>>2]=0}a[m>>0]=1;c[n>>2]=z;c[f+240>>2]=e;A=0;while(1){z=z+(A<<4)|0;if(z){c[z+0>>2]=c[f+216>>2];c[z+4>>2]=c[f+220>>2];c[z+8>>2]=c[f+224>>2];c[z+12>>2]=c[f+228>>2]}A=A+1|0;if((A|0)==(e|0))break;z=c[n>>2]|0}c[o>>2]=e;z=c[n>>2]|0;u=+g[f+72>>2];v=+g[f+76>>2];t=+g[f+80>>2];A=0;while(1){w=+g[d>>2];g[f+200>>2]=w;x=+g[d+4>>2];g[f+204>>2]=x;y=s*(+g[d+8>>2]-t);g[f+200>>2]=q*(w-u);g[f+204>>2]=r*(x-v);g[f+208>>2]=y;g[f+212>>2]=0.0;c[z+(A<<4)>>2]=~~+g[f+200+(c[f+164>>2]<<2)>>2];c[z+(A<<4)+4>>2]=~~+g[f+200+(c[p>>2]<<2)>>2];c[z+(A<<4)+8>>2]=~~+g[f+200+(c[f+160>>2]<<2)>>2];c[z+(A<<4)+12>>2]=A;A=A+1|0;if((A|0)==(e|0))break;d=d+16|0}d=c[o>>2]|0;if((d|0)>1)vE(f+232|0,0,d+ -1|0)}else c[o>>2]=e;c[f+92>>2]=c[f+88>>2];c[h>>2]=0;c[f+100>>2]=e;d=c[f+140>>2]|0;if((d|0)<(e|0)){if((c[f+144>>2]|0)<(e|0)){if(!e){p=0;z=d}else{c[5004]=(c[5004]|0)+1;p=fF((e<<2|3)+16|0)|0;if(!p)p=0;else{c[(p+19&-16)+ -4>>2]=p;p=p+19&-16}z=c[f+140>>2]|0}if((z|0)>0){B=0;do{A=p+(B<<2)|0;if(A)c[A>>2]=c[(c[j>>2]|0)+(B<<2)>>2];B=B+1|0}while((B|0)!=(z|0))}z=c[j>>2]|0;if(z){if(a[f+152>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[z+ -4>>2]|0)}c[j>>2]=0}a[f+152>>0]=1;c[j>>2]=p;c[f+144>>2]=e}do{p=(c[j>>2]|0)+(d<<2)|0;if(p)c[p>>2]=0;d=d+1|0}while((d|0)!=(e|0))}c[f+140>>2]=e;if((e|0)>0){d=0;do{p=c[h>>2]|0;if(!p){p=c[f+92>>2]|0;if(!p){c[5004]=(c[5004]|0)+1;p=fF(31)|0;if((p|0)!=0?(l=p+19&-16,c[l+ -4>>2]=p,(p+19&-16|0)!=0):0){z=c[f+100>>2]|0;c[l+4>>2]=z;c[l+8>>2]=0;c[5004]=(c[5004]|0)+1;z=fF((z*112|3)+16|0)|0;if(!z)z=0;else{c[(z+19&-16)+ -4>>2]=z;z=z+19&-16}c[(p+19&-16)>>2]=z;p=p+19&-16}else p=0;c[p+8>>2]=c[f+88>>2];c[f+88>>2]=p}else c[f+92>>2]=c[p+8>>2];z=c[p+4>>2]|0;if((z|0)>0){A=0;B=c[p>>2]|0;do{A=A+1|0;E=B;B=B+112|0;c[E>>2]=(A|0)<(z|0)?B:0}while((A|0)!=(z|0))}p=c[p>>2]|0;c[h>>2]=c[p>>2];if(!p)p=0;else k=85}else{c[h>>2]=c[p>>2];k=85}if((k|0)==85){k=0;E=p+104|0;c[p+0>>2]=0;c[p+4>>2]=0;c[p+8>>2]=0;c[p+12>>2]=0;c[p+16>>2]=0;c[E>>2]=-1}c[p+8>>2]=0;E=p+88|0;D=(c[n>>2]|0)+(d<<4)|0;c[E+0>>2]=c[D+0>>2];c[E+4>>2]=c[D+4>>2];c[E+8>>2]=c[D+8>>2];c[E+12>>2]=c[D+12>>2];c[p+104>>2]=-1;c[(c[j>>2]|0)+(d<<2)>>2]=p;d=d+1|0}while((d|0)<(e|0))}h=c[n>>2]|0;if(h){if(a[m>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[n>>2]=0}a[m>>0]=1;c[n>>2]=0;c[o>>2]=0;c[f+240>>2]=0;c[f+108>>2]=c[f+104>>2];c[f+112>>2]=0;c[f+116>>2]=e*6;c[f+172>>2]=0;c[f+176>>2]=0;c[f+156>>2]=-3;c[f+184>>2]=0;c[f+188>>2]=0;c[f+192>>2]=0;c[f+196>>2]=0;qE(f+56|0,0,e,f+184|0);c[f+180>>2]=c[f+184>>2];e=c[n>>2]|0;if(e){if(a[m>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[n>>2]=0}e=c[b+4>>2]|0;if((e|0)<0){if((c[b+8>>2]|0)<0){h=c[b+12>>2]|0;if(h){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[h+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=0;c[b+8>>2]=0}do{E=(c[b+12>>2]|0)+(e<<4)|0;c[E+0>>2]=c[f+40>>2];c[E+4>>2]=c[f+44>>2];c[E+8>>2]=c[f+48>>2];c[E+12>>2]=c[f+52>>2];e=e+1|0}while((e|0)!=0)}c[b+4>>2]=0;c[f+24>>2]=0;c[f+28>>2]=0;c[f+32>>2]=0;h=c[b+24>>2]|0;if((h|0)<0){if((c[b+28>>2]|0)<0){e=c[b+32>>2]|0;if(e){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=0;c[b+28>>2]=0}do{e=(c[b+32>>2]|0)+(h*12|0)|0;if(e){c[e+0>>2]=c[f+24>>2];c[e+4>>2]=c[f+28>>2];c[e+8>>2]=c[f+32>>2]}h=h+1|0}while((h|0)!=0)}c[b+24>>2]=0;h=c[b+44>>2]|0;if((h|0)<0){e=c[b+52>>2]|0;if((c[b+48>>2]|0)<0){if(e){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=0;c[b+48>>2]=0;e=0}j=h;do{h=e+(j<<2)|0;if(h)c[h>>2]=0;j=j+1|0}while((j|0)!=0)}c[b+44>>2]=0;e=c[f+180>>2]|0;if((c[e+104>>2]|0)<0){c[e+104>>2]=0;c[5004]=(c[5004]|0)+1;h=fF(23)|0;if(h){c[(h+19&-16)+ -4>>2]=h;p=h+19&-16;if(h+19&-16)c[p>>2]=e}else p=0;j=1;o=1;e=0;while(1){h=c[p+(e<<2)>>2]|0;if((c[h+100>>2]|0)>-1){g[f+232+(c[f+164>>2]<<2)>>2]=+(c[h+88>>2]|0);g[f+232+(c[f+168>>2]<<2)>>2]=+(c[h+92>>2]|0);q=+(c[h+96>>2]|0)}else{q=+tE(h+24|0);q=q/+tE(h+72|0);g[f+232+(c[f+164>>2]<<2)>>2]=q;q=+tE(h+40|0);q=q/+tE(h+72|0);g[f+232+(c[f+168>>2]<<2)>>2]=q;q=+tE(h+56|0);q=q/+tE(h+72|0)}g[f+232+(c[f+160>>2]<<2)>>2]=q;s=+g[f+232>>2]*+g[f+56>>2]+ +g[f+72>>2];q=+g[f+236>>2]*+g[f+60>>2]+ +g[f+76>>2];r=+g[f+240>>2]*+g[f+64>>2]+ +g[f+80>>2];m=c[b+4>>2]|0;do if((m|0)==(c[b+8>>2]|0)){k=(m|0)==0?1:m<<1;if((m|0)>=(k|0))break;if(!k)l=0;else{c[5004]=(c[5004]|0)+1;l=fF((k<<4|3)+16|0)|0;if(!l)l=0;else{c[(l+19&-16)+ -4>>2]=l;l=l+19&-16}m=c[b+4>>2]|0}if((m|0)>0){n=0;do{E=l+(n<<4)|0;D=(c[b+12>>2]|0)+(n<<4)|0;c[E+0>>2]=c[D+0>>2];c[E+4>>2]=c[D+4>>2];c[E+8>>2]=c[D+8>>2];c[E+12>>2]=c[D+12>>2];n=n+1|0}while((n|0)!=(m|0))}m=c[b+12>>2]|0;if(m){if(a[b+16>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[m+ -4>>2]|0)}c[b+12>>2]=0}a[b+16>>0]=1;c[b+12>>2]=l;c[b+8>>2]=k;m=c[b+4>>2]|0}while(0);E=c[b+12>>2]|0;g[E+(m<<4)>>2]=s;g[E+(m<<4)+4>>2]=q;g[E+(m<<4)+8>>2]=r;g[E+(m<<4)+12>>2]=0.0;c[b+4>>2]=(c[b+4>>2]|0)+1;h=c[h+8>>2]|0;if(h){k=h;l=-1;m=-1;do{n=k+20|0;d=c[n>>2]|0;if((d|0)<0){d=c[b+24>>2]|0;c[f+12>>2]=0;c[f+16>>2]=0;c[f+20>>2]=0;z=c[b+28>>2]|0;do if((d|0)==(z|0)){z=(d|0)==0?1:d<<1;if((d|0)>=(z|0)){A=d;z=d;break}if(!z){A=0;D=d}else{c[5004]=(c[5004]|0)+1;A=fF((z*12|3)+16|0)|0;if(!A)A=0;else{c[(A+19&-16)+ -4>>2]=A;A=A+19&-16}D=c[b+24>>2]|0}if((D|0)>0){C=0;do{B=A+(C*12|0)|0;if(B){E=(c[b+32>>2]|0)+(C*12|0)|0;c[B+0>>2]=c[E+0>>2];c[B+4>>2]=c[E+4>>2];c[B+8>>2]=c[E+8>>2]}C=C+1|0}while((C|0)!=(D|0))}B=c[b+32>>2]|0;if(B){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[B+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=A;c[b+28>>2]=z;A=c[b+24>>2]|0}else A=d;while(0);B=(c[b+32>>2]|0)+(A*12|0)|0;if(!B)D=z;else{c[B+0>>2]=c[f+12>>2];c[B+4>>2]=c[f+16>>2];c[B+8>>2]=c[f+20>>2];A=c[b+24>>2]|0;D=c[b+28>>2]|0}z=A+1|0;c[b+24>>2]=z;c[f+0>>2]=0;c[f+4>>2]=0;c[f+8>>2]=0;do if((z|0)==(D|0)){z=(D|0)==0?1:D<<1;if((D|0)>=(z|0))break;if(!z)A=0;else{c[5004]=(c[5004]|0)+1;A=fF((z*12|3)+16|0)|0;if(!A)A=0;else{c[(A+19&-16)+ -4>>2]=A;A=A+19&-16}D=c[b+24>>2]|0}if((D|0)>0){C=0;do{B=A+(C*12|0)|0;if(B){E=(c[b+32>>2]|0)+(C*12|0)|0;c[B+0>>2]=c[E+0>>2];c[B+4>>2]=c[E+4>>2];c[B+8>>2]=c[E+8>>2]}C=C+1|0}while((C|0)!=(D|0))}B=c[b+32>>2]|0;if(B){if(a[b+36>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[B+ -4>>2]|0)}c[b+32>>2]=0}a[b+36>>0]=1;c[b+32>>2]=A;c[b+28>>2]=z;D=c[b+24>>2]|0}else D=z;while(0);z=c[b+32>>2]|0;A=z+(D*12|0)|0;if(A){c[A+0>>2]=c[f+0>>2];c[A+4>>2]=c[f+4>>2];c[A+8>>2]=c[f+8>>2];D=c[b+24>>2]|0;z=c[b+32>>2]|0}c[b+24>>2]=D+1;c[n>>2]=d;c[(c[k+8>>2]|0)+20>>2]=d+1;c[z+(d*12|0)+4>>2]=1;c[z+((d+1|0)*12|0)+4>>2]=-1;A=c[k+12>>2]|0;B=c[A+104>>2]|0;if((B|0)<0){c[A+104>>2]=j;do if((j|0)==(o|0)){B=(o|0)==0?1:o<<1;if((o|0)>=(B|0))break;do if(!B)C=0;else{c[5004]=(c[5004]|0)+1;C=fF((B<<2|3)+16|0)|0;if(!C){C=0;break}c[(C+19&-16)+ -4>>2]=C;C=C+19&-16}while(0);if((o|0)>0){E=0;do{D=C+(E<<2)|0;if(D)c[D>>2]=c[p+(E<<2)>>2];E=E+1|0}while((E|0)!=(o|0))}if(!p){p=C;o=B;break}c[5006]=(c[5006]|0)+1;gF(c[p+ -4>>2]|0);p=C;o=B}while(0);B=p+(j<<2)|0;if(B)c[B>>2]=A;A=j+1|0}else{A=j;j=B}c[z+(d*12|0)+8>>2]=j;c[z+((d+1|0)*12|0)+8>>2]=e;d=c[n>>2]|0;j=A}if((m|0)>-1){c[(c[b+32>>2]|0)+(d*12|0)>>2]=m-d;m=c[n>>2]|0}else{m=d;l=d}k=c[k>>2]|0}while((k|0)!=(h|0));c[(c[b+32>>2]|0)+(l*12|0)>>2]=m-l}h=e+1|0;if((h|0)<(j|0))e=h;else break}if((e|0)>-1){k=0;do{e=c[(c[p+(k<<2)>>2]|0)+8>>2]|0;if(e){j=e;do{l=j+20|0;if((c[l>>2]|0)>-1){d=c[b+44>>2]|0;do if((d|0)==(c[b+48>>2]|0)){m=(d|0)==0?1:d<<1;if((d|0)>=(m|0))break;if(!m)n=0;else{c[5004]=(c[5004]|0)+1;n=fF((m<<2|3)+16|0)|0;if(!n)n=0;else{c[(n+19&-16)+ -4>>2]=n;n=n+19&-16}d=c[b+44>>2]|0}if((d|0)>0){o=0;do{z=n+(o<<2)|0;if(z)c[z>>2]=c[(c[b+52>>2]|0)+(o<<2)>>2];o=o+1|0}while((o|0)!=(d|0))}o=c[b+52>>2]|0;if(o){if(a[b+56>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[o+ -4>>2]|0)}c[b+52>>2]=0}a[b+56>>0]=1;c[b+52>>2]=n;c[b+48>>2]=m;d=c[b+44>>2]|0}while(0);m=(c[b+52>>2]|0)+(d<<2)|0;if(m){c[m>>2]=c[l>>2];d=c[b+44>>2]|0}c[b+44>>2]=d+1;l=j;do{c[l+20>>2]=-1;l=c[(c[l+8>>2]|0)+4>>2]|0}while((l|0)!=(j|0))}j=c[j>>2]|0}while((j|0)!=(e|0))}k=k+1|0}while((k|0)<(h|0))}if(p){c[5006]=(c[5006]|0)+1;gF(c[p+ -4>>2]|0)}}wE(f+56|0);i=f;return}function vE(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0;j=i;i=i+16|0;h=c[a+12>>2]|0;f=c[h+(((d+b|0)/2|0)<<4)>>2]|0;g=c[h+(((d+b|0)/2|0)<<4)+4>>2]|0;e=c[h+(((d+b|0)/2|0)<<4)+8>>2]|0;k=b;l=d;while(1){while(1){m=c[h+(k<<4)+4>>2]|0;if((m|0)>=(g|0)){if((m|0)!=(g|0))break;m=c[h+(k<<4)>>2]|0;if((m|0)>=(f|0)){if((m|0)!=(f|0))break;if((c[h+(k<<4)+8>>2]|0)>=(e|0))break}}k=k+1|0}while(1){m=c[h+(l<<4)+4>>2]|0;if((g|0)>=(m|0)){if((g|0)!=(m|0))break;m=c[h+(l<<4)>>2]|0;if((f|0)>=(m|0)){if((f|0)!=(m|0))break;if((e|0)>=(c[h+(l<<4)+8>>2]|0))break}}l=l+ -1|0}if((k|0)<=(l|0)){m=h+(k<<4)|0;c[j+0>>2]=c[m+0>>2];c[j+4>>2]=c[m+4>>2];c[j+8>>2]=c[m+8>>2];c[j+12>>2]=c[m+12>>2];h=h+(l<<4)|0;c[m+0>>2]=c[h+0>>2];c[m+4>>2]=c[h+4>>2];c[m+8>>2]=c[h+8>>2];c[m+12>>2]=c[h+12>>2];m=(c[a+12>>2]|0)+(l<<4)|0;c[m+0>>2]=c[j+0>>2];c[m+4>>2]=c[j+4>>2];c[m+8>>2]=c[j+8>>2];c[m+12>>2]=c[j+12>>2];k=k+1|0;l=l+ -1|0}if((k|0)>(l|0))break;h=c[a+12>>2]|0}if((l|0)>(b|0))vE(a,b,l);if((k|0)>=(d|0)){i=j;return}vE(a,k,d);i=j;return}function wE(b){b=b|0;var d=0,e=0,f=0;d=i;e=c[b+92>>2]|0;if(e){if(a[b+96>>0]|0){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[b+92>>2]=0}a[b+96>>0]=1;c[b+92>>2]=0;c[b+84>>2]=0;c[b+88>>2]=0;e=c[b+64>>2]|0;if(e)do{c[b+64>>2]=c[e+8>>2];f=c[e>>2]|0;if(f){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);e=c[b+64>>2]|0}while((e|0)!=0);f=c[b+48>>2]|0;if(f)do{c[b+48>>2]=c[f+8>>2];e=c[f>>2]|0;if(e){c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0)}c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0);f=c[b+48>>2]|0}while((f|0)!=0);e=c[b+32>>2]|0;if(!e){i=d;return}do{c[b+32>>2]=c[e+8>>2];f=c[e>>2]|0;if(f){c[5006]=(c[5006]|0)+1;gF(c[f+ -4>>2]|0)}c[5006]=(c[5006]|0)+1;gF(c[e+ -4>>2]|0);e=c[b+32>>2]|0}while((e|0)!=0);i=d;return}function xE(a){a=a|0;var b=0,d=0;b=i;do{c[a+4>>2]=0;g[a+8>>2]=0.0;d=c[a+24>>2]|0;if(d)xE(d);a=c[a+28>>2]|0}while((a|0)!=0);i=b;return}function yE(a){a=a|0;var b=0,d=0,e=0,f=0;b=i;i=i+16|0;d=c[5022]|0;if((c[d>>2]|0)!=(a|0)){f=c[d+24>>2]|0;a:do if(!f)e=5;else while(1){if((c[f>>2]|0)==(a|0)){d=f;break a}f=c[f+28>>2]|0;if(!f){e=5;break}}while(0);if((e|0)==5){e=fF(36)|0;b:do if(!e){while(1){e=c[5158]|0;c[5158]=e+0;if(!e)break;sc[e&3]();e=fF(36)|0;if(e)break b}f=Ab(4)|0;c[f>>2]=20472;yb(f|0,20520,265)}while(0);c[e>>2]=a;a=e+4|0;f=e+20|0;c[a+0>>2]=0;c[a+4>>2]=0;c[a+8>>2]=0;c[a+12>>2]=0;c[f>>2]=d;c[e+24>>2]=0;f=e+28|0;c[f>>2]=0;c[e+32>>2]=0;xE(e);c[f>>2]=c[d+24>>2];c[d+24>>2]=e;d=e}c[5022]=d}e=d+4|0;c[e>>2]=(c[e>>2]|0)+1;e=d+16|0;f=c[e>>2]|0;c[e>>2]=f+1;if(f){i=b;return}Eb(b|0,0)|0;f=c[5008]|0;c[d+12>>2]=(c[b+4>>2]|0)-(c[f+4>>2]|0)+(((c[b>>2]|0)-(c[f>>2]|0)|0)*1e6|0);i=b;return}function zE(){var a=0,b=0;a=i;b=fF(8)|0;a:do if(!b){while(1){b=c[5158]|0;c[5158]=b+0;if(!b)break;sc[b&3]();b=fF(8)|0;if(b)break a}b=Ab(4)|0;c[b>>2]=20472;yb(b|0,20520,265)}while(0);c[5008]=b;Eb(b|0,0)|0;c[5010]=20080;c[5011]=0;c[5012]=0;c[5013]=0;c[5014]=0;c[5015]=0;c[5016]=0;c[5017]=0;c[5018]=0;xE(20040);i=a;return}function AE(a,b){a=a|0;b=b|0;var d=0;d=i;i=i+16|0;c[d>>2]=b;b=c[o>>2]|0;_a(b|0,a|0,d|0)|0;xb(10,b|0)|0;zb()}function BE(){var a=0,b=0,d=0,e=0;a=i;i=i+16|0;if(sb(20288,3)|0)AE(20296,a);b=pb(c[5070]|0)|0;if(!b)AE(20264,a);b=c[b>>2]|0;if(!b)AE(20264,a);d=c[b+48>>2]|0;e=c[b+52>>2]|0;if(!((d&-256|0)==1126902528&(e|0)==1129074247)){c[a>>2]=20112;AE(20224,a)}if((d|0)==1126902529&(e|0)==1129074247)d=c[b+44>>2]|0;else d=b+80|0;c[a+12>>2]=d;e=c[b>>2]|0;b=c[e+4>>2]|0;if(PE(20656,e,a+12|0)|0){e=c[a+12>>2]|0;e=Pb[c[(c[e>>2]|0)+8>>2]&127](e)|0;c[a>>2]=20112;c[a+4>>2]=b;c[a+8>>2]=e;AE(20128,a)}else{c[a>>2]=20112;c[a+4>>2]=b;AE(20176,a)}}function CE(){var a=0;a=i;i=i+16|0;if(!(tb(20280,273)|0)){i=a;return}else AE(20352,a)}function DE(a){a=a|0;var b=0;b=i;i=i+16|0;gF(a);if(!(wb(c[5070]|0,0)|0)){i=b;return}else AE(20408,b)}function EE(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function FE(a){a=a|0;return}function GE(a){a=a|0;return 20488}function HE(a){a=a|0;var b=0;b=i;i=i+16|0;sc[a&3]();AE(20536,b)}function IE(){var a=0,b=0;b=i;i=i+16|0;if(sb(20288,3)|0)AE(20296,b);b=pb(c[5070]|0)|0;if(((b|0)!=0?(a=c[b>>2]|0,(a|0)!=0):0)?(c[a+52>>2]|0)==1129074247?(c[a+48>>2]&-256|0)==1126902528:0:0)HE(c[a+12>>2]|0);b=c[5026]|0;c[5026]=b+0;HE(b)}function JE(a){a=a|0;return}function KE(a){a=a|0;return}function LE(a){a=a|0;return}function ME(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function NE(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function OE(a){a=a|0;var b=0;b=i;gF(a);i=b;return}function PE(a,b,d){a=a|0;b=b|0;d=d|0;var e=0,f=0,g=0;e=i;i=i+64|0;if((a|0)==(b|0)){g=1;i=e;return g|0}if(!b){g=0;i=e;return g|0}b=VE(b,20784)|0;if(!b){g=0;i=e;return g|0}g=e+0|0;f=g+56|0;do{c[g>>2]=0;g=g+4|0}while((g|0)<(f|0));c[e>>2]=b;c[e+8>>2]=a;c[e+12>>2]=-1;c[e+48>>2]=1;vc[c[(c[b>>2]|0)+28>>2]&127](b,e,c[d>>2]|0,1);if((c[e+24>>2]|0)!=1){g=0;i=e;return g|0}c[d>>2]=c[e+16>>2];g=1;i=e;return g|0}function QE(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0;f=i;g=c[b+16>>2]|0;if(!g){c[b+16>>2]=d;c[b+24>>2]=e;c[b+36>>2]=1;i=f;return}if((g|0)!=(d|0)){c[b+36>>2]=(c[b+36>>2]|0)+1;c[b+24>>2]=2;a[b+54>>0]=1;i=f;return}if((c[b+24>>2]|0)!=2){i=f;return}c[b+24>>2]=e;i=f;return}function RE(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;if((c[b+8>>2]|0)!=(a|0)){i=f;return}QE(b,d,e);i=f;return}function SE(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;if((a|0)==(c[b+8>>2]|0)){QE(b,d,e);i=f;return}else{a=c[a+8>>2]|0;vc[c[(c[a>>2]|0)+28>>2]&127](a,b,d,e);i=f;return}}function TE(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0;f=i;g=c[a+4>>2]|0;if(!(g&1))h=g>>8;else h=c[(c[d>>2]|0)+(g>>8)>>2]|0;a=c[a>>2]|0;vc[c[(c[a>>2]|0)+28>>2]&127](a,b,d+h|0,(g&2|0)!=0?e:2);i=f;return}function UE(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0;g=i;if((b|0)==(c[d+8>>2]|0)){QE(d,e,f);i=g;return}h=c[b+12>>2]|0;TE(b+16|0,d,e,f);if((h|0)<=1){i=g;return}j=b+24|0;while(1){TE(j,d,e,f);if(a[d+54>>0]|0){f=7;break}j=j+8|0;if(j>>>0>=(b+(h<<3)+16|0)>>>0){f=7;break}}if((f|0)==7){i=g;return}}function VE(d,e){d=d|0;e=e|0;var f=0,g=0,h=0,j=0;f=i;i=i+64|0;g=c[d>>2]|0;h=d+(c[g+ -8>>2]|0)|0;g=c[g+ -4>>2]|0;c[f>>2]=e;c[f+4>>2]=d;c[f+8>>2]=20728;j=f+12|0;d=j+40|0;do{c[j>>2]=0;j=j+4|0}while((j|0)<(d|0));b[f+52>>1]=0;a[f+54>>0]=0;do if((g|0)==(e|0)){c[f+48>>2]=1;Zb[c[(c[g>>2]|0)+20>>2]&7](g,f,h,h,1,0);e=(c[f+24>>2]|0)==1?h:0}else{Jb[c[(c[g>>2]|0)+24>>2]&31](g,f,h,1,0);e=c[f+36>>2]|0;if(!e){if((c[f+40>>2]|0)!=1){e=0;break}if((c[f+28>>2]|0)!=1){e=0;break}e=(c[f+32>>2]|0)==1?c[f+20>>2]|0:0;break}else if((e|0)!=1){e=0;break}if((c[f+24>>2]|0)!=1){if(c[f+40>>2]|0){e=0;break}if((c[f+28>>2]|0)!=1){e=0;break}if((c[f+32>>2]|0)!=1){e=0;break}}e=c[f+16>>2]|0}while(0);i=f;return e|0}function WE(b,d,e,f){b=b|0;d=d|0;e=e|0;f=f|0;var g=0;g=i;a[b+53>>0]=1;if((c[b+4>>2]|0)!=(e|0)){i=g;return}a[b+52>>0]=1;e=c[b+16>>2]|0;if(!e){c[b+16>>2]=d;c[b+24>>2]=f;c[b+36>>2]=1;if(!((f|0)==1?(c[b+48>>2]|0)==1:0)){i=g;return}a[b+54>>0]=1;i=g;return}if((e|0)!=(d|0)){c[b+36>>2]=(c[b+36>>2]|0)+1;a[b+54>>0]=1;i=g;return}d=c[b+24>>2]|0;if((d|0)==2)c[b+24>>2]=f;else f=d;if(!((f|0)==1?(c[b+48>>2]|0)==1:0)){i=g;return}a[b+54>>0]=1;i=g;return}function XE(b,d,e,f,g){b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0,j=0,k=0,l=0,m=0,n=0,o=0;k=i;if((b|0)==(c[d+8>>2]|0)){if((c[d+4>>2]|0)!=(e|0)){i=k;return}if((c[d+28>>2]|0)==1){i=k;return}c[d+28>>2]=f;i=k;return}if((b|0)!=(c[d>>2]|0)){l=c[b+12>>2]|0;ZE(b+16|0,d,e,f,g);if((l|0)<=1){i=k;return}m=c[b+8>>2]|0;if((m&2|0)==0?(c[d+36>>2]|0)!=1:0){if(!(m&1)){m=b+24|0;while(1){if(a[d+54>>0]|0){m=43;break}if((c[d+36>>2]|0)==1){m=43;break}ZE(m,d,e,f,g);m=m+8|0;if(m>>>0>=(b+(l<<3)+16|0)>>>0){m=43;break}}if((m|0)==43){i=k;return}}m=b+24|0;while(1){if(a[d+54>>0]|0){m=43;break}if((c[d+36>>2]|0)==1?(c[d+24>>2]|0)==1:0){m=43;break}ZE(m,d,e,f,g);m=m+8|0;if(m>>>0>=(b+(l<<3)+16|0)>>>0){m=43;break}}if((m|0)==43){i=k;return}}m=b+24|0;while(1){if(a[d+54>>0]|0){m=43;break}ZE(m,d,e,f,g);m=m+8|0;if(m>>>0>=(b+(l<<3)+16|0)>>>0){m=43;break}}if((m|0)==43){i=k;return}}if((c[d+16>>2]|0)!=(e|0)?(c[d+20>>2]|0)!=(e|0):0){c[d+32>>2]=f;if((c[d+44>>2]|0)==4){i=k;return}n=c[b+12>>2]|0;a:do if((n|0)>0){o=0;m=0;l=b+16|0;b:do{a[d+52>>0]=0;a[d+53>>0]=0;YE(l,d,e,e,1,g);if(a[d+54>>0]|0)break;do if(a[d+53>>0]|0){if(!(a[d+52>>0]|0))if(!(c[b+8>>2]&1)){m=1;break b}else{m=1;break}if((c[d+24>>2]|0)==1){m=25;break a}if(!(c[b+8>>2]&2)){m=25;break a}else{o=1;m=1}}while(0);l=l+8|0}while(l>>>0<(b+(n<<3)+16|0)>>>0);if(o){j=m;m=24}else{h=m;m=21}}else{h=0;m=21}while(0);if((m|0)==21){c[d+20>>2]=e;c[d+40>>2]=(c[d+40>>2]|0)+1;if((c[d+36>>2]|0)==1?(c[d+24>>2]|0)==2:0){a[d+54>>0]=1;if(h)m=25;else m=26}else{j=h;m=24}}if((m|0)==24)if(j)m=25;else m=26;if((m|0)==25){c[d+44>>2]=3;i=k;return}else if((m|0)==26){c[d+44>>2]=4;i=k;return}}if((f|0)!=1){i=k;return}c[d+32>>2]=1;i=k;return}function YE(a,b,d,e,f,g){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0,j=0,k=0;h=i;j=c[a+4>>2]|0;if(!(j&1))k=j>>8;else k=c[(c[e>>2]|0)+(j>>8)>>2]|0;a=c[a>>2]|0;Zb[c[(c[a>>2]|0)+20>>2]&7](a,b,d,e+k|0,(j&2|0)!=0?f:2,g);i=h;return}function ZE(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,j=0;g=i;h=c[a+4>>2]|0;if(!(h&1))j=h>>8;else j=c[(c[d>>2]|0)+(h>>8)>>2]|0;a=c[a>>2]|0;Jb[c[(c[a>>2]|0)+24>>2]&31](a,b,d+j|0,(h&2|0)!=0?e:2,f);i=g;return}function _E(b,d,e,f,g){b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0,j=0;h=i;if((b|0)==(c[d+8>>2]|0)){if((c[d+4>>2]|0)!=(e|0)){i=h;return}if((c[d+28>>2]|0)==1){i=h;return}c[d+28>>2]=f;i=h;return}if((b|0)!=(c[d>>2]|0)){b=c[b+8>>2]|0;Jb[c[(c[b>>2]|0)+24>>2]&31](b,d,e,f,g);i=h;return}if((c[d+16>>2]|0)!=(e|0)?(c[d+20>>2]|0)!=(e|0):0){c[d+32>>2]=f;if((c[d+44>>2]|0)==4){i=h;return}a[d+52>>0]=0;a[d+53>>0]=0;b=c[b+8>>2]|0;Zb[c[(c[b>>2]|0)+20>>2]&7](b,d,e,e,1,g);if(a[d+53>>0]|0){if(!(a[d+52>>0]|0)){f=1;j=13}}else{f=0;j=13}do if((j|0)==13){c[d+20>>2]=e;c[d+40>>2]=(c[d+40>>2]|0)+1;if((c[d+36>>2]|0)==1?(c[d+24>>2]|0)==2:0){a[d+54>>0]=1;if(f)break}else j=16;if((j|0)==16?f:0)break;c[d+44>>2]=4;i=h;return}while(0);c[d+44>>2]=3;i=h;return}if((f|0)!=1){i=h;return}c[d+32>>2]=1;i=h;return}function $E(b,d,e,f,g){b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;g=i;if((c[d+8>>2]|0)==(b|0)){if((c[d+4>>2]|0)!=(e|0)){i=g;return}if((c[d+28>>2]|0)==1){i=g;return}c[d+28>>2]=f;i=g;return}if((c[d>>2]|0)!=(b|0)){i=g;return}if((c[d+16>>2]|0)!=(e|0)?(c[d+20>>2]|0)!=(e|0):0){c[d+32>>2]=f;c[d+20>>2]=e;c[d+40>>2]=(c[d+40>>2]|0)+1;if((c[d+36>>2]|0)==1?(c[d+24>>2]|0)==2:0)a[d+54>>0]=1;c[d+44>>2]=4;i=g;return}if((f|0)!=1){i=g;return}c[d+32>>2]=1;i=g;return}function aF(b,d,e,f,g,h){b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;var j=0,k=0,l=0,m=0,n=0;j=i;if((b|0)==(c[d+8>>2]|0)){WE(d,e,f,g);i=j;return}k=a[d+52>>0]|0;l=a[d+53>>0]|0;m=c[b+12>>2]|0;a[d+52>>0]=0;a[d+53>>0]=0;YE(b+16|0,d,e,f,g,h);a:do if((m|0)>1){n=b+24|0;do{if(a[d+54>>0]|0)break a;if(!(a[d+52>>0]|0)){if((a[d+53>>0]|0)!=0?(c[b+8>>2]&1|0)==0:0)break a}else{if((c[d+24>>2]|0)==1)break a;if(!(c[b+8>>2]&2))break a}a[d+52>>0]=0;a[d+53>>0]=0;YE(n,d,e,f,g,h);n=n+8|0}while(n>>>0<(b+(m<<3)+16|0)>>>0)}while(0);a[d+52>>0]=k;a[d+53>>0]=l;i=j;return}function bF(a,b,d,e,f,g){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;var h=0;h=i;if((a|0)==(c[b+8>>2]|0)){WE(b,d,e,f);i=h;return}else{a=c[a+8>>2]|0;Zb[c[(c[a>>2]|0)+20>>2]&7](a,b,d,e,f,g);i=h;return}}function cF(a,b,d,e,f,g){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;g=g|0;g=i;if((c[b+8>>2]|0)!=(a|0)){i=g;return}WE(b,d,e,f);i=g;return}function dF(a,b,d){a=a|0;b=b|0;d=d|0;var e=0;e=i;i=i+16|0;c[e>>2]=c[d>>2];b=Yb[c[(c[a>>2]|0)+16>>2]&31](a,b,e)|0;if(!b){i=e;return b&1|0}c[d>>2]=c[e>>2];i=e;return b&1|0}function eF(a){a=a|0;var b=0;b=i;if(!a)a=0;else a=(VE(a,20896)|0)!=0;i=b;return a&1|0}



function fF(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=0,E=0;b=i;do if(a>>>0<245){if(a>>>0<11)o=16;else o=a+11&-8;u=o>>>3;p=c[5286]|0;if(p>>>u&3){e=c[21184+(((p>>>u&1^1)+u<<1)+2<<2)>>2]|0;d=c[e+8>>2]|0;do if((21184+((p>>>u&1^1)+u<<1<<2)|0)!=(d|0)){if(d>>>0<(c[5290]|0)>>>0)zb();if((c[d+12>>2]|0)==(e|0)){c[d+12>>2]=21184+((p>>>u&1^1)+u<<1<<2);c[21184+(((p>>>u&1^1)+u<<1)+2<<2)>>2]=d;break}else zb()}else c[5286]=p&~(1<<(p>>>u&1^1)+u);while(0);c[e+4>>2]=(p>>>u&1^1)+u<<3|3;c[e+((p>>>u&1^1)+u<<3|4)>>2]=c[e+((p>>>u&1^1)+u<<3|4)>>2]|1;E=e+8|0;i=b;return E|0}if(o>>>0>(c[5288]|0)>>>0){if(p>>>u){e=(p>>>u<<u&(2<<u|0-(2<<u))&0-(p>>>u<<u&(2<<u|0-(2<<u))))+ -1|0;d=e>>>(e>>>12&16)>>>(e>>>(e>>>12&16)>>>5&8);g=d>>>(d>>>2&4)>>>(d>>>(d>>>2&4)>>>1&2);g=(e>>>(e>>>12&16)>>>5&8|e>>>12&16|d>>>2&4|d>>>(d>>>2&4)>>>1&2|g>>>1&1)+(g>>>(g>>>1&1))|0;d=c[21184+((g<<1)+2<<2)>>2]|0;e=c[d+8>>2]|0;do if((21184+(g<<1<<2)|0)!=(e|0)){if(e>>>0<(c[5290]|0)>>>0)zb();if((c[e+12>>2]|0)==(d|0)){c[e+12>>2]=21184+(g<<1<<2);c[21184+((g<<1)+2<<2)>>2]=e;break}else zb()}else c[5286]=p&~(1<<g);while(0);f=(g<<3)-o|0;c[d+4>>2]=o|3;e=d+o|0;c[d+(o|4)>>2]=f|1;c[d+(g<<3)>>2]=f;h=c[5288]|0;if(h){g=c[5291]|0;j=c[5286]|0;if(j&1<<(h>>>3)){j=c[21184+((h>>>3<<1)+2<<2)>>2]|0;if(j>>>0<(c[5290]|0)>>>0)zb();else{C=21184+((h>>>3<<1)+2<<2)|0;B=j}}else{c[5286]=j|1<<(h>>>3);C=21184+((h>>>3<<1)+2<<2)|0;B=21184+(h>>>3<<1<<2)|0}c[C>>2]=g;c[B+12>>2]=g;c[g+8>>2]=B;c[g+12>>2]=21184+(h>>>3<<1<<2)}c[5288]=f;c[5291]=e;E=d+8|0;i=b;return E|0}p=c[5287]|0;if(p){e=((p&0-p)+ -1|0)>>>(((p&0-p)+ -1|0)>>>12&16);d=e>>>(e>>>5&8)>>>(e>>>(e>>>5&8)>>>2&4);d=c[21448+((e>>>5&8|((p&0-p)+ -1|0)>>>12&16|e>>>(e>>>5&8)>>>2&4|d>>>1&2|d>>>(d>>>1&2)>>>1&1)+(d>>>(d>>>1&2)>>>(d>>>(d>>>1&2)>>>1&1))<<2)>>2]|0;e=(c[d+4>>2]&-8)-o|0;f=d;while(1){g=c[f+16>>2]|0;if(!g){g=c[f+20>>2]|0;if(!g)break}f=(c[g+4>>2]&-8)-o|0;E=f>>>0<e>>>0;e=E?f:e;f=g;d=E?g:d}h=c[5290]|0;if(d>>>0<h>>>0)zb();f=d+o|0;if(d>>>0>=f>>>0)zb();g=c[d+24>>2]|0;j=c[d+12>>2]|0;do if((j|0)==(d|0)){k=d+20|0;j=c[k>>2]|0;if(!j){k=d+16|0;j=c[k>>2]|0;if(!j){A=0;break}}while(1){l=j+20|0;m=c[l>>2]|0;if(m){j=m;k=l;continue}m=j+16|0;l=c[m>>2]|0;if(!l)break;else{j=l;k=m}}if(k>>>0<h>>>0)zb();else{c[k>>2]=0;A=j;break}}else{k=c[d+8>>2]|0;if(k>>>0<h>>>0)zb();if((c[k+12>>2]|0)!=(d|0))zb();if((c[j+8>>2]|0)==(d|0)){c[k+12>>2]=j;c[j+8>>2]=k;A=j;break}else zb()}while(0);do if(g){h=c[d+28>>2]|0;if((d|0)==(c[21448+(h<<2)>>2]|0)){c[21448+(h<<2)>>2]=A;if(!A){c[5287]=c[5287]&~(1<<h);break}}else{if(g>>>0<(c[5290]|0)>>>0)zb();if((c[g+16>>2]|0)==(d|0))c[g+16>>2]=A;else c[g+20>>2]=A;if(!A)break}if(A>>>0<(c[5290]|0)>>>0)zb();c[A+24>>2]=g;g=c[d+16>>2]|0;do if(g)if(g>>>0<(c[5290]|0)>>>0)zb();else{c[A+16>>2]=g;c[g+24>>2]=A;break}while(0);g=c[d+20>>2]|0;if(g)if(g>>>0<(c[5290]|0)>>>0)zb();else{c[A+20>>2]=g;c[g+24>>2]=A;break}}while(0);if(e>>>0<16){E=e+o|0;c[d+4>>2]=E|3;E=d+(E+4)|0;c[E>>2]=c[E>>2]|1}else{c[d+4>>2]=o|3;c[d+(o|4)>>2]=e|1;c[d+(e+o)>>2]=e;g=c[5288]|0;if(g){h=c[5291]|0;j=c[5286]|0;if(j&1<<(g>>>3)){j=c[21184+((g>>>3<<1)+2<<2)>>2]|0;if(j>>>0<(c[5290]|0)>>>0)zb();else{z=21184+((g>>>3<<1)+2<<2)|0;y=j}}else{c[5286]=j|1<<(g>>>3);z=21184+((g>>>3<<1)+2<<2)|0;y=21184+(g>>>3<<1<<2)|0}c[z>>2]=h;c[y+12>>2]=h;c[h+8>>2]=y;c[h+12>>2]=21184+(g>>>3<<1<<2)}c[5288]=e;c[5291]=f}E=d+8|0;i=b;return E|0}}}else if(a>>>0<=4294967231){o=a+11&-8;A=c[5287]|0;if(A){if((a+11|0)>>>8)if(o>>>0>16777215)B=31;else{B=(a+11|0)>>>8<<((((a+11|0)>>>8)+1048320|0)>>>16&8);B=14-((B+520192|0)>>>16&4|(((a+11|0)>>>8)+1048320|0)>>>16&8|((B<<((B+520192|0)>>>16&4))+245760|0)>>>16&2)+(B<<((B+520192|0)>>>16&4)<<(((B<<((B+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;B=o>>>(B+7|0)&1|B<<1}else B=0;C=c[21448+(B<<2)>>2]|0;a:do if(!C){z=0-o|0;a=0;y=0}else{if((B|0)==31)y=0;else y=25-(B>>>1)|0;z=0-o|0;a=0;D=o<<y;y=0;while(1){E=c[C+4>>2]&-8;if((E-o|0)>>>0<z>>>0)if((E|0)==(o|0)){z=E-o|0;a=C;y=C;break a}else{z=E-o|0;y=C}E=c[C+20>>2]|0;C=c[C+(D>>>31<<2)+16>>2]|0;a=(E|0)==0|(E|0)==(C|0)?a:E;if(!C)break;else D=D<<1}}while(0);if((a|0)==0&(y|0)==0){B=2<<B;if(!(A&(B|0-B)))break;D=(A&(B|0-B)&0-(A&(B|0-B)))+ -1|0;E=D>>>(D>>>12&16)>>>(D>>>(D>>>12&16)>>>5&8);a=E>>>(E>>>2&4)>>>(E>>>(E>>>2&4)>>>1&2);a=c[21448+((D>>>(D>>>12&16)>>>5&8|D>>>12&16|E>>>2&4|E>>>(E>>>2&4)>>>1&2|a>>>1&1)+(a>>>(a>>>1&1))<<2)>>2]|0}if(a)while(1){E=(c[a+4>>2]&-8)-o|0;A=E>>>0<z>>>0;z=A?E:z;y=A?a:y;A=c[a+16>>2]|0;if(A){a=A;continue}a=c[a+20>>2]|0;if(!a)break}if((y|0)!=0?z>>>0<((c[5288]|0)-o|0)>>>0:0){f=c[5290]|0;if(y>>>0<f>>>0)zb();d=y+o|0;if(y>>>0>=d>>>0)zb();e=c[y+24>>2]|0;g=c[y+12>>2]|0;do if((g|0)==(y|0)){h=y+20|0;g=c[h>>2]|0;if(!g){h=y+16|0;g=c[h>>2]|0;if(!g){x=0;break}}while(1){k=g+20|0;j=c[k>>2]|0;if(j){g=j;h=k;continue}k=g+16|0;j=c[k>>2]|0;if(!j)break;else{g=j;h=k}}if(h>>>0<f>>>0)zb();else{c[h>>2]=0;x=g;break}}else{h=c[y+8>>2]|0;if(h>>>0<f>>>0)zb();if((c[h+12>>2]|0)!=(y|0))zb();if((c[g+8>>2]|0)==(y|0)){c[h+12>>2]=g;c[g+8>>2]=h;x=g;break}else zb()}while(0);do if(e){f=c[y+28>>2]|0;if((y|0)==(c[21448+(f<<2)>>2]|0)){c[21448+(f<<2)>>2]=x;if(!x){c[5287]=c[5287]&~(1<<f);break}}else{if(e>>>0<(c[5290]|0)>>>0)zb();if((c[e+16>>2]|0)==(y|0))c[e+16>>2]=x;else c[e+20>>2]=x;if(!x)break}if(x>>>0<(c[5290]|0)>>>0)zb();c[x+24>>2]=e;e=c[y+16>>2]|0;do if(e)if(e>>>0<(c[5290]|0)>>>0)zb();else{c[x+16>>2]=e;c[e+24>>2]=x;break}while(0);e=c[y+20>>2]|0;if(e)if(e>>>0<(c[5290]|0)>>>0)zb();else{c[x+20>>2]=e;c[e+24>>2]=x;break}}while(0);b:do if(z>>>0>=16){c[y+4>>2]=o|3;c[y+(o|4)>>2]=z|1;c[y+(z+o)>>2]=z;e=z>>>3;if(z>>>0<256){f=c[5286]|0;do if(!(f&1<<e)){c[5286]=f|1<<e;v=21184+((e<<1)+2<<2)|0;u=21184+(e<<1<<2)|0}else{f=c[21184+((e<<1)+2<<2)>>2]|0;if(f>>>0>=(c[5290]|0)>>>0){v=21184+((e<<1)+2<<2)|0;u=f;break}zb()}while(0);c[v>>2]=d;c[u+12>>2]=d;c[y+(o+8)>>2]=u;c[y+(o+12)>>2]=21184+(e<<1<<2);break}e=z>>>8;if(e)if(z>>>0>16777215)e=31;else{E=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(E+245760|0)>>>16&2)+(E<<((E+245760|0)>>>16&2)>>>15)|0;e=z>>>(e+7|0)&1|e<<1}else e=0;f=21448+(e<<2)|0;c[y+(o+28)>>2]=e;c[y+(o+20)>>2]=0;c[y+(o+16)>>2]=0;h=c[5287]|0;g=1<<e;if(!(h&g)){c[5287]=h|g;c[f>>2]=d;c[y+(o+24)>>2]=f;c[y+(o+12)>>2]=d;c[y+(o+8)>>2]=d;break}f=c[f>>2]|0;if((e|0)==31)e=0;else e=25-(e>>>1)|0;c:do if((c[f+4>>2]&-8|0)!=(z|0)){e=z<<e;while(1){g=f+(e>>>31<<2)+16|0;h=c[g>>2]|0;if(!h)break;if((c[h+4>>2]&-8|0)==(z|0)){p=h;break c}else{e=e<<1;f=h}}if(g>>>0<(c[5290]|0)>>>0)zb();else{c[g>>2]=d;c[y+(o+24)>>2]=f;c[y+(o+12)>>2]=d;c[y+(o+8)>>2]=d;break b}}else p=f;while(0);e=p+8|0;f=c[e>>2]|0;g=c[5290]|0;if(p>>>0<g>>>0)zb();if(f>>>0<g>>>0)zb();else{c[f+12>>2]=d;c[e>>2]=d;c[y+(o+8)>>2]=f;c[y+(o+12)>>2]=p;c[y+(o+24)>>2]=0;break}}else{E=z+o|0;c[y+4>>2]=E|3;E=y+(E+4)|0;c[E>>2]=c[E>>2]|1}while(0);E=y+8|0;i=b;return E|0}}}else o=-1;while(0);p=c[5288]|0;if(o>>>0<=p>>>0){d=p-o|0;e=c[5291]|0;if(d>>>0>15){c[5291]=e+o;c[5288]=d;c[e+(o+4)>>2]=d|1;c[e+p>>2]=d;c[e+4>>2]=o|3}else{c[5288]=0;c[5291]=0;c[e+4>>2]=p|3;c[e+(p+4)>>2]=c[e+(p+4)>>2]|1}E=e+8|0;i=b;return E|0}p=c[5289]|0;if(o>>>0<p>>>0){D=p-o|0;c[5289]=D;E=c[5292]|0;c[5292]=E+o;c[E+(o+4)>>2]=D|1;c[E+4>>2]=o|3;E=E+8|0;i=b;return E|0}do if(!(c[5404]|0)){p=nb(30)|0;if(!(p+ -1&p)){c[5406]=p;c[5405]=p;c[5407]=-1;c[5408]=-1;c[5409]=0;c[5397]=0;c[5404]=(Cb(0)|0)&-16^1431655768;break}else zb()}while(0);v=o+48|0;p=c[5406]|0;x=o+47|0;u=p+x&0-p;if(u>>>0<=o>>>0){E=0;i=b;return E|0}y=c[5396]|0;if((y|0)!=0?(E=c[5394]|0,(E+u|0)>>>0<=E>>>0|(E+u|0)>>>0>y>>>0):0){E=0;i=b;return E|0}d:do if(!(c[5397]&4)){y=c[5292]|0;e:do if(y){z=21592|0;while(1){A=c[z>>2]|0;if(A>>>0<=y>>>0?(w=z+4|0,(A+(c[w>>2]|0)|0)>>>0>y>>>0):0)break;z=c[z+8>>2]|0;if(!z){n=182;break e}}if(z){A=p+x-(c[5289]|0)&0-p;if(A>>>0<2147483647){p=gb(A|0)|0;z=(p|0)==((c[z>>2]|0)+(c[w>>2]|0)|0);w=p;y=A;p=z?p:-1;z=z?A:0;n=191}else z=0}else n=182}else n=182;while(0);do if((n|0)==182){z=gb(0)|0;if((z|0)!=(-1|0)){p=c[5405]|0;if(!(p+ -1&z))A=u;else A=u-z+(p+ -1+z&0-p)|0;w=c[5394]|0;p=w+A|0;if(A>>>0>o>>>0&A>>>0<2147483647){E=c[5396]|0;if((E|0)!=0?p>>>0<=w>>>0|p>>>0>E>>>0:0){z=0;break}n=gb(A|0)|0;w=n;y=A;p=(n|0)==(z|0)?z:-1;z=(n|0)==(z|0)?A:0;n=191}else z=0}else z=0}while(0);f:do if((n|0)==191){n=0-y|0;if((p|0)!=(-1|0)){q=z;n=202;break d}do if((w|0)!=(-1|0)&y>>>0<2147483647&y>>>0<v>>>0?(t=c[5406]|0,t=x-y+t&0-t,t>>>0<2147483647):0)if((gb(t|0)|0)==(-1|0)){gb(n|0)|0;break f}else{y=t+y|0;break}while(0);if((w|0)!=(-1|0)){p=w;q=y;n=202;break d}}while(0);c[5397]=c[5397]|4;n=199}else{z=0;n=199}while(0);if((((n|0)==199?u>>>0<2147483647:0)?(s=gb(u|0)|0,r=gb(0)|0,(r|0)!=(-1|0)&(s|0)!=(-1|0)&s>>>0<r>>>0):0)?(q=(r-s|0)>>>0>(o+40|0)>>>0,q):0){p=s;q=q?r-s|0:z;n=202}if((n|0)==202){r=(c[5394]|0)+q|0;c[5394]=r;if(r>>>0>(c[5395]|0)>>>0)c[5395]=r;r=c[5292]|0;g:do if(r){w=21592|0;while(1){t=c[w>>2]|0;u=w+4|0;v=c[u>>2]|0;if((p|0)==(t+v|0)){n=214;break}s=c[w+8>>2]|0;if(!s)break;else w=s}if(((n|0)==214?(c[w+12>>2]&8|0)==0:0)?r>>>0>=t>>>0&r>>>0<p>>>0:0){c[u>>2]=v+q;e=(c[5289]|0)+q|0;if(!(r+8&7))d=0;else d=0-(r+8)&7;E=e-d|0;c[5292]=r+d;c[5289]=E;c[r+(d+4)>>2]=E|1;c[r+(e+4)>>2]=40;c[5293]=c[5408];break}if(p>>>0<(c[5290]|0)>>>0)c[5290]=p;t=p+q|0;s=21592|0;while(1){if((c[s>>2]|0)==(t|0)){n=224;break}u=c[s+8>>2]|0;if(!u)break;else s=u}if((n|0)==224?(c[s+12>>2]&8|0)==0:0){c[s>>2]=p;h=s+4|0;c[h>>2]=(c[h>>2]|0)+q;h=p+8|0;if(!(h&7))h=0;else h=0-h&7;k=p+(q+8)|0;if(!(k&7))r=0;else r=0-k&7;s=p+(r+q)|0;k=h+o|0;l=p+k|0;m=s-(p+h)-o|0;c[p+(h+4)>>2]=o|3;h:do if((s|0)!=(c[5292]|0)){if((s|0)==(c[5291]|0)){E=(c[5288]|0)+m|0;c[5288]=E;c[5291]=l;c[p+(k+4)>>2]=E|1;c[p+(E+k)>>2]=E;break}o=q+4|0;n=c[p+(o+r)>>2]|0;if((n&3|0)==1){i:do if(n>>>0>=256){j=c[p+((r|24)+q)>>2]|0;u=c[p+(q+12+r)>>2]|0;do if((u|0)==(s|0)){v=r|16;u=p+(o+v)|0;t=c[u>>2]|0;if(!t){u=p+(v+q)|0;t=c[u>>2]|0;if(!t){g=0;break}}while(1){v=t+20|0;w=c[v>>2]|0;if(w){t=w;u=v;continue}v=t+16|0;w=c[v>>2]|0;if(!w)break;else{t=w;u=v}}if(u>>>0<(c[5290]|0)>>>0)zb();else{c[u>>2]=0;g=t;break}}else{t=c[p+((r|8)+q)>>2]|0;if(t>>>0<(c[5290]|0)>>>0)zb();if((c[t+12>>2]|0)!=(s|0))zb();if((c[u+8>>2]|0)==(s|0)){c[t+12>>2]=u;c[u+8>>2]=t;g=u;break}else zb()}while(0);if(!j)break;t=c[p+(q+28+r)>>2]|0;do if((s|0)!=(c[21448+(t<<2)>>2]|0)){if(j>>>0<(c[5290]|0)>>>0)zb();if((c[j+16>>2]|0)==(s|0))c[j+16>>2]=g;else c[j+20>>2]=g;if(!g)break i}else{c[21448+(t<<2)>>2]=g;if(g)break;c[5287]=c[5287]&~(1<<t);break i}while(0);if(g>>>0<(c[5290]|0)>>>0)zb();c[g+24>>2]=j;j=r|16;s=c[p+(j+q)>>2]|0;do if(s)if(s>>>0<(c[5290]|0)>>>0)zb();else{c[g+16>>2]=s;c[s+24>>2]=g;break}while(0);j=c[p+(o+j)>>2]|0;if(!j)break;if(j>>>0<(c[5290]|0)>>>0)zb();else{c[g+20>>2]=j;c[j+24>>2]=g;break}}else{g=c[p+((r|8)+q)>>2]|0;o=c[p+(q+12+r)>>2]|0;do if((g|0)!=(21184+(n>>>3<<1<<2)|0)){if(g>>>0<(c[5290]|0)>>>0)zb();if((c[g+12>>2]|0)==(s|0))break;zb()}while(0);if((o|0)==(g|0)){c[5286]=c[5286]&~(1<<(n>>>3));break}do if((o|0)==(21184+(n>>>3<<1<<2)|0))j=o+8|0;else{if(o>>>0<(c[5290]|0)>>>0)zb();if((c[o+8>>2]|0)==(s|0)){j=o+8|0;break}zb()}while(0);c[g+12>>2]=o;c[j>>2]=g}while(0);s=p+((n&-8|r)+q)|0;m=(n&-8)+m|0}g=s+4|0;c[g>>2]=c[g>>2]&-2;c[p+(k+4)>>2]=m|1;c[p+(m+k)>>2]=m;g=m>>>3;if(m>>>0<256){d=c[5286]|0;do if(!(d&1<<g)){c[5286]=d|1<<g;f=21184+((g<<1)+2<<2)|0;e=21184+(g<<1<<2)|0}else{d=c[21184+((g<<1)+2<<2)>>2]|0;if(d>>>0>=(c[5290]|0)>>>0){f=21184+((g<<1)+2<<2)|0;e=d;break}zb()}while(0);c[f>>2]=l;c[e+12>>2]=l;c[p+(k+8)>>2]=e;c[p+(k+12)>>2]=21184+(g<<1<<2);break}e=m>>>8;do if(!e)e=0;else{if(m>>>0>16777215){e=31;break}E=e<<((e+1048320|0)>>>16&8)<<(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4);e=14-(((e<<((e+1048320|0)>>>16&8))+520192|0)>>>16&4|(e+1048320|0)>>>16&8|(E+245760|0)>>>16&2)+(E<<((E+245760|0)>>>16&2)>>>15)|0;e=m>>>(e+7|0)&1|e<<1}while(0);j=21448+(e<<2)|0;c[p+(k+28)>>2]=e;c[p+(k+20)>>2]=0;c[p+(k+16)>>2]=0;f=c[5287]|0;g=1<<e;if(!(f&g)){c[5287]=f|g;c[j>>2]=l;c[p+(k+24)>>2]=j;c[p+(k+12)>>2]=l;c[p+(k+8)>>2]=l;break}f=c[j>>2]|0;if((e|0)==31)e=0;else e=25-(e>>>1)|0;j:do if((c[f+4>>2]&-8|0)!=(m|0)){e=m<<e;while(1){g=f+(e>>>31<<2)+16|0;j=c[g>>2]|0;if(!j)break;if((c[j+4>>2]&-8|0)==(m|0)){d=j;break j}else{e=e<<1;f=j}}if(g>>>0<(c[5290]|0)>>>0)zb();else{c[g>>2]=l;c[p+(k+24)>>2]=f;c[p+(k+12)>>2]=l;c[p+(k+8)>>2]=l;break h}}else d=f;while(0);f=d+8|0;e=c[f>>2]|0;g=c[5290]|0;if(d>>>0<g>>>0)zb();if(e>>>0<g>>>0)zb();else{c[e+12>>2]=l;c[f>>2]=l;c[p+(k+8)>>2]=e;c[p+(k+12)>>2]=d;c[p+(k+24)>>2]=0;break}}else{E=(c[5289]|0)+m|0;c[5289]=E;c[5292]=l;c[p+(k+4)>>2]=E|1}while(0);E=p+(h|8)|0;i=b;return E|0}d=21592|0;while(1){e=c[d>>2]|0;if(e>>>0<=r>>>0?(m=c[d+4>>2]|0,(e+m|0)>>>0>r>>>0):0)break;d=c[d+8>>2]|0}if(!(e+(m+ -39)&7))d=0;else d=0-(e+(m+ -39))&7;d=e+(m+ -47+d)|0;d=d>>>0<(r+16|0)>>>0?r:d;f=p+8|0;if(!(f&7))f=0;else f=0-f&7;E=q+ -40-f|0;c[5292]=p+f;c[5289]=E;c[p+(f+4)>>2]=E|1;c[p+(q+ -36)>>2]=40;c[5293]=c[5408];c[d+4>>2]=27;c[d+8>>2]=c[5398];c[d+12>>2]=c[5399];c[d+16>>2]=c[5400];c[d+20>>2]=c[5401];c[5398]=p;c[5399]=q;c[5401]=0;c[5400]=d+8;c[d+28>>2]=7;if((d+32|0)>>>0<(e+m|0)>>>0){f=d+28|0;do{E=f;f=f+4|0;c[f>>2]=7}while((E+8|0)>>>0<(e+m|0)>>>0)}if((d|0)!=(r|0)){c[r+(d-r+4)>>2]=c[r+(d-r+4)>>2]&-2;c[r+4>>2]=d-r|1;c[r+(d-r)>>2]=d-r;if((d-r|0)>>>0<256){e=c[5286]|0;do if(!(e&1<<((d-r|0)>>>3))){c[5286]=e|1<<((d-r|0)>>>3);l=21184+(((d-r|0)>>>3<<1)+2<<2)|0;k=21184+((d-r|0)>>>3<<1<<2)|0}else{e=c[21184+(((d-r|0)>>>3<<1)+2<<2)>>2]|0;if(e>>>0>=(c[5290]|0)>>>0){l=21184+(((d-r|0)>>>3<<1)+2<<2)|0;k=e;break}zb()}while(0);c[l>>2]=r;c[k+12>>2]=r;c[r+8>>2]=k;c[r+12>>2]=21184+((d-r|0)>>>3<<1<<2);break}if((d-r|0)>>>8)if((d-r|0)>>>0>16777215)e=31;else{e=(d-r|0)>>>8<<((((d-r|0)>>>8)+1048320|0)>>>16&8);e=14-((e+520192|0)>>>16&4|(((d-r|0)>>>8)+1048320|0)>>>16&8|((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)+(e<<((e+520192|0)>>>16&4)<<(((e<<((e+520192|0)>>>16&4))+245760|0)>>>16&2)>>>15)|0;e=(d-r|0)>>>(e+7|0)&1|e<<1}else e=0;j=21448+(e<<2)|0;c[r+28>>2]=e;c[r+20>>2]=0;c[r+16>>2]=0;f=c[5287]|0;g=1<<e;if(!(f&g)){c[5287]=f|g;c[j>>2]=r;c[r+24>>2]=j;c[r+12>>2]=r;c[r+8>>2]=r;break}g=c[j>>2]|0;if((e|0)==31)e=0;else e=25-(e>>>1)|0;k:do if((c[g+4>>2]&-8|0)!=(d-r|0)){e=d-r<<e;while(1){f=g+(e>>>31<<2)+16|0;j=c[f>>2]|0;if(!j)break;if((c[j+4>>2]&-8|0)==(d-r|0)){h=j;break k}else{e=e<<1;g=j}}if(f>>>0<(c[5290]|0)>>>0)zb();else{c[f>>2]=r;c[r+24>>2]=g;c[r+12>>2]=r;c[r+8>>2]=r;break g}}else h=g;while(0);e=h+8|0;d=c[e>>2]|0;f=c[5290]|0;if(h>>>0<f>>>0)zb();if(d>>>0<f>>>0)zb();else{c[d+12>>2]=r;c[e>>2]=r;c[r+8>>2]=d;c[r+12>>2]=h;c[r+24>>2]=0;break}}}else{E=c[5290]|0;if((E|0)==0|p>>>0<E>>>0)c[5290]=p;c[5398]=p;c[5399]=q;c[5401]=0;c[5295]=c[5404];c[5294]=-1;d=0;do{E=d<<1;c[21184+(E+3<<2)>>2]=21184+(E<<2);c[21184+(E+2<<2)>>2]=21184+(E<<2);d=d+1|0}while((d|0)!=32);d=p+8|0;if(!(d&7))d=0;else d=0-d&7;E=q+ -40-d|0;c[5292]=p+d;c[5289]=E;c[p+(d+4)>>2]=E|1;c[p+(q+ -36)>>2]=40;c[5293]=c[5408]}while(0);d=c[5289]|0;if(d>>>0>o>>>0){D=d-o|0;c[5289]=D;E=c[5292]|0;c[5292]=E+o;c[E+(o+4)>>2]=D|1;c[E+4>>2]=o|3;E=E+8|0;i=b;return E|0}}c[(vb()|0)>>2]=12;E=0;i=b;return E|0}function gF(a){a=a|0;var b=0,d=0,e=0,f=0,g=0,h=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0,q=0,r=0,s=0,t=0,u=0,v=0,w=0;b=i;if(!a){i=b;return}r=c[5290]|0;if((a+ -8|0)>>>0<r>>>0)zb();h=c[a+ -4>>2]|0;if((h&3|0)==1)zb();k=a+((h&-8)+ -8)|0;do if(!(h&1)){o=c[a+ -8>>2]|0;if(!(h&3)){i=b;return}m=a+(-8-o)|0;n=o+(h&-8)|0;if(m>>>0<r>>>0)zb();if((m|0)==(c[5291]|0)){if((c[a+((h&-8)+ -4)>>2]&3|0)!=3){d=m;p=n;break}c[5288]=n;c[a+((h&-8)+ -4)>>2]=c[a+((h&-8)+ -4)>>2]&-2;c[a+(-8-o+4)>>2]=n|1;c[k>>2]=n;i=b;return}if(o>>>0<256){p=c[a+(-8-o+8)>>2]|0;d=c[a+(-8-o+12)>>2]|0;if((p|0)!=(21184+(o>>>3<<1<<2)|0)){if(p>>>0<r>>>0)zb();if((c[p+12>>2]|0)!=(m|0))zb()}if((d|0)==(p|0)){c[5286]=c[5286]&~(1<<(o>>>3));d=m;p=n;break}if((d|0)!=(21184+(o>>>3<<1<<2)|0)){if(d>>>0<r>>>0)zb();if((c[d+8>>2]|0)!=(m|0))zb();else s=d+8|0}else s=d+8|0;c[p+12>>2]=d;c[s>>2]=p;d=m;p=n;break}s=c[a+(-8-o+24)>>2]|0;u=c[a+(-8-o+12)>>2]|0;do if((u|0)==(m|0)){u=c[a+(-8-o+20)>>2]|0;if(!u){u=c[a+(-8-o+16)>>2]|0;if(!u){q=0;break}else t=a+(-8-o+16)|0}else t=a+(-8-o+20)|0;while(1){w=u+20|0;v=c[w>>2]|0;if(v){u=v;t=w;continue}w=u+16|0;v=c[w>>2]|0;if(!v)break;else{u=v;t=w}}if(t>>>0<r>>>0)zb();else{c[t>>2]=0;q=u;break}}else{t=c[a+(-8-o+8)>>2]|0;if(t>>>0<r>>>0)zb();if((c[t+12>>2]|0)!=(m|0))zb();if((c[u+8>>2]|0)==(m|0)){c[t+12>>2]=u;c[u+8>>2]=t;q=u;break}else zb()}while(0);if(s){r=c[a+(-8-o+28)>>2]|0;if((m|0)==(c[21448+(r<<2)>>2]|0)){c[21448+(r<<2)>>2]=q;if(!q){c[5287]=c[5287]&~(1<<r);d=m;p=n;break}}else{if(s>>>0<(c[5290]|0)>>>0)zb();if((c[s+16>>2]|0)==(m|0))c[s+16>>2]=q;else c[s+20>>2]=q;if(!q){d=m;p=n;break}}if(q>>>0<(c[5290]|0)>>>0)zb();c[q+24>>2]=s;r=c[a+(-8-o+16)>>2]|0;do if(r)if(r>>>0<(c[5290]|0)>>>0)zb();else{c[q+16>>2]=r;c[r+24>>2]=q;break}while(0);o=c[a+(-8-o+20)>>2]|0;if(o)if(o>>>0<(c[5290]|0)>>>0)zb();else{c[q+20>>2]=o;c[o+24>>2]=q;d=m;p=n;break}else{d=m;p=n}}else{d=m;p=n}}else{d=a+ -8|0;p=h&-8}while(0);if(d>>>0>=k>>>0)zb();m=c[a+((h&-8)+ -4)>>2]|0;if(!(m&1))zb();if(!(m&2)){if((k|0)==(c[5292]|0)){w=(c[5289]|0)+p|0;c[5289]=w;c[5292]=d;c[d+4>>2]=w|1;if((d|0)!=(c[5291]|0)){i=b;return}c[5291]=0;c[5288]=0;i=b;return}if((k|0)==(c[5291]|0)){w=(c[5288]|0)+p|0;c[5288]=w;c[5291]=d;c[d+4>>2]=w|1;c[d+w>>2]=w;i=b;return}p=(m&-8)+p|0;do if(m>>>0>=256){l=c[a+((h&-8)+16)>>2]|0;n=c[a+(h&-8|4)>>2]|0;do if((n|0)==(k|0)){n=c[a+((h&-8)+12)>>2]|0;if(!n){n=c[a+((h&-8)+8)>>2]|0;if(!n){j=0;break}else m=a+((h&-8)+8)|0}else m=a+((h&-8)+12)|0;while(1){o=n+20|0;q=c[o>>2]|0;if(q){n=q;m=o;continue}o=n+16|0;q=c[o>>2]|0;if(!q)break;else{n=q;m=o}}if(m>>>0<(c[5290]|0)>>>0)zb();else{c[m>>2]=0;j=n;break}}else{m=c[a+(h&-8)>>2]|0;if(m>>>0<(c[5290]|0)>>>0)zb();if((c[m+12>>2]|0)!=(k|0))zb();if((c[n+8>>2]|0)==(k|0)){c[m+12>>2]=n;c[n+8>>2]=m;j=n;break}else zb()}while(0);if(l){m=c[a+((h&-8)+20)>>2]|0;if((k|0)==(c[21448+(m<<2)>>2]|0)){c[21448+(m<<2)>>2]=j;if(!j){c[5287]=c[5287]&~(1<<m);break}}else{if(l>>>0<(c[5290]|0)>>>0)zb();if((c[l+16>>2]|0)==(k|0))c[l+16>>2]=j;else c[l+20>>2]=j;if(!j)break}if(j>>>0<(c[5290]|0)>>>0)zb();c[j+24>>2]=l;k=c[a+((h&-8)+8)>>2]|0;do if(k)if(k>>>0<(c[5290]|0)>>>0)zb();else{c[j+16>>2]=k;c[k+24>>2]=j;break}while(0);h=c[a+((h&-8)+12)>>2]|0;if(h)if(h>>>0<(c[5290]|0)>>>0)zb();else{c[j+20>>2]=h;c[h+24>>2]=j;break}}}else{j=c[a+(h&-8)>>2]|0;h=c[a+(h&-8|4)>>2]|0;if((j|0)!=(21184+(m>>>3<<1<<2)|0)){if(j>>>0<(c[5290]|0)>>>0)zb();if((c[j+12>>2]|0)!=(k|0))zb()}if((h|0)==(j|0)){c[5286]=c[5286]&~(1<<(m>>>3));break}if((h|0)!=(21184+(m>>>3<<1<<2)|0)){if(h>>>0<(c[5290]|0)>>>0)zb();if((c[h+8>>2]|0)!=(k|0))zb();else l=h+8|0}else l=h+8|0;c[j+12>>2]=h;c[l>>2]=j}while(0);c[d+4>>2]=p|1;c[d+p>>2]=p;if((d|0)==(c[5291]|0)){c[5288]=p;i=b;return}}else{c[a+((h&-8)+ -4)>>2]=m&-2;c[d+4>>2]=p|1;c[d+p>>2]=p}h=p>>>3;if(p>>>0<256){e=c[5286]|0;if(e&1<<h){e=c[21184+((h<<1)+2<<2)>>2]|0;if(e>>>0<(c[5290]|0)>>>0)zb();else{f=21184+((h<<1)+2<<2)|0;g=e}}else{c[5286]=e|1<<h;f=21184+((h<<1)+2<<2)|0;g=21184+(h<<1<<2)|0}c[f>>2]=d;c[g+12>>2]=d;c[d+8>>2]=g;c[d+12>>2]=21184+(h<<1<<2);i=b;return}f=p>>>8;if(f)if(p>>>0>16777215)f=31;else{w=f<<((f+1048320|0)>>>16&8)<<(((f<<((f+1048320|0)>>>16&8))+520192|0)>>>16&4);f=14-(((f<<((f+1048320|0)>>>16&8))+520192|0)>>>16&4|(f+1048320|0)>>>16&8|(w+245760|0)>>>16&2)+(w<<((w+245760|0)>>>16&2)>>>15)|0;f=p>>>(f+7|0)&1|f<<1}else f=0;g=21448+(f<<2)|0;c[d+28>>2]=f;c[d+20>>2]=0;c[d+16>>2]=0;a=c[5287]|0;h=1<<f;a:do if(a&h){g=c[g>>2]|0;if((f|0)==31)f=0;else f=25-(f>>>1)|0;b:do if((c[g+4>>2]&-8|0)!=(p|0)){f=p<<f;h=g;while(1){a=h+(f>>>31<<2)+16|0;g=c[a>>2]|0;if(!g)break;if((c[g+4>>2]&-8|0)==(p|0)){e=g;break b}else{f=f<<1;h=g}}if(a>>>0<(c[5290]|0)>>>0)zb();else{c[a>>2]=d;c[d+24>>2]=h;c[d+12>>2]=d;c[d+8>>2]=d;break a}}else e=g;while(0);f=e+8|0;h=c[f>>2]|0;g=c[5290]|0;if(e>>>0<g>>>0)zb();if(h>>>0<g>>>0)zb();else{c[h+12>>2]=d;c[f>>2]=d;c[d+8>>2]=h;c[d+12>>2]=e;c[d+24>>2]=0;break}}else{c[5287]=a|h;c[g>>2]=d;c[d+24>>2]=g;c[d+12>>2]=d;c[d+8>>2]=d}while(0);w=(c[5294]|0)+ -1|0;c[5294]=w;if(!w)d=21600|0;else{i=b;return}while(1){d=c[d>>2]|0;if(!d)break;else d=d+8|0}c[5294]=-1;i=b;return}function hF(){}function iF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;b=b-d-(c>>>0>a>>>0|0)>>>0;return(E=b,a-c>>>0|0)|0}function jF(b,d,e){b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0;f=b+e|0;if((e|0)>=20){d=d&255;h=b&3;g=d|d<<8|d<<16|d<<24;if(h){h=b+4-h|0;while((b|0)<(h|0)){a[b>>0]=d;b=b+1|0}}while((b|0)<(f&~3|0)){c[b>>2]=g;b=b+4|0}}while((b|0)<(f|0)){a[b>>0]=d;b=b+1|0}return b-e|0}function kF(b){b=b|0;var c=0;c=b;while(a[c>>0]|0)c=c+1|0;return c-b|0}function lF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return(E=b+d+(a+c>>>0>>>0<a>>>0|0)>>>0,a+c>>>0|0)|0}function mF(b,d,e){b=b|0;d=d|0;e=e|0;var f=0;if((e|0)>=4096)return rb(b|0,d|0,e|0)|0;f=b|0;if((b&3)==(d&3)){while(b&3){if(!e)return f|0;a[b>>0]=a[d>>0]|0;b=b+1|0;d=d+1|0;e=e-1|0}while((e|0)>=4){c[b>>2]=c[d>>2];b=b+4|0;d=d+4|0;e=e-4|0}}while((e|0)>0){a[b>>0]=a[d>>0]|0;b=b+1|0;d=d+1|0;e=e-1|0}return f|0}function nF(b,c,d){b=b|0;c=c|0;d=d|0;var e=0;if((c|0)<(b|0)&(b|0)<(c+d|0)){e=b;c=c+d|0;b=b+d|0;while((d|0)>0){b=b-1|0;c=c-1|0;d=d-1|0;a[b>>0]=a[c>>0]|0}b=e}else mF(b,c,d)|0;return b|0}function oF(a){a=a|0;return(a&255)<<24|(a>>8&255)<<16|(a>>16&255)<<8|a>>>24|0}function pF(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){E=b<<c|(a&(1<<c)-1<<32-c)>>>32-c;return a<<c}E=a<<c-32;return 0}function qF(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){E=b>>>c;return a>>>c|(b&(1<<c)-1)<<32-c}E=0;return b>>>c-32|0}function rF(a,b,c){a=a|0;b=b|0;c=c|0;if((c|0)<32){E=b>>c;return a>>>c|(b&(1<<c)-1)<<32-c}E=(b|0)<0?-1:0;return b>>c-32|0}function sF(b){b=b|0;var c=0;c=a[n+(b>>>24)>>0]|0;if((c|0)<8)return c|0;c=a[n+(b>>16&255)>>0]|0;if((c|0)<8)return c+8|0;c=a[n+(b>>8&255)>>0]|0;if((c|0)<8)return c+16|0;return(a[n+(b&255)>>0]|0)+24|0}function tF(b){b=b|0;var c=0;c=a[m+(b&255)>>0]|0;if((c|0)<8)return c|0;c=a[m+(b>>8&255)>>0]|0;if((c|0)<8)return c+8|0;c=a[m+(b>>16&255)>>0]|0;if((c|0)<8)return c+16|0;return(a[m+(b>>>24)>>0]|0)+24|0}function uF(a,b){a=a|0;b=b|0;var c=0,d=0,e=0;c=aa(b&65535,a&65535)|0;e=(c>>>16)+(aa(b&65535,a>>>16)|0)|0;d=aa(b>>>16,a&65535)|0;return(E=(e>>>16)+(aa(b>>>16,a>>>16)|0)+(((e&65535)+d|0)>>>16)|0,e+d<<16|c&65535|0)|0}function vF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0,g=0,h=0;g=b>>31|((b|0)<0?-1:0)<<1;e=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;h=d>>31|((d|0)<0?-1:0)<<1;f=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1;b=iF(g^a,e^b,g,e)|0;a=E;a=iF((AF(b,a,iF(h^c,f^d,h,f)|0,E,0)|0)^(h^g),E^(f^e),h^g,f^e)|0;return a|0}function wF(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0,g=0,h=0,j=0,k=0;f=i;i=i+8|0;h=b>>31|((b|0)<0?-1:0)<<1;g=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1;k=e>>31|((e|0)<0?-1:0)<<1;j=((e|0)<0?-1:0)>>31|((e|0)<0?-1:0)<<1;b=iF(h^a,g^b,h,g)|0;a=E;AF(b,a,iF(k^d,j^e,k,j)|0,E,f|0)|0;a=iF(c[f>>2]^h,c[f+4>>2]^g,h,g)|0;b=E;i=f;return(E=b,a)|0}function xF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;var e=0,f=0;e=uF(a,c)|0;f=E;return(E=(aa(b,c)|0)+(aa(d,a)|0)+f|f&0,e|0|0)|0}function yF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;a=AF(a,b,c,d,0)|0;return a|0}function zF(a,b,d,e){a=a|0;b=b|0;d=d|0;e=e|0;var f=0;f=i;i=i+8|0;AF(a,b,d,e,f|0)|0;i=f;return(E=c[f+4>>2]|0,c[f>>2]|0)|0}function AF(a,b,d,e,f){a=a|0;b=b|0;d=d|0;e=e|0;f=f|0;var g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0,p=0;if(!b)if(!e){if(f){c[f>>2]=(a>>>0)%(d>>>0);c[f+4>>2]=0}k=0;l=(a>>>0)/(d>>>0)>>>0;return(E=k,l)|0}else{if(!f){k=0;l=0;return(E=k,l)|0}c[f>>2]=a|0;c[f+4>>2]=b&0;k=0;l=0;return(E=k,l)|0}do if(d){if(e){k=(sF(e|0)|0)-(sF(b|0)|0)|0;if(k>>>0<=31){i=k+1|0;g=a>>>((k+1|0)>>>0)&k-31>>31|b<<31-k;h=b>>>((k+1|0)>>>0)&k-31>>31;j=0;l=a<<31-k;break}if(!f){k=0;l=0;return(E=k,l)|0}c[f>>2]=a|0;c[f+4>>2]=b|b&0;k=0;l=0;return(E=k,l)|0}if(d-1&d){l=(sF(d|0)|0)+33-(sF(b|0)|0)|0;i=l;g=32-l-1>>31&b>>>((l-32|0)>>>0)|(b<<32-l|a>>>(l>>>0))&l-32>>31;h=l-32>>31&b>>>(l>>>0);j=a<<64-l&32-l>>31;l=(b<<64-l|a>>>((l-32|0)>>>0))&32-l>>31|a<<32-l&l-33>>31;break}if(f){c[f>>2]=d-1&a;c[f+4>>2]=0}if((d|0)==1){k=b|b&0;l=a|0|0;return(E=k,l)|0}else{l=tF(d|0)|0;k=b>>>(l>>>0)|0;l=b<<32-l|a>>>(l>>>0)|0;return(E=k,l)|0}}else{if(!e){if(f){c[f>>2]=(b>>>0)%(d>>>0);c[f+4>>2]=0}k=0;l=(b>>>0)/(d>>>0)>>>0;return(E=k,l)|0}if(!a){if(f){c[f>>2]=0;c[f+4>>2]=(b>>>0)%(e>>>0)}k=0;l=(b>>>0)/(e>>>0)>>>0;return(E=k,l)|0}if(!(e-1&e)){if(f){c[f>>2]=a|0;c[f+4>>2]=e-1&b|b&0}k=0;l=b>>>((tF(e|0)|0)>>>0);return(E=k,l)|0}k=(sF(e|0)|0)-(sF(b|0)|0)|0;if(k>>>0<=30){i=k+1|0;g=b<<31-k|a>>>((k+1|0)>>>0);h=b>>>((k+1|0)>>>0);j=0;l=a<<31-k;break}if(!f){k=0;l=0;return(E=k,l)|0}c[f>>2]=a|0;c[f+4>>2]=b|b&0;k=0;l=0;return(E=k,l)|0}while(0);if(!i){e=l;k=j;d=0;j=0}else{a=lF(d|0|0,e|e&0,-1,-1)|0;b=E;k=j;j=0;do{p=l;l=k>>>31|l<<1;k=j|k<<1;p=g<<1|p>>>31|0;o=g>>>31|h<<1|0;iF(a,b,p,o)|0;m=E;n=m>>31|((m|0)<0?-1:0)<<1;j=n&1;g=iF(p,o,n&(d|0),(((m|0)<0?-1:0)>>31|((m|0)<0?-1:0)<<1)&(e|e&0))|0;h=E;i=i-1|0}while((i|0)!=0);e=l;d=0}if(f){c[f>>2]=g;c[f+4>>2]=h}o=(k|0)>>>31|e<<1|(0<<1|k>>>31)&0|d;p=(k<<1|0>>>31)&-2|j;return(E=o,p)|0}function BF(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;Jb[a&31](b|0,c|0,d|0,e|0,f|0)}function CF(a,b,c){a=a|0;b=b|0;c=+c;Kb[a&31](b|0,+c)}function DF(a,b){a=a|0;b=b|0;Lb[a&511](b|0)}function EF(a,b,c,d,e,f,g){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;f=f|0;g=g|0;Mb[a&0](b|0,c|0,d|0,+e,f|0,g|0)}function FF(a,b,c){a=a|0;b=b|0;c=c|0;Nb[a&127](b|0,c|0)}function GF(a,b,c,d,e,f,g,h,i,j,k){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;k=k|0;return Ob[a&3](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0,k|0)|0}function HF(a,b){a=a|0;b=b|0;return Pb[a&127](b|0)|0}function IF(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=+d;e=e|0;Qb[a&7](b|0,c|0,+d,e|0)}function JF(a,b,c,d,e,f,g){a=a|0;b=b|0;c=+c;d=+d;e=e|0;f=f|0;g=g|0;Rb[a&0](b|0,+c,+d,e|0,f|0,g|0)}function KF(a,b,c,d,e){a=a|0;b=b|0;c=+c;d=d|0;e=e|0;Sb[a&0](b|0,+c,d|0,e|0)}function LF(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return Tb[a&31](b|0,c|0,d|0,e|0)|0}function MF(a,b,c,d){a=a|0;b=b|0;c=+c;d=d|0;Ub[a&15](b|0,+c,d|0)}function NF(a,b,c,d,e,f,g,h,i){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;return+Vb[a&1](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0)}function OF(a,b,c,d,e,f,g,h,i,j,k,l){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;g=+g;h=+h;i=+i;j=j|0;k=k|0;l=+l;Wb[a&0](b|0,c|0,d|0,e|0,+f,+g,+h,+i,j|0,k|0,+l)}function PF(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;return+Xb[a&15](b|0,c|0,d|0,e|0,f|0)}function QF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return Yb[a&31](b|0,c|0,d|0)|0}function RF(a,b,c,d,e,f,g){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;Zb[a&7](b|0,c|0,d|0,e|0,f|0,g|0)}function SF(a,b,c,d){a=a|0;b=b|0;c=c|0;d=+d;return _b[a&7](b|0,c|0,+d)|0}function TF(a,b){a=a|0;b=b|0;return+$b[a&15](b|0)}function UF(a,b,c,d,e,f,g){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;return ac[a&3](b|0,c|0,d|0,e|0,f|0,g|0)|0}function VF(a,b,c,d,e,f,g){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;f=f|0;g=g|0;return+bc[a&3](b|0,c|0,d|0,+e,f|0,g|0)}function WF(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=+d;e=e|0;f=f|0;cc[a&0](b|0,c|0,+d,e|0,f|0)}function XF(a,b,c,d,e,f,g,h){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;dc[a&1](b|0,c|0,d|0,e|0,f|0,g|0,h|0)}function YF(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;ec[a&1](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0)}function ZF(a,b,c,d,e,f,g,h,i,j,k){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;k=k|0;fc[a&3](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0,k|0)}function _F(a,b,c){a=a|0;b=b|0;c=c|0;return gc[a&31](b|0,c|0)|0}function $F(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;return+hc[a&15](b|0,c|0,d|0)}function aG(a,b,c,d,e,f,g,h,i,j,k){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;k=k|0;return+ic[a&3](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0,k|0)}function bG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;jc[a&1](b|0,c|0,d|0,e|0,+f)}function cG(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;return+kc[a&3](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0)}function dG(a,b,c){a=a|0;b=b|0;c=+c;return+lc[a&1](b|0,+c)}function eG(a,b,c,d,e,f,g,h,i,j,k,l,m){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=+f;g=+g;h=+h;i=+i;j=+j;k=k|0;l=+l;m=m|0;mc[a&0](b|0,c|0,d|0,e|0,+f,+g,+h,+i,+j,k|0,+l,m|0)}function fG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=+d;e=e|0;f=f|0;return+nc[a&3](b|0,c|0,+d,e|0,f|0)}function gG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;return+oc[a&1](b|0,c|0,d|0,e|0)}function hG(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;return pc[a&3](b|0,c|0,d|0,e|0,f|0,g|0,h|0,i|0,j|0)|0}function iG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;qc[a&15](b|0,c|0,d|0,+e)}function jG(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;rc[a&127](b|0,c|0,d|0)}function kG(a){a=a|0;sc[a&3]()}function lG(a,b,c,d){a=a|0;b=b|0;c=c|0;d=+d;tc[a&7](b|0,c|0,+d)}function mG(a,b,c,d,e){a=a|0;b=b|0;c=+c;d=d|0;e=+e;return uc[a&1](b|0,+c,d|0,+e)|0}function nG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;vc[a&127](b|0,c|0,d|0,e|0)}function oG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;ba(0)}function pG(a,b){a=a|0;b=+b;ba(1)}function qG(a){a=a|0;ba(2)}function rG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=+d;e=e|0;f=f|0;ba(3)}function sG(a,b){a=a|0;b=b|0;ba(4)}function tG(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;ba(5);return 0}function uG(a){a=a|0;ba(6);return 0}function vG(a,b,c,d){a=a|0;b=b|0;c=+c;d=d|0;ba(7)}function wG(a,b,c,d,e,f){a=a|0;b=+b;c=+c;d=d|0;e=e|0;f=f|0;ba(8)}function xG(a,b,c,d){a=a|0;b=+b;c=c|0;d=d|0;ba(9)}function yG(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;ba(10);return 0}function zG(a,b,c){a=a|0;b=+b;c=c|0;ba(11)}function AG(a,b,c,d,e,f,g,h){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;ba(12);return 0.0}function BG(a,b,c,d,e,f,g,h,i,j,k){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;f=+f;g=+g;h=+h;i=i|0;j=j|0;k=+k;ba(13)}function CG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;ba(14);return 0.0}function DG(a,b,c){a=a|0;b=b|0;c=c|0;ba(15);return 0}function EG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;ba(16)}function FG(a,b,c){a=a|0;b=b|0;c=+c;ba(17);return 0}function GG(a){a=a|0;ba(18);return 0.0}function HG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;ba(19);return 0}function IG(a,b,c,d,e,f){a=a|0;b=b|0;c=c|0;d=+d;e=e|0;f=f|0;ba(20);return 0.0}function JG(a,b,c,d,e){a=a|0;b=b|0;c=+c;d=d|0;e=e|0;ba(21)}function KG(a,b,c,d,e,f,g){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;ba(22)}function LG(a,b,c,d,e,f,g,h,i){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;ba(23)}function MG(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;ba(24)}function NG(a,b){a=a|0;b=b|0;ba(25);return 0}function OG(a,b,c){a=a|0;b=b|0;c=c|0;ba(26);return 0.0}function PG(a,b,c,d,e,f,g,h,i,j){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;j=j|0;ba(27);return 0.0}function QG(a,b,c,d,e){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;ba(28)}function RG(a,b,c,d,e,f,g,h,i){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;ba(29);return 0.0}function SG(a,b){a=a|0;b=+b;ba(30);return 0.0}function TG(a,b,c,d,e,f,g,h,i,j,k,l){a=a|0;b=b|0;c=c|0;d=d|0;e=+e;f=+f;g=+g;h=+h;i=+i;j=j|0;k=+k;l=l|0;ba(31)}function UG(a,b,c,d,e){a=a|0;b=b|0;c=+c;d=d|0;e=e|0;ba(32);return 0.0}function VG(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;ba(33);return 0.0}function WG(a,b,c,d,e,f,g,h,i){a=a|0;b=b|0;c=c|0;d=d|0;e=e|0;f=f|0;g=g|0;h=h|0;i=i|0;ba(34);return 0}function XG(a,b,c,d){a=a|0;b=b|0;c=c|0;d=+d;ba(35)}function YG(a,b,c){a=a|0;b=b|0;c=c|0;ba(36)}function ZG(){ba(37)}function _G(){Hb()}function $G(a,b,c){a=a|0;b=b|0;c=+c;ba(38)}function aH(a,b,c,d){a=a|0;b=+b;c=c|0;d=+d;ba(39);return 0}function bH(a,b,c,d){a=a|0;b=b|0;c=c|0;d=d|0;ba(40)}




// EMSCRIPTEN_END_FUNCS
var Jb=[oG,ds,_w,ky,iz,Az,zB,EB,xC,CC,FC,LC,VC,fD,oD,HD,$E,_E,XE,oG,oG,oG,oG,oG,oG,oG,oG,oG,oG,oG,oG,oG];var Kb=[pG,qp,pp,bp,Vo,Po,Bp,ar,br,Ss,ot,Kt,Kv,Zv,lw,Hx,Hp,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG,pG];var Lb=[qG,Un,Vn,Wn,Zn,_n,eo,fo,jo,ko,oo,po,so,to,Ho,Io,zo,Oo,No,Du,Eu,Qo,Fu,To,Ro,mp,So,op,Np,Qp,Rp,gq,hq,Zp,dq,sq,tq,mq,xq,wq,Hq,yq,Mq,Tq,Uq,Oq,Zq,Yq,gr,hr,Xq,ir,ur,tr,Lr,Ur,Vr,$r,as,ms,ts,us,vs,ws,Os,Ps,ht,gt,st,tt,vt,wt,yt,zt,Et,Ft,Nt,Ot,Qt,Rt,Wt,Vt,cu,ku,Bu,Au,Uu,Tu,Zu,Yu,av,Ru,cv,Pu,ev,Nu,gv,iv,jv,mv,nv,pv,qv,uv,vv,tv,yv,Ev,Fv,Hv,Iv,Iu,Nv,Qv,Pv,Sv,fw,gw,ow,pw,sw,tw,zw,Aw,yw,Bw,Tw,Uw,ox,px,cx,rx,Cx,Dx,Mx,Nx,Qx,Rx,$x,_x,ry,jy,sy,hy,uy,cy,wy,By,Ay,Gy,Hy,Jy,Ky,My,Ny,Py,Qy,Sy,Ty,Vy,Wy,Yy,Zy,$y,az,cz,dz,fz,gz,kz,lz,oz,nz,sz,rz,xz,yz,Lu,sv,Bz,Cz,Ut,mu,Gz,Hz,Iz,Jz,Oz,Nz,Sz,Tz,Vz,Wz,$z,_z,qA,rA,tA,uA,zA,yA,MA,LA,XA,YA,WA,ZA,oB,nB,np,Dp,yB,xB,DB,CB,IB,HB,SB,TB,ZB,_B,fC,eC,mC,oC,qC,rC,yC,zC,BC,AC,GC,HC,KC,JC,NC,QC,TC,SC,WC,YC,aD,$C,dD,cD,hD,iD,lD,kD,nD,mD,pD,tD,wD,xD,vD,BD,GD,FD,LD,KD,YD,XD,gE,fE,FE,EE,JE,ME,KE,LE,NE,OE,DE,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG,qG];var Mb=[rG];var Nb=[sG,lo,mo,wo,yo,xp,Zo,wp,dp,ep,fp,Wo,Xo,$o,_o,rp,gp,hp,ip,jp,kp,Ap,_p,$p,nq,oq,Jq,Aq,Cq,Dq,Eq,Kq,Pq,Qq,cr,jr,sr,Qr,Rr,hs,ls,Gs,Ks,Ls,Qs,Gp,yu,jt,lt,mt,Ht,Jt,Zt,Yt,eu,Gu,Wu,Av,Lv,Vv,Rv,ew,kw,rw,vw,Fw,mx,Ex,Gx,my,qy,ty,vy,yy,mz,qu,RA,SA,nA,pA,hA,Xw,qB,BB,GB,MB,$B,aC,XB,YB,hC,EC,PC,RC,UC,_C,bD,rD,JD,mE,nE,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG,sG];var Ob=[tG,zz,Ez,tG];var Pb=[uG,Ec,Jo,yp,sp,tp,zp,iq,uq,Gq,Iq,Vq,qr,Or,Wr,is,js,As,Bs,Cs,Es,Js,Ep,Rs,Jp,Xs,Zs,_s,bt,iC,nt,qt,It,Lt,Lp,Pt,St,fu,hu,iu,ju,Xv,Yv,$v,jw,mw,qw,uw,Vw,Ww,Kw,Lw,Ow,nx,qx,fx,gx,jx,Fx,Ix,Ox,Sx,ny,oy,Dy,Ey,Fy,su,Qz,jA,kA,lA,mA,oA,aB,dB,fB,gB,jB,Fp,NB,OB,PB,bC,jE,cC,nC,zu,aE,GE,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG,uG];var Qb=[vG,Eo,eq,qq,Rq,Sr,vG,vG];var Rb=[wG];var Sb=[xG];var Tb=[yG,ao,dr,ys,_t,Iy,Ly,Oy,Ry,Uy,Xy,_y,bz,ez,hz,QA,Rz,fA,sD,yG,yG,yG,yG,yG,yG,yG,yG,yG,yG,yG,yG,yG];var Ub=[zG,Ns,kC,Dt,Uv,iw,DA,vx,$A,wB,LB,zG,zG,zG,zG,zG];var Vb=[AG,vo];var Wb=[BG];var Xb=[CG,jz,AB,FB,DC,OC,XC,gD,qD,ID,CG,CG,CG,CG,CG,CG];var Yb=[DG,Zr,$n,Ko,jq,vq,Wq,rr,Xr,xs,Is,Kp,kt,Mt,Xt,au,$t,Wv,nw,Rw,Jx,Cy,pu,TA,iA,dA,QB,eE,xu,_D,$D,PE];var Zb=[EG,Sp,fs,fy,cF,bF,aF,EG];var _b=[FG,dt,Qw,lx,lB,FG,FG,FG];var $b=[GG,vu,Ts,pt,_v,Lx,Px,Tx,Ip,GG,GG,GG,GG,GG,GG,GG];var ac=[HG,xw,wz,RB];var bc=[IG,ov,rv,IG];var cc=[JG];var dc=[KG,Sw];var ec=[LG,Hr];var fc=[MG,hE,iE,MG];var gc=[NG,go,qo,uo,up,vp,Op,or,AA,gu,du,lu,fv,hv,kv,wv,Cv,Dv,ru,sA,vA,NG,NG,NG,NG,NG,NG,NG,NG,NG,NG,NG];var hc=[OG,ho,ro,Fo,Pp,fq,rq,Nq,Sq,Tr,lv,xv,OG,OG,OG,OG];var ic=[PG,Kr,Gr,PG];var jc=[QG,Xn];var kc=[RG,Fr,Ir,RG];var lc=[SG,uu];var mc=[TG];var nc=[UG,Gv,Jv,UG];var oc=[VG,Jr];var pc=[WG,bs,ay,WG];var qc=[XG,Yn,Ao,dv,Ew,Dz,Mz,uD,AD,ED,XG,XG,XG,XG,XG,XG];var rc=[YG,bo,Go,cp,Mr,Nr,cs,ks,zs,Ds,Fs,Hs,tu,Us,Vs,Ys,at,et,lC,rt,ut,xt,At,Zw,Bt,Mp,nu,ou,zv,Mv,dw,bw,Cw,Dw,Jw,Hw,Nw,ex,bx,ix,Kx,yx,wx,xx,dy,py,xy,pz,tz,Kz,Lz,cA,aA,bA,gA,BA,bB,eB,iB,pB,uB,sB,kE,lE,ZC,yD,zD,CD,DD,Tt,ax,$w,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG,YG];var sc=[ZG,_G,BE,CE];var tc=[$G,Lq,Bq,Fq,er,Bv,$G,$G];var uc=[aH,Uo];var vc=[bH,Su,Mu,Yo,ap,fr,Er,es,gs,Ms,Ws,Yw,$s,ct,gC,it,Gt,Ct,bu,Cu,_u,$u,bv,VA,UA,Tv,hw,cw,FA,Iw,Mw,Pw,dx,hx,kx,sx,ux,zx,Bx,Ax,ey,iy,qz,uz,Uz,Xz,CA,_A,cB,hB,kB,mB,vB,tB,JB,KB,dE,jC,pC,sC,eD,jD,RE,SE,UE,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH,bH];return{_emscripten_bind_btCylinderShape___destroy___0:Pn,_strlen:kF,_emscripten_bind_btDispatcherInfo_set_m_useContinuous_1:ed,_emscripten_bind_btCollisionObject_isActive_0:Ue,_emscripten_bind_btVehicleTuning_set_m_frictionSlip_1:xh,_emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4:ef,_emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1:Hl,_emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0:ti,_emscripten_bind_btQuaternion_setX_1:Yi,_emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0:bd,_emscripten_bind_btQuaternion_setZ_1:_i,_emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0:em,_emscripten_bind_btKinematicCharacterController_setMaxSlope_1:pk,_emscripten_bind_btQuadWord_z_0:Fn,_emscripten_bind_btTransform_setIdentity_0:kn,_emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0:vj,_emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0:pj,_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0:$d,_emscripten_bind_btCollisionDispatcher___destroy___0:mh,_emscripten_bind_btRigidBody_applyCentralImpulse_1:zm,_emscripten_bind_btDefaultMotionState_getWorldTransform_1:ai,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1:of,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3:qf,_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2:pf,_emscripten_bind_btVector3_op_mul_1:Mk,_emscripten_bind_btDynamicsWorld_rayTest_3:Ei,_emscripten_bind_btRaycastVehicle_updateWheelTransform_2:Tl,_emscripten_bind_btQuadWord_x_0:Dn,_emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0:gm,_emscripten_bind_btCollisionObject_isKinematicObject_0:Ve,_emscripten_bind_ConvexResultCallback___destroy___0:Pf,_emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1:Nh,_emscripten_bind_btRigidBody_getCenterOfMassTransform_0:nm,_emscripten_bind_btGhostObject_isKinematicObject_0:yl,_emscripten_bind_btCapsuleShape___destroy___0:vd,_emscripten_bind_btCollisionObject_activate_1:Te,_emscripten_bind_btCollisionObject_activate_0:Se,_emscripten_bind_btKinematicCharacterController_setUpAxis_1:ck,_emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1:cd,_emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1:jh,_emscripten_bind_btVector3_setX_1:Ik,_emscripten_bind_btCollisionConfiguration___destroy___0:wd,_emscripten_bind_btQuaternion_btQuaternion_4:Si,_emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1:De,_emscripten_bind_btManifoldPoint_set_m_localPointB_1:Be,_emscripten_bind_btVector3_setZ_1:Kk,_emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0:Hj,_emscripten_bind_btQuaternion_setValue_4:Ti,_emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1:ad,_emscripten_bind_LocalShapeInfo___destroy___0:Nl,_emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0:Jj,_emscripten_bind_btQuadWord_setY_1:In,_emscripten_bind_btRigidBody_isKinematicObject_0:Qm,_emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1:ge,_emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0:ci,_emscripten_bind_btConeTwistConstraint_setDamping_1:ng,_emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0:Cd,_emscripten_bind_btCollisionWorld___destroy___0:Cn,_emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0:ij,_emscripten_bind_btBoxShape_btBoxShape_1:fh,_emscripten_bind_btPersistentManifold_getBody1_0:bh,_emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1:Ai,_emscripten_bind_btKinematicCharacterController_setGravity_1:nk,_emscripten_bind_btConstraintSetting_set_m_impulseClamp_1:ml,_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5:Ke,_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3:Je,_emscripten_bind_LocalShapeInfo_get_m_shapePart_0:Jl,_emscripten_bind_btWheelInfo_get_m_rollInfluence_0:tj,_emscripten_bind_btVector4_setValue_4:Sj,_emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1:Pc,_emscripten_bind_btDynamicsWorld_getDispatchInfo_0:Gi,_emscripten_bind_btVector3_length_0:Ek,_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2:Ef,_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1:Df,_emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1:Ph,_emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1:lj,_emscripten_bind_btPairCachingGhostObject___destroy___0:Wd,_emscripten_bind_btPairCachingGhostObject_activate_0:Hd,_emscripten_bind_btPairCachingGhostObject_activate_1:Id,_emscripten_bind_btPairCachingGhostObject_forceActivationState_1:Gd,_emscripten_bind_btDefaultMotionState___destroy___0:ei,_emscripten_bind_btDispatcherInfo_get_m_stepCount_0:Zc,_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1:ae,_emscripten_bind_btQuadWord_setW_1:Kn,_emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0:be,_emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2:Oi,_emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0:Fj,_emscripten_bind_btRigidBody_setLinearFactor_1:sm,_emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1:od,_emscripten_bind_btRaycastVehicle_setSteeringValue_2:Rl,_emscripten_bind_btPoint2PointConstraint___destroy___0:Zf,_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2:mf,_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1:lf,_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1:ke,_malloc:fF,_emscripten_bind_btDispatcherInfo_get_m_useEpa_0:jd,_emscripten_bind_btTransform_btTransform_2:jn,_emscripten_bind_btTransform_btTransform_0:hn,_emscripten_bind_btWheelInfo_set_m_wheelsRadius_1:yj,_emscripten_bind_btDispatcherInfo_set_m_enableSPU_1:id,_emscripten_bind_btRaycastVehicle_setCoordinateSystem_3:Zl,_emscripten_bind_btCollisionObject_setActivationState_1:Qe,_emscripten_bind_btPersistentManifold___destroy___0:eh,_emscripten_bind_btConstraintSetting_get_m_impulseClamp_0:ll,_emscripten_bind_btCylinderShapeZ___destroy___0:gn,_emscripten_bind_btMatrix3x3___destroy___0:Ic,_emscripten_bind_ConvexResultCallback_hasHit_0:If,_emscripten_bind_btCollisionShape_calculateLocalInertia_2:el,_emscripten_bind_btCollisionWorld_convexSweepTest_5:An,_emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1:ui,_emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2:Qi,_emscripten_bind_btConstraintSetting_set_m_damping_1:kl,_emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1:Kj,_emscripten_bind_btRigidBody_setCcdMotionThreshold_1:Ym,_emscripten_bind_btRigidBody_applyForce_2:um,_emscripten_bind_btConeShapeZ_calculateLocalInertia_2:Jg,_emscripten_bind_btConstraintSetting_set_m_tau_1:il,_emscripten_bind_btConvexHullShape_calculateLocalInertia_2:Zg,_emscripten_bind_btSphereShape_calculateLocalInertia_2:Rk,_emscripten_bind_btPoint2PointConstraint_get_m_setting_0:Xf,_emscripten_bind_LocalConvexResult_LocalConvexResult_5:$l,_emscripten_bind_btGhostObject_setFriction_1:Al,_emscripten_bind_btPairCachingGhostObject_getWorldTransform_0:Nd,_emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1:Zm,_emscripten_bind_btRigidBody_setFriction_1:Sm,_emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1:hm,_emscripten_bind_btGhostObject_setWorldTransform_1:El,_emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1:kf,_emscripten_bind_btConvexHullShape___destroy___0:_g,_emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0:yf,_emscripten_bind_btVector4_setX_1:Xj,_emscripten_bind_btKinematicCharacterController_jump_0:mk,_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1:qg,_emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1:Ff,_emscripten_bind_btRigidBody_upcast_1:Im,_emscripten_bind_btCollisionObject_getWorldTransform_0:Ye,_emscripten_bind_btVector4_setZ_1:Zj,_emscripten_bind_btQuadWord_y_0:En,___cxa_can_catch:dF,_emscripten_bind_btTransform_getBasis_0:qn,_emscripten_bind_btPairCachingGhostObject_setFriction_1:Md,_emscripten_bind_btDispatcherInfo_set_m_useEpa_1:kd,_emscripten_bind_btCollisionDispatcher_getNumManifolds_0:kh,_emscripten_bind_btVehicleRaycaster___destroy___0:Ok,_emscripten_bind_ClosestRayResultCallback___destroy___0:Bi,_emscripten_bind_btQuadWord_w_0:Gn,_emscripten_bind_btCompoundShape___destroy___0:Fh,_emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2:Qc,_emscripten_bind_btGhostObject_btGhostObject_0:ol,_emscripten_bind_btConeShape_btConeShape_2:vg,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1:ue,_emscripten_bind_btManifoldPoint_set_m_localPointA_1:ze,_emscripten_bind_btCollisionObject_setCollisionShape_1:af,_emscripten_bind_btWheelInfo___destroy___0:Lj,_emscripten_bind_btTransform_setRotation_1:nn,_emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0:Ud,_emscripten_bind_btPoint2PointConstraint_enableFeedback_1:Wf,_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1:wi,_emscripten_bind_btAxisSweep3_btAxisSweep3_2:xd,_emscripten_bind_btAxisSweep3_btAxisSweep3_3:yd,_emscripten_bind_btBoxShape_calculateLocalInertia_2:hh,_emscripten_bind_btVector3_setY_1:Jk,_emscripten_bind_btAxisSweep3_btAxisSweep3_4:zd,_emscripten_bind_btAxisSweep3_btAxisSweep3_5:Ad,_emscripten_bind_btQuadWord_setX_1:Hn,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0:pe,_emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1:ph,_emscripten_bind_btOverlappingPairCache___destroy___0:Bk,_emscripten_bind_btConstraintSetting___destroy___0:nl,_emscripten_bind_RayResultCallback___destroy___0:oj,_emscripten_bind_btPersistentManifold_getBody0_0:ah,_emscripten_bind_btConeShapeX_btConeShapeX_2:Lg,_emscripten_bind_btConeTwistConstraint_enableFeedback_1:tg,_emscripten_bind_btCapsuleShapeZ_setLocalScaling_1:cj,_emscripten_bind_btRigidBody_applyTorque_1:tm,_emscripten_bind_btSliderConstraint_setUpperLinLimit_1:eg,_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2:jg,_emscripten_bind_btConcaveShape___destroy___0:Oj,_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4:kg,_emscripten_bind_btQuaternion_x_0:Ui,_emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1:fm,_emscripten_bind_btConcaveShape_setLocalScaling_1:Mj,_emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0:uf,_emscripten_bind_btConeShapeX_setLocalScaling_1:Mg,_emscripten_bind_btQuaternion_z_0:Wi,_emscripten_bind_btConvexHullShape_btConvexHullShape_0:Vg,_emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1:Gj,_emscripten_bind_btConstraintSetting_get_m_damping_0:jl,_emscripten_bind_btGhostObject___destroy___0:Il,_emscripten_bind_btGhostObject_setContactProcessingThreshold_1:sl,_emscripten_bind_btRigidBody_applyCentralForce_1:vm,_emscripten_bind_btQuaternion___destroy___0:aj,_emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1:lh,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_2:$h,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_0:Xh,_emscripten_bind_btDefaultMotionState_btDefaultMotionState_1:_h,_emscripten_bind_btKinematicCharacterController_canJump_0:lk,_emscripten_bind_btRigidBody_isActive_0:Pm,_emscripten_bind_btRaycastVehicle_btRaycastVehicle_3:Pl,_emscripten_bind_btMotionState_setWorldTransform_1:$f,_emscripten_bind_btCylinderShape_setLocalScaling_1:Nn,_emscripten_bind_btCollisionWorld_rayTest_3:tn,_emscripten_bind_btCompoundShape_calculateLocalInertia_2:Eh,_emscripten_bind_btCollisionWorld_getDispatchInfo_0:vn,_emscripten_bind_btRigidBody_setCollisionShape_1:Xm,_emscripten_bind_btConeShapeX___destroy___0:Og,_emscripten_bind_btCollisionObject_getCollisionFlags_0:Ze,_emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1:gd,_emscripten_bind_btConeTwistConstraint_enableMotor_1:og,_emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1:Aj,_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4:bk,_emscripten_bind_btPairCachingGhostObject_setRestitution_1:Ld,_emscripten_bind_btBroadphaseInterface___destroy___0:Ne,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1:oe,_emscripten_bind_btCollisionObject_setContactProcessingThreshold_1:Pe,_emscripten_bind_btPersistentManifold_getNumContacts_0:ch,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0:te,_emscripten_bind_LocalConvexResult___destroy___0:km,_emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0:Wc,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1:qe,_emscripten_bind_btCollisionWorld_addCollisionObject_3:yn,_emscripten_bind_btRigidBody_getCollisionFlags_0:Um,_emscripten_bind_btCollisionShape_setLocalScaling_1:dl,_emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0:Uh,_emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0:am,_emscripten_bind_btMatrix3x3_setEulerZYX_3:Fc,_emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0:pd,_emscripten_bind_btConvexHullShape_setLocalScaling_1:Yg,_emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0:kj,_emscripten_bind_btCollisionWorld_getDispatcher_0:sn,_emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1:jj,_emscripten_bind_btTriangleMesh_btTriangleMesh_1:Qg,_i64Subtract:iF,_emscripten_bind_btRaycastVehicle_getWheelTransformWS_1:Sl,_emscripten_bind_btRigidBody_setDamping_2:qm,_emscripten_bind_btDynamicsWorld_getDispatcher_0:Di,_emscripten_bind_btGhostObject_setCollisionFlags_1:Dl,_emscripten_bind_btMatrix3x3_getRotation_1:Gc,_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1:pg,_emscripten_bind_btCylinderShapeX_setLocalScaling_1:an,_emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0:Sc,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0:le,_emscripten_bind_btCompoundShape_setLocalScaling_1:Dh,_emscripten_bind_btOverlappingPairCallback___destroy___0:lm,_emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0:Ce,_emscripten_bind_btVector4_setY_1:Yj,_emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1:Td,_emscripten_bind_btRigidBody_setContactProcessingThreshold_1:Km,_emscripten_bind_btRigidBody_getLinearVelocity_0:Cm,_emscripten_bind_btRigidBody_applyImpulse_2:xm,_emscripten_bind_btConcaveShape_calculateLocalInertia_2:Nj,_emscripten_bind_btRigidBody_setWorldTransform_1:Wm,_emscripten_bind_btRigidBody_setAngularVelocity_1:Fm,_emscripten_bind_btConvexShape_setLocalScaling_1:zg,_emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2:gi,_free:gF,_emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1:Ed,_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0:xi,_emscripten_bind_RayResultCallback_hasHit_0:hj,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0:re,_emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0:Kh,_emscripten_bind_btWheelInfo_get_m_frictionSlip_0:rj,_emscripten_bind_btConeShapeZ_setLocalScaling_1:Ig,_emscripten_bind_btPairCachingGhostObject_setActivationState_1:Fd,_emscripten_bind_btConvexTriangleMeshShape___destroy___0:Hf,_emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1:vh,_emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1:dn,_emscripten_bind_btRigidBody_getAngularVelocity_0:Dm,_emscripten_bind_btCompoundShape_btCompoundShape_0:Ah,_emscripten_bind_btCompoundShape_btCompoundShape_1:Bh,_emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1:Ak,_emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2:vk,_emscripten_bind_btDispatcherInfo_get_m_useContinuous_0:dd,_emscripten_bind_btRigidBody_updateInertiaTensor_0:Bm,_emscripten_bind_btTransform_setOrigin_1:mn,_emscripten_bind_ClosestRayResultCallback_hasHit_0:mi,_emscripten_bind_btCompoundShape_addChildShape_2:Ch,_emscripten_bind_btDispatcher___destroy___0:ki,_emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0:qh,_emscripten_bind_btDiscreteDynamicsWorld___destroy___0:Cf,_emscripten_bind_btConvexShape___destroy___0:Bg,_memmove:nF,_emscripten_bind_btCapsuleShapeX_setLocalScaling_1:Pi,_emscripten_bind_btCollisionObject_setRestitution_1:We,_emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0:zj,_emscripten_bind_LocalConvexResult_get_m_hitFraction_0:im,_emscripten_bind_btDispatcherInfo_get_m_enableSPU_0:hd,_emscripten_bind_btQuaternion_w_0:Xi,_emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0:Jf,_emscripten_bind_btTransform_getRotation_0:pn,_emscripten_bind_btHingeConstraint_btHingeConstraint_6:Zk,_emscripten_bind_btHingeConstraint_btHingeConstraint_7:_k,_emscripten_bind_btHingeConstraint_btHingeConstraint_4:Xk,_emscripten_bind_btHingeConstraint_btHingeConstraint_5:Yk,_emscripten_bind_btHingeConstraint_btHingeConstraint_2:Vk,_emscripten_bind_btHingeConstraint_btHingeConstraint_3:Wk,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1:se,_emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0:Mh,_emscripten_bind_btTypedConstraint___destroy___0:Tn,_emscripten_bind_btCylinderShapeX_btCylinderShapeX_1:$m,_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3:jf,_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1:hf,_emscripten_bind_btVector3_z_0:Hk,_emscripten_bind_btSphereShape_btSphereShape_1:Pk,_emscripten_bind_btQuaternion_y_0:Vi,_emscripten_bind_btCollisionWorld_addCollisionObject_1:wn,_emscripten_bind_btCollisionWorld_addCollisionObject_2:xn,_emscripten_bind_btRigidBody_setRestitution_1:Rm,_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1:Rh,_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0:Qh,_emscripten_bind_btRigidBody_getMotionState_0:Gm,_emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1:fj,_emscripten_bind_ConcreteContactResultCallback_addSingleResult_7:Kc,_emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0:Vc,_emscripten_bind_btActionInterface___destroy___0:zk,_emscripten_bind_btDefaultMotionState_setWorldTransform_1:bi,_emscripten_bind_btDefaultVehicleRaycaster___destroy___0:gj,_emscripten_bind_RayResultCallback_get_m_collisionObject_0:mj,_emscripten_bind_btPoint2PointConstraint_getPivotInA_0:Uf,_emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0:Ih,_emscripten_bind_btCylinderShape_calculateLocalInertia_2:On,_emscripten_bind_btGhostObject_setRestitution_1:zl,_emscripten_bind_btDynamicsWorld_addCollisionObject_1:Hi,_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0:Sh,_emscripten_bind_btDynamicsWorld_addCollisionObject_3:Ji,_emscripten_bind_btDynamicsWorld_addCollisionObject_2:Ii,_emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0:rf,_emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1:sk,_emscripten_bind_btVector4_op_mul_1:_j,_emscripten_bind_btCylinderShape_btCylinderShape_1:Mn,_emscripten_bind_btVector3___destroy___0:Nk,_emscripten_bind_btRigidBody_setAngularFactor_1:Hm,_emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2:fn,_emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1:Ml,_emscripten_bind_btMotionState_getWorldTransform_1:_f,_emscripten_bind_btDynamicsWorld_getBroadphase_0:Ki,_emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1:qd,_emscripten_bind_btVector3_x_0:Fk,___cxa_is_pointer_type:eF,_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3:Xd,_emscripten_bind_btCollisionObject_getCollisionShape_0:Oe,_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4:Yd,_emscripten_bind_btManifoldPoint___destroy___0:Ie,_emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1:ee,_emscripten_bind_btVector4_length_0:Tj,_emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1:di,_emscripten_bind_btCylinderShapeZ_setLocalScaling_1:en,_emscripten_bind_ClosestConvexResultCallback___destroy___0:Wh,_emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0:Uk,_emscripten_bind_btCollisionObject_setFriction_1:Xe,_emscripten_bind_btDefaultCollisionConfiguration___destroy___0:Eg,_emscripten_bind_btRigidBody_setMassProps_2:rm,_emscripten_bind_btVector3_setValue_3:Lk,_emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1:Sd,_emscripten_bind_btGhostObject_getCollisionFlags_0:Cl,_emscripten_bind_btCapsuleShapeX___destroy___0:Ri,_emscripten_bind_btHingeConstraint_setLimit_4:$k,_emscripten_bind_btHingeConstraint_setLimit_5:al,_emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1:Ij,_emscripten_bind_btConeShape_setLocalScaling_1:wg,_emscripten_bind_btGhostObject_getNumOverlappingObjects_0:pl,_emscripten_bind_btGhostObject_getCollisionShape_0:rl,_emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1:ce,_emscripten_bind_btPersistentManifold_getContactPoint_1:dh,_emscripten_bind_btConeShapeX_calculateLocalInertia_2:Ng,_emscripten_bind_btGhostObject_activate_0:vl,_emscripten_bind_btGhostObject_activate_1:wl,_emscripten_bind_btManifoldPoint_getPositionWorldOnB_0:xe,_emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0:Ee,_emscripten_bind_btConeShapeZ_btConeShapeZ_2:Hg,_emscripten_bind_btSphereShape___destroy___0:Sk,_emscripten_bind_btSliderConstraint_setUpperAngLimit_1:gg,_emscripten_bind_btDynamicsWorld_contactPairTest_3:Mi,_emscripten_bind_btCollisionWorld_getPairCache_0:un,_emscripten_bind_btConeTwistConstraint_setMotorTarget_1:rg,_emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1:Jh,_emscripten_bind_btWheelInfo_set_m_rollInfluence_1:uj,_emscripten_bind_btGhostObject_setCcdMotionThreshold_1:Gl,_emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0:Tk,_emscripten_bind_btGhostObject_forceActivationState_1:ul,_emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0:Jc,_emscripten_bind_VoidPtr___destroy___0:Uc,_emscripten_bind_btSliderConstraint_setLowerAngLimit_1:fg,_emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2:Gh,_emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0:ni,_emscripten_bind_btRaycastVehicle_getRigidBody_0:Wl,_emscripten_bind_btWheelInfo_get_m_steering_0:Dj,_emscripten_bind_btConstraintSetting_get_m_tau_0:hl,_emscripten_bind_btSliderConstraint___destroy___0:ig,_emscripten_bind_btCollisionShape___destroy___0:fl,_emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0:Nf,_emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0:$c,_emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0:de,_emscripten_bind_btPairCachingGhostObject_setCollisionShape_1:Rd,_emscripten_bind_btKinematicCharacterController_warp_1:fk,_emscripten_bind_btAxisSweep3___destroy___0:Bd,_emscripten_bind_btTriangleMesh___destroy___0:Ug,_emscripten_bind_btKinematicCharacterController_preStep_1:gk,_emscripten_bind_btRaycastVehicle_applyEngineForce_2:Ql,_emscripten_bind_btRaycastVehicle_setBrake_2:Yl,_emscripten_bind_ConcreteContactResultCallback___destroy___0:Lc,_emscripten_bind_btCollisionObject___destroy___0:df,_emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1:th,_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1:ie,_emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1:sg,_emscripten_bind_btDispatcherInfo_set_m_timeStep_1:Yc,_emscripten_bind_btVector3_btVector3_3:Dk,_emscripten_bind_btVector3_btVector3_0:Ck,_emscripten_bind_btBoxShape___destroy___0:ih,_emscripten_bind_btDiscreteDynamicsWorld_getGravity_0:gf,_emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0:Oh,_emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0:sh,_emscripten_bind_btConeTwistConstraint___destroy___0:ug,_emscripten_bind_btQuadWord___destroy___0:Ln,_emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1:oi,_emscripten_bind_btRigidBody_setCenterOfMassTransform_1:om,_emscripten_bind_btConstraintSolver___destroy___0:Ol,_emscripten_bind_btDbvtBroadphase___destroy___0:Tc,_emscripten_bind_btCapsuleShape_btCapsuleShape_2:sd,_emscripten_bind_btTypedConstraint_enableFeedback_1:Sn,_emscripten_bind_btQuadWord_setZ_1:Jn,_emscripten_bind_btCapsuleShape_setLocalScaling_1:td,_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0:ne,_emscripten_bind_btTriangleMeshShape_setLocalScaling_1:fi,_emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1:Of,_emscripten_bind_btPersistentManifold_btPersistentManifold_0:$g,_emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0:Lf,_emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2:li,_emscripten_bind_btVector4___destroy___0:$j,_emscripten_bind_btPairCachingGhostObject_isKinematicObject_0:Kd,_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1:yi,_i64Add:lF,_emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2:xk,_emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1:zh,_emscripten_bind_btCollisionObject_setCcdMotionThreshold_1:bf,_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0:Cg,_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1:Dg,_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3:ak,_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0:je,_emscripten_bind_btPoint2PointConstraint_getPivotInB_0:Vf,_emscripten_bind_btKinematicCharacterController_playerStep_2:hk,_emscripten_bind_btDispatcherInfo___destroy___0:rd,_emscripten_bind_btStaticPlaneShape_setLocalScaling_1:wk,_emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2:Gf,_emscripten_bind_ContactResultCallback_addSingleResult_7:Fg,_emscripten_bind_btGhostObject_getWorldTransform_0:Bl,_emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0:tf,_emscripten_bind_LocalConvexResult_set_m_hitFraction_1:jm,_emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2:dj,_emscripten_bind_btDispatcherInfo_get_m_timeStep_0:Xc,_emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1:rh,_emscripten_bind_btDynamicsWorld___destroy___0:Ni,_emscripten_bind_btMotionState___destroy___0:ag,_emscripten_bind_btCollisionObject_setCollisionFlags_1:_e,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1:vf,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2:wf,_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3:xf,_emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1:qj,_emscripten_bind_btRaycastVehicle_getNumWheels_0:Vl,_emscripten_bind_btDispatcher_getManifoldByIndexInternal_1:ji,_emscripten_bind_btWheelInfo_set_m_steering_1:Ej,_emscripten_bind_btPairCachingGhostObject_setWorldTransform_1:Qd,_emscripten_bind_btConeTwistConstraint_setAngularOnly_1:mg,_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4:Rf,_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2:Qf,_emscripten_bind_btKinematicCharacterController_setJumpSpeed_1:jk,_emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1:Kf,_emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1:Vd,_emscripten_bind_btRigidBodyConstructionInfo___destroy___0:ve,_emscripten_bind_btRigidBody_getWorldTransform_0:Tm,_emscripten_bind_btPoint2PointConstraint_setPivotA_1:Sf,_emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1:Lh,_memcpy:mF,_emscripten_bind_btCapsuleShape_calculateLocalInertia_2:ud,_emscripten_bind_btVector3_y_0:Gk,_emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0:yh,_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2:Mc,_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3:Oc,_emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0:Ll,_emscripten_bind_btGhostObject_setCollisionShape_1:Fl,_emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1:md,_emscripten_bind_btQuaternion_setW_1:$i,_emscripten_bind_btDiscreteDynamicsWorld_setGravity_1:ff,_emscripten_bind_btGhostObject_isActive_0:xl,_emscripten_bind_btVector4_z_0:Wj,_emscripten_bind_btCollisionObject_forceActivationState_1:Re,_emscripten_bind_btKinematicCharacterController_onGround_0:tk,_emscripten_bind_btRaycastVehicle_getWheelInfo_1:Xl,_emscripten_bind_btConeTwistConstraint_setLimit_2:lg,_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1:Th,_emscripten_bind_btRigidBody___destroy___0:_m,_emscripten_bind_btStridingMeshInterface___destroy___0:Me,_emscripten_bind_btRigidBody_setSleepingThresholds_2:pm,_emscripten_bind_btCollisionObject_setWorldTransform_1:$e,_emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0:cm,_emscripten_bind_btManifoldPoint_get_m_localPointA_0:ye,_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0:Zd,_emscripten_bind_btCollisionWorld_getBroadphase_0:zn,_emscripten_bind_btDispatcher_getNumManifolds_0:ii,_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0:he,_emscripten_bind_btRigidBody_activate_1:Om,_emscripten_bind_btRigidBody_activate_0:Nm,_emscripten_bind_btRaycastVehicle___destroy___0:_l,_emscripten_bind_btGhostObject_setActivationState_1:tl,_emscripten_bind_btCollisionWorld_contactPairTest_3:Bn,_emscripten_bind_btCylinderShapeX___destroy___0:cn,_emscripten_bind_btManifoldPoint_getPositionWorldOnA_0:we,_emscripten_bind_ContactResultCallback___destroy___0:Gg,_emscripten_bind_btDispatcherInfo_set_m_stepCount_1:_c,_emscripten_bind_btVector4_x_0:Uj,_emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1:Pd,_emscripten_bind_btKinematicCharacterController_getGhostObject_0:rk,_emscripten_bind_btRigidBody_btRigidBody_1:mm,_emscripten_bind_btTriangleMeshShape___destroy___0:hi,_emscripten_bind_btKinematicCharacterController_setWalkDirection_1:dk,_emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0:fe,_emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0:oh,_emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1:He,_emscripten_bind_btKinematicCharacterController_getGravity_0:ok,_emscripten_bind_btDiscreteDynamicsWorld_addAction_1:Bf,_emscripten_bind_btQuaternion_setY_1:Zi,_emscripten_bind_btConeShape_calculateLocalInertia_2:xg,_emscripten_bind_btCylinderShapeX_calculateLocalInertia_2:bn,_emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1:Mf,_llvm_bswap_i32:oF,_emscripten_bind_btSphereShape_setLocalScaling_1:Qk,_emscripten_bind_btVector4_w_0:Rj,_emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0:Ge,_emscripten_bind_btBvhTriangleMeshShape___destroy___0:Rc,_emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0:pi,_emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1:Vh,_emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1:nf,_emscripten_bind_btVector4_y_0:Vj,_emscripten_bind_btGeneric6DofConstraint___destroy___0:Le,_emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0:uh,_emscripten_bind_btConvexHullShape_addPoint_1:Wg,_emscripten_bind_btConvexHullShape_addPoint_2:Xg,_emscripten_bind_btTransform_getOrigin_0:on,_emscripten_bind_btHingeConstraint___destroy___0:cl,_emscripten_bind_btHingeConstraint_enableFeedback_1:bl,_emscripten_bind_btConvexShape_calculateLocalInertia_2:Ag,_memset:jF,_emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0:ri,_emscripten_bind_btTriangleMesh_btTriangleMesh_0:Pg,_emscripten_bind_btPairCachingGhostObject_getCollisionShape_0:Dd,_emscripten_bind_btTriangleMesh_btTriangleMesh_2:Rg,_emscripten_bind_btTransform___destroy___0:rn,_emscripten_bind_btWheelInfo_set_m_frictionSlip_1:sj,_emscripten_bind_btRigidBody_getCollisionShape_0:Jm,_emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1:Fe,_emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0:Bj,_emscripten_bind_btManifoldPoint_get_m_localPointB_0:Ae,_emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3:Af,_emscripten_bind_btSliderConstraint_setLowerLinLimit_1:dg,_emscripten_bind_btPoint2PointConstraint_set_m_setting_1:Yf,_emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1:cf,_emscripten_bind_btWheelInfo_get_m_wheelsRadius_0:xj,_emscripten_bind_btRigidBody_setLinearVelocity_1:Em,_emscripten_bind_btVehicleTuning_btVehicleTuning_0:nh,_emscripten_bind_RayResultCallback_set_m_collisionObject_1:nj,_emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1:qi,_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0:vi,_emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1:Cj,_emscripten_bind_btDynamicsWorld_addAction_1:Ci,_emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0:Od,_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1:_d,_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1:me,_emscripten_bind_btKinematicCharacterController_setFallSpeed_1:ik,_emscripten_bind_btRigidBody_setActivationState_1:Lm,_emscripten_bind_ClosestConvexResultCallback_hasHit_0:Hh,_emscripten_bind_btCapsuleShapeZ___destroy___0:ej,_emscripten_bind_LocalShapeInfo_set_m_shapePart_1:Kl,_emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0:zi,_emscripten_bind_btTriangleMesh_addTriangle_3:Sg,_emscripten_bind_btGhostObject_getOverlappingObject_1:ql,_emscripten_bind_btTriangleMesh_addTriangle_4:Tg,_emscripten_bind_btRigidBody_applyTorqueImpulse_1:wm,_emscripten_bind_btRigidBody_setCollisionFlags_1:Vm,_emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1:wj,_emscripten_bind_btConeShape___destroy___0:yg,_emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2:bj,_emscripten_bind_btSliderConstraint_btSliderConstraint_5:cg,_emscripten_bind_btSliderConstraint_btSliderConstraint_3:bg,_emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0:ld,_emscripten_bind_btDynamicsWorld_convexSweepTest_5:Li,_emscripten_bind_btRigidBody_forceActivationState_1:Mm,_emscripten_bind_btPoint2PointConstraint_setPivotB_1:Tf,_emscripten_bind_btGhostPairCallback___destroy___0:Rn,_emscripten_bind_btKinematicCharacterController_getMaxSlope_0:qk,_emscripten_bind_btSliderConstraint_enableFeedback_1:hg,_emscripten_bind_btRaycastVehicle_addWheel_7:Ul,_emscripten_bind_btPairCachingGhostObject_isActive_0:Jd,_emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1:dm,_emscripten_bind_btStaticPlaneShape___destroy___0:yk,_emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0:nd,_emscripten_bind_btBoxShape_setLocalScaling_1:gh,_emscripten_bind_btConeShapeZ___destroy___0:Kg,_emscripten_bind_btDynamicsWorld_getPairCache_0:Fi,_emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5:zf,_emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2:ek,_emscripten_bind_btVector4_btVector4_0:Pj,_emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0:fd,_emscripten_bind_btVector4_btVector4_4:Qj,_emscripten_bind_btKinematicCharacterController___destroy___0:uk,_emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1:bm,_emscripten_bind_btConstraintSetting_btConstraintSetting_0:gl,_emscripten_bind_btDiscreteDynamicsWorld_rayTest_3:sf,_emscripten_bind_btGhostPairCallback_btGhostPairCallback_0:Qn,_emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1:kk,_emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1:si,_emscripten_bind_btVehicleTuning_get_m_frictionSlip_0:wh,__GLOBAL__I_a:zE,runPostSets:hF,stackAlloc:wc,stackSave:xc,stackRestore:yc,setThrew:zc,setTempRet0:Cc,getTempRet0:Dc,dynCall_viiiii:BF,dynCall_vid:CF,dynCall_vi:DF,dynCall_viiidii:EF,dynCall_vii:FF,dynCall_iiiiiiiiiii:GF,dynCall_ii:HF,dynCall_viidi:IF,dynCall_viddiii:JF,dynCall_vidii:KF,dynCall_iiiii:LF,dynCall_vidi:MF,dynCall_diiiiiiii:NF,dynCall_viiiiddddiid:OF,dynCall_diiiii:PF,dynCall_iiii:QF,dynCall_viiiiii:RF,dynCall_iiid:SF,dynCall_di:TF,dynCall_iiiiiii:UF,dynCall_diiidii:VF,dynCall_viidii:WF,dynCall_viiiiiii:XF,dynCall_viiiiiiiii:YF,dynCall_viiiiiiiiii:ZF,dynCall_iii:_F,dynCall_diii:$F,dynCall_diiiiiiiiii:aG,dynCall_viiiid:bG,dynCall_diiiiiiiii:cG,dynCall_did:dG,dynCall_viiiidddddidi:eG,dynCall_diidii:fG,dynCall_diiii:gG,dynCall_iiiiiiiiii:hG,dynCall_viiid:iG,dynCall_viii:jG,dynCall_v:kG,dynCall_viid:lG,dynCall_iidid:mG,dynCall_viiii:nG}})


// EMSCRIPTEN_END_ASM
(Module.asmGlobalArg,Module.asmLibraryArg,buffer);var _emscripten_bind_btCylinderShape___destroy___0=Module["_emscripten_bind_btCylinderShape___destroy___0"]=asm["_emscripten_bind_btCylinderShape___destroy___0"];var _strlen=Module["_strlen"]=asm["_strlen"];var _emscripten_bind_btDispatcherInfo_set_m_useContinuous_1=Module["_emscripten_bind_btDispatcherInfo_set_m_useContinuous_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_useContinuous_1"];var _emscripten_bind_btCollisionObject_isActive_0=Module["_emscripten_bind_btCollisionObject_isActive_0"]=asm["_emscripten_bind_btCollisionObject_isActive_0"];var _emscripten_bind_btVehicleTuning_set_m_frictionSlip_1=Module["_emscripten_bind_btVehicleTuning_set_m_frictionSlip_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_frictionSlip_1"];var _emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4=Module["_emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4"];var _emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1=Module["_emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1"]=asm["_emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1"];var _emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0"];var _emscripten_bind_btQuaternion_setX_1=Module["_emscripten_bind_btQuaternion_setX_1"]=asm["_emscripten_bind_btQuaternion_setX_1"];var _emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0=Module["_emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0"];var _emscripten_bind_btQuaternion_setZ_1=Module["_emscripten_bind_btQuaternion_setZ_1"]=asm["_emscripten_bind_btQuaternion_setZ_1"];var _emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0=Module["_emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0"]=asm["_emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0"];var _emscripten_bind_btKinematicCharacterController_setMaxSlope_1=Module["_emscripten_bind_btKinematicCharacterController_setMaxSlope_1"]=asm["_emscripten_bind_btKinematicCharacterController_setMaxSlope_1"];var _emscripten_bind_btQuadWord_z_0=Module["_emscripten_bind_btQuadWord_z_0"]=asm["_emscripten_bind_btQuadWord_z_0"];var _emscripten_bind_btTransform_setIdentity_0=Module["_emscripten_bind_btTransform_setIdentity_0"]=asm["_emscripten_bind_btTransform_setIdentity_0"];var _emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0=Module["_emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0"]=asm["_emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0"];var _emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0=Module["_emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0"]=asm["_emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0"];var _emscripten_bind_btCollisionDispatcher___destroy___0=Module["_emscripten_bind_btCollisionDispatcher___destroy___0"]=asm["_emscripten_bind_btCollisionDispatcher___destroy___0"];var _emscripten_bind_btRigidBody_applyCentralImpulse_1=Module["_emscripten_bind_btRigidBody_applyCentralImpulse_1"]=asm["_emscripten_bind_btRigidBody_applyCentralImpulse_1"];var _emscripten_bind_btDefaultMotionState_getWorldTransform_1=Module["_emscripten_bind_btDefaultMotionState_getWorldTransform_1"]=asm["_emscripten_bind_btDefaultMotionState_getWorldTransform_1"];var _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1"];var _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3=Module["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3"];var _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2=Module["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2"];var _emscripten_bind_btVector3_op_mul_1=Module["_emscripten_bind_btVector3_op_mul_1"]=asm["_emscripten_bind_btVector3_op_mul_1"];var _emscripten_bind_btDynamicsWorld_rayTest_3=Module["_emscripten_bind_btDynamicsWorld_rayTest_3"]=asm["_emscripten_bind_btDynamicsWorld_rayTest_3"];var _emscripten_bind_btRaycastVehicle_updateWheelTransform_2=Module["_emscripten_bind_btRaycastVehicle_updateWheelTransform_2"]=asm["_emscripten_bind_btRaycastVehicle_updateWheelTransform_2"];var _emscripten_bind_btQuadWord_x_0=Module["_emscripten_bind_btQuadWord_x_0"]=asm["_emscripten_bind_btQuadWord_x_0"];var _emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0=Module["_emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0"]=asm["_emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0"];var _emscripten_bind_btCollisionObject_isKinematicObject_0=Module["_emscripten_bind_btCollisionObject_isKinematicObject_0"]=asm["_emscripten_bind_btCollisionObject_isKinematicObject_0"];var _emscripten_bind_ConvexResultCallback___destroy___0=Module["_emscripten_bind_ConvexResultCallback___destroy___0"]=asm["_emscripten_bind_ConvexResultCallback___destroy___0"];var _emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1"];var _emscripten_bind_btRigidBody_getCenterOfMassTransform_0=Module["_emscripten_bind_btRigidBody_getCenterOfMassTransform_0"]=asm["_emscripten_bind_btRigidBody_getCenterOfMassTransform_0"];var _emscripten_bind_btGhostObject_isKinematicObject_0=Module["_emscripten_bind_btGhostObject_isKinematicObject_0"]=asm["_emscripten_bind_btGhostObject_isKinematicObject_0"];var _emscripten_bind_btCapsuleShape___destroy___0=Module["_emscripten_bind_btCapsuleShape___destroy___0"]=asm["_emscripten_bind_btCapsuleShape___destroy___0"];var _emscripten_bind_btCollisionObject_activate_1=Module["_emscripten_bind_btCollisionObject_activate_1"]=asm["_emscripten_bind_btCollisionObject_activate_1"];var _emscripten_bind_btCollisionObject_activate_0=Module["_emscripten_bind_btCollisionObject_activate_0"]=asm["_emscripten_bind_btCollisionObject_activate_0"];var _emscripten_bind_btKinematicCharacterController_setUpAxis_1=Module["_emscripten_bind_btKinematicCharacterController_setUpAxis_1"]=asm["_emscripten_bind_btKinematicCharacterController_setUpAxis_1"];var _emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1=Module["_emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1"];var _emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1=Module["_emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1"]=asm["_emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1"];var _emscripten_bind_btVector3_setX_1=Module["_emscripten_bind_btVector3_setX_1"]=asm["_emscripten_bind_btVector3_setX_1"];var _emscripten_bind_btCollisionConfiguration___destroy___0=Module["_emscripten_bind_btCollisionConfiguration___destroy___0"]=asm["_emscripten_bind_btCollisionConfiguration___destroy___0"];var _emscripten_bind_btQuaternion_btQuaternion_4=Module["_emscripten_bind_btQuaternion_btQuaternion_4"]=asm["_emscripten_bind_btQuaternion_btQuaternion_4"];var _emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1=Module["_emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1"]=asm["_emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1"];var _emscripten_bind_btManifoldPoint_set_m_localPointB_1=Module["_emscripten_bind_btManifoldPoint_set_m_localPointB_1"]=asm["_emscripten_bind_btManifoldPoint_set_m_localPointB_1"];var _emscripten_bind_btVector3_setZ_1=Module["_emscripten_bind_btVector3_setZ_1"]=asm["_emscripten_bind_btVector3_setZ_1"];var _emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0=Module["_emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0"]=asm["_emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0"];var _emscripten_bind_btQuaternion_setValue_4=Module["_emscripten_bind_btQuaternion_setValue_4"]=asm["_emscripten_bind_btQuaternion_setValue_4"];var _emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1=Module["_emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1"];var _emscripten_bind_LocalShapeInfo___destroy___0=Module["_emscripten_bind_LocalShapeInfo___destroy___0"]=asm["_emscripten_bind_LocalShapeInfo___destroy___0"];var _emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0=Module["_emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0"]=asm["_emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0"];var _emscripten_bind_btQuadWord_setY_1=Module["_emscripten_bind_btQuadWord_setY_1"]=asm["_emscripten_bind_btQuadWord_setY_1"];var _emscripten_bind_btRigidBody_isKinematicObject_0=Module["_emscripten_bind_btRigidBody_isKinematicObject_0"]=asm["_emscripten_bind_btRigidBody_isKinematicObject_0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1"];var _emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0=Module["_emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0"]=asm["_emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0"];var _emscripten_bind_btConeTwistConstraint_setDamping_1=Module["_emscripten_bind_btConeTwistConstraint_setDamping_1"]=asm["_emscripten_bind_btConeTwistConstraint_setDamping_1"];var _emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0=Module["_emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0"]=asm["_emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0"];var _emscripten_bind_btCollisionWorld___destroy___0=Module["_emscripten_bind_btCollisionWorld___destroy___0"]=asm["_emscripten_bind_btCollisionWorld___destroy___0"];var _emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0=Module["_emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0"]=asm["_emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0"];var _emscripten_bind_btBoxShape_btBoxShape_1=Module["_emscripten_bind_btBoxShape_btBoxShape_1"]=asm["_emscripten_bind_btBoxShape_btBoxShape_1"];var _emscripten_bind_btPersistentManifold_getBody1_0=Module["_emscripten_bind_btPersistentManifold_getBody1_0"]=asm["_emscripten_bind_btPersistentManifold_getBody1_0"];var _emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1"];var _emscripten_bind_btKinematicCharacterController_setGravity_1=Module["_emscripten_bind_btKinematicCharacterController_setGravity_1"]=asm["_emscripten_bind_btKinematicCharacterController_setGravity_1"];var _emscripten_bind_btConstraintSetting_set_m_impulseClamp_1=Module["_emscripten_bind_btConstraintSetting_set_m_impulseClamp_1"]=asm["_emscripten_bind_btConstraintSetting_set_m_impulseClamp_1"];var _emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5=Module["_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5"]=asm["_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5"];var _emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3=Module["_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3"]=asm["_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3"];var _emscripten_bind_LocalShapeInfo_get_m_shapePart_0=Module["_emscripten_bind_LocalShapeInfo_get_m_shapePart_0"]=asm["_emscripten_bind_LocalShapeInfo_get_m_shapePart_0"];var _emscripten_bind_btWheelInfo_get_m_rollInfluence_0=Module["_emscripten_bind_btWheelInfo_get_m_rollInfluence_0"]=asm["_emscripten_bind_btWheelInfo_get_m_rollInfluence_0"];var _emscripten_bind_btVector4_setValue_4=Module["_emscripten_bind_btVector4_setValue_4"]=asm["_emscripten_bind_btVector4_setValue_4"];var _emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1=Module["_emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1"]=asm["_emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1"];var _emscripten_bind_btDynamicsWorld_getDispatchInfo_0=Module["_emscripten_bind_btDynamicsWorld_getDispatchInfo_0"]=asm["_emscripten_bind_btDynamicsWorld_getDispatchInfo_0"];var _emscripten_bind_btVector3_length_0=Module["_emscripten_bind_btVector3_length_0"]=asm["_emscripten_bind_btVector3_length_0"];var _emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2=Module["_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2"]=asm["_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2"];var _emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1=Module["_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1"]=asm["_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1"];var _emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1"];var _emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1=Module["_emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1"]=asm["_emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1"];var _emscripten_bind_btPairCachingGhostObject___destroy___0=Module["_emscripten_bind_btPairCachingGhostObject___destroy___0"]=asm["_emscripten_bind_btPairCachingGhostObject___destroy___0"];var _emscripten_bind_btPairCachingGhostObject_activate_0=Module["_emscripten_bind_btPairCachingGhostObject_activate_0"]=asm["_emscripten_bind_btPairCachingGhostObject_activate_0"];var _emscripten_bind_btPairCachingGhostObject_activate_1=Module["_emscripten_bind_btPairCachingGhostObject_activate_1"]=asm["_emscripten_bind_btPairCachingGhostObject_activate_1"];var _emscripten_bind_btPairCachingGhostObject_forceActivationState_1=Module["_emscripten_bind_btPairCachingGhostObject_forceActivationState_1"]=asm["_emscripten_bind_btPairCachingGhostObject_forceActivationState_1"];var _emscripten_bind_btDefaultMotionState___destroy___0=Module["_emscripten_bind_btDefaultMotionState___destroy___0"]=asm["_emscripten_bind_btDefaultMotionState___destroy___0"];var _emscripten_bind_btDispatcherInfo_get_m_stepCount_0=Module["_emscripten_bind_btDispatcherInfo_get_m_stepCount_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_stepCount_0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1"];var _emscripten_bind_btQuadWord_setW_1=Module["_emscripten_bind_btQuadWord_setW_1"]=asm["_emscripten_bind_btQuadWord_setW_1"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0"];var _emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2=Module["_emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2"]=asm["_emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2"];var _emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0=Module["_emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0"]=asm["_emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0"];var _emscripten_bind_btRigidBody_setLinearFactor_1=Module["_emscripten_bind_btRigidBody_setLinearFactor_1"]=asm["_emscripten_bind_btRigidBody_setLinearFactor_1"];var _emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1=Module["_emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1"];var _emscripten_bind_btRaycastVehicle_setSteeringValue_2=Module["_emscripten_bind_btRaycastVehicle_setSteeringValue_2"]=asm["_emscripten_bind_btRaycastVehicle_setSteeringValue_2"];var _emscripten_bind_btPoint2PointConstraint___destroy___0=Module["_emscripten_bind_btPoint2PointConstraint___destroy___0"]=asm["_emscripten_bind_btPoint2PointConstraint___destroy___0"];var _emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2=Module["_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2"];var _emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1"];var _malloc=Module["_malloc"]=asm["_malloc"];var _emscripten_bind_btDispatcherInfo_get_m_useEpa_0=Module["_emscripten_bind_btDispatcherInfo_get_m_useEpa_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_useEpa_0"];var _emscripten_bind_btTransform_btTransform_2=Module["_emscripten_bind_btTransform_btTransform_2"]=asm["_emscripten_bind_btTransform_btTransform_2"];var _emscripten_bind_btTransform_btTransform_0=Module["_emscripten_bind_btTransform_btTransform_0"]=asm["_emscripten_bind_btTransform_btTransform_0"];var _emscripten_bind_btWheelInfo_set_m_wheelsRadius_1=Module["_emscripten_bind_btWheelInfo_set_m_wheelsRadius_1"]=asm["_emscripten_bind_btWheelInfo_set_m_wheelsRadius_1"];var _emscripten_bind_btDispatcherInfo_set_m_enableSPU_1=Module["_emscripten_bind_btDispatcherInfo_set_m_enableSPU_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_enableSPU_1"];var _emscripten_bind_btRaycastVehicle_setCoordinateSystem_3=Module["_emscripten_bind_btRaycastVehicle_setCoordinateSystem_3"]=asm["_emscripten_bind_btRaycastVehicle_setCoordinateSystem_3"];var _emscripten_bind_btCollisionObject_setActivationState_1=Module["_emscripten_bind_btCollisionObject_setActivationState_1"]=asm["_emscripten_bind_btCollisionObject_setActivationState_1"];var _emscripten_bind_btPersistentManifold___destroy___0=Module["_emscripten_bind_btPersistentManifold___destroy___0"]=asm["_emscripten_bind_btPersistentManifold___destroy___0"];var _emscripten_bind_btConstraintSetting_get_m_impulseClamp_0=Module["_emscripten_bind_btConstraintSetting_get_m_impulseClamp_0"]=asm["_emscripten_bind_btConstraintSetting_get_m_impulseClamp_0"];var _emscripten_bind_btCylinderShapeZ___destroy___0=Module["_emscripten_bind_btCylinderShapeZ___destroy___0"]=asm["_emscripten_bind_btCylinderShapeZ___destroy___0"];var _emscripten_bind_btMatrix3x3___destroy___0=Module["_emscripten_bind_btMatrix3x3___destroy___0"]=asm["_emscripten_bind_btMatrix3x3___destroy___0"];var _emscripten_bind_ConvexResultCallback_hasHit_0=Module["_emscripten_bind_ConvexResultCallback_hasHit_0"]=asm["_emscripten_bind_ConvexResultCallback_hasHit_0"];var _emscripten_bind_btCollisionShape_calculateLocalInertia_2=Module["_emscripten_bind_btCollisionShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btCollisionShape_calculateLocalInertia_2"];var _emscripten_bind_btCollisionWorld_convexSweepTest_5=Module["_emscripten_bind_btCollisionWorld_convexSweepTest_5"]=asm["_emscripten_bind_btCollisionWorld_convexSweepTest_5"];var _emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1"];var _emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2=Module["_emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2"]=asm["_emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2"];var _emscripten_bind_btConstraintSetting_set_m_damping_1=Module["_emscripten_bind_btConstraintSetting_set_m_damping_1"]=asm["_emscripten_bind_btConstraintSetting_set_m_damping_1"];var _emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1=Module["_emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1"]=asm["_emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1"];var _emscripten_bind_btRigidBody_setCcdMotionThreshold_1=Module["_emscripten_bind_btRigidBody_setCcdMotionThreshold_1"]=asm["_emscripten_bind_btRigidBody_setCcdMotionThreshold_1"];var _emscripten_bind_btRigidBody_applyForce_2=Module["_emscripten_bind_btRigidBody_applyForce_2"]=asm["_emscripten_bind_btRigidBody_applyForce_2"];var _emscripten_bind_btConeShapeZ_calculateLocalInertia_2=Module["_emscripten_bind_btConeShapeZ_calculateLocalInertia_2"]=asm["_emscripten_bind_btConeShapeZ_calculateLocalInertia_2"];var _emscripten_bind_btConstraintSetting_set_m_tau_1=Module["_emscripten_bind_btConstraintSetting_set_m_tau_1"]=asm["_emscripten_bind_btConstraintSetting_set_m_tau_1"];var _emscripten_bind_btConvexHullShape_calculateLocalInertia_2=Module["_emscripten_bind_btConvexHullShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btConvexHullShape_calculateLocalInertia_2"];var _emscripten_bind_btSphereShape_calculateLocalInertia_2=Module["_emscripten_bind_btSphereShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btSphereShape_calculateLocalInertia_2"];var _emscripten_bind_btPoint2PointConstraint_get_m_setting_0=Module["_emscripten_bind_btPoint2PointConstraint_get_m_setting_0"]=asm["_emscripten_bind_btPoint2PointConstraint_get_m_setting_0"];var _emscripten_bind_LocalConvexResult_LocalConvexResult_5=Module["_emscripten_bind_LocalConvexResult_LocalConvexResult_5"]=asm["_emscripten_bind_LocalConvexResult_LocalConvexResult_5"];var _emscripten_bind_btGhostObject_setFriction_1=Module["_emscripten_bind_btGhostObject_setFriction_1"]=asm["_emscripten_bind_btGhostObject_setFriction_1"];var _emscripten_bind_btPairCachingGhostObject_getWorldTransform_0=Module["_emscripten_bind_btPairCachingGhostObject_getWorldTransform_0"]=asm["_emscripten_bind_btPairCachingGhostObject_getWorldTransform_0"];var _emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1=Module["_emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1"]=asm["_emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1"];var _emscripten_bind_btRigidBody_setFriction_1=Module["_emscripten_bind_btRigidBody_setFriction_1"]=asm["_emscripten_bind_btRigidBody_setFriction_1"];var _emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1=Module["_emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1"]=asm["_emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1"];var _emscripten_bind_btGhostObject_setWorldTransform_1=Module["_emscripten_bind_btGhostObject_setWorldTransform_1"]=asm["_emscripten_bind_btGhostObject_setWorldTransform_1"];var _emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1"];var _emscripten_bind_btConvexHullShape___destroy___0=Module["_emscripten_bind_btConvexHullShape___destroy___0"]=asm["_emscripten_bind_btConvexHullShape___destroy___0"];var _emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0=Module["_emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0"];var _emscripten_bind_btVector4_setX_1=Module["_emscripten_bind_btVector4_setX_1"]=asm["_emscripten_bind_btVector4_setX_1"];var _emscripten_bind_btKinematicCharacterController_jump_0=Module["_emscripten_bind_btKinematicCharacterController_jump_0"]=asm["_emscripten_bind_btKinematicCharacterController_jump_0"];var _emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1=Module["_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1"]=asm["_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1"];var _emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1=Module["_emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1"]=asm["_emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1"];var _emscripten_bind_btRigidBody_upcast_1=Module["_emscripten_bind_btRigidBody_upcast_1"]=asm["_emscripten_bind_btRigidBody_upcast_1"];var _emscripten_bind_btCollisionObject_getWorldTransform_0=Module["_emscripten_bind_btCollisionObject_getWorldTransform_0"]=asm["_emscripten_bind_btCollisionObject_getWorldTransform_0"];var _emscripten_bind_btVector4_setZ_1=Module["_emscripten_bind_btVector4_setZ_1"]=asm["_emscripten_bind_btVector4_setZ_1"];var _emscripten_bind_btQuadWord_y_0=Module["_emscripten_bind_btQuadWord_y_0"]=asm["_emscripten_bind_btQuadWord_y_0"];var ___cxa_can_catch=Module["___cxa_can_catch"]=asm["___cxa_can_catch"];var _emscripten_bind_btTransform_getBasis_0=Module["_emscripten_bind_btTransform_getBasis_0"]=asm["_emscripten_bind_btTransform_getBasis_0"];var _emscripten_bind_btPairCachingGhostObject_setFriction_1=Module["_emscripten_bind_btPairCachingGhostObject_setFriction_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setFriction_1"];var _emscripten_bind_btDispatcherInfo_set_m_useEpa_1=Module["_emscripten_bind_btDispatcherInfo_set_m_useEpa_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_useEpa_1"];var _emscripten_bind_btCollisionDispatcher_getNumManifolds_0=Module["_emscripten_bind_btCollisionDispatcher_getNumManifolds_0"]=asm["_emscripten_bind_btCollisionDispatcher_getNumManifolds_0"];var _emscripten_bind_btVehicleRaycaster___destroy___0=Module["_emscripten_bind_btVehicleRaycaster___destroy___0"]=asm["_emscripten_bind_btVehicleRaycaster___destroy___0"];var _emscripten_bind_ClosestRayResultCallback___destroy___0=Module["_emscripten_bind_ClosestRayResultCallback___destroy___0"]=asm["_emscripten_bind_ClosestRayResultCallback___destroy___0"];var _emscripten_bind_btQuadWord_w_0=Module["_emscripten_bind_btQuadWord_w_0"]=asm["_emscripten_bind_btQuadWord_w_0"];var _emscripten_bind_btCompoundShape___destroy___0=Module["_emscripten_bind_btCompoundShape___destroy___0"]=asm["_emscripten_bind_btCompoundShape___destroy___0"];var _emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2=Module["_emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2"];var _emscripten_bind_btGhostObject_btGhostObject_0=Module["_emscripten_bind_btGhostObject_btGhostObject_0"]=asm["_emscripten_bind_btGhostObject_btGhostObject_0"];var _emscripten_bind_btConeShape_btConeShape_2=Module["_emscripten_bind_btConeShape_btConeShape_2"]=asm["_emscripten_bind_btConeShape_btConeShape_2"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1"];var _emscripten_bind_btManifoldPoint_set_m_localPointA_1=Module["_emscripten_bind_btManifoldPoint_set_m_localPointA_1"]=asm["_emscripten_bind_btManifoldPoint_set_m_localPointA_1"];var _emscripten_bind_btCollisionObject_setCollisionShape_1=Module["_emscripten_bind_btCollisionObject_setCollisionShape_1"]=asm["_emscripten_bind_btCollisionObject_setCollisionShape_1"];var _emscripten_bind_btWheelInfo___destroy___0=Module["_emscripten_bind_btWheelInfo___destroy___0"]=asm["_emscripten_bind_btWheelInfo___destroy___0"];var _emscripten_bind_btTransform_setRotation_1=Module["_emscripten_bind_btTransform_setRotation_1"]=asm["_emscripten_bind_btTransform_setRotation_1"];var _emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0=Module["_emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0"]=asm["_emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0"];var _emscripten_bind_btPoint2PointConstraint_enableFeedback_1=Module["_emscripten_bind_btPoint2PointConstraint_enableFeedback_1"]=asm["_emscripten_bind_btPoint2PointConstraint_enableFeedback_1"];var _emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1"];var _emscripten_bind_btAxisSweep3_btAxisSweep3_2=Module["_emscripten_bind_btAxisSweep3_btAxisSweep3_2"]=asm["_emscripten_bind_btAxisSweep3_btAxisSweep3_2"];var _emscripten_bind_btAxisSweep3_btAxisSweep3_3=Module["_emscripten_bind_btAxisSweep3_btAxisSweep3_3"]=asm["_emscripten_bind_btAxisSweep3_btAxisSweep3_3"];var _emscripten_bind_btBoxShape_calculateLocalInertia_2=Module["_emscripten_bind_btBoxShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btBoxShape_calculateLocalInertia_2"];var _emscripten_bind_btVector3_setY_1=Module["_emscripten_bind_btVector3_setY_1"]=asm["_emscripten_bind_btVector3_setY_1"];var _emscripten_bind_btAxisSweep3_btAxisSweep3_4=Module["_emscripten_bind_btAxisSweep3_btAxisSweep3_4"]=asm["_emscripten_bind_btAxisSweep3_btAxisSweep3_4"];var _emscripten_bind_btAxisSweep3_btAxisSweep3_5=Module["_emscripten_bind_btAxisSweep3_btAxisSweep3_5"]=asm["_emscripten_bind_btAxisSweep3_btAxisSweep3_5"];var _emscripten_bind_btQuadWord_setX_1=Module["_emscripten_bind_btQuadWord_setX_1"]=asm["_emscripten_bind_btQuadWord_setX_1"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0"];var _emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1=Module["_emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1"];var _emscripten_bind_btOverlappingPairCache___destroy___0=Module["_emscripten_bind_btOverlappingPairCache___destroy___0"]=asm["_emscripten_bind_btOverlappingPairCache___destroy___0"];var _emscripten_bind_btConstraintSetting___destroy___0=Module["_emscripten_bind_btConstraintSetting___destroy___0"]=asm["_emscripten_bind_btConstraintSetting___destroy___0"];var _emscripten_bind_RayResultCallback___destroy___0=Module["_emscripten_bind_RayResultCallback___destroy___0"]=asm["_emscripten_bind_RayResultCallback___destroy___0"];var _emscripten_bind_btPersistentManifold_getBody0_0=Module["_emscripten_bind_btPersistentManifold_getBody0_0"]=asm["_emscripten_bind_btPersistentManifold_getBody0_0"];var _emscripten_bind_btConeShapeX_btConeShapeX_2=Module["_emscripten_bind_btConeShapeX_btConeShapeX_2"]=asm["_emscripten_bind_btConeShapeX_btConeShapeX_2"];var _emscripten_bind_btConeTwistConstraint_enableFeedback_1=Module["_emscripten_bind_btConeTwistConstraint_enableFeedback_1"]=asm["_emscripten_bind_btConeTwistConstraint_enableFeedback_1"];var _emscripten_bind_btCapsuleShapeZ_setLocalScaling_1=Module["_emscripten_bind_btCapsuleShapeZ_setLocalScaling_1"]=asm["_emscripten_bind_btCapsuleShapeZ_setLocalScaling_1"];var _emscripten_bind_btRigidBody_applyTorque_1=Module["_emscripten_bind_btRigidBody_applyTorque_1"]=asm["_emscripten_bind_btRigidBody_applyTorque_1"];var _emscripten_bind_btSliderConstraint_setUpperLinLimit_1=Module["_emscripten_bind_btSliderConstraint_setUpperLinLimit_1"]=asm["_emscripten_bind_btSliderConstraint_setUpperLinLimit_1"];var _emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2=Module["_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2"]=asm["_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2"];var _emscripten_bind_btConcaveShape___destroy___0=Module["_emscripten_bind_btConcaveShape___destroy___0"]=asm["_emscripten_bind_btConcaveShape___destroy___0"];var _emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4=Module["_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4"]=asm["_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4"];var _emscripten_bind_btQuaternion_x_0=Module["_emscripten_bind_btQuaternion_x_0"]=asm["_emscripten_bind_btQuaternion_x_0"];var _emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1=Module["_emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1"]=asm["_emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1"];var _emscripten_bind_btConcaveShape_setLocalScaling_1=Module["_emscripten_bind_btConcaveShape_setLocalScaling_1"]=asm["_emscripten_bind_btConcaveShape_setLocalScaling_1"];var _emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0=Module["_emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0"];var _emscripten_bind_btConeShapeX_setLocalScaling_1=Module["_emscripten_bind_btConeShapeX_setLocalScaling_1"]=asm["_emscripten_bind_btConeShapeX_setLocalScaling_1"];var _emscripten_bind_btQuaternion_z_0=Module["_emscripten_bind_btQuaternion_z_0"]=asm["_emscripten_bind_btQuaternion_z_0"];var _emscripten_bind_btConvexHullShape_btConvexHullShape_0=Module["_emscripten_bind_btConvexHullShape_btConvexHullShape_0"]=asm["_emscripten_bind_btConvexHullShape_btConvexHullShape_0"];var _emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1=Module["_emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1"]=asm["_emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1"];var _emscripten_bind_btConstraintSetting_get_m_damping_0=Module["_emscripten_bind_btConstraintSetting_get_m_damping_0"]=asm["_emscripten_bind_btConstraintSetting_get_m_damping_0"];var _emscripten_bind_btGhostObject___destroy___0=Module["_emscripten_bind_btGhostObject___destroy___0"]=asm["_emscripten_bind_btGhostObject___destroy___0"];var _emscripten_bind_btGhostObject_setContactProcessingThreshold_1=Module["_emscripten_bind_btGhostObject_setContactProcessingThreshold_1"]=asm["_emscripten_bind_btGhostObject_setContactProcessingThreshold_1"];var _emscripten_bind_btRigidBody_applyCentralForce_1=Module["_emscripten_bind_btRigidBody_applyCentralForce_1"]=asm["_emscripten_bind_btRigidBody_applyCentralForce_1"];var _emscripten_bind_btQuaternion___destroy___0=Module["_emscripten_bind_btQuaternion___destroy___0"]=asm["_emscripten_bind_btQuaternion___destroy___0"];var _emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1=Module["_emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1"]=asm["_emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1"];var _emscripten_bind_btDefaultMotionState_btDefaultMotionState_2=Module["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_2"]=asm["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_2"];var _emscripten_bind_btDefaultMotionState_btDefaultMotionState_0=Module["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_0"]=asm["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_0"];var _emscripten_bind_btDefaultMotionState_btDefaultMotionState_1=Module["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_1"]=asm["_emscripten_bind_btDefaultMotionState_btDefaultMotionState_1"];var _emscripten_bind_btKinematicCharacterController_canJump_0=Module["_emscripten_bind_btKinematicCharacterController_canJump_0"]=asm["_emscripten_bind_btKinematicCharacterController_canJump_0"];var _emscripten_bind_btRigidBody_isActive_0=Module["_emscripten_bind_btRigidBody_isActive_0"]=asm["_emscripten_bind_btRigidBody_isActive_0"];var _emscripten_bind_btRaycastVehicle_btRaycastVehicle_3=Module["_emscripten_bind_btRaycastVehicle_btRaycastVehicle_3"]=asm["_emscripten_bind_btRaycastVehicle_btRaycastVehicle_3"];var _emscripten_bind_btMotionState_setWorldTransform_1=Module["_emscripten_bind_btMotionState_setWorldTransform_1"]=asm["_emscripten_bind_btMotionState_setWorldTransform_1"];var _emscripten_bind_btCylinderShape_setLocalScaling_1=Module["_emscripten_bind_btCylinderShape_setLocalScaling_1"]=asm["_emscripten_bind_btCylinderShape_setLocalScaling_1"];var _emscripten_bind_btCollisionWorld_rayTest_3=Module["_emscripten_bind_btCollisionWorld_rayTest_3"]=asm["_emscripten_bind_btCollisionWorld_rayTest_3"];var _emscripten_bind_btCompoundShape_calculateLocalInertia_2=Module["_emscripten_bind_btCompoundShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btCompoundShape_calculateLocalInertia_2"];var _emscripten_bind_btCollisionWorld_getDispatchInfo_0=Module["_emscripten_bind_btCollisionWorld_getDispatchInfo_0"]=asm["_emscripten_bind_btCollisionWorld_getDispatchInfo_0"];var _emscripten_bind_btRigidBody_setCollisionShape_1=Module["_emscripten_bind_btRigidBody_setCollisionShape_1"]=asm["_emscripten_bind_btRigidBody_setCollisionShape_1"];var _emscripten_bind_btConeShapeX___destroy___0=Module["_emscripten_bind_btConeShapeX___destroy___0"]=asm["_emscripten_bind_btConeShapeX___destroy___0"];var _emscripten_bind_btCollisionObject_getCollisionFlags_0=Module["_emscripten_bind_btCollisionObject_getCollisionFlags_0"]=asm["_emscripten_bind_btCollisionObject_getCollisionFlags_0"];var _emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1=Module["_emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1"];var _emscripten_bind_btConeTwistConstraint_enableMotor_1=Module["_emscripten_bind_btConeTwistConstraint_enableMotor_1"]=asm["_emscripten_bind_btConeTwistConstraint_enableMotor_1"];var _emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1=Module["_emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1"]=asm["_emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1"];var _emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4=Module["_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4"]=asm["_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4"];var _emscripten_bind_btPairCachingGhostObject_setRestitution_1=Module["_emscripten_bind_btPairCachingGhostObject_setRestitution_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setRestitution_1"];var _emscripten_bind_btBroadphaseInterface___destroy___0=Module["_emscripten_bind_btBroadphaseInterface___destroy___0"]=asm["_emscripten_bind_btBroadphaseInterface___destroy___0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1"];var _emscripten_bind_btCollisionObject_setContactProcessingThreshold_1=Module["_emscripten_bind_btCollisionObject_setContactProcessingThreshold_1"]=asm["_emscripten_bind_btCollisionObject_setContactProcessingThreshold_1"];var _emscripten_bind_btPersistentManifold_getNumContacts_0=Module["_emscripten_bind_btPersistentManifold_getNumContacts_0"]=asm["_emscripten_bind_btPersistentManifold_getNumContacts_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0"];var _emscripten_bind_LocalConvexResult___destroy___0=Module["_emscripten_bind_LocalConvexResult___destroy___0"]=asm["_emscripten_bind_LocalConvexResult___destroy___0"];var _emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0=Module["_emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0"]=asm["_emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1"];var _emscripten_bind_btCollisionWorld_addCollisionObject_3=Module["_emscripten_bind_btCollisionWorld_addCollisionObject_3"]=asm["_emscripten_bind_btCollisionWorld_addCollisionObject_3"];var _emscripten_bind_btRigidBody_getCollisionFlags_0=Module["_emscripten_bind_btRigidBody_getCollisionFlags_0"]=asm["_emscripten_bind_btRigidBody_getCollisionFlags_0"];var _emscripten_bind_btCollisionShape_setLocalScaling_1=Module["_emscripten_bind_btCollisionShape_setLocalScaling_1"]=asm["_emscripten_bind_btCollisionShape_setLocalScaling_1"];var _emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0"];var _emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0=Module["_emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0"]=asm["_emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0"];var _emscripten_bind_btMatrix3x3_setEulerZYX_3=Module["_emscripten_bind_btMatrix3x3_setEulerZYX_3"]=asm["_emscripten_bind_btMatrix3x3_setEulerZYX_3"];var _emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0=Module["_emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0"];var _emscripten_bind_btConvexHullShape_setLocalScaling_1=Module["_emscripten_bind_btConvexHullShape_setLocalScaling_1"]=asm["_emscripten_bind_btConvexHullShape_setLocalScaling_1"];var _emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0=Module["_emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0"]=asm["_emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0"];var _emscripten_bind_btCollisionWorld_getDispatcher_0=Module["_emscripten_bind_btCollisionWorld_getDispatcher_0"]=asm["_emscripten_bind_btCollisionWorld_getDispatcher_0"];var _emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1=Module["_emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1"]=asm["_emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1"];var _emscripten_bind_btTriangleMesh_btTriangleMesh_1=Module["_emscripten_bind_btTriangleMesh_btTriangleMesh_1"]=asm["_emscripten_bind_btTriangleMesh_btTriangleMesh_1"];var _i64Subtract=Module["_i64Subtract"]=asm["_i64Subtract"];var _emscripten_bind_btRaycastVehicle_getWheelTransformWS_1=Module["_emscripten_bind_btRaycastVehicle_getWheelTransformWS_1"]=asm["_emscripten_bind_btRaycastVehicle_getWheelTransformWS_1"];var _emscripten_bind_btRigidBody_setDamping_2=Module["_emscripten_bind_btRigidBody_setDamping_2"]=asm["_emscripten_bind_btRigidBody_setDamping_2"];var _emscripten_bind_btDynamicsWorld_getDispatcher_0=Module["_emscripten_bind_btDynamicsWorld_getDispatcher_0"]=asm["_emscripten_bind_btDynamicsWorld_getDispatcher_0"];var _emscripten_bind_btGhostObject_setCollisionFlags_1=Module["_emscripten_bind_btGhostObject_setCollisionFlags_1"]=asm["_emscripten_bind_btGhostObject_setCollisionFlags_1"];var _emscripten_bind_btMatrix3x3_getRotation_1=Module["_emscripten_bind_btMatrix3x3_getRotation_1"]=asm["_emscripten_bind_btMatrix3x3_getRotation_1"];var _emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1=Module["_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1"]=asm["_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1"];var _emscripten_bind_btCylinderShapeX_setLocalScaling_1=Module["_emscripten_bind_btCylinderShapeX_setLocalScaling_1"]=asm["_emscripten_bind_btCylinderShapeX_setLocalScaling_1"];var _emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0=Module["_emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0"]=asm["_emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0"];var _emscripten_bind_btCompoundShape_setLocalScaling_1=Module["_emscripten_bind_btCompoundShape_setLocalScaling_1"]=asm["_emscripten_bind_btCompoundShape_setLocalScaling_1"];var _emscripten_bind_btOverlappingPairCallback___destroy___0=Module["_emscripten_bind_btOverlappingPairCallback___destroy___0"]=asm["_emscripten_bind_btOverlappingPairCallback___destroy___0"];var _emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0=Module["_emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0"]=asm["_emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0"];var _emscripten_bind_btVector4_setY_1=Module["_emscripten_bind_btVector4_setY_1"]=asm["_emscripten_bind_btVector4_setY_1"];var _emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1=Module["_emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1"];var _emscripten_bind_btRigidBody_setContactProcessingThreshold_1=Module["_emscripten_bind_btRigidBody_setContactProcessingThreshold_1"]=asm["_emscripten_bind_btRigidBody_setContactProcessingThreshold_1"];var _emscripten_bind_btRigidBody_getLinearVelocity_0=Module["_emscripten_bind_btRigidBody_getLinearVelocity_0"]=asm["_emscripten_bind_btRigidBody_getLinearVelocity_0"];var _emscripten_bind_btRigidBody_applyImpulse_2=Module["_emscripten_bind_btRigidBody_applyImpulse_2"]=asm["_emscripten_bind_btRigidBody_applyImpulse_2"];var _emscripten_bind_btConcaveShape_calculateLocalInertia_2=Module["_emscripten_bind_btConcaveShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btConcaveShape_calculateLocalInertia_2"];var _emscripten_bind_btRigidBody_setWorldTransform_1=Module["_emscripten_bind_btRigidBody_setWorldTransform_1"]=asm["_emscripten_bind_btRigidBody_setWorldTransform_1"];var _emscripten_bind_btRigidBody_setAngularVelocity_1=Module["_emscripten_bind_btRigidBody_setAngularVelocity_1"]=asm["_emscripten_bind_btRigidBody_setAngularVelocity_1"];var _emscripten_bind_btConvexShape_setLocalScaling_1=Module["_emscripten_bind_btConvexShape_setLocalScaling_1"]=asm["_emscripten_bind_btConvexShape_setLocalScaling_1"];var _emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2=Module["_emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2"];var _free=Module["_free"]=asm["_free"];var _emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1=Module["_emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1"];var _emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0"];var _emscripten_bind_RayResultCallback_hasHit_0=Module["_emscripten_bind_RayResultCallback_hasHit_0"]=asm["_emscripten_bind_RayResultCallback_hasHit_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0"];var _emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0"];var _emscripten_bind_btWheelInfo_get_m_frictionSlip_0=Module["_emscripten_bind_btWheelInfo_get_m_frictionSlip_0"]=asm["_emscripten_bind_btWheelInfo_get_m_frictionSlip_0"];var _emscripten_bind_btConeShapeZ_setLocalScaling_1=Module["_emscripten_bind_btConeShapeZ_setLocalScaling_1"]=asm["_emscripten_bind_btConeShapeZ_setLocalScaling_1"];var _emscripten_bind_btPairCachingGhostObject_setActivationState_1=Module["_emscripten_bind_btPairCachingGhostObject_setActivationState_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setActivationState_1"];var _emscripten_bind_btConvexTriangleMeshShape___destroy___0=Module["_emscripten_bind_btConvexTriangleMeshShape___destroy___0"]=asm["_emscripten_bind_btConvexTriangleMeshShape___destroy___0"];var _emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1=Module["_emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1"];var _emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1=Module["_emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1"]=asm["_emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1"];var _emscripten_bind_btRigidBody_getAngularVelocity_0=Module["_emscripten_bind_btRigidBody_getAngularVelocity_0"]=asm["_emscripten_bind_btRigidBody_getAngularVelocity_0"];var _emscripten_bind_btCompoundShape_btCompoundShape_0=Module["_emscripten_bind_btCompoundShape_btCompoundShape_0"]=asm["_emscripten_bind_btCompoundShape_btCompoundShape_0"];var _emscripten_bind_btCompoundShape_btCompoundShape_1=Module["_emscripten_bind_btCompoundShape_btCompoundShape_1"]=asm["_emscripten_bind_btCompoundShape_btCompoundShape_1"];var _emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1=Module["_emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1"]=asm["_emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1"];var _emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2=Module["_emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2"]=asm["_emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2"];var _emscripten_bind_btDispatcherInfo_get_m_useContinuous_0=Module["_emscripten_bind_btDispatcherInfo_get_m_useContinuous_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_useContinuous_0"];var _emscripten_bind_btRigidBody_updateInertiaTensor_0=Module["_emscripten_bind_btRigidBody_updateInertiaTensor_0"]=asm["_emscripten_bind_btRigidBody_updateInertiaTensor_0"];var _emscripten_bind_btTransform_setOrigin_1=Module["_emscripten_bind_btTransform_setOrigin_1"]=asm["_emscripten_bind_btTransform_setOrigin_1"];var _emscripten_bind_ClosestRayResultCallback_hasHit_0=Module["_emscripten_bind_ClosestRayResultCallback_hasHit_0"]=asm["_emscripten_bind_ClosestRayResultCallback_hasHit_0"];var _emscripten_bind_btCompoundShape_addChildShape_2=Module["_emscripten_bind_btCompoundShape_addChildShape_2"]=asm["_emscripten_bind_btCompoundShape_addChildShape_2"];var _emscripten_bind_btDispatcher___destroy___0=Module["_emscripten_bind_btDispatcher___destroy___0"]=asm["_emscripten_bind_btDispatcher___destroy___0"];var _emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0=Module["_emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0"];var _emscripten_bind_btDiscreteDynamicsWorld___destroy___0=Module["_emscripten_bind_btDiscreteDynamicsWorld___destroy___0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld___destroy___0"];var _emscripten_bind_btConvexShape___destroy___0=Module["_emscripten_bind_btConvexShape___destroy___0"]=asm["_emscripten_bind_btConvexShape___destroy___0"];var _memmove=Module["_memmove"]=asm["_memmove"];var _emscripten_bind_btCapsuleShapeX_setLocalScaling_1=Module["_emscripten_bind_btCapsuleShapeX_setLocalScaling_1"]=asm["_emscripten_bind_btCapsuleShapeX_setLocalScaling_1"];var _emscripten_bind_btCollisionObject_setRestitution_1=Module["_emscripten_bind_btCollisionObject_setRestitution_1"]=asm["_emscripten_bind_btCollisionObject_setRestitution_1"];var _emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0=Module["_emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0"]=asm["_emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0"];var _emscripten_bind_LocalConvexResult_get_m_hitFraction_0=Module["_emscripten_bind_LocalConvexResult_get_m_hitFraction_0"]=asm["_emscripten_bind_LocalConvexResult_get_m_hitFraction_0"];var _emscripten_bind_btDispatcherInfo_get_m_enableSPU_0=Module["_emscripten_bind_btDispatcherInfo_get_m_enableSPU_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_enableSPU_0"];var _emscripten_bind_btQuaternion_w_0=Module["_emscripten_bind_btQuaternion_w_0"]=asm["_emscripten_bind_btQuaternion_w_0"];var _emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0=Module["_emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0"]=asm["_emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0"];var _emscripten_bind_btTransform_getRotation_0=Module["_emscripten_bind_btTransform_getRotation_0"]=asm["_emscripten_bind_btTransform_getRotation_0"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_6=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_6"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_6"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_7=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_7"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_7"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_4=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_4"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_4"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_5=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_5"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_5"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_2=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_2"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_2"];var _emscripten_bind_btHingeConstraint_btHingeConstraint_3=Module["_emscripten_bind_btHingeConstraint_btHingeConstraint_3"]=asm["_emscripten_bind_btHingeConstraint_btHingeConstraint_3"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1"];var _emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0"];var _emscripten_bind_btTypedConstraint___destroy___0=Module["_emscripten_bind_btTypedConstraint___destroy___0"]=asm["_emscripten_bind_btTypedConstraint___destroy___0"];var _emscripten_bind_btCylinderShapeX_btCylinderShapeX_1=Module["_emscripten_bind_btCylinderShapeX_btCylinderShapeX_1"]=asm["_emscripten_bind_btCylinderShapeX_btCylinderShapeX_1"];var _emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3=Module["_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3"];var _emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1"];var _emscripten_bind_btVector3_z_0=Module["_emscripten_bind_btVector3_z_0"]=asm["_emscripten_bind_btVector3_z_0"];var _emscripten_bind_btSphereShape_btSphereShape_1=Module["_emscripten_bind_btSphereShape_btSphereShape_1"]=asm["_emscripten_bind_btSphereShape_btSphereShape_1"];var _emscripten_bind_btQuaternion_y_0=Module["_emscripten_bind_btQuaternion_y_0"]=asm["_emscripten_bind_btQuaternion_y_0"];var _emscripten_bind_btCollisionWorld_addCollisionObject_1=Module["_emscripten_bind_btCollisionWorld_addCollisionObject_1"]=asm["_emscripten_bind_btCollisionWorld_addCollisionObject_1"];var _emscripten_bind_btCollisionWorld_addCollisionObject_2=Module["_emscripten_bind_btCollisionWorld_addCollisionObject_2"]=asm["_emscripten_bind_btCollisionWorld_addCollisionObject_2"];var _emscripten_bind_btRigidBody_setRestitution_1=Module["_emscripten_bind_btRigidBody_setRestitution_1"]=asm["_emscripten_bind_btRigidBody_setRestitution_1"];var _emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1"];var _emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0"];var _emscripten_bind_btRigidBody_getMotionState_0=Module["_emscripten_bind_btRigidBody_getMotionState_0"]=asm["_emscripten_bind_btRigidBody_getMotionState_0"];var _emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1=Module["_emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1"]=asm["_emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1"];var _emscripten_bind_ConcreteContactResultCallback_addSingleResult_7=Module["_emscripten_bind_ConcreteContactResultCallback_addSingleResult_7"]=asm["_emscripten_bind_ConcreteContactResultCallback_addSingleResult_7"];var _emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0=Module["_emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0"]=asm["_emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0"];var _emscripten_bind_btActionInterface___destroy___0=Module["_emscripten_bind_btActionInterface___destroy___0"]=asm["_emscripten_bind_btActionInterface___destroy___0"];var _emscripten_bind_btDefaultMotionState_setWorldTransform_1=Module["_emscripten_bind_btDefaultMotionState_setWorldTransform_1"]=asm["_emscripten_bind_btDefaultMotionState_setWorldTransform_1"];var _emscripten_bind_btDefaultVehicleRaycaster___destroy___0=Module["_emscripten_bind_btDefaultVehicleRaycaster___destroy___0"]=asm["_emscripten_bind_btDefaultVehicleRaycaster___destroy___0"];var _emscripten_bind_RayResultCallback_get_m_collisionObject_0=Module["_emscripten_bind_RayResultCallback_get_m_collisionObject_0"]=asm["_emscripten_bind_RayResultCallback_get_m_collisionObject_0"];var _emscripten_bind_btPoint2PointConstraint_getPivotInA_0=Module["_emscripten_bind_btPoint2PointConstraint_getPivotInA_0"]=asm["_emscripten_bind_btPoint2PointConstraint_getPivotInA_0"];var _emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0"];var _emscripten_bind_btCylinderShape_calculateLocalInertia_2=Module["_emscripten_bind_btCylinderShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btCylinderShape_calculateLocalInertia_2"];var _emscripten_bind_btGhostObject_setRestitution_1=Module["_emscripten_bind_btGhostObject_setRestitution_1"]=asm["_emscripten_bind_btGhostObject_setRestitution_1"];var _emscripten_bind_btDynamicsWorld_addCollisionObject_1=Module["_emscripten_bind_btDynamicsWorld_addCollisionObject_1"]=asm["_emscripten_bind_btDynamicsWorld_addCollisionObject_1"];var _emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0"];var _emscripten_bind_btDynamicsWorld_addCollisionObject_3=Module["_emscripten_bind_btDynamicsWorld_addCollisionObject_3"]=asm["_emscripten_bind_btDynamicsWorld_addCollisionObject_3"];var _emscripten_bind_btDynamicsWorld_addCollisionObject_2=Module["_emscripten_bind_btDynamicsWorld_addCollisionObject_2"]=asm["_emscripten_bind_btDynamicsWorld_addCollisionObject_2"];var _emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0=Module["_emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0"];var _emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1=Module["_emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1"]=asm["_emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1"];var _emscripten_bind_btVector4_op_mul_1=Module["_emscripten_bind_btVector4_op_mul_1"]=asm["_emscripten_bind_btVector4_op_mul_1"];var _emscripten_bind_btCylinderShape_btCylinderShape_1=Module["_emscripten_bind_btCylinderShape_btCylinderShape_1"]=asm["_emscripten_bind_btCylinderShape_btCylinderShape_1"];var _emscripten_bind_btVector3___destroy___0=Module["_emscripten_bind_btVector3___destroy___0"]=asm["_emscripten_bind_btVector3___destroy___0"];var _emscripten_bind_btRigidBody_setAngularFactor_1=Module["_emscripten_bind_btRigidBody_setAngularFactor_1"]=asm["_emscripten_bind_btRigidBody_setAngularFactor_1"];var _emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2=Module["_emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2"]=asm["_emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2"];var _emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1=Module["_emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1"]=asm["_emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1"];var _emscripten_bind_btMotionState_getWorldTransform_1=Module["_emscripten_bind_btMotionState_getWorldTransform_1"]=asm["_emscripten_bind_btMotionState_getWorldTransform_1"];var _emscripten_bind_btDynamicsWorld_getBroadphase_0=Module["_emscripten_bind_btDynamicsWorld_getBroadphase_0"]=asm["_emscripten_bind_btDynamicsWorld_getBroadphase_0"];var _emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1=Module["_emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1"];var _emscripten_bind_btVector3_x_0=Module["_emscripten_bind_btVector3_x_0"]=asm["_emscripten_bind_btVector3_x_0"];var ___cxa_is_pointer_type=Module["___cxa_is_pointer_type"]=asm["___cxa_is_pointer_type"];var _emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3=Module["_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3"];var _emscripten_bind_btCollisionObject_getCollisionShape_0=Module["_emscripten_bind_btCollisionObject_getCollisionShape_0"]=asm["_emscripten_bind_btCollisionObject_getCollisionShape_0"];var _emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4=Module["_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4"];var _emscripten_bind_btManifoldPoint___destroy___0=Module["_emscripten_bind_btManifoldPoint___destroy___0"]=asm["_emscripten_bind_btManifoldPoint___destroy___0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1"];var _emscripten_bind_btVector4_length_0=Module["_emscripten_bind_btVector4_length_0"]=asm["_emscripten_bind_btVector4_length_0"];var _emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1=Module["_emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1"]=asm["_emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1"];var _emscripten_bind_btCylinderShapeZ_setLocalScaling_1=Module["_emscripten_bind_btCylinderShapeZ_setLocalScaling_1"]=asm["_emscripten_bind_btCylinderShapeZ_setLocalScaling_1"];var _emscripten_bind_ClosestConvexResultCallback___destroy___0=Module["_emscripten_bind_ClosestConvexResultCallback___destroy___0"]=asm["_emscripten_bind_ClosestConvexResultCallback___destroy___0"];var _emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0=Module["_emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0"]=asm["_emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0"];var _emscripten_bind_btCollisionObject_setFriction_1=Module["_emscripten_bind_btCollisionObject_setFriction_1"]=asm["_emscripten_bind_btCollisionObject_setFriction_1"];var _emscripten_bind_btDefaultCollisionConfiguration___destroy___0=Module["_emscripten_bind_btDefaultCollisionConfiguration___destroy___0"]=asm["_emscripten_bind_btDefaultCollisionConfiguration___destroy___0"];var _emscripten_bind_btRigidBody_setMassProps_2=Module["_emscripten_bind_btRigidBody_setMassProps_2"]=asm["_emscripten_bind_btRigidBody_setMassProps_2"];var _emscripten_bind_btVector3_setValue_3=Module["_emscripten_bind_btVector3_setValue_3"]=asm["_emscripten_bind_btVector3_setValue_3"];var _emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1=Module["_emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1"];var _emscripten_bind_btGhostObject_getCollisionFlags_0=Module["_emscripten_bind_btGhostObject_getCollisionFlags_0"]=asm["_emscripten_bind_btGhostObject_getCollisionFlags_0"];var _emscripten_bind_btCapsuleShapeX___destroy___0=Module["_emscripten_bind_btCapsuleShapeX___destroy___0"]=asm["_emscripten_bind_btCapsuleShapeX___destroy___0"];var _emscripten_bind_btHingeConstraint_setLimit_4=Module["_emscripten_bind_btHingeConstraint_setLimit_4"]=asm["_emscripten_bind_btHingeConstraint_setLimit_4"];var _emscripten_bind_btHingeConstraint_setLimit_5=Module["_emscripten_bind_btHingeConstraint_setLimit_5"]=asm["_emscripten_bind_btHingeConstraint_setLimit_5"];var _emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1=Module["_emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1"]=asm["_emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1"];var _emscripten_bind_btConeShape_setLocalScaling_1=Module["_emscripten_bind_btConeShape_setLocalScaling_1"]=asm["_emscripten_bind_btConeShape_setLocalScaling_1"];var _emscripten_bind_btGhostObject_getNumOverlappingObjects_0=Module["_emscripten_bind_btGhostObject_getNumOverlappingObjects_0"]=asm["_emscripten_bind_btGhostObject_getNumOverlappingObjects_0"];var _emscripten_bind_btGhostObject_getCollisionShape_0=Module["_emscripten_bind_btGhostObject_getCollisionShape_0"]=asm["_emscripten_bind_btGhostObject_getCollisionShape_0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1"];var _emscripten_bind_btPersistentManifold_getContactPoint_1=Module["_emscripten_bind_btPersistentManifold_getContactPoint_1"]=asm["_emscripten_bind_btPersistentManifold_getContactPoint_1"];var _emscripten_bind_btConeShapeX_calculateLocalInertia_2=Module["_emscripten_bind_btConeShapeX_calculateLocalInertia_2"]=asm["_emscripten_bind_btConeShapeX_calculateLocalInertia_2"];var _emscripten_bind_btGhostObject_activate_0=Module["_emscripten_bind_btGhostObject_activate_0"]=asm["_emscripten_bind_btGhostObject_activate_0"];var _emscripten_bind_btGhostObject_activate_1=Module["_emscripten_bind_btGhostObject_activate_1"]=asm["_emscripten_bind_btGhostObject_activate_1"];var _emscripten_bind_btManifoldPoint_getPositionWorldOnB_0=Module["_emscripten_bind_btManifoldPoint_getPositionWorldOnB_0"]=asm["_emscripten_bind_btManifoldPoint_getPositionWorldOnB_0"];var _emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0=Module["_emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0"]=asm["_emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0"];var _emscripten_bind_btConeShapeZ_btConeShapeZ_2=Module["_emscripten_bind_btConeShapeZ_btConeShapeZ_2"]=asm["_emscripten_bind_btConeShapeZ_btConeShapeZ_2"];var _emscripten_bind_btSphereShape___destroy___0=Module["_emscripten_bind_btSphereShape___destroy___0"]=asm["_emscripten_bind_btSphereShape___destroy___0"];var _emscripten_bind_btSliderConstraint_setUpperAngLimit_1=Module["_emscripten_bind_btSliderConstraint_setUpperAngLimit_1"]=asm["_emscripten_bind_btSliderConstraint_setUpperAngLimit_1"];var _emscripten_bind_btDynamicsWorld_contactPairTest_3=Module["_emscripten_bind_btDynamicsWorld_contactPairTest_3"]=asm["_emscripten_bind_btDynamicsWorld_contactPairTest_3"];var _emscripten_bind_btCollisionWorld_getPairCache_0=Module["_emscripten_bind_btCollisionWorld_getPairCache_0"]=asm["_emscripten_bind_btCollisionWorld_getPairCache_0"];var _emscripten_bind_btConeTwistConstraint_setMotorTarget_1=Module["_emscripten_bind_btConeTwistConstraint_setMotorTarget_1"]=asm["_emscripten_bind_btConeTwistConstraint_setMotorTarget_1"];var _emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1"];var _emscripten_bind_btWheelInfo_set_m_rollInfluence_1=Module["_emscripten_bind_btWheelInfo_set_m_rollInfluence_1"]=asm["_emscripten_bind_btWheelInfo_set_m_rollInfluence_1"];var _emscripten_bind_btGhostObject_setCcdMotionThreshold_1=Module["_emscripten_bind_btGhostObject_setCcdMotionThreshold_1"]=asm["_emscripten_bind_btGhostObject_setCcdMotionThreshold_1"];var _emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0=Module["_emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0"]=asm["_emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0"];var _emscripten_bind_btGhostObject_forceActivationState_1=Module["_emscripten_bind_btGhostObject_forceActivationState_1"]=asm["_emscripten_bind_btGhostObject_forceActivationState_1"];var _emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0=Module["_emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0"]=asm["_emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0"];var _emscripten_bind_VoidPtr___destroy___0=Module["_emscripten_bind_VoidPtr___destroy___0"]=asm["_emscripten_bind_VoidPtr___destroy___0"];var _emscripten_bind_btSliderConstraint_setLowerAngLimit_1=Module["_emscripten_bind_btSliderConstraint_setLowerAngLimit_1"]=asm["_emscripten_bind_btSliderConstraint_setLowerAngLimit_1"];var _emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2=Module["_emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2"]=asm["_emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2"];var _emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0"];var _emscripten_bind_btRaycastVehicle_getRigidBody_0=Module["_emscripten_bind_btRaycastVehicle_getRigidBody_0"]=asm["_emscripten_bind_btRaycastVehicle_getRigidBody_0"];var _emscripten_bind_btWheelInfo_get_m_steering_0=Module["_emscripten_bind_btWheelInfo_get_m_steering_0"]=asm["_emscripten_bind_btWheelInfo_get_m_steering_0"];var _emscripten_bind_btConstraintSetting_get_m_tau_0=Module["_emscripten_bind_btConstraintSetting_get_m_tau_0"]=asm["_emscripten_bind_btConstraintSetting_get_m_tau_0"];var _emscripten_bind_btSliderConstraint___destroy___0=Module["_emscripten_bind_btSliderConstraint___destroy___0"]=asm["_emscripten_bind_btSliderConstraint___destroy___0"];var _emscripten_bind_btCollisionShape___destroy___0=Module["_emscripten_bind_btCollisionShape___destroy___0"]=asm["_emscripten_bind_btCollisionShape___destroy___0"];var _emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0=Module["_emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0"]=asm["_emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0"];var _emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0=Module["_emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0"];var _emscripten_bind_btPairCachingGhostObject_setCollisionShape_1=Module["_emscripten_bind_btPairCachingGhostObject_setCollisionShape_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setCollisionShape_1"];var _emscripten_bind_btKinematicCharacterController_warp_1=Module["_emscripten_bind_btKinematicCharacterController_warp_1"]=asm["_emscripten_bind_btKinematicCharacterController_warp_1"];var _emscripten_bind_btAxisSweep3___destroy___0=Module["_emscripten_bind_btAxisSweep3___destroy___0"]=asm["_emscripten_bind_btAxisSweep3___destroy___0"];var _emscripten_bind_btTriangleMesh___destroy___0=Module["_emscripten_bind_btTriangleMesh___destroy___0"]=asm["_emscripten_bind_btTriangleMesh___destroy___0"];var _emscripten_bind_btKinematicCharacterController_preStep_1=Module["_emscripten_bind_btKinematicCharacterController_preStep_1"]=asm["_emscripten_bind_btKinematicCharacterController_preStep_1"];var _emscripten_bind_btRaycastVehicle_applyEngineForce_2=Module["_emscripten_bind_btRaycastVehicle_applyEngineForce_2"]=asm["_emscripten_bind_btRaycastVehicle_applyEngineForce_2"];var _emscripten_bind_btRaycastVehicle_setBrake_2=Module["_emscripten_bind_btRaycastVehicle_setBrake_2"]=asm["_emscripten_bind_btRaycastVehicle_setBrake_2"];var _emscripten_bind_ConcreteContactResultCallback___destroy___0=Module["_emscripten_bind_ConcreteContactResultCallback___destroy___0"]=asm["_emscripten_bind_ConcreteContactResultCallback___destroy___0"];var _emscripten_bind_btCollisionObject___destroy___0=Module["_emscripten_bind_btCollisionObject___destroy___0"]=asm["_emscripten_bind_btCollisionObject___destroy___0"];var _emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1=Module["_emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1"];var _emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1=Module["_emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1"]=asm["_emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1"];var _emscripten_bind_btDispatcherInfo_set_m_timeStep_1=Module["_emscripten_bind_btDispatcherInfo_set_m_timeStep_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_timeStep_1"];var _emscripten_bind_btVector3_btVector3_3=Module["_emscripten_bind_btVector3_btVector3_3"]=asm["_emscripten_bind_btVector3_btVector3_3"];var _emscripten_bind_btVector3_btVector3_0=Module["_emscripten_bind_btVector3_btVector3_0"]=asm["_emscripten_bind_btVector3_btVector3_0"];var _emscripten_bind_btBoxShape___destroy___0=Module["_emscripten_bind_btBoxShape___destroy___0"]=asm["_emscripten_bind_btBoxShape___destroy___0"];var _emscripten_bind_btDiscreteDynamicsWorld_getGravity_0=Module["_emscripten_bind_btDiscreteDynamicsWorld_getGravity_0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_getGravity_0"];var _emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0=Module["_emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0"];var _emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0=Module["_emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0"];var _emscripten_bind_btConeTwistConstraint___destroy___0=Module["_emscripten_bind_btConeTwistConstraint___destroy___0"]=asm["_emscripten_bind_btConeTwistConstraint___destroy___0"];var _emscripten_bind_btQuadWord___destroy___0=Module["_emscripten_bind_btQuadWord___destroy___0"]=asm["_emscripten_bind_btQuadWord___destroy___0"];var _emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1"];var _emscripten_bind_btRigidBody_setCenterOfMassTransform_1=Module["_emscripten_bind_btRigidBody_setCenterOfMassTransform_1"]=asm["_emscripten_bind_btRigidBody_setCenterOfMassTransform_1"];var _emscripten_bind_btConstraintSolver___destroy___0=Module["_emscripten_bind_btConstraintSolver___destroy___0"]=asm["_emscripten_bind_btConstraintSolver___destroy___0"];var _emscripten_bind_btDbvtBroadphase___destroy___0=Module["_emscripten_bind_btDbvtBroadphase___destroy___0"]=asm["_emscripten_bind_btDbvtBroadphase___destroy___0"];var _emscripten_bind_btCapsuleShape_btCapsuleShape_2=Module["_emscripten_bind_btCapsuleShape_btCapsuleShape_2"]=asm["_emscripten_bind_btCapsuleShape_btCapsuleShape_2"];var _emscripten_bind_btTypedConstraint_enableFeedback_1=Module["_emscripten_bind_btTypedConstraint_enableFeedback_1"]=asm["_emscripten_bind_btTypedConstraint_enableFeedback_1"];var _emscripten_bind_btQuadWord_setZ_1=Module["_emscripten_bind_btQuadWord_setZ_1"]=asm["_emscripten_bind_btQuadWord_setZ_1"];var _emscripten_bind_btCapsuleShape_setLocalScaling_1=Module["_emscripten_bind_btCapsuleShape_setLocalScaling_1"]=asm["_emscripten_bind_btCapsuleShape_setLocalScaling_1"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0"];var _emscripten_bind_btTriangleMeshShape_setLocalScaling_1=Module["_emscripten_bind_btTriangleMeshShape_setLocalScaling_1"]=asm["_emscripten_bind_btTriangleMeshShape_setLocalScaling_1"];var _emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1=Module["_emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1"]=asm["_emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1"];var _emscripten_bind_btPersistentManifold_btPersistentManifold_0=Module["_emscripten_bind_btPersistentManifold_btPersistentManifold_0"]=asm["_emscripten_bind_btPersistentManifold_btPersistentManifold_0"];var _emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0=Module["_emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0"]=asm["_emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0"];var _emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2=Module["_emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2"]=asm["_emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2"];var _emscripten_bind_btVector4___destroy___0=Module["_emscripten_bind_btVector4___destroy___0"]=asm["_emscripten_bind_btVector4___destroy___0"];var _emscripten_bind_btPairCachingGhostObject_isKinematicObject_0=Module["_emscripten_bind_btPairCachingGhostObject_isKinematicObject_0"]=asm["_emscripten_bind_btPairCachingGhostObject_isKinematicObject_0"];var _emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1"];var _i64Add=Module["_i64Add"]=asm["_i64Add"];var _emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2=Module["_emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2"];var _emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1=Module["_emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1"];var _emscripten_bind_btCollisionObject_setCcdMotionThreshold_1=Module["_emscripten_bind_btCollisionObject_setCcdMotionThreshold_1"]=asm["_emscripten_bind_btCollisionObject_setCcdMotionThreshold_1"];var _emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0=Module["_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0"]=asm["_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0"];var _emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1=Module["_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1"]=asm["_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1"];var _emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3=Module["_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3"]=asm["_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0"];var _emscripten_bind_btPoint2PointConstraint_getPivotInB_0=Module["_emscripten_bind_btPoint2PointConstraint_getPivotInB_0"]=asm["_emscripten_bind_btPoint2PointConstraint_getPivotInB_0"];var _emscripten_bind_btKinematicCharacterController_playerStep_2=Module["_emscripten_bind_btKinematicCharacterController_playerStep_2"]=asm["_emscripten_bind_btKinematicCharacterController_playerStep_2"];var _emscripten_bind_btDispatcherInfo___destroy___0=Module["_emscripten_bind_btDispatcherInfo___destroy___0"]=asm["_emscripten_bind_btDispatcherInfo___destroy___0"];var _emscripten_bind_btStaticPlaneShape_setLocalScaling_1=Module["_emscripten_bind_btStaticPlaneShape_setLocalScaling_1"]=asm["_emscripten_bind_btStaticPlaneShape_setLocalScaling_1"];var _emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2=Module["_emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2"];var _emscripten_bind_ContactResultCallback_addSingleResult_7=Module["_emscripten_bind_ContactResultCallback_addSingleResult_7"]=asm["_emscripten_bind_ContactResultCallback_addSingleResult_7"];var _emscripten_bind_btGhostObject_getWorldTransform_0=Module["_emscripten_bind_btGhostObject_getWorldTransform_0"]=asm["_emscripten_bind_btGhostObject_getWorldTransform_0"];var _emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0=Module["_emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0"];var _emscripten_bind_LocalConvexResult_set_m_hitFraction_1=Module["_emscripten_bind_LocalConvexResult_set_m_hitFraction_1"]=asm["_emscripten_bind_LocalConvexResult_set_m_hitFraction_1"];var _emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2=Module["_emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2"]=asm["_emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2"];var _emscripten_bind_btDispatcherInfo_get_m_timeStep_0=Module["_emscripten_bind_btDispatcherInfo_get_m_timeStep_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_timeStep_0"];var _emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1=Module["_emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1"]=asm["_emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1"];var _emscripten_bind_btDynamicsWorld___destroy___0=Module["_emscripten_bind_btDynamicsWorld___destroy___0"]=asm["_emscripten_bind_btDynamicsWorld___destroy___0"];var _emscripten_bind_btMotionState___destroy___0=Module["_emscripten_bind_btMotionState___destroy___0"]=asm["_emscripten_bind_btMotionState___destroy___0"];var _emscripten_bind_btCollisionObject_setCollisionFlags_1=Module["_emscripten_bind_btCollisionObject_setCollisionFlags_1"]=asm["_emscripten_bind_btCollisionObject_setCollisionFlags_1"];var _emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1"];var _emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2=Module["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2"];var _emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3=Module["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3"];var _emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1=Module["_emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1"]=asm["_emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1"];var _emscripten_bind_btRaycastVehicle_getNumWheels_0=Module["_emscripten_bind_btRaycastVehicle_getNumWheels_0"]=asm["_emscripten_bind_btRaycastVehicle_getNumWheels_0"];var _emscripten_bind_btDispatcher_getManifoldByIndexInternal_1=Module["_emscripten_bind_btDispatcher_getManifoldByIndexInternal_1"]=asm["_emscripten_bind_btDispatcher_getManifoldByIndexInternal_1"];var _emscripten_bind_btWheelInfo_set_m_steering_1=Module["_emscripten_bind_btWheelInfo_set_m_steering_1"]=asm["_emscripten_bind_btWheelInfo_set_m_steering_1"];var _emscripten_bind_btPairCachingGhostObject_setWorldTransform_1=Module["_emscripten_bind_btPairCachingGhostObject_setWorldTransform_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setWorldTransform_1"];var _emscripten_bind_btConeTwistConstraint_setAngularOnly_1=Module["_emscripten_bind_btConeTwistConstraint_setAngularOnly_1"]=asm["_emscripten_bind_btConeTwistConstraint_setAngularOnly_1"];var _emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4=Module["_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4"]=asm["_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4"];var _emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2=Module["_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2"]=asm["_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2"];var _emscripten_bind_btKinematicCharacterController_setJumpSpeed_1=Module["_emscripten_bind_btKinematicCharacterController_setJumpSpeed_1"]=asm["_emscripten_bind_btKinematicCharacterController_setJumpSpeed_1"];var _emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1=Module["_emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1"]=asm["_emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1"];var _emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1=Module["_emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1"]=asm["_emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1"];var _emscripten_bind_btRigidBodyConstructionInfo___destroy___0=Module["_emscripten_bind_btRigidBodyConstructionInfo___destroy___0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo___destroy___0"];var _emscripten_bind_btRigidBody_getWorldTransform_0=Module["_emscripten_bind_btRigidBody_getWorldTransform_0"]=asm["_emscripten_bind_btRigidBody_getWorldTransform_0"];var _emscripten_bind_btPoint2PointConstraint_setPivotA_1=Module["_emscripten_bind_btPoint2PointConstraint_setPivotA_1"]=asm["_emscripten_bind_btPoint2PointConstraint_setPivotA_1"];var _emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1"];var _memcpy=Module["_memcpy"]=asm["_memcpy"];var _emscripten_bind_btCapsuleShape_calculateLocalInertia_2=Module["_emscripten_bind_btCapsuleShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btCapsuleShape_calculateLocalInertia_2"];var _emscripten_bind_btVector3_y_0=Module["_emscripten_bind_btVector3_y_0"]=asm["_emscripten_bind_btVector3_y_0"];var _emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0=Module["_emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0"];var _emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2=Module["_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2"]=asm["_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2"];var _emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3=Module["_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3"]=asm["_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3"];var _emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0=Module["_emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0"]=asm["_emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0"];var _emscripten_bind_btGhostObject_setCollisionShape_1=Module["_emscripten_bind_btGhostObject_setCollisionShape_1"]=asm["_emscripten_bind_btGhostObject_setCollisionShape_1"];var _emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1=Module["_emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1"];var _emscripten_bind_btQuaternion_setW_1=Module["_emscripten_bind_btQuaternion_setW_1"]=asm["_emscripten_bind_btQuaternion_setW_1"];var _emscripten_bind_btDiscreteDynamicsWorld_setGravity_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_setGravity_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_setGravity_1"];var _emscripten_bind_btGhostObject_isActive_0=Module["_emscripten_bind_btGhostObject_isActive_0"]=asm["_emscripten_bind_btGhostObject_isActive_0"];var _emscripten_bind_btVector4_z_0=Module["_emscripten_bind_btVector4_z_0"]=asm["_emscripten_bind_btVector4_z_0"];var _emscripten_bind_btCollisionObject_forceActivationState_1=Module["_emscripten_bind_btCollisionObject_forceActivationState_1"]=asm["_emscripten_bind_btCollisionObject_forceActivationState_1"];var _emscripten_bind_btKinematicCharacterController_onGround_0=Module["_emscripten_bind_btKinematicCharacterController_onGround_0"]=asm["_emscripten_bind_btKinematicCharacterController_onGround_0"];var _emscripten_bind_btRaycastVehicle_getWheelInfo_1=Module["_emscripten_bind_btRaycastVehicle_getWheelInfo_1"]=asm["_emscripten_bind_btRaycastVehicle_getWheelInfo_1"];var _emscripten_bind_btConeTwistConstraint_setLimit_2=Module["_emscripten_bind_btConeTwistConstraint_setLimit_2"]=asm["_emscripten_bind_btConeTwistConstraint_setLimit_2"];var _emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1"];var _emscripten_bind_btRigidBody___destroy___0=Module["_emscripten_bind_btRigidBody___destroy___0"]=asm["_emscripten_bind_btRigidBody___destroy___0"];var _emscripten_bind_btStridingMeshInterface___destroy___0=Module["_emscripten_bind_btStridingMeshInterface___destroy___0"]=asm["_emscripten_bind_btStridingMeshInterface___destroy___0"];var _emscripten_bind_btRigidBody_setSleepingThresholds_2=Module["_emscripten_bind_btRigidBody_setSleepingThresholds_2"]=asm["_emscripten_bind_btRigidBody_setSleepingThresholds_2"];var _emscripten_bind_btCollisionObject_setWorldTransform_1=Module["_emscripten_bind_btCollisionObject_setWorldTransform_1"]=asm["_emscripten_bind_btCollisionObject_setWorldTransform_1"];var _emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0=Module["_emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0"]=asm["_emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0"];var _emscripten_bind_btManifoldPoint_get_m_localPointA_0=Module["_emscripten_bind_btManifoldPoint_get_m_localPointA_0"]=asm["_emscripten_bind_btManifoldPoint_get_m_localPointA_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0"];var _emscripten_bind_btCollisionWorld_getBroadphase_0=Module["_emscripten_bind_btCollisionWorld_getBroadphase_0"]=asm["_emscripten_bind_btCollisionWorld_getBroadphase_0"];var _emscripten_bind_btDispatcher_getNumManifolds_0=Module["_emscripten_bind_btDispatcher_getNumManifolds_0"]=asm["_emscripten_bind_btDispatcher_getNumManifolds_0"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0"];var _emscripten_bind_btRigidBody_activate_1=Module["_emscripten_bind_btRigidBody_activate_1"]=asm["_emscripten_bind_btRigidBody_activate_1"];var _emscripten_bind_btRigidBody_activate_0=Module["_emscripten_bind_btRigidBody_activate_0"]=asm["_emscripten_bind_btRigidBody_activate_0"];var _emscripten_bind_btRaycastVehicle___destroy___0=Module["_emscripten_bind_btRaycastVehicle___destroy___0"]=asm["_emscripten_bind_btRaycastVehicle___destroy___0"];var _emscripten_bind_btGhostObject_setActivationState_1=Module["_emscripten_bind_btGhostObject_setActivationState_1"]=asm["_emscripten_bind_btGhostObject_setActivationState_1"];var _emscripten_bind_btCollisionWorld_contactPairTest_3=Module["_emscripten_bind_btCollisionWorld_contactPairTest_3"]=asm["_emscripten_bind_btCollisionWorld_contactPairTest_3"];var _emscripten_bind_btCylinderShapeX___destroy___0=Module["_emscripten_bind_btCylinderShapeX___destroy___0"]=asm["_emscripten_bind_btCylinderShapeX___destroy___0"];var _emscripten_bind_btManifoldPoint_getPositionWorldOnA_0=Module["_emscripten_bind_btManifoldPoint_getPositionWorldOnA_0"]=asm["_emscripten_bind_btManifoldPoint_getPositionWorldOnA_0"];var _emscripten_bind_ContactResultCallback___destroy___0=Module["_emscripten_bind_ContactResultCallback___destroy___0"]=asm["_emscripten_bind_ContactResultCallback___destroy___0"];var _emscripten_bind_btDispatcherInfo_set_m_stepCount_1=Module["_emscripten_bind_btDispatcherInfo_set_m_stepCount_1"]=asm["_emscripten_bind_btDispatcherInfo_set_m_stepCount_1"];var _emscripten_bind_btVector4_x_0=Module["_emscripten_bind_btVector4_x_0"]=asm["_emscripten_bind_btVector4_x_0"];var _emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1=Module["_emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1"]=asm["_emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1"];var _emscripten_bind_btKinematicCharacterController_getGhostObject_0=Module["_emscripten_bind_btKinematicCharacterController_getGhostObject_0"]=asm["_emscripten_bind_btKinematicCharacterController_getGhostObject_0"];var _emscripten_bind_btRigidBody_btRigidBody_1=Module["_emscripten_bind_btRigidBody_btRigidBody_1"]=asm["_emscripten_bind_btRigidBody_btRigidBody_1"];var _emscripten_bind_btTriangleMeshShape___destroy___0=Module["_emscripten_bind_btTriangleMeshShape___destroy___0"]=asm["_emscripten_bind_btTriangleMeshShape___destroy___0"];var _emscripten_bind_btKinematicCharacterController_setWalkDirection_1=Module["_emscripten_bind_btKinematicCharacterController_setWalkDirection_1"]=asm["_emscripten_bind_btKinematicCharacterController_setWalkDirection_1"];var _emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0=Module["_emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0"];var _emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0=Module["_emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0"];var _emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1=Module["_emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1"]=asm["_emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1"];var _emscripten_bind_btKinematicCharacterController_getGravity_0=Module["_emscripten_bind_btKinematicCharacterController_getGravity_0"]=asm["_emscripten_bind_btKinematicCharacterController_getGravity_0"];var _emscripten_bind_btDiscreteDynamicsWorld_addAction_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_addAction_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_addAction_1"];var _emscripten_bind_btQuaternion_setY_1=Module["_emscripten_bind_btQuaternion_setY_1"]=asm["_emscripten_bind_btQuaternion_setY_1"];var _emscripten_bind_btConeShape_calculateLocalInertia_2=Module["_emscripten_bind_btConeShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btConeShape_calculateLocalInertia_2"];var _emscripten_bind_btCylinderShapeX_calculateLocalInertia_2=Module["_emscripten_bind_btCylinderShapeX_calculateLocalInertia_2"]=asm["_emscripten_bind_btCylinderShapeX_calculateLocalInertia_2"];var _emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1=Module["_emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1"]=asm["_emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1"];var _llvm_bswap_i32=Module["_llvm_bswap_i32"]=asm["_llvm_bswap_i32"];var _emscripten_bind_btSphereShape_setLocalScaling_1=Module["_emscripten_bind_btSphereShape_setLocalScaling_1"]=asm["_emscripten_bind_btSphereShape_setLocalScaling_1"];var _emscripten_bind_btVector4_w_0=Module["_emscripten_bind_btVector4_w_0"]=asm["_emscripten_bind_btVector4_w_0"];var _emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0=Module["_emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0"]=asm["_emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0"];var _emscripten_bind_btBvhTriangleMeshShape___destroy___0=Module["_emscripten_bind_btBvhTriangleMeshShape___destroy___0"]=asm["_emscripten_bind_btBvhTriangleMeshShape___destroy___0"];var _emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0"];var _emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1=Module["_emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1"]=asm["_emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1"];var _emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1=Module["_emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1"];var _emscripten_bind_btVector4_y_0=Module["_emscripten_bind_btVector4_y_0"]=asm["_emscripten_bind_btVector4_y_0"];var _emscripten_bind_btGeneric6DofConstraint___destroy___0=Module["_emscripten_bind_btGeneric6DofConstraint___destroy___0"]=asm["_emscripten_bind_btGeneric6DofConstraint___destroy___0"];var _emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0=Module["_emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0"];var _emscripten_bind_btConvexHullShape_addPoint_1=Module["_emscripten_bind_btConvexHullShape_addPoint_1"]=asm["_emscripten_bind_btConvexHullShape_addPoint_1"];var _emscripten_bind_btConvexHullShape_addPoint_2=Module["_emscripten_bind_btConvexHullShape_addPoint_2"]=asm["_emscripten_bind_btConvexHullShape_addPoint_2"];var _emscripten_bind_btTransform_getOrigin_0=Module["_emscripten_bind_btTransform_getOrigin_0"]=asm["_emscripten_bind_btTransform_getOrigin_0"];var _emscripten_bind_btHingeConstraint___destroy___0=Module["_emscripten_bind_btHingeConstraint___destroy___0"]=asm["_emscripten_bind_btHingeConstraint___destroy___0"];var _emscripten_bind_btHingeConstraint_enableFeedback_1=Module["_emscripten_bind_btHingeConstraint_enableFeedback_1"]=asm["_emscripten_bind_btHingeConstraint_enableFeedback_1"];var _emscripten_bind_btConvexShape_calculateLocalInertia_2=Module["_emscripten_bind_btConvexShape_calculateLocalInertia_2"]=asm["_emscripten_bind_btConvexShape_calculateLocalInertia_2"];var _memset=Module["_memset"]=asm["_memset"];var _emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0"];var _emscripten_bind_btTriangleMesh_btTriangleMesh_0=Module["_emscripten_bind_btTriangleMesh_btTriangleMesh_0"]=asm["_emscripten_bind_btTriangleMesh_btTriangleMesh_0"];var _emscripten_bind_btPairCachingGhostObject_getCollisionShape_0=Module["_emscripten_bind_btPairCachingGhostObject_getCollisionShape_0"]=asm["_emscripten_bind_btPairCachingGhostObject_getCollisionShape_0"];var _emscripten_bind_btTriangleMesh_btTriangleMesh_2=Module["_emscripten_bind_btTriangleMesh_btTriangleMesh_2"]=asm["_emscripten_bind_btTriangleMesh_btTriangleMesh_2"];var _emscripten_bind_btTransform___destroy___0=Module["_emscripten_bind_btTransform___destroy___0"]=asm["_emscripten_bind_btTransform___destroy___0"];var _emscripten_bind_btWheelInfo_set_m_frictionSlip_1=Module["_emscripten_bind_btWheelInfo_set_m_frictionSlip_1"]=asm["_emscripten_bind_btWheelInfo_set_m_frictionSlip_1"];var _emscripten_bind_btRigidBody_getCollisionShape_0=Module["_emscripten_bind_btRigidBody_getCollisionShape_0"]=asm["_emscripten_bind_btRigidBody_getCollisionShape_0"];var _emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1=Module["_emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1"]=asm["_emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1"];var _emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0=Module["_emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0"]=asm["_emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0"];var _emscripten_bind_btManifoldPoint_get_m_localPointB_0=Module["_emscripten_bind_btManifoldPoint_get_m_localPointB_0"]=asm["_emscripten_bind_btManifoldPoint_get_m_localPointB_0"];var _emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3=Module["_emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3"];var _emscripten_bind_btSliderConstraint_setLowerLinLimit_1=Module["_emscripten_bind_btSliderConstraint_setLowerLinLimit_1"]=asm["_emscripten_bind_btSliderConstraint_setLowerLinLimit_1"];var _emscripten_bind_btPoint2PointConstraint_set_m_setting_1=Module["_emscripten_bind_btPoint2PointConstraint_set_m_setting_1"]=asm["_emscripten_bind_btPoint2PointConstraint_set_m_setting_1"];var _emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1=Module["_emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1"]=asm["_emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1"];var _emscripten_bind_btWheelInfo_get_m_wheelsRadius_0=Module["_emscripten_bind_btWheelInfo_get_m_wheelsRadius_0"]=asm["_emscripten_bind_btWheelInfo_get_m_wheelsRadius_0"];var _emscripten_bind_btRigidBody_setLinearVelocity_1=Module["_emscripten_bind_btRigidBody_setLinearVelocity_1"]=asm["_emscripten_bind_btRigidBody_setLinearVelocity_1"];var _emscripten_bind_btVehicleTuning_btVehicleTuning_0=Module["_emscripten_bind_btVehicleTuning_btVehicleTuning_0"]=asm["_emscripten_bind_btVehicleTuning_btVehicleTuning_0"];var _emscripten_bind_RayResultCallback_set_m_collisionObject_1=Module["_emscripten_bind_RayResultCallback_set_m_collisionObject_1"]=asm["_emscripten_bind_RayResultCallback_set_m_collisionObject_1"];var _emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1"];var _emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0"];var _emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1=Module["_emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1"]=asm["_emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1"];var _emscripten_bind_btDynamicsWorld_addAction_1=Module["_emscripten_bind_btDynamicsWorld_addAction_1"]=asm["_emscripten_bind_btDynamicsWorld_addAction_1"];var _emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0=Module["_emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0"]=asm["_emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1"];var _emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1=Module["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1"]=asm["_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1"];var _emscripten_bind_btKinematicCharacterController_setFallSpeed_1=Module["_emscripten_bind_btKinematicCharacterController_setFallSpeed_1"]=asm["_emscripten_bind_btKinematicCharacterController_setFallSpeed_1"];var _emscripten_bind_btRigidBody_setActivationState_1=Module["_emscripten_bind_btRigidBody_setActivationState_1"]=asm["_emscripten_bind_btRigidBody_setActivationState_1"];var _emscripten_bind_ClosestConvexResultCallback_hasHit_0=Module["_emscripten_bind_ClosestConvexResultCallback_hasHit_0"]=asm["_emscripten_bind_ClosestConvexResultCallback_hasHit_0"];var _emscripten_bind_btCapsuleShapeZ___destroy___0=Module["_emscripten_bind_btCapsuleShapeZ___destroy___0"]=asm["_emscripten_bind_btCapsuleShapeZ___destroy___0"];var _emscripten_bind_LocalShapeInfo_set_m_shapePart_1=Module["_emscripten_bind_LocalShapeInfo_set_m_shapePart_1"]=asm["_emscripten_bind_LocalShapeInfo_set_m_shapePart_1"];var _emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0=Module["_emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0"]=asm["_emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0"];var _emscripten_bind_btTriangleMesh_addTriangle_3=Module["_emscripten_bind_btTriangleMesh_addTriangle_3"]=asm["_emscripten_bind_btTriangleMesh_addTriangle_3"];var _emscripten_bind_btGhostObject_getOverlappingObject_1=Module["_emscripten_bind_btGhostObject_getOverlappingObject_1"]=asm["_emscripten_bind_btGhostObject_getOverlappingObject_1"];var _emscripten_bind_btTriangleMesh_addTriangle_4=Module["_emscripten_bind_btTriangleMesh_addTriangle_4"]=asm["_emscripten_bind_btTriangleMesh_addTriangle_4"];var _emscripten_bind_btRigidBody_applyTorqueImpulse_1=Module["_emscripten_bind_btRigidBody_applyTorqueImpulse_1"]=asm["_emscripten_bind_btRigidBody_applyTorqueImpulse_1"];var _emscripten_bind_btRigidBody_setCollisionFlags_1=Module["_emscripten_bind_btRigidBody_setCollisionFlags_1"]=asm["_emscripten_bind_btRigidBody_setCollisionFlags_1"];var _emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1=Module["_emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1"]=asm["_emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1"];var _emscripten_bind_btConeShape___destroy___0=Module["_emscripten_bind_btConeShape___destroy___0"]=asm["_emscripten_bind_btConeShape___destroy___0"];var _emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2=Module["_emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2"]=asm["_emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2"];var _emscripten_bind_btSliderConstraint_btSliderConstraint_5=Module["_emscripten_bind_btSliderConstraint_btSliderConstraint_5"]=asm["_emscripten_bind_btSliderConstraint_btSliderConstraint_5"];var _emscripten_bind_btSliderConstraint_btSliderConstraint_3=Module["_emscripten_bind_btSliderConstraint_btSliderConstraint_3"]=asm["_emscripten_bind_btSliderConstraint_btSliderConstraint_3"];var _emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0=Module["_emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0"];var _emscripten_bind_btDynamicsWorld_convexSweepTest_5=Module["_emscripten_bind_btDynamicsWorld_convexSweepTest_5"]=asm["_emscripten_bind_btDynamicsWorld_convexSweepTest_5"];var _emscripten_bind_btRigidBody_forceActivationState_1=Module["_emscripten_bind_btRigidBody_forceActivationState_1"]=asm["_emscripten_bind_btRigidBody_forceActivationState_1"];var _emscripten_bind_btPoint2PointConstraint_setPivotB_1=Module["_emscripten_bind_btPoint2PointConstraint_setPivotB_1"]=asm["_emscripten_bind_btPoint2PointConstraint_setPivotB_1"];var _emscripten_bind_btGhostPairCallback___destroy___0=Module["_emscripten_bind_btGhostPairCallback___destroy___0"]=asm["_emscripten_bind_btGhostPairCallback___destroy___0"];var _emscripten_bind_btKinematicCharacterController_getMaxSlope_0=Module["_emscripten_bind_btKinematicCharacterController_getMaxSlope_0"]=asm["_emscripten_bind_btKinematicCharacterController_getMaxSlope_0"];var _emscripten_bind_btSliderConstraint_enableFeedback_1=Module["_emscripten_bind_btSliderConstraint_enableFeedback_1"]=asm["_emscripten_bind_btSliderConstraint_enableFeedback_1"];var _emscripten_bind_btRaycastVehicle_addWheel_7=Module["_emscripten_bind_btRaycastVehicle_addWheel_7"]=asm["_emscripten_bind_btRaycastVehicle_addWheel_7"];var _emscripten_bind_btPairCachingGhostObject_isActive_0=Module["_emscripten_bind_btPairCachingGhostObject_isActive_0"]=asm["_emscripten_bind_btPairCachingGhostObject_isActive_0"];var _emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1=Module["_emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1"]=asm["_emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1"];var _emscripten_bind_btStaticPlaneShape___destroy___0=Module["_emscripten_bind_btStaticPlaneShape___destroy___0"]=asm["_emscripten_bind_btStaticPlaneShape___destroy___0"];var _emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0=Module["_emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0"];var _emscripten_bind_btBoxShape_setLocalScaling_1=Module["_emscripten_bind_btBoxShape_setLocalScaling_1"]=asm["_emscripten_bind_btBoxShape_setLocalScaling_1"];var _emscripten_bind_btConeShapeZ___destroy___0=Module["_emscripten_bind_btConeShapeZ___destroy___0"]=asm["_emscripten_bind_btConeShapeZ___destroy___0"];var _emscripten_bind_btDynamicsWorld_getPairCache_0=Module["_emscripten_bind_btDynamicsWorld_getPairCache_0"]=asm["_emscripten_bind_btDynamicsWorld_getPairCache_0"];var _emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5=Module["_emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5"];var _emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2=Module["_emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2"]=asm["_emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2"];var _emscripten_bind_btVector4_btVector4_0=Module["_emscripten_bind_btVector4_btVector4_0"]=asm["_emscripten_bind_btVector4_btVector4_0"];var _emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0=Module["_emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0"]=asm["_emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0"];var _emscripten_bind_btVector4_btVector4_4=Module["_emscripten_bind_btVector4_btVector4_4"]=asm["_emscripten_bind_btVector4_btVector4_4"];var _emscripten_bind_btKinematicCharacterController___destroy___0=Module["_emscripten_bind_btKinematicCharacterController___destroy___0"]=asm["_emscripten_bind_btKinematicCharacterController___destroy___0"];var _emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1=Module["_emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1"]=asm["_emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1"];var _emscripten_bind_btConstraintSetting_btConstraintSetting_0=Module["_emscripten_bind_btConstraintSetting_btConstraintSetting_0"]=asm["_emscripten_bind_btConstraintSetting_btConstraintSetting_0"];var _emscripten_bind_btDiscreteDynamicsWorld_rayTest_3=Module["_emscripten_bind_btDiscreteDynamicsWorld_rayTest_3"]=asm["_emscripten_bind_btDiscreteDynamicsWorld_rayTest_3"];var _emscripten_bind_btGhostPairCallback_btGhostPairCallback_0=Module["_emscripten_bind_btGhostPairCallback_btGhostPairCallback_0"]=asm["_emscripten_bind_btGhostPairCallback_btGhostPairCallback_0"];var _emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1=Module["_emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1"]=asm["_emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1"];var _emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1=Module["_emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1"]=asm["_emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1"];var _emscripten_bind_btVehicleTuning_get_m_frictionSlip_0=Module["_emscripten_bind_btVehicleTuning_get_m_frictionSlip_0"]=asm["_emscripten_bind_btVehicleTuning_get_m_frictionSlip_0"];var __GLOBAL__I_a=Module["__GLOBAL__I_a"]=asm["__GLOBAL__I_a"];var runPostSets=Module["runPostSets"]=asm["runPostSets"];var dynCall_viiiii=Module["dynCall_viiiii"]=asm["dynCall_viiiii"];var dynCall_vid=Module["dynCall_vid"]=asm["dynCall_vid"];var dynCall_vi=Module["dynCall_vi"]=asm["dynCall_vi"];var dynCall_viiidii=Module["dynCall_viiidii"]=asm["dynCall_viiidii"];var dynCall_vii=Module["dynCall_vii"]=asm["dynCall_vii"];var dynCall_iiiiiiiiiii=Module["dynCall_iiiiiiiiiii"]=asm["dynCall_iiiiiiiiiii"];var dynCall_ii=Module["dynCall_ii"]=asm["dynCall_ii"];var dynCall_viidi=Module["dynCall_viidi"]=asm["dynCall_viidi"];var dynCall_viddiii=Module["dynCall_viddiii"]=asm["dynCall_viddiii"];var dynCall_vidii=Module["dynCall_vidii"]=asm["dynCall_vidii"];var dynCall_iiiii=Module["dynCall_iiiii"]=asm["dynCall_iiiii"];var dynCall_vidi=Module["dynCall_vidi"]=asm["dynCall_vidi"];var dynCall_diiiiiiii=Module["dynCall_diiiiiiii"]=asm["dynCall_diiiiiiii"];var dynCall_viiiiddddiid=Module["dynCall_viiiiddddiid"]=asm["dynCall_viiiiddddiid"];var dynCall_diiiii=Module["dynCall_diiiii"]=asm["dynCall_diiiii"];var dynCall_iiii=Module["dynCall_iiii"]=asm["dynCall_iiii"];var dynCall_viiiiii=Module["dynCall_viiiiii"]=asm["dynCall_viiiiii"];var dynCall_iiid=Module["dynCall_iiid"]=asm["dynCall_iiid"];var dynCall_di=Module["dynCall_di"]=asm["dynCall_di"];var dynCall_iiiiiii=Module["dynCall_iiiiiii"]=asm["dynCall_iiiiiii"];var dynCall_diiidii=Module["dynCall_diiidii"]=asm["dynCall_diiidii"];var dynCall_viidii=Module["dynCall_viidii"]=asm["dynCall_viidii"];var dynCall_viiiiiii=Module["dynCall_viiiiiii"]=asm["dynCall_viiiiiii"];var dynCall_viiiiiiiii=Module["dynCall_viiiiiiiii"]=asm["dynCall_viiiiiiiii"];var dynCall_viiiiiiiiii=Module["dynCall_viiiiiiiiii"]=asm["dynCall_viiiiiiiiii"];var dynCall_iii=Module["dynCall_iii"]=asm["dynCall_iii"];var dynCall_diii=Module["dynCall_diii"]=asm["dynCall_diii"];var dynCall_diiiiiiiiii=Module["dynCall_diiiiiiiiii"]=asm["dynCall_diiiiiiiiii"];var dynCall_viiiid=Module["dynCall_viiiid"]=asm["dynCall_viiiid"];var dynCall_diiiiiiiii=Module["dynCall_diiiiiiiii"]=asm["dynCall_diiiiiiiii"];var dynCall_did=Module["dynCall_did"]=asm["dynCall_did"];var dynCall_viiiidddddidi=Module["dynCall_viiiidddddidi"]=asm["dynCall_viiiidddddidi"];var dynCall_diidii=Module["dynCall_diidii"]=asm["dynCall_diidii"];var dynCall_diiii=Module["dynCall_diiii"]=asm["dynCall_diiii"];var dynCall_iiiiiiiiii=Module["dynCall_iiiiiiiiii"]=asm["dynCall_iiiiiiiiii"];var dynCall_viiid=Module["dynCall_viiid"]=asm["dynCall_viiid"];var dynCall_viii=Module["dynCall_viii"]=asm["dynCall_viii"];var dynCall_v=Module["dynCall_v"]=asm["dynCall_v"];var dynCall_viid=Module["dynCall_viid"]=asm["dynCall_viid"];var dynCall_iidid=Module["dynCall_iidid"]=asm["dynCall_iidid"];var dynCall_viiii=Module["dynCall_viiii"]=asm["dynCall_viiii"];Runtime.stackAlloc=asm["stackAlloc"];Runtime.stackSave=asm["stackSave"];Runtime.stackRestore=asm["stackRestore"];Runtime.setTempRet0=asm["setTempRet0"];Runtime.getTempRet0=asm["getTempRet0"];var i64Math=(function(){var goog={math:{}};goog.math.Long=(function(low,high){this.low_=low|0;this.high_=high|0});goog.math.Long.IntCache_={};goog.math.Long.fromInt=(function(value){if(-128<=value&&value<128){var cachedObj=goog.math.Long.IntCache_[value];if(cachedObj){return cachedObj}}var obj=new goog.math.Long(value|0,value<0?-1:0);if(-128<=value&&value<128){goog.math.Long.IntCache_[value]=obj}return obj});goog.math.Long.fromNumber=(function(value){if(isNaN(value)||!isFinite(value)){return goog.math.Long.ZERO}else if(value<=-goog.math.Long.TWO_PWR_63_DBL_){return goog.math.Long.MIN_VALUE}else if(value+1>=goog.math.Long.TWO_PWR_63_DBL_){return goog.math.Long.MAX_VALUE}else if(value<0){return goog.math.Long.fromNumber(-value).negate()}else{return new goog.math.Long(value%goog.math.Long.TWO_PWR_32_DBL_|0,value/goog.math.Long.TWO_PWR_32_DBL_|0)}});goog.math.Long.fromBits=(function(lowBits,highBits){return new goog.math.Long(lowBits,highBits)});goog.math.Long.fromString=(function(str,opt_radix){if(str.length==0){throw Error("number format error: empty string")}var radix=opt_radix||10;if(radix<2||36<radix){throw Error("radix out of range: "+radix)}if(str.charAt(0)=="-"){return goog.math.Long.fromString(str.substring(1),radix).negate()}else if(str.indexOf("-")>=0){throw Error('number format error: interior "-" character: '+str)}var radixToPower=goog.math.Long.fromNumber(Math.pow(radix,8));var result=goog.math.Long.ZERO;for(var i=0;i<str.length;i+=8){var size=Math.min(8,str.length-i);var value=parseInt(str.substring(i,i+size),radix);if(size<8){var power=goog.math.Long.fromNumber(Math.pow(radix,size));result=result.multiply(power).add(goog.math.Long.fromNumber(value))}else{result=result.multiply(radixToPower);result=result.add(goog.math.Long.fromNumber(value))}}return result});goog.math.Long.TWO_PWR_16_DBL_=1<<16;goog.math.Long.TWO_PWR_24_DBL_=1<<24;goog.math.Long.TWO_PWR_32_DBL_=goog.math.Long.TWO_PWR_16_DBL_*goog.math.Long.TWO_PWR_16_DBL_;goog.math.Long.TWO_PWR_31_DBL_=goog.math.Long.TWO_PWR_32_DBL_/2;goog.math.Long.TWO_PWR_48_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_16_DBL_;goog.math.Long.TWO_PWR_64_DBL_=goog.math.Long.TWO_PWR_32_DBL_*goog.math.Long.TWO_PWR_32_DBL_;goog.math.Long.TWO_PWR_63_DBL_=goog.math.Long.TWO_PWR_64_DBL_/2;goog.math.Long.ZERO=goog.math.Long.fromInt(0);goog.math.Long.ONE=goog.math.Long.fromInt(1);goog.math.Long.NEG_ONE=goog.math.Long.fromInt(-1);goog.math.Long.MAX_VALUE=goog.math.Long.fromBits(4294967295|0,2147483647|0);goog.math.Long.MIN_VALUE=goog.math.Long.fromBits(0,2147483648|0);goog.math.Long.TWO_PWR_24_=goog.math.Long.fromInt(1<<24);goog.math.Long.prototype.toInt=(function(){return this.low_});goog.math.Long.prototype.toNumber=(function(){return this.high_*goog.math.Long.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()});goog.math.Long.prototype.toString=(function(opt_radix){var radix=opt_radix||10;if(radix<2||36<radix){throw Error("radix out of range: "+radix)}if(this.isZero()){return"0"}if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){var radixLong=goog.math.Long.fromNumber(radix);var div=this.div(radixLong);var rem=div.multiply(radixLong).subtract(this);return div.toString(radix)+rem.toInt().toString(radix)}else{return"-"+this.negate().toString(radix)}}var radixToPower=goog.math.Long.fromNumber(Math.pow(radix,6));var rem=this;var result="";while(true){var remDiv=rem.div(radixToPower);var intval=rem.subtract(remDiv.multiply(radixToPower)).toInt();var digits=intval.toString(radix);rem=remDiv;if(rem.isZero()){return digits+result}else{while(digits.length<6){digits="0"+digits}result=""+digits+result}}});goog.math.Long.prototype.getHighBits=(function(){return this.high_});goog.math.Long.prototype.getLowBits=(function(){return this.low_});goog.math.Long.prototype.getLowBitsUnsigned=(function(){return this.low_>=0?this.low_:goog.math.Long.TWO_PWR_32_DBL_+this.low_});goog.math.Long.prototype.getNumBitsAbs=(function(){if(this.isNegative()){if(this.equals(goog.math.Long.MIN_VALUE)){return 64}else{return this.negate().getNumBitsAbs()}}else{var val=this.high_!=0?this.high_:this.low_;for(var bit=31;bit>0;bit--){if((val&1<<bit)!=0){break}}return this.high_!=0?bit+33:bit+1}});goog.math.Long.prototype.isZero=(function(){return this.high_==0&&this.low_==0});goog.math.Long.prototype.isNegative=(function(){return this.high_<0});goog.math.Long.prototype.isOdd=(function(){return(this.low_&1)==1});goog.math.Long.prototype.equals=(function(other){return this.high_==other.high_&&this.low_==other.low_});goog.math.Long.prototype.notEquals=(function(other){return this.high_!=other.high_||this.low_!=other.low_});goog.math.Long.prototype.lessThan=(function(other){return this.compare(other)<0});goog.math.Long.prototype.lessThanOrEqual=(function(other){return this.compare(other)<=0});goog.math.Long.prototype.greaterThan=(function(other){return this.compare(other)>0});goog.math.Long.prototype.greaterThanOrEqual=(function(other){return this.compare(other)>=0});goog.math.Long.prototype.compare=(function(other){if(this.equals(other)){return 0}var thisNeg=this.isNegative();var otherNeg=other.isNegative();if(thisNeg&&!otherNeg){return-1}if(!thisNeg&&otherNeg){return 1}if(this.subtract(other).isNegative()){return-1}else{return 1}});goog.math.Long.prototype.negate=(function(){if(this.equals(goog.math.Long.MIN_VALUE)){return goog.math.Long.MIN_VALUE}else{return this.not().add(goog.math.Long.ONE)}});goog.math.Long.prototype.add=(function(other){var a48=this.high_>>>16;var a32=this.high_&65535;var a16=this.low_>>>16;var a00=this.low_&65535;var b48=other.high_>>>16;var b32=other.high_&65535;var b16=other.low_>>>16;var b00=other.low_&65535;var c48=0,c32=0,c16=0,c00=0;c00+=a00+b00;c16+=c00>>>16;c00&=65535;c16+=a16+b16;c32+=c16>>>16;c16&=65535;c32+=a32+b32;c48+=c32>>>16;c32&=65535;c48+=a48+b48;c48&=65535;return goog.math.Long.fromBits(c16<<16|c00,c48<<16|c32)});goog.math.Long.prototype.subtract=(function(other){return this.add(other.negate())});goog.math.Long.prototype.multiply=(function(other){if(this.isZero()){return goog.math.Long.ZERO}else if(other.isZero()){return goog.math.Long.ZERO}if(this.equals(goog.math.Long.MIN_VALUE)){return other.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO}else if(other.equals(goog.math.Long.MIN_VALUE)){return this.isOdd()?goog.math.Long.MIN_VALUE:goog.math.Long.ZERO}if(this.isNegative()){if(other.isNegative()){return this.negate().multiply(other.negate())}else{return this.negate().multiply(other).negate()}}else if(other.isNegative()){return this.multiply(other.negate()).negate()}if(this.lessThan(goog.math.Long.TWO_PWR_24_)&&other.lessThan(goog.math.Long.TWO_PWR_24_)){return goog.math.Long.fromNumber(this.toNumber()*other.toNumber())}var a48=this.high_>>>16;var a32=this.high_&65535;var a16=this.low_>>>16;var a00=this.low_&65535;var b48=other.high_>>>16;var b32=other.high_&65535;var b16=other.low_>>>16;var b00=other.low_&65535;var c48=0,c32=0,c16=0,c00=0;c00+=a00*b00;c16+=c00>>>16;c00&=65535;c16+=a16*b00;c32+=c16>>>16;c16&=65535;c16+=a00*b16;c32+=c16>>>16;c16&=65535;c32+=a32*b00;c48+=c32>>>16;c32&=65535;c32+=a16*b16;c48+=c32>>>16;c32&=65535;c32+=a00*b32;c48+=c32>>>16;c32&=65535;c48+=a48*b00+a32*b16+a16*b32+a00*b48;c48&=65535;return goog.math.Long.fromBits(c16<<16|c00,c48<<16|c32)});goog.math.Long.prototype.div=(function(other){if(other.isZero()){throw Error("division by zero")}else if(this.isZero()){return goog.math.Long.ZERO}if(this.equals(goog.math.Long.MIN_VALUE)){if(other.equals(goog.math.Long.ONE)||other.equals(goog.math.Long.NEG_ONE)){return goog.math.Long.MIN_VALUE}else if(other.equals(goog.math.Long.MIN_VALUE)){return goog.math.Long.ONE}else{var halfThis=this.shiftRight(1);var approx=halfThis.div(other).shiftLeft(1);if(approx.equals(goog.math.Long.ZERO)){return other.isNegative()?goog.math.Long.ONE:goog.math.Long.NEG_ONE}else{var rem=this.subtract(other.multiply(approx));var result=approx.add(rem.div(other));return result}}}else if(other.equals(goog.math.Long.MIN_VALUE)){return goog.math.Long.ZERO}if(this.isNegative()){if(other.isNegative()){return this.negate().div(other.negate())}else{return this.negate().div(other).negate()}}else if(other.isNegative()){return this.div(other.negate()).negate()}var res=goog.math.Long.ZERO;var rem=this;while(rem.greaterThanOrEqual(other)){var approx=Math.max(1,Math.floor(rem.toNumber()/other.toNumber()));var log2=Math.ceil(Math.log(approx)/Math.LN2);var delta=log2<=48?1:Math.pow(2,log2-48);var approxRes=goog.math.Long.fromNumber(approx);var approxRem=approxRes.multiply(other);while(approxRem.isNegative()||approxRem.greaterThan(rem)){approx-=delta;approxRes=goog.math.Long.fromNumber(approx);approxRem=approxRes.multiply(other)}if(approxRes.isZero()){approxRes=goog.math.Long.ONE}res=res.add(approxRes);rem=rem.subtract(approxRem)}return res});goog.math.Long.prototype.modulo=(function(other){return this.subtract(this.div(other).multiply(other))});goog.math.Long.prototype.not=(function(){return goog.math.Long.fromBits(~this.low_,~this.high_)});goog.math.Long.prototype.and=(function(other){return goog.math.Long.fromBits(this.low_&other.low_,this.high_&other.high_)});goog.math.Long.prototype.or=(function(other){return goog.math.Long.fromBits(this.low_|other.low_,this.high_|other.high_)});goog.math.Long.prototype.xor=(function(other){return goog.math.Long.fromBits(this.low_^other.low_,this.high_^other.high_)});goog.math.Long.prototype.shiftLeft=(function(numBits){numBits&=63;if(numBits==0){return this}else{var low=this.low_;if(numBits<32){var high=this.high_;return goog.math.Long.fromBits(low<<numBits,high<<numBits|low>>>32-numBits)}else{return goog.math.Long.fromBits(0,low<<numBits-32)}}});goog.math.Long.prototype.shiftRight=(function(numBits){numBits&=63;if(numBits==0){return this}else{var high=this.high_;if(numBits<32){var low=this.low_;return goog.math.Long.fromBits(low>>>numBits|high<<32-numBits,high>>numBits)}else{return goog.math.Long.fromBits(high>>numBits-32,high>=0?0:-1)}}});goog.math.Long.prototype.shiftRightUnsigned=(function(numBits){numBits&=63;if(numBits==0){return this}else{var high=this.high_;if(numBits<32){var low=this.low_;return goog.math.Long.fromBits(low>>>numBits|high<<32-numBits,high>>>numBits)}else if(numBits==32){return goog.math.Long.fromBits(high,0)}else{return goog.math.Long.fromBits(high>>>numBits-32,0)}}});var navigator={appName:"Modern Browser"};var dbits;var canary=0xdeadbeefcafe;var j_lm=(canary&16777215)==15715070;function BigInteger(a,b,c){if(a!=null)if("number"==typeof a)this.fromNumber(a,b,c);else if(b==null&&"string"!=typeof a)this.fromString(a,256);else this.fromString(a,b)}function nbi(){return new BigInteger(null)}function am1(i,x,w,j,c,n){while(--n>=0){var v=x*this[i++]+w[j]+c;c=Math.floor(v/67108864);w[j++]=v&67108863}return c}function am2(i,x,w,j,c,n){var xl=x&32767,xh=x>>15;while(--n>=0){var l=this[i]&32767;var h=this[i++]>>15;var m=xh*l+h*xl;l=xl*l+((m&32767)<<15)+w[j]+(c&1073741823);c=(l>>>30)+(m>>>15)+xh*h+(c>>>30);w[j++]=l&1073741823}return c}function am3(i,x,w,j,c,n){var xl=x&16383,xh=x>>14;while(--n>=0){var l=this[i]&16383;var h=this[i++]>>14;var m=xh*l+h*xl;l=xl*l+((m&16383)<<14)+w[j]+c;c=(l>>28)+(m>>14)+xh*h;w[j++]=l&268435455}return c}if(j_lm&&navigator.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;dbits=30}else if(j_lm&&navigator.appName!="Netscape"){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array;var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(n){return BI_RM.charAt(n)}function intAt(s,i){var c=BI_RC[s.charCodeAt(i)];return c==null?-1:c}function bnpCopyTo(r){for(var i=this.t-1;i>=0;--i)r[i]=this[i];r.t=this.t;r.s=this.s}function bnpFromInt(x){this.t=1;this.s=x<0?-1:0;if(x>0)this[0]=x;else if(x<-1)this[0]=x+DV;else this.t=0}function nbv(i){var r=nbi();r.fromInt(i);return r}function bnpFromString(s,b){var k;if(b==16)k=4;else if(b==8)k=3;else if(b==256)k=8;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else{this.fromRadix(s,b);return}this.t=0;this.s=0;var i=s.length,mi=false,sh=0;while(--i>=0){var x=k==8?s[i]&255:intAt(s,i);if(x<0){if(s.charAt(i)=="-")mi=true;continue}mi=false;if(sh==0)this[this.t++]=x;else if(sh+k>this.DB){this[this.t-1]|=(x&(1<<this.DB-sh)-1)<<sh;this[this.t++]=x>>this.DB-sh}else this[this.t-1]|=x<<sh;sh+=k;if(sh>=this.DB)sh-=this.DB}if(k==8&&(s[0]&128)!=0){this.s=-1;if(sh>0)this[this.t-1]|=(1<<this.DB-sh)-1<<sh}this.clamp();if(mi)BigInteger.ZERO.subTo(this,this)}function bnpClamp(){var c=this.s&this.DM;while(this.t>0&&this[this.t-1]==c)--this.t}function bnToString(b){if(this.s<0)return"-"+this.negate().toString(b);var k;if(b==16)k=4;else if(b==8)k=3;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else return this.toRadix(b);var km=(1<<k)-1,d,m=false,r="",i=this.t;var p=this.DB-i*this.DB%k;if(i-->0){if(p<this.DB&&(d=this[i]>>p)>0){m=true;r=int2char(d)}while(i>=0){if(p<k){d=(this[i]&(1<<p)-1)<<k-p;d|=this[--i]>>(p+=this.DB-k)}else{d=this[i]>>(p-=k)&km;if(p<=0){p+=this.DB;--i}}if(d>0)m=true;if(m)r+=int2char(d)}}return m?r:"0"}function bnNegate(){var r=nbi();BigInteger.ZERO.subTo(this,r);return r}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var r=this.s-a.s;if(r!=0)return r;var i=this.t;r=i-a.t;if(r!=0)return this.s<0?-r:r;while(--i>=0)if((r=this[i]-a[i])!=0)return r;return 0}function nbits(x){var r=1,t;if((t=x>>>16)!=0){x=t;r+=16}if((t=x>>8)!=0){x=t;r+=8}if((t=x>>4)!=0){x=t;r+=4}if((t=x>>2)!=0){x=t;r+=2}if((t=x>>1)!=0){x=t;r+=1}return r}function bnBitLength(){if(this.t<=0)return 0;return this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(n,r){var i;for(i=this.t-1;i>=0;--i)r[i+n]=this[i];for(i=n-1;i>=0;--i)r[i]=0;r.t=this.t+n;r.s=this.s}function bnpDRShiftTo(n,r){for(var i=n;i<this.t;++i)r[i-n]=this[i];r.t=Math.max(this.t-n,0);r.s=this.s}function bnpLShiftTo(n,r){var bs=n%this.DB;var cbs=this.DB-bs;var bm=(1<<cbs)-1;var ds=Math.floor(n/this.DB),c=this.s<<bs&this.DM,i;for(i=this.t-1;i>=0;--i){r[i+ds+1]=this[i]>>cbs|c;c=(this[i]&bm)<<bs}for(i=ds-1;i>=0;--i)r[i]=0;r[ds]=c;r.t=this.t+ds+1;r.s=this.s;r.clamp()}function bnpRShiftTo(n,r){r.s=this.s;var ds=Math.floor(n/this.DB);if(ds>=this.t){r.t=0;return}var bs=n%this.DB;var cbs=this.DB-bs;var bm=(1<<bs)-1;r[0]=this[ds]>>bs;for(var i=ds+1;i<this.t;++i){r[i-ds-1]|=(this[i]&bm)<<cbs;r[i-ds]=this[i]>>bs}if(bs>0)r[this.t-ds-1]|=(this.s&bm)<<cbs;r.t=this.t-ds;r.clamp()}function bnpSubTo(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]-a[i];r[i++]=c&this.DM;c>>=this.DB}if(a.t<this.t){c-=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.DM;c>>=this.DB}c+=this.s}else{c+=this.s;while(i<a.t){c-=a[i];r[i++]=c&this.DM;c>>=this.DB}c-=a.s}r.s=c<0?-1:0;if(c<-1)r[i++]=this.DV+c;else if(c>0)r[i++]=c;r.t=i;r.clamp()}function bnpMultiplyTo(a,r){var x=this.abs(),y=a.abs();var i=x.t;r.t=i+y.t;while(--i>=0)r[i]=0;for(i=0;i<y.t;++i)r[i+x.t]=x.am(0,y[i],r,i,0,x.t);r.s=0;r.clamp();if(this.s!=a.s)BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(r){var x=this.abs();var i=r.t=2*x.t;while(--i>=0)r[i]=0;for(i=0;i<x.t-1;++i){var c=x.am(i,x[i],r,2*i,0,1);if((r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.DV){r[i+x.t]-=x.DV;r[i+x.t+1]=1}}if(r.t>0)r[r.t-1]+=x.am(i,x[i],r,2*i,0,1);r.s=0;r.clamp()}function bnpDivRemTo(m,q,r){var pm=m.abs();if(pm.t<=0)return;var pt=this.abs();if(pt.t<pm.t){if(q!=null)q.fromInt(0);if(r!=null)this.copyTo(r);return}if(r==null)r=nbi();var y=nbi(),ts=this.s,ms=m.s;var nsh=this.DB-nbits(pm[pm.t-1]);if(nsh>0){pm.lShiftTo(nsh,y);pt.lShiftTo(nsh,r)}else{pm.copyTo(y);pt.copyTo(r)}var ys=y.t;var y0=y[ys-1];if(y0==0)return;var yt=y0*(1<<this.F1)+(ys>1?y[ys-2]>>this.F2:0);var d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2;var i=r.t,j=i-ys,t=q==null?nbi():q;y.dlShiftTo(j,t);if(r.compareTo(t)>=0){r[r.t++]=1;r.subTo(t,r)}BigInteger.ONE.dlShiftTo(ys,t);t.subTo(y,y);while(y.t<ys)y[y.t++]=0;while(--j>=0){var qd=r[--i]==y0?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);if((r[i]+=y.am(0,qd,r,j,0,ys))<qd){y.dlShiftTo(j,t);r.subTo(t,r);while(r[i]<--qd)r.subTo(t,r)}}if(q!=null){r.drShiftTo(ys,q);if(ts!=ms)BigInteger.ZERO.subTo(q,q)}r.t=ys;r.clamp();if(nsh>0)r.rShiftTo(nsh,r);if(ts<0)BigInteger.ZERO.subTo(r,r)}function bnMod(a){var r=nbi();this.abs().divRemTo(a,null,r);if(this.s<0&&r.compareTo(BigInteger.ZERO)>0)a.subTo(r,r);return r}function Classic(m){this.m=m}function cConvert(x){if(x.s<0||x.compareTo(this.m)>=0)return x.mod(this.m);else return x}function cRevert(x){return x}function cReduce(x){x.divRemTo(this.m,null,x)}function cMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}function cSqrTo(x,r){x.squareTo(r);this.reduce(r)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var y=x&3;y=y*(2-(x&15)*y)&15;y=y*(2-(x&255)*y)&255;y=y*(2-((x&65535)*y&65535))&65535;y=y*(2-x*y%this.DV)%this.DV;return y>0?this.DV-y:-y}function Montgomery(m){this.m=m;this.mp=m.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<m.DB-15)-1;this.mt2=2*m.t}function montConvert(x){var r=nbi();x.abs().dlShiftTo(this.m.t,r);r.divRemTo(this.m,null,r);if(x.s<0&&r.compareTo(BigInteger.ZERO)>0)this.m.subTo(r,r);return r}function montRevert(x){var r=nbi();x.copyTo(r);this.reduce(r);return r}function montReduce(x){while(x.t<=this.mt2)x[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=x[i]&32767;var u0=j*this.mpl+((j*this.mph+(x[i]>>15)*this.mpl&this.um)<<15)&x.DM;j=i+this.m.t;x[j]+=this.m.am(0,u0,x,i,0,this.m.t);while(x[j]>=x.DV){x[j]-=x.DV;x[++j]++}}x.clamp();x.drShiftTo(this.m.t,x);if(x.compareTo(this.m)>=0)x.subTo(this.m,x)}function montSqrTo(x,r){x.squareTo(r);this.reduce(r)}function montMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)==0}function bnpExp(e,z){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),r2=nbi(),g=z.convert(this),i=nbits(e)-1;g.copyTo(r);while(--i>=0){z.sqrTo(r,r2);if((e&1<<i)>0)z.mulTo(r2,g,r);else{var t=r;r=r2;r2=t}}return z.revert(r)}function bnModPowInt(e,m){var z;if(e<256||m.isEven())z=new Classic(m);else z=new Montgomery(m);return this.exp(e,z)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnpFromRadix(s,b){this.fromInt(0);if(b==null)b=10;var cs=this.chunkSize(b);var d=Math.pow(b,cs),mi=false,j=0,w=0;for(var i=0;i<s.length;++i){var x=intAt(s,i);if(x<0){if(s.charAt(i)=="-"&&this.signum()==0)mi=true;continue}w=b*w+x;if(++j>=cs){this.dMultiply(d);this.dAddOffset(w,0);j=0;w=0}}if(j>0){this.dMultiply(Math.pow(b,j));this.dAddOffset(w,0)}if(mi)BigInteger.ZERO.subTo(this,this)}function bnpChunkSize(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function bnSigNum(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function bnpDMultiply(n){this[this.t]=this.am(0,n-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(n,w){if(n==0)return;while(this.t<=w)this[this.t++]=0;this[w]+=n;while(this[w]>=this.DV){this[w]-=this.DV;if(++w>=this.t)this[this.t++]=0;++this[w]}}function bnpToRadix(b){if(b==null)b=10;if(this.signum()==0||b<2||b>36)return"0";var cs=this.chunkSize(b);var a=Math.pow(b,cs);var d=nbv(a),y=nbi(),z=nbi(),r="";this.divRemTo(d,y,z);while(y.signum()>0){r=(a+z.intValue()).toString(b).substr(1)+r;y.divRemTo(d,y,z)}return z.intValue().toString(b)+r}function bnIntValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnpAddTo(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]+a[i];r[i++]=c&this.DM;c>>=this.DB}if(a.t<this.t){c+=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.DM;c>>=this.DB}c+=this.s}else{c+=this.s;while(i<a.t){c+=a[i];r[i++]=c&this.DM;c>>=this.DB}c+=a.s}r.s=c<0?-1:0;if(c>0)r[i++]=c;else if(c<-1)r[i++]=this.DV+c;r.t=i;r.clamp()}BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.addTo=bnpAddTo;var Wrapper={abs:(function(l,h){var x=new goog.math.Long(l,h);var ret;if(x.isNegative()){ret=x.negate()}else{ret=x}HEAP32[tempDoublePtr>>2]=ret.low_;HEAP32[tempDoublePtr+4>>2]=ret.high_}),ensureTemps:(function(){if(Wrapper.ensuredTemps)return;Wrapper.ensuredTemps=true;Wrapper.two32=new BigInteger;Wrapper.two32.fromString("4294967296",10);Wrapper.two64=new BigInteger;Wrapper.two64.fromString("18446744073709551616",10);Wrapper.temp1=new BigInteger;Wrapper.temp2=new BigInteger}),lh2bignum:(function(l,h){var a=new BigInteger;a.fromString(h.toString(),10);var b=new BigInteger;a.multiplyTo(Wrapper.two32,b);var c=new BigInteger;c.fromString(l.toString(),10);var d=new BigInteger;c.addTo(b,d);return d}),stringify:(function(l,h,unsigned){var ret=(new goog.math.Long(l,h)).toString();if(unsigned&&ret[0]=="-"){Wrapper.ensureTemps();var bignum=new BigInteger;bignum.fromString(ret,10);ret=new BigInteger;Wrapper.two64.addTo(bignum,ret);ret=ret.toString(10)}return ret}),fromString:(function(str,base,min,max,unsigned){Wrapper.ensureTemps();var bignum=new BigInteger;bignum.fromString(str,base);var bigmin=new BigInteger;bigmin.fromString(min,10);var bigmax=new BigInteger;bigmax.fromString(max,10);if(unsigned&&bignum.compareTo(BigInteger.ZERO)<0){var temp=new BigInteger;bignum.addTo(Wrapper.two64,temp);bignum=temp}var error=false;if(bignum.compareTo(bigmin)<0){bignum=bigmin;error=true}else if(bignum.compareTo(bigmax)>0){bignum=bigmax;error=true}var ret=goog.math.Long.fromString(bignum.toString());HEAP32[tempDoublePtr>>2]=ret.low_;HEAP32[tempDoublePtr+4>>2]=ret.high_;if(error)throw"range error"})};return Wrapper})();if(memoryInitializer){if(typeof Module["locateFile"]==="function"){memoryInitializer=Module["locateFile"](memoryInitializer)}else if(Module["memoryInitializerPrefixURL"]){memoryInitializer=Module["memoryInitializerPrefixURL"]+memoryInitializer}if(ENVIRONMENT_IS_NODE||ENVIRONMENT_IS_SHELL){var data=Module["readBinary"](memoryInitializer);HEAPU8.set(data,STATIC_BASE)}else{addRunDependency("memory initializer");Browser.asyncLoad(memoryInitializer,(function(data){HEAPU8.set(data,STATIC_BASE);removeRunDependency("memory initializer")}),(function(data){throw"could not load memory initializer "+memoryInitializer}))}}function ExitStatus(status){this.name="ExitStatus";this.message="Program terminated with exit("+status+")";this.status=status}ExitStatus.prototype=new Error;ExitStatus.prototype.constructor=ExitStatus;var initialStackTop;var preloadStartTime=null;var calledMain=false;dependenciesFulfilled=function runCaller(){if(!Module["calledRun"]&&shouldRunNow)run();if(!Module["calledRun"])dependenciesFulfilled=runCaller};Module["callMain"]=Module.callMain=function callMain(args){assert(runDependencies==0,"cannot call main when async dependencies remain! (listen on __ATMAIN__)");assert(__ATPRERUN__.length==0,"cannot call main when preRun functions remain to be called");args=args||[];ensureInitRuntime();var argc=args.length+1;function pad(){for(var i=0;i<4-1;i++){argv.push(0)}}var argv=[allocate(intArrayFromString(Module["thisProgram"]),"i8",ALLOC_NORMAL)];pad();for(var i=0;i<argc-1;i=i+1){argv.push(allocate(intArrayFromString(args[i]),"i8",ALLOC_NORMAL));pad()}argv.push(0);argv=allocate(argv,"i32",ALLOC_NORMAL);initialStackTop=STACKTOP;try{var ret=Module["_main"](argc,argv,0);exit(ret)}catch(e){if(e instanceof ExitStatus){return}else if(e=="SimulateInfiniteLoop"){Module["noExitRuntime"]=true;return}else{if(e&&typeof e==="object"&&e.stack)Module.printErr("exception thrown: "+[e,e.stack]);throw e}}finally{calledMain=true}};function run(args){args=args||Module["arguments"];if(preloadStartTime===null)preloadStartTime=Date.now();if(runDependencies>0){return}preRun();if(runDependencies>0)return;if(Module["calledRun"])return;function doRun(){if(Module["calledRun"])return;Module["calledRun"]=true;if(ABORT)return;ensureInitRuntime();preMain();if(ENVIRONMENT_IS_WEB&&preloadStartTime!==null){Module.printErr("pre-main prep time: "+(Date.now()-preloadStartTime)+" ms")}if(Module["_main"]&&shouldRunNow){Module["callMain"](args)}postRun()}if(Module["setStatus"]){Module["setStatus"]("Running...");setTimeout((function(){setTimeout((function(){Module["setStatus"]("")}),1);doRun()}),1)}else{doRun()}}Module["run"]=Module.run=run;function exit(status){if(Module["noExitRuntime"]){return}ABORT=true;EXITSTATUS=status;STACKTOP=initialStackTop;exitRuntime();if(ENVIRONMENT_IS_NODE){process["stdout"]["once"]("drain",(function(){process["exit"](status)}));console.log(" ");setTimeout((function(){process["exit"](status)}),500)}else if(ENVIRONMENT_IS_SHELL&&typeof quit==="function"){quit(status)}throw new ExitStatus(status)}Module["exit"]=Module.exit=exit;function abort(text){if(text){Module.print(text);Module.printErr(text)}ABORT=true;EXITSTATUS=1;var extra="\nIf this abort() is unexpected, build with -s ASSERTIONS=1 which can give more information.";throw"abort() at "+stackTrace()+extra}Module["abort"]=Module.abort=abort;if(Module["preInit"]){if(typeof Module["preInit"]=="function")Module["preInit"]=[Module["preInit"]];while(Module["preInit"].length>0){Module["preInit"].pop()()}}var shouldRunNow=true;if(Module["noInitialRun"]){shouldRunNow=false}Module["noExitRuntime"]=true;run();function WrapperObject(){}WrapperObject.prototype=Object.create(WrapperObject.prototype);WrapperObject.prototype.constructor=WrapperObject;WrapperObject.prototype.__class__=WrapperObject;WrapperObject.__cache__={};Module["WrapperObject"]=WrapperObject;function getCache(__class__){return(__class__||WrapperObject).__cache__}Module["getCache"]=getCache;function wrapPointer(ptr,__class__){var cache=getCache(__class__);var ret=cache[ptr];if(ret)return ret;ret=Object.create((__class__||WrapperObject).prototype);ret.ptr=ptr;return cache[ptr]=ret}Module["wrapPointer"]=wrapPointer;function castObject(obj,__class__){return wrapPointer(obj.ptr,__class__)}Module["castObject"]=castObject;Module["NULL"]=wrapPointer(0);function destroy(obj){if(!obj["__destroy__"])throw"Error: Cannot destroy object. (Did you create it yourself?)";obj["__destroy__"]();delete getCache(obj.__class__)[obj.ptr]}Module["destroy"]=destroy;function compare(obj1,obj2){return obj1.ptr===obj2.ptr}Module["compare"]=compare;function getPointer(obj){return obj.ptr}Module["getPointer"]=getPointer;function getClass(obj){return obj.__class__}Module["getClass"]=getClass;function ensureString(value){if(typeof value=="string")return allocate(intArrayFromString(value),"i8",ALLOC_STACK);return value}function btMatrix3x3(){throw"cannot construct a btMatrix3x3, no constructor in IDL"}btMatrix3x3.prototype=Object.create(WrapperObject.prototype);btMatrix3x3.prototype.constructor=btMatrix3x3;btMatrix3x3.prototype.__class__=btMatrix3x3;btMatrix3x3.__cache__={};Module["btMatrix3x3"]=btMatrix3x3;btMatrix3x3.prototype["setEulerZYX"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btMatrix3x3_setEulerZYX_3(self,arg0,arg1,arg2)});btMatrix3x3.prototype["getRotation"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btMatrix3x3_getRotation_1(self,arg0)});btMatrix3x3.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btMatrix3x3___destroy___0(self)});function ConcreteContactResultCallback(){this.ptr=_emscripten_bind_ConcreteContactResultCallback_ConcreteContactResultCallback_0();getCache(ConcreteContactResultCallback)[this.ptr]=this}ConcreteContactResultCallback.prototype=Object.create(ContactResultCallback.prototype);ConcreteContactResultCallback.prototype.constructor=ConcreteContactResultCallback;ConcreteContactResultCallback.prototype.__class__=ConcreteContactResultCallback;ConcreteContactResultCallback.__cache__={};Module["ConcreteContactResultCallback"]=ConcreteContactResultCallback;ConcreteContactResultCallback.prototype["addSingleResult"]=(function(arg0,arg1,arg2,arg3,arg4,arg5,arg6){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg5&&typeof arg5==="object")arg5=arg5.ptr;else arg5=ensureString(arg5);if(arg6&&typeof arg6==="object")arg6=arg6.ptr;else arg6=ensureString(arg6);return _emscripten_bind_ConcreteContactResultCallback_addSingleResult_7(self,arg0,arg1,arg2,arg3,arg4,arg5,arg6)});ConcreteContactResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_ConcreteContactResultCallback___destroy___0(self)});function btBvhTriangleMeshShape(arg0,arg1,arg2){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg2===undefined){this.ptr=_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_2(arg0,arg1);getCache(btBvhTriangleMeshShape)[this.ptr]=this;return}this.ptr=_emscripten_bind_btBvhTriangleMeshShape_btBvhTriangleMeshShape_3(arg0,arg1,arg2);getCache(btBvhTriangleMeshShape)[this.ptr]=this}btBvhTriangleMeshShape.prototype=Object.create(btTriangleMeshShape.prototype);btBvhTriangleMeshShape.prototype.constructor=btBvhTriangleMeshShape;btBvhTriangleMeshShape.prototype.__class__=btBvhTriangleMeshShape;btBvhTriangleMeshShape.__cache__={};Module["btBvhTriangleMeshShape"]=btBvhTriangleMeshShape;btBvhTriangleMeshShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btBvhTriangleMeshShape_setLocalScaling_1(self,arg0)});btBvhTriangleMeshShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btBvhTriangleMeshShape_calculateLocalInertia_2(self,arg0,arg1)});btBvhTriangleMeshShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btBvhTriangleMeshShape___destroy___0(self)});function btDbvtBroadphase(){this.ptr=_emscripten_bind_btDbvtBroadphase_btDbvtBroadphase_0();getCache(btDbvtBroadphase)[this.ptr]=this}btDbvtBroadphase.prototype=Object.create(WrapperObject.prototype);btDbvtBroadphase.prototype.constructor=btDbvtBroadphase;btDbvtBroadphase.prototype.__class__=btDbvtBroadphase;btDbvtBroadphase.__cache__={};Module["btDbvtBroadphase"]=btDbvtBroadphase;btDbvtBroadphase.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDbvtBroadphase___destroy___0(self)});function VoidPtr(){throw"cannot construct a VoidPtr, no constructor in IDL"}VoidPtr.prototype=Object.create(WrapperObject.prototype);VoidPtr.prototype.constructor=VoidPtr;VoidPtr.prototype.__class__=VoidPtr;VoidPtr.__cache__={};Module["VoidPtr"]=VoidPtr;VoidPtr.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_VoidPtr___destroy___0(self)});function btSequentialImpulseConstraintSolver(){this.ptr=_emscripten_bind_btSequentialImpulseConstraintSolver_btSequentialImpulseConstraintSolver_0();getCache(btSequentialImpulseConstraintSolver)[this.ptr]=this}btSequentialImpulseConstraintSolver.prototype=Object.create(WrapperObject.prototype);btSequentialImpulseConstraintSolver.prototype.constructor=btSequentialImpulseConstraintSolver;btSequentialImpulseConstraintSolver.prototype.__class__=btSequentialImpulseConstraintSolver;btSequentialImpulseConstraintSolver.__cache__={};Module["btSequentialImpulseConstraintSolver"]=btSequentialImpulseConstraintSolver;btSequentialImpulseConstraintSolver.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btSequentialImpulseConstraintSolver___destroy___0(self)});function btDispatcherInfo(){throw"cannot construct a btDispatcherInfo, no constructor in IDL"}btDispatcherInfo.prototype=Object.create(WrapperObject.prototype);btDispatcherInfo.prototype.constructor=btDispatcherInfo;btDispatcherInfo.prototype.__class__=btDispatcherInfo;btDispatcherInfo.__cache__={};Module["btDispatcherInfo"]=btDispatcherInfo;btDispatcherInfo.prototype["get_m_timeStep"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_timeStep_0(self)});btDispatcherInfo.prototype["set_m_timeStep"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_timeStep_1(self,arg0)});btDispatcherInfo.prototype["get_m_stepCount"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_stepCount_0(self)});btDispatcherInfo.prototype["set_m_stepCount"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_stepCount_1(self,arg0)});btDispatcherInfo.prototype["get_m_dispatchFunc"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_dispatchFunc_0(self)});btDispatcherInfo.prototype["set_m_dispatchFunc"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_dispatchFunc_1(self,arg0)});btDispatcherInfo.prototype["get_m_timeOfImpact"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_timeOfImpact_0(self)});btDispatcherInfo.prototype["set_m_timeOfImpact"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_timeOfImpact_1(self,arg0)});btDispatcherInfo.prototype["get_m_useContinuous"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_useContinuous_0(self)});btDispatcherInfo.prototype["set_m_useContinuous"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_useContinuous_1(self,arg0)});btDispatcherInfo.prototype["get_m_enableSatConvex"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_enableSatConvex_0(self)});btDispatcherInfo.prototype["set_m_enableSatConvex"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_enableSatConvex_1(self,arg0)});btDispatcherInfo.prototype["get_m_enableSPU"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_enableSPU_0(self)});btDispatcherInfo.prototype["set_m_enableSPU"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_enableSPU_1(self,arg0)});btDispatcherInfo.prototype["get_m_useEpa"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_useEpa_0(self)});btDispatcherInfo.prototype["set_m_useEpa"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_useEpa_1(self,arg0)});btDispatcherInfo.prototype["get_m_allowedCcdPenetration"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_allowedCcdPenetration_0(self)});btDispatcherInfo.prototype["set_m_allowedCcdPenetration"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_allowedCcdPenetration_1(self,arg0)});btDispatcherInfo.prototype["get_m_useConvexConservativeDistanceUtil"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_useConvexConservativeDistanceUtil_0(self)});btDispatcherInfo.prototype["set_m_useConvexConservativeDistanceUtil"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_useConvexConservativeDistanceUtil_1(self,arg0)});btDispatcherInfo.prototype["get_m_convexConservativeDistanceThreshold"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcherInfo_get_m_convexConservativeDistanceThreshold_0(self)});btDispatcherInfo.prototype["set_m_convexConservativeDistanceThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDispatcherInfo_set_m_convexConservativeDistanceThreshold_1(self,arg0)});btDispatcherInfo.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDispatcherInfo___destroy___0(self)});function btCapsuleShape(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btCapsuleShape_btCapsuleShape_2(arg0,arg1);getCache(btCapsuleShape)[this.ptr]=this}btCapsuleShape.prototype=Object.create(btCollisionShape.prototype);btCapsuleShape.prototype.constructor=btCapsuleShape;btCapsuleShape.prototype.__class__=btCapsuleShape;btCapsuleShape.__cache__={};Module["btCapsuleShape"]=btCapsuleShape;btCapsuleShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCapsuleShape_setLocalScaling_1(self,arg0)});btCapsuleShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCapsuleShape_calculateLocalInertia_2(self,arg0,arg1)});btCapsuleShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCapsuleShape___destroy___0(self)});function btCollisionConfiguration(){throw"cannot construct a btCollisionConfiguration, no constructor in IDL"}btCollisionConfiguration.prototype=Object.create(WrapperObject.prototype);btCollisionConfiguration.prototype.constructor=btCollisionConfiguration;btCollisionConfiguration.prototype.__class__=btCollisionConfiguration;btCollisionConfiguration.__cache__={};Module["btCollisionConfiguration"]=btCollisionConfiguration;btCollisionConfiguration.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCollisionConfiguration___destroy___0(self)});function btAxisSweep3(arg0,arg1,arg2,arg3,arg4){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg2===undefined){this.ptr=_emscripten_bind_btAxisSweep3_btAxisSweep3_2(arg0,arg1);getCache(btAxisSweep3)[this.ptr]=this;return}if(arg3===undefined){this.ptr=_emscripten_bind_btAxisSweep3_btAxisSweep3_3(arg0,arg1,arg2);getCache(btAxisSweep3)[this.ptr]=this;return}if(arg4===undefined){this.ptr=_emscripten_bind_btAxisSweep3_btAxisSweep3_4(arg0,arg1,arg2,arg3);getCache(btAxisSweep3)[this.ptr]=this;return}this.ptr=_emscripten_bind_btAxisSweep3_btAxisSweep3_5(arg0,arg1,arg2,arg3,arg4);getCache(btAxisSweep3)[this.ptr]=this}btAxisSweep3.prototype=Object.create(WrapperObject.prototype);btAxisSweep3.prototype.constructor=btAxisSweep3;btAxisSweep3.prototype.__class__=btAxisSweep3;btAxisSweep3.__cache__={};Module["btAxisSweep3"]=btAxisSweep3;btAxisSweep3.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btAxisSweep3___destroy___0(self)});function btPairCachingGhostObject(){this.ptr=_emscripten_bind_btPairCachingGhostObject_btPairCachingGhostObject_0();getCache(btPairCachingGhostObject)[this.ptr]=this}btPairCachingGhostObject.prototype=Object.create(btGhostObject.prototype);btPairCachingGhostObject.prototype.constructor=btPairCachingGhostObject;btPairCachingGhostObject.prototype.__class__=btPairCachingGhostObject;btPairCachingGhostObject.__cache__={};Module["btPairCachingGhostObject"]=btPairCachingGhostObject;btPairCachingGhostObject.prototype["getCollisionShape"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPairCachingGhostObject_getCollisionShape_0(self),btCollisionShape)});btPairCachingGhostObject.prototype["setContactProcessingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setContactProcessingThreshold_1(self,arg0)});btPairCachingGhostObject.prototype["setActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setActivationState_1(self,arg0)});btPairCachingGhostObject.prototype["forceActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_forceActivationState_1(self,arg0)});btPairCachingGhostObject.prototype["activate"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){_emscripten_bind_btPairCachingGhostObject_activate_0(self);return}_emscripten_bind_btPairCachingGhostObject_activate_1(self,arg0)});btPairCachingGhostObject.prototype["isActive"]=(function(){var self=this.ptr;return _emscripten_bind_btPairCachingGhostObject_isActive_0(self)});btPairCachingGhostObject.prototype["isKinematicObject"]=(function(){var self=this.ptr;return _emscripten_bind_btPairCachingGhostObject_isKinematicObject_0(self)});btPairCachingGhostObject.prototype["setRestitution"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setRestitution_1(self,arg0)});btPairCachingGhostObject.prototype["setFriction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setFriction_1(self,arg0)});btPairCachingGhostObject.prototype["getWorldTransform"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPairCachingGhostObject_getWorldTransform_0(self),btTransform)});btPairCachingGhostObject.prototype["getCollisionFlags"]=(function(){var self=this.ptr;return _emscripten_bind_btPairCachingGhostObject_getCollisionFlags_0(self)});btPairCachingGhostObject.prototype["setCollisionFlags"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setCollisionFlags_1(self,arg0)});btPairCachingGhostObject.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setWorldTransform_1(self,arg0)});btPairCachingGhostObject.prototype["setCollisionShape"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setCollisionShape_1(self,arg0)});btPairCachingGhostObject.prototype["setCcdMotionThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setCcdMotionThreshold_1(self,arg0)});btPairCachingGhostObject.prototype["setCcdSweptSphereRadius"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPairCachingGhostObject_setCcdSweptSphereRadius_1(self,arg0)});btPairCachingGhostObject.prototype["getNumOverlappingObjects"]=(function(){var self=this.ptr;return _emscripten_bind_btPairCachingGhostObject_getNumOverlappingObjects_0(self)});btPairCachingGhostObject.prototype["getOverlappingObject"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btPairCachingGhostObject_getOverlappingObject_1(self,arg0),btCollisionObject)});btPairCachingGhostObject.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btPairCachingGhostObject___destroy___0(self)});function btRigidBodyConstructionInfo(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg3===undefined){this.ptr=_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_3(arg0,arg1,arg2);getCache(btRigidBodyConstructionInfo)[this.ptr]=this;return}this.ptr=_emscripten_bind_btRigidBodyConstructionInfo_btRigidBodyConstructionInfo_4(arg0,arg1,arg2,arg3);getCache(btRigidBodyConstructionInfo)[this.ptr]=this}btRigidBodyConstructionInfo.prototype=Object.create(WrapperObject.prototype);btRigidBodyConstructionInfo.prototype.constructor=btRigidBodyConstructionInfo;btRigidBodyConstructionInfo.prototype.__class__=btRigidBodyConstructionInfo;btRigidBodyConstructionInfo.__cache__={};Module["btRigidBodyConstructionInfo"]=btRigidBodyConstructionInfo;btRigidBodyConstructionInfo.prototype["get_m_linearDamping"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_linearDamping_0(self)});btRigidBodyConstructionInfo.prototype["set_m_linearDamping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearDamping_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_angularDamping"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_angularDamping_0(self)});btRigidBodyConstructionInfo.prototype["set_m_angularDamping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularDamping_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_friction"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_friction_0(self)});btRigidBodyConstructionInfo.prototype["set_m_friction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_friction_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_rollingFriction"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_rollingFriction_0(self)});btRigidBodyConstructionInfo.prototype["set_m_rollingFriction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_rollingFriction_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_restitution"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_restitution_0(self)});btRigidBodyConstructionInfo.prototype["set_m_restitution"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_restitution_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_linearSleepingThreshold"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_linearSleepingThreshold_0(self)});btRigidBodyConstructionInfo.prototype["set_m_linearSleepingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_linearSleepingThreshold_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_angularSleepingThreshold"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_angularSleepingThreshold_0(self)});btRigidBodyConstructionInfo.prototype["set_m_angularSleepingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_angularSleepingThreshold_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_additionalDamping"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDamping_0(self)});btRigidBodyConstructionInfo.prototype["set_m_additionalDamping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDamping_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_additionalDampingFactor"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalDampingFactor_0(self)});btRigidBodyConstructionInfo.prototype["set_m_additionalDampingFactor"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalDampingFactor_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_additionalLinearDampingThresholdSqr"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalLinearDampingThresholdSqr_0(self)});btRigidBodyConstructionInfo.prototype["set_m_additionalLinearDampingThresholdSqr"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalLinearDampingThresholdSqr_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_additionalAngularDampingThresholdSqr"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingThresholdSqr_0(self)});btRigidBodyConstructionInfo.prototype["set_m_additionalAngularDampingThresholdSqr"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingThresholdSqr_1(self,arg0)});btRigidBodyConstructionInfo.prototype["get_m_additionalAngularDampingFactor"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBodyConstructionInfo_get_m_additionalAngularDampingFactor_0(self)});btRigidBodyConstructionInfo.prototype["set_m_additionalAngularDampingFactor"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBodyConstructionInfo_set_m_additionalAngularDampingFactor_1(self,arg0)});btRigidBodyConstructionInfo.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btRigidBodyConstructionInfo___destroy___0(self)});function btManifoldPoint(){throw"cannot construct a btManifoldPoint, no constructor in IDL"}btManifoldPoint.prototype=Object.create(WrapperObject.prototype);btManifoldPoint.prototype.constructor=btManifoldPoint;btManifoldPoint.prototype.__class__=btManifoldPoint;btManifoldPoint.__cache__={};Module["btManifoldPoint"]=btManifoldPoint;btManifoldPoint.prototype["getPositionWorldOnA"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_getPositionWorldOnA_0(self),btVector3)});btManifoldPoint.prototype["getPositionWorldOnB"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_getPositionWorldOnB_0(self),btVector3)});btManifoldPoint.prototype["get_m_localPointA"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_get_m_localPointA_0(self),btVector3)});btManifoldPoint.prototype["set_m_localPointA"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btManifoldPoint_set_m_localPointA_1(self,arg0)});btManifoldPoint.prototype["get_m_localPointB"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_get_m_localPointB_0(self),btVector3)});btManifoldPoint.prototype["set_m_localPointB"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btManifoldPoint_set_m_localPointB_1(self,arg0)});btManifoldPoint.prototype["get_m_positionWorldOnB"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_get_m_positionWorldOnB_0(self),btVector3)});btManifoldPoint.prototype["set_m_positionWorldOnB"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btManifoldPoint_set_m_positionWorldOnB_1(self,arg0)});btManifoldPoint.prototype["get_m_positionWorldOnA"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_get_m_positionWorldOnA_0(self),btVector3)});btManifoldPoint.prototype["set_m_positionWorldOnA"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btManifoldPoint_set_m_positionWorldOnA_1(self,arg0)});btManifoldPoint.prototype["get_m_normalWorldOnB"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btManifoldPoint_get_m_normalWorldOnB_0(self),btVector3)});btManifoldPoint.prototype["set_m_normalWorldOnB"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btManifoldPoint_set_m_normalWorldOnB_1(self,arg0)});btManifoldPoint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btManifoldPoint___destroy___0(self)});function btGeneric6DofConstraint(arg0,arg1,arg2,arg3,arg4){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg3===undefined){this.ptr=_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_3(arg0,arg1,arg2);getCache(btGeneric6DofConstraint)[this.ptr]=this;return}if(arg4===undefined){this.ptr=_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_4(arg0,arg1,arg2,arg3);getCache(btGeneric6DofConstraint)[this.ptr]=this;return}this.ptr=_emscripten_bind_btGeneric6DofConstraint_btGeneric6DofConstraint_5(arg0,arg1,arg2,arg3,arg4);getCache(btGeneric6DofConstraint)[this.ptr]=this}btGeneric6DofConstraint.prototype=Object.create(WrapperObject.prototype);btGeneric6DofConstraint.prototype.constructor=btGeneric6DofConstraint;btGeneric6DofConstraint.prototype.__class__=btGeneric6DofConstraint;btGeneric6DofConstraint.__cache__={};Module["btGeneric6DofConstraint"]=btGeneric6DofConstraint;btGeneric6DofConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btGeneric6DofConstraint___destroy___0(self)});function btStridingMeshInterface(){throw"cannot construct a btStridingMeshInterface, no constructor in IDL"}btStridingMeshInterface.prototype=Object.create(WrapperObject.prototype);btStridingMeshInterface.prototype.constructor=btStridingMeshInterface;btStridingMeshInterface.prototype.__class__=btStridingMeshInterface;btStridingMeshInterface.__cache__={};Module["btStridingMeshInterface"]=btStridingMeshInterface;btStridingMeshInterface.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btStridingMeshInterface___destroy___0(self)});function btBroadphaseInterface(){throw"cannot construct a btBroadphaseInterface, no constructor in IDL"}btBroadphaseInterface.prototype=Object.create(WrapperObject.prototype);btBroadphaseInterface.prototype.constructor=btBroadphaseInterface;btBroadphaseInterface.prototype.__class__=btBroadphaseInterface;btBroadphaseInterface.__cache__={};Module["btBroadphaseInterface"]=btBroadphaseInterface;btBroadphaseInterface.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btBroadphaseInterface___destroy___0(self)});function btCollisionObject(){throw"cannot construct a btCollisionObject, no constructor in IDL"}btCollisionObject.prototype=Object.create(WrapperObject.prototype);btCollisionObject.prototype.constructor=btCollisionObject;btCollisionObject.prototype.__class__=btCollisionObject;btCollisionObject.__cache__={};Module["btCollisionObject"]=btCollisionObject;btCollisionObject.prototype["getCollisionShape"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionObject_getCollisionShape_0(self),btCollisionShape)});btCollisionObject.prototype["setContactProcessingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setContactProcessingThreshold_1(self,arg0)});btCollisionObject.prototype["setActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setActivationState_1(self,arg0)});btCollisionObject.prototype["forceActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_forceActivationState_1(self,arg0)});btCollisionObject.prototype["activate"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){_emscripten_bind_btCollisionObject_activate_0(self);return}_emscripten_bind_btCollisionObject_activate_1(self,arg0)});btCollisionObject.prototype["isActive"]=(function(){var self=this.ptr;return _emscripten_bind_btCollisionObject_isActive_0(self)});btCollisionObject.prototype["isKinematicObject"]=(function(){var self=this.ptr;return _emscripten_bind_btCollisionObject_isKinematicObject_0(self)});btCollisionObject.prototype["setRestitution"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setRestitution_1(self,arg0)});btCollisionObject.prototype["setFriction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setFriction_1(self,arg0)});btCollisionObject.prototype["getWorldTransform"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionObject_getWorldTransform_0(self),btTransform)});btCollisionObject.prototype["getCollisionFlags"]=(function(){var self=this.ptr;return _emscripten_bind_btCollisionObject_getCollisionFlags_0(self)});btCollisionObject.prototype["setCollisionFlags"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setCollisionFlags_1(self,arg0)});btCollisionObject.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setWorldTransform_1(self,arg0)});btCollisionObject.prototype["setCollisionShape"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setCollisionShape_1(self,arg0)});btCollisionObject.prototype["setCcdMotionThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setCcdMotionThreshold_1(self,arg0)});btCollisionObject.prototype["setCcdSweptSphereRadius"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionObject_setCcdSweptSphereRadius_1(self,arg0)});btCollisionObject.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCollisionObject___destroy___0(self)});function btDiscreteDynamicsWorld(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);this.ptr=_emscripten_bind_btDiscreteDynamicsWorld_btDiscreteDynamicsWorld_4(arg0,arg1,arg2,arg3);getCache(btDiscreteDynamicsWorld)[this.ptr]=this}btDiscreteDynamicsWorld.prototype=Object.create(btDynamicsWorld.prototype);btDiscreteDynamicsWorld.prototype.constructor=btDiscreteDynamicsWorld;btDiscreteDynamicsWorld.prototype.__class__=btDiscreteDynamicsWorld;btDiscreteDynamicsWorld.__cache__={};Module["btDiscreteDynamicsWorld"]=btDiscreteDynamicsWorld;btDiscreteDynamicsWorld.prototype["setGravity"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDiscreteDynamicsWorld_setGravity_1(self,arg0)});btDiscreteDynamicsWorld.prototype["getGravity"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDiscreteDynamicsWorld_getGravity_0(self),btVector3)});btDiscreteDynamicsWorld.prototype["addRigidBody"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg1===undefined){_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_1(self,arg0);return}if(arg2===undefined){_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_2(self,arg0,arg1);return}_emscripten_bind_btDiscreteDynamicsWorld_addRigidBody_3(self,arg0,arg1,arg2)});btDiscreteDynamicsWorld.prototype["removeRigidBody"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDiscreteDynamicsWorld_removeRigidBody_1(self,arg0)});btDiscreteDynamicsWorld.prototype["addConstraint"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg1===undefined){_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_1(self,arg0);return}_emscripten_bind_btDiscreteDynamicsWorld_addConstraint_2(self,arg0,arg1)});btDiscreteDynamicsWorld.prototype["removeConstraint"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDiscreteDynamicsWorld_removeConstraint_1(self,arg0)});btDiscreteDynamicsWorld.prototype["stepSimulation"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg1===undefined){return _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_1(self,arg0)}if(arg2===undefined){return _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_2(self,arg0,arg1)}return _emscripten_bind_btDiscreteDynamicsWorld_stepSimulation_3(self,arg0,arg1,arg2)});btDiscreteDynamicsWorld.prototype["getDispatcher"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDiscreteDynamicsWorld_getDispatcher_0(self),btDispatcher)});btDiscreteDynamicsWorld.prototype["rayTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btDiscreteDynamicsWorld_rayTest_3(self,arg0,arg1,arg2)});btDiscreteDynamicsWorld.prototype["getPairCache"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDiscreteDynamicsWorld_getPairCache_0(self),btOverlappingPairCache)});btDiscreteDynamicsWorld.prototype["getDispatchInfo"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDiscreteDynamicsWorld_getDispatchInfo_0(self),btDispatcherInfo)});btDiscreteDynamicsWorld.prototype["addCollisionObject"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg1===undefined){_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_1(self,arg0);return}if(arg2===undefined){_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_2(self,arg0,arg1);return}_emscripten_bind_btDiscreteDynamicsWorld_addCollisionObject_3(self,arg0,arg1,arg2)});btDiscreteDynamicsWorld.prototype["getBroadphase"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDiscreteDynamicsWorld_getBroadphase_0(self),btBroadphaseInterface)});btDiscreteDynamicsWorld.prototype["convexSweepTest"]=(function(arg0,arg1,arg2,arg3,arg4){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);_emscripten_bind_btDiscreteDynamicsWorld_convexSweepTest_5(self,arg0,arg1,arg2,arg3,arg4)});btDiscreteDynamicsWorld.prototype["contactPairTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btDiscreteDynamicsWorld_contactPairTest_3(self,arg0,arg1,arg2)});btDiscreteDynamicsWorld.prototype["addAction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDiscreteDynamicsWorld_addAction_1(self,arg0)});btDiscreteDynamicsWorld.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDiscreteDynamicsWorld___destroy___0(self)});function btConvexTriangleMeshShape(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg1===undefined){this.ptr=_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_1(arg0);getCache(btConvexTriangleMeshShape)[this.ptr]=this;return}this.ptr=_emscripten_bind_btConvexTriangleMeshShape_btConvexTriangleMeshShape_2(arg0,arg1);getCache(btConvexTriangleMeshShape)[this.ptr]=this}btConvexTriangleMeshShape.prototype=Object.create(btConvexShape.prototype);btConvexTriangleMeshShape.prototype.constructor=btConvexTriangleMeshShape;btConvexTriangleMeshShape.prototype.__class__=btConvexTriangleMeshShape;btConvexTriangleMeshShape.__cache__={};Module["btConvexTriangleMeshShape"]=btConvexTriangleMeshShape;btConvexTriangleMeshShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConvexTriangleMeshShape_setLocalScaling_1(self,arg0)});btConvexTriangleMeshShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConvexTriangleMeshShape_calculateLocalInertia_2(self,arg0,arg1)});btConvexTriangleMeshShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConvexTriangleMeshShape___destroy___0(self)});function ConvexResultCallback(){throw"cannot construct a ConvexResultCallback, no constructor in IDL"}ConvexResultCallback.prototype=Object.create(WrapperObject.prototype);ConvexResultCallback.prototype.constructor=ConvexResultCallback;ConvexResultCallback.prototype.__class__=ConvexResultCallback;ConvexResultCallback.__cache__={};Module["ConvexResultCallback"]=ConvexResultCallback;ConvexResultCallback.prototype["hasHit"]=(function(){var self=this.ptr;return _emscripten_bind_ConvexResultCallback_hasHit_0(self)});ConvexResultCallback.prototype["get_m_collisionFilterGroup"]=(function(){var self=this.ptr;return _emscripten_bind_ConvexResultCallback_get_m_collisionFilterGroup_0(self)});ConvexResultCallback.prototype["set_m_collisionFilterGroup"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ConvexResultCallback_set_m_collisionFilterGroup_1(self,arg0)});ConvexResultCallback.prototype["get_m_collisionFilterMask"]=(function(){var self=this.ptr;return _emscripten_bind_ConvexResultCallback_get_m_collisionFilterMask_0(self)});ConvexResultCallback.prototype["set_m_collisionFilterMask"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ConvexResultCallback_set_m_collisionFilterMask_1(self,arg0)});ConvexResultCallback.prototype["get_m_closestHitFraction"]=(function(){var self=this.ptr;return _emscripten_bind_ConvexResultCallback_get_m_closestHitFraction_0(self)});ConvexResultCallback.prototype["set_m_closestHitFraction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ConvexResultCallback_set_m_closestHitFraction_1(self,arg0)});ConvexResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_ConvexResultCallback___destroy___0(self)});function btPoint2PointConstraint(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg2===undefined){this.ptr=_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_2(arg0,arg1);getCache(btPoint2PointConstraint)[this.ptr]=this;return}if(arg3===undefined){this.ptr=_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_3(arg0,arg1,arg2);getCache(btPoint2PointConstraint)[this.ptr]=this;return}this.ptr=_emscripten_bind_btPoint2PointConstraint_btPoint2PointConstraint_4(arg0,arg1,arg2,arg3);getCache(btPoint2PointConstraint)[this.ptr]=this}btPoint2PointConstraint.prototype=Object.create(btTypedConstraint.prototype);btPoint2PointConstraint.prototype.constructor=btPoint2PointConstraint;btPoint2PointConstraint.prototype.__class__=btPoint2PointConstraint;btPoint2PointConstraint.__cache__={};Module["btPoint2PointConstraint"]=btPoint2PointConstraint;btPoint2PointConstraint.prototype["setPivotA"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPoint2PointConstraint_setPivotA_1(self,arg0)});btPoint2PointConstraint.prototype["setPivotB"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPoint2PointConstraint_setPivotB_1(self,arg0)});btPoint2PointConstraint.prototype["getPivotInA"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPoint2PointConstraint_getPivotInA_0(self),btVector3)});btPoint2PointConstraint.prototype["getPivotInB"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPoint2PointConstraint_getPivotInB_0(self),btVector3)});btPoint2PointConstraint.prototype["enableFeedback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPoint2PointConstraint_enableFeedback_1(self,arg0)});btPoint2PointConstraint.prototype["get_m_setting"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPoint2PointConstraint_get_m_setting_0(self),btConstraintSetting)});btPoint2PointConstraint.prototype["set_m_setting"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btPoint2PointConstraint_set_m_setting_1(self,arg0)});btPoint2PointConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btPoint2PointConstraint___destroy___0(self)});function btMotionState(){throw"cannot construct a btMotionState, no constructor in IDL"}btMotionState.prototype=Object.create(WrapperObject.prototype);btMotionState.prototype.constructor=btMotionState;btMotionState.prototype.__class__=btMotionState;btMotionState.__cache__={};Module["btMotionState"]=btMotionState;btMotionState.prototype["getWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btMotionState_getWorldTransform_1(self,arg0)});btMotionState.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btMotionState_setWorldTransform_1(self,arg0)});btMotionState.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btMotionState___destroy___0(self)});function btSliderConstraint(arg0,arg1,arg2,arg3,arg4){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg3===undefined){this.ptr=_emscripten_bind_btSliderConstraint_btSliderConstraint_3(arg0,arg1,arg2);getCache(btSliderConstraint)[this.ptr]=this;return}if(arg4===undefined){this.ptr=_emscripten_bind_btSliderConstraint_btSliderConstraint_4(arg0,arg1,arg2,arg3);getCache(btSliderConstraint)[this.ptr]=this;return}this.ptr=_emscripten_bind_btSliderConstraint_btSliderConstraint_5(arg0,arg1,arg2,arg3,arg4);getCache(btSliderConstraint)[this.ptr]=this}btSliderConstraint.prototype=Object.create(btTypedConstraint.prototype);btSliderConstraint.prototype.constructor=btSliderConstraint;btSliderConstraint.prototype.__class__=btSliderConstraint;btSliderConstraint.__cache__={};Module["btSliderConstraint"]=btSliderConstraint;btSliderConstraint.prototype["setLowerLinLimit"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSliderConstraint_setLowerLinLimit_1(self,arg0)});btSliderConstraint.prototype["setUpperLinLimit"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSliderConstraint_setUpperLinLimit_1(self,arg0)});btSliderConstraint.prototype["setLowerAngLimit"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSliderConstraint_setLowerAngLimit_1(self,arg0)});btSliderConstraint.prototype["setUpperAngLimit"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSliderConstraint_setUpperAngLimit_1(self,arg0)});btSliderConstraint.prototype["enableFeedback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSliderConstraint_enableFeedback_1(self,arg0)});btSliderConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btSliderConstraint___destroy___0(self)});function btConeTwistConstraint(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg2===undefined){this.ptr=_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_2(arg0,arg1);getCache(btConeTwistConstraint)[this.ptr]=this;return}if(arg3===undefined){this.ptr=_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_3(arg0,arg1,arg2);getCache(btConeTwistConstraint)[this.ptr]=this;return}this.ptr=_emscripten_bind_btConeTwistConstraint_btConeTwistConstraint_4(arg0,arg1,arg2,arg3);getCache(btConeTwistConstraint)[this.ptr]=this}btConeTwistConstraint.prototype=Object.create(btTypedConstraint.prototype);btConeTwistConstraint.prototype.constructor=btConeTwistConstraint;btConeTwistConstraint.prototype.__class__=btConeTwistConstraint;btConeTwistConstraint.__cache__={};Module["btConeTwistConstraint"]=btConeTwistConstraint;btConeTwistConstraint.prototype["setLimit"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConeTwistConstraint_setLimit_2(self,arg0,arg1)});btConeTwistConstraint.prototype["setAngularOnly"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setAngularOnly_1(self,arg0)});btConeTwistConstraint.prototype["setDamping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setDamping_1(self,arg0)});btConeTwistConstraint.prototype["enableMotor"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_enableMotor_1(self,arg0)});btConeTwistConstraint.prototype["setMaxMotorImpulse"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulse_1(self,arg0)});btConeTwistConstraint.prototype["setMaxMotorImpulseNormalized"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setMaxMotorImpulseNormalized_1(self,arg0)});btConeTwistConstraint.prototype["setMotorTarget"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setMotorTarget_1(self,arg0)});btConeTwistConstraint.prototype["setMotorTargetInConstraintSpace"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_setMotorTargetInConstraintSpace_1(self,arg0)});btConeTwistConstraint.prototype["enableFeedback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeTwistConstraint_enableFeedback_1(self,arg0)});btConeTwistConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConeTwistConstraint___destroy___0(self)});function btConeShape(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btConeShape_btConeShape_2(arg0,arg1);getCache(btConeShape)[this.ptr]=this}btConeShape.prototype=Object.create(btCollisionShape.prototype);btConeShape.prototype.constructor=btConeShape;btConeShape.prototype.__class__=btConeShape;btConeShape.__cache__={};Module["btConeShape"]=btConeShape;btConeShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeShape_setLocalScaling_1(self,arg0)});btConeShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConeShape_calculateLocalInertia_2(self,arg0,arg1)});btConeShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConeShape___destroy___0(self)});function btConvexShape(){throw"cannot construct a btConvexShape, no constructor in IDL"}btConvexShape.prototype=Object.create(btCollisionShape.prototype);btConvexShape.prototype.constructor=btConvexShape;btConvexShape.prototype.__class__=btConvexShape;btConvexShape.__cache__={};Module["btConvexShape"]=btConvexShape;btConvexShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConvexShape_setLocalScaling_1(self,arg0)});btConvexShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConvexShape_calculateLocalInertia_2(self,arg0,arg1)});btConvexShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConvexShape___destroy___0(self)});function btDefaultCollisionConfiguration(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){this.ptr=_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_0();getCache(btDefaultCollisionConfiguration)[this.ptr]=this;return}this.ptr=_emscripten_bind_btDefaultCollisionConfiguration_btDefaultCollisionConfiguration_1(arg0);getCache(btDefaultCollisionConfiguration)[this.ptr]=this}btDefaultCollisionConfiguration.prototype=Object.create(WrapperObject.prototype);btDefaultCollisionConfiguration.prototype.constructor=btDefaultCollisionConfiguration;btDefaultCollisionConfiguration.prototype.__class__=btDefaultCollisionConfiguration;btDefaultCollisionConfiguration.__cache__={};Module["btDefaultCollisionConfiguration"]=btDefaultCollisionConfiguration;btDefaultCollisionConfiguration.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDefaultCollisionConfiguration___destroy___0(self)});function ContactResultCallback(){throw"cannot construct a ContactResultCallback, no constructor in IDL"}ContactResultCallback.prototype=Object.create(WrapperObject.prototype);ContactResultCallback.prototype.constructor=ContactResultCallback;ContactResultCallback.prototype.__class__=ContactResultCallback;ContactResultCallback.__cache__={};Module["ContactResultCallback"]=ContactResultCallback;ContactResultCallback.prototype["addSingleResult"]=(function(arg0,arg1,arg2,arg3,arg4,arg5,arg6){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg5&&typeof arg5==="object")arg5=arg5.ptr;else arg5=ensureString(arg5);if(arg6&&typeof arg6==="object")arg6=arg6.ptr;else arg6=ensureString(arg6);return _emscripten_bind_ContactResultCallback_addSingleResult_7(self,arg0,arg1,arg2,arg3,arg4,arg5,arg6)});ContactResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_ContactResultCallback___destroy___0(self)});function btConeShapeZ(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btConeShapeZ_btConeShapeZ_2(arg0,arg1);getCache(btConeShapeZ)[this.ptr]=this}btConeShapeZ.prototype=Object.create(btConeShape.prototype);btConeShapeZ.prototype.constructor=btConeShapeZ;btConeShapeZ.prototype.__class__=btConeShapeZ;btConeShapeZ.__cache__={};Module["btConeShapeZ"]=btConeShapeZ;btConeShapeZ.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeShapeZ_setLocalScaling_1(self,arg0)});btConeShapeZ.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConeShapeZ_calculateLocalInertia_2(self,arg0,arg1)});btConeShapeZ.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConeShapeZ___destroy___0(self)});function btConeShapeX(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btConeShapeX_btConeShapeX_2(arg0,arg1);getCache(btConeShapeX)[this.ptr]=this}btConeShapeX.prototype=Object.create(btConeShape.prototype);btConeShapeX.prototype.constructor=btConeShapeX;btConeShapeX.prototype.__class__=btConeShapeX;btConeShapeX.__cache__={};Module["btConeShapeX"]=btConeShapeX;btConeShapeX.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConeShapeX_setLocalScaling_1(self,arg0)});btConeShapeX.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConeShapeX_calculateLocalInertia_2(self,arg0,arg1)});btConeShapeX.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConeShapeX___destroy___0(self)});function btTriangleMesh(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg0===undefined){this.ptr=_emscripten_bind_btTriangleMesh_btTriangleMesh_0();getCache(btTriangleMesh)[this.ptr]=this;return}if(arg1===undefined){this.ptr=_emscripten_bind_btTriangleMesh_btTriangleMesh_1(arg0);getCache(btTriangleMesh)[this.ptr]=this;return}this.ptr=_emscripten_bind_btTriangleMesh_btTriangleMesh_2(arg0,arg1);getCache(btTriangleMesh)[this.ptr]=this}btTriangleMesh.prototype=Object.create(btStridingMeshInterface.prototype);btTriangleMesh.prototype.constructor=btTriangleMesh;btTriangleMesh.prototype.__class__=btTriangleMesh;btTriangleMesh.__cache__={};Module["btTriangleMesh"]=btTriangleMesh;btTriangleMesh.prototype["addTriangle"]=(function(arg0,arg1,arg2,arg3){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg3===undefined){_emscripten_bind_btTriangleMesh_addTriangle_3(self,arg0,arg1,arg2);return}_emscripten_bind_btTriangleMesh_addTriangle_4(self,arg0,arg1,arg2,arg3)});btTriangleMesh.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btTriangleMesh___destroy___0(self)});function btConvexHullShape(){this.ptr=_emscripten_bind_btConvexHullShape_btConvexHullShape_0();getCache(btConvexHullShape)[this.ptr]=this}btConvexHullShape.prototype=Object.create(btCollisionShape.prototype);btConvexHullShape.prototype.constructor=btConvexHullShape;btConvexHullShape.prototype.__class__=btConvexHullShape;btConvexHullShape.__cache__={};Module["btConvexHullShape"]=btConvexHullShape;btConvexHullShape.prototype["addPoint"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg1===undefined){_emscripten_bind_btConvexHullShape_addPoint_1(self,arg0);return}_emscripten_bind_btConvexHullShape_addPoint_2(self,arg0,arg1)});btConvexHullShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConvexHullShape_setLocalScaling_1(self,arg0)});btConvexHullShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConvexHullShape_calculateLocalInertia_2(self,arg0,arg1)});btConvexHullShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConvexHullShape___destroy___0(self)});function btPersistentManifold(){this.ptr=_emscripten_bind_btPersistentManifold_btPersistentManifold_0();getCache(btPersistentManifold)[this.ptr]=this}btPersistentManifold.prototype=Object.create(WrapperObject.prototype);btPersistentManifold.prototype.constructor=btPersistentManifold;btPersistentManifold.prototype.__class__=btPersistentManifold;btPersistentManifold.__cache__={};Module["btPersistentManifold"]=btPersistentManifold;btPersistentManifold.prototype["getBody0"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPersistentManifold_getBody0_0(self),btCollisionObject)});btPersistentManifold.prototype["getBody1"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btPersistentManifold_getBody1_0(self),btCollisionObject)});btPersistentManifold.prototype["getNumContacts"]=(function(){var self=this.ptr;return _emscripten_bind_btPersistentManifold_getNumContacts_0(self)});btPersistentManifold.prototype["getContactPoint"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btPersistentManifold_getContactPoint_1(self,arg0),btManifoldPoint)});btPersistentManifold.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btPersistentManifold___destroy___0(self)});function btBoxShape(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btBoxShape_btBoxShape_1(arg0);getCache(btBoxShape)[this.ptr]=this}btBoxShape.prototype=Object.create(btCollisionShape.prototype);btBoxShape.prototype.constructor=btBoxShape;btBoxShape.prototype.__class__=btBoxShape;btBoxShape.__cache__={};Module["btBoxShape"]=btBoxShape;btBoxShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btBoxShape_setLocalScaling_1(self,arg0)});btBoxShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btBoxShape_calculateLocalInertia_2(self,arg0,arg1)});btBoxShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btBoxShape___destroy___0(self)});function btCollisionDispatcher(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btCollisionDispatcher_btCollisionDispatcher_1(arg0);getCache(btCollisionDispatcher)[this.ptr]=this}btCollisionDispatcher.prototype=Object.create(btDispatcher.prototype);btCollisionDispatcher.prototype.constructor=btCollisionDispatcher;btCollisionDispatcher.prototype.__class__=btCollisionDispatcher;btCollisionDispatcher.__cache__={};Module["btCollisionDispatcher"]=btCollisionDispatcher;btCollisionDispatcher.prototype["getNumManifolds"]=(function(){var self=this.ptr;return _emscripten_bind_btCollisionDispatcher_getNumManifolds_0(self)});btCollisionDispatcher.prototype["getManifoldByIndexInternal"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btCollisionDispatcher_getManifoldByIndexInternal_1(self,arg0),btPersistentManifold)});btCollisionDispatcher.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCollisionDispatcher___destroy___0(self)});function btVehicleTuning(){this.ptr=_emscripten_bind_btVehicleTuning_btVehicleTuning_0();getCache(btVehicleTuning)[this.ptr]=this}btVehicleTuning.prototype=Object.create(WrapperObject.prototype);btVehicleTuning.prototype.constructor=btVehicleTuning;btVehicleTuning.prototype.__class__=btVehicleTuning;btVehicleTuning.__cache__={};Module["btVehicleTuning"]=btVehicleTuning;btVehicleTuning.prototype["get_m_suspensionStiffness"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_suspensionStiffness_0(self)});btVehicleTuning.prototype["set_m_suspensionStiffness"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_suspensionStiffness_1(self,arg0)});btVehicleTuning.prototype["get_m_suspensionCompression"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_suspensionCompression_0(self)});btVehicleTuning.prototype["set_m_suspensionCompression"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_suspensionCompression_1(self,arg0)});btVehicleTuning.prototype["get_m_suspensionDamping"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_suspensionDamping_0(self)});btVehicleTuning.prototype["set_m_suspensionDamping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_suspensionDamping_1(self,arg0)});btVehicleTuning.prototype["get_m_maxSuspensionTravelCm"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_maxSuspensionTravelCm_0(self)});btVehicleTuning.prototype["set_m_maxSuspensionTravelCm"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_maxSuspensionTravelCm_1(self,arg0)});btVehicleTuning.prototype["get_m_frictionSlip"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_frictionSlip_0(self)});btVehicleTuning.prototype["set_m_frictionSlip"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_frictionSlip_1(self,arg0)});btVehicleTuning.prototype["get_m_maxSuspensionForce"]=(function(){var self=this.ptr;return _emscripten_bind_btVehicleTuning_get_m_maxSuspensionForce_0(self)});btVehicleTuning.prototype["set_m_maxSuspensionForce"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVehicleTuning_set_m_maxSuspensionForce_1(self,arg0)});function btCompoundShape(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){this.ptr=_emscripten_bind_btCompoundShape_btCompoundShape_0();getCache(btCompoundShape)[this.ptr]=this;return}this.ptr=_emscripten_bind_btCompoundShape_btCompoundShape_1(arg0);getCache(btCompoundShape)[this.ptr]=this}btCompoundShape.prototype=Object.create(btCollisionShape.prototype);btCompoundShape.prototype.constructor=btCompoundShape;btCompoundShape.prototype.__class__=btCompoundShape;btCompoundShape.__cache__={};Module["btCompoundShape"]=btCompoundShape;btCompoundShape.prototype["addChildShape"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCompoundShape_addChildShape_2(self,arg0,arg1)});btCompoundShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCompoundShape_setLocalScaling_1(self,arg0)});btCompoundShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCompoundShape_calculateLocalInertia_2(self,arg0,arg1)});btCompoundShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCompoundShape___destroy___0(self)});function btCollisionObjectWrapper(){throw"cannot construct a btCollisionObjectWrapper, no constructor in IDL"}btCollisionObjectWrapper.prototype=Object.create(WrapperObject.prototype);btCollisionObjectWrapper.prototype.constructor=btCollisionObjectWrapper;btCollisionObjectWrapper.prototype.__class__=btCollisionObjectWrapper;btCollisionObjectWrapper.__cache__={};Module["btCollisionObjectWrapper"]=btCollisionObjectWrapper;function ClosestConvexResultCallback(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_ClosestConvexResultCallback_ClosestConvexResultCallback_2(arg0,arg1);getCache(ClosestConvexResultCallback)[this.ptr]=this}ClosestConvexResultCallback.prototype=Object.create(ConvexResultCallback.prototype);ClosestConvexResultCallback.prototype.constructor=ClosestConvexResultCallback;ClosestConvexResultCallback.prototype.__class__=ClosestConvexResultCallback;ClosestConvexResultCallback.__cache__={};Module["ClosestConvexResultCallback"]=ClosestConvexResultCallback;ClosestConvexResultCallback.prototype["hasHit"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestConvexResultCallback_hasHit_0(self)});ClosestConvexResultCallback.prototype["get_m_convexFromWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestConvexResultCallback_get_m_convexFromWorld_0(self),btVector3)});ClosestConvexResultCallback.prototype["set_m_convexFromWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_convexFromWorld_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_convexToWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestConvexResultCallback_get_m_convexToWorld_0(self),btVector3)});ClosestConvexResultCallback.prototype["set_m_convexToWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_convexToWorld_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_hitNormalWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestConvexResultCallback_get_m_hitNormalWorld_0(self),btVector3)});ClosestConvexResultCallback.prototype["set_m_hitNormalWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_hitNormalWorld_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_hitPointWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestConvexResultCallback_get_m_hitPointWorld_0(self),btVector3)});ClosestConvexResultCallback.prototype["set_m_hitPointWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_hitPointWorld_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_collisionFilterGroup"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterGroup_0(self)});ClosestConvexResultCallback.prototype["set_m_collisionFilterGroup"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterGroup_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_collisionFilterMask"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestConvexResultCallback_get_m_collisionFilterMask_0(self)});ClosestConvexResultCallback.prototype["set_m_collisionFilterMask"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_collisionFilterMask_1(self,arg0)});ClosestConvexResultCallback.prototype["get_m_closestHitFraction"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestConvexResultCallback_get_m_closestHitFraction_0(self)});ClosestConvexResultCallback.prototype["set_m_closestHitFraction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestConvexResultCallback_set_m_closestHitFraction_1(self,arg0)});ClosestConvexResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_ClosestConvexResultCallback___destroy___0(self)});function btDefaultMotionState(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg0===undefined){this.ptr=_emscripten_bind_btDefaultMotionState_btDefaultMotionState_0();getCache(btDefaultMotionState)[this.ptr]=this;return}if(arg1===undefined){this.ptr=_emscripten_bind_btDefaultMotionState_btDefaultMotionState_1(arg0);getCache(btDefaultMotionState)[this.ptr]=this;return}this.ptr=_emscripten_bind_btDefaultMotionState_btDefaultMotionState_2(arg0,arg1);getCache(btDefaultMotionState)[this.ptr]=this}btDefaultMotionState.prototype=Object.create(btMotionState.prototype);btDefaultMotionState.prototype.constructor=btDefaultMotionState;btDefaultMotionState.prototype.__class__=btDefaultMotionState;btDefaultMotionState.__cache__={};Module["btDefaultMotionState"]=btDefaultMotionState;btDefaultMotionState.prototype["getWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDefaultMotionState_getWorldTransform_1(self,arg0)});btDefaultMotionState.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDefaultMotionState_setWorldTransform_1(self,arg0)});btDefaultMotionState.prototype["get_m_graphicsWorldTrans"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDefaultMotionState_get_m_graphicsWorldTrans_0(self),btTransform)});btDefaultMotionState.prototype["set_m_graphicsWorldTrans"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDefaultMotionState_set_m_graphicsWorldTrans_1(self,arg0)});btDefaultMotionState.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDefaultMotionState___destroy___0(self)});function btTriangleMeshShape(){throw"cannot construct a btTriangleMeshShape, no constructor in IDL"}btTriangleMeshShape.prototype=Object.create(btConcaveShape.prototype);btTriangleMeshShape.prototype.constructor=btTriangleMeshShape;btTriangleMeshShape.prototype.__class__=btTriangleMeshShape;btTriangleMeshShape.__cache__={};Module["btTriangleMeshShape"]=btTriangleMeshShape;btTriangleMeshShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btTriangleMeshShape_setLocalScaling_1(self,arg0)});btTriangleMeshShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btTriangleMeshShape_calculateLocalInertia_2(self,arg0,arg1)});btTriangleMeshShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btTriangleMeshShape___destroy___0(self)});function btDispatcher(){throw"cannot construct a btDispatcher, no constructor in IDL"}btDispatcher.prototype=Object.create(WrapperObject.prototype);btDispatcher.prototype.constructor=btDispatcher;btDispatcher.prototype.__class__=btDispatcher;btDispatcher.__cache__={};Module["btDispatcher"]=btDispatcher;btDispatcher.prototype["getNumManifolds"]=(function(){var self=this.ptr;return _emscripten_bind_btDispatcher_getNumManifolds_0(self)});btDispatcher.prototype["getManifoldByIndexInternal"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btDispatcher_getManifoldByIndexInternal_1(self,arg0),btPersistentManifold)});btDispatcher.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDispatcher___destroy___0(self)});function ClosestRayResultCallback(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_ClosestRayResultCallback_ClosestRayResultCallback_2(arg0,arg1);getCache(ClosestRayResultCallback)[this.ptr]=this}ClosestRayResultCallback.prototype=Object.create(RayResultCallback.prototype);ClosestRayResultCallback.prototype.constructor=ClosestRayResultCallback;ClosestRayResultCallback.prototype.__class__=ClosestRayResultCallback;ClosestRayResultCallback.__cache__={};Module["ClosestRayResultCallback"]=ClosestRayResultCallback;ClosestRayResultCallback.prototype["hasHit"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestRayResultCallback_hasHit_0(self)});ClosestRayResultCallback.prototype["get_m_rayFromWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestRayResultCallback_get_m_rayFromWorld_0(self),btVector3)});ClosestRayResultCallback.prototype["set_m_rayFromWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_rayFromWorld_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_rayToWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestRayResultCallback_get_m_rayToWorld_0(self),btVector3)});ClosestRayResultCallback.prototype["set_m_rayToWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_rayToWorld_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_hitNormalWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestRayResultCallback_get_m_hitNormalWorld_0(self),btVector3)});ClosestRayResultCallback.prototype["set_m_hitNormalWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_hitNormalWorld_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_hitPointWorld"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestRayResultCallback_get_m_hitPointWorld_0(self),btVector3)});ClosestRayResultCallback.prototype["set_m_hitPointWorld"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_hitPointWorld_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_collisionFilterGroup"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterGroup_0(self)});ClosestRayResultCallback.prototype["set_m_collisionFilterGroup"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterGroup_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_collisionFilterMask"]=(function(){var self=this.ptr;return _emscripten_bind_ClosestRayResultCallback_get_m_collisionFilterMask_0(self)});ClosestRayResultCallback.prototype["set_m_collisionFilterMask"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_collisionFilterMask_1(self,arg0)});ClosestRayResultCallback.prototype["get_m_collisionObject"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_ClosestRayResultCallback_get_m_collisionObject_0(self),btCollisionObject)});ClosestRayResultCallback.prototype["set_m_collisionObject"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_ClosestRayResultCallback_set_m_collisionObject_1(self,arg0)});ClosestRayResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_ClosestRayResultCallback___destroy___0(self)});function btDynamicsWorld(){throw"cannot construct a btDynamicsWorld, no constructor in IDL"}btDynamicsWorld.prototype=Object.create(btCollisionWorld.prototype);btDynamicsWorld.prototype.constructor=btDynamicsWorld;btDynamicsWorld.prototype.__class__=btDynamicsWorld;btDynamicsWorld.__cache__={};Module["btDynamicsWorld"]=btDynamicsWorld;btDynamicsWorld.prototype["addAction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btDynamicsWorld_addAction_1(self,arg0)});btDynamicsWorld.prototype["getDispatcher"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDynamicsWorld_getDispatcher_0(self),btDispatcher)});btDynamicsWorld.prototype["rayTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btDynamicsWorld_rayTest_3(self,arg0,arg1,arg2)});btDynamicsWorld.prototype["getPairCache"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDynamicsWorld_getPairCache_0(self),btOverlappingPairCache)});btDynamicsWorld.prototype["getDispatchInfo"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDynamicsWorld_getDispatchInfo_0(self),btDispatcherInfo)});btDynamicsWorld.prototype["addCollisionObject"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg1===undefined){_emscripten_bind_btDynamicsWorld_addCollisionObject_1(self,arg0);return}if(arg2===undefined){_emscripten_bind_btDynamicsWorld_addCollisionObject_2(self,arg0,arg1);return}_emscripten_bind_btDynamicsWorld_addCollisionObject_3(self,arg0,arg1,arg2)});btDynamicsWorld.prototype["getBroadphase"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btDynamicsWorld_getBroadphase_0(self),btBroadphaseInterface)});btDynamicsWorld.prototype["convexSweepTest"]=(function(arg0,arg1,arg2,arg3,arg4){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);_emscripten_bind_btDynamicsWorld_convexSweepTest_5(self,arg0,arg1,arg2,arg3,arg4)});btDynamicsWorld.prototype["contactPairTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btDynamicsWorld_contactPairTest_3(self,arg0,arg1,arg2)});btDynamicsWorld.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDynamicsWorld___destroy___0(self)});function btCapsuleShapeX(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btCapsuleShapeX_btCapsuleShapeX_2(arg0,arg1);getCache(btCapsuleShapeX)[this.ptr]=this}btCapsuleShapeX.prototype=Object.create(btCapsuleShape.prototype);btCapsuleShapeX.prototype.constructor=btCapsuleShapeX;btCapsuleShapeX.prototype.__class__=btCapsuleShapeX;btCapsuleShapeX.__cache__={};Module["btCapsuleShapeX"]=btCapsuleShapeX;btCapsuleShapeX.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCapsuleShapeX_setLocalScaling_1(self,arg0)});btCapsuleShapeX.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCapsuleShapeX_calculateLocalInertia_2(self,arg0,arg1)});btCapsuleShapeX.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCapsuleShapeX___destroy___0(self)});function btQuaternion(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);this.ptr=_emscripten_bind_btQuaternion_btQuaternion_4(arg0,arg1,arg2,arg3);getCache(btQuaternion)[this.ptr]=this}btQuaternion.prototype=Object.create(btQuadWord.prototype);btQuaternion.prototype.constructor=btQuaternion;btQuaternion.prototype.__class__=btQuaternion;btQuaternion.__cache__={};Module["btQuaternion"]=btQuaternion;btQuaternion.prototype["setValue"]=(function(arg0,arg1,arg2,arg3){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);_emscripten_bind_btQuaternion_setValue_4(self,arg0,arg1,arg2,arg3)});btQuaternion.prototype["x"]=(function(){var self=this.ptr;return _emscripten_bind_btQuaternion_x_0(self)});btQuaternion.prototype["y"]=(function(){var self=this.ptr;return _emscripten_bind_btQuaternion_y_0(self)});btQuaternion.prototype["z"]=(function(){var self=this.ptr;return _emscripten_bind_btQuaternion_z_0(self)});btQuaternion.prototype["w"]=(function(){var self=this.ptr;return _emscripten_bind_btQuaternion_w_0(self)});btQuaternion.prototype["setX"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuaternion_setX_1(self,arg0)});btQuaternion.prototype["setY"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuaternion_setY_1(self,arg0)});btQuaternion.prototype["setZ"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuaternion_setZ_1(self,arg0)});btQuaternion.prototype["setW"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuaternion_setW_1(self,arg0)});btQuaternion.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btQuaternion___destroy___0(self)});function btCapsuleShapeZ(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btCapsuleShapeZ_btCapsuleShapeZ_2(arg0,arg1);getCache(btCapsuleShapeZ)[this.ptr]=this}btCapsuleShapeZ.prototype=Object.create(btCapsuleShape.prototype);btCapsuleShapeZ.prototype.constructor=btCapsuleShapeZ;btCapsuleShapeZ.prototype.__class__=btCapsuleShapeZ;btCapsuleShapeZ.__cache__={};Module["btCapsuleShapeZ"]=btCapsuleShapeZ;btCapsuleShapeZ.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCapsuleShapeZ_setLocalScaling_1(self,arg0)});btCapsuleShapeZ.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCapsuleShapeZ_calculateLocalInertia_2(self,arg0,arg1)});btCapsuleShapeZ.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCapsuleShapeZ___destroy___0(self)});function btDefaultVehicleRaycaster(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btDefaultVehicleRaycaster_btDefaultVehicleRaycaster_1(arg0);getCache(btDefaultVehicleRaycaster)[this.ptr]=this}btDefaultVehicleRaycaster.prototype=Object.create(btVehicleRaycaster.prototype);btDefaultVehicleRaycaster.prototype.constructor=btDefaultVehicleRaycaster;btDefaultVehicleRaycaster.prototype.__class__=btDefaultVehicleRaycaster;btDefaultVehicleRaycaster.__cache__={};Module["btDefaultVehicleRaycaster"]=btDefaultVehicleRaycaster;btDefaultVehicleRaycaster.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDefaultVehicleRaycaster___destroy___0(self)});function RayResultCallback(){throw"cannot construct a RayResultCallback, no constructor in IDL"}RayResultCallback.prototype=Object.create(WrapperObject.prototype);RayResultCallback.prototype.constructor=RayResultCallback;RayResultCallback.prototype.__class__=RayResultCallback;RayResultCallback.__cache__={};Module["RayResultCallback"]=RayResultCallback;RayResultCallback.prototype["hasHit"]=(function(){var self=this.ptr;return _emscripten_bind_RayResultCallback_hasHit_0(self)});RayResultCallback.prototype["get_m_collisionFilterGroup"]=(function(){var self=this.ptr;return _emscripten_bind_RayResultCallback_get_m_collisionFilterGroup_0(self)});RayResultCallback.prototype["set_m_collisionFilterGroup"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_RayResultCallback_set_m_collisionFilterGroup_1(self,arg0)});RayResultCallback.prototype["get_m_collisionFilterMask"]=(function(){var self=this.ptr;return _emscripten_bind_RayResultCallback_get_m_collisionFilterMask_0(self)});RayResultCallback.prototype["set_m_collisionFilterMask"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_RayResultCallback_set_m_collisionFilterMask_1(self,arg0)});RayResultCallback.prototype["get_m_collisionObject"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_RayResultCallback_get_m_collisionObject_0(self),btCollisionObject)});RayResultCallback.prototype["set_m_collisionObject"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_RayResultCallback_set_m_collisionObject_1(self,arg0)});RayResultCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_RayResultCallback___destroy___0(self)});function btWheelInfo(){throw"cannot construct a btWheelInfo, no constructor in IDL"}btWheelInfo.prototype=Object.create(WrapperObject.prototype);btWheelInfo.prototype.constructor=btWheelInfo;btWheelInfo.prototype.__class__=btWheelInfo;btWheelInfo.__cache__={};Module["btWheelInfo"]=btWheelInfo;btWheelInfo.prototype["get_m_suspensionStiffness"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_suspensionStiffness_0(self)});btWheelInfo.prototype["set_m_suspensionStiffness"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_suspensionStiffness_1(self,arg0)});btWheelInfo.prototype["get_m_frictionSlip"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_frictionSlip_0(self)});btWheelInfo.prototype["set_m_frictionSlip"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_frictionSlip_1(self,arg0)});btWheelInfo.prototype["get_m_rollInfluence"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_rollInfluence_0(self)});btWheelInfo.prototype["set_m_rollInfluence"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_rollInfluence_1(self,arg0)});btWheelInfo.prototype["get_m_suspensionRestLength1"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_suspensionRestLength1_0(self)});btWheelInfo.prototype["set_m_suspensionRestLength1"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_suspensionRestLength1_1(self,arg0)});btWheelInfo.prototype["get_m_wheelsRadius"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_wheelsRadius_0(self)});btWheelInfo.prototype["set_m_wheelsRadius"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_wheelsRadius_1(self,arg0)});btWheelInfo.prototype["get_m_wheelsDampingCompression"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_wheelsDampingCompression_0(self)});btWheelInfo.prototype["set_m_wheelsDampingCompression"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_wheelsDampingCompression_1(self,arg0)});btWheelInfo.prototype["get_m_wheelsDampingRelaxation"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_wheelsDampingRelaxation_0(self)});btWheelInfo.prototype["set_m_wheelsDampingRelaxation"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_wheelsDampingRelaxation_1(self,arg0)});btWheelInfo.prototype["get_m_steering"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_steering_0(self)});btWheelInfo.prototype["set_m_steering"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_steering_1(self,arg0)});btWheelInfo.prototype["get_m_maxSuspensionForce"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_maxSuspensionForce_0(self)});btWheelInfo.prototype["set_m_maxSuspensionForce"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_maxSuspensionForce_1(self,arg0)});btWheelInfo.prototype["get_m_maxSuspensionTravelCm"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_maxSuspensionTravelCm_0(self)});btWheelInfo.prototype["set_m_maxSuspensionTravelCm"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_maxSuspensionTravelCm_1(self,arg0)});btWheelInfo.prototype["get_m_bIsFrontWheel"]=(function(){var self=this.ptr;return _emscripten_bind_btWheelInfo_get_m_bIsFrontWheel_0(self)});btWheelInfo.prototype["set_m_bIsFrontWheel"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btWheelInfo_set_m_bIsFrontWheel_1(self,arg0)});btWheelInfo.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btWheelInfo___destroy___0(self)});function btConcaveShape(){throw"cannot construct a btConcaveShape, no constructor in IDL"}btConcaveShape.prototype=Object.create(btCollisionShape.prototype);btConcaveShape.prototype.constructor=btConcaveShape;btConcaveShape.prototype.__class__=btConcaveShape;btConcaveShape.__cache__={};Module["btConcaveShape"]=btConcaveShape;btConcaveShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConcaveShape_setLocalScaling_1(self,arg0)});btConcaveShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btConcaveShape_calculateLocalInertia_2(self,arg0,arg1)});btConcaveShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConcaveShape___destroy___0(self)});function btVector4(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg0===undefined){this.ptr=_emscripten_bind_btVector4_btVector4_0();getCache(btVector4)[this.ptr]=this;return}if(arg1===undefined){this.ptr=_emscripten_bind_btVector4_btVector4_1(arg0);getCache(btVector4)[this.ptr]=this;return}if(arg2===undefined){this.ptr=_emscripten_bind_btVector4_btVector4_2(arg0,arg1);getCache(btVector4)[this.ptr]=this;return}if(arg3===undefined){this.ptr=_emscripten_bind_btVector4_btVector4_3(arg0,arg1,arg2);getCache(btVector4)[this.ptr]=this;return}this.ptr=_emscripten_bind_btVector4_btVector4_4(arg0,arg1,arg2,arg3);getCache(btVector4)[this.ptr]=this}btVector4.prototype=Object.create(btVector3.prototype);btVector4.prototype.constructor=btVector4;btVector4.prototype.__class__=btVector4;btVector4.__cache__={};Module["btVector4"]=btVector4;btVector4.prototype["w"]=(function(){var self=this.ptr;return _emscripten_bind_btVector4_w_0(self)});btVector4.prototype["setValue"]=(function(arg0,arg1,arg2,arg3){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);_emscripten_bind_btVector4_setValue_4(self,arg0,arg1,arg2,arg3)});btVector4.prototype["length"]=(function(){var self=this.ptr;return _emscripten_bind_btVector4_length_0(self)});btVector4.prototype["x"]=(function(){var self=this.ptr;return _emscripten_bind_btVector4_x_0(self)});btVector4.prototype["y"]=(function(){var self=this.ptr;return _emscripten_bind_btVector4_y_0(self)});btVector4.prototype["z"]=(function(){var self=this.ptr;return _emscripten_bind_btVector4_z_0(self)});btVector4.prototype["setX"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector4_setX_1(self,arg0)});btVector4.prototype["setY"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector4_setY_1(self,arg0)});btVector4.prototype["setZ"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector4_setZ_1(self,arg0)});btVector4.prototype["op_mul"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btVector4_op_mul_1(self,arg0),btVector3)});btVector4.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btVector4___destroy___0(self)});function btKinematicCharacterController(arg0,arg1,arg2,arg3){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg3===undefined){this.ptr=_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_3(arg0,arg1,arg2);getCache(btKinematicCharacterController)[this.ptr]=this;return}this.ptr=_emscripten_bind_btKinematicCharacterController_btKinematicCharacterController_4(arg0,arg1,arg2,arg3);getCache(btKinematicCharacterController)[this.ptr]=this}btKinematicCharacterController.prototype=Object.create(btActionInterface.prototype);btKinematicCharacterController.prototype.constructor=btKinematicCharacterController;btKinematicCharacterController.prototype.__class__=btKinematicCharacterController;btKinematicCharacterController.__cache__={};Module["btKinematicCharacterController"]=btKinematicCharacterController;btKinematicCharacterController.prototype["setUpAxis"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setUpAxis_1(self,arg0)});btKinematicCharacterController.prototype["setWalkDirection"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setWalkDirection_1(self,arg0)});btKinematicCharacterController.prototype["setVelocityForTimeInterval"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btKinematicCharacterController_setVelocityForTimeInterval_2(self,arg0,arg1)});btKinematicCharacterController.prototype["warp"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_warp_1(self,arg0)});btKinematicCharacterController.prototype["preStep"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_preStep_1(self,arg0)});btKinematicCharacterController.prototype["playerStep"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btKinematicCharacterController_playerStep_2(self,arg0,arg1)});btKinematicCharacterController.prototype["setFallSpeed"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setFallSpeed_1(self,arg0)});btKinematicCharacterController.prototype["setJumpSpeed"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setJumpSpeed_1(self,arg0)});btKinematicCharacterController.prototype["setMaxJumpHeight"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setMaxJumpHeight_1(self,arg0)});btKinematicCharacterController.prototype["canJump"]=(function(){var self=this.ptr;return _emscripten_bind_btKinematicCharacterController_canJump_0(self)});btKinematicCharacterController.prototype["jump"]=(function(){var self=this.ptr;_emscripten_bind_btKinematicCharacterController_jump_0(self)});btKinematicCharacterController.prototype["setGravity"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setGravity_1(self,arg0)});btKinematicCharacterController.prototype["getGravity"]=(function(){var self=this.ptr;return _emscripten_bind_btKinematicCharacterController_getGravity_0(self)});btKinematicCharacterController.prototype["setMaxSlope"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setMaxSlope_1(self,arg0)});btKinematicCharacterController.prototype["getMaxSlope"]=(function(){var self=this.ptr;return _emscripten_bind_btKinematicCharacterController_getMaxSlope_0(self)});btKinematicCharacterController.prototype["getGhostObject"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btKinematicCharacterController_getGhostObject_0(self),btPairCachingGhostObject)});btKinematicCharacterController.prototype["setUseGhostSweepTest"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btKinematicCharacterController_setUseGhostSweepTest_1(self,arg0)});btKinematicCharacterController.prototype["onGround"]=(function(){var self=this.ptr;return _emscripten_bind_btKinematicCharacterController_onGround_0(self)});btKinematicCharacterController.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btKinematicCharacterController___destroy___0(self)});function btStaticPlaneShape(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);this.ptr=_emscripten_bind_btStaticPlaneShape_btStaticPlaneShape_2(arg0,arg1);getCache(btStaticPlaneShape)[this.ptr]=this}btStaticPlaneShape.prototype=Object.create(btConcaveShape.prototype);btStaticPlaneShape.prototype.constructor=btStaticPlaneShape;btStaticPlaneShape.prototype.__class__=btStaticPlaneShape;btStaticPlaneShape.__cache__={};Module["btStaticPlaneShape"]=btStaticPlaneShape;btStaticPlaneShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btStaticPlaneShape_setLocalScaling_1(self,arg0)});btStaticPlaneShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btStaticPlaneShape_calculateLocalInertia_2(self,arg0,arg1)});btStaticPlaneShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btStaticPlaneShape___destroy___0(self)});function btActionInterface(){throw"cannot construct a btActionInterface, no constructor in IDL"}btActionInterface.prototype=Object.create(WrapperObject.prototype);btActionInterface.prototype.constructor=btActionInterface;btActionInterface.prototype.__class__=btActionInterface;btActionInterface.__cache__={};Module["btActionInterface"]=btActionInterface;btActionInterface.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btActionInterface___destroy___0(self)});function btOverlappingPairCache(){throw"cannot construct a btOverlappingPairCache, no constructor in IDL"}btOverlappingPairCache.prototype=Object.create(WrapperObject.prototype);btOverlappingPairCache.prototype.constructor=btOverlappingPairCache;btOverlappingPairCache.prototype.__class__=btOverlappingPairCache;btOverlappingPairCache.__cache__={};Module["btOverlappingPairCache"]=btOverlappingPairCache;btOverlappingPairCache.prototype["setInternalGhostPairCallback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btOverlappingPairCache_setInternalGhostPairCallback_1(self,arg0)});btOverlappingPairCache.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btOverlappingPairCache___destroy___0(self)});function btVector3(arg0,arg1,arg2){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg0===undefined){this.ptr=_emscripten_bind_btVector3_btVector3_0();getCache(btVector3)[this.ptr]=this;return}if(arg1===undefined){this.ptr=_emscripten_bind_btVector3_btVector3_1(arg0);getCache(btVector3)[this.ptr]=this;return}if(arg2===undefined){this.ptr=_emscripten_bind_btVector3_btVector3_2(arg0,arg1);getCache(btVector3)[this.ptr]=this;return}this.ptr=_emscripten_bind_btVector3_btVector3_3(arg0,arg1,arg2);getCache(btVector3)[this.ptr]=this}btVector3.prototype=Object.create(WrapperObject.prototype);btVector3.prototype.constructor=btVector3;btVector3.prototype.__class__=btVector3;btVector3.__cache__={};Module["btVector3"]=btVector3;btVector3.prototype["length"]=(function(){var self=this.ptr;return _emscripten_bind_btVector3_length_0(self)});btVector3.prototype["x"]=(function(){var self=this.ptr;return _emscripten_bind_btVector3_x_0(self)});btVector3.prototype["y"]=(function(){var self=this.ptr;return _emscripten_bind_btVector3_y_0(self)});btVector3.prototype["z"]=(function(){var self=this.ptr;return _emscripten_bind_btVector3_z_0(self)});btVector3.prototype["setX"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector3_setX_1(self,arg0)});btVector3.prototype["setY"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector3_setY_1(self,arg0)});btVector3.prototype["setZ"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btVector3_setZ_1(self,arg0)});btVector3.prototype["setValue"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btVector3_setValue_3(self,arg0,arg1,arg2)});btVector3.prototype["op_mul"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btVector3_op_mul_1(self,arg0),btVector3)});btVector3.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btVector3___destroy___0(self)});function btVehicleRaycaster(){throw"cannot construct a btVehicleRaycaster, no constructor in IDL"}btVehicleRaycaster.prototype=Object.create(WrapperObject.prototype);btVehicleRaycaster.prototype.constructor=btVehicleRaycaster;btVehicleRaycaster.prototype.__class__=btVehicleRaycaster;btVehicleRaycaster.__cache__={};Module["btVehicleRaycaster"]=btVehicleRaycaster;btVehicleRaycaster.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btVehicleRaycaster___destroy___0(self)});function btSphereShape(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btSphereShape_btSphereShape_1(arg0);getCache(btSphereShape)[this.ptr]=this}btSphereShape.prototype=Object.create(btCollisionShape.prototype);btSphereShape.prototype.constructor=btSphereShape;btSphereShape.prototype.__class__=btSphereShape;btSphereShape.__cache__={};Module["btSphereShape"]=btSphereShape;btSphereShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btSphereShape_setLocalScaling_1(self,arg0)});btSphereShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btSphereShape_calculateLocalInertia_2(self,arg0,arg1)});btSphereShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btSphereShape___destroy___0(self)});function btDefaultCollisionConstructionInfo(){this.ptr=_emscripten_bind_btDefaultCollisionConstructionInfo_btDefaultCollisionConstructionInfo_0();getCache(btDefaultCollisionConstructionInfo)[this.ptr]=this}btDefaultCollisionConstructionInfo.prototype=Object.create(WrapperObject.prototype);btDefaultCollisionConstructionInfo.prototype.constructor=btDefaultCollisionConstructionInfo;btDefaultCollisionConstructionInfo.prototype.__class__=btDefaultCollisionConstructionInfo;btDefaultCollisionConstructionInfo.__cache__={};Module["btDefaultCollisionConstructionInfo"]=btDefaultCollisionConstructionInfo;btDefaultCollisionConstructionInfo.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btDefaultCollisionConstructionInfo___destroy___0(self)});function btHingeConstraint(arg0,arg1,arg2,arg3,arg4,arg5,arg6){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg5&&typeof arg5==="object")arg5=arg5.ptr;else arg5=ensureString(arg5);if(arg6&&typeof arg6==="object")arg6=arg6.ptr;else arg6=ensureString(arg6);if(arg2===undefined){this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_2(arg0,arg1);getCache(btHingeConstraint)[this.ptr]=this;return}if(arg3===undefined){this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_3(arg0,arg1,arg2);getCache(btHingeConstraint)[this.ptr]=this;return}if(arg4===undefined){this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_4(arg0,arg1,arg2,arg3);getCache(btHingeConstraint)[this.ptr]=this;return}if(arg5===undefined){this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_5(arg0,arg1,arg2,arg3,arg4);getCache(btHingeConstraint)[this.ptr]=this;return}if(arg6===undefined){this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_6(arg0,arg1,arg2,arg3,arg4,arg5);getCache(btHingeConstraint)[this.ptr]=this;return}this.ptr=_emscripten_bind_btHingeConstraint_btHingeConstraint_7(arg0,arg1,arg2,arg3,arg4,arg5,arg6);getCache(btHingeConstraint)[this.ptr]=this}btHingeConstraint.prototype=Object.create(btTypedConstraint.prototype);btHingeConstraint.prototype.constructor=btHingeConstraint;btHingeConstraint.prototype.__class__=btHingeConstraint;btHingeConstraint.__cache__={};Module["btHingeConstraint"]=btHingeConstraint;btHingeConstraint.prototype["setLimit"]=(function(arg0,arg1,arg2,arg3,arg4){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg4===undefined){_emscripten_bind_btHingeConstraint_setLimit_4(self,arg0,arg1,arg2,arg3);return}_emscripten_bind_btHingeConstraint_setLimit_5(self,arg0,arg1,arg2,arg3,arg4)});btHingeConstraint.prototype["enableFeedback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btHingeConstraint_enableFeedback_1(self,arg0)});btHingeConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btHingeConstraint___destroy___0(self)});function btCollisionShape(){throw"cannot construct a btCollisionShape, no constructor in IDL"}btCollisionShape.prototype=Object.create(WrapperObject.prototype);btCollisionShape.prototype.constructor=btCollisionShape;btCollisionShape.prototype.__class__=btCollisionShape;btCollisionShape.__cache__={};Module["btCollisionShape"]=btCollisionShape;btCollisionShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCollisionShape_setLocalScaling_1(self,arg0)});btCollisionShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCollisionShape_calculateLocalInertia_2(self,arg0,arg1)});btCollisionShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCollisionShape___destroy___0(self)});function btConstraintSetting(){this.ptr=_emscripten_bind_btConstraintSetting_btConstraintSetting_0();getCache(btConstraintSetting)[this.ptr]=this}btConstraintSetting.prototype=Object.create(WrapperObject.prototype);btConstraintSetting.prototype.constructor=btConstraintSetting;btConstraintSetting.prototype.__class__=btConstraintSetting;btConstraintSetting.__cache__={};Module["btConstraintSetting"]=btConstraintSetting;btConstraintSetting.prototype["get_m_tau"]=(function(){var self=this.ptr;return _emscripten_bind_btConstraintSetting_get_m_tau_0(self)});btConstraintSetting.prototype["set_m_tau"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConstraintSetting_set_m_tau_1(self,arg0)});btConstraintSetting.prototype["get_m_damping"]=(function(){var self=this.ptr;return _emscripten_bind_btConstraintSetting_get_m_damping_0(self)});btConstraintSetting.prototype["set_m_damping"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConstraintSetting_set_m_damping_1(self,arg0)});btConstraintSetting.prototype["get_m_impulseClamp"]=(function(){var self=this.ptr;return _emscripten_bind_btConstraintSetting_get_m_impulseClamp_0(self)});btConstraintSetting.prototype["set_m_impulseClamp"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btConstraintSetting_set_m_impulseClamp_1(self,arg0)});btConstraintSetting.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConstraintSetting___destroy___0(self)});function btGhostObject(){this.ptr=_emscripten_bind_btGhostObject_btGhostObject_0();getCache(btGhostObject)[this.ptr]=this}btGhostObject.prototype=Object.create(btCollisionObject.prototype);btGhostObject.prototype.constructor=btGhostObject;btGhostObject.prototype.__class__=btGhostObject;btGhostObject.__cache__={};Module["btGhostObject"]=btGhostObject;btGhostObject.prototype["getNumOverlappingObjects"]=(function(){var self=this.ptr;return _emscripten_bind_btGhostObject_getNumOverlappingObjects_0(self)});btGhostObject.prototype["getOverlappingObject"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btGhostObject_getOverlappingObject_1(self,arg0),btCollisionObject)});btGhostObject.prototype["getCollisionShape"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btGhostObject_getCollisionShape_0(self),btCollisionShape)});btGhostObject.prototype["setContactProcessingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setContactProcessingThreshold_1(self,arg0)});btGhostObject.prototype["setActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setActivationState_1(self,arg0)});btGhostObject.prototype["forceActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_forceActivationState_1(self,arg0)});btGhostObject.prototype["activate"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){_emscripten_bind_btGhostObject_activate_0(self);return}_emscripten_bind_btGhostObject_activate_1(self,arg0)});btGhostObject.prototype["isActive"]=(function(){var self=this.ptr;return _emscripten_bind_btGhostObject_isActive_0(self)});btGhostObject.prototype["isKinematicObject"]=(function(){var self=this.ptr;return _emscripten_bind_btGhostObject_isKinematicObject_0(self)});btGhostObject.prototype["setRestitution"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setRestitution_1(self,arg0)});btGhostObject.prototype["setFriction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setFriction_1(self,arg0)});btGhostObject.prototype["getWorldTransform"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btGhostObject_getWorldTransform_0(self),btTransform)});btGhostObject.prototype["getCollisionFlags"]=(function(){var self=this.ptr;return _emscripten_bind_btGhostObject_getCollisionFlags_0(self)});btGhostObject.prototype["setCollisionFlags"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setCollisionFlags_1(self,arg0)});btGhostObject.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setWorldTransform_1(self,arg0)});btGhostObject.prototype["setCollisionShape"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setCollisionShape_1(self,arg0)});btGhostObject.prototype["setCcdMotionThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setCcdMotionThreshold_1(self,arg0)});btGhostObject.prototype["setCcdSweptSphereRadius"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btGhostObject_setCcdSweptSphereRadius_1(self,arg0)});btGhostObject.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btGhostObject___destroy___0(self)});function LocalShapeInfo(){throw"cannot construct a LocalShapeInfo, no constructor in IDL"}LocalShapeInfo.prototype=Object.create(WrapperObject.prototype);LocalShapeInfo.prototype.constructor=LocalShapeInfo;LocalShapeInfo.prototype.__class__=LocalShapeInfo;LocalShapeInfo.__cache__={};Module["LocalShapeInfo"]=LocalShapeInfo;LocalShapeInfo.prototype["get_m_shapePart"]=(function(){var self=this.ptr;return _emscripten_bind_LocalShapeInfo_get_m_shapePart_0(self)});LocalShapeInfo.prototype["set_m_shapePart"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalShapeInfo_set_m_shapePart_1(self,arg0)});LocalShapeInfo.prototype["get_m_triangleIndex"]=(function(){var self=this.ptr;return _emscripten_bind_LocalShapeInfo_get_m_triangleIndex_0(self)});LocalShapeInfo.prototype["set_m_triangleIndex"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalShapeInfo_set_m_triangleIndex_1(self,arg0)});LocalShapeInfo.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_LocalShapeInfo___destroy___0(self)});function btConstraintSolver(){throw"cannot construct a btConstraintSolver, no constructor in IDL"}btConstraintSolver.prototype=Object.create(WrapperObject.prototype);btConstraintSolver.prototype.constructor=btConstraintSolver;btConstraintSolver.prototype.__class__=btConstraintSolver;btConstraintSolver.__cache__={};Module["btConstraintSolver"]=btConstraintSolver;btConstraintSolver.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btConstraintSolver___destroy___0(self)});function btRaycastVehicle(arg0,arg1,arg2){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);this.ptr=_emscripten_bind_btRaycastVehicle_btRaycastVehicle_3(arg0,arg1,arg2);getCache(btRaycastVehicle)[this.ptr]=this}btRaycastVehicle.prototype=Object.create(btActionInterface.prototype);btRaycastVehicle.prototype.constructor=btRaycastVehicle;btRaycastVehicle.prototype.__class__=btRaycastVehicle;btRaycastVehicle.__cache__={};Module["btRaycastVehicle"]=btRaycastVehicle;btRaycastVehicle.prototype["applyEngineForce"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRaycastVehicle_applyEngineForce_2(self,arg0,arg1)});btRaycastVehicle.prototype["setSteeringValue"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRaycastVehicle_setSteeringValue_2(self,arg0,arg1)});btRaycastVehicle.prototype["getWheelTransformWS"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btRaycastVehicle_getWheelTransformWS_1(self,arg0),btTransform)});btRaycastVehicle.prototype["updateWheelTransform"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRaycastVehicle_updateWheelTransform_2(self,arg0,arg1)});btRaycastVehicle.prototype["addWheel"]=(function(arg0,arg1,arg2,arg3,arg4,arg5,arg6){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);if(arg5&&typeof arg5==="object")arg5=arg5.ptr;else arg5=ensureString(arg5);if(arg6&&typeof arg6==="object")arg6=arg6.ptr;else arg6=ensureString(arg6);return wrapPointer(_emscripten_bind_btRaycastVehicle_addWheel_7(self,arg0,arg1,arg2,arg3,arg4,arg5,arg6),btWheelInfo)});btRaycastVehicle.prototype["getNumWheels"]=(function(){var self=this.ptr;return _emscripten_bind_btRaycastVehicle_getNumWheels_0(self)});btRaycastVehicle.prototype["getRigidBody"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRaycastVehicle_getRigidBody_0(self),btRigidBody)});btRaycastVehicle.prototype["getWheelInfo"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btRaycastVehicle_getWheelInfo_1(self,arg0),btWheelInfo)});btRaycastVehicle.prototype["setBrake"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRaycastVehicle_setBrake_2(self,arg0,arg1)});btRaycastVehicle.prototype["setCoordinateSystem"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btRaycastVehicle_setCoordinateSystem_3(self,arg0,arg1,arg2)});btRaycastVehicle.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btRaycastVehicle___destroy___0(self)});function LocalConvexResult(arg0,arg1,arg2,arg3,arg4){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);this.ptr=_emscripten_bind_LocalConvexResult_LocalConvexResult_5(arg0,arg1,arg2,arg3,arg4);getCache(LocalConvexResult)[this.ptr]=this}LocalConvexResult.prototype=Object.create(WrapperObject.prototype);LocalConvexResult.prototype.constructor=LocalConvexResult;LocalConvexResult.prototype.__class__=LocalConvexResult;LocalConvexResult.__cache__={};Module["LocalConvexResult"]=LocalConvexResult;LocalConvexResult.prototype["get_m_hitCollisionObject"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_LocalConvexResult_get_m_hitCollisionObject_0(self),btCollisionObject)});LocalConvexResult.prototype["set_m_hitCollisionObject"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalConvexResult_set_m_hitCollisionObject_1(self,arg0)});LocalConvexResult.prototype["get_m_localShapeInfo"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_LocalConvexResult_get_m_localShapeInfo_0(self),LocalShapeInfo)});LocalConvexResult.prototype["set_m_localShapeInfo"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalConvexResult_set_m_localShapeInfo_1(self,arg0)});LocalConvexResult.prototype["get_m_hitNormalLocal"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_LocalConvexResult_get_m_hitNormalLocal_0(self),btVector3)});LocalConvexResult.prototype["set_m_hitNormalLocal"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalConvexResult_set_m_hitNormalLocal_1(self,arg0)});LocalConvexResult.prototype["get_m_hitPointLocal"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_LocalConvexResult_get_m_hitPointLocal_0(self),btVector3)});LocalConvexResult.prototype["set_m_hitPointLocal"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalConvexResult_set_m_hitPointLocal_1(self,arg0)});LocalConvexResult.prototype["get_m_hitFraction"]=(function(){var self=this.ptr;return _emscripten_bind_LocalConvexResult_get_m_hitFraction_0(self)});LocalConvexResult.prototype["set_m_hitFraction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_LocalConvexResult_set_m_hitFraction_1(self,arg0)});LocalConvexResult.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_LocalConvexResult___destroy___0(self)});function btOverlappingPairCallback(){throw"cannot construct a btOverlappingPairCallback, no constructor in IDL"}btOverlappingPairCallback.prototype=Object.create(WrapperObject.prototype);btOverlappingPairCallback.prototype.constructor=btOverlappingPairCallback;btOverlappingPairCallback.prototype.__class__=btOverlappingPairCallback;btOverlappingPairCallback.__cache__={};Module["btOverlappingPairCallback"]=btOverlappingPairCallback;btOverlappingPairCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btOverlappingPairCallback___destroy___0(self)});function btRigidBody(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btRigidBody_btRigidBody_1(arg0);getCache(btRigidBody)[this.ptr]=this}btRigidBody.prototype=Object.create(btCollisionObject.prototype);btRigidBody.prototype.constructor=btRigidBody;btRigidBody.prototype.__class__=btRigidBody;btRigidBody.__cache__={};Module["btRigidBody"]=btRigidBody;btRigidBody.prototype["getCenterOfMassTransform"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getCenterOfMassTransform_0(self),btTransform)});btRigidBody.prototype["setCenterOfMassTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setCenterOfMassTransform_1(self,arg0)});btRigidBody.prototype["setSleepingThresholds"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRigidBody_setSleepingThresholds_2(self,arg0,arg1)});btRigidBody.prototype["setDamping"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRigidBody_setDamping_2(self,arg0,arg1)});btRigidBody.prototype["setMassProps"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRigidBody_setMassProps_2(self,arg0,arg1)});btRigidBody.prototype["setLinearFactor"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setLinearFactor_1(self,arg0)});btRigidBody.prototype["applyTorque"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_applyTorque_1(self,arg0)});btRigidBody.prototype["applyForce"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRigidBody_applyForce_2(self,arg0,arg1)});btRigidBody.prototype["applyCentralForce"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_applyCentralForce_1(self,arg0)});btRigidBody.prototype["applyTorqueImpulse"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_applyTorqueImpulse_1(self,arg0)});btRigidBody.prototype["applyImpulse"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btRigidBody_applyImpulse_2(self,arg0,arg1)});btRigidBody.prototype["applyCentralImpulse"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_applyCentralImpulse_1(self,arg0)});btRigidBody.prototype["updateInertiaTensor"]=(function(){var self=this.ptr;_emscripten_bind_btRigidBody_updateInertiaTensor_0(self)});btRigidBody.prototype["getLinearVelocity"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getLinearVelocity_0(self),btVector3)});btRigidBody.prototype["getAngularVelocity"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getAngularVelocity_0(self),btVector3)});btRigidBody.prototype["setLinearVelocity"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setLinearVelocity_1(self,arg0)});btRigidBody.prototype["setAngularVelocity"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setAngularVelocity_1(self,arg0)});btRigidBody.prototype["getMotionState"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getMotionState_0(self),btMotionState)});btRigidBody.prototype["setAngularFactor"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setAngularFactor_1(self,arg0)});btRigidBody.prototype["upcast"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);return wrapPointer(_emscripten_bind_btRigidBody_upcast_1(self,arg0),btRigidBody)});btRigidBody.prototype["getCollisionShape"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getCollisionShape_0(self),btCollisionShape)});btRigidBody.prototype["setContactProcessingThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setContactProcessingThreshold_1(self,arg0)});btRigidBody.prototype["setActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setActivationState_1(self,arg0)});btRigidBody.prototype["forceActivationState"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_forceActivationState_1(self,arg0)});btRigidBody.prototype["activate"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg0===undefined){_emscripten_bind_btRigidBody_activate_0(self);return}_emscripten_bind_btRigidBody_activate_1(self,arg0)});btRigidBody.prototype["isActive"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBody_isActive_0(self)});btRigidBody.prototype["isKinematicObject"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBody_isKinematicObject_0(self)});btRigidBody.prototype["setRestitution"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setRestitution_1(self,arg0)});btRigidBody.prototype["setFriction"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setFriction_1(self,arg0)});btRigidBody.prototype["getWorldTransform"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btRigidBody_getWorldTransform_0(self),btTransform)});btRigidBody.prototype["getCollisionFlags"]=(function(){var self=this.ptr;return _emscripten_bind_btRigidBody_getCollisionFlags_0(self)});btRigidBody.prototype["setCollisionFlags"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setCollisionFlags_1(self,arg0)});btRigidBody.prototype["setWorldTransform"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setWorldTransform_1(self,arg0)});btRigidBody.prototype["setCollisionShape"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setCollisionShape_1(self,arg0)});btRigidBody.prototype["setCcdMotionThreshold"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setCcdMotionThreshold_1(self,arg0)});btRigidBody.prototype["setCcdSweptSphereRadius"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btRigidBody_setCcdSweptSphereRadius_1(self,arg0)});btRigidBody.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btRigidBody___destroy___0(self)});function btCylinderShapeX(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btCylinderShapeX_btCylinderShapeX_1(arg0);getCache(btCylinderShapeX)[this.ptr]=this}btCylinderShapeX.prototype=Object.create(btCylinderShape.prototype);btCylinderShapeX.prototype.constructor=btCylinderShapeX;btCylinderShapeX.prototype.__class__=btCylinderShapeX;btCylinderShapeX.__cache__={};Module["btCylinderShapeX"]=btCylinderShapeX;btCylinderShapeX.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCylinderShapeX_setLocalScaling_1(self,arg0)});btCylinderShapeX.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCylinderShapeX_calculateLocalInertia_2(self,arg0,arg1)});btCylinderShapeX.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCylinderShapeX___destroy___0(self)});function btCylinderShapeZ(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btCylinderShapeZ_btCylinderShapeZ_1(arg0);getCache(btCylinderShapeZ)[this.ptr]=this}btCylinderShapeZ.prototype=Object.create(btCylinderShape.prototype);btCylinderShapeZ.prototype.constructor=btCylinderShapeZ;btCylinderShapeZ.prototype.__class__=btCylinderShapeZ;btCylinderShapeZ.__cache__={};Module["btCylinderShapeZ"]=btCylinderShapeZ;btCylinderShapeZ.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCylinderShapeZ_setLocalScaling_1(self,arg0)});btCylinderShapeZ.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCylinderShapeZ_calculateLocalInertia_2(self,arg0,arg1)});btCylinderShapeZ.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCylinderShapeZ___destroy___0(self)});function btTransform(arg0,arg1){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg0===undefined){this.ptr=_emscripten_bind_btTransform_btTransform_0();getCache(btTransform)[this.ptr]=this;return}if(arg1===undefined){this.ptr=_emscripten_bind_btTransform_btTransform_1(arg0);getCache(btTransform)[this.ptr]=this;return}this.ptr=_emscripten_bind_btTransform_btTransform_2(arg0,arg1);getCache(btTransform)[this.ptr]=this}btTransform.prototype=Object.create(WrapperObject.prototype);btTransform.prototype.constructor=btTransform;btTransform.prototype.__class__=btTransform;btTransform.__cache__={};Module["btTransform"]=btTransform;btTransform.prototype["setIdentity"]=(function(){var self=this.ptr;_emscripten_bind_btTransform_setIdentity_0(self)});btTransform.prototype["setOrigin"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btTransform_setOrigin_1(self,arg0)});btTransform.prototype["setRotation"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btTransform_setRotation_1(self,arg0)});btTransform.prototype["getOrigin"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btTransform_getOrigin_0(self),btVector3)});btTransform.prototype["getRotation"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btTransform_getRotation_0(self),btQuaternion)});btTransform.prototype["getBasis"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btTransform_getBasis_0(self),btMatrix3x3)});btTransform.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btTransform___destroy___0(self)});function btCollisionWorld(){throw"cannot construct a btCollisionWorld, no constructor in IDL"}btCollisionWorld.prototype=Object.create(WrapperObject.prototype);btCollisionWorld.prototype.constructor=btCollisionWorld;btCollisionWorld.prototype.__class__=btCollisionWorld;btCollisionWorld.__cache__={};Module["btCollisionWorld"]=btCollisionWorld;btCollisionWorld.prototype["getDispatcher"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionWorld_getDispatcher_0(self),btDispatcher)});btCollisionWorld.prototype["rayTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btCollisionWorld_rayTest_3(self,arg0,arg1,arg2)});btCollisionWorld.prototype["getPairCache"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionWorld_getPairCache_0(self),btOverlappingPairCache)});btCollisionWorld.prototype["getDispatchInfo"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionWorld_getDispatchInfo_0(self),btDispatcherInfo)});btCollisionWorld.prototype["addCollisionObject"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg1===undefined){_emscripten_bind_btCollisionWorld_addCollisionObject_1(self,arg0);return}if(arg2===undefined){_emscripten_bind_btCollisionWorld_addCollisionObject_2(self,arg0,arg1);return}_emscripten_bind_btCollisionWorld_addCollisionObject_3(self,arg0,arg1,arg2)});btCollisionWorld.prototype["getBroadphase"]=(function(){var self=this.ptr;return wrapPointer(_emscripten_bind_btCollisionWorld_getBroadphase_0(self),btBroadphaseInterface)});btCollisionWorld.prototype["convexSweepTest"]=(function(arg0,arg1,arg2,arg3,arg4){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);if(arg3&&typeof arg3==="object")arg3=arg3.ptr;else arg3=ensureString(arg3);if(arg4&&typeof arg4==="object")arg4=arg4.ptr;else arg4=ensureString(arg4);_emscripten_bind_btCollisionWorld_convexSweepTest_5(self,arg0,arg1,arg2,arg3,arg4)});btCollisionWorld.prototype["contactPairTest"]=(function(arg0,arg1,arg2){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);if(arg2&&typeof arg2==="object")arg2=arg2.ptr;else arg2=ensureString(arg2);_emscripten_bind_btCollisionWorld_contactPairTest_3(self,arg0,arg1,arg2)});btCollisionWorld.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCollisionWorld___destroy___0(self)});function btQuadWord(){throw"cannot construct a btQuadWord, no constructor in IDL"}btQuadWord.prototype=Object.create(WrapperObject.prototype);btQuadWord.prototype.constructor=btQuadWord;btQuadWord.prototype.__class__=btQuadWord;btQuadWord.__cache__={};Module["btQuadWord"]=btQuadWord;btQuadWord.prototype["x"]=(function(){var self=this.ptr;return _emscripten_bind_btQuadWord_x_0(self)});btQuadWord.prototype["y"]=(function(){var self=this.ptr;return _emscripten_bind_btQuadWord_y_0(self)});btQuadWord.prototype["z"]=(function(){var self=this.ptr;return _emscripten_bind_btQuadWord_z_0(self)});btQuadWord.prototype["w"]=(function(){var self=this.ptr;return _emscripten_bind_btQuadWord_w_0(self)});btQuadWord.prototype["setX"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuadWord_setX_1(self,arg0)});btQuadWord.prototype["setY"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuadWord_setY_1(self,arg0)});btQuadWord.prototype["setZ"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuadWord_setZ_1(self,arg0)});btQuadWord.prototype["setW"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btQuadWord_setW_1(self,arg0)});btQuadWord.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btQuadWord___destroy___0(self)});function btCylinderShape(arg0){if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);this.ptr=_emscripten_bind_btCylinderShape_btCylinderShape_1(arg0);getCache(btCylinderShape)[this.ptr]=this}btCylinderShape.prototype=Object.create(btCollisionShape.prototype);btCylinderShape.prototype.constructor=btCylinderShape;btCylinderShape.prototype.__class__=btCylinderShape;btCylinderShape.__cache__={};Module["btCylinderShape"]=btCylinderShape;btCylinderShape.prototype["setLocalScaling"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btCylinderShape_setLocalScaling_1(self,arg0)});btCylinderShape.prototype["calculateLocalInertia"]=(function(arg0,arg1){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);if(arg1&&typeof arg1==="object")arg1=arg1.ptr;else arg1=ensureString(arg1);_emscripten_bind_btCylinderShape_calculateLocalInertia_2(self,arg0,arg1)});btCylinderShape.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btCylinderShape___destroy___0(self)});function btGhostPairCallback(){this.ptr=_emscripten_bind_btGhostPairCallback_btGhostPairCallback_0();getCache(btGhostPairCallback)[this.ptr]=this}btGhostPairCallback.prototype=Object.create(WrapperObject.prototype);btGhostPairCallback.prototype.constructor=btGhostPairCallback;btGhostPairCallback.prototype.__class__=btGhostPairCallback;btGhostPairCallback.__cache__={};Module["btGhostPairCallback"]=btGhostPairCallback;btGhostPairCallback.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btGhostPairCallback___destroy___0(self)});function btTypedConstraint(){throw"cannot construct a btTypedConstraint, no constructor in IDL"}btTypedConstraint.prototype=Object.create(WrapperObject.prototype);btTypedConstraint.prototype.constructor=btTypedConstraint;btTypedConstraint.prototype.__class__=btTypedConstraint;btTypedConstraint.__cache__={};Module["btTypedConstraint"]=btTypedConstraint;btTypedConstraint.prototype["enableFeedback"]=(function(arg0){var self=this.ptr;if(arg0&&typeof arg0==="object")arg0=arg0.ptr;else arg0=ensureString(arg0);_emscripten_bind_btTypedConstraint_enableFeedback_1(self,arg0)});btTypedConstraint.prototype["__destroy__"]=(function(){var self=this.ptr;_emscripten_bind_btTypedConstraint___destroy___0(self)});this["Ammo"]=Module






  return this;
}).call({});
// Create a PlayCanvas application
var canvas = document.getElementById("application-canvas");
canvas.focus();

var app = new pc.fw.Application(canvas, {
    mouse: new pc.input.Mouse(canvas),
    keyboard: new pc.input.Keyboard(canvas),
    touch: new pc.input.TouchDevice(canvas)
});

app.context.loader._handlers['texture'].crossOrigin = 'anonymous';
app.context.loader._handlers['model'].crossOrigin = 'anonymous';

app.start();

// Fill the available space at full resolution
app.setCanvasFillMode(pc.fw.FillMode.FILL_WINDOW);
app.setCanvasResolution(pc.fw.ResolutionMode.AUTO);

//Prepare global variables for Entities
var tank,
    base,
    gun,
    gameOver,
    congrats,
    store,
    store_listing,
    //    stats,
    health,
    score,
    highscore,
    floor,
    skybox,
    light,
    store_light,
    cam,
    spawner,
    activeBullet,
    store_bullet_green,
    store_bullet_pink;

var EnemyTypes = {
    Red: RedEnemy,
    Yellow: YellowEnemy
}

var BulletTypes = [
    GreenBullet,
    PinkBullet
]

BulletTypes.DefaultBullet = GreenBullet;
BulletTypes.DefaultBullet.prototype.ammo = 999;
//GreenBullet.ammo = 999;
//PinkBullet.ammo = 0;

// load all textures
var textures = [
    //    "assets/skybox/posy.png",
    //    "assets/skybox/negy.png",
    //    "assets/skybox/negx.png",
    //    "assets/skybox/posx.png",
    //    "assets/skybox/posz.png",
    //    "assets/skybox/negz.png",
    "assets/Hex_Plating.png",
    "assets/clouds.jpg",
    "assets/red.png",
    "assets/green.png",
    "assets/yellow.png",
    "assets/pink.png",
    "assets/fonts/boombox_72.png",
    "assets/tank/tank_icon.png",
    "assets/menu/shoot-icon.png",
    "assets/menu/move-icon.png"
    //    "assets/fonts/boombox_144.png"
];

var materials = [
    "assets/yellow.png",
];

var assets_json = [
    "assets/fonts/boombox.json",
    //    "assets/fonts/boombox_144.json"
];

var models = [
    "assets/tank/Tank_base.json",
    "assets/tank/Tank_gun_turret.json"
];

var promises = [];

for (var i = 0; i < textures.length; i++)
    promises.push(app.context.assets.loadFromUrl(textures[i], "texture"));

for (var i = 0; i < assets_json.length; i++)
    promises.push(app.context.assets.loadFromUrl(assets_json[i], "json"));

for (var i = 0; i < models.length; i++)
    promises.push(app.context.assets.loadFromUrl(models[i], "model"));

//for (var i = 0; i < materials.length; i++)
//    promises.push(app.context.assets.loadFromUrl(materials[i], "material"));


// check for all assets to load then create skybox
pc.promise.all(promises).then(function (results) {

    app.context.systems.rigidbody.setGravity(0, -10, 0);
    app.scene.ambientLight = new pc.Color(0.35, 0.35, 0.35);

    // Create camera entity
    cam = new pc.fw.Entity();
    cam.setName('cam');
    cam.addComponent('camera', {
        clearColor: [0.3, 0.3, 0.3]
    });

    cam.setLocalPosition(0, 1.5, -3.5);
    cam.rotateLocal(-20, 180, 0);

    // Create light entities
    light = new pc.fw.Entity();
    light.setName('light');
    light.translate(0, 2, 0);
    light.addComponent('light', {
        type: 'point',
        color: new pc.Color(0.5, 0.5, 1),
        range: 30,
        intensity: 2,
        castShadows: true
    });

    store_light = new pc.Entity();
    store_light.setName('store_light');
    store_light.setPosition(0, 1, 0);
    store_light.addComponent('light', {
        type: 'directional',
        color: light.light.color,
        intensity: 1,
        castShadows: true
    });
    store_light.enabled = false;


    //    //Create a skybox entity
    //    skybox = new pc.fw.Entity();
    //    skybox.setName('skybox');
    //
    //    skybox.addComponent('skybox', {
    //        enabled: true,
    //        posy: results[0].asset.id,
    //        negy: results[0].asset.id,
    //        negx: results[0].asset.id,
    //        posx: results[0].asset.id,
    //        posz: results[0].asset.id,
    //        negz: results[0].asset.id
    //    });

    //Create a representation of the active bullet
    activeBullet = new GreenBullet(pc.Vec3.ZERO, new pc.Vec3(-0.45, 0.95, -3));
    activeBullet.setName('activeBullet');
    activeBullet.removeComponent('collision');
    activeBullet.displayOnly = true;
    activeBullet.addChild(buildText(activeBullet.ammo.toString(), -132, 300));
    activeBullet.enabled = false;

    store_bullet_green = new GreenBullet(pc.Vec3.ZERO, new pc.Vec3(0, 1, -0.8));
    store_bullet_green.setName('store_bullet_green');
    store_bullet_green.removeComponent('collision');
    store_bullet_green.displayOnly = true;
    store_bullet_green.addChild(buildText("$", 0, 75));

    store_bullet_pink = new PinkBullet(pc.Vec3.ZERO, new pc.Vec3(0, 1, 0.7));
    store_bullet_pink.setName('store_bullet_pink');
    store_bullet_pink.removeComponent('collision');
    store_bullet_pink.displayOnly = true;
    store_bullet_pink.addChild(buildText("$", 0, -210));

    store_listing = new pc.Entity();
    store_listing.setName('store_listing');
    store_listing.enabled = false;

    // Create tank entity
    tank = new pc.fw.Entity();
    tank.setName('tank');
    tank.rotate(0, 180, 0);

    tank.addComponent('rigidbody', {
        type: 'static'
    });

    tank.addComponent('collision', {
        type: 'box',
        halfExtents: tank.getLocalScale().clone().scale(0.5)
    });

    var tankScript = {
        name: 'tank',
        url: 'scripts/tank.js'
    };

    base = new pc.fw.Entity();
    base.setName('base');

    gun = new pc.fw.Entity();
    gun.setName('gun');
    gun.translateLocal(0, 0.55, 0);

    base.addComponent('model', {
        type: "asset",
        asset: app.assets.find('Tank_base'),
        castShadows: true,
        receiveShadows: true,
        enabled: false
    });

    gun.addComponent('model', {
        type: "asset",
        asset: app.assets.find('Tank_gun_turret'),
        castShadows: true,
        receiveShadows: true,
        enabled: false
    });

    var lookScript = {
        name: 'look',
        url: 'scripts/look.js'
    }

    var shootScript = {
        name: 'shoot',
        url: 'scripts/shoot.js'
    }

    var burnScript = {
        name: 'burn',
        url: 'scripts/burn.js',
        attributes: [{
            name: 'maps',
            type: 'string',
            value: 'clouds.jpg'
            }]
    };

    gun.addComponent('script', {
        enabled: true,
        scripts: [lookScript, shootScript, burnScript]
    });

    var moveScript = {
        name: 'move',
        url: 'scripts/move.js'
    }

    tank.addComponent('script', {
        enabled: true,
        scripts: [tankScript]
            //        scripts: [moveScript, tankScript]
    });

    base.addComponent('script', {
        enabled: true,
        scripts: [burnScript]
    });

    //    gun.dead = true;
    //    base.dead = true;


    //    tank.script.tank.die();

    //Create a floor
    floor = new pc.fw.Entity();
    floor.setName('floor');

    floor.setLocalScale(100, 1, 100);

    floor.addComponent('model', {
        type: "box",
        castShadows: true,
        receiveShadows: true
    });
    var floorMaterial = new pc.scene.PhongMaterial();
    floorMaterial.diffuseMap = results[0].resource[0];
    floorMaterial.diffuseMapTiling = pc.Vec2.ONE.clone().scale(10); //(1, 10);
    floorMaterial.update();
    floor.model.model.meshInstances[0].material = floorMaterial;

    floor.addComponent('rigidbody', {
        type: 'static'
    });

    floor.addComponent('collision', {
        type: 'box',
        halfExtents: floor.getLocalScale().clone().scale(0.5)
    });

    floor.translate(0, -0.5, 0);
    floor.rigidbody.syncEntityToBody();

    var wall = floor.clone();
    wall.removeComponent('rigidbody');
    wall.removeComponent('collision');
    wall.setName('wall');
    //    wall.rotate(0, 0, 90);

    wall.setLocalScale(1, 60, 60);
    wall.setLocalPosition(-30, 30, 0);

    //    wall.addComponent('model', {
    //        type: "box",
    //        castShadows: true,
    //        receiveShadows: true
    //    });
    //    var wallMaterial = new pc.scene.PhongMaterial();
    //    wallMaterial.diffuseMap = results[0].resource[0];
    //    wallMaterial.diffuseMapTiling = new pc.Vec2(10, 10);
    //    wallMaterial.update();
    //    wall.model.model.meshInstances[0].material = wallMaterial;

    var wall2 = wall.clone();
    wall2.translate(60, 0, 0);

    var wall3 = wall.clone();
    wall3.translate(30, 0, 30);
    wall3.rotate(0, 90, 0);

    var wall4 = wall3.clone();
    wall4.translate(0, 0, -60);

    //Create an enemy spawner
    spawner = new pc.fw.Entity();
    spawner.setName('spawner');

    var spawnScript = {
        name: 'spawn',
        url: 'scripts/spawn.js'
    }

    spawner.addComponent('script', {
        enabled: true,
        scripts: [spawnScript]
    });

    //Create a HUD
    //    stats = new pc.fw.Entity();
    //    stats.setName('stats');
    score = new pc.fw.Entity();
    score.setName('score');
    highscore = new pc.fw.Entity();
    highscore.setName('highscore');
    congrats = new pc.fw.Entity();
    congrats.setName('congrats');
    congrats.enabled = false;
    store = new pc.Entity();
    store.setName('store');
    store.enabled = false;
    gameOver = new pc.fw.Entity();
    gameOver.setName('gameOver');

    var gameOverText = {
        name: 'gameOverText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
            }, {
            name: 'fontJson',
            value: 'boombox'
            }, {
            name: 'text',
            value: 'Start Game'
            }, {
            name: 'maxTextLength',
            value: '64'
            }, {
            name: 'x',
            value: 0
            }, {
            name: 'y',
            value: 30
            }, {
            name: 'anchor',
            value: 4
            }, {
            name: 'pivot',
            value: 4
            }, {
            name: 'tint',
            type: 'rgba',
            //            value: [0.2, 0.5, 1, 1]
            value: [0.8, 0.8, 0, 1]
            }, {
            name: 'maxResHeight',
            value: 300
            }, {
            name: 'depth',
            value: 1
            }]

    };

    var scoreText = {
        name: 'scoreText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
            }, {
            name: 'fontJson',
            value: 'boombox'
            }, {
            name: 'text',
            value: ''
            }, {
            name: 'maxTextLength',
            value: '14'
            }, {
            name: 'x',
            value: 5
            }, {
            name: 'y',
            value: -5
            }, {
            name: 'anchor',
            value: 0
            }, {
            name: 'pivot',
            value: 0
            }, {
            name: 'tint',
            type: 'rgba',
            value: [1, 1, 1, 1]
                //            value: [0, 0, 0, 1]
            }, {
            name: 'maxResHeight',
            value: 720
            }, {
            name: 'depth',
            value: 1
            }]

    };

    var highScoreText = {
        name: 'scoreText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
            }, {
            name: 'fontJson',
            value: 'boombox'
            }, {
            name: 'text',
            value: 'High Score: '
            }, {
            name: 'maxTextLength',
            value: '20'
            }, {
            name: 'x',
            value: -5
            }, {
            name: 'y',
            value: -5
            }, {
            name: 'anchor',
            value: 2
            }, {
            name: 'pivot',
            value: 2
            }, {
            name: 'tint',
            type: 'rgba',
            value: [1, 1, 1, 1]
                //            value: [0, 0, 0, 1]
            }, {
            name: 'maxResHeight',
            value: 720
            }, {
            name: 'depth',
            value: 1
            }]

    };

    var congratsText = {
        name: 'scoreText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
            }, {
            name: 'fontJson',
            value: 'boombox'
            }, {
            name: 'text',
            value: 'You beat your high score!'
            }, {
            name: 'maxTextLength',
            value: '32'
            }, {
            name: 'x',
            value: 0
            }, {
            name: 'y',
            value: -30
            }, {
            name: 'anchor',
            value: 4
            }, {
            name: 'pivot',
            value: 4
            }, {
            name: 'tint',
            type: 'rgba',
            value: [1, 1, 1, 1]
                //            value: [0, 0, 0, 1]
            }, {
            name: 'maxResHeight',
            value: 720
            }, {
            name: 'depth',
            value: 1
            }]

    };

    //    var storeSprite = {
    //        name: 'storeSprite',
    //        url: 'scripts/sprite.js',
    //        attributes: [{
    //            name: 'textureAsset',
    //            value: 'tank_icon.png'
    //                    }, {
    //            name: 'x',
    //            value: 0
    //                    }, {
    //            name: 'y',
    //            value: -10
    //                    }, {
    //            name: 'width',
    //            value: 128
    //                    }, {
    //            name: 'height',
    //            value: 128
    //                    }, {
    //            name: 'anchor',
    //            value: 1
    //                    }, {
    //            name: 'pivot',
    //            value: 1
    //                    }, {
    //            name: 'tint',
    //            type: 'rgba',
    //            value: [1, 1, 1, 1]
    //                    }, {
    //            name: 'maxResHeight',
    //            value: 720
    //                    }, {
    //            name: 'depth',
    //            value: 1
    //                    }, {
    //            name: 'uPercentage',
    //            value: 1
    //                    }, {
    //            name: 'vPercentage',
    //            value: 1
    //                    }]
    //    }

    var storeText = {
        name: 'scoreText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
            }, {
            name: 'fontJson',
            value: 'boombox'
            }, {
            name: 'text',
            value: '$'
            }, {
            name: 'maxTextLength',
            value: '3'
            }, {
            name: 'x',
            value: 0
            }, {
            name: 'y',
            value: -5
            }, {
            name: 'anchor',
            value: 1
            }, {
            name: 'pivot',
            value: 1
            }, {
            name: 'tint',
            type: 'rgba',
            value: [0.8, 0.8, 0, 1]
                //            value: [0, 0, 0, 1]
            }, {
            name: 'maxResHeight',
            value: 360
            }, {
            name: 'depth',
            value: 1
            }]

    };


    var gameOverScript = {
        name: 'gameOver',
        url: 'scripts/gameOver.js'
    }

    gameOver.addComponent('script', {
        enabled: true,
        scripts: [gameOverText, gameOverScript]
    });

    //    gameOver.enabled = true;

    var scoreScript = {
        name: 'score',
        url: 'scripts/score.js'
    }

    score.addComponent('script', {
        enabled: true,
        scripts: [scoreText, scoreScript]
    });

    var highScoreScript = {
        name: 'highscore',
        url: 'scripts/highscore.js'
    }

    highscore.addComponent('script', {
        enabled: true,
        scripts: [highScoreText, highScoreScript]
    });

    //    var highScoreScript = {
    //        name: 'highscore',
    //        url: 'scripts/highscore.js'
    //    }

    congrats.addComponent('script', {
        enabled: true,
        scripts: [congratsText]
            //        scripts: [highScoreText, highScoreScript]
    });

    var storeScript = {
        name: 'store',
        url: 'scripts/store.js'
    }

    store.addComponent('script', {
        enabled: true,
        scripts: [storeText, storeScript]
            //        scripts: [storeSprite]
    });

    health = new pc.fw.Entity();
    health.setName('health');
    var healthScript = {
        name: 'health',
        url: 'scripts/health.js'
    }

    health.addComponent('script', {
        enabled: true,
        scripts: [healthScript]
    });

    var info_shoot = new pc.fw.Entity();
    info_shoot.setName('info_shoot');

    var info_shoot_sprite = {
        name: 'sprite',
        url: 'scripts/sprite.js',
        attributes: [{
            name: 'textureAsset',
            value: 'shoot-icon.png'
            }, {
            name: 'x',
            value: 100
            }, {
            name: 'y',
            value: 50
            }, {
            name: 'width',
            value: 64
            }, {
            name: 'height',
            value: 64
            }, {
            name: 'anchor',
            value: 6
            }, {
            name: 'pivot',
            value: 6
            }, {
            name: 'tint',
            type: 'rgba',
            value: [1, 1, 1, 1]
            }, {
            name: 'maxResHeight',
            value: 300
            }, {
            name: 'depth',
            value: 10
            }, {
            name: 'uPercentage',
            value: 1
            }, {
            name: 'vPercentage',
            value: 1
            }]
    }

    info_shoot.addComponent('script', {
        enabled: true,
        scripts: [info_shoot_sprite]
    });

    var info_move = new pc.fw.Entity;
    info_move.setName('info_move');
    var info_move_sprite = {
        name: 'sprite',
        url: 'scripts/sprite.js',
        attributes: [{
            name: 'textureAsset',
            value: 'move-icon.png'
            }, {
            name: 'x',
            value: -100
            }, {
            name: 'y',
            value: 50
            }, {
            name: 'width',
            value: 64
            }, {
            name: 'height',
            value: 64
            }, {
            name: 'anchor',
            value: 8
            }, {
            name: 'pivot',
            value: 8
            }, {
            name: 'tint',
            type: 'rgba',
            value: [1, 1, 1, 1]
            }, {
            name: 'maxResHeight',
            value: 300
            }, {
            name: 'depth',
            value: 10
            }, {
            name: 'uPercentage',
            value: 1
            }, {
            name: 'vPercentage',
            value: 1
            }]
    }

    info_move.addComponent('script', {
        enabled: true,
        scripts: [info_move_sprite]
    });

    store_listing.addChild(store_bullet_green);
    store_listing.addChild(store_bullet_pink);
    store.addChild(store_listing);

    cam.addChild(activeBullet);
    tank.addChild(base);
    tank.addChild(gun);
    gun.addChild(cam);

    gameOver.addChild(info_shoot);
    gameOver.addChild(info_move);

    app.root.addChild(gameOver);
    app.root.addChild(score);
    app.root.addChild(health);
    app.root.addChild(highscore);
    app.root.addChild(congrats);
    app.root.addChild(store);

    app.root.addChild(tank);
    app.root.addChild(floor);
    app.root.addChild(light);
    app.root.addChild(store_light);
    app.root.addChild(wall);
    app.root.addChild(wall2);
    app.root.addChild(wall3);
    app.root.addChild(wall4);


});
<?xml version="1.0" encoding="UTF-8" ?>
<widget xmlns="http://www.w3.org/ns/widgets" xmlns:gap="http://phonegap.com/ns/1.0" id="com.thenigh7sh4de.tanky" version="0.5.0">

    <name>Tanky</name>

    <description>
        A fun and cute little mobile game where you must protect your tank.
        <br/> Tanky is Love. Tanky is Life. &lt;3
    </description>

    <author href="https://github.com/nigh7sh4de/tanky" email="plotnikd@gmail.com">
        Nigh7Sh4de
    </author>

    <preference name="orientation" value="landscape" />
    <preference name="fullscreen" value="true" />
    <preference name="android-minSdkVersion" value="14" />
    <preference name="permissions" value="none" />

    <icon src="icon.png" />

</widget>
//Dis how it should be and hopefully will be if PlayCanvas gets their shit together
inherit = function (Self, Super) {
    Self.prototype = Object.create(Super.prototype);
    //    Self.prototype = Super.prototype;
    //    Self.prototye = new Super;
    Self.prototype.constructor = Self;
}

buildText = function (text, x, y) {
    var thing = new pc.fw.Entity();
    thing.setName('text_' + text);
    var thingText = {
        name: 'thingText',
        url: 'scripts/font_renderer.js',
        attributes: [{
            name: 'fontAtlas',
            value: 'boombox_72.png'
        }, {
            name: 'fontJson',
            value: 'boombox'
        }, {
            name: 'text',
            value: text
        }, {
            name: 'maxTextLength',
            value: '64'
        }, {
            name: 'x',
            value: x
        }, {
            name: 'y',
            value: y
        }, {
            name: 'anchor',
            value: 4
        }, {
            name: 'pivot',
            value: 4
        }, {
            name: 'tint',
            type: 'rgba',
            value: [0, 0, 0, 1]
        }, {
            name: 'maxResHeight',
            value: 720
        }, {
            name: 'depth',
            value: 1
        }]

    };

    thing.addComponent('script', {
        enabled: true,
        scripts: [thingText]
    });

    return thing;
}
PNG
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=0">
    <title>Tanky</title>

    <link rel="stylesheet" href="style.css">

</head>

<body>
    <canvas id="application-canvas" tabindex="0"></canvas>

    <!--    <script src="http://code.playcanvas.com/playcanvas-latest.min.js"></script>-->
    <!--    <script src="http://code.playcanvas.com/playcanvas-latest.js"></script>-->
    <!--    <script src="http://code.playcanvas.com/playcanvas-stable.min.js"></script>-->
    <!--    <script src="http://code.playcanvas.com/ammo.751ec5f.js"></script>-->
    <script src="ammo.751ec5f.js"></script>
    <!--    <script src="playcanvas-latest_20150202.min.js"></script>-->

    <!--For Release use this:
    <script src="playcanvas-latest_20150306.min.js"></script>

    Otherwise use: -->
    <script src="playcanvas-latest_20150426.js"></script>



    <script src="scripts/shaders/burn.f.js"></script>
    <script src="scripts/shaders/burn.v.js"></script>

    <script src="helperfunctions.js"></script>

    <script src="scripts/templates/Enemy.js"></script>
    <script src="scripts/templates/YellowEnemy.js"></script>
    <script src="scripts/templates/RedEnemy.js"></script>
    <script src="scripts/templates/Bullet.js"></script>
    <script src="scripts/templates/GreenBullet.js"></script>
    <script src="scripts/templates/PinkBullet.js"></script>


    <script src="app.js"></script>

</body>

</html>
Copyright (c) 2015 Nigh7Sh4de

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

This software uses PlayCanvas engine which is distrubted un the the following license:

Copyright (c) 2011-2014 PlayCanvas Ltd.
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.
          
nigh7sh4de  L   00
+* S6lm}puBD1	x)xcFY}Da
=1=tkXG rmw~R?Z 0]}9&M*CE[P%:Pp)SU#FOB45.x&j59kPnez}iBCk]^>~>LXekL7-nf{/DT,PVH{JeD&zq^ -l>VGZ)hG5uG<:F@&uC4M}*$~PjEy|}A\3X`hMvOPMe1(@y4eigY+eE/*
 PlayCanvas Engine v0.166.0
 revision e493448

 http://playcanvas.com
 Copyright 2011-2014 PlayCanvas Ltd. All rights reserved.
 Do not distribute.
 Contains: https://github.com/tildeio/rsvp.js - see page for license information
*/
var pc = {config:{}, common:{}, apps:{}, data:{}, unpack:function() {
  console.warn("pc.unpack has been deprecated and will be removed shortly. Please update your code.")
}, makeArray:function(arr) {
  var i, ret = [], length = arr.length;
  for(i = 0;i < length;++i) {
    ret.push(arr[i])
  }
  return ret
}, type:function(obj) {
  if(obj === null) {
    return"null"
  }
  var type = typeof obj;
  if(type == "undefined" || type == "number" || type == "string" || type == "boolean") {
    return type
  }
  return _typeLookup[Object.prototype.toString.call(obj)]
}, extend:function(target, ex) {
  var prop, copy;
  for(prop in ex) {
    copy = ex[prop];
    if(pc.type(copy) == "object") {
      target[prop] = pc.extend({}, copy)
    }else {
      if(pc.type(copy) == "array") {
        target[prop] = pc.extend([], copy)
      }else {
        target[prop] = copy
      }
    }
  }
  return target
}, isDefined:function(o) {
  var a;
  return o !== a
}};
var _typeLookup = function() {
  var result = {}, index, names = ["Array", "Object", "Function", "Date", "RegExp", "Float32Array"];
  for(index = 0;index < names.length;++index) {
    result["[object " + names[index] + "]"] = names[index].toLowerCase()
  }
  return result
}();
if(typeof exports !== "undefined") {
  exports.pc = pc
}
;(function() {
  if(typeof document === "undefined") {
    return
  }
  var fullscreenchange = function() {
    var e = document.createEvent("CustomEvent");
    e.initCustomEvent("fullscreenchange", true, false, null);
    document.dispatchEvent(e)
  };
  var fullscreenerror = function() {
    var e = document.createEvent("CustomEvent");
    e.initCustomEvent("fullscreenerror", true, false, null);
    document.dispatchEvent(e)
  };
  document.addEventListener("webkitfullscreenchange", fullscreenchange, false);
  document.addEventListener("mozfullscreenchange", fullscreenchange, false);
  document.addEventListener("MSFullscreenChange", fullscreenchange, false);
  document.addEventListener("webkitfullscreenerror", fullscreenerror, false);
  document.addEventListener("mozfullscreenerror", fullscreenerror, false);
  document.addEventListener("MSFullscreenError", fullscreenerror, false);
  if(Element.prototype.mozRequestFullScreen) {
    Element.prototype.requestFullscreen = function() {
      this.mozRequestFullScreen()
    }
  }else {
    Element.prototype.requestFullscreen = Element.prototype.requestFullscreen || Element.prototype.webkitRequestFullscreen || Element.prototype.msRequestFullscreen || function() {
    }
  }
  document.exitFullscreen = document.exitFullscreen || document.webkitExitFullscreen || document.mozCancelFullScreen || document.msExitFullscreen;
  if(!document.fullscreenElement) {
    Object.defineProperty(document, "fullscreenElement", {enumerable:true, configurable:false, get:function() {
      return document.webkitCurrentFullScreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement
    }})
  }
  if(!document.fullscreenEnabled) {
    Object.defineProperty(document, "fullscreenEnabled", {enumerable:true, configurable:false, get:function() {
      return document.webkitFullscreenEnabled || document.mozFullScreenEnabled || document.msFullscreenEnabled
    }})
  }
})();
pc.extend(pc, function() {
  var Color = function() {
    this.data = new Float32Array(4);
    if(arguments.length >= 3) {
      this.data[0] = arguments[0];
      this.data[1] = arguments[1];
      this.data[2] = arguments[2];
      this.data[3] = arguments.length >= 4 ? arguments[3] : 1
    }else {
      this.data[0] = 0;
      this.data[1] = 0;
      this.data[2] = 0;
      this.data[3] = 1
    }
  };
  Color.prototype = {clone:function() {
    return new pc.Color(this.r, this.g, this.b, this.a)
  }, copy:function(rhs) {
    var a = this.data;
    var b = rhs.data;
    a[0] = b[0];
    a[1] = b[1];
    a[2] = b[2];
    a[3] = b[3];
    return this
  }, set:function(r, g, b, a) {
    var c = this.data;
    c[0] = r;
    c[1] = g;
    c[2] = b;
    c[3] = a === undefined ? 1 : a;
    return this
  }, fromString:function(hex) {
    var i = parseInt(hex.replace("#", "0x"));
    var bytes;
    if(hex.length > 7) {
      bytes = pc.math.intToBytes32(i)
    }else {
      bytes = pc.math.intToBytes24(i);
      bytes[3] = 255
    }
    this.set(bytes[0] / 255, bytes[1] / 255, bytes[2] / 255, bytes[3] / 255);
    return this
  }, toString:function(alpha) {
    var s = "#" + ((1 << 24) + (parseInt(this.r * 255) << 16) + (parseInt(this.g * 255) << 8) + parseInt(this.b * 255)).toString(16).slice(1);
    if(alpha === true) {
      var a = parseInt(this.a * 255).toString(16);
      if(this.a < 16 / 255) {
        s += "0" + a
      }else {
        s += a
      }
    }
    return s
  }};
  Object.defineProperty(Color.prototype, "r", {get:function() {
    return this.data[0]
  }, set:function(value) {
    this.data[0] = value
  }});
  Object.defineProperty(Color.prototype, "g", {get:function() {
    return this.data[1]
  }, set:function(value) {
    this.data[1] = value
  }});
  Object.defineProperty(Color.prototype, "b", {get:function() {
    return this.data[2]
  }, set:function(value) {
    this.data[2] = value
  }});
  Object.defineProperty(Color.prototype, "a", {get:function() {
    return this.data[3]
  }, set:function(value) {
    this.data[3] = value
  }});
  return{Color:Color}
}());
pc.guid = function() {
  return{create:function() {
    return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function(c) {
      var r = Math.random() * 16 | 0, v = c == "x" ? r : r & 3 | 8;
      return v.toString(16)
    })
  }}
}();
pc.extend(pc, function() {
  var Timer = function Timer() {
    this._isRunning = false;
    this._a = 0;
    this._b = 0
  };
  Timer.prototype = {start:function() {
    this._isRunning = true;
    this._a = (new Date).getTime()
  }, stop:function() {
    this._isRunning = false;
    this._b = (new Date).getTime()
  }, getMilliseconds:function() {
    return this._b - this._a
  }};
  return{Timer:Timer, now:function() {
    return(new Date).getTime()
  }}
}());
pc.extend(pc, function() {
  return{createURI:function(options) {
    var s = "";
    if((options.authority || options.scheme) && (options.host || options.hostpath)) {
      throw new Error("Can't have 'scheme' or 'authority' and 'host' or 'hostpath' option");
    }
    if(options.host && options.hostpath) {
      throw new Error("Can't have 'host' and 'hostpath' option");
    }
    if(options.path && options.hostpath) {
      throw new Error("Can't have 'path' and 'hostpath' option");
    }
    if(options.scheme) {
      s += options.scheme + ":"
    }
    if(options.authority) {
      s += "//" + options.authority
    }
    if(options.host) {
      s += options.host
    }
    if(options.path) {
      s += options.path
    }
    if(options.hostpath) {
      s += options.hostpath
    }
    if(options.query) {
      s += "?" + options.query
    }
    if(options.fragment) {
      s += "#" + options.fragment
    }
    return s
  }, URI:function(uri) {
    var re = /^(([^:\/?\#]+):)?(\/\/([^\/?\#]*))?([^?\#]*)(\?([^\#]*))?(\#(.*))?/, result = uri.match(re);
    this.scheme = result[2];
    this.authority = result[4];
    this.path = result[5];
    this.query = result[7];
    this.fragment = result[9];
    this.toString = function() {
      var s = "";
      if(this.scheme) {
        s += this.scheme + ":"
      }
      if(this.authority) {
        s += "//" + this.authority
      }
      s += this.path;
      if(this.query) {
        s += "?" + this.query
      }
      if(this.fragment) {
        s += "#" + this.fragment
      }
      return s
    };
    this.getQuery = function() {
      var vars;
      var pair;
      var result = {};
      if(this.query) {
        vars = decodeURIComponent(this.query).split("&");
        vars.forEach(function(item, index, arr) {
          pair = item.split("=");
          result[pair[0]] = pair[1]
        }, this)
      }
      return result
    };
    this.setQuery = function(params) {
      q = "";
      for(var key in params) {
        if(params.hasOwnProperty(key)) {
          if(q !== "") {
            q += "&"
          }
          q += encodeURIComponent(key) + "=" + encodeURIComponent(params[key])
        }
      }
      this.query = q
    }
  }}
}());
pc.extend(pc, function() {
  var log = {write:function(text) {
    console.log(text)
  }, open:function(text) {
    pc.log.write(Date())
  }, info:function(text) {
    console.info("INFO:    " + text)
  }, debug:function(text) {
    console.debug("DEBUG:   " + text)
  }, error:function(text) {
    console.error("ERROR:   " + text)
  }, warning:function(text) {
    console.warn("WARNING: " + text)
  }, alert:function(text) {
    pc.log.write("ALERT:   " + text);
    alert(text)
  }, assert:function(condition, text) {
    if(condition === false) {
      pc.log.write("ASSERT:  " + text);
      alert("ASSERT failed: " + text)
    }
  }};
  return{log:log}
}());
var logINFO = pc.log.info;
var logDEBUG = pc.log.debug;
var logWARNING = pc.log.warning;
var logERROR = pc.log.error;
var logALERT = pc.log.alert;
var logASSERT = pc.log.assert;
Function.prototype.extendsFrom = function(Super) {
  var Self;
  var Func;
  var Temp = function() {
  };
  Self = this;
  Func = function() {
    Super.apply(this, arguments);
    Self.apply(this, arguments);
    this.constructor = Self
  };
  Func._super = Super.prototype;
  Temp.prototype = Super.prototype;
  Func.prototype = new Temp;
  return Func
};
pc.extend(pc, function() {
  return{inherits:function(Self, Super) {
    var Temp = function() {
    };
    var Func = function() {
      Super.apply(this, arguments);
      Self.apply(this, arguments)
    };
    Func._super = Super.prototype;
    Temp.prototype = Super.prototype;
    Func.prototype = new Temp;
    return Func
  }}
}());
if(!Function.prototype.bind) {
  Function.prototype.bind = function(oThis) {
    if(typeof this !== "function") {
      throw new TypeError("Function.prototype.bind - what is trying to be fBound is not callable");
    }
    var aArgs = Array.prototype.slice.call(arguments, 1), fToBind = this, fNOP = function() {
    }, fBound = function() {
      return fToBind.apply(this instanceof fNOP ? this : oThis || window, aArgs.concat(Array.prototype.slice.call(arguments)))
    };
    fNOP.prototype = this.prototype;
    fBound.prototype = new fNOP;
    return fBound
  }
}
;pc.path = function() {
  return{delimiter:"/", join:function() {
    var index;
    var num = arguments.length;
    var result = arguments[0];
    for(index = 0;index < num - 1;++index) {
      var one = arguments[index];
      var two = arguments[index + 1];
      if(!pc.isDefined(one) || !pc.isDefined(two)) {
        throw new Error("undefined argument to pc.path.join");
      }
      if(two[0] === pc.path.delimiter) {
        result = two;
        continue
      }
      if(one && two && one[one.length - 1] !== pc.path.delimiter && two[0] !== pc.path.delimiter) {
        result += pc.path.delimiter + two
      }else {
        result += two
      }
    }
    return result
  }, split:function(path) {
    var parts = path.split(pc.path.delimiter);
    var tail = parts.slice(parts.length - 1)[0];
    var head = parts.slice(0, parts.length - 1).join(pc.path.delimiter);
    return[head, tail]
  }, getBasename:function(path) {
    return pc.path.split(path)[1]
  }, getDirectory:function(path) {
    var parts = path.split(pc.path.delimiter);
    return parts.slice(0, parts.length - 1).join(pc.path.delimiter)
  }, getExtension:function(path) {
    var ext = path.split(".").pop();
    if(ext !== path) {
      return"." + ext
    }else {
      return""
    }
  }, isRelativePath:function(s) {
    return s.charAt(0) !== "/" && s.match(/:\/\//) === null
  }, extractPath:function(s) {
    var path = ".", parts = s.split("/"), i = 0;
    if(parts.length > 1) {
      if(pc.path.isRelativePath(s) === false) {
        path = ""
      }
      for(i = 0;i < parts.length - 1;++i) {
        path += "/" + parts[i]
      }
    }
    return path
  }}
}();
pc.string = function() {
  return{ASCII_LOWERCASE:"abcdefghijklmnopqrstuvwxyz", ASCII_UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ", ASCII_LETTERS:this.ASCII_LOWERCASE + this.ASCII_UPPERCASE, format:function(s) {
    var i = 0, regexp, args = pc.makeArray(arguments);
    args.shift();
    for(i = 0;i < args.length;i++) {
      regexp = new RegExp("\\{" + i + "\\}", "gi");
      s = s.replace(regexp, args[i])
    }
    return s
  }, startsWith:function(s, subs) {
    return s.indexOf(subs) === 0
  }, endsWith:function(s, subs) {
    return s.lastIndexOf(subs, s.length - subs.length) !== -1
  }, toBool:function(s, strict) {
    if(s === "true") {
      return true
    }
    if(strict) {
      if(s === "false") {
        return false
      }
      throw new Error("Not a boolean string");
    }
    return false
  }}
}();
pc.extend(pc, function() {
  var json = {parse:function(value, reviver) {
    return JSON.parse(value, reviver)
  }, stringify:function(value, replacer, space) {
    return JSON.stringify(value, function(key, value) {
      if(this[key] instanceof Float32Array) {
        value = pc.makeArray(this[key])
      }
      return replacer ? replacer(key, value) : value
    }, space)
  }};
  return{json:json}
}());
pc.cookie = function() {
  return{set:function(name, value, options) {
    options = options || {};
    var cookie = name + "=" + value;
    if(options.path) {
      cookie += ";path=" + options.path
    }
    if(options.domain) {
      cookie += ";domain=" + options.domain
    }
    if(options.path) {
      cookie += ";path=" + options.path
    }
    if(options.secure) {
      cookie += ";secure"
    }
    if(options.lifetime) {
      cookie += ";max-age=" + options.lifetime * 24 * 60 * 60
    }else {
      cookie += ";max-age=" + 1 * 24 * 60 * 60
    }
    document.cookie = cookie
  }, get:function(name) {
    var cookie, cookies = document.cookie.split(";");
    var i, len = cookies.length;
    for(i = 0;i < len;i++) {
      cookie = cookies[i].trim();
      if(pc.string.startsWith(cookie, name)) {
        return cookie.split("=")[1]
      }
    }
  }, remove:function(name, options) {
    options.lifetime = 0;
    pc.cookie.set(name, "", options)
  }}
}();
pc.debug = function() {
  var table = null;
  var row = null;
  var title = null;
  var field = null;
  return{display:function(data) {
    function init() {
      table = document.createElement("table");
      row = document.createElement("tr");
      title = document.createElement("td");
      field = document.createElement("td");
      table.style.cssText = "position:absolute;font-family:sans-serif;font-size:12px;color:#cccccc";
      table.style.top = "0px";
      table.style.left = "0px";
      table.style.border = "thin solid #cccccc";
      document.body.appendChild(table)
    }
    if(!table) {
      init()
    }
    table.innerHTML = "";
    for(var key in data) {
      var r = row.cloneNode();
      var t = title.cloneNode();
      var f = field.cloneNode();
      t.textContent = key;
      f.textContent = data[key];
      r.appendChild(t);
      r.appendChild(f);
      table.appendChild(r)
    }
  }}
}();
pc.extend(pc, function() {
  var ObjectPool = function(constructor, options) {
    this.objects = [];
    this.ctor = constructor;
    this.name = options.name;
    this.useNew = options.useNew === undefined || options.useNew;
    this.metrics = options.metrics;
    if(options.metrics) {
      this.total = 0;
      this.used = 0
    }
  };
  ObjectPool.prototype = {_construct:function(constructor, args) {
    function F() {
      return constructor.apply(this, args)
    }
    F.prototype = constructor.prototype;
    return new F
  }, allocate:function() {
    var object;
    if(this.objects.length) {
      object = this.objects.pop();
      this.ctor.apply(object, arguments);
      if(this.metrics) {
        this.used++
      }
    }else {
      if(this.useNew) {
        object = this._construct(this.ctor, arguments)
      }else {
        object = this.ctor.apply(this, arguments)
      }
      if(this.metrics) {
        this.total++;
        this.used++
      }
    }
    return object
  }, free:function(object) {
    this.objects.push(object);
    if(this.metrics) {
      this.used--
    }
    if(object.onFree) {
      object.onFree()
    }
  }, usage:function() {
    return pc.string.format("{0} - total: {1}, used: {2}", this.name, this.total, this.used)
  }};
  var AllocatePool = function(constructor, size) {
    this._constructor = constructor;
    this._pool = [];
    this._count = 0;
    this._resize(size)
  };
  AllocatePool.prototype = {_resize:function(size) {
    if(size > this._pool.length) {
      for(var i = this._pool.length;i < size;i++) {
        this._pool[i] = new this._constructor
      }
    }
  }, allocate:function() {
    if(this._count >= this._pool.length) {
      this._resize(this._pool.length * 2)
    }
    return this._pool[this._count++]
  }, freeAll:function() {
    this._count = 0
  }};
  return{AllocatePool:AllocatePool, ObjectPool:ObjectPool}
}());
pc.events = function() {
  var Events = {attach:function(target) {
    var ev = pc.events;
    target.on = ev.on;
    target.off = ev.off;
    target.fire = ev.fire;
    target.hasEvent = ev.hasEvent;
    target.bind = ev.on;
    target.unbind = ev.off;
    return target
  }, on:function(name, callback, scope) {
    if(pc.type(name) != "string") {
      throw new TypeError("Event name must be a string");
    }
    var callbacks = this._callbacks || (this._callbacks = {});
    var events = callbacks[name] || (callbacks[name] = []);
    events.push({callback:callback, scope:scope || this});
    return this
  }, off:function(name, callback, scope) {
    var callbacks = this._callbacks;
    var events;
    var index;
    if(!callbacks) {
      return
    }
    if(!callback) {
      callbacks[name] = []
    }else {
      events = callbacks[name];
      if(!events) {
        return this
      }
      for(index = 0;index < events.length;index++) {
        if(events[index].callback === callback) {
          if(!scope || scope === events[index].scope) {
            events.splice(index, 1);
            index--
          }
        }
      }
    }
    return this
  }, fire:function(name) {
    var index;
    var length;
    var args;
    var callbacks;
    if(this._callbacks && this._callbacks[name]) {
      length = this._callbacks[name].length;
      if(length) {
        args = pc.makeArray(arguments);
        args.shift();
        callbacks = this._callbacks[name].slice();
        for(index = 0;index < length;++index) {
          var scope = callbacks[index].scope;
          callbacks[index].callback.apply(scope, args)
        }
      }
    }
    return this
  }, hasEvent:function(name) {
    return this._callbacks !== undefined && this._callbacks[name] !== undefined && this._callbacks[name].length > 0
  }};
  Events.bind = Events.on;
  Events.unbind = Events.off;
  return Events
}();
pc.dom = function() {
  return{getWidth:function(element) {
    return element.offsetWidth
  }, getHeight:function(element) {
    return element.offsetHeight
  }, setText:function(element, text) {
    if(element.textContent) {
      element.textContent = text
    }else {
      if(element.innerText) {
        element.innerText = text
      }
    }
  }, getText:function(element) {
    return element.textContent || element.innerText
  }}
}();
pc.math = {DEG_TO_RAD:Math.PI / 180, RAD_TO_DEG:180 / Math.PI, INV_LOG2:1 / Math.log(2), clamp:function(value, min, max) {
  if(value >= max) {
    return max
  }
  if(value <= min) {
    return min
  }
  return value
}, intToBytes24:function(i) {
  var r, g, b;
  r = i >> 16 & 255;
  g = i >> 8 & 255;
  b = i & 255;
  return[r, g, b]
}, intToBytes32:function(i) {
  var r, g, b, a;
  r = i >> 24 & 255;
  g = i >> 16 & 255;
  b = i >> 8 & 255;
  a = i & 255;
  return[r, g, b, a]
}, bytesToInt24:function(r, g, b) {
  if(r.length) {
    b = r[2];
    g = r[1];
    r = r[0]
  }
  return r << 16 | g << 8 | b
}, bytesToInt32:function(r, g, b, a) {
  if(r.length) {
    a = r[3];
    b = r[2];
    g = r[1];
    r = r[0]
  }
  return(r << 24 | g << 16 | b << 8 | a) >>> 32
}, lerp:function(a, b, alpha) {
  return a + (b - a) * pc.math.clamp(alpha, 0, 1)
}, lerpAngle:function(a, b, alpha) {
  if(b - a > 180) {
    b -= 360
  }
  if(b - a < -180) {
    b += 360
  }
  return pc.math.lerp(a, b, pc.math.clamp(alpha, 0, 1))
}, powerOfTwo:function(x) {
  return x !== 0 && !(x & x - 1)
}, nextPowerOfTwo:function(val) {
  val--;
  val = val >> 1 | val;
  val = val >> 2 | val;
  val = val >> 4 | val;
  val = val >> 8 | val;
  val = val >> 16 | val;
  val++;
  return val
}, random:function(min, max) {
  var diff = max - min;
  return Math.random() * diff + min
}, smoothstep:function(min, max, x) {
  if(x <= min) {
    return 0
  }
  if(x >= max) {
    return 1
  }
  x = (x - min) / (max - min);
  return x * x * (3 - 2 * x)
}, smootherstep:function(min, max, x) {
  if(x <= min) {
    return 0
  }
  if(x >= max) {
    return 1
  }
  x = (x - min) / (max - min);
  return x * x * x * (x * (x * 6 - 15) + 10)
}};
pc.math.intToBytes = pc.math.intToBytes32;
pc.math.bytesToInt = pc.math.bytesToInt32;
if(!Math.log2) {
  Math.log2 = function(x) {
    return Math.log(x) * pc.math.INV_LOG2
  }
}
;pc.extend(pc, function() {
  var Vec2 = function() {
    this.data = new Float32Array(2);
    if(arguments.length === 2) {
      this.data.set(arguments)
    }else {
      this.data[0] = 0;
      this.data[1] = 0
    }
  };
  Vec2.prototype = {add:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] += b[0];
    a[1] += b[1];
    return this
  }, add2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + b[0];
    r[1] = a[1] + b[1];
    return this
  }, clone:function() {
    return(new Vec2).copy(this)
  }, copy:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] = b[0];
    a[1] = b[1];
    return this
  }, dot:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] * b[0] + a[1] * b[1]
  }, equals:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] === b[0] && a[1] === b[1]
  }, length:function() {
    var v = this.data;
    return Math.sqrt(v[0] * v[0] + v[1] * v[1])
  }, lengthSq:function() {
    var v = this.data;
    return v[0] * v[0] + v[1] * v[1]
  }, lerp:function(lhs, rhs, alpha) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + alpha * (b[0] - a[0]);
    r[1] = a[1] + alpha * (b[1] - a[1]);
    return this
  }, mul:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] *= b[0];
    a[1] *= b[1];
    return this
  }, mul2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] * b[0];
    r[1] = a[1] * b[1];
    return this
  }, normalize:function() {
    return this.scale(1 / this.length())
  }, scale:function(scalar) {
    var v = this.data;
    v[0] *= scalar;
    v[1] *= scalar;
    return this
  }, set:function(x, y) {
    var v = this.data;
    v[0] = x;
    v[1] = y;
    return this
  }, sub:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] -= b[0];
    a[1] -= b[1];
    return this
  }, sub2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] - b[0];
    r[1] = a[1] - b[1];
    return this
  }, toString:function() {
    return"[" + this.data[0] + ", " + this.data[1] + "]"
  }};
  Object.defineProperty(Vec2.prototype, "x", {get:function() {
    return this.data[0]
  }, set:function(value) {
    this.data[0] = value
  }});
  Object.defineProperty(Vec2.prototype, "y", {get:function() {
    return this.data[1]
  }, set:function(value) {
    this.data[1] = value
  }});
  Object.defineProperty(Vec2, "ONE", {get:function() {
    var one = new Vec2(1, 1);
    return function() {
      return one
    }
  }()});
  Object.defineProperty(Vec2, "RIGHT", {get:function() {
    var right = new Vec2(1, 0);
    return function() {
      return right
    }
  }()});
  Object.defineProperty(Vec2, "UP", {get:function() {
    var down = new Vec2(0, 1);
    return function() {
      return down
    }
  }()});
  Object.defineProperty(Vec2, "ZERO", {get:function() {
    var zero = new Vec2(0, 0);
    return function() {
      return zero
    }
  }()});
  return{Vec2:Vec2}
}());
pc.extend(pc, function() {
  var Vec3 = function() {
    this.data = new Float32Array(3);
    if(arguments.length === 3) {
      this.data.set(arguments)
    }else {
      this.data[0] = 0;
      this.data[1] = 0;
      this.data[2] = 0
    }
  };
  Vec3.prototype = {add:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] += b[0];
    a[1] += b[1];
    a[2] += b[2];
    return this
  }, add2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + b[0];
    r[1] = a[1] + b[1];
    r[2] = a[2] + b[2];
    return this
  }, clone:function() {
    return(new Vec3).copy(this)
  }, copy:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] = b[0];
    a[1] = b[1];
    a[2] = b[2];
    return this
  }, cross:function(lhs, rhs) {
    var a, b, r, ax, ay, az, bx, by, bz;
    a = lhs.data;
    b = rhs.data;
    r = this.data;
    ax = a[0];
    ay = a[1];
    az = a[2];
    bx = b[0];
    by = b[1];
    bz = b[2];
    r[0] = ay * bz - by * az;
    r[1] = az * bx - bz * ax;
    r[2] = ax * by - bx * ay;
    return this
  }, dot:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2]
  }, equals:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2]
  }, length:function() {
    var v = this.data;
    return Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2])
  }, lengthSq:function() {
    var v = this.data;
    return v[0] * v[0] + v[1] * v[1] + v[2] * v[2]
  }, lerp:function(lhs, rhs, alpha) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + alpha * (b[0] - a[0]);
    r[1] = a[1] + alpha * (b[1] - a[1]);
    r[2] = a[2] + alpha * (b[2] - a[2]);
    return this
  }, mul:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] *= b[0];
    a[1] *= b[1];
    a[2] *= b[2];
    return this
  }, mul2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] * b[0];
    r[1] = a[1] * b[1];
    r[2] = a[2] * b[2];
    return this
  }, normalize:function() {
    return this.scale(1 / this.length())
  }, project:function(rhs) {
    var a = this.data;
    var b = rhs.data;
    var a_dot_b = a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
    var b_dot_b = b[0] * b[0] + b[1] * b[1] + b[2] * b[2];
    var s = a_dot_b / b_dot_b;
    a[0] = b[0] * s;
    a[1] = b[1] * s;
    a[2] = b[2] * s;
    return this
  }, scale:function(scalar) {
    var v = this.data;
    v[0] *= scalar;
    v[1] *= scalar;
    v[2] *= scalar;
    return this
  }, set:function(x, y, z) {
    var v = this.data;
    v[0] = x;
    v[1] = y;
    v[2] = z;
    return this
  }, sub:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] -= b[0];
    a[1] -= b[1];
    a[2] -= b[2];
    return this
  }, sub2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] - b[0];
    r[1] = a[1] - b[1];
    r[2] = a[2] - b[2];
    return this
  }, toString:function() {
    return"[" + this.data[0] + ", " + this.data[1] + ", " + this.data[2] + "]"
  }};
  Object.defineProperty(Vec3.prototype, "x", {get:function() {
    return this.data[0]
  }, set:function(value) {
    this.data[0] = value
  }});
  Object.defineProperty(Vec3.prototype, "y", {get:function() {
    return this.data[1]
  }, set:function(value) {
    this.data[1] = value
  }});
  Object.defineProperty(Vec3.prototype, "z", {get:function() {
    return this.data[2]
  }, set:function(value) {
    this.data[2] = value
  }});
  Object.defineProperty(Vec3, "BACK", {get:function() {
    var back = new Vec3(0, 0, 1);
    return function() {
      return back
    }
  }()});
  Object.defineProperty(Vec3, "DOWN", {get:function() {
    var down = new Vec3(0, -1, 0);
    return function() {
      return down
    }
  }()});
  Object.defineProperty(Vec3, "FORWARD", {get:function() {
    var forward = new Vec3(0, 0, -1);
    return function() {
      return forward
    }
  }()});
  Object.defineProperty(Vec3, "LEFT", {get:function() {
    var left = new Vec3(-1, 0, 0);
    return function() {
      return left
    }
  }()});
  Object.defineProperty(Vec3, "ONE", {get:function() {
    var one = new Vec3(1, 1, 1);
    return function() {
      return one
    }
  }()});
  Object.defineProperty(Vec3, "RIGHT", {get:function() {
    var right = new Vec3(1, 0, 0);
    return function() {
      return right
    }
  }()});
  Object.defineProperty(Vec3, "UP", {get:function() {
    var down = new Vec3(0, 1, 0);
    return function() {
      return down
    }
  }()});
  Object.defineProperty(Vec3, "ZERO", {get:function() {
    var zero = new Vec3(0, 0, 0);
    return function() {
      return zero
    }
  }()});
  return{Vec3:Vec3}
}());
pc.extend(pc, function() {
  var Vec4 = function() {
    this.data = new Float32Array(4);
    if(arguments.length === 4) {
      this.data.set(arguments)
    }else {
      this.data[0] = 0;
      this.data[1] = 0;
      this.data[2] = 0;
      this.data[3] = 0
    }
  };
  Vec4.prototype = {add:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] += b[0];
    a[1] += b[1];
    a[2] += b[2];
    a[3] += b[3];
    return this
  }, add2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + b[0];
    r[1] = a[1] + b[1];
    r[2] = a[2] + b[2];
    r[3] = a[3] + b[3];
    return this
  }, clone:function() {
    return(new Vec4).copy(this)
  }, copy:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] = b[0];
    a[1] = b[1];
    a[2] = b[2];
    a[3] = b[3];
    return this
  }, dot:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3]
  }, equals:function(rhs) {
    var a = this.data, b = rhs.data;
    return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3]
  }, length:function() {
    var v = this.data;
    return Math.sqrt(v[0] * v[0] + v[1] * v[1] + v[2] * v[2] + v[3] * v[3])
  }, lengthSq:function() {
    var v = this.data;
    return v[0] * v[0] + v[1] * v[1] + v[2] * v[2] + v[3] * v[3]
  }, lerp:function(lhs, rhs, alpha) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + alpha * (b[0] - a[0]);
    r[1] = a[1] + alpha * (b[1] - a[1]);
    r[2] = a[2] + alpha * (b[2] - a[2]);
    r[3] = a[3] + alpha * (b[3] - a[3]);
    return this
  }, mul:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] *= b[0];
    a[1] *= b[1];
    a[2] *= b[2];
    a[3] *= b[3];
    return this
  }, mul2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] * b[0];
    r[1] = a[1] * b[1];
    r[2] = a[2] * b[2];
    r[3] = a[3] * b[3];
    return this
  }, normalize:function() {
    return this.scale(1 / this.length())
  }, scale:function(scalar) {
    var v = this.data;
    v[0] *= scalar;
    v[1] *= scalar;
    v[2] *= scalar;
    v[3] *= scalar;
    return this
  }, set:function(x, y, z, w) {
    var v = this.data;
    v[0] = x;
    v[1] = y;
    v[2] = z;
    v[3] = w;
    return this
  }, sub:function(rhs) {
    var a = this.data, b = rhs.data;
    a[0] -= b[0];
    a[1] -= b[1];
    a[2] -= b[2];
    a[3] -= b[3];
    return this
  }, sub2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] - b[0];
    r[1] = a[1] - b[1];
    r[2] = a[2] - b[2];
    r[3] = a[3] - b[3];
    return this
  }, toString:function() {
    return"[" + this.data[0] + ", " + this.data[1] + ", " + this.data[2] + ", " + this.data[3] + "]"
  }};
  Object.defineProperty(Vec4.prototype, "x", {get:function() {
    return this.data[0]
  }, set:function(value) {
    this.data[0] = value
  }});
  Object.defineProperty(Vec4.prototype, "y", {get:function() {
    return this.data[1]
  }, set:function(value) {
    this.data[1] = value
  }});
  Object.defineProperty(Vec4.prototype, "z", {get:function() {
    return this.data[2]
  }, set:function(value) {
    this.data[2] = value
  }});
  Object.defineProperty(Vec4.prototype, "w", {get:function() {
    return this.data[3]
  }, set:function(value) {
    this.data[3] = value
  }});
  Object.defineProperty(Vec4, "ONE", {get:function() {
    var one = new Vec4(1, 1, 1, 1);
    return function() {
      return one
    }
  }()});
  Object.defineProperty(Vec4, "ZERO", {get:function() {
    var zero = new Vec4(0, 0, 0, 0);
    return function() {
      return zero
    }
  }()});
  return{Vec4:Vec4}
}());
pc.extend(pc, function() {
  var Mat3 = function() {
    this.data = new Float32Array(9);
    if(arguments.length === 9) {
      this.data.set(arguments)
    }else {
      this.setIdentity()
    }
  };
  Mat3.prototype = {clone:function() {
    return(new pc.Mat3).copy(this)
  }, copy:function(rhs) {
    var src = rhs.data;
    var dst = this.data;
    dst[0] = src[0];
    dst[1] = src[1];
    dst[2] = src[2];
    dst[3] = src[3];
    dst[4] = src[4];
    dst[5] = src[5];
    dst[6] = src[6];
    dst[7] = src[7];
    dst[8] = src[8];
    return this
  }, equals:function(rhs) {
    var l = this.data;
    var r = rhs.data;
    return l[0] === r[0] && l[1] === r[1] && l[2] === r[2] && l[3] === r[3] && l[4] === r[4] && l[5] === r[5] && l[6] === r[6] && l[7] === r[7] && l[8] === r[8]
  }, isIdentity:function() {
    var m = this.data;
    return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 0 && m[4] === 1 && m[5] === 0 && m[6] === 0 && m[7] === 0 && m[8] === 1
  }, setIdentity:function() {
    var m = this.data;
    m[0] = 1;
    m[1] = 0;
    m[2] = 0;
    m[3] = 0;
    m[4] = 1;
    m[5] = 0;
    m[6] = 0;
    m[7] = 0;
    m[8] = 1;
    return this
  }, toString:function() {
    var t = "[";
    for(var i = 0;i < 9;i++) {
      t += this.data[i];
      t += i !== 9 ? ", " : ""
    }
    t += "]";
    return t
  }, transpose:function() {
    var m = this.data;
    var tmp;
    tmp = m[1];
    m[1] = m[3];
    m[3] = tmp;
    tmp = m[2];
    m[2] = m[6];
    m[6] = tmp;
    tmp = m[5];
    m[5] = m[7];
    m[7] = tmp;
    return this
  }};
  Object.defineProperty(Mat3, "IDENTITY", {get:function() {
    var identity = new Mat3;
    return function() {
      return identity
    }
  }()});
  Object.defineProperty(Mat3, "ZERO", {get:function() {
    var zero = new Mat3(0, 0, 0, 0, 0, 0, 0, 0, 0);
    return function() {
      return zero
    }
  }()});
  return{Mat3:Mat3}
}());
pc.extend(pc, function() {
  var Mat4 = function() {
    this.data = new Float32Array(16);
    if(arguments.length === 16) {
      this.data.set(arguments)
    }else {
      this.setIdentity()
    }
  };
  Mat4.prototype = {add2:function(lhs, rhs) {
    var a = lhs.data, b = rhs.data, r = this.data;
    r[0] = a[0] + b[0];
    r[1] = a[1] + b[1];
    r[2] = a[2] + b[2];
    r[3] = a[3] + b[3];
    r[4] = a[4] + b[4];
    r[5] = a[5] + b[5];
    r[6] = a[6] + b[6];
    r[7] = a[7] + b[7];
    r[8] = a[8] + b[8];
    r[9] = a[9] + b[9];
    r[10] = a[10] + b[10];
    r[11] = a[11] + b[11];
    r[12] = a[12] + b[12];
    r[13] = a[13] + b[13];
    r[14] = a[14] + b[14];
    r[15] = a[15] + b[15];
    return this
  }, add:function(rhs) {
    return this.add2(this, rhs)
  }, clone:function() {
    return(new pc.Mat4).copy(this)
  }, copy:function(rhs) {
    var src = rhs.data, dst = this.data;
    dst[0] = src[0];
    dst[1] = src[1];
    dst[2] = src[2];
    dst[3] = src[3];
    dst[4] = src[4];
    dst[5] = src[5];
    dst[6] = src[6];
    dst[7] = src[7];
    dst[8] = src[8];
    dst[9] = src[9];
    dst[10] = src[10];
    dst[11] = src[11];
    dst[12] = src[12];
    dst[13] = src[13];
    dst[14] = src[14];
    dst[15] = src[15];
    return this
  }, equals:function(rhs) {
    var l = this.data, r = rhs.data;
    return l[0] === r[0] && l[1] === r[1] && l[2] === r[2] && l[3] === r[3] && l[4] === r[4] && l[5] === r[5] && l[6] === r[6] && l[7] === r[7] && l[8] === r[8] && l[9] === r[9] && l[10] === r[10] && l[11] === r[11] && l[12] === r[12] && l[13] === r[13] && l[14] === r[14] && l[15] === r[15]
  }, isIdentity:function() {
    var m = this.data;
    return m[0] === 1 && m[1] === 0 && m[2] === 0 && m[3] === 0 && m[4] === 0 && m[5] === 1 && m[6] === 0 && m[7] === 0 && m[8] === 0 && m[9] === 0 && m[10] === 1 && m[11] === 0 && m[12] === 0 && m[13] === 0 && m[14] === 0 && m[15] === 1
  }, mul2:function(lhs, rhs) {
    var a00, a01, a02, a03, a10, a11, a12, a13, a20, a21, a22, a23, a30, a31, a32, a33, b0, b1, b2, b3, a = lhs.data, b = rhs.data, r = this.data;
    a00 = a[0];
    a01 = a[1];
    a02 = a[2];
    a03 = a[3];
    a10 = a[4];
    a11 = a[5];
    a12 = a[6];
    a13 = a[7];
    a20 = a[8];
    a21 = a[9];
    a22 = a[10];
    a23 = a[11];
    a30 = a[12];
    a31 = a[13];
    a32 = a[14];
    a33 = a[15];
    b0 = b[0];
    b1 = b[1];
    b2 = b[2];
    b3 = b[3];
    r[0] = a00 * b0 + a10 * b1 + a20 * b2 + a30 * b3;
    r[1] = a01 * b0 + a11 * b1 + a21 * b2 + a31 * b3;
    r[2] = a02 * b0 + a12 * b1 + a22 * b2 + a32 * b3;
    r[3] = a03 * b0 + a13 * b1 + a23 * b2 + a33 * b3;
    b0 = b[4];
    b1 = b[5];
    b2 = b[6];
    b3 = b[7];
    r[4] = a00 * b0 + a10 * b1 + a20 * b2 + a30 * b3;
    r[5] = a01 * b0 + a11 * b1 + a21 * b2 + a31 * b3;
    r[6] = a02 * b0 + a12 * b1 + a22 * b2 + a32 * b3;
    r[7] = a03 * b0 + a13 * b1 + a23 * b2 + a33 * b3;
    b0 = b[8];
    b1 = b[9];
    b2 = b[10];
    b3 = b[11];
    r[8] = a00 * b0 + a10 * b1 + a20 * b2 + a30 * b3;
    r[9] = a01 * b0 + a11 * b1 + a21 * b2 + a31 * b3;
    r[10] = a02 * b0 + a12 * b1 + a22 * b2 + a32 * b3;
    r[11] = a03 * b0 + a13 * b1 + a23 * b2 + a33 * b3;
    b0 = b[12];
    b1 = b[13];
    b2 = b[14];
    b3 = b[15];
    r[12] = a00 * b0 + a10 * b1 + a20 * b2 + a30 * b3;
    r[13] = a01 * b0 + a11 * b1 + a21 * b2 + a31 * b3;
    r[14] = a02 * b0 + a12 * b1 + a22 * b2 + a32 * b3;
    r[15] = a03 * b0 + a13 * b1 + a23 * b2 + a33 * b3;
    return this
  }, mul:function(rhs) {
    return this.mul2(this, rhs)
  }, transformPoint:function(vec, res) {
    var x, y, z, m = this.data, v = vec.data;
    res = res === undefined ? new pc.Vec3 : res;
    x = v[0] * m[0] + v[1] * m[4] + v[2] * m[8] + m[12];
    y = v[0] * m[1] + v[1] * m[5] + v[2] * m[9] + m[13];
    z = v[0] * m[2] + v[1] * m[6] + v[2] * m[10] + m[14];
    return res.set(x, y, z)
  }, transformVector:function(vec, res) {
    var x, y, z, m = this.data, v = vec.data;
    res = res === undefined ? new pc.Vec3 : res;
    x = v[0] * m[0] + v[1] * m[4] + v[2] * m[8];
    y = v[0] * m[1] + v[1] * m[5] + v[2] * m[9];
    z = v[0] * m[2] + v[1] * m[6] + v[2] * m[10];
    return res.set(x, y, z)
  }, setLookAt:function() {
    var x, y, z;
    x = new pc.Vec3;
    y = new pc.Vec3;
    z = new pc.Vec3;
    return function(position, target, up) {
      z.sub2(position, target).normalize();
      y.copy(up).normalize();
      x.cross(y, z).normalize();
      y.cross(z, x);
      var r = this.data;
      r[0] = x.x;
      r[1] = x.y;
      r[2] = x.z;
      r[3] = 0;
      r[4] = y.x;
      r[5] = y.y;
      r[6] = y.z;
      r[7] = 0;
      r[8] = z.x;
      r[9] = z.y;
      r[10] = z.z;
      r[11] = 0;
      r[12] = position.x;
      r[13] = position.y;
      r[14] = position.z;
      r[15] = 1;
      return this
    }
  }(), setFrustum:function(left, right, bottom, top, znear, zfar) {
    var temp1, temp2, temp3, temp4, r;
    temp1 = 2 * znear;
    temp2 = right - left;
    temp3 = top - bottom;
    temp4 = zfar - znear;
    r = this.data;
    r[0] = temp1 / temp2;
    r[1] = 0;
    r[2] = 0;
    r[3] = 0;
    r[4] = 0;
    r[5] = temp1 / temp3;
    r[6] = 0;
    r[7] = 0;
    r[8] = (right + left) / temp2;
    r[9] = (top + bottom) / temp3;
    r[10] = (-zfar - znear) / temp4;
    r[11] = -1;
    r[12] = 0;
    r[13] = 0;
    r[14] = -temp1 * zfar / temp4;
    r[15] = 0;
    return this
  }, setPerspective:function(fovy, aspect, znear, zfar) {
    var xmax, ymax;
    ymax = znear * Math.tan(fovy * Math.PI / 360);
    xmax = ymax * aspect;
    return this.setFrustum(-xmax, xmax, -ymax, ymax, znear, zfar)
  }, setOrtho:function(left, right, bottom, top, near, far) {
    var r = this.data;
    r[0] = 2 / (right - left);
    r[1] = 0;
    r[2] = 0;
    r[3] = 0;
    r[4] = 0;
    r[5] = 2 / (top - bottom);
    r[6] = 0;
    r[7] = 0;
    r[8] = 0;
    r[9] = 0;
    r[10] = -2 / (far - near);
    r[11] = 0;
    r[12] = -(right + left) / (right - left);
    r[13] = -(top + bottom) / (top - bottom);
    r[14] = -(far + near) / (far - near);
    r[15] = 1;
    return this
  }, setFromAxisAngle:function(axis, angle) {
    var x, y, z, c, s, t, tx, ty, m;
    angle *= pc.math.DEG_TO_RAD;
    x = axis.x;
    y = axis.y;
    z = axis.z;
    c = Math.cos(angle);
    s = Math.sin(angle);
    t = 1 - c;
    tx = t * x;
    ty = t * y;
    m = this.data;
    m[0] = tx * x + c;
    m[1] = tx * y + s * z;
    m[2] = tx * z - s * y;
    m[3] = 0;
    m[4] = tx * y - s * z;
    m[5] = ty * y + c;
    m[6] = ty * z + s * x;
    m[7] = 0;
    m[8] = tx * z + s * y;
    m[9] = ty * z - x * s;
    m[10] = t * z * z + c;
    m[11] = 0;
    m[12] = 0;
    m[13] = 0;
    m[14] = 0;
    m[15] = 1;
    return this
  }, setTranslate:function(tx, ty, tz) {
    var m = this.data;
    m[0] = 1;
    m[1] = 0;
    m[2] = 0;
    m[3] = 0;
    m[4] = 0;
    m[5] = 1;
    m[6] = 0;
    m[7] = 0;
    m[8] = 0;
    m[9] = 0;
    m[10] = 1;
    m[11] = 0;
    m[12] = tx;
    m[13] = ty;
    m[14] = tz;
    m[15] = 1;
    return this
  }, setScale:function(sx, sy, sz) {
    var m = this.data;
    m[0] = sx;
    m[1] = 0;
    m[2] = 0;
    m[3] = 0;
    m[4] = 0;
    m[5] = sy;
    m[6] = 0;
    m[7] = 0;
    m[8] = 0;
    m[9] = 0;
    m[10] = sz;
    m[11] = 0;
    m[12] = 0;
    m[13] = 0;
    m[14] = 0;
    m[15] = 1;
    return this
  }, invert:function() {
    var a00, a01, a02, a03, a10, a11, a12, a13, a20, a21, a22, a23, a30, a31, a32, a33, b00, b01, b02, b03, b04, b05, b06, b07, b08, b09, b10, b11, invDet, m;
    m = this.data;
    a00 = m[0];
    a01 = m[1];
    a02 = m[2];
    a03 = m[3];
    a10 = m[4];
    a11 = m[5];
    a12 = m[6];
    a13 = m[7];
    a20 = m[8];
    a21 = m[9];
    a22 = m[10];
    a23 = m[11];
    a30 = m[12];
    a31 = m[13];
    a32 = m[14];
    a33 = m[15];
    b00 = a00 * a11 - a01 * a10;
    b01 = a00 * a12 - a02 * a10;
    b02 = a00 * a13 - a03 * a10;
    b03 = a01 * a12 - a02 * a11;
    b04 = a01 * a13 - a03 * a11;
    b05 = a02 * a13 - a03 * a12;
    b06 = a20 * a31 - a21 * a30;
    b07 = a20 * a32 - a22 * a30;
    b08 = a20 * a33 - a23 * a30;
    b09 = a21 * a32 - a22 * a31;
    b10 = a21 * a33 - a23 * a31;
    b11 = a22 * a33 - a23 * a32;
    invDet = 1 / (b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06);
    m[0] = (a11 * b11 - a12 * b10 + a13 * b09) * invDet;
    m[1] = (-a01 * b11 + a02 * b10 - a03 * b09) * invDet;
    m[2] = (a31 * b05 - a32 * b04 + a33 * b03) * invDet;
    m[3] = (-a21 * b05 + a22 * b04 - a23 * b03) * invDet;
    m[4] = (-a10 * b11 + a12 * b08 - a13 * b07) * invDet;
    m[5] = (a00 * b11 - a02 * b08 + a03 * b07) * invDet;
    m[6] = (-a30 * b05 + a32 * b02 - a33 * b01) * invDet;
    m[7] = (a20 * b05 - a22 * b02 + a23 * b01) * invDet;
    m[8] = (a10 * b10 - a11 * b08 + a13 * b06) * invDet;
    m[9] = (-a00 * b10 + a01 * b08 - a03 * b06) * invDet;
    m[10] = (a30 * b04 - a31 * b02 + a33 * b00) * invDet;
    m[11] = (-a20 * b04 + a21 * b02 - a23 * b00) * invDet;
    m[12] = (-a10 * b09 + a11 * b07 - a12 * b06) * invDet;
    m[13] = (a00 * b09 - a01 * b07 + a02 * b06) * invDet;
    m[14] = (-a30 * b03 + a31 * b01 - a32 * b00) * invDet;
    m[15] = (a20 * b03 - a21 * b01 + a22 * b00) * invDet;
    return this
  }, setIdentity:function() {
    var m = this.data;
    m[0] = 1;
    m[1] = 0;
    m[2] = 0;
    m[3] = 0;
    m[4] = 0;
    m[5] = 1;
    m[6] = 0;
    m[7] = 0;
    m[8] = 0;
    m[9] = 0;
    m[10] = 1;
    m[11] = 0;
    m[12] = 0;
    m[13] = 0;
    m[14] = 0;
    m[15] = 1;
    return this
  }, setTRS:function(t, r, s) {
    var tx, ty, tz, qx, qy, qz, qw, sx, sy, sz, x2, y2, z2, xx, xy, xz, yy, yz, zz, wx, wy, wz, m;
    tx = t.x;
    ty = t.y;
    tz = t.z;
    qx = r.x;
    qy = r.y;
    qz = r.z;
    qw = r.w;
    sx = s.x;
    sy = s.y;
    sz = s.z;
    x2 = qx + qx;
    y2 = qy + qy;
    z2 = qz + qz;
    xx = qx * x2;
    xy = qx * y2;
    xz = qx * z2;
    yy = qy * y2;
    yz = qy * z2;
    zz = qz * z2;
    wx = qw * x2;
    wy = qw * y2;
    wz = qw * z2;
    m = this.data;
    m[0] = (1 - (yy + zz)) * sx;
    m[1] = (xy + wz) * sx;
    m[2] = (xz - wy) * sx;
    m[3] = 0;
    m[4] = (xy - wz) * sy;
    m[5] = (1 - (xx + zz)) * sy;
    m[6] = (yz + wx) * sy;
    m[7] = 0;
    m[8] = (xz + wy) * sz;
    m[9] = (yz - wx) * sz;
    m[10] = (1 - (xx + yy)) * sz;
    m[11] = 0;
    m[12] = tx;
    m[13] = ty;
    m[14] = tz;
    m[15] = 1;
    return this
  }, transpose:function() {
    var tmp, m = this.data;
    tmp = m[1];
    m[1] = m[4];
    m[4] = tmp;
    tmp = m[2];
    m[2] = m[8];
    m[8] = tmp;
    tmp = m[3];
    m[3] = m[12];
    m[12] = tmp;
    tmp = m[6];
    m[6] = m[9];
    m[9] = tmp;
    tmp = m[7];
    m[7] = m[13];
    m[13] = tmp;
    tmp = m[11];
    m[11] = m[14];
    m[14] = tmp;
    return this
  }, invertTo3x3:function(res) {
    var a11, a21, a31, a12, a22, a32, a13, a23, a33, m, r, det, idet;
    m = this.data;
    r = res.data;
    a11 = m[10] * m[5] - m[6] * m[9];
    a21 = -m[10] * m[1] + m[2] * m[9];
    a31 = m[6] * m[1] - m[2] * m[5];
    a12 = -m[10] * m[4] + m[6] * m[8];
    a22 = m[10] * m[0] - m[2] * m[8];
    a32 = -m[6] * m[0] + m[2] * m[4];
    a13 = m[9] * m[4] - m[5] * m[8];
    a23 = -m[9] * m[0] + m[1] * m[8];
    a33 = m[5] * m[0] - m[1] * m[4];
    det = m[0] * a11 + m[1] * a12 + m[2] * a13;
    if(det === 0) {
      console.warn("pc.Mat4#invertTo3x3: Matrix not invertible");
      return this
    }
    idet = 1 / det;
    r[0] = idet * a11;
    r[1] = idet * a21;
    r[2] = idet * a31;
    r[3] = idet * a12;
    r[4] = idet * a22;
    r[5] = idet * a32;
    r[6] = idet * a13;
    r[7] = idet * a23;
    r[8] = idet * a33;
    return this
  }, getTranslation:function(t) {
    t = t === undefined ? new pc.Vec3 : t;
    return t.set(this.data[12], this.data[13], this.data[14])
  }, getX:function(x) {
    x = x === undefined ? new pc.Vec3 : x;
    return x.set(this.data[0], this.data[1], this.data[2])
  }, getY:function(y) {
    y = y === undefined ? new pc.Vec3 : y;
    return y.set(this.data[4], this.data[5], this.data[6])
  }, getZ:function(z) {
    z = z === undefined ? new pc.Vec3 : z;
    return z.set(this.data[8], this.data[9], this.data[10])
  }, getScale:function() {
    var x, y, z;
    x = new pc.Vec3;
    y = new pc.Vec3;
    z = new pc.Vec3;
    return function(scale) {
      scale = scale === undefined ? new pc.Vec3 : scale;
      this.getX(x);
      this.getY(y);
      this.getZ(z);
      scale.set(x.length(), y.length(), z.length());
      return scale
    }
  }(), setFromEulerAngles:function(ex, ey, ez) {
    var s1, c1, s2, c2, s3, c3, m;
    ex *= pc.math.DEG_TO_RAD;
    ey *= pc.math.DEG_TO_RAD;
    ez *= pc.math.DEG_TO_RAD;
    s1 = Math.sin(-ex);
    c1 = Math.cos(-ex);
    s2 = Math.sin(-ey);
    c2 = Math.cos(-ey);
    s3 = Math.sin(-ez);
    c3 = Math.cos(-ez);
    m = this.data;
    m[0] = c2 * c3;
    m[1] = -c2 * s3;
    m[2] = s2;
    m[3] = 0;
    m[4] = c1 * s3 + c3 * s1 * s2;
    m[5] = c1 * c3 - s1 * s2 * s3;
    m[6] = -c2 * s1;
    m[7] = 0;
    m[8] = s1 * s3 - c1 * c3 * s2;
    m[9] = c3 * s1 + c1 * s2 * s3;
    m[10] = c1 * c2;
    m[11] = 0;
    m[12] = 0;
    m[13] = 0;
    m[14] = 0;
    m[15] = 1;
    return this
  }, getEulerAngles:function() {
    var scale = new pc.Vec3;
    return function(eulers) {
      var x, y, z, sx, sy, sz, m, halfPi;
      eulers = eulers === undefined ? new pc.Vec3 : eulers;
      this.getScale(scale);
      sx = scale.x;
      sy = scale.y;
      sz = scale.z;
      m = this.data;
      y = Math.asin(-m[2] / sx);
      halfPi = Math.PI * 0.5;
      if(y < halfPi) {
        if(y > -halfPi) {
          x = Math.atan2(m[6] / sy, m[10] / sz);
          z = Math.atan2(m[1] / sx, m[0] / sx)
        }else {
          z = 0;
          x = -Math.atan2(m[4] / sy, m[5] / sy)
        }
      }else {
        z = 0;
        x = Math.atan2(m[4] / sy, m[5] / sy)
      }
      return eulers.set(x, y, z).scale(pc.math.RAD_TO_DEG)
    }
  }(), toString:function() {
    var i, t;
    t = "[";
    for(i = 0;i < 16;i += 1) {
      t += this.data[i];
      t += i !== 15 ? ", " : ""
    }
    t += "]";
    return t
  }};
  Object.defineProperty(Mat4, "IDENTITY", {get:function() {
    var identity = new Mat4;
    return function() {
      return identity
    }
  }()});
  Object.defineProperty(Mat4, "ZERO", {get:function() {
    var zero = new Mat4(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
    return function() {
      return zero
    }
  }()});
  return{Mat4:Mat4}
}());
pc.extend(pc, function() {
  var Quat = function(x, y, z, w) {
    this.x = x === undefined ? 0 : x;
    this.y = y === undefined ? 0 : y;
    this.z = z === undefined ? 0 : z;
    this.w = w === undefined ? 1 : w
  };
  Quat.prototype = {clone:function() {
    return new pc.Quat(this.x, this.y, this.z, this.w)
  }, conjugate:function() {
    this.x *= -1;
    this.y *= -1;
    this.z *= -1;
    return this
  }, copy:function(rhs) {
    this.x = rhs.x;
    this.y = rhs.y;
    this.z = rhs.z;
    this.w = rhs.w;
    return this
  }, equals:function(that) {
    return this.x === that.x && this.y === that.y && this.z === that.z && this.w === that.w
  }, getEulerAngles:function(eulers) {
    var x, y, z, qx, qy, qz, qw, a2;
    eulers = eulers === undefined ? new pc.Vec3 : eulers;
    qx = this.x;
    qy = this.y;
    qz = this.z;
    qw = this.w;
    a2 = 2 * (qw * qy - qx * qz);
    if(a2 <= -0.99999) {
      x = 2 * Math.atan2(qx, qw);
      y = -Math.PI / 2;
      z = 0
    }else {
      if(a2 >= 0.99999) {
        x = 2 * Math.atan2(qx, qw);
        y = Math.PI / 2;
        z = 0
      }else {
        x = Math.atan2(2 * (qw * qx + qy * qz), 1 - 2 * (qx * qx + qy * qy));
        y = Math.asin(a2);
        z = Math.atan2(2 * (qw * qz + qx * qy), 1 - 2 * (qy * qy + qz * qz))
      }
    }
    return eulers.set(x, y, z).scale(pc.math.RAD_TO_DEG)
  }, invert:function() {
    return this.conjugate().normalize()
  }, length:function() {
    var x, y, z, w;
    x = this.x;
    y = this.y;
    z = this.z;
    w = this.w;
    return Math.sqrt(x * x + y * y + z * z + w * w)
  }, lengthSq:function() {
    var v = this.data;
    return v[0] * v[0] + v[1] * v[1] + v[2] * v[2]
  }, mul:function(rhs) {
    var q1x, q1y, q1z, q1w, q2x, q2y, q2z, q2w;
    q1x = this.x;
    q1y = this.y;
    q1z = this.z;
    q1w = this.w;
    q2x = rhs.x;
    q2y = rhs.y;
    q2z = rhs.z;
    q2w = rhs.w;
    this.x = q1w * q2x + q1x * q2w + q1y * q2z - q1z * q2y;
    this.y = q1w * q2y + q1y * q2w + q1z * q2x - q1x * q2z;
    this.z = q1w * q2z + q1z * q2w + q1x * q2y - q1y * q2x;
    this.w = q1w * q2w - q1x * q2x - q1y * q2y - q1z * q2z;
    return this
  }, mul2:function(lhs, rhs) {
    var q1x, q1y, q1z, q1w, q2x, q2y, q2z, q2w;
    q1x = lhs.x;
    q1y = lhs.y;
    q1z = lhs.z;
    q1w = lhs.w;
    q2x = rhs.x;
    q2y = rhs.y;
    q2z = rhs.z;
    q2w = rhs.w;
    this.x = q1w * q2x + q1x * q2w + q1y * q2z - q1z * q2y;
    this.y = q1w * q2y + q1y * q2w + q1z * q2x - q1x * q2z;
    this.z = q1w * q2z + q1z * q2w + q1x * q2y - q1y * q2x;
    this.w = q1w * q2w - q1x * q2x - q1y * q2y - q1z * q2z;
    return this
  }, normalize:function() {
    var len = this.length();
    if(len === 0) {
      this.x = this.y = this.z = 0;
      this.w = 1
    }else {
      len = 1 / len;
      this.x *= len;
      this.y *= len;
      this.z *= len;
      this.w *= len
    }
    return this
  }, set:function(x, y, z, w) {
    this.x = x;
    this.y = y;
    this.z = z;
    this.w = w;
    return this
  }, setFromAxisAngle:function(axis, angle) {
    var sa, ca;
    angle *= 0.5 * pc.math.DEG_TO_RAD;
    sa = Math.sin(angle);
    ca = Math.cos(angle);
    this.x = sa * axis.x;
    this.y = sa * axis.y;
    this.z = sa * axis.z;
    this.w = ca;
    return this
  }, setFromEulerAngles:function(ex, ey, ez) {
    var sx, cx, sy, cy, sz, cz, halfToRad;
    halfToRad = 0.5 * pc.math.DEG_TO_RAD;
    ex *= halfToRad;
    ey *= halfToRad;
    ez *= halfToRad;
    sx = Math.sin(ex);
    cx = Math.cos(ex);
    sy = Math.sin(ey);
    cy = Math.cos(ey);
    sz = Math.sin(ez);
    cz = Math.cos(ez);
    this.x = sx * cy * cz - cx * sy * sz;
    this.y = cx * sy * cz + sx * cy * sz;
    this.z = cx * cy * sz - sx * sy * cz;
    this.w = cx * cy * cz + sx * sy * sz;
    return this
  }, setFromMat4:function(m) {
    var m00, m01, m02, m10, m11, m12, m20, m21, m22, tr, s, rs, lx, ly, lz;
    m = m.data;
    m00 = m[0];
    m01 = m[1];
    m02 = m[2];
    m10 = m[4];
    m11 = m[5];
    m12 = m[6];
    m20 = m[8];
    m21 = m[9];
    m22 = m[10];
    lx = 1 / Math.sqrt(m00 * m00 + m01 * m01 + m02 * m02);
    ly = 1 / Math.sqrt(m10 * m10 + m11 * m11 + m12 * m12);
    lz = 1 / Math.sqrt(m20 * m20 + m21 * m21 + m22 * m22);
    m00 *= lx;
    m01 *= lx;
    m02 *= lx;
    m10 *= ly;
    m11 *= ly;
    m12 *= ly;
    m20 *= lz;
    m21 *= lz;
    m22 *= lz;
    tr = m00 + m11 + m22;
    if(tr >= 0) {
      s = Math.sqrt(tr + 1);
      this.w = s * 0.5;
      s = 0.5 / s;
      this.x = (m12 - m21) * s;
      this.y = (m20 - m02) * s;
      this.z = (m01 - m10) * s
    }else {
      if(m00 > m11) {
        if(m00 > m22) {
          rs = m00 - (m11 + m22) + 1;
          rs = Math.sqrt(rs);
          this.x = rs * 0.5;
          rs = 0.5 / rs;
          this.w = (m12 - m21) * rs;
          this.y = (m01 + m10) * rs;
          this.z = (m02 + m20) * rs
        }else {
          rs = m22 - (m00 + m11) + 1;
          rs = Math.sqrt(rs);
          this.z = rs * 0.5;
          rs = 0.5 / rs;
          this.w = (m01 - m10) * rs;
          this.x = (m20 + m02) * rs;
          this.y = (m21 + m12) * rs
        }
      }else {
        if(m11 > m22) {
          rs = m11 - (m22 + m00) + 1;
          rs = Math.sqrt(rs);
          this.y = rs * 0.5;
          rs = 0.5 / rs;
          this.w = (m20 - m02) * rs;
          this.z = (m12 + m21) * rs;
          this.x = (m10 + m01) * rs
        }else {
          rs = m22 - (m00 + m11) + 1;
          rs = Math.sqrt(rs);
          this.z = rs * 0.5;
          rs = 0.5 / rs;
          this.w = (m01 - m10) * rs;
          this.x = (m20 + m02) * rs;
          this.y = (m21 + m12) * rs
        }
      }
    }
    return this
  }, slerp:function(lhs, rhs, alpha) {
    var lx, ly, lz, lw, rx, ry, rz, rw;
    lx = lhs.x;
    ly = lhs.y;
    lz = lhs.z;
    lw = lhs.w;
    rx = rhs.x;
    ry = rhs.y;
    rz = rhs.z;
    rw = rhs.w;
    var cosHalfTheta = lw * rw + lx * rx + ly * ry + lz * rz;
    if(cosHalfTheta < 0) {
      rw = -rw;
      rx = -rx;
      ry = -ry;
      rz = -rz;
      cosHalfTheta = -cosHalfTheta
    }
    if(Math.abs(cosHalfTheta) >= 1) {
      this.w = lw;
      this.x = lx;
      this.y = ly;
      this.z = lz;
      return this
    }
    var halfTheta = Math.acos(cosHalfTheta);
    var sinHalfTheta = Math.sqrt(1 - cosHalfTheta * cosHalfTheta);
    if(Math.abs(sinHalfTheta) < 0.001) {
      this.w = lw * 0.5 + rw * 0.5;
      this.x = lx * 0.5 + rx * 0.5;
      this.y = ly * 0.5 + ry * 0.5;
      this.z = lz * 0.5 + rz * 0.5;
      return this
    }
    var ratioA = Math.sin((1 - alpha) * halfTheta) / sinHalfTheta;
    var ratioB = Math.sin(alpha * halfTheta) / sinHalfTheta;
    this.w = lw * ratioA + rw * ratioB;
    this.x = lx * ratioA + rx * ratioB;
    this.y = ly * ratioA + ry * ratioB;
    this.z = lz * ratioA + rz * ratioB;
    return this
  }, transformVector:function(vec, res) {
    if(res === undefined) {
      res = new pc.Vec3
    }
    var x = vec.x, y = vec.y, z = vec.z;
    var qx = this.x, qy = this.y, qz = this.z, qw = this.w;
    var ix = qw * x + qy * z - qz * y;
    var iy = qw * y + qz * x - qx * z;
    var iz = qw * z + qx * y - qy * x;
    var iw = -qx * x - qy * y - qz * z;
    res.x = ix * qw + iw * -qx + iy * -qz - iz * -qy;
    res.y = iy * qw + iw * -qy + iz * -qx - ix * -qz;
    res.z = iz * qw + iw * -qz + ix * -qy - iy * -qx;
    return res
  }, toString:function() {
    return"[" + this.x + ", " + this.y + ", " + this.z + ", " + this.w + "]"
  }};
  Object.defineProperty(Quat, "IDENTITY", {get:function() {
    var identity = new Quat;
    return function() {
      return identity
    }
  }()});
  Object.defineProperty(Quat, "ZERO", {get:function() {
    var zero = new Quat(0, 0, 0, 0);
    return function() {
      return zero
    }
  }()});
  return{Quat:Quat}
}());
pc.extend(pc, function() {
  var CURVE_LINEAR = 0;
  var CURVE_SMOOTHSTEP = 1;
  var CURVE_CATMULL = 2;
  var CURVE_CARDINAL = 3;
  var Curve = function(data) {
    this.keys = [];
    this.type = CURVE_SMOOTHSTEP;
    this.tension = 0.5;
    if(data) {
      for(var i = 0;i < data.length - 1;i += 2) {
        this.keys.push([data[i], data[i + 1]])
      }
    }
    this.sort()
  };
  Curve.prototype = {add:function(time, value) {
    var keys = this.keys;
    var len = keys.length;
    var i = 0;
    for(;i < len;i++) {
      if(keys[i][0] > time) {
        break
      }
    }
    var key = [time, value];
    this.keys.splice(i, 0, key);
    return key
  }, get:function(index) {
    return this.keys[index]
  }, sort:function() {
    this.keys.sort(function(a, b) {
      return a[0] - b[0]
    })
  }, value:function(time) {
    var keys = this.keys;
    if(!keys.length) {
      return 0
    }
    if(time < keys[0][0]) {
      return keys[0][1]
    }else {
      if(time > keys[keys.length - 1][0]) {
        return keys[keys.length - 1][1]
      }
    }
    var leftTime = 0;
    var leftValue = keys.length ? keys[0][1] : 0;
    var rightTime = 1;
    var rightValue = 0;
    for(var i = 0, len = keys.length;i < len;i++) {
      if(keys[i][0] === time) {
        return keys[i][1]
      }
      rightValue = keys[i][1];
      if(time < keys[i][0]) {
        rightTime = keys[i][0];
        break
      }
      leftTime = keys[i][0];
      leftValue = keys[i][1]
    }
    var div = rightTime - leftTime;
    var interpolation = div === 0 ? 0 : (time - leftTime) / div;
    if(this.type === CURVE_SMOOTHSTEP) {
      interpolation *= interpolation * (3 - 2 * interpolation)
    }else {
      if(this.type === CURVE_CATMULL || this.type === CURVE_CARDINAL) {
        var p1 = leftValue;
        var p2 = rightValue;
        var p0 = p1 + (p1 - p2);
        var p3 = p2 + (p2 - p1);
        var dt1 = rightTime - leftTime;
        var dt0 = dt1;
        var dt2 = dt1;
        if(i > 0) {
          i = i - 1
        }
        if(i > 0) {
          p0 = keys[i - 1][1];
          dt0 = keys[i][0] - keys[i - 1][0]
        }
        if(keys.length > i + 1) {
          dt1 = keys[i + 1][0] - keys[i][0]
        }
        if(keys.length > i + 2) {
          dt2 = keys[i + 2][0] - keys[i + 1][0];
          p3 = keys[i + 2][1]
        }
        p0 = p1 + (p0 - p1) * dt1 / dt0;
        p3 = p2 + (p3 - p2) * dt1 / dt2;
        if(this.type === CURVE_CATMULL) {
          return this._interpolateCatmullRom(p0, p1, p2, p3, interpolation)
        }else {
          return this._interpolateCardinal(p0, p1, p2, p3, interpolation, this.tension)
        }
      }
    }
    return pc.math.lerp(leftValue, rightValue, interpolation)
  }, _interpolateHermite:function(p0, p1, t0, t1, s) {
    var s2 = s * s;
    var s3 = s * s * s;
    var h0 = 2 * s3 - 3 * s2 + 1;
    var h1 = -2 * s3 + 3 * s2;
    var h2 = s3 - 2 * s2 + s;
    var h3 = s3 - s2;
    return p0 * h0 + p1 * h1 + t0 * h2 + t1 * h3
  }, _interpolateCardinal:function(p0, p1, p2, p3, s, t) {
    var t0 = t * (p2 - p0);
    var t1 = t * (p3 - p1);
    return this._interpolateHermite(p1, p2, t0, t1, s)
  }, _interpolateCatmullRom:function(p0, p1, p2, p3, s) {
    return this._interpolateCardinal(p0, p1, p2, p3, s, 0.5)
  }, closest:function(time) {
    var keys = this.keys;
    var length = keys.length;
    var min = 2;
    var result = null;
    for(var i = 0;i < length;i++) {
      var diff = Math.abs(time - keys[i][0]);
      if(min >= diff) {
        min = diff;
        result = keys[i]
      }else {
        break
      }
    }
    return result
  }, clone:function() {
    var result = new pc.Curve;
    result.keys = pc.extend(result.keys, this.keys);
    result.type = this.type;
    return result
  }, quantize:function(precision) {
    precision = Math.max(precision, 2);
    var values = new Float32Array(precision);
    var step = 1 / (precision - 1);
    for(var i = 0;i < precision;i++) {
      var value = this.value(step * i);
      values[i] = value
    }
    return values
  }};
  Object.defineProperty(Curve.prototype, "length", {get:function() {
    return this.keys.length
  }});
  return{Curve:Curve, CURVE_LINEAR:CURVE_LINEAR, CURVE_SMOOTHSTEP:CURVE_SMOOTHSTEP, CURVE_CATMULL:CURVE_CATMULL, CURVE_CARDINAL:CURVE_CARDINAL}
}());
pc.extend(pc, function() {
  var CurveSet = function() {
    var i;
    this.curves = [];
    this._type = pc.CURVE_SMOOTHSTEP;
    if(arguments.length > 1) {
      for(i = 0;i < arguments.length;i++) {
        this.curves.push(new pc.Curve(arguments[i]))
      }
    }else {
      if(arguments.length === 0) {
        this.curves.push(new pc.Curve)
      }else {
        var arg = arguments[0];
        if(pc.type(arg) === "number") {
          for(i = 0;i < arg;i++) {
            this.curves.push(new pc.Curve)
          }
        }else {
          for(i = 0;i < arg.length;i++) {
            this.curves.push(new pc.Curve(arg[i]))
          }
        }
      }
    }
  };
  CurveSet.prototype = {get:function(index) {
    return this.curves[index]
  }, value:function(time, result) {
    var length = this.curves.length;
    result = result || [];
    result.length = length;
    for(var i = 0;i < length;i++) {
      result[i] = this.curves[i].value(time)
    }
    return result
  }, clone:function() {
    var result = new pc.CurveSet;
    result.curves = [];
    for(var i = 0;i < this.curves.length;i++) {
      result.curves.push(this.curves[i].clone())
    }
    result._type = this._type;
    return result
  }, quantize:function(precision) {
    precision = Math.max(precision, 2);
    var numCurves = this.curves.length;
    var values = new Float32Array(precision * numCurves);
    var step = 1 / (precision - 1);
    var temp = [];
    for(var i = 0;i < precision;i++) {
      var value = this.value(step * i, temp);
      if(numCurves == 1) {
        values[i] = value[0]
      }else {
        for(var j = 0;j < numCurves;j++) {
          values[i * numCurves + j] = value[j]
        }
      }
    }
    return values
  }};
  Object.defineProperty(CurveSet.prototype, "length", {get:function() {
    return this.curves.length
  }});
  Object.defineProperty(CurveSet.prototype, "type", {get:function() {
    return this._type
  }, set:function(value) {
    this._type = value;
    for(var i = 0;i < this.curves.length;i++) {
      this.curves[i].type = value
    }
  }});
  return{CurveSet:CurveSet}
}());
pc.shape = function() {
  var Shape = function Shape() {
  };
  Shape.prototype = {containsPoint:function(point) {
    throw new Error("Shape hasn't implemented containsPoint");
  }};
  return{Shape:Shape, Type:{CAPSULE:"Capsule", CONE:"Cone", CYLINDER:"Cylinder", CIRCLE:"Circle", RECT:"Rect"}}
}();
pc.shape.intersection = function() {
  return{aabbAabb:function(a, b) {
    var aMax = a.getMax();
    var aMin = a.getMin();
    var bMax = b.getMax();
    var bMin = b.getMin();
    return aMin[0] <= bMax[0] && aMax[0] >= bMin[0] && aMin[1] <= bMax[1] && aMax[1] >= bMin[1] && aMin[2] <= bMax[2] && aMax[2] >= bMin[2]
  }, rayAabb:function(rayOrigin, rayDir, aabb) {
    var diff = new pc.Vec3, absDiff, absDir, cross = new pc.Vec3, prod = new pc.Vec3, i;
    diff.sub2(rayOrigin, aabb.center);
    absDiff = new pc.Vec3(Math.abs(diff.x), Math.abs(diff.y), Math.abs(diff.z));
    prod.mul2(diff, rayDir);
    if(absDiff.x > aabb.halfExtents.x && prod.x >= 0) {
      return false
    }
    if(absDiff.y > aabb.halfExtents.y && prod.y >= 0) {
      return false
    }
    if(absDiff.z > aabb.halfExtents.z && prod.z >= 0) {
      return false
    }
    absDir = new pc.Vec3(Math.abs(rayDir.x), Math.abs(rayDir.y), Math.abs(rayDir.z));
    cross.cross(rayDir, diff);
    cross.set(Math.abs(cross.x), Math.abs(cross.y), Math.abs(cross.z));
    if(cross.x > aabb.halfExtents.y * absDir.z + aabb.halfExtents.z * absDir.y) {
      return false
    }
    if(cross.y > aabb.halfExtents.x * absDir.z + aabb.halfExtents.z * absDir.x) {
      return false
    }
    if(cross.z > aabb.halfExtents.x * absDir.y + aabb.halfExtents.y * absDir.x) {
      return false
    }
    return true
  }, raySphere:function(rayOrigin, rayDir, sphere, result) {
    var diff = new pc.Vec3;
    var a = 0;
    var b = 0;
    var c = 0;
    var discr = 0;
    result = result || {};
    diff.sub2(rayOrigin, sphere.center);
    if(diff.dot(diff) < sphere.radius * sphere.radius) {
      result.success = true;
      result.t = 0;
      return true
    }
    a = rayDir.dot(rayDir);
    b = 2 * rayDir.dot(diff);
    c = sphere.center.dot(sphere.center);
    c += rayOrigin.dot(rayOrigin);
    c -= 2 * sphere.center.dot(rayOrigin);
    c -= sphere.radius * sphere.radius;
    discr = b * b - 4 * a * c;
    if(discr < 0) {
      result.success = false;
      result.t = 0;
      return false
    }
    result.success = true;
    result.t = (-b - Math.sqrt(discr)) / (2 * a);
    return true
  }, rayTriangle:function(rayOrigin, rayDir, t, intersection) {
    var w0 = rayOrigin.clone().sub(t.v0);
    var a = -t.n.dot(w0);
    var b = t.n.dot(rayDir);
    if(Math.fabs(b) < 1E-8) {
      if(a === 0) {
        return 2
      }else {
        return 0
      }
    }
    var r = a / b;
    if(r < 0) {
      return 0
    }
    var fromOrigin = rayDir.clone().scale(r);
    intersection.add2(rayOrigin, fromOrigin);
    var w = (new pc.Vec3).sub2(intersection, t.v0);
    var wu = w.dot(t.u);
    var wv = w.dot(t.v);
    var s = (t.uv * wv - t.vv * wu) / t.d;
    if(s < 0 || s > 1) {
      return 0
    }
    var t = (t.uv * wu - t.uu * wv) / t.d;
    if(t < 0 || s + t > 1) {
      return 0
    }
    return 1
  }}
}();
pc.extend(pc.shape, function() {
  pc.shape.Type.AABB = "Aabb";
  var Aabb = function Aabb(center, halfExtents) {
    this.center = center || new pc.Vec3(0, 0, 0);
    this.halfExtents = halfExtents || new pc.Vec3(0.5, 0.5, 0.5);
    this.type = pc.shape.Type.AABB
  };
  Aabb = pc.inherits(Aabb, pc.shape.Shape);
  Aabb.prototype.add = function(other) {
    var tc = this.center;
    var th = this.halfExtents;
    var tminx = tc.x - th.x;
    var tmaxx = tc.x + th.x;
    var tminy = tc.y - th.y;
    var tmaxy = tc.y + th.y;
    var tminz = tc.z - th.z;
    var tmaxz = tc.z + th.z;
    var oc = other.center;
    var oh = other.halfExtents;
    var ominx = oc.x - oh.x;
    var omaxx = oc.x + oh.x;
    var ominy = oc.y - oh.y;
    var omaxy = oc.y + oh.y;
    var ominz = oc.z - oh.z;
    var omaxz = oc.z + oh.z;
    if(ominx < tminx) {
      tminx = ominx
    }
    if(omaxx > tmaxx) {
      tmaxx = omaxx
    }
    if(ominy < tminy) {
      tminy = ominy
    }
    if(omaxy > tmaxy) {
      tmaxy = omaxy
    }
    if(ominz < tminz) {
      tminz = ominz
    }
    if(omaxz > tmaxz) {
      tmaxz = omaxz
    }
    tc.set(tminx + tmaxx, tminy + tmaxy, tminz + tmaxz).scale(0.5);
    th.set(tmaxx - tminx, tmaxy - tminy, tmaxz - tminz).scale(0.5)
  };
  Aabb.prototype.copy = function(src) {
    this.center.copy(src.center);
    this.halfExtents.copy(src.halfExtents);
    this.type = src.type
  };
  Aabb.prototype.setMinMax = function(min, max) {
    this.center.add2(max, min).scale(0.5);
    this.halfExtents.sub2(max, min).scale(0.5)
  };
  Aabb.prototype.getMin = function() {
    return this.center.clone().sub(this.halfExtents)
  };
  Aabb.prototype.getMax = function() {
    return this.center.clone().add(this.halfExtents)
  };
  Aabb.prototype.containsPoint = function(point) {
    var min = this.getMin(), max = this.getMax(), i;
    for(i = 0;i < 3;++i) {
      if(point.data[i] < min.data[i] || point.data[i] > max.data[i]) {
        return false
      }
    }
    return true
  };
  Aabb.prototype.setFromTransformedAabb = function(aabb, m) {
    var bc = this.center;
    var br = this.halfExtents;
    var ac = aabb.center.data;
    var ar = aabb.halfExtents.data;
    m = m.data;
    var mx0 = m[0];
    var mx1 = m[4];
    var mx2 = m[8];
    var my0 = m[1];
    var my1 = m[5];
    var my2 = m[9];
    var mz0 = m[2];
    var mz1 = m[6];
    var mz2 = m[10];
    var mx0a = Math.abs(mx0);
    var mx1a = Math.abs(mx1);
    var mx2a = Math.abs(mx2);
    var my0a = Math.abs(my0);
    var my1a = Math.abs(my1);
    var my2a = Math.abs(my2);
    var mz0a = Math.abs(mz0);
    var mz1a = Math.abs(mz1);
    var mz2a = Math.abs(mz2);
    bc.set(m[12] + mx0 * ac[0] + mx1 * ac[1] + mx2 * ac[2], m[13] + my0 * ac[0] + my1 * ac[1] + my2 * ac[2], m[14] + mz0 * ac[0] + mz1 * ac[1] + mz2 * ac[2]);
    br.set(mx0a * ar[0] + mx1a * ar[1] + mx2a * ar[2], my0a * ar[0] + my1a * ar[1] + my2a * ar[2], mz0a * ar[0] + mz1a * ar[1] + mz2a * ar[2])
  };
  Aabb.prototype.compute = function(vertices) {
    var min = new pc.Vec3(vertices[0], vertices[1], vertices[2]);
    var max = new pc.Vec3(vertices[0], vertices[1], vertices[2]);
    var numVerts = vertices.length / 3;
    for(var i = 1;i < numVerts;i++) {
      var x = vertices[i * 3 + 0];
      var y = vertices[i * 3 + 1];
      var z = vertices[i * 3 + 2];
      if(x < min.x) {
        min.x = x
      }
      if(y < min.y) {
        min.y = y
      }
      if(z < min.z) {
        min.z = z
      }
      if(x > max.x) {
        max.x = x
      }
      if(y > max.y) {
        max.y = y
      }
      if(z > max.z) {
        max.z = z
      }
    }
    this.setMinMax(min, max)
  };
  return{Aabb:Aabb}
}());
pc.extend(pc.shape, function() {
  pc.shape.Type.BOX = "Box";
  var center = new pc.Vec3;
  var p = new pc.Vec3;
  var t = new pc.Mat4;
  var scale = new pc.Mat4;
  function Box(transform, halfExtents) {
    this.transform = transform === undefined ? new pc.Mat4 : transform;
    this.halfExtents = halfExtents === undefined ? new pc.Vec3(0.5, 0.5, 0.5) : halfExtents;
    this.type = pc.shape.Type.BOX
  }
  Box = pc.inherits(Box, pc.shape.Shape);
  Box.prototype.containsPoint = function(point) {
    this.transform.getTranslation(center);
    var extents = this.getHalfExtents();
    t.copy(this.transform);
    p.copy(extents).scale(2);
    scale.setTRS(pc.Vec3.ZERO, pc.Quat.IDENTITY, p);
    t.mul(scale).invert();
    t.transformPoint(point, p);
    var min = -0.5;
    var max = 0.5;
    if(p.x < min || p.x > max) {
      return false
    }else {
      if(p.y < min || p.y > max) {
        return false
      }else {
        if(p.z < min || p.z > max) {
          return false
        }
      }
    }
    return true
  };
  Box.prototype.getHalfExtents = function() {
    return this.halfExtents
  };
  return{Box:Box}
}());
pc.extend(pc, function() {
  var viewProj = new pc.Mat4;
  var Frustum = function Frustum(projectionMatrix, viewMatrix) {
    projectionMatrix = projectionMatrix || (new pc.Mat4).setPerspective(90, 16 / 9, 0.1, 1E3);
    viewMatrix = viewMatrix || new pc.Mat4;
    this.planes = [];
    for(var i = 0;i < 6;i++) {
      this.planes[i] = []
    }
    this.update(projectionMatrix, viewMatrix)
  };
  Frustum.prototype = {update:function(projectionMatrix, viewMatrix) {
    viewProj.mul2(projectionMatrix, viewMatrix);
    var vpm = viewProj.data;
    this.planes[0][0] = vpm[3] - vpm[0];
    this.planes[0][1] = vpm[7] - vpm[4];
    this.planes[0][2] = vpm[11] - vpm[8];
    this.planes[0][3] = vpm[15] - vpm[12];
    t = Math.sqrt(this.planes[0][0] * this.planes[0][0] + this.planes[0][1] * this.planes[0][1] + this.planes[0][2] * this.planes[0][2]);
    this.planes[0][0] /= t;
    this.planes[0][1] /= t;
    this.planes[0][2] /= t;
    this.planes[0][3] /= t;
    this.planes[1][0] = vpm[3] + vpm[0];
    this.planes[1][1] = vpm[7] + vpm[4];
    this.planes[1][2] = vpm[11] + vpm[8];
    this.planes[1][3] = vpm[15] + vpm[12];
    t = Math.sqrt(this.planes[1][0] * this.planes[1][0] + this.planes[1][1] * this.planes[1][1] + this.planes[1][2] * this.planes[1][2]);
    this.planes[1][0] /= t;
    this.planes[1][1] /= t;
    this.planes[1][2] /= t;
    this.planes[1][3] /= t;
    this.planes[2][0] = vpm[3] + vpm[1];
    this.planes[2][1] = vpm[7] + vpm[5];
    this.planes[2][2] = vpm[11] + vpm[9];
    this.planes[2][3] = vpm[15] + vpm[13];
    t = Math.sqrt(this.planes[2][0] * this.planes[2][0] + this.planes[2][1] * this.planes[2][1] + this.planes[2][2] * this.planes[2][2]);
    this.planes[2][0] /= t;
    this.planes[2][1] /= t;
    this.planes[2][2] /= t;
    this.planes[2][3] /= t;
    this.planes[3][0] = vpm[3] - vpm[1];
    this.planes[3][1] = vpm[7] - vpm[5];
    this.planes[3][2] = vpm[11] - vpm[9];
    this.planes[3][3] = vpm[15] - vpm[13];
    t = Math.sqrt(this.planes[3][0] * this.planes[3][0] + this.planes[3][1] * this.planes[3][1] + this.planes[3][2] * this.planes[3][2]);
    this.planes[3][0] /= t;
    this.planes[3][1] /= t;
    this.planes[3][2] /= t;
    this.planes[3][3] /= t;
    this.planes[4][0] = vpm[3] - vpm[2];
    this.planes[4][1] = vpm[7] - vpm[6];
    this.planes[4][2] = vpm[11] - vpm[10];
    this.planes[4][3] = vpm[15] - vpm[14];
    t = Math.sqrt(this.planes[4][0] * this.planes[4][0] + this.planes[4][1] * this.planes[4][1] + this.planes[4][2] * this.planes[4][2]);
    this.planes[4][0] /= t;
    this.planes[4][1] /= t;
    this.planes[4][2] /= t;
    this.planes[4][3] /= t;
    this.planes[5][0] = vpm[3] + vpm[2];
    this.planes[5][1] = vpm[7] + vpm[6];
    this.planes[5][2] = vpm[11] + vpm[10];
    this.planes[5][3] = vpm[15] + vpm[14];
    t = Math.sqrt(this.planes[5][0] * this.planes[5][0] + this.planes[5][1] * this.planes[5][1] + this.planes[5][2] * this.planes[5][2]);
    this.planes[5][0] /= t;
    this.planes[5][1] /= t;
    this.planes[5][2] /= t;
    this.planes[5][3] /= t
  }, containsPoint:function(point) {
    for(var p = 0;p < 6;p++) {
      if(this.planes[p][0] * point.x + this.planes[p][1] * point.y + this.planes[p][2] * point.z + this.planes[p][3] <= 0) {
        return false
      }
    }
    return true
  }, containsSphere:function(sphere) {
    var c = 0;
    var d;
    for(p = 0;p < 6;p++) {
      d = this.planes[p][0] * sphere.center.x + this.planes[p][1] * sphere.center.y + this.planes[p][2] * sphere.center.z + this.planes[p][3];
      if(d <= -sphere.radius) {
        return 0
      }
      if(d > sphere.radius) {
        c++
      }
    }
    return c === 6 ? 2 : 1
  }};
  return{Frustum:Frustum}
}());
pc.extend(pc.shape, function() {
  pc.shape.Type.PLANE = "Plane";
  var Plane = function Plane(point, normal) {
    this.normal = normal || new pc.Vec3(0, 0, 1);
    this.point = point || new pc.Vec3(0, 0, 0);
    this.d = -this.normal.dot(this.point);
    this.type = pc.shape.Type.PLANE
  };
  Plane = pc.inherits(Plane, pc.shape.Shape);
  Plane.prototype.containsPoint = function(point) {
    return false
  };
  Plane.prototype.distance = function(pos) {
    return this.normal.dot(pos) + this.d
  };
  Plane.prototype.intersect = function(p0, p1) {
    var d0 = this.distance(p0);
    var d1 = this.distance(p1);
    return d0 / (d0 - d1)
  };
  Plane.prototype.intersectPosition = function(p0, p1) {
    var t = this.intersect(p0, p1);
    var r = new pc.Vec3;
    r.lerp(p0, p1, t);
    return r
  };
  return{Plane:Plane}
}());
pc.extend(pc.shape, function() {
  pc.shape.Type.SPHERE = "Sphere";
  function Sphere(center, radius) {
    this.center = center === undefined ? new pc.Vec3(0, 0, 0) : center;
    this.radius = radius === undefined ? 1 : radius;
    this.type = pc.shape.Type.SPHERE
  }
  Sphere = pc.inherits(Sphere, pc.shape.Shape);
  Sphere.prototype.containsPoint = function() {
    var centerToPoint = new pc.Vec3;
    return function(point) {
      var lenSq = centerToPoint.sub2(point, this.center).lengthSq();
      var r = this.radius;
      return lenSq < r * r
    }
  }();
  Sphere.prototype.compute = function(vertices) {
    var i;
    var numVerts = vertices.length / 3;
    var vertex = new pc.Vec3(0, 0, 0);
    var avgVertex = new pc.Vec3(0, 0, 0);
    var sum = new pc.Vec3(0, 0, 0);
    for(i = 0;i < numVerts;i++) {
      vertex.set(vertices[i * 3], vertices[i * 3 + 1], vertices[i * 3 + 2]);
      sum.addSelf(vertex);
      if(i % 100 === 0) {
        sum.scale(1 / numVerts);
        avgVertex.add(sum);
        sum.set(0, 0, 0)
      }
    }
    sum.scale(1 / numVerts);
    avgVertex.add(sum);
    this.center.copy(avgVertex);
    var maxDistSq = 0;
    var centerToVert = new pc.Vec3(0, 0, 0);
    for(i = 0;i < numVerts;i++) {
      vertex.set(vertices[i * 3], vertices[i * 3 + 1], vertices[i * 3 + 2]);
      centerToVert.sub2(vertex, this.center);
      maxDistSq = Math.max(centerToVert.lengthSq(), maxDistSq)
    }
    this.radius = Math.sqrt(maxDistSq)
  };
  Sphere.prototype.intersectRay = function(start, direction) {
    var m = start.clone().sub(this.center);
    var b = m.dot(direction);
    var c = m.dot(m) - this.radius * this.radius;
    if(c > 0 && b > 0) {
      return null
    }
    var discr = b * b - c;
    if(discr < 0) {
      return null
    }
    t = Math.abs(-b - Math.sqrt(discr));
    return direction.clone().scale(t).add(start)
  };
  return{Sphere:Sphere}
}());
pc.extend(pc.shape, function() {
  pc.shape.Type.TORUS = "Torus";
  var Torus = function Torus(transform, iradius, oradius) {
    this.transform = transform;
    this.iradius = iradius;
    this.oradius = oradius;
    this.type = pc.shape.Type.TORUS
  };
  Torus = pc.inherits(Torus, pc.shape.Shape);
  Torus.prototype.containsPoint = function(point) {
    throw new Error("Not implemented yet");
  };
  return{Torus:Torus}
}());
(function() {
  var enums = {ADDRESS_REPEAT:0, ADDRESS_CLAMP_TO_EDGE:1, ADDRESS_MIRRORED_REPEAT:2, BLENDMODE_ZERO:0, BLENDMODE_ONE:1, BLENDMODE_SRC_COLOR:2, BLENDMODE_ONE_MINUS_SRC_COLOR:3, BLENDMODE_DST_COLOR:4, BLENDMODE_ONE_MINUS_DST_COLOR:5, BLENDMODE_SRC_ALPHA:6, BLENDMODE_SRC_ALPHA_SATURATE:7, BLENDMODE_ONE_MINUS_SRC_ALPHA:8, BLENDMODE_DST_ALPHA:9, BLENDMODE_ONE_MINUS_DST_ALPHA:10, BLENDEQUATION_ADD:0, BLENDEQUATION_SUBTRACT:1, BLENDEQUATION_REVERSE_SUBTRACT:2, BUFFER_STATIC:0, BUFFER_DYNAMIC:1, BUFFER_STREAM:2,
  CLEARFLAG_COLOR:1, CLEARFLAG_DEPTH:2, CLEARFLAG_STENCIL:4, CULLFACE_NONE:0, CULLFACE_BACK:1, CULLFACE_FRONT:2, CULLFACE_FRONTANDBACK:3, ELEMENTTYPE_INT8:0, ELEMENTTYPE_UINT8:1, ELEMENTTYPE_INT16:2, ELEMENTTYPE_UINT16:3, ELEMENTTYPE_INT32:4, ELEMENTTYPE_UINT32:5, ELEMENTTYPE_FLOAT32:6, FILTER_NEAREST:0, FILTER_LINEAR:1, FILTER_NEAREST_MIPMAP_NEAREST:2, FILTER_NEAREST_MIPMAP_LINEAR:3, FILTER_LINEAR_MIPMAP_NEAREST:4, FILTER_LINEAR_MIPMAP_LINEAR:5, INDEXFORMAT_UINT8:0, INDEXFORMAT_UINT16:1, INDEXFORMAT_UINT32:2,
  PIXELFORMAT_A8:0, PIXELFORMAT_L8:1, PIXELFORMAT_L8_A8:2, PIXELFORMAT_R5_G6_B5:3, PIXELFORMAT_R5_G5_B5_A1:4, PIXELFORMAT_R4_G4_B4_A4:5, PIXELFORMAT_R8_G8_B8:6, PIXELFORMAT_R8_G8_B8_A8:7, PIXELFORMAT_DXT1:8, PIXELFORMAT_DXT3:9, PIXELFORMAT_DXT5:10, PIXELFORMAT_RGB16F:11, PIXELFORMAT_RGBA16F:12, PIXELFORMAT_RGB32F:13, PIXELFORMAT_RGBA32F:14, PIXELFORMAT_ETC1:15, PRIMITIVE_POINTS:0, PRIMITIVE_LINES:1, PRIMITIVE_LINELOOP:2, PRIMITIVE_LINESTRIP:3, PRIMITIVE_TRIANGLES:4, PRIMITIVE_TRISTRIP:5, PRIMITIVE_TRIFAN:6,
  SEMANTIC_POSITION:"POSITION", SEMANTIC_NORMAL:"NORMAL", SEMANTIC_TANGENT:"TANGENT", SEMANTIC_BLENDWEIGHT:"BLENDWEIGHT", SEMANTIC_BLENDINDICES:"BLENDINDICES", SEMANTIC_COLOR:"COLOR", SEMANTIC_TEXCOORD0:"TEXCOORD0", SEMANTIC_TEXCOORD1:"TEXCOORD1", SEMANTIC_TEXCOORD2:"TEXCOORD2", SEMANTIC_TEXCOORD3:"TEXCOORD3", SEMANTIC_TEXCOORD4:"TEXCOORD4", SEMANTIC_TEXCOORD5:"TEXCOORD5", SEMANTIC_TEXCOORD6:"TEXCOORD6", SEMANTIC_TEXCOORD7:"TEXCOORD7", SEMANTIC_ATTR0:"ATTR0", SEMANTIC_ATTR1:"ATTR1", SEMANTIC_ATTR2:"ATTR2",
  SEMANTIC_ATTR3:"ATTR3", SEMANTIC_ATTR4:"ATTR4", SEMANTIC_ATTR5:"ATTR5", SEMANTIC_ATTR6:"ATTR6", SEMANTIC_ATTR7:"ATTR7", SEMANTIC_ATTR8:"ATTR8", SEMANTIC_ATTR9:"ATTR9", SEMANTIC_ATTR10:"ATTR10", SEMANTIC_ATTR11:"ATTR11", SEMANTIC_ATTR12:"ATTR12", SEMANTIC_ATTR13:"ATTR13", SEMANTIC_ATTR14:"ATTR14", SEMANTIC_ATTR15:"ATTR15", TEXTURELOCK_READ:1, TEXTURELOCK_WRITE:2, UNIFORMTYPE_BOOL:0, UNIFORMTYPE_INT:1, UNIFORMTYPE_FLOAT:2, UNIFORMTYPE_VEC2:3, UNIFORMTYPE_VEC3:4, UNIFORMTYPE_VEC4:5, UNIFORMTYPE_IVEC2:6,
  UNIFORMTYPE_IVEC3:7, UNIFORMTYPE_IVEC4:8, UNIFORMTYPE_BVEC2:9, UNIFORMTYPE_BVEC3:10, UNIFORMTYPE_BVEC4:11, UNIFORMTYPE_MAT2:12, UNIFORMTYPE_MAT3:13, UNIFORMTYPE_MAT4:14, UNIFORMTYPE_TEXTURE2D:15, UNIFORMTYPE_TEXTURECUBE:16};
  pc.extend(pc, enums);
  pc.gfx = {};
  pc.extend(pc.gfx, enums)
})();
pc.extend(pc, function() {
  var ScopeId = function(name) {
    this.name = name;
    this.value = null;
    this.versionObject = new pc.VersionedObject
  };
  ScopeId.prototype = {setValue:function(value) {
    this.value = value;
    this.versionObject.increment()
  }, getValue:function(value) {
    return this.value
  }};
  return{ScopeId:ScopeId}
}());
pc.extend(pc, function() {
  var ScopeSpace = function(name) {
    this.name = name;
    this.variables = {};
    this.namespaces = {}
  };
  ScopeSpace.prototype = {resolve:function(name) {
    if(this.variables.hasOwnProperty(name) === false) {
      this.variables[name] = new pc.ScopeId(name)
    }
    return this.variables[name]
  }, getSubSpace:function(name) {
    if(this.namespaces.hasOwnProperty(name) === false) {
      this.namespaces[name] = new pc.ScopeSpace(name);
      logDEBUG("Added ScopeSpace: " + name)
    }
    return this.namespaces[name]
  }};
  return{ScopeSpace:ScopeSpace}
}());
pc.extend(pc, function() {
  var Version = function() {
    this.globalId = 0;
    this.revision = 0
  };
  Version.prototype = {equals:function(other) {
    return this.globalId === other.globalId && this.revision === other.revision
  }, notequals:function(other) {
    return this.globalId !== other.globalId || this.revision !== other.revision
  }, copy:function(other) {
    this.globalId = other.globalId;
    this.revision = other.revision
  }, reset:function() {
    this.globalId = 0;
    this.revision = 0
  }};
  return{Version:Version}
}());
pc.extend(pc, function() {
  var idCounter = 0;
  var VersionedObject = function() {
    idCounter++;
    this.version = new pc.Version;
    this.version.globalId = idCounter
  };
  VersionedObject.prototype = {increment:function() {
    this.version.revision++
  }};
  return{VersionedObject:VersionedObject}
}());
pc.extend(pc, function() {
  function VertexIteratorSetter(buffer, vertexElement) {
    this.index = 0;
    switch(vertexElement.dataType) {
      case pc.ELEMENTTYPE_INT8:
        this.array = new Int8Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_UINT8:
        this.array = new Uint8Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_INT16:
        this.array = new Int16Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_UINT16:
        this.array = new Uint16Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_INT32:
        this.array = new Int32Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_UINT32:
        this.array = new Uint32Array(buffer, vertexElement.offset);
        break;
      case pc.ELEMENTTYPE_FLOAT32:
        this.array = new Float32Array(buffer, vertexElement.offset);
        break
    }
    switch(vertexElement.numComponents) {
      case 1:
        this.set = VertexIteratorSetter_set1;
        break;
      case 2:
        this.set = VertexIteratorSetter_set2;
        break;
      case 3:
        this.set = VertexIteratorSetter_set3;
        break;
      case 4:
        this.set = VertexIteratorSetter_set4;
        break
    }
  }
  function VertexIteratorSetter_set1(a) {
    this.array[this.index] = a
  }
  function VertexIteratorSetter_set2(a, b) {
    this.array[this.index] = a;
    this.array[this.index + 1] = b
  }
  function VertexIteratorSetter_set3(a, b, c) {
    this.array[this.index] = a;
    this.array[this.index + 1] = b;
    this.array[this.index + 2] = c
  }
  function VertexIteratorSetter_set4(a, b, c, d) {
    this.array[this.index] = a;
    this.array[this.index + 1] = b;
    this.array[this.index + 2] = c;
    this.array[this.index + 3] = d
  }
  function VertexIterator(vertexBuffer) {
    this.vertexBuffer = vertexBuffer;
    this.buffer = this.vertexBuffer.lock();
    this.setters = [];
    this.element = {};
    var vertexFormat = this.vertexBuffer.getFormat();
    for(var i = 0;i < vertexFormat.elements.length;i++) {
      var vertexElement = vertexFormat.elements[i];
      this.setters[i] = new VertexIteratorSetter(this.buffer, vertexElement);
      this.element[vertexElement.name] = this.setters[i]
    }
  }
  VertexIterator.prototype = {next:function() {
    var i = 0;
    var setters = this.setters;
    var numSetters = this.setters.length;
    var vertexFormat = this.vertexBuffer.getFormat();
    while(i < numSetters) {
      var setter = setters[i++];
      setter.index += vertexFormat.size / setter.array.constructor.BYTES_PER_ELEMENT
    }
  }, end:function() {
    this.vertexBuffer.unlock()
  }};
  return{VertexIterator:VertexIterator}
}());
pc.extend(pc, function() {
  var _typeSize = [];
  _typeSize[pc.ELEMENTTYPE_INT8] = 1;
  _typeSize[pc.ELEMENTTYPE_UINT8] = 1;
  _typeSize[pc.ELEMENTTYPE_INT16] = 2;
  _typeSize[pc.ELEMENTTYPE_UINT16] = 2;
  _typeSize[pc.ELEMENTTYPE_INT32] = 4;
  _typeSize[pc.ELEMENTTYPE_UINT32] = 4;
  _typeSize[pc.ELEMENTTYPE_FLOAT32] = 4;
  var VertexFormat = function(graphicsDevice, description) {
    var i;
    this.elements = [];
    this.size = 0;
    for(var i = 0, len = description.length;i < len;i++) {
      var elementDesc = description[i];
      var element = {name:elementDesc.semantic, offset:0, stride:0, stream:-1, scopeId:graphicsDevice.scope.resolve(elementDesc.semantic), dataType:elementDesc.type, numComponents:elementDesc.components, normalize:elementDesc.normalize === undefined ? false : elementDesc.normalize, size:elementDesc.components * _typeSize[elementDesc.type]};
      this.elements.push(element);
      this.size += element.size
    }
    var offset = 0;
    for(var i = 0, len = this.elements.length;i < len;i++) {
      var element = this.elements[i];
      element.offset = offset;
      element.stride = this.size;
      offset += element.size
    }
  };
  return{VertexFormat:VertexFormat}
}());
pc.extend(pc, function() {
  var VertexBuffer = function(graphicsDevice, format, numVertices, usage, initialData) {
    this.usage = usage || pc.BUFFER_STATIC;
    this.format = format;
    this.numVertices = numVertices;
    this.numBytes = format.size * numVertices;
    this.device = graphicsDevice;
    var gl = this.device.gl;
    this.bufferId = gl.createBuffer();
    if(initialData && this.setData(initialData)) {
      return
    }else {
      this.storage = new ArrayBuffer(this.numBytes)
    }
  };
  VertexBuffer.prototype = {destroy:function() {
    var gl = this.device.gl;
    gl.deleteBuffer(this.bufferId)
  }, getFormat:function() {
    return this.format
  }, getUsage:function() {
    return this.usage
  }, getNumVertices:function() {
    return this.numVertices
  }, lock:function() {
    return this.storage
  }, unlock:function() {
    var gl = this.device.gl;
    var glUsage;
    switch(this.usage) {
      case pc.BUFFER_STATIC:
        glUsage = gl.STATIC_DRAW;
        break;
      case pc.BUFFER_DYNAMIC:
        glUsage = gl.DYNAMIC_DRAW;
        break;
      case pc.BUFFER_STREAM:
        glUsage = gl.STREAM_DRAW;
        break
    }
    gl.bindBuffer(gl.ARRAY_BUFFER, this.bufferId);
    gl.bufferData(gl.ARRAY_BUFFER, this.storage, glUsage)
  }, setData:function(data) {
    if(data.byteLength !== this.numBytes) {
      console.error("VertexBuffer: wrong initial data size: expected " + this.numBytes + ", got " + data.byteLength);
      return false
    }
    this.storage = data;
    this.unlock();
    return true
  }};
  return{VertexBuffer:VertexBuffer}
}());
pc.extend(pc, function() {
  var IndexBuffer = function(graphicsDevice, format, numIndices, usage) {
    this.usage = usage || pc.BUFFER_STATIC;
    this.format = format;
    this.numIndices = numIndices;
    this.device = graphicsDevice;
    var gl = this.device.gl;
    this.bufferId = gl.createBuffer();
    var bytesPerIndex;
    if(format === pc.INDEXFORMAT_UINT8) {
      bytesPerIndex = 1;
      this.glFormat = gl.UNSIGNED_BYTE
    }else {
      if(format === pc.INDEXFORMAT_UINT16) {
        bytesPerIndex = 2;
        this.glFormat = gl.UNSIGNED_SHORT
      }else {
        if(format === pc.INDEXFORMAT_UINT32) {
          bytesPerIndex = 4;
          this.glFormat = gl.UNSIGNED_INT
        }
      }
    }
    var numBytes = this.numIndices * bytesPerIndex;
    this.storage = new ArrayBuffer(numBytes)
  };
  IndexBuffer.prototype = {destroy:function() {
    var gl = this.device.gl;
    gl.deleteBuffer(this.bufferId)
  }, getFormat:function() {
    return this.format
  }, getNumIndices:function() {
    return this.numIndices
  }, lock:function() {
    return this.storage
  }, unlock:function() {
    var gl = this.device.gl;
    var glUsage;
    switch(this.usage) {
      case pc.BUFFER_STATIC:
        glUsage = gl.STATIC_DRAW;
        break;
      case pc.BUFFER_DYNAMIC:
        glUsage = gl.DYNAMIC_DRAW;
        break;
      case pc.BUFFER_STREAM:
        glUsage = gl.STREAM_DRAW;
        break
    }
    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.bufferId);
    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.storage, glUsage)
  }};
  return{IndexBuffer:IndexBuffer}
}());
pc.extend(pc, function() {
  var Texture = function(graphicsDevice, options) {
    this.device = graphicsDevice;
    var width = 4;
    var height = 4;
    var format = pc.PIXELFORMAT_R8_G8_B8_A8;
    var cubemap = false;
    var autoMipmap = true;
    var rgbm = false;
    var fixCubemapSeams = false;
    if(options !== undefined) {
      width = options.width !== undefined ? options.width : width;
      height = options.height !== undefined ? options.height : height;
      format = options.format !== undefined ? options.format : format;
      cubemap = options.cubemap !== undefined ? options.cubemap : cubemap;
      autoMipmap = options.autoMipmap !== undefined ? options.autoMipmap : autoMipmap;
      rgbm = options.rgbm !== undefined ? options.rgbm : rgbm;
      fixCubemapSeams = options.fixCubemapSeams !== undefined ? options.fixCubemapSeams : fixCubemapSeams
    }
    this.name = null;
    this.autoMipmap = autoMipmap;
    this.rgbm = rgbm;
    this.fixCubemapSeams = fixCubemapSeams;
    this._cubemap = cubemap;
    this._format = format;
    this._compressed = format === pc.PIXELFORMAT_DXT1 || format === pc.PIXELFORMAT_DXT3 || format === pc.PIXELFORMAT_DXT5 || format === pc.PIXELFORMAT_ETC1;
    this._width = width || 4;
    this._height = height || 4;
    this._addressU = pc.ADDRESS_REPEAT;
    this._addressV = pc.ADDRESS_REPEAT;
    if(pc.math.powerOfTwo(this._width) && pc.math.powerOfTwo(this._height)) {
      this._minFilter = pc.FILTER_LINEAR_MIPMAP_LINEAR
    }else {
      this._minFilter = pc.FILTER_LINEAR
    }
    this._magFilter = pc.FILTER_LINEAR;
    this._anisotropy = 1;
    this._levels = cubemap ? [[null, null, null, null, null, null]] : [null];
    this._lockedLevel = -1;
    this._needsUpload = true
  };
  Object.defineProperty(Texture.prototype, "minFilter", {get:function() {
    return this._minFilter
  }, set:function(filter) {
    if(!(pc.math.powerOfTwo(this._width) && pc.math.powerOfTwo(this._height))) {
      if(!(filter === pc.FILTER_NEAREST || filter === pc.FILTER_LINEAR)) {
        logWARNING("Invalid minification filter mode set on non power of two texture. Forcing linear addressing.");
        filter = pc.FILTER_LINEAR
      }
    }
    this._minFilter = filter
  }});
  Object.defineProperty(Texture.prototype, "magFilter", {get:function() {
    return this._magFilter
  }, set:function(magFilter) {
    if(!(magFilter === pc.FILTER_NEAREST || magFilter === pc.FILTER_LINEAR)) {
      logWARNING("Invalid magnification filter mode. Must be set to FILTER_NEAREST or FILTER_LINEAR.")
    }
    this._magFilter = magFilter
  }});
  Object.defineProperty(Texture.prototype, "addressU", {get:function() {
    return this._addressU
  }, set:function(addressU) {
    if(!(pc.math.powerOfTwo(this._width) && pc.math.powerOfTwo(this._height))) {
      if(addressU !== pc.ADDRESS_CLAMP_TO_EDGE) {
        logWARNING("Invalid address mode in U set on non power of two texture. Forcing clamp to edge addressing.");
        addressU = pc.ADDRESS_CLAMP_TO_EDGE
      }
    }
    this._addressU = addressU
  }});
  Object.defineProperty(Texture.prototype, "addressV", {get:function() {
    return this._addressV
  }, set:function(addressV) {
    if(!(pc.math.powerOfTwo(this._width) && pc.math.powerOfTwo(this._height))) {
      if(addressV !== pc.ADDRESS_CLAMP_TO_EDGE) {
        logWARNING("Invalid address mode in V set on non power of two texture. Forcing clamp to edge addressing.");
        addressV = pc.ADDRESS_CLAMP_TO_EDGE
      }
    }
    this._addressV = addressV
  }});
  Object.defineProperty(Texture.prototype, "anisotropy", {get:function() {
    return this._anisotropy
  }, set:function(anisotropy) {
    this._anisotropy = anisotropy
  }});
  Object.defineProperty(Texture.prototype, "width", {get:function() {
    return this._width
  }});
  Object.defineProperty(Texture.prototype, "height", {get:function() {
    return this._height
  }});
  Object.defineProperty(Texture.prototype, "format", {get:function() {
    return this._format
  }});
  Object.defineProperty(Texture.prototype, "cubemap", {get:function() {
    return this._cubemap
  }});
  pc.extend(Texture.prototype, {bind:function() {
  }, destroy:function() {
    if(this._glTextureId) {
      var gl = this.device.gl;
      gl.deleteTexture(this._glTextureId)
    }
  }, lock:function(options) {
    options = options || {level:0, face:0, mode:pc.TEXTURELOCK_WRITE};
    if(options.level === undefined) {
      options.level = 0
    }
    if(options.face === undefined) {
      options.face = 0
    }
    if(options.mode === undefined) {
      options.mode = pc.TEXTURELOCK_WRITE
    }
    this._lockedLevel = options.level;
    if(this._levels[options.level] === null) {
      switch(this._format) {
        case pc.PIXELFORMAT_A8:
        ;
        case pc.PIXELFORMAT_L8:
          this._levels[options.level] = new Uint8Array(this._width * this._height);
          break;
        case pc.PIXELFORMAT_L8_A8:
          this._levels[options.level] = new Uint8Array(this._width * this._height * 2);
          break;
        case pc.PIXELFORMAT_R5_G6_B5:
        ;
        case pc.PIXELFORMAT_R5_G5_B5_A1:
        ;
        case pc.PIXELFORMAT_R4_G4_B4_A4:
          this._levels[options.level] = new Uint16Array(this._width * this._height);
          break;
        case pc.PIXELFORMAT_R8_G8_B8:
          this._levels[options.level] = new Uint8Array(this._width * this._height * 3);
          break;
        case pc.PIXELFORMAT_R8_G8_B8_A8:
          this._levels[options.level] = new Uint8Array(this._width * this._height * 4);
          break;
        case pc.PIXELFORMAT_DXT1:
          this._levels[options.level] = new Uint8Array(Math.floor((this._width + 3) / 4) * Math.floor((this._height + 3) / 4) * 8);
          break;
        case pc.PIXELFORMAT_DXT3:
        ;
        case pc.PIXELFORMAT_DXT5:
          this._levels[options.level] = new Uint8Array(Math.floor((this._width + 3) / 4) * Math.floor((this._height + 3) / 4) * 16);
          break;
        case pc.PIXELFORMAT_RGB16F:
        ;
        case pc.PIXELFORMAT_RGB32F:
          this._levels[options.level] = new Float32Array(this._width * this._height * 3);
          break;
        case pc.PIXELFORMAT_RGBA16F:
        ;
        case pc.PIXELFORMAT_RGBA32F:
          this._levels[options.level] = new Float32Array(this._width * this._height * 4);
          break
      }
    }
    return this._levels[options.level]
  }, recover:function() {
  }, load:function(src, loader, requestBatch) {
    if(this._cubemap) {
      var options = {batch:requestBatch};
      var requests = src.map(function(url) {
        return new pc.resources.ImageRequest(url)
      });
      loader.request(requests).then(function(resources) {
        this.setSource(resources)
      }.bind(this))
    }else {
      var request = new pc.resources.ImageRequest(src);
      loader.request(request).then(function(resources) {
        this.setSource(resources[0])
      }.bind(this))
    }
  }, setSource:function(source) {
    if(this._cubemap) {
      logASSERT(Object.prototype.toString.apply(source) === "[object Array]", "pc.Texture: setSource: supplied source is not an array");
      logASSERT(source.length === 6, "pc.Texture: setSource: supplied source does not have 6 entries.");
      var validTypes = 0;
      var validDimensions = true;
      var width = source[0].width;
      var height = source[0].height;
      for(var i = 0;i < 6;i++) {
        if(source[i] instanceof HTMLCanvasElement || source[i] instanceof HTMLImageElement || source[i] instanceof HTMLVideoElement) {
          validTypes++
        }
        if(source[i].width !== width) {
          validDimensions = false
        }
        if(source[i].height !== height) {
          validDimensions = false
        }
      }
      logASSERT(validTypes === 6, "pc.Texture: setSource: Not all supplied source elements are of required type (canvas, image or video).");
      logASSERT(validDimensions, "pc.Texture: setSource: Not all supplied source elements share the same dimensions.");
      this._width = source[0].width;
      this._height = source[0].height;
      this._levels[0] = source
    }else {
      logASSERT(source instanceof HTMLCanvasElement || source instanceof HTMLImageElement || source instanceof HTMLVideoElement, "pc.Texture: setSource: supplied source is not an instance of HTMLCanvasElement, HTMLImageElement or HTMLVideoElement.");
      this._width = source.width;
      this._height = source.height;
      this._levels[0] = source
    }
    this.upload();
    this.minFilter = this._minFilter;
    this.magFilter = this._magFilter;
    this.addressu = this._addressu;
    this.addressv = this._addressv
  }, getSource:function() {
    return this._levels[0]
  }, unlock:function() {
    logASSERT(this._lockedLevel !== -1, "Attempting to unlock a texture that is not locked");
    this.upload();
    this._lockedLevel = -1
  }, upload:function() {
    this._needsUpload = true
  }, getDds:function() {
    if(this.format != pc.PIXELFORMAT_R8_G8_B8_A8) {
      console.error("This format is not implemented yet")
    }
    var fsize = 128;
    var i = 0;
    var j;
    var face;
    while(this._levels[i]) {
      if(!this.cubemap) {
        var mipSize = this._levels[i].length;
        if(!mipSize) {
          console.error("No byte array for mip " + i);
          return
        }
        fsize += mipSize
      }else {
        for(face = 0;face < 6;face++) {
          var mipSize = this._levels[i][face].length;
          if(!mipSize) {
            console.error("No byte array for mip " + i + ", face " + face);
            return
          }
          fsize += mipSize
        }
      }
      var mipSize;
      fsize += this._levels[i].length;
      i++
    }
    var buff = new ArrayBuffer(fsize);
    var header = new Uint32Array(buff, 0, 128 / 4);
    var DDS_MAGIC = 542327876;
    var DDS_HEADER_SIZE = 124;
    var DDS_FLAGS_REQUIRED = 1 | 2 | 4 | 4096 | 524288;
    var DDS_FLAGS_MIPMAP = 131072;
    var DDS_PIXELFORMAT_SIZE = 32;
    var DDS_PIXELFLAGS_RGBA8 = 1 | 64;
    var DDS_CAPS_REQUIRED = 4096;
    var DDS_CAPS_MIPMAP = 4194304;
    var DDS_CAPS_COMPLEX = 8;
    var DDS_CAPS2_CUBEMAP = 512 | 1024 | 2048 | 4096 | 8192 | 16384 | 32768;
    var flags = DDS_FLAGS_REQUIRED;
    if(this._levels.length > 1) {
      flags |= DDS_FLAGS_MIPMAP
    }
    var caps = DDS_CAPS_REQUIRED;
    if(this._levels.length > 1) {
      caps |= DDS_CAPS_MIPMAP
    }
    if(this._levels.length > 1 || this.cubemap) {
      caps |= DDS_CAPS_COMPLEX
    }
    var caps2 = this.cubemap ? DDS_CAPS2_CUBEMAP : 0;
    header[0] = DDS_MAGIC;
    header[1] = DDS_HEADER_SIZE;
    header[2] = flags;
    header[3] = this.height;
    header[4] = this.width;
    header[5] = this.width * this.height * 4;
    header[6] = 0;
    header[7] = this._levels.length;
    for(i = 0;i < 11;i++) {
      header[8 + i] = 0
    }
    header[19] = DDS_PIXELFORMAT_SIZE;
    header[20] = DDS_PIXELFLAGS_RGBA8;
    header[21] = 0;
    header[22] = 32;
    header[23] = 16711680;
    header[24] = 65280;
    header[25] = 255;
    header[26] = 4278190080;
    header[27] = caps;
    header[28] = caps2;
    header[29] = 0;
    header[30] = 0;
    header[31] = 0;
    var offset = 128;
    if(!this.cubemap) {
      for(i = 0;i < this._levels.length;i++) {
        var level = this._levels[i];
        var mip = new Uint8Array(buff, offset, level.length);
        for(j = 0;j < level.length;j++) {
          mip[j] = level[j]
        }
        offset += level.length
      }
    }else {
      for(face = 0;face < 6;face++) {
        for(i = 0;i < this._levels.length;i++) {
          var level = this._levels[i][face];
          var mip = new Uint8Array(buff, offset, level.length);
          for(j = 0;j < level.length;j++) {
            mip[j] = level[j]
          }
          offset += level.length
        }
      }
    }
    return buff
  }});
  return{Texture:Texture}
}());
pc.extend(pc, function() {
  var defaultOptions = {depth:true, face:0};
  var RenderTarget = function(graphicsDevice, colorBuffer, options) {
    this._device = graphicsDevice;
    this._colorBuffer = colorBuffer;
    options = options !== undefined ? options : defaultOptions;
    this._face = options.face !== undefined ? options.face : 0;
    this._depth = options.depth !== undefined ? options.depth : true
  };
  RenderTarget.prototype = {bind:function() {
  }, destroy:function() {
    var gl = this._device.gl;
    gl.deleteFramebuffer(this._frameBuffer);
    if(this._depthBuffer) {
      gl.deleteRenderbuffer(this._depthBuffer)
    }
  }, unbind:function() {
  }};
  Object.defineProperty(RenderTarget.prototype, "colorBuffer", {get:function() {
    return this._colorBuffer
  }});
  Object.defineProperty(RenderTarget.prototype, "face", {get:function() {
    return this._face
  }});
  Object.defineProperty(RenderTarget.prototype, "width", {get:function() {
    return this._colorBuffer.width
  }});
  Object.defineProperty(RenderTarget.prototype, "height", {get:function() {
    return this._colorBuffer.height
  }});
  return{RenderTarget:RenderTarget}
}());
pc.extend(pc, function() {
  var ShaderInput = function(graphicsDevice, name, type, locationId) {
    this.locationId = locationId;
    this.scopeId = graphicsDevice.scope.resolve(name);
    this.version = new pc.Version;
    this.dataType = type;
    this.array = []
  };
  return{ShaderInput:ShaderInput}
}());
pc.extend(pc, function() {
  function addLineNumbers(src) {
    var chunks = src.split("\n");
    for(var i = 0, len = chunks.length;i < len;i++) {
      chunks[i] = i + 1 + ":\t" + chunks[i]
    }
    return chunks.join("\n")
  }
  function createShader(gl, type, src) {
    var shader = gl.createShader(type);
    gl.shaderSource(shader, src);
    gl.compileShader(shader);
    var ok = gl.getShaderParameter(shader, gl.COMPILE_STATUS);
    if(!ok) {
      var error = gl.getShaderInfoLog(shader);
      var typeName = type === gl.VERTEX_SHADER ? "vertex" : "fragment";
      logERROR("Failed to compile " + typeName + " shader:\n\n" + addLineNumbers(src) + "\n\n" + error)
    }
    return shader
  }
  function createProgram(gl, vertexShader, fragmentShader) {
    var program = gl.createProgram();
    gl.attachShader(program, vertexShader);
    gl.attachShader(program, fragmentShader);
    gl.linkProgram(program);
    var ok = gl.getProgramParameter(program, gl.LINK_STATUS);
    if(!ok) {
      var error = gl.getProgramInfoLog(program);
      logERROR("Failed to link shader program. Error: " + error)
    }
    return program
  }
  var Shader = function(graphicsDevice, definition) {
    this.device = graphicsDevice;
    this.definition = definition;
    var gl = this.device.gl;
    var vertexShader = createShader(gl, gl.VERTEX_SHADER, definition.vshader);
    var fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, definition.fshader);
    this.program = createProgram(gl, vertexShader, fragmentShader);
    gl.deleteShader(vertexShader);
    gl.deleteShader(fragmentShader);
    this.attributes = [];
    this.uniforms = [];
    this.samplers = [];
    var i = 0;
    var info, location;
    var _typeToPc = {};
    _typeToPc[gl.BOOL] = pc.UNIFORMTYPE_BOOL;
    _typeToPc[gl.INT] = pc.UNIFORMTYPE_INT;
    _typeToPc[gl.FLOAT] = pc.UNIFORMTYPE_FLOAT;
    _typeToPc[gl.FLOAT_VEC2] = pc.UNIFORMTYPE_VEC2;
    _typeToPc[gl.FLOAT_VEC3] = pc.UNIFORMTYPE_VEC3;
    _typeToPc[gl.FLOAT_VEC4] = pc.UNIFORMTYPE_VEC4;
    _typeToPc[gl.INT_VEC2] = pc.UNIFORMTYPE_IVEC2;
    _typeToPc[gl.INT_VEC3] = pc.UNIFORMTYPE_IVEC3;
    _typeToPc[gl.INT_VEC4] = pc.UNIFORMTYPE_IVEC4;
    _typeToPc[gl.BOOL_VEC2] = pc.UNIFORMTYPE_BVEC2;
    _typeToPc[gl.BOOL_VEC3] = pc.UNIFORMTYPE_BVEC3;
    _typeToPc[gl.BOOL_VEC4] = pc.UNIFORMTYPE_BVEC4;
    _typeToPc[gl.FLOAT_MAT2] = pc.UNIFORMTYPE_MAT2;
    _typeToPc[gl.FLOAT_MAT3] = pc.UNIFORMTYPE_MAT3;
    _typeToPc[gl.FLOAT_MAT4] = pc.UNIFORMTYPE_MAT4;
    _typeToPc[gl.SAMPLER_2D] = pc.UNIFORMTYPE_TEXTURE2D;
    _typeToPc[gl.SAMPLER_CUBE] = pc.UNIFORMTYPE_TEXTURECUBE;
    var numAttributes = gl.getProgramParameter(this.program, gl.ACTIVE_ATTRIBUTES);
    while(i < numAttributes) {
      info = gl.getActiveAttrib(this.program, i++);
      location = gl.getAttribLocation(this.program, info.name);
      if(definition.attributes[info.name] === undefined) {
        console.error('Vertex shader attribute "' + info.name + '" is not mapped to a semantic in shader definition.')
      }
      var attr = new pc.ShaderInput(graphicsDevice, definition.attributes[info.name], _typeToPc[info.type], location);
      this.attributes.push(attr)
    }
    i = 0;
    var numUniforms = gl.getProgramParameter(this.program, gl.ACTIVE_UNIFORMS);
    while(i < numUniforms) {
      info = gl.getActiveUniform(this.program, i++);
      location = gl.getUniformLocation(this.program, info.name);
      if(info.type === gl.SAMPLER_2D || info.type === gl.SAMPLER_CUBE) {
        this.samplers.push(new pc.ShaderInput(graphicsDevice, info.name, _typeToPc[info.type], location))
      }else {
        this.uniforms.push(new pc.ShaderInput(graphicsDevice, info.name, _typeToPc[info.type], location))
      }
    }
  };
  Shader.prototype = {destroy:function() {
    var gl = this.device.gl;
    gl.deleteProgram(this.program)
  }};
  return{Shader:Shader}
}());
pc.extend(pc, function() {
  var ProgramLibrary = function(device) {
    this._device = device;
    this._cache = {};
    this._generators = {}
  };
  ProgramLibrary.prototype.register = function(name, generator) {
    if(!this.isRegistered(name)) {
      this._generators[name] = generator
    }
  };
  ProgramLibrary.prototype.unregister = function(name) {
    if(this.isRegistered(name)) {
      delete this._generators[name]
    }
  };
  ProgramLibrary.prototype.isRegistered = function(name) {
    var generator = this._generators[name];
    return generator !== undefined
  };
  ProgramLibrary.prototype.getProgram = function(name, options) {
    var generator = this._generators[name];
    if(generator === undefined) {
      logERROR("No program library functions registered for: " + name);
      return null
    }
    var key = generator.generateKey(gd, options);
    var shader = this._cache[key];
    if(!shader) {
      var gd = this._device;
      var shaderDefinition = generator.createShaderDefinition(gd, options);
      shader = this._cache[key] = new pc.Shader(gd, shaderDefinition)
    }
    return shader
  };
  return{ProgramLibrary:ProgramLibrary}
}());
pc.extend(pc, function() {
  var EVENT_RESIZE = "resizecanvas";
  function UnsupportedBrowserError(message) {
    this.name = "UnsupportedBrowserError";
    this.message = message || ""
  }
  UnsupportedBrowserError.prototype = Error.prototype;
  function ContextCreationError(message) {
    this.name = "ContextCreationError";
    this.message = message || ""
  }
  ContextCreationError.prototype = Error.prototype;
  var _contextLostHandler = function() {
    logWARNING("Context lost.")
  };
  var _contextRestoredHandler = function() {
    logINFO("Context restored.")
  };
  var _createContext = function(canvas, options) {
    var names = ["webgl", "experimental-webgl"];
    var context = null;
    for(var i = 0;i < names.length;i++) {
      try {
        context = canvas.getContext(names[i], options)
      }catch(e) {
      }
      if(context) {
        break
      }
    }
    return context
  };
  var _downsampleImage = function(image, size) {
    var srcW = image.width;
    var srcH = image.height;
    if(srcW > size || srcH > size) {
      var scale = size / Math.max(srcW, srcH);
      var dstW = Math.floor(srcW * scale);
      var dstH = Math.floor(srcH * scale);
      console.warn("Image dimensions larger than max supported texture size of " + size + ". " + "Resizing from " + srcW + ", " + srcH + " to " + dstW + ", " + dstH + ".");
      var canvas = document.createElement("canvas");
      canvas.width = dstW;
      canvas.height = dstH;
      var context = canvas.getContext("2d");
      context.drawImage(image, 0, 0, srcW, srcH, 0, 0, dstW, dstH);
      return canvas
    }
    return image
  };
  function _isIE() {
    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE ");
    var trident = navigator.userAgent.match(/Trident.*rv\:11\./);
    return msie > 0 || !!trident
  }
  var GraphicsDevice = function(canvas) {
    this.gl = undefined;
    this.canvas = canvas;
    this.shader = null;
    this.indexBuffer = null;
    this.vertexBuffers = [];
    this.precision = "highp";
    this.enableAutoInstancing = false;
    this.autoInstancingMaxObjects = 16384;
    this.attributesInvalidated = true;
    this.boundBuffer = [];
    this.instancedAttribs = {};
    this.enabledAttributes = {};
    this.textureUnits = [];
    this.commitFunction = {};
    if(!window.WebGLRenderingContext) {
      throw new pc.UnsupportedBrowserError;
    }
    this.gl = _createContext(canvas);
    var gl = this.gl;
    if(!this.gl) {
      throw new pc.ContextCreationError;
    }
    (function() {
      canvas.addEventListener("webglcontextlost", _contextLostHandler, false);
      canvas.addEventListener("webglcontextrestored", _contextRestoredHandler, false);
      this.canvas = canvas;
      this.shader = null;
      this.indexBuffer = null;
      this.vertexBuffers = [];
      this.precision = "highp";
      this.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
      this.maxCubeMapSize = gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);
      var vertexShaderPrecisionHighpFloat = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.HIGH_FLOAT);
      var vertexShaderPrecisionMediumpFloat = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.MEDIUM_FLOAT);
      var vertexShaderPrecisionLowpFloat = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.LOW_FLOAT);
      var fragmentShaderPrecisionHighpFloat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_FLOAT);
      var fragmentShaderPrecisionMediumpFloat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT);
      var fragmentShaderPrecisionLowpFloat = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.LOW_FLOAT);
      var vertexShaderPrecisionHighpInt = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.HIGH_INT);
      var vertexShaderPrecisionMediumpInt = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.MEDIUM_INT);
      var vertexShaderPrecisionLowpInt = gl.getShaderPrecisionFormat(gl.VERTEX_SHADER, gl.LOW_INT);
      var fragmentShaderPrecisionHighpInt = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.HIGH_INT);
      var fragmentShaderPrecisionMediumpInt = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.MEDIUM_INT);
      var fragmentShaderPrecisionLowpInt = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.LOW_INT);
      var highpAvailable = vertexShaderPrecisionHighpFloat.precision > 0 && fragmentShaderPrecisionHighpFloat.precision > 0;
      var mediumpAvailable = vertexShaderPrecisionMediumpFloat.precision > 0 && fragmentShaderPrecisionMediumpFloat.precision > 0;
      if(!highpAvailable) {
        if(mediumpAvailable) {
          this.precision = "mediump";
          console.warn("WARNING: highp not supported, using mediump")
        }else {
          this.precision = "lowp";
          console.warn("WARNING: highp and mediump not supported, using lowp")
        }
      }
      this.maxPrecision = this.precision;
      this.defaultClearOptions = {color:[0, 0, 0, 1], depth:1, flags:pc.CLEARFLAG_COLOR | pc.CLEARFLAG_DEPTH};
      this.glAddress = [gl.REPEAT, gl.CLAMP_TO_EDGE, gl.MIRRORED_REPEAT];
      this.glBlendEquation = [gl.FUNC_ADD, gl.FUNC_SUBTRACT, gl.FUNC_REVERSE_SUBTRACT];
      this.glBlendFunction = [gl.ZERO, gl.ONE, gl.SRC_COLOR, gl.ONE_MINUS_SRC_COLOR, gl.DST_COLOR, gl.ONE_MINUS_DST_COLOR, gl.SRC_ALPHA, gl.SRC_ALPHA_SATURATE, gl.ONE_MINUS_SRC_ALPHA, gl.DST_ALPHA, gl.ONE_MINUS_DST_ALPHA];
      this.glClearFlag = [0, gl.COLOR_BUFFER_BIT, gl.DEPTH_BUFFER_BIT, gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT, gl.STENCIL_BUFFER_BIT, gl.STENCIL_BUFFER_BIT | gl.COLOR_BUFFER_BIT, gl.STENCIL_BUFFER_BIT | gl.DEPTH_BUFFER_BIT, gl.STENCIL_BUFFER_BIT | gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT];
      this.glFilter = [gl.NEAREST, gl.LINEAR, gl.NEAREST_MIPMAP_NEAREST, gl.NEAREST_MIPMAP_LINEAR, gl.LINEAR_MIPMAP_NEAREST, gl.LINEAR_MIPMAP_LINEAR];
      this.glPrimitive = [gl.POINTS, gl.LINES, gl.LINE_LOOP, gl.LINE_STRIP, gl.TRIANGLES, gl.TRIANGLE_STRIP, gl.TRIANGLE_FAN];
      this.glType = [gl.BYTE, gl.UNSIGNED_BYTE, gl.SHORT, gl.UNSIGNED_SHORT, gl.INT, gl.UNSIGNED_INT, gl.FLOAT];
      this.extTextureFloat = gl.getExtension("OES_texture_float");
      this.extTextureFloatLinear = gl.getExtension("OES_texture_float_linear");
      this.extTextureHalfFloat = gl.getExtension("OES_texture_half_float");
      this.maxVertexTextures = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);
      this.supportsBoneTextures = this.extTextureFloat && this.maxVertexTextures > 0;
      this.extTextureFloatRenderable = !!this.extTextureFloat;
      if(this.extTextureFloat) {
        var __texture = gl.createTexture();
        gl.bindTexture(gl.TEXTURE_2D, __texture);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);
        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);
        var __width = 2;
        var __height = 2;
        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, __width, __height, 0, gl.RGBA, gl.FLOAT, null);
        var __fbo = gl.createFramebuffer();
        gl.bindFramebuffer(gl.FRAMEBUFFER, __fbo);
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, __texture, 0);
        gl.bindTexture(gl.TEXTURE_2D, null);
        if(gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE) {
          this.extTextureFloatRenderable = false
        }
      }
      this.extTextureLod = gl.getExtension("EXT_shader_texture_lod");
      this.fragmentUniformsCount = gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);
      this.samplerCount = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);
      this.extDepthTexture = null;
      this.extStandardDerivatives = gl.getExtension("OES_standard_derivatives");
      if(this.extStandardDerivatives) {
        gl.hint(this.extStandardDerivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES, gl.NICEST)
      }
      this.extTextureFilterAnisotropic = gl.getExtension("EXT_texture_filter_anisotropic");
      if(!this.extTextureFilterAnisotropic) {
        this.extTextureFilterAnisotropic = gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")
      }
      this.extCompressedTextureS3TC = gl.getExtension("WEBGL_compressed_texture_s3tc");
      if(!this.extCompressedTextureS3TC) {
        this.extCompressedTextureS3TC = gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc")
      }
      if(this.extCompressedTextureS3TC) {
        if(_isIE()) {
          this.extCompressedTextureS3TC = false
        }
      }
      if(this.extCompressedTextureS3TC) {
        var formats = gl.getParameter(gl.COMPRESSED_TEXTURE_FORMATS);
        for(var i = 0;i < formats.length;i++) {
          switch(formats[i]) {
            case this.extCompressedTextureS3TC.COMPRESSED_RGB_S3TC_DXT1_EXT:
              break;
            case this.extCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT1_EXT:
              break;
            case this.extCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT3_EXT:
              break;
            case this.extCompressedTextureS3TC.COMPRESSED_RGBA_S3TC_DXT5_EXT:
              break;
            default:
              break
          }
        }
      }
      this.extInstancing = gl.getExtension("ANGLE_instanced_arrays");
      if(this.enableAutoInstancing && !this.extInstancing) {
        this.enableAutoInstancing = false
      }
      this.extCompressedTextureETC1 = gl.getExtension("WEBGL_compressed_texture_etc1");
      this.extDrawBuffers = gl.getExtension("EXT_draw_buffers");
      this.maxDrawBuffers = this.extDrawBuffers ? gl.getParameter(this.extDrawBuffers.MAX_DRAW_BUFFERS_EXT) : 1;
      this.maxColorAttachments = this.extDrawBuffers ? gl.getParameter(this.extDrawBuffers.MAX_COLOR_ATTACHMENTS_EXT) : 1;
      this.renderTarget = null;
      this.scope = new pc.ScopeSpace("Device");
      this.commitFunction = {};
      this.commitFunction[pc.UNIFORMTYPE_BOOL] = function(locationId, value) {
        gl.uniform1i(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_INT] = function(locationId, value) {
        gl.uniform1i(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_FLOAT] = function(locationId, value) {
        if(typeof value == "number") {
          gl.uniform1f(locationId, value)
        }else {
          gl.uniform1fv(locationId, value)
        }
      };
      this.commitFunction[pc.UNIFORMTYPE_VEC2] = function(locationId, value) {
        gl.uniform2fv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_VEC3] = function(locationId, value) {
        gl.uniform3fv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_VEC4] = function(locationId, value) {
        gl.uniform4fv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_IVEC2] = function(locationId, value) {
        gl.uniform2iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_BVEC2] = function(locationId, value) {
        gl.uniform2iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_IVEC3] = function(locationId, value) {
        gl.uniform3iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_BVEC3] = function(locationId, value) {
        gl.uniform3iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_IVEC4] = function(locationId, value) {
        gl.uniform4iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_BVEC4] = function(locationId, value) {
        gl.uniform4iv(locationId, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_MAT2] = function(locationId, value) {
        gl.uniformMatrix2fv(locationId, false, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_MAT3] = function(locationId, value) {
        gl.uniformMatrix3fv(locationId, false, value)
      };
      this.commitFunction[pc.UNIFORMTYPE_MAT4] = function(locationId, value) {
        gl.uniformMatrix4fv(locationId, false, value)
      };
      this.setBlending(false);
      this.setBlendFunction(pc.BLENDMODE_ONE, pc.BLENDMODE_ZERO);
      this.setBlendEquation(pc.BLENDEQUATION_ADD);
      this.setColorWrite(true, true, true, true);
      this.setCullMode(pc.CULLFACE_BACK);
      this.setDepthTest(true);
      this.setDepthWrite(true);
      this.setClearDepth(1);
      this.setClearColor(0, 0, 0, 0);
      gl.enable(gl.SCISSOR_TEST);
      this.programLib = new pc.ProgramLibrary(this);
      for(var generator in pc.programlib) {
        this.programLib.register(generator, pc.programlib[generator])
      }
      var numUniforms = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);
      numUniforms -= 4 * 4;
      numUniforms -= 8;
      numUniforms -= 1;
      numUniforms -= 4 * 4;
      this.boneLimit = Math.floor(numUniforms / 4);
      if(this.boneLimit > 110) {
        this.boneLimit = 110
      }
      pc.events.attach(this);
      this.boundBuffer = [];
      this.instancedAttribs = {};
      this.textureUnits = [];
      this.attributesInvalidated = true;
      this.enabledAttributes = {};
      var bufferId = gl.createBuffer();
      var storage = new ArrayBuffer(16);
      gl.bindBuffer(gl.ARRAY_BUFFER, bufferId);
      gl.bufferData(gl.ARRAY_BUFFER, storage, gl.STATIC_DRAW);
      gl.getError();
      gl.vertexAttribPointer(0, 4, gl.UNSIGNED_BYTE, false, 4, 0);
      this.supportsUnsignedByte = gl.getError() === 0;
      gl.deleteBuffer(bufferId)
    }).call(this)
  };
  GraphicsDevice.prototype = {setViewport:function(x, y, width, height) {
    var gl = this.gl;
    gl.viewport(x, y, width, height)
  }, setScissor:function(x, y, width, height) {
    var gl = this.gl;
    gl.scissor(x, y, width, height)
  }, getProgramLibrary:function() {
    return this.programLib
  }, setProgramLibrary:function(programLib) {
    this.programLib = programLib
  }, updateBegin:function() {
    var gl = this.gl;
    this.boundBuffer = [];
    this.indexBuffer = null;
    var target = this.renderTarget;
    if(target) {
      if(!target._glFrameBuffer) {
        target._glFrameBuffer = gl.createFramebuffer();
        gl.bindFramebuffer(gl.FRAMEBUFFER, target._glFrameBuffer);
        if(!target._colorBuffer._glTextureId) {
          this.setTexture(target._colorBuffer, 0)
        }
        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, target._colorBuffer._cubemap ? gl.TEXTURE_CUBE_MAP_POSITIVE_X + target._face : gl.TEXTURE_2D, target._colorBuffer._glTextureId, 0);
        if(target._depth) {
          if(!target._glDepthBuffer) {
            target._glDepthBuffer = gl.createRenderbuffer()
          }
          gl.bindRenderbuffer(gl.RENDERBUFFER, target._glDepthBuffer);
          gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, target.width, target.height);
          gl.bindRenderbuffer(gl.RENDERBUFFER, null);
          gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, target._glDepthBuffer)
        }
        var status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);
        switch(status) {
          case gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:
            console.error("ERROR: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
            break;
          case gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:
            console.error("ERROR: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
            break;
          case gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:
            console.error("ERROR: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
            break;
          case gl.FRAMEBUFFER_UNSUPPORTED:
            console.error("ERROR: FRAMEBUFFER_UNSUPPORTED");
            break;
          case gl.FRAMEBUFFER_COMPLETE:
            break;
          default:
            break
        }
      }else {
        gl.bindFramebuffer(gl.FRAMEBUFFER, target._glFrameBuffer)
      }
    }else {
      gl.bindFramebuffer(gl.FRAMEBUFFER, null)
    }
    for(var i = 0;i < 16;i++) {
      this.textureUnits[i] = null
    }
  }, updateEnd:function() {
    var gl = this.gl;
    var target = this.renderTarget;
    if(target) {
      gl.bindFramebuffer(gl.FRAMEBUFFER, null)
    }
  }, initializeTexture:function(texture) {
    var gl = this.gl;
    texture._glTextureId = gl.createTexture();
    texture._glTarget = texture._cubemap ? gl.TEXTURE_CUBE_MAP : gl.TEXTURE_2D;
    switch(texture._format) {
      case pc.PIXELFORMAT_A8:
        texture._glFormat = gl.ALPHA;
        texture._glInternalFormat = gl.ALPHA;
        texture._glPixelType = gl.UNSIGNED_BYTE;
        break;
      case pc.PIXELFORMAT_L8:
        texture._glFormat = gl.LUMINANCE;
        texture._glInternalFormat = gl.LUMINANCE;
        texture._glPixelType = gl.UNSIGNED_BYTE;
        break;
      case pc.PIXELFORMAT_L8_A8:
        texture._glFormat = gl.LUMINANCE_ALPHA;
        texture._glInternalFormat = gl.LUMINANCE_ALPHA;
        texture._glPixelType = gl.UNSIGNED_BYTE;
        break;
      case pc.PIXELFORMAT_R5_G6_B5:
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = gl.RGB;
        texture._glPixelType = gl.UNSIGNED_SHORT_5_6_5;
        break;
      case pc.PIXELFORMAT_R5_G5_B5_A1:
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = gl.RGBA;
        texture._glPixelType = gl.UNSIGNED_SHORT_5_5_5_1;
        break;
      case pc.PIXELFORMAT_R4_G4_B4_A4:
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = gl.RGBA;
        texture._glPixelType = gl.UNSIGNED_SHORT_4_4_4_4;
        break;
      case pc.PIXELFORMAT_R8_G8_B8:
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = gl.RGB;
        texture._glPixelType = gl.UNSIGNED_BYTE;
        break;
      case pc.PIXELFORMAT_R8_G8_B8_A8:
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = gl.RGBA;
        texture._glPixelType = gl.UNSIGNED_BYTE;
        break;
      case pc.PIXELFORMAT_DXT1:
        ext = this.extCompressedTextureS3TC;
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = ext.COMPRESSED_RGB_S3TC_DXT1_EXT;
        break;
      case pc.PIXELFORMAT_DXT3:
        ext = this.extCompressedTextureS3TC;
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = ext.COMPRESSED_RGBA_S3TC_DXT3_EXT;
        break;
      case pc.PIXELFORMAT_DXT5:
        ext = this.extCompressedTextureS3TC;
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = ext.COMPRESSED_RGBA_S3TC_DXT5_EXT;
        break;
      case pc.PIXELFORMAT_ETC1:
        ext = this.extCompressedTextureETC1;
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = ext.COMPRESSED_RGB_ETC1_WEBGL;
        break;
      case pc.PIXELFORMAT_RGB16F:
        ext = this.extTextureHalfFloat;
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = gl.RGB;
        texture._glPixelType = ext.HALF_FLOAT_OES;
        break;
      case pc.PIXELFORMAT_RGBA16F:
        ext = this.extTextureHalfFloat;
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = gl.RGBA;
        texture._glPixelType = ext.HALF_FLOAT_OES;
        break;
      case pc.PIXELFORMAT_RGB32F:
        texture._glFormat = gl.RGB;
        texture._glInternalFormat = gl.RGB;
        texture._glPixelType = gl.FLOAT;
        break;
      case pc.PIXELFORMAT_RGBA32F:
        texture._glFormat = gl.RGBA;
        texture._glInternalFormat = gl.RGBA;
        texture._glPixelType = gl.FLOAT;
        break
    }
  }, uploadTexture:function(texture) {
    var gl = this.gl;
    var mipLevel = 0;
    var mipObject;
    while(texture._levels[mipLevel] || mipLevel == 0) {
      mipObject = texture._levels[mipLevel];
      if(mipLevel == 1 && !texture._compressed) {
        gl.generateMipmap(texture._glTarget)
      }
      if(texture._cubemap) {
        var face;
        gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);
        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
        if(mipObject[0] instanceof HTMLCanvasElement || mipObject[0] instanceof HTMLImageElement || mipObject[0] instanceof HTMLVideoElement) {
          for(face = 0;face < 6;face++) {
            var src = mipObject[face];
            if(src instanceof HTMLImageElement) {
              if(src.width > this.maxCubeMapSize || src.height > this.maxCubeMapSize) {
                src = _downsampleImage(src, this.maxCubeMapSize);
                if(mipLevel === 0) {
                  texture.width = src.width;
                  texture.height = src.height
                }
              }
            }
            gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + face, mipLevel, texture._glInternalFormat, texture._glFormat, texture._glPixelType, src)
          }
        }else {
          var resMult = 1 / Math.pow(2, mipLevel);
          for(face = 0;face < 6;face++) {
            if(texture._compressed) {
              gl.compressedTexImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + face, mipLevel, texture._glInternalFormat, Math.max(texture._width * resMult, 1), Math.max(texture._height * resMult, 1), 0, mipObject[face])
            }else {
              gl.texImage2D(gl.TEXTURE_CUBE_MAP_POSITIVE_X + face, mipLevel, texture._glInternalFormat, Math.max(texture._width * resMult, 1), Math.max(texture._height * resMult, 1), 0, texture._glFormat, texture._glPixelType, mipObject[face])
            }
          }
        }
      }else {
        if(mipObject instanceof HTMLCanvasElement || mipObject instanceof HTMLImageElement || mipObject instanceof HTMLVideoElement) {
          if(mipObject instanceof HTMLImageElement) {
            if(mipObject.width > this.maxTextureSize || mipObject.height > this.maxTextureSize) {
              mipObject = _downsampleImage(mipObject, this.maxTextureSize);
              if(mipLevel === 0) {
                texture.width = mipObject.width;
                texture.height = mipObject.height
              }
            }
          }
          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
          gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
          gl.texImage2D(gl.TEXTURE_2D, mipLevel, texture._glInternalFormat, texture._glFormat, texture._glPixelType, mipObject)
        }else {
          gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, false);
          var resMult = 1 / Math.pow(2, mipLevel);
          if(texture._compressed) {
            gl.compressedTexImage2D(gl.TEXTURE_2D, mipLevel, texture._glInternalFormat, Math.max(texture._width * resMult, 1), Math.max(texture._height * resMult, 1), 0, mipObject)
          }else {
            gl.texImage2D(gl.TEXTURE_2D, mipLevel, texture._glInternalFormat, Math.max(texture._width * resMult, 1), Math.max(texture._height * resMult, 1), 0, texture._glFormat, texture._glPixelType, mipObject)
          }
        }
      }
      mipLevel++
    }
    if(texture.autoMipmap && pc.math.powerOfTwo(texture._width) && pc.math.powerOfTwo(texture._height) && texture._levels.length === 1 && !texture._compressed) {
      gl.generateMipmap(texture._glTarget)
    }
  }, setTexture:function(texture, textureUnit) {
    var gl = this.gl;
    if(!texture._glTextureId) {
      this.initializeTexture(texture)
    }
    gl.activeTexture(gl.TEXTURE0 + textureUnit);
    if(this.textureUnits[textureUnit] !== texture) {
      gl.bindTexture(texture._glTarget, texture._glTextureId);
      this.textureUnits[textureUnit] = texture
    }
    gl.texParameteri(texture._glTarget, gl.TEXTURE_MIN_FILTER, this.glFilter[texture._minFilter]);
    gl.texParameteri(texture._glTarget, gl.TEXTURE_MAG_FILTER, this.glFilter[texture._magFilter]);
    gl.texParameteri(texture._glTarget, gl.TEXTURE_WRAP_S, this.glAddress[texture._addressU]);
    gl.texParameteri(texture._glTarget, gl.TEXTURE_WRAP_T, this.glAddress[texture._addressV]);
    var ext = this.extTextureFilterAnisotropic;
    if(ext) {
      var maxAnisotropy = this.maxAnisotropy;
      var anisotropy = texture.anisotropy;
      anisotropy = Math.min(anisotropy, maxAnisotropy);
      gl.texParameterf(texture._glTarget, ext.TEXTURE_MAX_ANISOTROPY_EXT, anisotropy)
    }
    if(texture._needsUpload) {
      this.uploadTexture(texture);
      texture._needsUpload = false
    }
  }, draw:function(primitive, numInstances) {
    var gl = this.gl;
    var i, j, len, sampler, samplerValue, texture, numTextures, uniform, scopeId, uniformVersion, programVersion;
    var shader = this.shader;
    var samplers = shader.samplers;
    var uniforms = shader.uniforms;
    if(numInstances > 1) {
      this.boundBuffer = [];
      this.attributesInvalidated = true
    }
    if(this.attributesInvalidated) {
      var attribute, element, vertexBuffer;
      var attributes = shader.attributes;
      for(i = 0, len = attributes.length;i < len;i++) {
        attribute = attributes[i];
        element = attribute.scopeId.value;
        if(element !== null) {
          vertexBuffer = this.vertexBuffers[element.stream];
          if(this.boundBuffer[element.stream] !== vertexBuffer.bufferId) {
            gl.bindBuffer(gl.ARRAY_BUFFER, vertexBuffer.bufferId);
            this.boundBuffer[element.stream] = vertexBuffer.bufferId
          }
          if(!this.enabledAttributes[attribute.locationId]) {
            gl.enableVertexAttribArray(attribute.locationId);
            this.enabledAttributes[attribute.locationId] = true
          }
          gl.vertexAttribPointer(attribute.locationId, element.numComponents, this.glType[element.dataType], element.normalize, element.stride, element.offset);
          if(element.stream === 1 && numInstances > 1) {
            if(!this.instancedAttribs[attribute.locationId]) {
              this.extInstancing.vertexAttribDivisorANGLE(attribute.locationId, 1);
              this.instancedAttribs = attribute.locationId
            }
          }else {
            if(this.instancedAttribs[attribute.locationId]) {
              this.extInstancing.vertexAttribDivisorANGLE(attribute.locationId, 0);
              this.instancedAttribs[attribute.locationId] = false
            }
          }
        }
      }
      this.attributesInvalidated = false
    }
    textureUnit = 0;
    for(i = 0, len = samplers.length;i < len;i++) {
      sampler = samplers[i];
      samplerValue = sampler.scopeId.value;
      if(samplerValue instanceof pc.Texture) {
        texture = samplerValue;
        this.setTexture(texture, textureUnit);
        if(sampler.slot !== textureUnit) {
          gl.uniform1i(sampler.locationId, textureUnit);
          sampler.slot = textureUnit
        }
        textureUnit++
      }else {
        sampler.array.length = 0;
        numTexures = samplerValue.length;
        for(j = 0;j < numTexures;j++) {
          texture = samplerValue[j];
          this.setTexture(texture, textureUnit);
          sampler.array[j] = textureUnit;
          textureUnit++
        }
        gl.uniform1iv(sampler.locationId, sampler.array)
      }
    }
    for(i = 0, len = uniforms.length;i < len;i++) {
      uniform = uniforms[i];
      scopeId = uniform.scopeId;
      uniformVersion = uniform.version;
      programVersion = scopeId.versionObject.version;
      if(uniformVersion.globalId !== programVersion.globalId || uniformVersion.revision !== programVersion.revision) {
        uniformVersion.globalId = programVersion.globalId;
        uniformVersion.revision = programVersion.revision;
        if(scopeId.value !== null) {
          this.commitFunction[uniform.dataType](uniform.locationId, scopeId.value)
        }
      }
    }
    if(primitive.indexed) {
      if(numInstances > 1) {
        this.extInstancing.drawElementsInstancedANGLE(this.glPrimitive[primitive.type], primitive.count, this.indexBuffer.glFormat, primitive.base * 2, numInstances);
        this.boundBuffer = [];
        this.attributesInvalidated = true
      }else {
        gl.drawElements(this.glPrimitive[primitive.type], primitive.count, this.indexBuffer.glFormat, primitive.base * 2)
      }
    }else {
      if(numInstances > 1) {
        this.extInstancing.drawArraysInstancedANGLE(this.glPrimitive[primitive.type], primitive.base, primitive.count, numInstances);
        this.boundBuffer = [];
        this.attributesInvalidated = true
      }else {
        gl.drawArrays(this.glPrimitive[primitive.type], primitive.base, primitive.count)
      }
    }
  }, clear:function(options) {
    var defaultOptions = this.defaultClearOptions;
    options = options || defaultOptions;
    var flags = options.flags === undefined ? defaultOptions.flags : options.flags;
    if(flags !== 0) {
      var gl = this.gl;
      if(flags & pc.CLEARFLAG_COLOR) {
        var color = options.color === undefined ? defaultOptions.color : options.color;
        this.setClearColor(color[0], color[1], color[2], color[3])
      }
      if(flags & pc.CLEARFLAG_DEPTH) {
        var depth = options.depth === undefined ? defaultOptions.depth : options.depth;
        this.setClearDepth(depth);
        if(!this.depthWrite) {
          gl.depthMask(true)
        }
      }
      gl.clear(this.glClearFlag[flags]);
      if(flags & pc.CLEARFLAG_DEPTH) {
        if(!this.depthWrite) {
          gl.depthMask(false)
        }
      }
    }
  }, readPixels:function(x, y, w, h, pixels) {
    var gl = this.gl;
    gl.readPixels(x, y, w, h, gl.RGBA, gl.UNSIGNED_BYTE, pixels)
  }, setClearDepth:function(depth) {
    if(depth !== this.clearDepth) {
      this.gl.clearDepth(depth);
      this.clearDepth = depth
    }
  }, setClearColor:function(r, g, b, a) {
    if(r !== this.clearRed || g !== this.clearGreen || b !== this.clearBlue || a !== this.clearAlpha) {
      this.gl.clearColor(r, g, b, a);
      this.clearRed = r;
      this.clearGreen = g;
      this.clearBlue = b;
      this.clearAlpha = a
    }
  }, setRenderTarget:function(renderTarget) {
    this.renderTarget = renderTarget
  }, getRenderTarget:function() {
    return this.renderTarget
  }, getDepthTest:function() {
    return this.depthTest
  }, setDepthTest:function(depthTest) {
    if(this.depthTest !== depthTest) {
      var gl = this.gl;
      if(depthTest) {
        gl.enable(gl.DEPTH_TEST)
      }else {
        gl.disable(gl.DEPTH_TEST)
      }
      this.depthTest = depthTest
    }
  }, getDepthWrite:function() {
    return this.depthWrite
  }, setDepthWrite:function(writeDepth) {
    if(this.depthWrite !== writeDepth) {
      this.gl.depthMask(writeDepth);
      this.depthWrite = writeDepth
    }
  }, setColorWrite:function(writeRed, writeGreen, writeBlue, writeAlpha) {
    if(this.writeRed !== writeRed || this.writeGreen !== writeGreen || this.writeBlue !== writeBlue || this.writeAlpha !== writeAlpha) {
      this.gl.colorMask(writeRed, writeGreen, writeBlue, writeAlpha);
      this.writeRed = writeRed;
      this.writeGreen = writeGreen;
      this.writeBlue = writeBlue;
      this.writeAlpha = writeAlpha
    }
  }, getBlending:function() {
    return this.blending
  }, setBlending:function(blending) {
    if(this.blending !== blending) {
      var gl = this.gl;
      if(blending) {
        gl.enable(gl.BLEND)
      }else {
        gl.disable(gl.BLEND)
      }
      this.blending = blending
    }
  }, setBlendFunction:function(blendSrc, blendDst) {
    if(this.blendSrc !== blendSrc || this.blendDst !== blendDst) {
      this.gl.blendFunc(this.glBlendFunction[blendSrc], this.glBlendFunction[blendDst]);
      this.blendSrc = blendSrc;
      this.blendDst = blendDst
    }
  }, setBlendEquation:function(blendEquation) {
    if(this.blendEquation !== blendEquation) {
      var gl = this.gl;
      gl.blendEquation(this.glBlendEquation[blendEquation]);
      this.blendEquation = blendEquation
    }
  }, setCullMode:function(cullMode) {
    if(this.cullMode !== cullMode) {
      var gl = this.gl;
      switch(cullMode) {
        case pc.CULLFACE_NONE:
          gl.disable(gl.CULL_FACE);
          break;
        case pc.CULLFACE_FRONT:
          gl.enable(gl.CULL_FACE);
          gl.cullFace(gl.FRONT);
          break;
        case pc.CULLFACE_BACK:
          gl.enable(gl.CULL_FACE);
          gl.cullFace(gl.BACK);
          break;
        case pc.CULLFACE_FRONTANDBACK:
          gl.enable(gl.CULL_FACE);
          gl.cullFace(gl.FRONT_AND_BACK);
          break
      }
      this.cullMode = cullMode
    }
  }, setIndexBuffer:function(indexBuffer) {
    if(this.indexBuffer !== indexBuffer) {
      this.indexBuffer = indexBuffer;
      var gl = this.gl;
      gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indexBuffer ? indexBuffer.bufferId : null)
    }
  }, setVertexBuffer:function(vertexBuffer, stream) {
    if(this.vertexBuffers[stream] !== vertexBuffer) {
      this.vertexBuffers[stream] = vertexBuffer;
      var vertexFormat = vertexBuffer.getFormat();
      var i = 0;
      var elements = vertexFormat.elements;
      var numElements = elements.length;
      while(i < numElements) {
        var vertexElement = elements[i++];
        vertexElement.stream = stream;
        vertexElement.scopeId.setValue(vertexElement)
      }
      this.attributesInvalidated = true
    }
  }, setShader:function(shader) {
    if(shader !== this.shader) {
      this.shader = shader;
      var gl = this.gl;
      gl.useProgram(shader.program);
      this.attributesInvalidated = true
    }
  }, getBoneLimit:function() {
    return this.boneLimit
  }, setBoneLimit:function(maxBones) {
    this.boneLimit = maxBones
  }, enableValidation:function(enable) {
    console.warn("enableValidation: This function is deprecated and will be removed shortly.")
  }, validate:function() {
    console.warn("validate: This function is deprecated and will be removed shortly.")
  }, resizeCanvas:function(width, height) {
    this.canvas.width = width;
    this.canvas.height = height;
    this.fire(EVENT_RESIZE, width, height)
  }};
  Object.defineProperty(GraphicsDevice.prototype, "width", {get:function() {
    return this.gl.drawingBufferWidth || this.canvas.width
  }});
  Object.defineProperty(GraphicsDevice.prototype, "height", {get:function() {
    return this.gl.drawingBufferHeight || this.canvas.height
  }});
  Object.defineProperty(GraphicsDevice.prototype, "fullscreen", {get:function() {
    return!!document.fullscreenElement
  }, set:function(fullscreen) {
    if(fullscreen) {
      var canvas = this.gl.canvas;
      canvas.requestFullscreen()
    }else {
      document.exitFullscreen()
    }
  }});
  Object.defineProperty(GraphicsDevice.prototype, "maxAnisotropy", {get:function() {
    var maxAniso;
    return function() {
      if(maxAniso === undefined) {
        maxAniso = 1;
        var gl = this.gl;
        var glExt = this.extTextureFilterAnisotropic;
        if(glExt) {
          maxAniso = gl.getParameter(glExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT)
        }
      }
      return maxAniso
    }
  }()});
  return{UnsupportedBrowserError:UnsupportedBrowserError, ContextCreationError:ContextCreationError, GraphicsDevice:GraphicsDevice, precalculatedTangents:true}
}());
pc.extend(pc, function() {
  var shaderChunks = {};
  var shaderCache = {};
  shaderChunks.collectAttribs = function(vsCode) {
    var attribs = {};
    var attrs = 0;
    var found = vsCode.indexOf("attribute");
    while(found >= 0) {
      var endOfLine = vsCode.indexOf(";", found);
      var startOfAttribName = vsCode.lastIndexOf(" ", endOfLine);
      var attribName = vsCode.substr(startOfAttribName + 1, endOfLine - (startOfAttribName + 1));
      if(attribName == "aPosition") {
        attribs.aPosition = pc.SEMANTIC_POSITION
      }else {
        attribs[attribName] = "ATTR" + attrs;
        attrs++
      }
      found = vsCode.indexOf("attribute", found + 1)
    }
    return attribs
  };
  shaderChunks.createShader = function(device, vsName, psName) {
    var vsCode = shaderChunks[vsName];
    var psCode = pc.programlib.getSnippet(device, "fs_precision") + "\n" + shaderChunks[psName];
    attribs = this.collectAttribs(vsCode);
    return new pc.Shader(device, {attributes:attribs, vshader:vsCode, fshader:psCode})
  };
  shaderChunks.createShaderFromCode = function(device, vsCode, psCode, uName) {
    var cached = shaderCache[uName];
    if(cached != undefined) {
      return cached
    }
    psCode = pc.programlib.getSnippet(device, "fs_precision") + "\n" + psCode;
    attribs = this.collectAttribs(vsCode);
    shaderCache[uName] = new pc.Shader(device, {attributes:attribs, vshader:vsCode, fshader:psCode});
    return shaderCache[uName]
  };
  return{shaderChunks:shaderChunks}
}());
pc.extend(pc, function() {
  var _postEffectQuadVB = null;
  function drawQuadWithShader(device, target, shader) {
    if(_postEffectQuadVB == null) {
      var vertexFormat = new pc.VertexFormat(device, [{semantic:pc.SEMANTIC_POSITION, components:2, type:pc.ELEMENTTYPE_FLOAT32}]);
      _postEffectQuadVB = new pc.VertexBuffer(device, vertexFormat, 4);
      var iterator = new pc.VertexIterator(_postEffectQuadVB);
      iterator.element[pc.SEMANTIC_POSITION].set(-1, -1);
      iterator.next();
      iterator.element[pc.SEMANTIC_POSITION].set(1, -1);
      iterator.next();
      iterator.element[pc.SEMANTIC_POSITION].set(-1, 1);
      iterator.next();
      iterator.element[pc.SEMANTIC_POSITION].set(1, 1);
      iterator.end()
    }
    device.setRenderTarget(target);
    device.updateBegin();
    var w = target !== null ? target.width : device.width;
    var h = target !== null ? target.height : device.height;
    var x = 0;
    var y = 0;
    device.setViewport(x, y, w, h);
    device.setScissor(x, y, w, h);
    var oldDepthTest = device.getDepthTest();
    var oldDepthWrite = device.getDepthWrite();
    device.setDepthTest(false);
    device.setDepthWrite(false);
    device.setVertexBuffer(_postEffectQuadVB, 0);
    device.setShader(shader);
    device.draw({type:pc.PRIMITIVE_TRISTRIP, base:0, count:4, indexed:false});
    device.setDepthTest(oldDepthTest);
    device.setDepthWrite(oldDepthWrite);
    device.updateEnd()
  }
  return{drawQuadWithShader:drawQuadWithShader}
}());
pc.extend(pc, function() {
  function fixChrome() {
    var endTime = Date.now() + 10;
    while(Date.now() < endTime) {
    }
  }
  function syncToCpu(device, targ, face) {
    var tex = targ._colorBuffer;
    if(tex.format != pc.PIXELFORMAT_R8_G8_B8_A8) {
      return
    }
    var pixels = new Uint8Array(tex.width * tex.height * 4);
    var gl = device.gl;
    gl.bindFramebuffer(gl.FRAMEBUFFER, targ._glFrameBuffer);
    gl.readPixels(0, 0, tex.width, tex.height, gl.RGBA, gl.UNSIGNED_BYTE, pixels);
    if(!tex._levels) {
      tex._levels = []
    }
    if(!tex._levels[0]) {
      tex._levels[0] = []
    }
    tex._levels[0][face] = pixels
  }
  function prefilterCubemap(options) {
    var device = options.device;
    var sourceCubemap = options.sourceCubemap;
    var method = options.method;
    var samples = options.samples;
    var cpuSync = options.cpuSync;
    var chromeFix = options.chromeFix;
    var chunks = pc.shaderChunks;
    var shader = chunks.createShaderFromCode(device, chunks.fullscreenQuadVS, chunks.rgbmPS + chunks.prefilterCubemapPS.replace(/\$METHOD/g, method === 0 ? "cos" : "phong").replace(/\$NUMSAMPLES/g, samples), "prefilter" + method + "" + samples);
    var shader2 = chunks.createShaderFromCode(device, chunks.fullscreenQuadVS, chunks.outputCubemapPS);
    var constantTexSource = device.scope.resolve("source");
    var constantParams = device.scope.resolve("params");
    var params = new pc.Vec4;
    var size = sourceCubemap.width;
    var rgbmSource = sourceCubemap.rgbm;
    var format = sourceCubemap.format;
    var cmapsList = [[], options.filteredFixed, options.filteredRgbm, options.filteredFixedRgbm];
    var gloss = method === 0 ? [0.9, 0.85, 0.7, 0.4, 0.25] : [512, 128, 32, 8, 2];
    var mipSize = [64, 32, 16, 8, 4];
    var mips = 5;
    var targ;
    var i, face, pass;
    var rgbFormat = format === pc.PIXELFORMAT_R8_G8_B8;
    if(rgbFormat && cpuSync) {
      format = pc.PIXELFORMAT_R8_G8_B8_A8;
      var nextCubemap = new pc.gfx.Texture(device, {cubemap:true, rgbm:rgbmSource, format:format, width:size, height:size, autoMipmap:false});
      nextCubemap.minFilter = pc.FILTER_LINEAR;
      nextCubemap.magFilter = pc.FILTER_LINEAR;
      nextCubemap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
      nextCubemap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
      for(face = 0;face < 6;face++) {
        targ = new pc.RenderTarget(device, nextCubemap, {face:face, depth:false});
        params.x = face;
        params.y = 0;
        constantTexSource.setValue(sourceCubemap);
        constantParams.setValue(params.data);
        if(chromeFix) {
          fixChrome()
        }
        pc.drawQuadWithShader(device, targ, shader2);
        syncToCpu(device, targ, face)
      }
      sourceCubemap = nextCubemap
    }
    if(size > 128) {
      var log128 = Math.round(Math.log2(128));
      var logSize = Math.round(Math.log2(size));
      var steps = logSize - log128;
      var nextCubemap;
      for(i = 0;i < steps;i++) {
        size = sourceCubemap.width * 0.5;
        var sampleGloss = method === 0 ? 1 : Math.pow(2, Math.round(Math.log2(gloss[0]) + (steps - i) * 2));
        nextCubemap = new pc.gfx.Texture(device, {cubemap:true, rgbm:rgbmSource, format:format, width:size, height:size, autoMipmap:false});
        nextCubemap.minFilter = pc.FILTER_LINEAR;
        nextCubemap.magFilter = pc.FILTER_LINEAR;
        nextCubemap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
        nextCubemap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
        for(face = 0;face < 6;face++) {
          targ = new pc.RenderTarget(device, nextCubemap, {face:face, depth:false});
          params.x = face;
          params.y = sampleGloss;
          params.z = size;
          params.w = 0;
          constantTexSource.setValue(sourceCubemap);
          constantParams.setValue(params.data);
          if(chromeFix) {
            fixChrome()
          }
          pc.drawQuadWithShader(device, targ, shader2);
          if(i === steps - 1 && cpuSync) {
            syncToCpu(device, targ, face)
          }
        }
        sourceCubemap = nextCubemap
      }
    }
    options.sourceCubemap = sourceCubemap;
    var sourceCubemapRgbm = null;
    if(!rgbmSource && options.filteredFixedRgbm) {
      var nextCubemap = new pc.gfx.Texture(device, {cubemap:true, rgbm:true, format:pc.PIXELFORMAT_R8_G8_B8_A8, width:size, height:size, autoMipmap:false});
      nextCubemap.minFilter = pc.FILTER_LINEAR;
      nextCubemap.magFilter = pc.FILTER_LINEAR;
      nextCubemap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
      nextCubemap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
      for(face = 0;face < 6;face++) {
        targ = new pc.RenderTarget(device, nextCubemap, {face:face, depth:false});
        params.x = face;
        params.w = 2;
        constantTexSource.setValue(sourceCubemap);
        constantParams.setValue(params.data);
        if(chromeFix) {
          fixChrome()
        }
        pc.drawQuadWithShader(device, targ, shader2);
        syncToCpu(device, targ, face)
      }
      sourceCubemapRgbm = nextCubemap
    }
    var unblurredGloss = method === 0 ? 1 : 2048;
    var startPass = method === 0 ? 0 : -1;
    cmapsList[startPass] = [];
    for(i = 0;i < mips;i++) {
      for(pass = startPass;pass < cmapsList.length;pass++) {
        if(cmapsList[pass] != null) {
          cmapsList[pass][i] = new pc.gfx.Texture(device, {cubemap:true, rgbm:pass < 2 ? rgbmSource : true, format:pass < 2 ? format : pc.PIXELFORMAT_R8_G8_B8_A8, fixCubemapSeams:pass === 1 || pass === 3, width:mipSize[i], height:mipSize[i], autoMipmap:false});
          cmapsList[pass][i].minFilter = pc.FILTER_LINEAR;
          cmapsList[pass][i].magFilter = pc.FILTER_LINEAR;
          cmapsList[pass][i].addressU = pc.ADDRESS_CLAMP_TO_EDGE;
          cmapsList[pass][i].addressV = pc.ADDRESS_CLAMP_TO_EDGE
        }
      }
    }
    for(pass = startPass;pass < cmapsList.length;pass++) {
      if(cmapsList[pass] != null) {
        if(pass > 1 && rgbmSource) {
          cmapsList[pass] = cmapsList[pass - 2];
          continue
        }
        for(i = 0;i < mips;i++) {
          for(face = 0;face < 6;face++) {
            targ = new pc.RenderTarget(device, cmapsList[pass][i], {face:face, depth:false});
            params.x = face;
            params.y = pass < 0 ? unblurredGloss : gloss[i];
            params.z = mipSize[i];
            params.w = pass;
            constantTexSource.setValue(i === 0 ? sourceCubemap : method === 0 ? cmapsList[0][i - 1] : cmapsList[-1][i - 1]);
            constantParams.setValue(params.data);
            if(chromeFix) {
              fixChrome()
            }
            pc.drawQuadWithShader(device, targ, shader);
            if(cpuSync) {
              syncToCpu(device, targ, face)
            }
          }
        }
      }
    }
    options.filtered = cmapsList[0];
    if(cpuSync && options.singleFilteredFixed) {
      var mips = [sourceCubemap, options.filteredFixed[0], options.filteredFixed[1], options.filteredFixed[2], options.filteredFixed[3], options.filteredFixed[4], options.filteredFixed[5]];
      var cubemap = new pc.gfx.Texture(device, {cubemap:true, rgbm:rgbmSource, fixCubemapSeams:true, format:format, width:128, height:128, autoMipmap:false});
      for(i = 0;i < 6;i++) {
        cubemap._levels[i] = mips[i]._levels[0]
      }
      cubemap.upload();
      cubemap.minFilter = pc.FILTER_LINEAR_MIPMAP_LINEAR;
      cubemap.magFilter = pc.FILTER_LINEAR;
      cubemap._prefilteredMips = true;
      options.singleFilteredFixed = cubemap
    }
    if(cpuSync && options.singlefilteredFixedRgbm && options.filteredFixedRgbm) {
      var mips = [sourceCubemapRgbm, options.filteredFixedRgbm[0], options.filteredFixedRgbm[1], options.filteredFixedRgbm[2], options.filteredFixedRgbm[3], options.filteredFixedRgbm[4], options.filteredFixedRgbm[5]];
      var cubemap = new pc.gfx.Texture(device, {cubemap:true, rgbm:true, fixCubemapSeams:true, format:pc.PIXELFORMAT_R8_G8_B8_A8, width:128, height:128, autoMipmap:false});
      for(i = 0;i < 6;i++) {
        cubemap._levels[i] = mips[i]._levels[0]
      }
      cubemap.upload();
      cubemap.minFilter = pc.FILTER_LINEAR_MIPMAP_LINEAR;
      cubemap.magFilter = pc.FILTER_LINEAR;
      cubemap._prefilteredMips = true;
      options.singlefilteredFixedRgbm = cubemap
    }
  }
  return{prefilterCubemap:prefilterCubemap}
}());
pc.shaderChunks.ambientPrefilteredCubeLodPS = "void addAmbient(inout psInternalData data) {\n    vec3 fixedReflDir = fixSeamsStatic(data.normalW, 1.0 - 1.0 / 4.0);\n    fixedReflDir.x *= -1.0;\n    data.diffuseLight = $DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, 5.0) ).rgb;\n}\n\n";
pc.shaderChunks.reflectionPrefilteredCubePS = "uniform samplerCube texture_prefilteredCubeMap128;\nuniform samplerCube texture_prefilteredCubeMap64;\nuniform samplerCube texture_prefilteredCubeMap32;\nuniform samplerCube texture_prefilteredCubeMap16;\nuniform samplerCube texture_prefilteredCubeMap8;\nuniform samplerCube texture_prefilteredCubeMap4;\nuniform float material_reflectionFactor;\n\nvoid addReflection(inout psInternalData data) {\n\n    // Unfortunately, WebGL doesn't allow us using textureCubeLod. Therefore bunch of nasty workarounds is required.\n    // We fix mip0 to 128x128, so code is rather static.\n    // Mips smaller than 4x4 aren't great even for diffuse. Don't forget that we don't have bilinear filtering between different faces.\n\n    float bias = saturate(1.0 - data.glossiness) * 5.0; // multiply by max mip level\n    int index1 = int(bias);\n    int index2 = int(min(bias + 1.0, 7.0));\n\n    vec3 fixedReflDir = fixSeams(cubeMapProject(data.reflDirW), bias);\n    fixedReflDir.x *= -1.0;\n\n    vec4 cubes[6];\n    cubes[0] = textureCube(texture_prefilteredCubeMap128, fixedReflDir);\n    cubes[1] = textureCube(texture_prefilteredCubeMap64, fixedReflDir);\n    cubes[2] = textureCube(texture_prefilteredCubeMap32, fixedReflDir);\n    cubes[3] = textureCube(texture_prefilteredCubeMap16, fixedReflDir);\n    cubes[4] = textureCube(texture_prefilteredCubeMap8, fixedReflDir);\n    cubes[5] = textureCube(texture_prefilteredCubeMap4, fixedReflDir);\n\n    // Also we don't have dynamic indexing in PS, so...\n    vec4 cube[2];\n    for(int i = 0; i < 6; i++) {\n        if (i == index1) {\n            cube[0] = cubes[i];\n        }\n        if (i == index2) {\n            cube[1] = cubes[i];\n        }\n    }\n\n    // another variant\n    /*if (index1==0){ cube[0]=cubes[0];\n    }else if (index1==1){ cube[0]=cubes[1];\n    }else if (index1==2){ cube[0]=cubes[2];\n    }else if (index1==3){ cube[0]=cubes[3];\n    }else if (index1==4){ cube[0]=cubes[4];\n    }else if (index1==5){ cube[0]=cubes[5];}\n\n    if (index2==0){ cube[1]=cubes[0];\n    }else if (index2==1){ cube[1]=cubes[1];\n    }else if (index2==2){ cube[1]=cubes[2];\n    }else if (index2==3){ cube[1]=cubes[3];\n    }else if (index2==4){ cube[1]=cubes[4];\n    }else if (index2==5){ cube[1]=cubes[5];}*/\n\n    vec4 cubeFinal = mix(cube[0], cube[1], fract(bias));\n    vec3 refl = $DECODE(cubeFinal).rgb;\n\n    data.reflection += vec4(refl, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.normalMapPS = "uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    data.normalW = data.TBN * normalMap;\n}\n\n";
pc.shaderChunks.gamma2_2FastPS = "vec3 gammaCorrectInput(vec3 color) {\n    return color * (color * (color * 0.305306011 + 0.682171111) + 0.012522878);\n}\n\nfloat gammaCorrectInput(float color) {\n    return color * (color * (color * 0.305306011 + 0.682171111) + 0.012522878);\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return vec4(gammaCorrectInput(color.rgb), color.a);\n}\n\nvec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    vec4 rgba = texture2D(tex, uv);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    vec4 rgba = textureCube(tex, uvw);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return pow(color, vec3(0.45));\n}\n\n";
pc.shaderChunks.particle_pointAlongVS = "    angle = atan(velocityV.x, velocityV.y); // not the fastest way, but easier to plug in; TODO: create rot matrix right from vectors\n\n";
pc.shaderChunks.glossConstPS = "uniform float material_shininess;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = material_shininess;\n}\n\n";
pc.shaderChunks.tonemappingFilmicPS = "const float A =  0.15;\nconst float B =  0.50;\nconst float C =  0.10;\nconst float D =  0.20;\nconst float E =  0.02;\nconst float F =  0.30;\nconst float W =  11.2;\n\nuniform float exposure;\n\nvec3 uncharted2Tonemap(vec3 x) {\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 toneMap(vec3 color) {\n    color = uncharted2Tonemap(color * exposure);\n    vec3 whiteScale = 1.0 / uncharted2Tonemap(vec3(W,W,W));\n    color = color * whiteScale;\n\n    return color;\n}\n\n";
pc.shaderChunks.skyboxPS = "varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvoid main(void) {\n    gl_FragColor = textureCube(texture_cubeMap, fixSeams(vViewDir));\n}\n\n";
pc.shaderChunks.particleUpdaterAABBPS = "uniform mat3 spawnBounds;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n    return emitterPos + spawnBounds * (inBounds - vec3(0.5));\n}\n\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n    localVelocity -= vec3(0, 0, initialVelocity);\n}\n\n";
pc.shaderChunks.uv1VS = "\nvec2 getUv1(inout vsInternalData data) {\n    return vertex_texCoord1;\n}\n";
pc.shaderChunks.particle_cpu_endVS = "\n    localPos *= particle_vertexData2.y * emitterScale;\n    localPos += particlePos;\n\n    gl_Position = matrix_viewProjection * vec4(localPos, 1.0);\n}\n\n";
pc.shaderChunks.normalVertexPS = "void getNormal(inout psInternalData data) {\n    data.normalW = normalize(vNormalW);\n}\n\n";
pc.shaderChunks.lightSpecularPhongPS = "float getLightSpecular(inout psInternalData data) {\n    float specPow = data.glossiness;\n\n    specPow = antiAliasGlossiness(data, specPow);\n\n    // Hack: On Mac OS X, calling pow with zero for the exponent generates hideous artifacts so bias up a little\n    return pow(max(dot(data.reflDirW, -data.lightDirNormW), 0.0), specPow + 0.0001);\n}\n\n";
pc.shaderChunks.refractionPS = "uniform float material_refraction, material_refractionIor;\n\nvec3 refract2(vec3 viewVec, vec3 Normal, float IOR) {\n    float vn = dot(viewVec, Normal);\n    float k = 1.0 - IOR * IOR * (1.0 - vn * vn);\n    vec3 refrVec = IOR * viewVec - (IOR * vn + sqrt(k)) * Normal;\n    return refrVec;\n}\n\nvoid addRefraction(inout psInternalData data) {\n\n    // use same reflection code with refraction vector\n    vec3 tmp = data.reflDirW;\n    vec4 tmp2 = data.reflection;\n    data.reflection = vec4(0.0);\n    data.reflDirW = refract2(-data.viewDirW, data.normalW, material_refractionIor);\n\n    addReflection(data);\n\n    data.diffuseLight = mix(data.diffuseLight, data.reflection.rgb * data.albedo, material_refraction);\n    data.reflDirW = tmp;\n    data.reflection = tmp2;\n}\n\n";
pc.shaderChunks.metalnessTexConstPS = "uniform sampler2D texture_metalnessMap;\nuniform float material_metalness;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, texture2D(texture_metalnessMap, $UV).$CH * material_metalness);\n}\n\n";
pc.shaderChunks.transformInstancedVS = "mat4 getModelMatrix(inout vsInternalData data) {\n    return mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";
pc.shaderChunks.normalMapFloatPS = "uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    normalMap = normalize(mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpMapFactor));\n    data.normalW = data.TBN * normalMap;\n}\n\n";
pc.shaderChunks.combineDiffuseSpecularOldPS = "vec3 combineColor(inout psInternalData data) {\n    return mix(data.albedo * data.diffuseLight + data.specularLight * data.specularity, data.reflection.rgb, data.reflection.a);\n}\n\n";
pc.shaderChunks.particleUpdaterStartPS = "float saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec3 unpack3NFloats(float src) {\n    float r = fract(src);\n    float g = fract(src * 256.0);\n    float b = fract(src * 65536.0);\n    return vec3(r, g, b);\n}\n\nvec3 tex1Dlod_lerp(sampler2D tex, vec2 tc, out vec3 w) {\n    vec4 a = texture2D(tex, tc);\n    vec4 b = texture2D(tex, tc + graphSampleSize);\n    float c = fract(tc.x * graphNumSamples);\n\n    vec3 unpackedA = unpack3NFloats(a.w);\n    vec3 unpackedB = unpack3NFloats(b.w);\n    w = mix(unpackedA, unpackedB, c);\n\n    return mix(a.xyz, b.xyz, c);\n}\n\nvoid main(void)\n{\n    if (gl_FragCoord.x > numParticles) discard;\n    float outMask0 = gl_FragCoord.y < 1.0? 1.0 : 0.0;\n    float outMask1 = (gl_FragCoord.y < 2.0 && gl_FragCoord.y >= 1.0)? 1.0 : 0.0;\n    float outMask2 = (gl_FragCoord.y < 3.0 && gl_FragCoord.y >= 2.0)? 1.0 : 0.0;\n\n    vec4 tex = texture2D(particleTexIN, vec2(vUv0.x, 0.125));\n    vec4 tex2 = texture2D(particleTexIN, vec2(vUv0.x, 0.375));\n    vec4 texR = texture2D(particleTexIN, vec2(vUv0.x, 0.625));\n\n    vec4 rndFactor = texR;\n    float particleLifetime = lifetime;\n    float life = tex2.w + delta;\n    float particleRate = rate + rateDiv * rndFactor.x;\n\n        float nlife = clamp(life / particleLifetime, 0.0, 1.0);\n        vec3 localVelocityDiv;\n        vec3 velocityDiv;\n        vec3 paramDiv;\n        vec3 localVelocity = tex1Dlod_lerp(internalTex0, vec2(nlife, 0), localVelocityDiv);\n        vec3 velocity =      tex1Dlod_lerp(internalTex1, vec2(nlife, 0), velocityDiv);\n        vec3 params =        tex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n        float rotSpeed = params.x;\n        float rotSpeedDiv = paramDiv.y;\n\n        localVelocity +=    (localVelocityDiv * vec3(2.0) - vec3(1.0)) * localVelocityDivMult * rndFactor.xyz;\n        velocity +=         (velocityDiv * vec3(2.0) - vec3(1.0)) * velocityDivMult * rndFactor.zxy;\n        rotSpeed +=         (rotSpeedDiv * 2.0 - 1.0) * rotSpeedDivMult * rndFactor.y;\n\n        addInitialVelocity(localVelocity, rndFactor.xyz);\n\n        vec3 outVelocity = emitterMatrix * localVelocity.xyz + velocity.xyz * emitterScale;\n        vec3 outPosition = tex.xyz + outVelocity * delta;\n        float outRotation = tex.w + rotSpeed * delta;\n\n        bool respawn = life <= 0.0 || life > particleLifetime;\n        outPosition = respawn? calcSpawnPosition(rndFactor.xyz, rndFactor.x) : outPosition;\n        outRotation = respawn? mix(startAngle, startAngle2, rndFactor.x) : outRotation;\n        outVelocity = respawn? vec3(0.0) : outVelocity;\n\n";
pc.shaderChunks.opacityTexPS = "uniform sampler2D texture_opacityMap;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = texture2D(texture_opacityMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.emissiveTexConstPS = "uniform sampler2D texture_emissiveMap;\nuniform vec3 material_emissive;\nvec3 getEmission(inout psInternalData data) {\n    return $texture2DSAMPLE(texture_emissiveMap, $UV).$CH * material_emissive;\n}\n\n";
pc.shaderChunks.normalVS = "vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = matrix_normal;\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";
pc.shaderChunks.particle_stretchVS = "    vec3 moveDir = particleVelocity * stretch;\n    vec3 posPrev = pos - moveDir;\n    posPrev += particlePosMoved;\n\n    vec2 centerToVertexV = normalize((mat3(matrix_view) * localPos).xy);\n\n    float interpolation = dot(-velocityV, centerToVertexV) * 0.5 + 0.5;\n\n    particlePos = mix(particlePos, posPrev, interpolation);\n\n";
pc.shaderChunks.skyboxHDRPS = "varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvoid main(void) {\n    vec3 color = $textureCubeSAMPLE(texture_cubeMap, fixSeams(vViewDir)).rgb;\n    color = toneMap(color);\n    color = gammaCorrectOutput(color);\n    gl_FragColor = vec4(color, 1.0);\n}\n\n";
pc.shaderChunks.reflectionPrefilteredCubeLodPS = "#extension GL_EXT_shader_texture_lod : enable\n\nuniform samplerCube texture_prefilteredCubeMap128;\nuniform float material_reflectionFactor;\n\nvoid addReflection(inout psInternalData data) {\n\n    float bias = saturate(1.0 - data.glossiness) * 5.0; // multiply by max mip level\n    vec3 fixedReflDir = fixSeams(cubeMapProject(data.reflDirW), bias);\n    fixedReflDir.x *= -1.0;\n\n    vec3 refl = $DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, bias) ).rgb;\n\n    data.reflection += vec4(refl, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.reflectionSpherePS = "uniform mat4 matrix_view;\nuniform sampler2D texture_sphereMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n\n    vec3 reflDirV = (mat3(matrix_view) * data.reflDirW).xyz;\n\n    float m = 2.0 * sqrt( dot(reflDirV.xy, reflDirV.xy) + (reflDirV.z+1.0)*(reflDirV.z+1.0) );\n    vec2 sphereMapUv = reflDirV.xy / m + 0.5;\n\n    data.reflection += vec4($texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb, material_reflectionFactor);\n}\n\n\n";
pc.shaderChunks.tonemappingNonePS = "vec3 toneMap(vec3 color) {\n    return color;\n}\n\n";
pc.shaderChunks.shadowVSPS = "\nfloat getShadowHardVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    float depth = unpackFloat(texture2DProj(shadowMap, vMainShadowUv));\n    return (depth < min(vMainShadowUv.z + shadowParams.z, 1.0)) ? 0.0 : 1.0;\n}\n\nfloat getShadowMaskVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return unpackMask(texture2DProj(shadowMap, vMainShadowUv));\n}\n\nfloat getShadowPCF3x3VS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    data.shadowCoord = vMainShadowUv.xyz;\n    data.shadowCoord.z += shadowParams.z;\n    data.shadowCoord.xyz /= vMainShadowUv.w;\n    data.shadowCoord.z = min(data.shadowCoord.z, 1.0);\n    return _getShadowPCF3x3(data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3_YZWVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    data.shadowCoord = vMainShadowUv.xyz;\n    data.shadowCoord.z += shadowParams.z;\n    data.shadowCoord.xyz /= vMainShadowUv.w;\n    data.shadowCoord.z = min(data.shadowCoord.z, 1.0);\n    return _getShadowPCF3x3_YZW(data, shadowMap, shadowParams);\n}\n\n";
pc.shaderChunks.particle_lambertPS = "\n    vec3 negNormal = max(normal, vec3(0.0));\n    vec3 posNormal = max(-normal, vec3(0.0));\n\n\n";
pc.shaderChunks.viewNormalVS = "\nuniform mat4 matrix_view;\nvec3 getViewNormal(inout vsInternalData data) {\n    return mat3(matrix_view) * vNormalW;\n}\n";
pc.shaderChunks.packDepthPS = "// Packing a float in GLSL with multiplication and mod\n// http://blog.gradientstudios.com/2012/08/23/shadow-map-improvement\nvec4 packFloat(float depth) {\n    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\n    // combination of mod and multiplication and division works better\n    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n    res -= res.xxyz * bit_mask;\n    return res;\n}\n\n\n";
pc.shaderChunks.basePS = "\nuniform vec3 view_position;\n\nuniform vec3 light_globalAmbient;\n\nstruct psInternalData {\n    vec3 albedo;\n    vec3 specularity;\n    float glossiness;\n    vec3 emission;\n    vec3 normalW;\n    mat3 TBN;\n    vec3 viewDirW;\n    vec3 reflDirW;\n    vec3 diffuseLight;\n    vec3 specularLight;\n    vec4 reflection;\n    float alpha;\n    vec3 lightDirNormW;\n    vec3 lightDirW;\n    vec3 lightPosW;\n    float atten;\n    vec3 shadowCoord;\n    vec2 uvOffset;\n    vec3 normalMap;\n    float ao;\n};\n\nvoid getViewDir(inout psInternalData data) {\n    data.viewDirW = normalize(view_position - vPositionW);\n}\n\nvoid getReflDir(inout psInternalData data) {\n    data.reflDirW = normalize(-reflect(data.viewDirW, data.normalW));\n}\n\nvoid getLightDirPoint(inout psInternalData data, vec3 lightPosW) {\n    data.lightDirW = vPositionW - lightPosW;\n    data.lightDirNormW = normalize(data.lightDirW);\n    data.lightPosW = lightPosW;\n}\n\nfloat getFalloffLinear(inout psInternalData data, float lightRadius) {\n    float d = length(data.lightDirW);\n    return max(((lightRadius - d) / lightRadius), 0.0);\n}\n\nfloat square(float x) {\n    return x*x;\n}\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat getFalloffInvSquared(inout psInternalData data, float lightRadius) {\n    float sqrDist = dot(data.lightDirW, data.lightDirW);\n    float falloff = 1.0 / (sqrDist + 1.0);\n    float invRadius = 1.0 / lightRadius;\n\n    falloff *= 16.0;\n    falloff *= square( saturate( 1.0 - square( sqrDist * square(invRadius) ) ) );\n\n    return falloff;\n}\n\nfloat getSpotEffect(inout psInternalData data, vec3 lightSpotDirW, float lightInnerConeAngle, float lightOuterConeAngle) {\n    float cosAngle = dot(data.lightDirNormW, lightSpotDirW);\n    return smoothstep(lightOuterConeAngle, lightInnerConeAngle, cosAngle);\n}\n\nvoid processMetalness(inout psInternalData data, float metalness) {\n    const float dielectricF0 = 0.04;\n    data.specularity = mix(vec3(dielectricF0), data.albedo, metalness);\n    data.albedo *= 1.0 - metalness;\n}\n\n";
pc.shaderChunks.transformSkinnedVS = "mat4 getModelMatrix(inout vsInternalData data) {\n    return             vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz / posW.w;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";
pc.shaderChunks.particle_lightingPS = "\n    vec3 light = negNormal.x*lightCube[0] + posNormal.x*lightCube[1] +\n                        negNormal.y*lightCube[2] + posNormal.y*lightCube[3] +\n                        negNormal.z*lightCube[4] + posNormal.z*lightCube[5];\n\n\n    rgb *= light;\n\n\n";
pc.shaderChunks.particle_blendMultiplyPS = "\n    rgb = mix(vec3(1.0), rgb, vec3(a));\n    if (rgb.r + rgb.g + rgb.b > 2.99) discard;\n\n";
pc.shaderChunks.particleUpdaterEndPS = "\n   tex = vec4(outPosition, outRotation) * outMask0 +\n          vec4(outVelocity, life) * outMask1 +\n          texR * outMask2;\n\n    gl_FragColor = tex;\n}\n\n";
pc.shaderChunks.skyboxPrefilteredCubePS = "varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvec3 fixSeamsStretch(vec3 vec, float mipmapIndex, float cubemapSize) {\n    float scale = 1.0 - exp2(mipmapIndex) / cubemapSize;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvoid main(void) {\n    vec3 color = textureCubeRGBM(texture_cubeMap, fixSeamsStretch(vViewDir, 0.0, 128.0));\n    color = toneMap(color);\n    color = gammaCorrectOutput(color);\n    gl_FragColor = vec4(color, 1.0);\n}\n\n";
pc.shaderChunks.particle_normalMapPS = "\n    vec3 normalMap         = normalize( texture2D(normalMap, texCoordsAlphaLife.xy).xyz * 2.0 - 1.0 );\n    vec3 normal = ParticleMat * normalMap;\n\n\n\n\n";
pc.shaderChunks.particleVS = "attribute vec4 particle_vertexData; // XYZ = particle position, W = particle ID + random factor\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\nuniform mat4 matrix_view;\n\nuniform float numParticles, numParticlesPot;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nuniform float stretch;\nuniform vec3 wrapBounds;\nuniform vec3 emitterScale;\nuniform float rate, rateDiv, lifetime, deltaRandomnessStatic, scaleDivMult, alphaDivMult, seed;\nuniform sampler2D particleTexOUT, particleTexIN;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nvarying vec4 texCoordsAlphaLife;\n\nvec3 unpack3NFloats(float src) {\n    float r = fract(src);\n    float g = fract(src * 256.0);\n    float b = fract(src * 65536.0);\n    return vec3(r, g, b);\n}\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec4 tex1Dlod_lerp(sampler2D tex, vec2 tc) {\n    return mix( texture2D(tex,tc), texture2D(tex,tc + graphSampleSize), fract(tc.x*graphNumSamples) );\n}\n\nvec4 tex1Dlod_lerp(sampler2D tex, vec2 tc, out vec3 w) {\n    vec4 a = texture2D(tex,tc);\n    vec4 b = texture2D(tex,tc + graphSampleSize);\n    float c = fract(tc.x*graphNumSamples);\n\n    vec3 unpackedA = unpack3NFloats(a.w);\n    vec3 unpackedB = unpack3NFloats(b.w);\n    w = mix(unpackedA, unpackedB, c);\n\n    return mix(a, b, c);\n}\n\n\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix) {\n    float c = cos(pRotation);\n    float s = sin(pRotation);\n\n    mat2 m = mat2(c, -s, s, c);\n    rotMatrix = m;\n\n    return m * quadXY;\n}\n\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY, out mat3 localMat) {\n    vec3 viewUp = matrix_viewInverse[1].xyz;\n    vec3 posCam = matrix_viewInverse[3].xyz;\n\n    mat3 billMat;\n    billMat[2] = normalize(InstanceCoords - posCam);\n    billMat[0] = normalize(cross(viewUp, billMat[2]));\n    billMat[1] = -viewUp;\n    vec3 pos = billMat * vec3(quadXY, 0);\n\n    localMat = billMat;\n\n    return pos;\n}\n\nvoid main(void) {\n    vec3 meshLocalPos = particle_vertexData.xyz;\n    float id = floor(particle_vertexData.w);\n\n    float rndFactor = fract(sin(id + 1.0 + seed));\n    vec3 rndFactor3 = vec3(rndFactor, fract(rndFactor*10.0), fract(rndFactor*100.0));\n\n    vec4 particleTex = texture2D(particleTexOUT, vec2(id / numParticlesPot, 0.125));\n    vec3 pos = particleTex.xyz;\n    float angle = particleTex.w;\n\n    vec4 particleTex2 = texture2D(particleTexOUT, vec2(id / numParticlesPot, 0.375));\n    vec3 particleVelocity = particleTex2.xyz;\n    vec2 velocityV = normalize((mat3(matrix_view) * particleVelocity).xy); // should be removed by compiler if align/stretch is not used\n    float life = particleTex2.w;\n\n    float particleLifetime = lifetime;\n\n    if (life <= 0.0 || life > particleLifetime) meshLocalPos = vec3(0.0);\n    vec2 quadXY = meshLocalPos.xy;\n    float nlife = clamp(life / particleLifetime, 0.0, 1.0);\n\n    vec3 paramDiv;\n    vec4 params = tex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n    float scale = params.y;\n    float scaleDiv = paramDiv.x;\n    float alphaDiv = paramDiv.z;\n\n    scale += (scaleDiv * 2.0 - 1.0) * scaleDivMult * fract(rndFactor*10000.0);\n\n    texCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5,    (alphaDiv * 2.0 - 1.0) * alphaDivMult * fract(rndFactor*1000.0),    nlife);\n\n    vec3 particlePos = pos;\n    vec3 particlePosMoved = vec3(0.0);\n\n    mat2 rotMatrix;\n    mat3 localMat;\n\n\n";
pc.shaderChunks.normalXYPS = "vec3 unpackNormal(vec4 nmap) {\n    vec3 normal;\n    normal.xy = nmap.wy * 2.0 - 1.0;\n    normal.z = sqrt(1.0 - saturate(dot(normal.xy, normal.xy)));\n    return normal;\n}\n\n";
pc.shaderChunks.outputCubemapPS = "varying vec2 vUv0;\n\nuniform samplerCube source;\nuniform vec4 params;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec4 encodeRGBM(vec4 color) { // modified RGBM\n    color.rgb = pow(color.rgb, vec3(0.5));\n    color.rgb *= 1.0 / 8.0;\n\n    color.a = saturate( max( max( color.r, color.g ), max( color.b, 1.0 / 255.0 ) ) );\n    color.a = ceil(color.a * 255.0) / 255.0;\n\n    color.rgb /= color.a;\n    return color;\n}\n\nvoid main(void) {\n\n    vec2 st = vUv0 * 2.0 - 1.0;\n    float face = params.x;\n\n    vec3 vec;\n    if (face==0.0) {\n        vec = vec3(1, -st.y, -st.x);\n    } else if (face==1.0) {\n        vec = vec3(-1, -st.y, st.x);\n    } else if (face==2.0) {\n        vec = vec3(st.x, 1, st.y);\n    } else if (face==3.0) {\n        vec = vec3(st.x, -1, -st.y);\n    } else if (face==4.0) {\n        vec = vec3(st.x, -st.y, 1);\n    } else {\n        vec = vec3(-st.x, -st.y, -1);\n    }\n\n    gl_FragColor = textureCube(source, vec);\n    if (params.w >= 2.0) gl_FragColor = encodeRGBM(gl_FragColor);\n}\n\n";
pc.shaderChunks.normalXYZPS = "vec3 unpackNormal(vec4 nmap) {\n    return nmap.xyz * 2.0 - 1.0;\n}\n\n";
pc.shaderChunks.metalnessConstPS = "uniform float material_metalness;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, material_metalness);\n}\n\n";
pc.shaderChunks.reflectionSphereLowPS = "uniform sampler2D texture_sphereMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n\n    vec3 reflDirV = vNormalV;\n\n    vec2 sphereMapUv = reflDirV.xy * 0.5 + 0.5;\n    data.reflection += vec4($texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.parallaxPS = "uniform sampler2D texture_heightMap;\nuniform float material_heightMapFactor;\nvoid getParallax(inout psInternalData data) {\n    float parallaxScale = material_heightMapFactor;\n    const float parallaxBias = 0.01;\n\n    float height = texture2D(texture_heightMap, $UV).r * parallaxScale - parallaxBias;\n    vec3 viewDirT = data.viewDirW * data.TBN;\n\n    data.uvOffset = min(height * viewDirT.xy, vec2(parallaxBias));\n}\n\n";
pc.shaderChunks.particle_blendNormalPS = "\n    if (a < 0.01) discard;\n";
pc.shaderChunks.specularAaToksvigPS = "float antiAliasGlossiness(inout psInternalData data, float power) {\n    float rlen = 1.0 / saturate(length(data.normalMap));\n    float toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n    return power * toksvig;\n}\n\n";
pc.shaderChunks.emissiveConstPS = "uniform vec3 material_emissive;\nvec3 getEmission(inout psInternalData data) {\n    return material_emissive;\n}\n\n";
pc.shaderChunks.TBNfastPS = "void getTBN(inout psInternalData data) {\n    data.TBN = mat3((vTangentW), (vBinormalW), (vNormalW));\n}\n\n";
pc.shaderChunks.gamma2_2PS = "vec3 gammaCorrectInput(vec3 color) {\n    return pow(color, vec3(2.2));\n}\n\nfloat gammaCorrectInput(float color) {\n    return pow(color, 2.2);\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\n\nvec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    vec4 rgba = texture2D(tex, uv);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    vec4 rgba = textureCube(tex, uvw);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return pow(color, vec3(0.45));\n}\n\n";
pc.shaderChunks.particle_blendAddPS = "\n    rgb *= gammaCorrectInput(a);\n    if ((rgb.r + rgb.g + rgb.b) < 0.000001) discard;\n\n";
pc.shaderChunks.startVS = "\nvoid main(void) {\n    vsInternalData data;\n\n    gl_Position = getPosition(data);\n";
pc.shaderChunks.normalSkinnedVS = "vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = mat3(data.modelMatrix[0].xyz, data.modelMatrix[1].xyz, data.modelMatrix[2].xyz);\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";
pc.shaderChunks.fresnelComplexPS = "// More physically-based Fresnel\nuniform float material_fresnelFactor; // should be IOR\nvoid getFresnel(inout psInternalData data) {\n    float cosThetaI = max(dot(data.normalW, data.viewDirW), 0.0);\n    float n = material_fresnelFactor;\n\n    float cosThetaT = sqrt(max(0.0, 1.0 - (1.0 - cosThetaI * cosThetaI) / (n * n)));\n    float nCosThetaT = n * cosThetaT;\n    float nCosThetaI = n * cosThetaI;\n\n    float rS = abs((cosThetaI - nCosThetaT) / (cosThetaI + nCosThetaT));\n    float rP = abs((cosThetaT - nCosThetaI) / (cosThetaT + nCosThetaI));\n    rS *= rS;\n    rP *= rP;\n\n    data.specularity *= (rS + rP) / 2.0;\n}\n\n";
pc.shaderChunks.particleUpdaterRespawnPS = "    life = life > particleLifetime? -particleRate * gl_FragCoord.x : life;\n\n";
pc.shaderChunks.opacityConstPS = "uniform float material_opacity;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = material_opacity;\n}\n\n";
pc.shaderChunks.baseVS = "\nattribute vec3 vertex_position;\nattribute vec3 vertex_normal;\nattribute vec4 vertex_tangent;\nattribute vec2 vertex_texCoord0;\nattribute vec2 vertex_texCoord1;\nattribute vec4 vertex_color;\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\n\nstruct vsInternalData {\n    vec3 positionW;\n    mat4 modelMatrix;\n    mat3 normalMatrix;\n    vec3 lightPosW;\n    vec3 lightDirNormW;\n    vec3 normalW;\n};\n\n";
pc.shaderChunks.ambientPrefilteredCubePS = "void addAmbient(inout psInternalData data) {\n    vec3 fixedReflDir = fixSeamsStatic(data.normalW, 1.0 - 1.0 / 4.0);\n    fixedReflDir.x *= -1.0;\n    data.diffuseLight = $DECODE(textureCube(texture_prefilteredCubeMap4, fixedReflDir)).rgb;\n}\n\n";
pc.shaderChunks.particle_wrapVS = "\n    vec3 origParticlePos = particlePos;\n    particlePos -= matrix_model[3].xyz;\n    particlePos = mod(particlePos, wrapBounds) - wrapBounds * 0.5;\n    particlePos += matrix_model[3].xyz;\n    particlePosMoved = particlePos - origParticlePos;\n\n\n";
pc.shaderChunks.combineDiffuseSpecularPS = "vec3 combineColor(inout psInternalData data) {\n    return mix(data.albedo * data.diffuseLight, data.specularLight + data.reflection.rgb * data.reflection.a, data.specularity);\n}\n\n";
pc.shaderChunks.normalInstancedVS = "vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = mat3(instance_line1.xyz, instance_line2.xyz, instance_line3.xyz);\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";
pc.shaderChunks.glossTexConstPS = "uniform sampler2D texture_glossMap;\nuniform float material_shininess;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = material_shininess * texture2D(texture_glossMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.fresnelSchlickPS = "// Schlick's approximation\nuniform float material_fresnelFactor; // unused\nvoid getFresnel(inout psInternalData data) {\n    float fresnel = 1.0 - max(dot(data.normalW, data.viewDirW), 0.0);\n    float fresnel2 = fresnel * fresnel;\n    fresnel *= fresnel2 * fresnel2;\n    fresnel *= data.glossiness * data.glossiness;\n    data.specularity = data.specularity + (1.0 - data.specularity) * fresnel;\n}\n\n";
pc.shaderChunks.diffuseConstPS = "uniform vec3 material_diffuse;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = material_diffuse.rgb;\n}\n\n";
pc.shaderChunks.particle_normalVS = "\n    Normal = normalize(localPos - localMat[2]);\n\n\n";
pc.shaderChunks.combineDiffuseSpecularNoConservePS = "vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight + (data.specularLight + data.reflection.rgb * data.reflection.a) * data.specularity;\n}\n\n";
pc.shaderChunks.uv0VS = "\nvec2 getUv0(inout vsInternalData data) {\n    return vertex_texCoord0;\n}\n";
pc.shaderChunks.emissiveTexPS = "uniform sampler2D texture_emissiveMap;\nvec3 getEmission(inout psInternalData data) {\n    return $texture2DSAMPLE(texture_emissiveMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.tonemappingLinearPS = "uniform float exposure;\nvec3 toneMap(vec3 color) {\n    return color * exposure;\n}\n\n";
pc.shaderChunks.specularAaNonePS = "float antiAliasGlossiness(inout psInternalData data, float power) {\n    return power;\n}\n\n";
pc.shaderChunks.specularAaToksvigFloatPS = "float antiAliasGlossiness(inout psInternalData data, float power) {\n    float rlen = 1.0 / saturate(length(data.normalMap));\n    float toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n    return power * mix(1.0, toksvig, material_bumpMapFactor);\n}\n\n";
pc.shaderChunks.prefilterCubemapPS = "varying vec2 vUv0;\n\nuniform samplerCube source;\nuniform vec4 params;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat rnd(vec2 uv) {\n    return fract(sin(dot(uv, vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\n\nconst float PI = 3.14159265358979;\nvec3 hemisphereSample_cos(vec2 uv, mat3 vecSpace, vec3 cubeDir, float gloss) { // cos + lerped cone size (better than just lerped)\n    float phi = uv.y * 2.0 * PI;\n    float cosTheta = sqrt(1.0 - uv.x);\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n    return normalize(mix(vecSpace * sampleDir, cubeDir, params.y));\n}\n\nvec3 hemisphereSample_phong(vec2 uv, mat3 vecSpace, vec3 cubeDir, float specPow) {\n    float phi = uv.y * 2.0 * PI;\n    float cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n    return vecSpace * sampleDir;\n}\n\nmat3 matrixFromVector(vec3 n) { // frisvad\n    float a = 1.0 / (1.0 + n.z);\n    float b = -n.x * n.y * a;\n    vec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n    vec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n    return mat3(b1, b2, n);\n}\n\nvec4 encodeRGBM(vec4 color) { // modified RGBM\n    color.rgb = pow(color.rgb, vec3(0.5));\n    color.rgb *= 1.0 / 8.0;\n\n    color.a = saturate( max( max( color.r, color.g ), max( color.b, 1.0 / 255.0 ) ) );\n    color.a = ceil(color.a * 255.0) / 255.0;\n\n    color.rgb /= color.a;\n    return color;\n}\n\nvoid main(void) {\n\n    vec2 st = vUv0 * 2.0 - 1.0;\n\n    if (params.w==1.0 || params.w==3.0) {\n        st = 2.0 * floor(gl_FragCoord.xy) / (params.z - 1.0) - 1.0;\n    }\n\n    float face = params.x;\n\n    vec3 vec;\n    if (face==0.0) {\n        vec = vec3(1, -st.y, -st.x);\n    } else if (face==1.0) {\n        vec = vec3(-1, -st.y, st.x);\n    } else if (face==2.0) {\n        vec = vec3(st.x, 1, st.y);\n    } else if (face==3.0) {\n        vec = vec3(st.x, -1, -st.y);\n    } else if (face==4.0) {\n        vec = vec3(st.x, -st.y, 1);\n    } else {\n        vec = vec3(-st.x, -st.y, -1);\n    }\n\n    mat3 vecSpace = matrixFromVector(normalize(vec));\n\n    vec4 color = vec4(0.0);\n    const int samples = $NUMSAMPLES;\n    vec3 vect;\n    for(int i=0; i<samples; i++) {\n        float sini = sin(float(i));\n        float cosi = cos(float(i));\n        float rand = rnd(vec2(sini, cosi));\n\n        vect = hemisphereSample_$METHOD(vec2(float(i) / float(samples), rand), vecSpace, vec, params.y);\n\n        color += textureCube(source, vect);\n    }\n    color /= float(samples);\n\n    gl_FragColor = params.w < 2.0? color : encodeRGBM(color);\n}\n";
pc.shaderChunks.cubeMapProjectBoxPS = "uniform vec3 envBoxMin, envBoxMax;\n\nvec3 cubeMapProject(vec3 nrdir) {\n    vec3 rbmax = (envBoxMax - vPositionW) / nrdir;\n    vec3 rbmin = (envBoxMin - vPositionW) / nrdir;\n\n    vec3 rbminmax;\n    rbminmax.x = nrdir.x>0.0? rbmax.x : rbmin.x;\n    rbminmax.y = nrdir.y>0.0? rbmax.y : rbmin.y;\n    rbminmax.z = nrdir.z>0.0? rbmax.z : rbmin.z;\n\n    float fa = min(min(rbminmax.x, rbminmax.y), rbminmax.z);\n\n    vec3 posonbox = vPositionW + nrdir * fa;\n    vec3 envBoxPos = (envBoxMin + envBoxMax) * 0.5;\n    return posonbox - envBoxPos;\n}\n\n";
pc.shaderChunks.fixCubemapSeamsStretchPS = "vec3 fixSeams(vec3 vec, float mipmapIndex) {\n    float scale = 1.0 - exp2(mipmapIndex) / 128.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvec3 fixSeams(vec3 vec) {\n    float scale = 1.0 - 1.0 / 128.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n    float scale = invRecMipSize;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\n";
pc.shaderChunks.opacityTexConstPS = "uniform sampler2D texture_opacityMap;\nuniform float material_opacity;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = texture2D(texture_opacityMap, $UV).$CH * material_opacity;\n}\n\n";
pc.shaderChunks.combineDiffuseSpecularNoReflSeparateAmbientPS = "uniform vec3 material_ambient;\nvec3 combineColor(inout psInternalData data) {\n    return (data.diffuseLight - light_globalAmbient) * data.albedo + data.specularLight * data.specularity + material_ambient * light_globalAmbient;\n}\n\n";
pc.shaderChunks.tangentBinormalVS = "\nvec3 getTangent(inout vsInternalData data) {\n    return normalize(data.normalMatrix * vertex_tangent.xyz);\n}\n\nvec3 getBinormal(inout vsInternalData data) {\n    return cross(vNormalW, vTangentW) * vertex_tangent.w;\n}\n\n";
pc.shaderChunks.specularTexPS = "uniform sampler2D texture_specularMap;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = texture2D(texture_specularMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.particle_TBNVS = "\n    mat3 rot3 = mat3(rotMatrix[0][0], rotMatrix[0][1], 0.0,        rotMatrix[1][0], rotMatrix[1][1], 0.0,        0.0, 0.0, 1.0);\n    localMat[2] *= -1.0;\n    ParticleMat = localMat * rot3;\n\n\n\n\n";
pc.shaderChunks.normalMapFloatTBNfastPS = "uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    normalMap = mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpMapFactor);\n    data.normalW = normalize(data.TBN * normalMap);\n}\n\n";
pc.shaderChunks.fresnelSimplePS = "// Easily tweakable but not very correct Fresnel\nuniform float material_fresnelFactor;\nvoid getFresnel(inout psInternalData data) {\n    float fresnel = 1.0 - max(dot(data.normalW, data.viewDirW), 0.0);\n    data.specularity *= pow(fresnel, material_fresnelFactor);\n}\n\n";
pc.shaderChunks.fixCubemapSeamsNonePS = "vec3 fixSeams(vec3 vec, float mipmapIndex) {\n    return vec;\n}\n\nvec3 fixSeams(vec3 vec) {\n    return vec;\n}\n\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n    return vec;\n}\n";
pc.shaderChunks.particle_cpuVS = "attribute vec4 particle_vertexData;     // XYZ = world pos, W = life\nattribute vec4 particle_vertexData2;     // X = angle, Y = scale, Z = alpha, W = velocity.x\nattribute vec4 particle_vertexData3;     // XYZ = particle local pos, W = velocity.y\nattribute vec2 particle_vertexData4;     // X = velocity.z, W = particle ID\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat4 matrix_view;\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\n\nuniform float numParticles;\nuniform float lifetime;\nuniform float stretch;\n//uniform float graphSampleSize;\n//uniform float graphNumSamples;\nuniform vec3 wrapBounds, emitterScale;\nuniform sampler2D texLifeAndSourcePosOUT;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nvarying vec4 texCoordsAlphaLife;\n\n\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix)\n{\n    float c = cos(pRotation);\n    float s = sin(pRotation);\n    //vec4 rotationMatrix = vec4(c, -s, s, c);\n\n    mat2 m = mat2(c, -s, s, c);\n    rotMatrix = m;\n\n    return m * quadXY;\n}\n\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY, out mat3 localMat)\n{\n    vec3 viewUp = matrix_viewInverse[1].xyz;\n    vec3 posCam = matrix_viewInverse[3].xyz;\n\n    mat3 billMat;\n    billMat[2] = normalize(InstanceCoords - posCam);\n    billMat[0] = normalize(cross(viewUp, billMat[2]));\n    billMat[1] = -viewUp;\n    vec3 pos = billMat * vec3(quadXY, 0);\n\n    localMat = billMat;\n\n    return pos;\n}\n\n\nvoid main(void)\n{\n    vec3 particlePos = particle_vertexData.xyz;\n    vec3 pos = particlePos;\n    vec3 vertPos = particle_vertexData3.xyz;\n    vec3 particleVelocity = vec3(particle_vertexData2.w, particle_vertexData3.w, particle_vertexData4.x);\n    vec2 velocityV = normalize((mat3(matrix_view) * particleVelocity).xy); // should be removed by compiler if align/stretch is not used\n\n    vec2 quadXY = vertPos.xy;\n    texCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5, particle_vertexData2.z, particle_vertexData.w);\n\n    mat2 rotMatrix;\n    mat3 localMat;\n\n    float angle = particle_vertexData2.x;\n    vec3 particlePosMoved = vec3(0.0);\n    vec3 meshLocalPos = particle_vertexData3.xyz;\n\n";
pc.shaderChunks.transformVS = "mat4 getModelMatrix(inout vsInternalData data) {\n    return matrix_model;\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";
pc.shaderChunks.fogExpPS = "uniform vec3 fog_color;\nuniform float fog_density;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = exp(-depth * fog_density);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    return mix(fog_color, color, fogFactor);\n}\n";
pc.shaderChunks.metalnessTexPS = "uniform sampler2D texture_metalnessMap;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, texture2D(texture_metalnessMap, $UV).$CH);\n}\n\n";
pc.shaderChunks.cubeMapProjectNonePS = "vec3 cubeMapProject(vec3 dir) {\n    return dir;\n}\n\n";
pc.shaderChunks.particle_billboardVS = "\n    quadXY = rotate(quadXY, angle, rotMatrix);\n    vec3 localPos = billboard(particlePos, quadXY, localMat);\n\n";
pc.shaderChunks.glossTexPS = "uniform sampler2D texture_glossMap;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = texture2D(texture_glossMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.combineDiffuseSpecularNoReflPS = "vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight + data.specularLight * data.specularity;\n}\n\n";
pc.shaderChunks.particle_meshVS = "\n    vec3 localPos = meshLocalPos;\n    localPos.xy = rotate(localPos.xy, angle, rotMatrix);\n    localPos.yz = rotate(localPos.yz, angle, rotMatrix);\n\n    billboard(particlePos, quadXY, localMat);\n\n\n";
pc.shaderChunks.particle_endPS = "    rgb = addFog(data, rgb);\n    rgb = toneMap(rgb);\n    rgb = gammaCorrectOutput(rgb);\n    gl_FragColor = vec4(rgb, a);\n}\n";
pc.shaderChunks.shadowCoordPS = "void _getShadowCoordOrtho(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    projPos.z += shadowParams.z;\n    projPos.z = min(projPos.z, 1.0);\n    data.shadowCoord = projPos.xyz;\n}\n\nvoid _getShadowCoordPersp(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    projPos.xyz /= projPos.w;\n    projPos.z += shadowParams.z;\n    data.shadowCoord = projPos.xyz;\n}\n\nvoid getShadowCoordOrtho(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPersp(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPerspNormalOffset(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    float distScale = abs(dot(vPositionW - data.lightPosW, data.lightDirNormW)); // fov?\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0) * distScale;\n\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, wPos);\n}\n\nvoid getShadowCoordOrthoNormalOffset(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0); //0.08\n\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, wPos);\n}\n\n";
pc.shaderChunks.fullscreenQuadVS = "attribute vec2 aPosition;\n\nvarying vec2 vUv0;\n\nvoid main(void)\n{\n    gl_Position = vec4(aPosition, 0.5, 1.0);\n    vUv0 = aPosition.xy*0.5+0.5;\n}\n\n";
pc.shaderChunks.particlePS = "varying vec4 texCoordsAlphaLife;\n\nuniform sampler2D colorMap;\nuniform sampler2D internalTex3;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nuniform vec4 screenSize;\nuniform float camera_far;\nuniform float softening;\nuniform float colorMult;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat unpackFloat(vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    float depth = dot(rgbaDepth, bitShift);\n    return depth;\n}\n\nvoid main(void) {\n    psInternalData data;\n    vec4 tex         = texture2DSRGB(colorMap, texCoordsAlphaLife.xy);\n    vec4 ramp     = texture2DSRGB(internalTex3, vec2(texCoordsAlphaLife.w, 0.0));\n    ramp.rgb *= colorMult;\n\n    ramp.a += texCoordsAlphaLife.z;\n\n    vec3 rgb =     tex.rgb * ramp.rgb;\n    float a =         tex.a * ramp.a;\n\n";
pc.shaderChunks.lightSpecularBlinnPS = "// Energy-conserving (hopefully) Blinn-Phong\nfloat getLightSpecular(inout psInternalData data) {\n    vec3 h = normalize( -data.lightDirNormW + data.viewDirW );\n    float nh = max( dot( h, data.normalW ), 0.0 );\n\n    float specPow = exp2(data.glossiness * 11.0); // glossiness is linear, power is not; 0 - 2048\n    specPow = antiAliasGlossiness(data, specPow);\n\n    // Hack: On Mac OS X, calling pow with zero for the exponent generates hideous artifacts so bias up a little\n    specPow = max(specPow, 0.0001);\n\n    return pow(nh, specPow) * (specPow + 2.0) / 8.0;\n}\n\n";
pc.shaderChunks.shadowCoordVS = "void getLightDirPoint(inout vsInternalData data, vec3 lightPosW) {\n    vec3 lightDirW = vPositionW - lightPosW;\n    data.lightDirNormW = normalize(lightDirW);\n    data.lightPosW = lightPosW;\n}\n\nvoid _getShadowCoordOrtho(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    vMainShadowUv = projPos;\n}\n\nvoid _getShadowCoordPersp(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    vMainShadowUv = projPos;\n}\n\nvoid getShadowCoordOrtho(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPersp(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPerspNormalOffset(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    float distScale = abs(dot(vPositionW - data.lightPosW, data.lightDirNormW)); // fov?\n    vec3 wPos = vPositionW + data.normalW * shadowParams.y * clamp(1.0 - dot(data.normalW, -data.lightDirNormW), 0.0, 1.0) * distScale;\n\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, wPos);\n}\n\nvoid getShadowCoordOrthoNormalOffset(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    vec3 wPos = vPositionW + data.normalW * shadowParams.y * clamp(1.0 - dot(data.normalW, -data.lightDirNormW), 0.0, 1.0); //0.08\n\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, wPos);\n}\n\n";
pc.shaderChunks.rgbmPS = "vec3 decodeRGBM(vec4 rgbm) {\n    vec3 color = (8.0 * rgbm.a) * rgbm.rgb;\n    return color * color;\n}\n\nvec3 texture2DRGBM(sampler2D tex, vec2 uv) {\n    return decodeRGBM(texture2D(tex, uv));\n}\n\nvec3 textureCubeRGBM(samplerCube tex, vec3 uvw) {\n    return decodeRGBM(textureCube(tex, uvw));\n}\n\n";
pc.shaderChunks.reflectionCubePS = "uniform samplerCube texture_cubeMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n    vec3 lookupVec = fixSeams(cubeMapProject(data.reflDirW));\n    lookupVec.x *= -1.0;\n    data.reflection += vec4($textureCubeSAMPLE(texture_cubeMap, lookupVec).rgb, material_reflectionFactor);\n}\n";
pc.shaderChunks.specularConstPS = "uniform vec3 material_specular;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = material_specular;\n}\n\n";
pc.shaderChunks.packDepthMaskPS = "vec4 packFloat(float depth) {\n    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\n    // combination of mod and multiplication and division works better\n    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n    res.x = 0.0;\n    res -= res.xxyz * bit_mask;\n    return res;\n}\n\n";
pc.shaderChunks.diffuseTexPS = "uniform sampler2D texture_diffuseMap;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = texture2DSRGB(texture_diffuseMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.endPS = "   gl_FragColor.rgb = combineColor(data);\n   gl_FragColor.rgb += getEmission(data);\n   gl_FragColor.rgb = addFog(data, gl_FragColor.rgb);\n   gl_FragColor.rgb = toneMap(gl_FragColor.rgb);\n   gl_FragColor.rgb = gammaCorrectOutput(gl_FragColor.rgb);\n   gl_FragColor.a = data.alpha;\n";
pc.shaderChunks.fogNonePS = "vec3 addFog(inout psInternalData data, vec3 color) {\n    return color;\n}\n\n\n";
pc.shaderChunks.gamma1_0PS = "vec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    return texture2D(tex, uv);\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    return textureCube(tex, uvw);\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return color;\n}\n\nvec3 gammaCorrectInput(vec3 color) {\n    return color;\n}\n\nfloat gammaCorrectInput(float color) {\n    return color;\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return color;\n}\n\n";
pc.shaderChunks.fogExp2PS = "uniform vec3 fog_color;\nuniform float fog_density;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = exp(-depth * depth * fog_density * fog_density);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    return mix(fog_color, color, fogFactor);\n}\n";
pc.shaderChunks.lightDiffuseLambertPS = "float getLightDiffuse(inout psInternalData data) {\n    return max(dot(data.normalW, -data.lightDirNormW), 0.0);\n}\n\n";
pc.shaderChunks.diffuseTexConstPS = "uniform sampler2D texture_diffuseMap;\nuniform vec3 material_diffuse;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = texture2DSRGB(texture_diffuseMap, $UV).$CH * material_diffuse;\n}\n\n";
pc.shaderChunks.particleUpdaterSpherePS = "uniform float spawnBoundsSphere;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n    float rnd4 = fract(rndFactor * 1000.0);\n    return emitterPos + normalize(inBounds.xyz - vec3(0.5)) * rnd4 * spawnBoundsSphere;\n}\n\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n    localVelocity += normalize(inBounds - vec3(0.5)) * initialVelocity;\n}\n\n";
pc.shaderChunks.ambientConstantPS = "\nvoid addAmbient(inout psInternalData data) {\n    data.diffuseLight = light_globalAmbient;\n}\n";
pc.shaderChunks.shadowPS = "// ----- Unpacking -----\n\nfloat unpackFloat(vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    return dot(rgbaDepth, bitShift);\n}\n\nfloat unpackMask(vec4 rgbaDepth) {\n    return rgbaDepth.x;\n}\n\nfloat unpackFloatYZW(vec4 enc) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    float v = dot(enc.yzw, bitShift.yzw);\n    return v;\n}\n\n\n// ----- Aux -----\n\nvec3 lessThan2(vec3 a, vec3 b) {\n    return clamp((b - a)*1000.0, 0.0, 1.0); // softer version\n}\n\nvec3 greaterThan2(vec3 a, vec3 b) {\n    return clamp((a - b)*1000.0, 0.0, 1.0); // softer version\n}\n\n\n// ----- Direct/Spot Sampling -----\n\nfloat getShadowHard(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    float depth = unpackFloat(texture2D(shadowMap, data.shadowCoord.xy));\n    return (depth < data.shadowCoord.z) ? 0.0 : 1.0;\n}\n\nfloat getShadowMask(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return unpackMask(texture2D(shadowMap, data.shadowCoord.xy));\n}\n\nfloat _xgetShadowPCF3x3(mat3 depthKernel, inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    mat3 shadowKernel;\n    vec3 shadowCoord = data.shadowCoord;\n    vec3 shadowZ = vec3(shadowCoord.z);\n    shadowKernel[0] = vec3(greaterThan(depthKernel[0], shadowZ));\n    shadowKernel[1] = vec3(greaterThan(depthKernel[1], shadowZ));\n    shadowKernel[2] = vec3(greaterThan(depthKernel[2], shadowZ));\n\n    vec2 fractionalCoord = fract( shadowCoord.xy * shadowParams.x );\n\n    shadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n    shadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\n    vec4 shadowValues;\n    shadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n    shadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n    shadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n    shadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\n    return dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\n\nfloat _getShadowPCF3x3(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    vec3 shadowCoord = data.shadowCoord;\n\n    float xoffset = 1.0 / shadowParams.x; // 1/shadow map width\n    float dx0 = -xoffset;\n    float dx1 = xoffset;\n\n    mat3 depthKernel;\n    depthKernel[0][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx0)));\n    depthKernel[0][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, 0.0)));\n    depthKernel[0][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx1)));\n    depthKernel[1][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx0)));\n    depthKernel[1][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy));\n    depthKernel[1][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx1)));\n    depthKernel[2][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx0)));\n    depthKernel[2][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, 0.0)));\n    depthKernel[2][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx1)));\n\n    return _xgetShadowPCF3x3(depthKernel, data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return _getShadowPCF3x3(data, shadowMap, shadowParams);\n}\n\nfloat _getShadowPCF3x3_YZW(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    vec3 shadowCoord = data.shadowCoord;\n\n    float xoffset = 1.0 / shadowParams.x; // 1/shadow map width\n    float dx0 = -xoffset;\n    float dx1 = xoffset;\n\n    mat3 depthKernel;\n    depthKernel[0][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx0)));\n    depthKernel[0][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, 0.0)));\n    depthKernel[0][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx1)));\n    depthKernel[1][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx0)));\n    depthKernel[1][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy));\n    depthKernel[1][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx1)));\n    depthKernel[2][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx0)));\n    depthKernel[2][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, 0.0)));\n    depthKernel[2][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx1)));\n\n    return _xgetShadowPCF3x3(depthKernel, data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3_YZW(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return _getShadowPCF3x3_YZW(data, shadowMap, shadowParams);\n}\n\n\n// ----- Point Sampling -----\n\nfloat getShadowPointHard(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams) {\n    return float(unpackFloat(textureCube(shadowMap, data.lightDirNormW)) > (length(data.lightDirW) * shadowParams.w + shadowParams.z));\n}\n\nfloat _getShadowPoint(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams, vec3 dir) {\n\n    vec3 tc = normalize(dir);\n    vec3 tcAbs = abs(tc);\n\n    vec4 dirX = vec4(1,0,0, tc.x);\n    vec4 dirY = vec4(0,1,0, tc.y);\n    float majorAxisLength = tc.z;\n    if ((tcAbs.x > tcAbs.y) && (tcAbs.x > tcAbs.z)) {\n        dirX = vec4(0,0,1, tc.z);\n        dirY = vec4(0,1,0, tc.y);\n        majorAxisLength = tc.x;\n    } else if ((tcAbs.y > tcAbs.x) && (tcAbs.y > tcAbs.z)) {\n        dirX = vec4(1,0,0, tc.x);\n        dirY = vec4(0,0,1, tc.z);\n        majorAxisLength = tc.y;\n    }\n\n    float shadowParamsInFaceSpace = ((1.0/shadowParams.x) * 2.0) * abs(majorAxisLength);\n\n    vec3 xoffset = (dirX.xyz * shadowParamsInFaceSpace);\n    vec3 yoffset = (dirY.xyz * shadowParamsInFaceSpace);\n    vec3 dx0 = -xoffset;\n    vec3 dy0 = -yoffset;\n    vec3 dx1 = xoffset;\n    vec3 dy1 = yoffset;\n\n    mat3 shadowKernel;\n    mat3 depthKernel;\n\n    depthKernel[0][0] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy0));\n    depthKernel[0][1] = unpackFloat(textureCube(shadowMap, tc + dx0));\n    depthKernel[0][2] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy1));\n    depthKernel[1][0] = unpackFloat(textureCube(shadowMap, tc + dy0));\n    depthKernel[1][1] = unpackFloat(textureCube(shadowMap, tc));\n    depthKernel[1][2] = unpackFloat(textureCube(shadowMap, tc + dy1));\n    depthKernel[2][0] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy0));\n    depthKernel[2][1] = unpackFloat(textureCube(shadowMap, tc + dx1));\n    depthKernel[2][2] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy1));\n\n    vec3 shadowZ = vec3(length(dir) * shadowParams.w + shadowParams.z);\n\n    shadowKernel[0] = vec3(lessThan2(depthKernel[0], shadowZ));\n    shadowKernel[1] = vec3(lessThan2(depthKernel[1], shadowZ));\n    shadowKernel[2] = vec3(lessThan2(depthKernel[2], shadowZ));\n\n    vec2 uv = (vec2(dirX.w, dirY.w) / abs(majorAxisLength)) * 0.5;\n\n    vec2 fractionalCoord = fract( uv * shadowParams.x );\n\n    shadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n    shadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\n    vec4 shadowValues;\n    shadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n    shadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n    shadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n    shadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\n    return 1.0 - dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\n\nfloat getShadowPointPCF3x3(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams) {\n    return _getShadowPoint(data, shadowMap, shadowParams, data.lightDirW);\n}\n\nvoid normalOffsetPointShadow(inout psInternalData data, vec4 shadowParams) {\n    float distScale = length(data.lightDirW);\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0) * distScale; //0.02\n    vec3 dir = wPos - data.lightPosW;\n    data.lightDirW = dir;\n}\n\n";
pc.shaderChunks.TBNPS = "void getTBN(inout psInternalData data) {\n    data.TBN = mat3(normalize(vTangentW), normalize(vBinormalW), normalize(vNormalW));\n}\n\n";
pc.shaderChunks.particle_halflambertPS = "\n    vec3 negNormal = normal*0.5+0.5;\n    vec3 posNormal = -normal*0.5+0.5;\n    negNormal *= negNormal;\n    posNormal *= posNormal;\n\n\n";
pc.shaderChunks.combineDiffusePS = "vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight;\n}\n\n";
pc.shaderChunks.particleUpdaterInitPS = "varying vec2 vUv0;\n\nuniform sampler2D particleTexIN;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nuniform mat3 emitterMatrix;\nuniform vec3 emitterScale;\n\nuniform vec3 emitterPos, frameRandom, localVelocityDivMult, velocityDivMult;\nuniform float delta, rate, rateDiv, lifetime, numParticles, rotSpeedDivMult, seed;\nuniform float startAngle, startAngle2;\nuniform float initialVelocity;\n\nuniform float graphSampleSize;\nuniform float graphNumSamples;\n\n";
pc.shaderChunks.fogLinearPS = "uniform vec3 fog_color;\nuniform float fog_start;\nuniform float fog_end;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = (fog_end - depth) / (fog_end - fog_start);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    fogFactor = gammaCorrectInput(fogFactor);\n    return mix(fog_color, color, fogFactor);\n}\n";
pc.shaderChunks.aoBakedPS = "uniform sampler2D texture_aoMap;\nvoid applyAO(inout psInternalData data) {\n    data.ao = texture2D(texture_aoMap, $UV).$CH;\n    data.diffuseLight *= data.ao;\n}\n\nvoid occludeSpecular(inout psInternalData data) {\n    // fake specular occlusion from AO\n    float specPow = exp2(data.glossiness * 4.0); // 0 - 128\n    specPow = max(specPow, 0.0001);\n    float specOcc = saturate(pow(data.ao * (data.glossiness + 1.0), specPow));\n\n    data.specularLight *= specOcc;\n    data.reflection *= specOcc;\n}\n\n";
pc.shaderChunks.particle_endVS = "\n    localPos *= scale * emitterScale;\n    localPos += particlePos;\n\n    gl_Position = matrix_viewProjection * vec4(localPos.xyz, 1.0);\n}\n";
pc.shaderChunks.particle_softPS = "\n    vec2 screenTC = gl_FragCoord.xy / screenSize.xy;\n    float depth = unpackFloat( texture2D(uDepthMap, screenTC) ) * camera_far;\n    float particleDepth = gl_FragCoord.z / gl_FragCoord.w;\n    float depthDiff = saturate(abs(particleDepth - depth) * softening);\n    a *= depthDiff;\n\n";
pc.shaderChunks.specularTexConstPS = "uniform sampler2D texture_specularMap;\nuniform vec3 material_specular;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = texture2D(texture_specularMap, $UV).$CH * material_specular;\n}\n\n";
pc.shaderChunks.startPS = "\nvoid main(void) {\n    psInternalData data;\n\tdata.diffuseLight = vec3(0);\n\tdata.specularLight = vec3(0);\n    data.reflection = vec4(0);\n\n\n";
pc.shaderChunks.lightmapSinglePS = "uniform sampler2D texture_lightMap;\nvoid addAmbient(inout psInternalData data) {\n    data.diffuseLight = texture2D(texture_lightMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.particleUpdaterOnStopPS = "    life = life < 0.0? particleLifetime + 1.0 : life;\n\n";
pc.shaderChunks.instancingVS = "\nattribute vec4 instance_line1;\nattribute vec4 instance_line2;\nattribute vec4 instance_line3;\nattribute vec4 instance_line4;\n\n";
pc.programlib = {getSnippet:function(device, id) {
  var code = "";
  switch(id) {
    case "common_main_begin":
      code += "void main(void)\n{\n";
      break;
    case "common_main_end":
      code += "}\n";
      break;
    case "fs_alpha_test_decl":
      code += "uniform float alpha_ref;\n";
      break;
    case "fs_alpha_test":
      code += "    if (gl_FragColor.a < alpha_ref) discard;\n\n";
      break;
    case "fs_clamp":
      code += "    gl_FragColor = clamp(gl_FragColor, 0.0, 1.0);\n";
      break;
    case "fs_flat_color_decl":
      code += "uniform vec4 uColor;\n";
      break;
    case "fs_flat_color":
      code += "    gl_FragColor = uColor;\n";
      break;
    case "fs_fog_linear_decl":
    ;
    case "fs_fog_exp_decl":
    ;
    case "fs_fog_exp2_decl":
      code += "uniform vec3 fog_color;\n";
      if(id === "fs_fog_linear_decl") {
        code += "uniform float fog_start;\n";
        code += "uniform float fog_end;\n\n"
      }else {
        code += "uniform float fog_density;\n\n"
      }
      break;
    case "fs_fog_linear":
    ;
    case "fs_fog_exp":
    ;
    case "fs_fog_exp2":
      code += "    float depth = gl_FragCoord.z / gl_FragCoord.w;\n";
      if(id === "fs_fog_linear") {
        code += "    float fogFactor = (fog_end - depth) / (fog_end - fog_start);\n"
      }else {
        if(id === "fs_fog_exp") {
          code += "    float fogFactor = exp(-depth * fog_density);\n"
        }else {
          code += "    float fogFactor = exp(-depth * depth * fog_density * fog_density);\n"
        }
      }
      code += "    fogFactor = clamp(fogFactor, 0.0, 1.0);\n";
      code += "    gl_FragColor.rgb = mix(fog_color, gl_FragColor.rgb, fogFactor);\n";
      break;
    case "fs_precision":
      code += "precision " + device.precision + " float;\n\n";
      break;
    case "fs_height_map_funcs":
      code += "vec3 perturb_normal( vec3 N, vec3 p, vec2 uv )\n";
      code += "{\n";
      code += "    vec3 dp1 = dFdx( p );\n";
      code += "    vec3 dp2 = dFdy( p );\n";
      code += "    vec2 duv1 = dFdx( uv );\n";
      code += "    vec2 duv2 = dFdy( uv );\n\n";
      code += "    vec3 dp2perp = cross( dp2, N );\n";
      code += "    vec3 dp1perp = cross( N, dp1 );\n\n";
      code += "    const float bumpScale = 0.125;\n";
      code += "    float Hll = bumpScale * texture2D( texture_heightMap, uv ).x;\n";
      code += "    float dBx = bumpScale * texture2D( texture_heightMap, uv + duv1 ).x - Hll;\n";
      code += "    float dBy = bumpScale * texture2D( texture_heightMap, uv + duv2 ).x - Hll;\n\n";
      code += "    float fDet = dot( dp1, dp2perp );\n";
      code += "    vec3 vGrad = sign( fDet ) * ( dBx * dp2perp + dBy * dp1perp );\n";
      code += "    return normalize( abs( fDet ) * N - vGrad );\n";
      code += "}\n\n";
      break;
    case "fs_normal_map_funcs":
      if(!pc.precalculatedTangents) {
        code += "mat3 cotangent_frame( vec3 N, vec3 p, vec2 uv )\n";
        code += "{\n";
        code += "    vec3 dp1 = dFdx( p );\n";
        code += "    vec3 dp2 = dFdy( p );\n";
        code += "    vec2 duv1 = dFdx( uv );\n";
        code += "    vec2 duv2 = dFdy( uv );\n\n";
        code += "    vec3 dp2perp = cross( dp2, N );\n";
        code += "    vec3 dp1perp = cross( N, dp1 );\n";
        code += "    vec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n";
        code += "    vec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n\n";
        code += "    float invmax = inversesqrt( max( dot(T,T), dot(B,B) ) );\n";
        code += "    return mat3( T * invmax, B * invmax, N );\n";
        code += "}\n\n";
        code += "vec3 perturb_normal( vec3 N, vec3 V, vec2 uv )\n";
        code += "{\n";
        code += "    vec3 map = texture2D( texture_normalMap, uv ).xyz;\n";
        code += "    map = map * 255./127. - 128./127.;\n";
        code += "    map.xy = map.xy * material_bumpMapFactor;\n";
        code += "    mat3 TBN = cotangent_frame( N, -V, uv );\n";
        code += "    return normalize( TBN * map );\n";
        code += "}\n\n"
      }
      break;
    case "vs_skin_decl":
      if(device.supportsBoneTextures) {
        code += ["attribute vec4 vertex_boneWeights;", "attribute vec4 vertex_boneIndices;", "", "uniform sampler2D texture_poseMap;", "uniform vec2 texture_poseMapSize;", "", "mat4 getBoneMatrix(const in float i)", "{", "    float j = i * 4.0;", "    float x = mod(j, float(texture_poseMapSize.x));", "    float y = floor(j / float(texture_poseMapSize.x));", "", "    float dx = 1.0 / float(texture_poseMapSize.x);", "    float dy = 1.0 / float(texture_poseMapSize.y);", "", "    y = dy * (y + 0.5);",
        "", "    vec4 v1 = texture2D(texture_poseMap, vec2(dx * (x + 0.5), y));", "    vec4 v2 = texture2D(texture_poseMap, vec2(dx * (x + 1.5), y));", "    vec4 v3 = texture2D(texture_poseMap, vec2(dx * (x + 2.5), y));", "    vec4 v4 = texture2D(texture_poseMap, vec2(dx * (x + 3.5), y));", "", "    mat4 bone = mat4(v1, v2, v3, v4);", "", "    return bone;", "}"].join("\n")
      }else {
        code += ["attribute vec4 vertex_boneWeights;", "attribute vec4 vertex_boneIndices;", "", "uniform mat4 matrix_pose[" + device.getBoneLimit() + "];", "", "mat4 getBoneMatrix(const in float i)", "{", "    mat4 bone = matrix_pose[int(i)];", "", "    return bone;", "}"].join("\n")
      }
      code += "\n\n";
      break;
    case "vs_transform_decl":
      code += "attribute vec3 vertex_position;\n";
      code += "uniform mat4 matrix_model;\n";
      code += "uniform mat4 matrix_viewProjection;\n\n";
      break
  }
  return code
}, gammaCode:function(value) {
  return value === pc.GAMMA_NONE ? pc.shaderChunks.gamma1_0PS : value === pc.GAMMA_SRGBFAST ? pc.shaderChunks.gamma2_2FastPS : pc.shaderChunks.gamma2_2PS
}, tonemapCode:function(value) {
  return value ? pc.shaderChunks.tonemappingFilmicPS : pc.shaderChunks.tonemappingLinearPS
}};
pc.programlib.basic = {generateKey:function(device, options) {
  var key = "basic";
  if(options.fog) {
    key += "_fog"
  }
  if(options.alphaTest) {
    key += "_atst"
  }
  if(options.vertexColors) {
    key += "_vcol"
  }
  if(options.diffuseMap) {
    key += "_diff"
  }
  return key
}, createShaderDefinition:function(device, options) {
  var attributes = {vertex_position:pc.SEMANTIC_POSITION};
  if(options.skin) {
    attributes.vertex_boneWeights = pc.SEMANTIC_BLENDWEIGHT;
    attributes.vertex_boneIndices = pc.SEMANTIC_BLENDINDICES
  }
  if(options.vertexColors) {
    attributes.vertex_color = pc.SEMANTIC_COLOR
  }
  if(options.diffuseMap) {
    attributes.vertex_texCoord0 = pc.SEMANTIC_TEXCOORD0
  }
  var getSnippet = pc.programlib.getSnippet;
  var code = "";
  code += getSnippet(device, "vs_transform_decl");
  if(options.skin) {
    code += getSnippet(device, "vs_skin_decl")
  }
  if(options.vertexColors) {
    code += "attribute vec4 vertex_color;\n";
    code += "varying vec4 vColor;\n"
  }
  if(options.diffuseMap) {
    code += "attribute vec2 vertex_texCoord0;\n";
    code += "varying vec2 vUv0;\n"
  }
  code += getSnippet(device, "common_main_begin");
  if(options.skin) {
    code += "    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n";
    code += "                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n";
    code += "                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n";
    code += "                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"
  }else {
    code += "    mat4 modelMatrix = matrix_model;\n"
  }
  code += "\n";
  code += "    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";
  code += "    gl_Position = matrix_viewProjection * positionW;\n\n";
  if(options.vertexColors) {
    code += "    vColor = vertex_color;\n"
  }
  if(options.diffuseMap) {
    code += "    vUv0 = vertex_texCoord0;\n"
  }
  code += getSnippet(device, "common_main_end");
  var vshader = code;
  code = getSnippet(device, "fs_precision");
  if(options.vertexColors) {
    code += "varying vec4 vColor;\n"
  }else {
    code += "uniform vec4 uColor;\n"
  }
  if(options.diffuseMap) {
    code += "varying vec2 vUv0;\n";
    code += "uniform sampler2D texture_diffuseMap;\n"
  }
  if(options.fog) {
    code += getSnippet(device, "fs_fog_decl")
  }
  if(options.alphatest) {
    code += getSnippet(device, "fs_alpha_test_decl")
  }
  code += getSnippet(device, "common_main_begin");
  if(options.vertexColors) {
    code += "    gl_FragColor = vColor;\n"
  }else {
    code += "    gl_FragColor = uColor;\n"
  }
  if(options.diffuseMap) {
    code += "    gl_FragColor *= texture2D(texture_diffuseMap, vUv0);\n"
  }
  if(options.alphatest) {
    code += getSnippet(device, "fs_alpha_test")
  }
  code += getSnippet(device, "fs_clamp");
  if(options.fog) {
    code += getSnippet(device, "fs_fog")
  }
  code += getSnippet(device, "common_main_end");
  var fshader = code;
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.depth = {generateKey:function(device, options) {
  var key = "depth";
  if(options.skin) {
    key += "_skin"
  }
  if(options.opacityMap) {
    key += "_opam"
  }
  return key
}, createShaderDefinition:function(device, options) {
  var attributes = {vertex_position:pc.SEMANTIC_POSITION};
  if(options.skin) {
    attributes.vertex_boneWeights = pc.SEMANTIC_BLENDWEIGHT;
    attributes.vertex_boneIndices = pc.SEMANTIC_BLENDINDICES
  }
  if(options.opacityMap) {
    attributes.vertex_texCoord0 = pc.SEMANTIC_TEXCOORD0
  }
  var getSnippet = pc.programlib.getSnippet;
  var code = "";
  code += getSnippet(device, "vs_transform_decl");
  if(options.skin) {
    code += getSnippet(device, "vs_skin_decl")
  }
  if(options.opacityMap) {
    code += "attribute vec2 vertex_texCoord0;\n\n";
    code += "varying vec2 vUv0;\n\n"
  }
  code += getSnippet(device, "common_main_begin");
  if(options.skin) {
    code += "    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n";
    code += "                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n";
    code += "                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n";
    code += "                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"
  }else {
    code += "    mat4 modelMatrix = matrix_model;\n"
  }
  code += "\n";
  code += "    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";
  code += "    gl_Position = matrix_viewProjection * positionW;\n\n";
  if(options.opacityMap) {
    code += "    vUv0 = vertex_texCoord0;\n"
  }
  code += getSnippet(device, "common_main_end");
  var vshader = code;
  code = getSnippet(device, "fs_precision");
  code += "uniform float camera_near;\n";
  code += "uniform float camera_far;\n";
  code += "vec4 packFloat(float depth)\n";
  code += "{\n";
  code += "    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n";
  code += "    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n";
  code += "    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n";
  code += "    res -= res.xxyz * bit_mask;\n";
  code += "    return res;\n";
  code += "}\n\n";
  code += getSnippet(device, "common_main_begin");
  code += "float depth = gl_FragCoord.z / gl_FragCoord.w;\n";
  code += "gl_FragColor = packFloat(depth / camera_far);\n";
  code += getSnippet(device, "common_main_end");
  var fshader = code;
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.depthrgba = {generateKey:function(device, options) {
  var key = "depthrgba";
  if(options.skin) {
    key += "_skin"
  }
  if(options.opacityMap) {
    key += "_opam" + options.opacityChannel
  }
  if(options.point) {
    key += "_pnt"
  }
  key += "_" + options.shadowType;
  return key
}, createShaderDefinition:function(device, options) {
  var attributes = {vertex_position:pc.SEMANTIC_POSITION};
  if(options.skin) {
    attributes.vertex_boneWeights = pc.SEMANTIC_BLENDWEIGHT;
    attributes.vertex_boneIndices = pc.SEMANTIC_BLENDINDICES
  }
  if(options.opacityMap) {
    attributes.vertex_texCoord0 = pc.SEMANTIC_TEXCOORD0
  }
  var getSnippet = pc.programlib.getSnippet;
  var code = "";
  code += getSnippet(device, "vs_transform_decl");
  if(options.skin) {
    code += getSnippet(device, "vs_skin_decl")
  }
  if(options.opacityMap) {
    code += "attribute vec2 vertex_texCoord0;\n\n";
    code += "varying vec2 vUv0;\n\n"
  }
  if(options.point) {
    code += "varying vec3 worldPos;\n\n"
  }
  code += getSnippet(device, "common_main_begin");
  if(options.skin) {
    code += "    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n";
    code += "                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n";
    code += "                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n";
    code += "                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"
  }else {
    code += "    mat4 modelMatrix = matrix_model;\n"
  }
  code += "\n";
  code += "    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";
  code += "    gl_Position = matrix_viewProjection * positionW;\n\n";
  if(options.opacityMap) {
    code += "    vUv0 = vertex_texCoord0;\n"
  }
  if(options.point) {
    code += "    worldPos = positionW.xyz;\n"
  }
  code += getSnippet(device, "common_main_end");
  var vshader = code;
  code = getSnippet(device, "fs_precision");
  if(options.opacityMap) {
    code += "varying vec2 vUv0;\n\n";
    code += "uniform sampler2D texture_opacityMap;\n\n"
  }
  if(options.point) {
    code += "varying vec3 worldPos;\n\n";
    code += "uniform vec3 view_position;\n\n";
    code += "uniform float light_radius;\n\n"
  }
  var chunks = pc.shaderChunks;
  if(options.shadowType === pc.SHADOW_DEPTHMASK) {
    code += chunks.packDepthMaskPS
  }else {
    code += chunks.packDepthPS
  }
  code += getSnippet(device, "common_main_begin");
  if(options.opacityMap) {
    code += "    if (texture2D(texture_opacityMap, vUv0)." + options.opacityChannel + " < 0.25) discard;\n\n"
  }
  if(options.point) {
    code += "   gl_FragData[0] = packFloat(min(distance(view_position, worldPos) / light_radius, 0.99999));\n"
  }else {
    code += "    gl_FragData[0] = packFloat(gl_FragCoord.z);\n"
  }
  code += getSnippet(device, "common_main_end");
  var fshader = code;
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.particle = {generateKey:function(device, options) {
  var key = "particle";
  for(prop in options) {
    if(options.hasOwnProperty(prop)) {
      key += options[prop]
    }
  }
  return key
}, createShaderDefinition:function(device, options) {
  var getSnippet = pc.programlib.getSnippet;
  var chunk = pc.shaderChunks;
  var vshader = "";
  var fshader = getSnippet(device, "fs_precision") + "\n";
  if(!options.useCpu) {
    if(options.normal == 1) {
      vshader += "\nvarying vec3 Normal;\n"
    }
    if(options.normal == 2) {
      vshader += "\nvarying mat3 ParticleMat;\n"
    }
    vshader += chunk.particleVS;
    if(options.wrap) {
      vshader += chunk.particle_wrapVS
    }
    if(options.alignToMotion) {
      vshader += chunk.particle_pointAlongVS
    }
    vshader += options.mesh ? chunk.particle_meshVS : chunk.particle_billboardVS;
    if(options.normal == 1) {
      vshader += chunk.particle_normalVS
    }
    if(options.normal == 2) {
      vshader += chunk.particle_TBNVS
    }
    if(options.stretch > 0) {
      vshader += chunk.particle_stretchVS
    }
    vshader += chunk.particle_endVS
  }else {
    if(options.normal == 1) {
      vshader += "\nvarying vec3 Normal;\n"
    }
    if(options.normal == 2) {
      vshader += "\nvarying mat3 ParticleMat;\n"
    }
    vshader += chunk.particle_cpuVS;
    if(options.alignToMotion) {
      vshader += chunk.particle_pointAlongVS
    }
    vshader += options.mesh ? chunk.particle_meshVS : chunk.particle_billboardVS;
    if(options.normal == 1) {
      vshader += chunk.particle_normalVS
    }
    if(options.normal == 2) {
      vshader += chunk.particle_TBNVS
    }
    if(options.stretch > 0) {
      vshader += chunk.particle_stretchVS
    }
    vshader += chunk.particle_cpu_endVS
  }
  if(options.normal > 0) {
    if(options.normal == 1) {
      fshader += "\nvarying vec3 Normal;\n"
    }else {
      if(options.normal == 2) {
        fshader += "\nvarying mat3 ParticleMat;\n"
      }
    }
    fshader += "\nuniform vec3 lightCube[6];\n"
  }
  if(options.normal == 0 && options.fog == "none") {
    options.srgb = false
  }
  fshader += pc.programlib.gammaCode(options.gamma);
  fshader += "struct psInternalData {float dummy;};\n";
  fshader += pc.programlib.tonemapCode(options.toneMap);
  if(options.fog === "linear") {
    fshader += chunk.fogLinearPS
  }else {
    if(options.fog === "exp") {
      fshader += chunk.fogExpPS
    }else {
      if(options.fog === "exp2") {
        fshader += chunk.fogExp2PS
      }else {
        fshader += chunk.fogNonePS
      }
    }
  }
  if(options.normal == 2) {
    fshader += "\nuniform sampler2D normalMap;\n"
  }
  if(options.soft > 0) {
    fshader += "\nuniform sampler2D uDepthMap;\n"
  }
  fshader += chunk.particlePS;
  if(options.soft > 0) {
    fshader += chunk.particle_softPS
  }
  if(options.normal == 1) {
    fshader += "\nvec3 normal = Normal;\n"
  }
  if(options.normal == 2) {
    fshader += chunk.particle_normalMapPS
  }
  if(options.normal > 0) {
    fshader += options.halflambert ? chunk.particle_halflambertPS : chunk.particle_lambertPS
  }
  if(options.normal > 0) {
    fshader += chunk.particle_lightingPS
  }
  if(options.blend == pc.BLEND_NORMAL) {
    fshader += chunk.particle_blendNormalPS
  }else {
    if(options.blend == pc.BLEND_ADDITIVE) {
      fshader += chunk.particle_blendAddPS
    }else {
      if(options.blend == pc.BLEND_MULTIPLICATIVE) {
        fshader += chunk.particle_blendMultiplyPS
      }
    }
  }
  fshader += chunk.particle_endPS;
  var attributes = pc.shaderChunks.collectAttribs(vshader);
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.phong = {hashCode:function(str) {
  var hash = 0;
  if(str.length == 0) {
    return hash
  }
  for(i = 0;i < str.length;i++) {
    char = str.charCodeAt(i);
    hash = (hash << 5) - hash + char;
    hash = hash & hash
  }
  return hash
}, generateKey:function(device, options) {
  var props = [];
  var key = "phong";
  for(prop in options) {
    if(prop === "lights") {
      for(var i = 0;i < options.lights.length;i++) {
        props.push(options.lights[i].getType() + "_" + (options.lights[i].getCastShadows() ? 1 : 0) + "_" + options.lights[i].getFalloffMode() + "_" + !!options.lights[i].getNormalOffsetBias())
      }
    }else {
      if(prop === "chunks") {
        for(var p in options[prop]) {
          if(options[prop].hasOwnProperty(p)) {
            props.push(p + options.chunks[p])
          }
        }
      }else {
        if(options[prop]) {
          props.push(prop)
        }
      }
    }
  }
  props.sort();
  for(prop in props) {
    key += props[prop] + options[props[prop]]
  }
  return this.hashCode(key)
}, _setMapTransform:function(codes, name, id, uv) {
  codes[0] += "uniform vec4 texture_" + name + "MapTransform;\n";
  var checkId = id + uv * 100;
  if(!codes[3][checkId]) {
    codes[1] += "varying vec2 vUV" + uv + "_" + id + ";\n";
    codes[2] += "   vUV" + uv + "_" + id + " = uv" + uv + " * texture_" + name + "MapTransform.xy + texture_" + name + "MapTransform.zw;\n";
    codes[3][checkId] = true
  }
  return codes
}, _uvSource:function(id, uv) {
  return id == 0 ? "vUv" + uv : "vUV" + uv + "_" + id
}, _addMap:function(p, options, chunks, uvOffset, subCode, format) {
  var mname = p + "Map";
  if(options[mname]) {
    var tname = mname + "Transform";
    var cname = mname + "Channel";
    var uname = mname + "Uv";
    var uv = this._uvSource(options[tname], options[uname]) + uvOffset;
    if(!subCode) {
      if(options[p + "Tint"]) {
        subCode = chunks[p + "TexConstPS"]
      }else {
        subCode = chunks[p + "TexPS"]
      }
    }
    if(format !== undefined) {
      var fmt = format === 0 ? "texture2DSRGB" : format === 1 ? "texture2DRGBM" : "texture2D";
      subCode = subCode.replace(/\$texture2DSAMPLE/g, fmt)
    }
    return subCode.replace(/\$UV/g, uv).replace(/\$CH/g, options[cname])
  }else {
    return chunks[p + "ConstPS"]
  }
}, _nonPointShadowMapProjection:function(light, shadowCoordArgs) {
  if(!light.getNormalOffsetBias()) {
    if(light.getType() == pc.LIGHTTYPE_SPOT) {
      return"   getShadowCoordPersp" + shadowCoordArgs
    }else {
      return"   getShadowCoordOrtho" + shadowCoordArgs
    }
  }else {
    if(light.getType() == pc.LIGHTTYPE_SPOT) {
      return"   getShadowCoordPerspNormalOffset" + shadowCoordArgs
    }else {
      return"   getShadowCoordOrthoNormalOffset" + shadowCoordArgs
    }
  }
}, _addVaryingIfNeeded:function(code, type, name) {
  return code.indexOf(name) >= 0 ? "varying " + type + " " + name + ";\n" : ""
}, createShaderDefinition:function(device, options) {
  var i;
  var lighting = options.lights.length > 0;
  if(options.shadingModel === pc.SPECULAR_PHONG) {
    options.fresnelModel = 0;
    options.specularAA = false;
    options.prefilteredCubemap = false
  }else {
    options.fresnelModel = options.fresnelModel === 0 ? pc.FRESNEL_SCHLICK : options.fresnelModel
  }
  var cubemapReflection = options.cubeMap || options.prefilteredCubemap;
  var reflections = options.sphereMap || cubemapReflection;
  var useTangents = pc.precalculatedTangents;
  var useTexCubeLod = options.useTexCubeLod;
  if(options.cubeMap || options.prefilteredCubemap) {
    options.sphereMap = null
  }
  if(!options.useSpecular) {
    options.specularMap = options.glossMap = null
  }
  this.options = options;
  var getSnippet = pc.programlib.getSnippet;
  var code = "";
  var codeBody = "";
  var varyings = "";
  var chunks = pc.shaderChunks;
  if(options.chunks) {
    var customChunks = [];
    for(var p in chunks) {
      if(chunks.hasOwnProperty(p)) {
        if(!options.chunks[p]) {
          customChunks[p] = chunks[p]
        }else {
          customChunks[p] = options.chunks[p];
          if(!lighting && !reflections) {
            customChunks[p] = customChunks[p].replace(/vertex_normal/g, "vec3(0)").replace(/vertex_tangent/g, "vec4(0)")
          }
        }
      }
    }
    chunks = customChunks
  }
  code += chunks.baseVS;
  var mainShadowLight = -1;
  if(!options.noShadow) {
    for(i = 0;i < options.lights.length;i++) {
      var lightType = options.lights[i].getType();
      if(options.lights[i].getCastShadows()) {
        if(lightType !== pc.LIGHTTYPE_POINT) {
          code += "uniform mat4 light" + i + "_shadowMatrixVS;\n";
          code += "uniform vec3 light" + i + "_shadowParamsVS;\n";
          code += "uniform vec3 light" + i + (lightType === pc.LIGHTTYPE_DIRECTIONAL ? "_directionVS" : "_positionVS") + ";\n";
          mainShadowLight = i;
          break
        }
      }
    }
    if(mainShadowLight >= 0) {
      code += chunks.shadowCoordVS
    }
  }
  var attributes = {vertex_position:pc.SEMANTIC_POSITION};
  codeBody += "   vPositionW    = getWorldPosition(data);\n";
  if(options.useInstancing) {
    attributes.instance_line1 = pc.SEMANTIC_TEXCOORD2;
    attributes.instance_line2 = pc.SEMANTIC_TEXCOORD3;
    attributes.instance_line3 = pc.SEMANTIC_TEXCOORD4;
    attributes.instance_line4 = pc.SEMANTIC_TEXCOORD5;
    code += chunks.instancingVS
  }
  if(lighting || reflections) {
    attributes.vertex_normal = pc.SEMANTIC_NORMAL;
    codeBody += "   vNormalW    = data.normalW = getNormal(data);\n";
    if(options.sphereMap && device.fragmentUniformsCount <= 16) {
      code += chunks.viewNormalVS;
      codeBody += "   vNormalV    = getViewNormal(data);\n"
    }
    if((options.heightMap || options.normalMap) && useTangents) {
      attributes.vertex_tangent = pc.SEMANTIC_TANGENT;
      code += chunks.tangentBinormalVS;
      codeBody += "   vTangentW   = getTangent(data);\n";
      codeBody += "   vBinormalW  = getBinormal(data);\n"
    }
    if(mainShadowLight >= 0) {
      if(lightType == pc.LIGHTTYPE_DIRECTIONAL) {
        codeBody += "   data.lightDirNormW = light" + mainShadowLight + "_directionVS;\n"
      }else {
        codeBody += "   getLightDirPoint(data, light" + mainShadowLight + "_positionVS);\n"
      }
      var shadowCoordArgs = "(data, light" + mainShadowLight + "_shadowMatrixVS, light" + mainShadowLight + "_shadowParamsVS);\n";
      codeBody += this._nonPointShadowMapProjection(options.lights[mainShadowLight], shadowCoordArgs)
    }
  }
  var useUv = [];
  var useUnmodifiedUv = [];
  var maxUvSets = 2;
  for(var p in pc._matTex2D) {
    var mname = p + "Map";
    if(options[mname]) {
      var tname = mname + "Transform";
      var uname = mname + "Uv";
      var cname = mname + "Channel";
      options[uname] = Math.min(options[uname], maxUvSets - 1);
      if(pc._matTex2D[p] > 0) {
        if(pc._matTex2D[p] < options[cname].length) {
          options[cname] = options[cname].substring(0, pc._matTex2D[p])
        }else {
          if(pc._matTex2D[p] > options[cname].length) {
            var str = options[cname];
            var chr = str.charAt(str.length - 1);
            var addLen = pc._matTex2D[p] - str.length;
            for(i = 0;i < addLen;i++) {
              str += chr
            }
            options[cname] = str
          }
        }
      }
      var uvSet = options[uname];
      useUv[uvSet] = true;
      useUnmodifiedUv[uvSet] = useUnmodifiedUv[uvSet] || options[mname] && !options[tname]
    }
  }
  for(i = 0;i < maxUvSets;i++) {
    if(useUv[i]) {
      attributes["vertex_texCoord" + i] = pc["SEMANTIC_TEXCOORD" + i];
      code += chunks["uv" + i + "VS"];
      codeBody += "   vec2 uv" + i + " = getUv" + i + "(data);\n"
    }
    if(useUnmodifiedUv[i]) {
      codeBody += "   vUv" + i + " = uv" + i + ";\n"
    }
  }
  var codes = [code, varyings, codeBody, []];
  for(var p in pc._matTex2D) {
    var mname = p + "Map";
    if(options[mname]) {
      var tname = mname + "Transform";
      if(options[tname]) {
        var uname = mname + "Uv";
        this._setMapTransform(codes, p, options[tname], options[uname])
      }
    }
  }
  code = codes[0];
  varyings = codes[1];
  codeBody = codes[2];
  if(options.vertexColors) {
    attributes.vertex_color = pc.SEMANTIC_COLOR
  }
  if(options.skin) {
    attributes.vertex_boneWeights = pc.SEMANTIC_BLENDWEIGHT;
    attributes.vertex_boneIndices = pc.SEMANTIC_BLENDINDICES;
    code += getSnippet(device, "vs_skin_decl");
    code += chunks.transformSkinnedVS;
    if(lighting || reflections) {
      code += chunks.normalSkinnedVS
    }
  }else {
    if(options.useInstancing) {
      code += chunks.transformInstancedVS;
      if(lighting || reflections) {
        code += chunks.normalInstancedVS
      }
    }else {
      code += chunks.transformVS;
      if(lighting || reflections) {
        code += chunks.normalVS
      }
    }
  }
  code += "\n";
  code += chunks.startVS;
  code += codeBody;
  code += "}";
  var vshader = code;
  var oldVars = varyings;
  varyings = "";
  varyings += this._addVaryingIfNeeded(code, "vec4", "vMainShadowUv");
  varyings += this._addVaryingIfNeeded(code, "vec3", "vPositionW");
  varyings += this._addVaryingIfNeeded(code, "vec3", "vNormalV");
  varyings += this._addVaryingIfNeeded(code, "vec3", "vNormalW");
  varyings += this._addVaryingIfNeeded(code, "vec3", "vTangentW");
  varyings += this._addVaryingIfNeeded(code, "vec3", "vBinormalW");
  varyings += this._addVaryingIfNeeded(code, "vec2", "vUv0");
  varyings += this._addVaryingIfNeeded(code, "vec2", "vUv1");
  varyings += oldVars;
  vshader = varyings + vshader;
  if(options.forceFragmentPrecision && options.forceFragmentPrecision != "highp" && options.forceFragmentPrecision != "mediump" && options.forceFragmentPrecision != "lowp") {
    options.forceFragmentPrecision = null
  }
  if(options.forceFragmentPrecision) {
    if(options.forceFragmentPrecision === "highp" && device.maxPrecision !== "highp") {
      options.forceFragmentPrecision = "mediump"
    }
    if(options.forceFragmentPrecision === "mediump" && device.maxPrecision === "lowp") {
      options.forceFragmentPrecision = "lowp"
    }
  }
  var fshader;
  code = options.forceFragmentPrecision ? "precision " + options.forceFragmentPrecision + " float;\n\n" : getSnippet(device, "fs_precision");
  if(options.customFragmentShader) {
    fshader = code + options.customFragmentShader;
    return{attributes:attributes, vshader:vshader, fshader:fshader}
  }
  code += varyings;
  code += chunks.basePS;
  var numShadowLights = 0;
  for(i = 0;i < options.lights.length;i++) {
    var lightType = options.lights[i].getType();
    code += "uniform vec3 light" + i + "_color;\n";
    if(lightType == pc.LIGHTTYPE_DIRECTIONAL) {
      code += "uniform vec3 light" + i + "_direction;\n"
    }else {
      code += "uniform vec3 light" + i + "_position;\n";
      code += "uniform float light" + i + "_radius;\n";
      if(lightType == pc.LIGHTTYPE_SPOT) {
        code += "uniform vec3 light" + i + "_spotDirection;\n";
        code += "uniform float light" + i + "_innerConeAngle;\n";
        code += "uniform float light" + i + "_outerConeAngle;\n"
      }
    }
    if(options.lights[i].getCastShadows() && !options.noShadow) {
      code += "uniform mat4 light" + i + "_shadowMatrix;\n";
      if(lightType == pc.LIGHTTYPE_POINT) {
        code += "uniform vec4 light" + i + "_shadowParams;\n"
      }else {
        code += "uniform vec3 light" + i + "_shadowParams;\n"
      }
      if(lightType == pc.LIGHTTYPE_POINT) {
        code += "uniform samplerCube light" + i + "_shadowMap;\n"
      }else {
        code += "uniform sampler2D light" + i + "_shadowMap;\n"
      }
      numShadowLights++
    }
  }
  if(options.alphaTest) {
    code += getSnippet(device, "fs_alpha_test_decl")
  }
  code += "\n";
  var uvOffset = options.heightMap ? " + data.uvOffset" : "";
  var tbn = options.fastTbn ? chunks.TBNfastPS : chunks.TBNPS;
  if(lighting || reflections) {
    if(options.normalMap && useTangents) {
      code += options.packedNormal ? chunks.normalXYPS : chunks.normalXYZPS;
      var uv = this._uvSource(options.normalMapTransform, options.normalMapUv) + uvOffset;
      if(options.needsNormalFloat) {
        code += (options.fastTbn ? chunks.normalMapFloatTBNfastPS : chunks.normalMapFloatPS).replace(/\$UV/g, uv)
      }else {
        code += chunks.normalMapPS.replace(/\$UV/g, uv)
      }
      code += tbn
    }else {
      code += chunks.normalVertexPS
    }
  }
  code += pc.programlib.gammaCode(options.gamma);
  code += pc.programlib.tonemapCode(options.toneMap);
  if(options.fog === "linear") {
    code += chunks.fogLinearPS
  }else {
    if(options.fog === "exp") {
      code += chunks.fogExpPS
    }else {
      if(options.fog === "exp2") {
        code += chunks.fogExp2PS
      }else {
        code += chunks.fogNonePS
      }
    }
  }
  if(options.rgbmReflection) {
    code += chunks.rgbmPS
  }
  if(cubemapReflection) {
    code += options.fixSeams ? chunks.fixCubemapSeamsStretchPS : chunks.fixCubemapSeamsNonePS;
    code += options.cubeMapProjection > 0 ? chunks.cubeMapProjectBoxPS : chunks.cubeMapProjectNonePS
  }
  code += this._addMap("diffuse", options, chunks, uvOffset);
  code += this._addMap("opacity", options, chunks, uvOffset);
  code += this._addMap("emissive", options, chunks, uvOffset, null, options.emissiveFormat);
  if(options.useSpecular) {
    if(options.specularAA && options.normalMap) {
      if(options.needsNormalFloat && (lighting || reflections)) {
        code += chunks.specularAaToksvigFloatPS
      }else {
        code += chunks.specularAaToksvigPS
      }
    }else {
      code += chunks.specularAaNonePS
    }
    code += this._addMap(options.useMetalness ? "metalness" : "specular", options, chunks, uvOffset);
    code += this._addMap("gloss", options, chunks, uvOffset);
    if(options.fresnelModel > 0) {
      if(options.fresnelModel === pc.FRESNEL_SIMPLE) {
        code += chunks.fresnelSimplePS
      }else {
        if(options.fresnelModel === pc.FRESNEL_SCHLICK) {
          code += chunks.fresnelSchlickPS
        }else {
          if(options.fresnelModel === pc.FRESNEL_COMPLEX) {
            code += chunks.fresnelComplexPS
          }
        }
      }
    }
  }
  if(options.heightMap) {
    if(!options.normalMap) {
      code += tbn
    }
    code += this._addMap("height", options, chunks, "", chunks.parallaxPS)
  }
  if(options.aoMap) {
    code += this._addMap("ao", options, chunks, uvOffset, chunks.aoBakedPS)
  }
  var reflectionDecode = options.rgbmReflection ? "decodeRGBM" : options.hdrReflection ? "" : "gammaCorrectInput";
  if(cubemapReflection) {
    if(options.prefilteredCubemap) {
      if(useTexCubeLod) {
        code += chunks.reflectionPrefilteredCubeLodPS.replace(/\$DECODE/g, reflectionDecode)
      }else {
        code += chunks.reflectionPrefilteredCubePS.replace(/\$DECODE/g, reflectionDecode)
      }
    }else {
      code += chunks.reflectionCubePS.replace(/\$textureCubeSAMPLE/g, options.rgbmReflection ? "textureCubeRGBM" : options.hdrReflection ? "textureCube" : "textureCubeSRGB")
    }
  }
  if(options.sphereMap) {
    var scode = device.fragmentUniformsCount > 16 ? chunks.reflectionSpherePS : chunks.reflectionSphereLowPS;
    scode = scode.replace(/\$texture2DSAMPLE/g, options.rgbmReflection ? "texture2DRGBM" : options.hdrReflection ? "texture2D" : "texture2DSRGB");
    code += scode
  }
  if((cubemapReflection || options.sphereMap) && options.refraction) {
    code += chunks.refractionPS
  }
  if(options.lightMap) {
    code += this._addMap("light", options, chunks, uvOffset, chunks.lightmapSinglePS)
  }else {
    if(options.prefilteredCubemap) {
      if(useTexCubeLod) {
        code += chunks.ambientPrefilteredCubeLodPS.replace(/\$DECODE/g, reflectionDecode)
      }else {
        code += chunks.ambientPrefilteredCubePS.replace(/\$DECODE/g, reflectionDecode)
      }
    }else {
      code += chunks.ambientConstantPS
    }
  }
  if(numShadowLights > 0) {
    code += chunks.shadowCoordPS + chunks.shadowPS;
    if(mainShadowLight >= 0) {
      code += chunks.shadowVSPS
    }
  }
  code += chunks.lightDiffuseLambertPS;
  var useOldAmbient = false;
  if(options.useSpecular) {
    code += options.shadingModel === pc.SPECULAR_PHONG ? chunks.lightSpecularPhongPS : chunks.lightSpecularBlinnPS;
    if(options.sphereMap || cubemapReflection || options.fresnelModel > 0) {
      if(options.fresnelModel > 0) {
        if(options.conserveEnergy) {
          code += chunks.combineDiffuseSpecularPS
        }else {
          code += chunks.combineDiffuseSpecularNoConservePS
        }
      }else {
        code += chunks.combineDiffuseSpecularOldPS
      }
    }else {
      if(options.diffuseMap) {
        code += chunks.combineDiffuseSpecularNoReflPS
      }else {
        code += chunks.combineDiffuseSpecularNoReflSeparateAmbientPS;
        useOldAmbient = true
      }
    }
  }else {
    code += chunks.combineDiffusePS
  }
  if(options.modulateAmbient && !useOldAmbient) {
    code += "uniform vec3 material_ambient;\n"
  }
  code += chunks.startPS;
  if(lighting || reflections) {
    code += "   getViewDir(data);\n";
    if(options.heightMap || options.normalMap) {
      code += "   getTBN(data);\n"
    }
    if(options.heightMap) {
      code += "   getParallax(data);\n"
    }
    code += "   getNormal(data);\n";
    if(options.useSpecular) {
      code += "   getReflDir(data);\n"
    }
  }
  code += "   getAlbedo(data);\n";
  if(lighting && options.useSpecular || reflections) {
    code += "   getSpecularity(data);\n";
    code += "   getGlossiness(data);\n";
    if(options.fresnelModel > 0) {
      code += "   getFresnel(data);\n"
    }
  }
  code += "   getOpacity(data);\n";
  if(options.alphaTest) {
    code += "   if (data.alpha < alpha_ref) discard;"
  }
  code += "   addAmbient(data);\n";
  if(options.modulateAmbient && !useOldAmbient) {
    code += "   data.diffuseLight *= material_ambient;\n"
  }
  if(options.aoMap && !options.occludeDirect) {
    code += "    applyAO(data);\n"
  }
  if(lighting || reflections) {
    if(cubemapReflection || options.sphereMap) {
      code += "   addReflection(data);\n"
    }
    var light;
    for(i = 0;i < options.lights.length;i++) {
      light = options.lights[i];
      var lightType = light.getType();
      if(lightType == pc.LIGHTTYPE_DIRECTIONAL) {
        code += "   data.lightDirNormW = light" + i + "_direction;\n";
        code += "   data.atten = 1.0;\n"
      }else {
        code += "   getLightDirPoint(data, light" + i + "_position);\n";
        if(light.getFalloffMode() == pc.LIGHTFALLOFF_LINEAR) {
          code += "   data.atten = getFalloffLinear(data, light" + i + "_radius);\n"
        }else {
          code += "   data.atten = getFalloffInvSquared(data, light" + i + "_radius);\n"
        }
        if(lightType == pc.LIGHTTYPE_SPOT) {
          code += "   data.atten *= getSpotEffect(data, light" + i + "_spotDirection, light" + i + "_innerConeAngle, light" + i + "_outerConeAngle);\n"
        }
      }
      code += "   data.atten *= getLightDiffuse(data);\n";
      if(light.getCastShadows() && !options.noShadow) {
        var shadowReadMode = null;
        if(light._shadowType <= pc.SHADOW_DEPTHMASK) {
          if(options.shadowSampleType === pc.SHADOWSAMPLE_HARD) {
            shadowReadMode = "Hard"
          }else {
            if(light._shadowType === pc.SHADOW_DEPTH && options.shadowSampleType === pc.SHADOWSAMPLE_PCF3X3) {
              shadowReadMode = "PCF3x3"
            }else {
              if(light._shadowType === pc.SHADOW_DEPTHMASK && options.shadowSampleType === pc.SHADOWSAMPLE_PCF3X3) {
                shadowReadMode = "PCF3x3_YZW"
              }else {
                if(light._shadowType === pc.SHADOW_DEPTHMASK && options.shadowSampleType === pc.SHADOWSAMPLE_MASK) {
                  shadowReadMode = "Mask"
                }
              }
            }
          }
        }
        if(shadowReadMode !== null) {
          if(lightType == pc.LIGHTTYPE_POINT) {
            var shadowCoordArgs = "(data, light" + i + "_shadowMap, light" + i + "_shadowParams);\n";
            if(light.getNormalOffsetBias()) {
              code += "   normalOffsetPointShadow(data, light" + i + "_shadowParams);\n"
            }
            code += "   data.atten *= getShadowPoint" + shadowReadMode + shadowCoordArgs
          }else {
            if(mainShadowLight === i) {
              shadowReadMode += "VS"
            }else {
              var shadowCoordArgs = "(data, light" + i + "_shadowMatrix, light" + i + "_shadowParams);\n";
              code += this._nonPointShadowMapProjection(options.lights[i], shadowCoordArgs)
            }
            code += "   data.atten *= getShadow" + shadowReadMode + "(data, light" + i + "_shadowMap, light" + i + "_shadowParams);\n"
          }
        }
      }
      code += "   data.diffuseLight += data.atten * light" + i + "_color;\n";
      if(options.useSpecular) {
        code += "   data.atten *= getLightSpecular(data);\n";
        code += "   data.specularLight += data.atten * light" + i + "_color;\n"
      }
      code += "\n"
    }
    if((cubemapReflection || options.sphereMap) && options.refraction) {
      code += "   addRefraction(data);\n"
    }
  }
  code += "\n";
  if(options.aoMap) {
    if(options.occludeDirect) {
      code += "    applyAO(data);\n"
    }
    if(options.occludeSpecular) {
      code += "    occludeSpecular(data);\n"
    }
  }
  code += chunks.endPS;
  code += getSnippet(device, "fs_clamp");
  code += getSnippet(device, "common_main_end");
  fshader = code;
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.pick = {generateKey:function(device, options) {
  var key = "pick";
  if(options.skin) {
    key += "_skin"
  }
  return key
}, createShaderDefinition:function(device, options) {
  var attributes = {vertex_position:pc.SEMANTIC_POSITION};
  if(options.skin) {
    attributes.vertex_boneWeights = pc.SEMANTIC_BLENDWEIGHT;
    attributes.vertex_boneIndices = pc.SEMANTIC_BLENDINDICES
  }
  var getSnippet = pc.programlib.getSnippet;
  var code = "";
  code += getSnippet(device, "vs_transform_decl");
  if(options.skin) {
    code += getSnippet(device, "vs_skin_decl")
  }
  code += getSnippet(device, "common_main_begin");
  if(options.skin) {
    code += "    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n";
    code += "                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n";
    code += "                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n";
    code += "                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"
  }else {
    code += "    mat4 modelMatrix = matrix_model;\n"
  }
  code += "\n";
  code += "    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";
  code += "    gl_Position = matrix_viewProjection * positionW;\n\n";
  code += getSnippet(device, "common_main_end");
  var vshader = code;
  code = getSnippet(device, "fs_precision");
  code += getSnippet(device, "fs_flat_color_decl");
  code += getSnippet(device, "common_main_begin");
  code += getSnippet(device, "fs_flat_color");
  code += getSnippet(device, "common_main_end");
  var fshader = code;
  return{attributes:attributes, vshader:vshader, fshader:fshader}
}};
pc.programlib.skybox = {generateKey:function(device, options) {
  var key = "skybox" + options.rgbm + " " + options.hdr + " " + options.fixSeams + "" + options.toneMapping + "" + options.gamma;
  return key
}, createShaderDefinition:function(device, options) {
  var getSnippet = pc.programlib.getSnippet;
  var chunks = pc.shaderChunks;
  return{attributes:{aPosition:pc.SEMANTIC_POSITION}, vshader:["attribute vec3 aPosition;", "", "uniform mat4 matrix_view;", "uniform mat4 matrix_projection;", "", "varying vec3 vViewDir;", "", "void main(void)", "{", "    mat4 view = matrix_view;", "    view[3][0] = view[3][1] = view[3][2] = 0.0;", "    gl_Position = matrix_projection * view * vec4(aPosition, 1.0);", "    gl_Position.z = gl_Position.w - 0.00001;", "    vViewDir = aPosition;", "    vViewDir.x *= -1.0;", "}"].join("\n"), fshader:getSnippet(device,
  "fs_precision") + (options.fixSeams ? chunks.fixCubemapSeamsStretchPS : chunks.fixCubemapSeamsNonePS) + (options.hdr ? pc.programlib.gammaCode(options.gamma) + pc.programlib.tonemapCode(options.toneMapping) + chunks.rgbmPS + chunks.skyboxHDRPS.replace(/\$textureCubeSAMPLE/g, options.rgbm ? "textureCubeRGBM" : options.hdr ? "textureCube" : "textureCubeSRGB") : chunks.skyboxPS)}
}};
pc.extend(pc, function() {
  var PostEffect = function(graphicsDevice) {
    this.device = graphicsDevice;
    this.shader = null;
    this.depthMap = null;
    this.vertexBuffer = pc.createFullscreenQuad(graphicsDevice);
    this.needsDepthBuffer = false
  };
  PostEffect.prototype = {render:function(inputTarget, outputTarget, rect) {
  }};
  function createFullscreenQuad(device) {
    var vertexFormat = new pc.VertexFormat(device, [{semantic:pc.SEMANTIC_POSITION, components:2, type:pc.ELEMENTTYPE_FLOAT32}]);
    var vertexBuffer = new pc.VertexBuffer(device, vertexFormat, 4);
    var iterator = new pc.VertexIterator(vertexBuffer);
    iterator.element[pc.SEMANTIC_POSITION].set(-1, -1);
    iterator.next();
    iterator.element[pc.SEMANTIC_POSITION].set(1, -1);
    iterator.next();
    iterator.element[pc.SEMANTIC_POSITION].set(-1, 1);
    iterator.next();
    iterator.element[pc.SEMANTIC_POSITION].set(1, 1);
    iterator.end();
    return vertexBuffer
  }
  function drawFullscreenQuad(device, target, vertexBuffer, shader, rect) {
    device.setRenderTarget(target);
    device.updateBegin();
    var w = target !== null ? target.width : device.width;
    var h = target !== null ? target.height : device.height;
    var x = 0;
    var y = 0;
    if(rect) {
      x = rect.x * w;
      y = rect.y * h;
      w *= rect.z;
      h *= rect.w
    }
    device.setViewport(x, y, w, h);
    device.setScissor(x, y, w, h);
    var oldBlending = device.getBlending();
    var oldDepthTest = device.getDepthTest();
    var oldDepthWrite = device.getDepthWrite();
    device.setBlending(false);
    device.setDepthTest(false);
    device.setDepthWrite(false);
    device.setVertexBuffer(vertexBuffer, 0);
    device.setShader(shader);
    device.draw({type:pc.PRIMITIVE_TRISTRIP, base:0, count:4, indexed:false});
    device.setBlending(oldBlending);
    device.setDepthTest(oldDepthTest);
    device.setDepthWrite(oldDepthWrite);
    device.updateEnd()
  }
  return{PostEffect:PostEffect, createFullscreenQuad:createFullscreenQuad, drawFullscreenQuad:drawFullscreenQuad}
}());
pc.extend(pc, function() {
  function PostEffectQueue(app, camera) {
    this.app = app;
    this.camera = camera;
    this.effects = [];
    this.enabled = false;
    this.depthTarget = null;
    this.renderTargetScale = 1;
    this.resizeTimeout = null;
    camera.on("set_rect", this.onCameraRectChanged, this)
  }
  PostEffectQueue.prototype = {_createOffscreenTarget:function(useDepth) {
    var rect = this.camera.rect;
    var width = Math.floor(rect.z * this.app.graphicsDevice.width * this.renderTargetScale);
    var height = Math.floor(rect.w * this.app.graphicsDevice.height * this.renderTargetScale);
    var colorBuffer = new pc.Texture(this.app.graphicsDevice, {format:pc.PIXELFORMAT_R8_G8_B8_A8, width:width, height:height});
    colorBuffer.minFilter = pc.FILTER_NEAREST;
    colorBuffer.magFilter = pc.FILTER_NEAREST;
    colorBuffer.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    colorBuffer.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    return new pc.RenderTarget(this.app.graphicsDevice, colorBuffer, {depth:useDepth})
  }, _setDepthTarget:function(depthTarget) {
    if(this.depthTarget !== depthTarget) {
      if(this.depthTarget) {
        this.depthTarget.destroy()
      }
      this.depthTarget = depthTarget
    }
    this.camera.camera._depthTarget = depthTarget
  }, setRenderTargetScale:function(scale) {
    this.renderTargetScale = scale;
    this.resizeRenderTargets()
  }, addEffect:function(effect) {
    var isFirstEffect = this.effects.length === 0;
    var effects = this.effects;
    var newEntry = {effect:effect, inputTarget:this._createOffscreenTarget(isFirstEffect), outputTarget:null};
    if(effect.needsDepthBuffer) {
      if(!this.depthTarget) {
        this._setDepthTarget(this._createOffscreenTarget(true))
      }
      effect.depthMap = this.depthTarget.colorBuffer
    }
    if(isFirstEffect) {
      this.camera.renderTarget = newEntry.inputTarget
    }
    effects.push(newEntry);
    var len = effects.length;
    if(len > 1) {
      effects[len - 2].outputTarget = newEntry.inputTarget
    }
    this.enable()
  }, removeEffect:function(effect) {
    var index = -1;
    for(var i = 0, len = this.effects.length;i < len;i++) {
      if(this.effects[i].effect === effect) {
        index = i;
        break
      }
    }
    if(index >= 0) {
      if(index > 0) {
        this.effects[index - 1].outputTarget = index + 1 < this.effects.length ? this.effects[index + 1].inputTarget : null
      }else {
        if(this.effects.length > 1) {
          if(!this.effects[1].inputTarget._depth) {
            this.effects[1].inputTarget.destroy();
            this.effects[1].inputTarget = this._createOffscreenTarget(true)
          }
          this.camera.renderTarget = this.effects[1].inputTarget
        }
      }
      this.effects[index].inputTarget.destroy();
      this.effects.splice(index, 1)
    }
    if(this.depthTarget) {
      var isDepthTargetNeeded = false;
      for(var i = 0, len = this.effects.length;i < len;i++) {
        if(this.effects[i].effect.needsDepthBuffer) {
          isDepthTargetNeeded = true;
          break
        }
      }
      if(!isDepthTargetNeeded) {
        this._setDepthTarget(null)
      }
    }
    if(this.effects.length === 0) {
      this.disable()
    }
  }, destroy:function() {
    if(this.depthTarget) {
      this.depthTarget.destroy();
      this.depthTarget = null
    }
    for(var i = 0, len = this.effects.length;i < len;i++) {
      this.effects[i].inputTarget.destroy()
    }
    this.effects.length = 0;
    this.disable()
  }, enable:function() {
    if(!this.enabled && this.effects.length) {
      this.enabled = true;
      var effects = this.effects;
      var camera = this.camera;
      this.app.graphicsDevice.on("resizecanvas", this._onCanvasResized, this);
      camera.camera.setRect(0, 0, 1, 1);
      this.command = new pc.Command(pc.LAYER_FX, pc.BLEND_NONE, function() {
        if(this.enabled && camera.data.isRendering) {
          var rect = null;
          var len = effects.length;
          if(len) {
            camera.renderTarget = effects[0].inputTarget;
            this._setDepthTarget(this.depthTarget);
            for(var i = 0;i < len;i++) {
              var fx = effects[i];
              if(i === len - 1) {
                rect = camera.rect
              }
              fx.effect.render(fx.inputTarget, fx.outputTarget, rect)
            }
          }
        }
      }.bind(this));
      this.app.scene.drawCalls.push(this.command)
    }
  }, disable:function() {
    if(this.enabled) {
      this.enabled = false;
      this.app.graphicsDevice.off("resizecanvas", this._onCanvasResized, this);
      this.camera.renderTarget = null;
      this.camera.camera._depthTarget = null;
      var rect = this.camera.rect;
      this.camera.camera.setRect(rect.x, rect.y, rect.z, rect.w);
      var i = this.app.scene.drawCalls.indexOf(this.command);
      if(i >= 0) {
        this.app.scene.drawCalls.splice(i, 1)
      }
    }
  }, _onCanvasResized:function(width, height) {
    if(this.resizeTimeout) {
      clearTimeout(this.resizeTimeout)
    }
    this.resizeTimeout = setTimeout(this.resizeRenderTargets.bind(this), 500)
  }, resizeRenderTargets:function() {
    var rect = this.camera.rect;
    var desiredWidth = Math.floor(rect.z * this.app.graphicsDevice.width * this.renderTargetScale);
    var desiredHeight = Math.floor(rect.w * this.app.graphicsDevice.height * this.renderTargetScale);
    var effects = this.effects;
    if(this.depthTarget && this.depthTarget.width !== desiredWidth && this.depthTarget.height !== desiredHeight) {
      this._setDepthTarget(this._createOffscreenTarget(true))
    }
    for(var i = 0, len = effects.length;i < len;i++) {
      var fx = effects[i];
      if(fx.inputTarget.width !== desiredWidth || fx.inputTarget.height !== desiredHeight) {
        fx.inputTarget.destroy();
        fx.inputTarget = this._createOffscreenTarget(fx.effect.needsDepthBuffer || i === 0);
        if(fx.effect.needsDepthBuffer) {
          fx.depthMap = this.depthTarget
        }
        if(i > 0) {
          effects[i - 1].outputTarget = fx.inputTarget
        }else {
          this.camera.renderTarget = fx.inputTarget
        }
      }
    }
  }, onCameraRectChanged:function(name, oldValue, newValue) {
    if(this.enabled) {
      this.camera.camera.setRect(0, 0, 1, 1);
      this.resizeRenderTargets()
    }
  }};
  return{PostEffectQueue:PostEffectQueue}
}());
(function() {
  var enums = {BLEND_SUBTRACTIVE:0, BLEND_ADDITIVE:1, BLEND_NORMAL:2, BLEND_NONE:3, BLEND_PREMULTIPLIED:4, BLEND_MULTIPLICATIVE:5, FOG_NONE:"none", FOG_LINEAR:"linear", FOG_EXP:"exp", FOG_EXP2:"exp2", FRESNEL_NONE:0, FRESNEL_SIMPLE:1, FRESNEL_SCHLICK:2, FRESNEL_COMPLEX:3, LAYER_HUD:0, LAYER_GIZMO:1, LAYER_FX:2, LAYER_WORLD:3, LIGHTTYPE_DIRECTIONAL:0, LIGHTTYPE_POINT:1, LIGHTTYPE_SPOT:2, LIGHTFALLOFF_LINEAR:0, LIGHTFALLOFF_INVERSESQUARED:1, SHADOW_DEPTH:0, SHADOW_DEPTHMASK:1, SHADOWSAMPLE_HARD:0,
  SHADOWSAMPLE_PCF3X3:1, SHADOWSAMPLE_MASK:2, PARTICLESORT_NONE:0, PARTICLESORT_DISTANCE:1, PARTICLESORT_NEWER_FIRST:2, PARTICLESORT_OLDER_FIRST:3, PARTICLEMODE_GPU:0, PARTICLEMODE_CPU:1, EMITTERSHAPE_BOX:0, EMITTERSHAPE_SPHERE:1, PROJECTION_PERSPECTIVE:0, PROJECTION_ORTHOGRAPHIC:1, RENDERSTYLE_SOLID:0, RENDERSTYLE_WIREFRAME:1, RENDERSTYLE_POINTS:2, CUBEPROJ_NONE:0, CUBEPROJ_BOX:1, SPECULAR_PHONG:0, SPECULAR_BLINN:1, GAMMA_NONE:0, GAMMA_SRGB:1, GAMMA_SRGBFAST:2, TONEMAP_LINEAR:0, TONEMAP_FILMIC:1,
  SHADERDEF_NOSHADOW:1, SHADERDEF_SKIN:2, SHADOWUPDATE_NONE:0, SHADOWUPDATE_THISFRAME:1, SHADOWUPDATE_REALTIME:2};
  pc.extend(pc, enums);
  pc.scene = {};
  pc.extend(pc.scene, enums)
})();
pc.extend(pc, function() {
  var Scene = function Scene() {
    this.drawCalls = [];
    this.shadowCasters = [];
    this.fog = pc.FOG_NONE;
    this.fogColor = new pc.Color(0, 0, 0);
    this.fogStart = 1;
    this.fogEnd = 1E3;
    this.fogDensity = 0;
    this.ambientLight = new pc.Color(0, 0, 0);
    this._gammaCorrection = pc.GAMMA_NONE;
    this._toneMapping = 0;
    this.exposure = 1;
    this._skyboxPrefiltered128 = null;
    this._skyboxPrefiltered64 = null;
    this._skyboxPrefiltered32 = null;
    this._skyboxPrefiltered16 = null;
    this._skyboxPrefiltered8 = null;
    this._skyboxPrefiltered4 = null;
    this._skyboxCubeMap = null;
    this._skyboxModel = null;
    this._models = [];
    this._lights = [];
    this._globalLights = [];
    this._localLights = [[], []];
    this.updateShaders = true
  };
  Object.defineProperty(Scene.prototype, "fog", {get:function() {
    return this._fog
  }, set:function(type) {
    if(type !== this._fog) {
      this._fog = type;
      this.updateShaders = true
    }
  }});
  Object.defineProperty(Scene.prototype, "gammaCorrection", {get:function() {
    return this._gammaCorrection
  }, set:function(value) {
    if(value !== this._gammaCorrection) {
      this._gammaCorrection = value;
      this.updateShaders = true
    }
  }});
  Object.defineProperty(Scene.prototype, "toneMapping", {get:function() {
    return this._toneMapping
  }, set:function(value) {
    if(value !== this._toneMapping) {
      this._toneMapping = value;
      this.updateShaders = true
    }
  }});
  Object.defineProperty(Scene.prototype, "skybox", {get:function() {
    return this._skyboxCubeMap
  }, set:function(value) {
    this._skyboxCubeMap = value;
    if(this._skyboxModel) {
      if(this.containsModel(this._skyboxModel)) {
        this.removeModel(this._skyboxModel)
      }
    }
    this._skyboxModel = null;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered128", {get:function() {
    return this._skyboxPrefiltered128
  }, set:function(value) {
    this._skyboxPrefiltered128 = value;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered64", {get:function() {
    return this._skyboxPrefiltered64
  }, set:function(value) {
    this._skyboxPrefiltered64 = value;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered32", {get:function() {
    return this._skyboxPrefiltered32
  }, set:function(value) {
    this._skyboxPrefiltered32 = value;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered16", {get:function() {
    return this._skyboxPrefiltered16
  }, set:function(value) {
    this._skyboxPrefiltered16 = value;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered8", {get:function() {
    return this._skyboxPrefiltered8
  }, set:function(value) {
    this._skyboxPrefiltered8 = value;
    this.updateShaders = true
  }});
  Object.defineProperty(Scene.prototype, "skyboxPrefiltered4", {get:function() {
    return this._skyboxPrefiltered4
  }, set:function(value) {
    this._skyboxPrefiltered4 = value;
    this.updateShaders = true
  }});
  Scene.prototype._updateShaders = function(device) {
    var i;
    if(this._skyboxCubeMap && !this._skyboxModel) {
      var material = new pc.Material;
      var scene = this;
      material.updateShader = function() {
        var library = device.getProgramLibrary();
        var shader = library.getProgram("skybox", {rgbm:scene._skyboxCubeMap.rgbm, hdr:scene._skyboxCubeMap.rgbm || scene._skyboxCubeMap.format === pc.PIXELFORMAT_RGBA32F, fixSeams:scene._skyboxCubeMap.fixCubemapSeams, gamma:scene.gammaCorrection, toneMapping:scene.toneMapping});
        this.setShader(shader)
      };
      material.updateShader();
      material.setParameter("texture_cubeMap", this._skyboxCubeMap);
      material.cull = pc.CULLFACE_NONE;
      var node = new pc.GraphNode;
      var mesh = pc.createBox(device);
      var meshInstance = new pc.MeshInstance(node, mesh, material);
      var model = new pc.Model;
      model.graph = node;
      model.meshInstances = [meshInstance];
      this._skyboxModel = model;
      this.addModel(model)
    }
    var materials = [];
    var drawCalls = this.drawCalls;
    for(i = 0;i < drawCalls.length;i++) {
      var drawCall = drawCalls[i];
      if(drawCall.material !== undefined) {
        if(materials.indexOf(drawCall.material) === -1) {
          materials.push(drawCall.material)
        }
      }
    }
    for(i = 0;i < materials.length;i++) {
      materials[i].clearVariants();
      materials[i].updateShader(device, this);
      materials[i].variants[0] = materials[i].shader
    }
  };
  Scene.prototype.getModels = function() {
    return this._models
  };
  Scene.prototype.addModel = function(model) {
    var i;
    var index = this._models.indexOf(model);
    if(index === -1) {
      this._models.push(model);
      var materials = model.getMaterials();
      for(i = 0;i < materials.length;i++) {
        materials[i].scene = this
      }
      var meshInstance;
      var numMeshInstances = model.meshInstances.length;
      for(i = 0;i < numMeshInstances;i++) {
        meshInstance = model.meshInstances[i];
        if(this.drawCalls.indexOf(meshInstance) === -1) {
          this.drawCalls.push(meshInstance)
        }
        if(meshInstance.castShadow) {
          if(this.shadowCasters.indexOf(meshInstance) === -1) {
            this.shadowCasters.push(meshInstance)
          }
        }
      }
      var lights = model.getLights();
      for(i = 0, len = lights.length;i < len;i++) {
        this.addLight(lights[i])
      }
    }
  };
  Scene.prototype.removeModel = function(model) {
    var i;
    var index = this._models.indexOf(model);
    if(index !== -1) {
      this._models.splice(index, 1);
      var materials = model.getMaterials();
      for(i = 0;i < materials.length;i++) {
        materials[i].scene = null
      }
      var meshInstance;
      var numMeshInstances = model.meshInstances.length;
      for(i = 0;i < numMeshInstances;i++) {
        meshInstance = model.meshInstances[i];
        index = this.drawCalls.indexOf(meshInstance);
        if(index !== -1) {
          this.drawCalls.splice(index, 1)
        }
        if(meshInstance.castShadow) {
          index = this.shadowCasters.indexOf(meshInstance);
          if(index !== -1) {
            this.shadowCasters.splice(index, 1)
          }
        }
      }
      var lights = model.getLights();
      for(i = 0, len = lights.length;i < len;i++) {
        this.removeLight(lights[i])
      }
    }
  };
  Scene.prototype.containsModel = function(model) {
    return this._models.indexOf(model) >= 0
  };
  Scene.prototype.addLight = function(light) {
    var index = this._lights.indexOf(light);
    if(index !== -1) {
      console.warn("pc.Scene#addLight: light is already in the scene")
    }else {
      this._lights.push(light);
      light._scene = this;
      this.updateShaders = true
    }
  };
  Scene.prototype.removeLight = function(light) {
    var index = this._lights.indexOf(light);
    if(index === -1) {
      console.warn("pc.Scene#removeLight: light is not in the scene")
    }else {
      this._lights.splice(index, 1);
      light._scene = null;
      this.updateShaders = true
    }
  };
  Scene.prototype.update = function() {
    for(var i = 0, len = this._models.length;i < len;i++) {
      this._models[i].getGraph().syncHierarchy()
    }
  };
  return{Scene:Scene}
}());
pc.extend(pc, function() {
  function sortDrawCalls(drawCallA, drawCallB) {
    if(drawCallA.distSqr && drawCallB.distSqr) {
      return drawCallB.distSqr - drawCallA.distSqr
    }else {
      return drawCallB.key - drawCallA.key
    }
  }
  var scale = (new pc.Mat4).setScale(0.5, 0.5, 0.5);
  var shift = (new pc.Mat4).setTranslate(0.5, 0.5, 0.5);
  var scaleShift = (new pc.Mat4).mul2(shift, scale);
  var camToLight = (new pc.Mat4).setFromAxisAngle(pc.Vec3.RIGHT, -90);
  var shadowCamWtm = new pc.Mat4;
  var shadowCamView = new pc.Mat4;
  var shadowCamViewProj = new pc.Mat4;
  var viewInvMat = new pc.Mat4;
  var viewMat = new pc.Mat4;
  var viewMat3 = new pc.Mat3;
  var viewProjMat = new pc.Mat4;
  var tempSphere = {};
  var c2sc = new pc.Mat4;
  var frustumPoints = [];
  for(i = 0;i < 8;i++) {
    frustumPoints.push(new pc.Vec3)
  }
  function _calculateSceneAabb(scene) {
    var meshInstances = scene.meshInstances;
    if(meshInstances.length > 0) {
      scene._sceneAabb.copy(meshInstances[0].aabb);
      for(var i = 1;i < meshInstances.length;i++) {
        scene._sceneAabb.add(meshInstances[i].aabb)
      }
    }
  }
  function _getFrustumCentroid(scene, camera, farClip, centroid) {
    centroid.set(0, 0, -(farClip + camera._nearClip) * 0.5);
    camera._node.getWorldTransform().transformPoint(centroid, centroid)
  }
  function _getFrustumPoints(scene, camera, farClip, points) {
    var cam = camera;
    var nearClip = cam.getNearClip();
    var fov = cam.getFov() * Math.PI / 180;
    var aspect = cam.getAspectRatio();
    var projection = cam.getProjection();
    var x, y;
    if(projection === pc.PROJECTION_PERSPECTIVE) {
      y = Math.tan(fov / 2) * nearClip
    }else {
      y = camera._orthoHeight
    }
    x = y * aspect;
    points[0].x = x;
    points[0].y = -y;
    points[0].z = -nearClip;
    points[1].x = x;
    points[1].y = y;
    points[1].z = -nearClip;
    points[2].x = -x;
    points[2].y = y;
    points[2].z = -nearClip;
    points[3].x = -x;
    points[3].y = -y;
    points[3].z = -nearClip;
    if(projection === pc.PROJECTION_PERSPECTIVE) {
      y = Math.tan(fov / 2) * farClip;
      x = y * aspect
    }
    points[4].x = x;
    points[4].y = -y;
    points[4].z = -farClip;
    points[5].x = x;
    points[5].y = y;
    points[5].z = -farClip;
    points[6].x = -x;
    points[6].y = y;
    points[6].z = -farClip;
    points[7].x = -x;
    points[7].y = -y;
    points[7].z = -farClip;
    return points
  }
  function createShadowMap(device, width, height) {
    var shadowMap = new pc.Texture(device, {format:pc.PIXELFORMAT_R8_G8_B8_A8, width:width, height:height, autoMipmap:false});
    shadowMap.minFilter = pc.FILTER_NEAREST;
    shadowMap.magFilter = pc.FILTER_NEAREST;
    shadowMap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    shadowMap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    return new pc.RenderTarget(device, shadowMap, true)
  }
  function createShadowCubeMap(device, size) {
    var cubemap = new pc.Texture(device, {format:pc.PIXELFORMAT_R8_G8_B8_A8, width:size, height:size, cubemap:true, autoMipmap:false});
    cubemap.minFilter = pc.FILTER_NEAREST;
    cubemap.magFilter = pc.FILTER_NEAREST;
    cubemap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    cubemap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    var targets = [];
    for(var i = 0;i < 6;i++) {
      var target = new pc.RenderTarget(device, cubemap, {face:i, depth:true});
      targets.push(target)
    }
    return targets
  }
  function createShadowCamera(device) {
    var flags = pc.CLEARFLAG_DEPTH;
    if(!device.extDepthTexture) {
      flags |= pc.CLEARFLAG_COLOR
    }
    var shadowCam = new pc.Camera;
    shadowCam.setClearOptions({color:[1, 1, 1, 1], depth:1, flags:flags});
    shadowCam._node = new pc.GraphNode;
    return shadowCam
  }
  function createShadowBuffer(device, light) {
    var shadowBuffer;
    if(light.getType() === pc.LIGHTTYPE_POINT) {
      shadowBuffer = createShadowCubeMap(device, light._shadowResolution);
      light._shadowCamera.setRenderTarget(shadowBuffer[0]);
      light._shadowCubeMap = shadowBuffer
    }else {
      shadowBuffer = createShadowMap(device, light._shadowResolution, light._shadowResolution);
      light._shadowCamera.setRenderTarget(shadowBuffer)
    }
  }
  function getShadowCamera(device, light) {
    var shadowCam = light._shadowCamera;
    var shadowBuffer;
    if(shadowCam === null) {
      shadowCam = light._shadowCamera = createShadowCamera(device);
      createShadowBuffer(device, light)
    }else {
      shadowBuffer = shadowCam.getRenderTarget();
      if(shadowBuffer.width !== light._shadowResolution || shadowBuffer.height !== light._shadowResolution) {
        createShadowBuffer(device, light)
      }
    }
    return shadowCam
  }
  function ForwardRenderer(graphicsDevice) {
    this.device = graphicsDevice;
    var library = this.device.getProgramLibrary();
    this._depthShaderStatic = library.getProgram("depth", {skin:false});
    this._depthShaderSkin = library.getProgram("depth", {skin:true});
    this._depthProgStatic = [];
    this._depthProgSkin = [];
    this._depthProgStaticOp = [];
    this._depthProgSkinOp = [];
    this._depthProgStaticPoint = [];
    this._depthProgSkinPoint = [];
    this._depthProgStaticOpPoint = [];
    this._depthProgSkinOpPoint = [];
    var chan = ["r", "g", "b", "a"];
    for(var i = 0;i < pc.SHADOW_DEPTH + 1;i++) {
      this._depthProgStatic[i] = library.getProgram("depthrgba", {skin:false, opacityMap:false, shadowType:i});
      this._depthProgSkin[i] = library.getProgram("depthrgba", {skin:true, opacityMap:false, shadowType:i});
      this._depthProgStaticPoint[i] = library.getProgram("depthrgba", {skin:false, opacityMap:false, point:true});
      this._depthProgSkinPoint[i] = library.getProgram("depthrgba", {skin:true, opacityMap:false, point:true});
      this._depthProgStaticOp[i] = {};
      this._depthProgSkinOp[i] = {};
      this._depthProgStaticOpPoint[i] = {};
      this._depthProgSkinOpPoint[i] = {};
      for(var c = 0;c < 4;c++) {
        this._depthProgStaticOp[i][chan[c]] = library.getProgram("depthrgba", {skin:false, opacityMap:true, shadowType:i, opacityChannel:chan[c]});
        this._depthProgSkinOp[i][chan[c]] = library.getProgram("depthrgba", {skin:true, opacityMap:true, shadowType:i, opacityChannel:chan[c]});
        this._depthProgStaticOpPoint[i][chan[c]] = library.getProgram("depthrgba", {skin:false, opacityMap:true, point:true, opacityChannel:chan[c]});
        this._depthProgSkinOpPoint[i][chan[c]] = library.getProgram("depthrgba", {skin:true, opacityMap:true, point:true, opacityChannel:chan[c]})
      }
    }
    var scope = this.device.scope;
    this.projId = scope.resolve("matrix_projection");
    this.viewId = scope.resolve("matrix_view");
    this.viewId3 = scope.resolve("matrix_view3");
    this.viewInvId = scope.resolve("matrix_viewInverse");
    this.viewProjId = scope.resolve("matrix_viewProjection");
    this.viewPosId = scope.resolve("view_position");
    this.nearClipId = scope.resolve("camera_near");
    this.farClipId = scope.resolve("camera_far");
    this.lightRadiusId = scope.resolve("light_radius");
    this.fogColorId = scope.resolve("fog_color");
    this.fogStartId = scope.resolve("fog_start");
    this.fogEndId = scope.resolve("fog_end");
    this.fogDensityId = scope.resolve("fog_density");
    this.modelMatrixId = scope.resolve("matrix_model");
    this.normalMatrixId = scope.resolve("matrix_normal");
    this.poseMatrixId = scope.resolve("matrix_pose[0]");
    this.boneTextureId = scope.resolve("texture_poseMap");
    this.boneTextureSizeId = scope.resolve("texture_poseMapSize");
    this.alphaTestId = scope.resolve("alpha_ref");
    this._shadowAabb = new pc.shape.Aabb;
    this._sceneAabb = new pc.shape.Aabb;
    this._shadowState = {blend:false};
    this.centroid = new pc.Vec3;
    this.fogColor = new Float32Array(3);
    this.ambientColor = new Float32Array(3)
  }
  pc.extend(ForwardRenderer.prototype, {setCamera:function(camera, cullBorder) {
    var projMat = camera.getProjectionMatrix();
    this.projId.setValue(projMat.data);
    var pos = camera._node.getPosition();
    var rot = camera._node.getRotation();
    viewInvMat.setTRS(pos, rot, pc.Vec3.ONE);
    this.viewInvId.setValue(viewInvMat.data);
    viewMat.copy(viewInvMat).invert();
    this.viewId.setValue(viewMat.data);
    viewMat3.data[0] = viewMat.data[0];
    viewMat3.data[1] = viewMat.data[1];
    viewMat3.data[2] = viewMat.data[2];
    viewMat3.data[3] = viewMat.data[4];
    viewMat3.data[4] = viewMat.data[5];
    viewMat3.data[5] = viewMat.data[6];
    viewMat3.data[6] = viewMat.data[8];
    viewMat3.data[7] = viewMat.data[9];
    viewMat3.data[8] = viewMat.data[10];
    this.viewId3.setValue(viewMat3.data);
    viewProjMat.mul2(projMat, viewMat);
    this.viewProjId.setValue(viewProjMat.data);
    this.viewPosId.setValue(camera._node.getPosition().data);
    this.nearClipId.setValue(camera.getNearClip());
    this.farClipId.setValue(camera.getFarClip());
    camera._frustum.update(projMat, viewMat);
    var device = this.device;
    var target = camera.getRenderTarget();
    device.setRenderTarget(target);
    device.updateBegin();
    var rect = camera.getRect();
    var pixelWidth = target ? target.width : device.width;
    var pixelHeight = target ? target.height : device.height;
    var x = Math.floor(rect.x * pixelWidth);
    var y = Math.floor(rect.y * pixelHeight);
    var w = Math.floor(rect.width * pixelWidth);
    var h = Math.floor(rect.height * pixelHeight);
    device.setViewport(x, y, w, h);
    device.setScissor(x, y, w, h);
    device.clear(camera.getClearOptions());
    if(cullBorder) {
      device.setScissor(1, 1, pixelWidth - 2, pixelHeight - 2)
    }
  }, dispatchGlobalLights:function(scene) {
    var i;
    this.mainLight = -1;
    this._activeShadowLights = [];
    var scope = this.device.scope;
    this.ambientColor[0] = scene.ambientLight.r;
    this.ambientColor[1] = scene.ambientLight.g;
    this.ambientColor[2] = scene.ambientLight.b;
    if(scene.gammaCorrection) {
      for(i = 0;i < 3;i++) {
        this.ambientColor[i] = Math.pow(this.ambientColor[i], 2.2)
      }
    }
    scope.resolve("light_globalAmbient").setValue(this.ambientColor);
    scope.resolve("exposure").setValue(scene.exposure)
  }, dispatchDirectLights:function(scene, mask) {
    var dirs = scene._globalLights;
    var numDirs = dirs.length;
    var i;
    var directional, wtm, light;
    var cnt = 0;
    var scope = this.device.scope;
    for(i = 0;i < numDirs;i++) {
      if(!(dirs[i].mask & mask)) {
        continue
      }
      directional = dirs[i];
      wtm = directional._node.getWorldTransform();
      light = "light" + cnt;
      scope.resolve(light + "_color").setValue(scene.gammaCorrection ? directional._linearFinalColor.data : directional._finalColor.data);
      wtm.getY(directional._direction).scale(-1);
      scope.resolve(light + "_direction").setValue(directional._direction.normalize().data);
      if(directional.getCastShadows()) {
        var shadowMap = this.device.extDepthTexture ? directional._shadowCamera._renderTarget._depthTexture : directional._shadowCamera._renderTarget.colorBuffer;
        scope.resolve(light + "_shadowMap").setValue(shadowMap);
        scope.resolve(light + "_shadowMatrix").setValue(directional._shadowMatrix.data);
        scope.resolve(light + "_shadowParams").setValue([directional._shadowResolution, directional._normalOffsetBias, directional._shadowBias]);
        this._activeShadowLights.push(directional);
        if(this.mainLight < 0) {
          scope.resolve(light + "_shadowMatrixVS").setValue(directional._shadowMatrix.data);
          scope.resolve(light + "_shadowParamsVS").setValue([directional._shadowResolution, directional._normalOffsetBias, directional._shadowBias]);
          scope.resolve(light + "_directionVS").setValue(directional._direction.normalize().data);
          this.mainLight = i
        }
      }
      cnt++
    }
    return cnt
  }, dispatchLocalLights:function(scene, mask, usedDirLights) {
    var i, wtm;
    var point, spot;
    var light;
    var localLights = scene._localLights;
    var cnt = 0;
    var pnts = localLights[pc.LIGHTTYPE_POINT - 1];
    var spts = localLights[pc.LIGHTTYPE_SPOT - 1];
    var numDirs = usedDirLights;
    var numPnts = pnts.length;
    var numSpts = spts.length;
    var scope = this.device.scope;
    for(i = 0;i < numPnts;i++) {
      if(!(pnts[i].mask & mask)) {
        continue
      }
      point = pnts[i];
      wtm = point._node.getWorldTransform();
      light = "light" + (numDirs + cnt);
      scope.resolve(light + "_radius").setValue(point._attenuationEnd);
      scope.resolve(light + "_color").setValue(scene.gammaCorrection ? point._linearFinalColor.data : point._finalColor.data);
      wtm.getTranslation(point._position);
      scope.resolve(light + "_position").setValue(point._position.data);
      if(point.getCastShadows()) {
        var shadowMap = this.device.extDepthTexture ? point._shadowCamera._renderTarget._depthTexture : point._shadowCamera._renderTarget.colorBuffer;
        scope.resolve(light + "_shadowMap").setValue(shadowMap);
        scope.resolve(light + "_shadowMatrix").setValue(point._shadowMatrix.data);
        scope.resolve(light + "_shadowParams").setValue([point._shadowResolution, point._normalOffsetBias, point._shadowBias, 1 / point.getAttenuationEnd()]);
        this._activeShadowLights.push(point)
      }
      cnt++
    }
    for(i = 0;i < numSpts;i++) {
      if(!(spts[i].mask & mask)) {
        continue
      }
      spot = spts[i];
      wtm = spot._node.getWorldTransform();
      light = "light" + (numDirs + cnt);
      scope.resolve(light + "_innerConeAngle").setValue(spot._innerConeAngleCos);
      scope.resolve(light + "_outerConeAngle").setValue(spot._outerConeAngleCos);
      scope.resolve(light + "_radius").setValue(spot._attenuationEnd);
      scope.resolve(light + "_color").setValue(scene.gammaCorrection ? spot._linearFinalColor.data : spot._finalColor.data);
      wtm.getTranslation(spot._position);
      scope.resolve(light + "_position").setValue(spot._position.data);
      wtm.getY(spot._direction).scale(-1);
      scope.resolve(light + "_spotDirection").setValue(spot._direction.data);
      if(spot.getCastShadows()) {
        var shadowMap = this.device.extDepthTexture ? spot._shadowCamera._renderTarget._depthTexture : spot._shadowCamera._renderTarget.colorBuffer;
        scope.resolve(light + "_shadowMap").setValue(shadowMap);
        scope.resolve(light + "_shadowMatrix").setValue(spot._shadowMatrix.data);
        scope.resolve(light + "_shadowParams").setValue([spot._shadowResolution, spot._normalOffsetBias, spot._shadowBias]);
        this._activeShadowLights.push(spot);
        if(this.mainLight < 0) {
          scope.resolve(light + "_shadowMatrixVS").setValue(spot._shadowMatrix.data);
          scope.resolve(light + "_shadowParamsVS").setValue([spot._shadowResolution, spot._normalOffsetBias, spot._shadowBias]);
          scope.resolve(light + "_positionVS").setValue(spot._position.data);
          this.mainLight = i
        }
      }
      cnt++
    }
  }, render:function(scene, camera) {
    var device = this.device;
    var scope = device.scope;
    scene._activeCamera = camera;
    if(scene.updateShaders) {
      scene._updateShaders(device);
      scene.updateShaders = false
    }
    var lights = scene._lights;
    var models = scene._models;
    var drawCalls = scene.drawCalls;
    var drawCallsCount = drawCalls.length;
    var shadowCasters = scene.shadowCasters;
    var i, j, numInstances;
    var drawCall, meshInstance, prevMeshInstance = null, mesh, material, prevMaterial = null, style;
    scene._globalLights.length = 0;
    scene._localLights[0].length = 0;
    scene._localLights[1].length = 0;
    for(i = 0;i < lights.length;i++) {
      var light = lights[i];
      if(light.getEnabled()) {
        if(light.getType() === pc.LIGHTTYPE_DIRECTIONAL) {
          scene._globalLights.push(light)
        }else {
          scene._localLights[light.getType() === pc.LIGHTTYPE_POINT ? 0 : 1].push(light)
        }
      }
    }
    this.culled = [];
    var meshPos;
    var visible;
    var camPos = camera._node.getPosition();
    for(i = 0;i < drawCallsCount;i++) {
      drawCall = drawCalls[i];
      visible = true;
      if(!drawCall.command) {
        if(drawCall._hidden) {
          continue
        }
        meshInstance = drawCall;
        if(meshInstance.layer === pc.LAYER_WORLD) {
          meshPos = meshInstance.aabb.center;
          if(camera.frustumCulling) {
            if(!meshInstance.aabb._radius) {
              meshInstance.aabb._radius = meshInstance.aabb.halfExtents.length()
            }
            tempSphere.center = meshPos;
            tempSphere.radius = meshInstance.aabb._radius;
            if(!camera._frustum.containsSphere(tempSphere)) {
              visible = false
            }
          }
          if(visible) {
            if(meshInstance.material.blendType === pc.BLEND_NORMAL || meshInstance.material.blendType === pc.BLEND_PREMULTIPLIED) {
              meshInstance.syncAabb();
              var tempx = meshPos.x - camPos.x;
              var tempy = meshPos.y - camPos.y;
              var tempz = meshPos.z - camPos.z;
              meshInstance.distSqr = tempx * tempx + tempy * tempy + tempz * tempz
            }else {
              if(meshInstance.distSqr !== undefined) {
                delete meshInstance.distSqr
              }
            }
          }
        }
      }
      if(visible) {
        this.culled.push(drawCall)
      }
    }
    drawCalls = this.culled;
    drawCallsCount = this.culled.length;
    for(i = 0;i < drawCallsCount;i++) {
      drawCall = drawCalls[i];
      if(drawCall.skinInstance) {
        drawCall.skinInstance.updateMatrixPalette()
      }
    }
    drawCalls.sort(sortDrawCalls);
    if(camera._depthTarget) {
      var oldTarget = camera.getRenderTarget();
      camera.setRenderTarget(camera._depthTarget);
      this.setCamera(camera);
      var oldBlending = device.getBlending();
      device.setBlending(false);
      for(i = 0;i < drawCallsCount;i++) {
        drawCall = drawCalls[i];
        if(!drawCall.command && drawCall.drawToDepth) {
          meshInstance = drawCall;
          mesh = meshInstance.mesh;
          this.modelMatrixId.setValue(meshInstance.node.worldTransform.data);
          if(meshInstance.skinInstance) {
            if(device.supportsBoneTextures) {
              this.boneTextureId.setValue(meshInstance.skinInstance.boneTexture);
              var w = meshInstance.skinInstance.boneTexture.width;
              var h = meshInstance.skinInstance.boneTexture.height;
              this.boneTextureSizeId.setValue([w, h])
            }else {
              this.poseMatrixId.setValue(meshInstance.skinInstance.matrixPalette)
            }
            device.setShader(this._depthShaderSkin)
          }else {
            device.setShader(this._depthShaderStatic)
          }
          style = meshInstance.renderStyle;
          device.setVertexBuffer(mesh.vertexBuffer, 0);
          device.setIndexBuffer(mesh.indexBuffer[style]);
          device.draw(mesh.primitive[style])
        }
        camera.setRenderTarget(oldTarget)
      }
      device.setBlending(oldBlending)
    }
    for(i = 0;i < lights.length;i++) {
      var light = lights[i];
      var type = light.getType();
      if(light.getCastShadows() && light.getEnabled() && light.shadowUpdateMode !== pc.SHADOWUPDATE_NONE) {
        if(light.shadowUpdateMode === pc.SHADOWUPDATE_THISFRAME) {
          light.shadowUpdateMode = pc.SHADOWUPDATE_NONE
        }
        var shadowCam = getShadowCamera(device, light);
        var passes = 1;
        var pass;
        if(type === pc.LIGHTTYPE_DIRECTIONAL) {
          var shadowDistance = light.getShadowDistance();
          _getFrustumCentroid(scene, camera, shadowDistance, this.centroid);
          shadowCam._node.setPosition(this.centroid);
          shadowCam._node.setRotation(light._node.getRotation());
          shadowCam._node.rotateLocal(-90, 0, 0);
          _getFrustumPoints(scene, camera, shadowDistance, frustumPoints);
          shadowCamWtm.copy(shadowCam._node.getWorldTransform());
          var worldToShadowCam = shadowCamWtm.invert();
          var camToWorld = camera._node.worldTransform;
          c2sc.mul2(worldToShadowCam, camToWorld);
          for(j = 0;j < 8;j++) {
            c2sc.transformPoint(frustumPoints[j], frustumPoints[j])
          }
          var minx, miny, minz, maxx, maxy, maxz;
          minx = miny = minz = 1E6;
          maxx = maxy = maxz = -1E6;
          for(j = 0;j < 8;j++) {
            var p = frustumPoints[j];
            if(p.x < minx) {
              minx = p.x
            }
            if(p.x > maxx) {
              maxx = p.x
            }
            if(p.y < miny) {
              miny = p.y
            }
            if(p.y > maxy) {
              maxy = p.y
            }
            if(p.z < minz) {
              minz = p.z
            }
            if(p.z > maxz) {
              maxz = p.z
            }
          }
          shadowCam._node.translateLocal(-(maxx + minx) * 0.5, (maxy + miny) * 0.5, maxz + (maxz - minz) * 0.25);
          shadowCamWtm.copy(shadowCam._node.getWorldTransform());
          shadowCam.setProjection(pc.PROJECTION_ORTHOGRAPHIC);
          shadowCam.setNearClip(0);
          shadowCam.setFarClip((maxz - minz) * 1.5);
          shadowCam.setAspectRatio((maxx - minx) / (maxy - miny));
          shadowCam.setOrthoHeight((maxy - miny) * 0.5)
        }else {
          if(type === pc.LIGHTTYPE_SPOT) {
            shadowCam.setProjection(pc.PROJECTION_PERSPECTIVE);
            shadowCam.setNearClip(light.getAttenuationEnd() / 1E3);
            shadowCam.setFarClip(light.getAttenuationEnd());
            shadowCam.setAspectRatio(1);
            shadowCam.setFov(light.getOuterConeAngle() * 2);
            var spos = light._node.getPosition();
            var srot = light._node.getRotation();
            shadowCamWtm.setTRS(spos, srot, pc.Vec3.ONE);
            shadowCamWtm.mul2(shadowCamWtm, camToLight)
          }else {
            if(type === pc.LIGHTTYPE_POINT) {
              shadowCam.setProjection(pc.PROJECTION_PERSPECTIVE);
              shadowCam.setNearClip(light.getAttenuationEnd() / 1E3);
              shadowCam.setFarClip(light.getAttenuationEnd());
              shadowCam.setAspectRatio(1);
              shadowCam.setFov(90);
              passes = 6;
              this.viewPosId.setValue(shadowCam._node.getPosition().data);
              this.lightRadiusId.setValue(light.getAttenuationEnd())
            }
          }
        }
        if(type != pc.LIGHTTYPE_POINT) {
          shadowCamView.copy(shadowCamWtm).invert();
          shadowCamViewProj.mul2(shadowCam.getProjectionMatrix(), shadowCamView);
          light._shadowMatrix.mul2(scaleShift, shadowCamViewProj);
          shadowCam._node.worldTransform.copy(shadowCamWtm)
        }
        var opChan = "r";
        for(pass = 0;pass < passes;pass++) {
          if(type === pc.LIGHTTYPE_POINT) {
            if(pass === 0) {
              shadowCam._node.setEulerAngles(0, 90, 180)
            }else {
              if(pass === 1) {
                shadowCam._node.setEulerAngles(0, -90, 180)
              }else {
                if(pass === 2) {
                  shadowCam._node.setEulerAngles(90, 0, 0)
                }else {
                  if(pass === 3) {
                    shadowCam._node.setEulerAngles(-90, 0, 0)
                  }else {
                    if(pass === 4) {
                      shadowCam._node.setEulerAngles(0, 180, 180)
                    }else {
                      if(pass === 5) {
                        shadowCam._node.setEulerAngles(0, 0, 180)
                      }
                    }
                  }
                }
              }
            }
            shadowCam._node.setPosition(light._node.getPosition());
            shadowCam.setRenderTarget(light._shadowCubeMap[pass])
          }
          this.setCamera(shadowCam, type !== pc.LIGHTTYPE_POINT);
          device.setBlending(false);
          device.setColorWrite(true, true, true, true);
          device.setDepthWrite(true);
          device.setDepthTest(true);
          if(device.extDepthTexture) {
            device.setColorWrite(false, false, false, false)
          }
          for(j = 0, numInstances = shadowCasters.length;j < numInstances;j++) {
            meshInstance = shadowCasters[j];
            mesh = meshInstance.mesh;
            material = meshInstance.material;
            device.setCullMode(material.cull);
            this.modelMatrixId.setValue(meshInstance.node.worldTransform.data);
            if(material.opacityMap) {
              scope.resolve("texture_opacityMap").setValue(material.opacityMap);
              if(material.opacityMapChannel) {
                opChan = material.opacityMapChannel
              }
            }
            if(meshInstance.skinInstance) {
              if(device.supportsBoneTextures) {
                this.boneTextureId.setValue(meshInstance.skinInstance.boneTexture);
                var w = meshInstance.skinInstance.boneTexture.width;
                var h = meshInstance.skinInstance.boneTexture.height;
                this.boneTextureSizeId.setValue([w, h])
              }else {
                this.poseMatrixId.setValue(meshInstance.skinInstance.matrixPalette)
              }
              if(type === pc.LIGHTTYPE_POINT) {
                device.setShader(material.opacityMap ? this._depthProgSkinOpPoint[light._shadowType][opChan] : this._depthProgSkinPoint[light._shadowType])
              }else {
                device.setShader(material.opacityMap ? this._depthProgSkinOp[light._shadowType][opChan] : this._depthProgSkin[light._shadowType])
              }
            }else {
              if(type === pc.LIGHTTYPE_POINT) {
                device.setShader(material.opacityMap ? this._depthProgStaticOpPoint[light._shadowType][opChan] : this._depthProgStaticPoint[light._shadowType])
              }else {
                device.setShader(material.opacityMap ? this._depthProgStaticOp[light._shadowType][opChan] : this._depthProgStatic[light._shadowType])
              }
            }
            style = meshInstance.renderStyle;
            device.setVertexBuffer(mesh.vertexBuffer, 0);
            device.setIndexBuffer(mesh.indexBuffer[style]);
            device.draw(mesh.primitive[style])
          }
        }
      }
    }
    this.setCamera(camera);
    this.dispatchGlobalLights(scene);
    if(scene.fog !== pc.FOG_NONE) {
      this.fogColor[0] = scene.fogColor.r;
      this.fogColor[1] = scene.fogColor.g;
      this.fogColor[2] = scene.fogColor.b;
      if(scene.gammaCorrection) {
        for(i = 0;i < 3;i++) {
          this.fogColor[i] = Math.pow(this.fogColor[i], 2.2)
        }
      }
      this.fogColorId.setValue(this.fogColor);
      if(scene.fog === pc.FOG_LINEAR) {
        this.fogStartId.setValue(scene.fogStart);
        this.fogEndId.setValue(scene.fogEnd)
      }else {
        this.fogDensityId.setValue(scene.fogDensity)
      }
    }
    var k;
    if(!pc._instanceVertexFormat) {
      var formatDesc = [{semantic:pc.SEMANTIC_TEXCOORD2, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_TEXCOORD3, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_TEXCOORD4, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_TEXCOORD5, components:4, type:pc.ELEMENTTYPE_FLOAT32}];
      pc._instanceVertexFormat = new pc.VertexFormat(device, formatDesc)
    }
    if(device.enableAutoInstancing) {
      if(!pc._autoInstanceBuffer) {
        pc._autoInstanceBuffer = new pc.VertexBuffer(device, pc._instanceVertexFormat, device.autoInstancingMaxObjects, pc.BUFFER_DYNAMIC);
        pc._autoInstanceBufferData = new Float32Array(pc._autoInstanceBuffer.lock())
      }
    }
    var next;
    var autoInstances;
    var j;
    var objDefs, prevObjDefs;
    for(i = 0;i < drawCallsCount;i++) {
      drawCall = drawCalls[i];
      if(drawCall.command) {
        drawCall.command()
      }else {
        meshInstance = drawCall;
        mesh = meshInstance.mesh;
        material = meshInstance.material;
        objDefs = meshInstance._shaderDefs;
        if(device.enableAutoInstancing && i !== numDrawCalls - 1 && material.useInstancing) {
          next = i + 1;
          autoInstances = 0;
          if(drawCalls[next].mesh === mesh && drawCalls[next].material === material) {
            for(j = 0;j < 16;j++) {
              pc._autoInstanceBufferData[j] = drawCall.node.worldTransform.data[j]
            }
            autoInstances = 1;
            while(next !== numDrawCalls && drawCalls[next].mesh === mesh && drawCalls[next].material === material) {
              for(j = 0;j < 16;j++) {
                pc._autoInstanceBufferData[autoInstances * 16 + j] = drawCalls[next].node.worldTransform.data[j]
              }
              autoInstances++;
              next++
            }
            meshInstance.instancingData = {};
            meshInstance.instancingData.count = autoInstances;
            meshInstance.instancingData._buffer = pc._autoInstanceBuffer;
            meshInstance.instancingData._buffer.unlock();
            i = next - 1
          }
        }
        if(meshInstance.instancingData && device.extInstancing) {
          if(!meshInstance.instancingData._buffer) {
            meshInstance.instancingData._buffer = new pc.VertexBuffer(device, pc._instanceVertexFormat, drawCall.instancingData.count, drawCall.instancingData.usage, meshInstance.instancingData.buffer)
          }
        }else {
          var modelMatrix = meshInstance.node.worldTransform;
          var normalMatrix = meshInstance.normalMatrix;
          modelMatrix.invertTo3x3(normalMatrix);
          normalMatrix.transpose();
          this.modelMatrixId.setValue(modelMatrix.data);
          this.normalMatrixId.setValue(normalMatrix.data)
        }
        if(meshInstance.skinInstance) {
          if(device.supportsBoneTextures) {
            this.boneTextureId.setValue(meshInstance.skinInstance.boneTexture);
            var w = meshInstance.skinInstance.boneTexture.width;
            var h = meshInstance.skinInstance.boneTexture.height;
            this.boneTextureSizeId.setValue([w, h])
          }else {
            this.poseMatrixId.setValue(meshInstance.skinInstance.matrixPalette)
          }
        }
        if(material && material === prevMaterial && objDefs !== prevObjDefs) {
          prevMaterial = null
        }
        if(material !== prevMaterial) {
          if(!meshInstance._shader) {
            meshInstance._shader = material.variants[objDefs];
            if(!meshInstance._shader) {
              material.updateShader(device, scene, objDefs);
              meshInstance._shader = material.variants[objDefs] = material.shader
            }
          }
          device.setShader(meshInstance._shader);
          var parameters = material.parameters;
          for(var paramName in parameters) {
            var parameter = parameters[paramName];
            if(!parameter.scopeId) {
              parameter.scopeId = device.scope.resolve(paramName)
            }
            parameter.scopeId.setValue(parameter.data)
          }
          if(!prevMaterial || material.mask !== prevMaterial.mask) {
            this._activeShadowLights = [];
            usedDirLights = this.dispatchDirectLights(scene, material.mask);
            this.dispatchLocalLights(scene, material.mask, usedDirLights)
          }
          if(material.shadowSampleType !== undefined) {
            for(k = 0;k < this._activeShadowLights.length;k++) {
              if(this._activeShadowLights[k]._shadowType === pc.SHADOW_DEPTHMASK) {
                if(material.shadowSampleType === pc.SHADOWSAMPLE_MASK) {
                  this._activeShadowLights[k]._shadowCamera._renderTarget.colorBuffer.minFilter = pc.FILTER_LINEAR;
                  this._activeShadowLights[k]._shadowCamera._renderTarget.colorBuffer.magFilter = pc.FILTER_LINEAR
                }else {
                  this._activeShadowLights[k]._shadowCamera._renderTarget.colorBuffer.minFilter = pc.FILTER_NEAREST;
                  this._activeShadowLights[k]._shadowCamera._renderTarget.colorBuffer.magFilter = pc.FILTER_NEAREST
                }
              }
            }
          }
          this.alphaTestId.setValue(material.alphaTest);
          device.setBlending(material.blend);
          device.setBlendFunction(material.blendSrc, material.blendDst);
          device.setBlendEquation(material.blendEquation);
          device.setColorWrite(material.redWrite, material.greenWrite, material.blueWrite, material.alphaWrite);
          device.setCullMode(material.cull);
          device.setDepthWrite(material.depthWrite);
          device.setDepthTest(material.depthTest)
        }
        device.setVertexBuffer(mesh.vertexBuffer, 0);
        style = meshInstance.renderStyle;
        device.setIndexBuffer(mesh.indexBuffer[style]);
        if(meshInstance.instancingData) {
          device.setVertexBuffer(meshInstance.instancingData._buffer, 1);
          device.draw(mesh.primitive[style], drawCall.instancingData.count);
          if(meshInstance.instancingData._buffer === pc._autoInstanceBuffer) {
            meshInstance.instancingData = null
          }
        }else {
          device.draw(mesh.primitive[style])
        }
        prevMaterial = material;
        prevMeshInstance = meshInstance;
        prevObjDefs = objDefs
      }
    }
  }});
  return{ForwardRenderer:ForwardRenderer}
}());
pc.extend(pc, function() {
  var GraphNode = function GraphNode() {
    this.name = "Untitled";
    this._labels = {};
    this.localPosition = new pc.Vec3(0, 0, 0);
    this.localRotation = new pc.Quat(0, 0, 0, 1);
    this.localScale = new pc.Vec3(1, 1, 1);
    this.localEulerAngles = new pc.Vec3(0, 0, 0);
    this.position = new pc.Vec3(0, 0, 0);
    this.rotation = new pc.Quat(0, 0, 0, 1);
    this.eulerAngles = new pc.Vec3(0, 0, 0);
    this.localTransform = new pc.Mat4;
    this.dirtyLocal = false;
    this.worldTransform = new pc.Mat4;
    this.dirtyWorld = false;
    this._right = new pc.Vec3;
    this._up = new pc.Vec3;
    this._forward = new pc.Vec3;
    this._parent = null;
    this._children = [];
    this._enabled = true;
    this._enabledInHierarchy = true
  };
  Object.defineProperty(GraphNode.prototype, "right", {get:function() {
    return this.getWorldTransform().getX(this._right).normalize()
  }});
  Object.defineProperty(GraphNode.prototype, "up", {get:function() {
    return this.getWorldTransform().getY(this._up).normalize()
  }});
  Object.defineProperty(GraphNode.prototype, "forward", {get:function() {
    return this.getWorldTransform().getZ(this._forward).normalize().scale(-1)
  }});
  Object.defineProperty(GraphNode.prototype, "forwards", {get:function() {
    console.log("pc.GraphNode#forwards is DEPRECATED. Use pc.GraphNode#forward instead.");
    return this.forward
  }});
  Object.defineProperty(GraphNode.prototype, "enabled", {get:function() {
    return this._enabled && this._enabledInHierarchy
  }, set:function(enabled) {
    if(this._enabled !== enabled) {
      this._enabled = enabled;
      if(!this._parent || this._parent.enabled) {
        this._notifyHierarchyStateChanged(this, enabled)
      }
    }
  }});
  pc.extend(GraphNode.prototype, {_notifyHierarchyStateChanged:function(node, enabled) {
    node._onHierarchyStateChanged(enabled);
    var c = node._children;
    for(var i = 0, len = c.length;i < len;i++) {
      if(c[i]._enabled) {
        this._notifyHierarchyStateChanged(c[i], enabled)
      }
    }
  }, _onHierarchyStateChanged:function(enabled) {
    this._enabledInHierarchy = enabled
  }, _cloneInternal:function(clone) {
    clone.name = this.name;
    clone._labels = pc.extend(this._labels, {});
    clone.localPosition.copy(this.localPosition);
    clone.localRotation.copy(this.localRotation);
    clone.localScale.copy(this.localScale);
    clone.localEulerAngles.copy(this.localEulerAngles);
    clone.position.copy(this.position);
    clone.rotation.copy(this.rotation);
    clone.eulerAngles.copy(this.eulerAngles);
    clone.localTransform.copy(this.localTransform);
    clone.dirtyLocal = this.dirtyLocal;
    clone.worldTransform.copy(this.worldTransform);
    clone.dirtyWorld = this.dirtyWorld;
    clone._enabled = this._enabled;
    clone._enabledInHierarchy = this._enabledInHierarchy
  }, clone:function() {
    var clone = new pc.GraphNode;
    this._cloneInternal(clone);
    return clone
  }, find:function(attr, value) {
    var i;
    var children = this.getChildren();
    var length = children.length;
    var results = [];
    var testValue;
    if(this[attr]) {
      if(this[attr] instanceof Function) {
        testValue = this[attr]()
      }else {
        testValue = this[attr]
      }
      if(testValue === value) {
        results.push(this)
      }
    }
    for(i = 0;i < length;++i) {
      results = results.concat(children[i].find(attr, value))
    }
    return results
  }, findOne:function(attr, value) {
    var i;
    var children = this.getChildren();
    var length = children.length;
    var result = null;
    var testValue;
    if(this[attr]) {
      if(this[attr] instanceof Function) {
        testValue = this[attr]()
      }else {
        testValue = this[attr]
      }
      if(testValue === value) {
        return this
      }
    }
    for(i = 0;i < length;++i) {
      result = children[i].findOne(attr, value);
      if(result !== null) {
        return result
      }
    }
    return null
  }, findByName:function(name) {
    if(this.name === name) {
      return this
    }
    for(var i = 0;i < this._children.length;i++) {
      var found = this._children[i].findByName(name);
      if(found !== null) {
        return found
      }
    }
    return null
  }, findByPath:function(path) {
    var parts = path.split("/");
    var currentParent = this;
    var result = null;
    for(var i = 0, imax = parts.length;i < imax && currentParent;i++) {
      var part = parts[i];
      result = null;
      var children = currentParent._children;
      for(var j = 0, jmax = children.length;j < jmax;j++) {
        if(children[j].name == part) {
          result = children[j];
          break
        }
      }
      currentParent = result
    }
    return result
  }, getPath:function() {
    var parent = this._parent;
    if(parent) {
      var path = this.name;
      var format = "{0}/{1}";
      while(parent && parent._parent) {
        path = pc.string.format(format, parent.name, path);
        parent = parent._parent
      }
      return path
    }else {
      return""
    }
  }, getRoot:function() {
    var parent = this.getParent();
    if(!parent) {
      return this
    }
    while(parent.getParent()) {
      parent = parent.getParent()
    }
    return parent
  }, getParent:function() {
    return this._parent
  }, getChildren:function() {
    return this._children
  }, getEulerAngles:function() {
    this.getWorldTransform().getEulerAngles(this.eulerAngles);
    return this.eulerAngles
  }, getLocalEulerAngles:function() {
    this.localRotation.getEulerAngles(this.localEulerAngles);
    return this.localEulerAngles
  }, getLocalPosition:function() {
    return this.localPosition
  }, getLocalRotation:function() {
    return this.localRotation
  }, getLocalScale:function() {
    return this.localScale
  }, getLocalTransform:function() {
    if(this.dirtyLocal) {
      this.localTransform.setTRS(this.localPosition, this.localRotation, this.localScale);
      this.dirtyLocal = false;
      this.dirtyWorld = true
    }
    return this.localTransform
  }, getName:function() {
    return this.name
  }, getPosition:function() {
    this.getWorldTransform().getTranslation(this.position);
    return this.position
  }, getRotation:function() {
    this.rotation.setFromMat4(this.getWorldTransform());
    return this.rotation
  }, getWorldTransform:function() {
    var syncList = [];
    return function() {
      var current = this;
      syncList.length = 0;
      while(current !== null) {
        syncList.push(current);
        current = current._parent
      }
      for(var i = syncList.length - 1;i >= 0;i--) {
        syncList[i].sync()
      }
      return this.worldTransform
    }
  }(), reparent:function(parent, index) {
    var current = this.getParent();
    if(current) {
      current.removeChild(this)
    }
    if(parent) {
      if(index >= 0) {
        parent.insertChild(this, index)
      }else {
        parent.addChild(this)
      }
    }
  }, setLocalEulerAngles:function() {
    var ex, ey, ez;
    switch(arguments.length) {
      case 1:
        ex = arguments[0].x;
        ey = arguments[0].y;
        ez = arguments[0].z;
        break;
      case 3:
        ex = arguments[0];
        ey = arguments[1];
        ez = arguments[2];
        break
    }
    this.localRotation.setFromEulerAngles(ex, ey, ez);
    this.dirtyLocal = true
  }, setLocalPosition:function() {
    if(arguments.length === 1) {
      this.localPosition.copy(arguments[0])
    }else {
      this.localPosition.set(arguments[0], arguments[1], arguments[2])
    }
    this.dirtyLocal = true
  }, setLocalRotation:function(q) {
    if(arguments.length === 1) {
      this.localRotation.copy(arguments[0])
    }else {
      this.localRotation.set(arguments[0], arguments[1], arguments[2], arguments[3])
    }
    this.dirtyLocal = true
  }, setLocalScale:function() {
    if(arguments.length === 1) {
      this.localScale.copy(arguments[0])
    }else {
      this.localScale.set(arguments[0], arguments[1], arguments[2])
    }
    this.dirtyLocal = true
  }, setName:function(name) {
    this.name = name
  }, setPosition:function() {
    var position = new pc.Vec3;
    var invParentWtm = new pc.Mat4;
    return function() {
      if(arguments.length === 1) {
        position.copy(arguments[0])
      }else {
        position.set(arguments[0], arguments[1], arguments[2])
      }
      if(this._parent === null) {
        this.localPosition.copy(position)
      }else {
        invParentWtm.copy(this._parent.getWorldTransform()).invert();
        invParentWtm.transformPoint(position, this.localPosition)
      }
      this.dirtyLocal = true
    }
  }(), setRotation:function() {
    var rotation = new pc.Quat;
    var invParentRot = new pc.Quat;
    return function() {
      if(arguments.length === 1) {
        rotation.copy(arguments[0])
      }else {
        rotation.set(arguments[0], arguments[1], arguments[2], arguments[3])
      }
      if(this._parent === null) {
        this.localRotation.copy(rotation)
      }else {
        var parentRot = this._parent.getRotation();
        invParentRot.copy(parentRot).invert();
        this.localRotation.copy(invParentRot).mul(rotation)
      }
      this.dirtyLocal = true
    }
  }(), setEulerAngles:function() {
    var invParentRot = new pc.Quat;
    return function() {
      var ex, ey, ez;
      switch(arguments.length) {
        case 1:
          ex = arguments[0].x;
          ey = arguments[0].y;
          ez = arguments[0].z;
          break;
        case 3:
          ex = arguments[0];
          ey = arguments[1];
          ez = arguments[2];
          break
      }
      this.localRotation.setFromEulerAngles(ex, ey, ez);
      if(this._parent !== null) {
        var parentRot = this._parent.getRotation();
        invParentRot.copy(parentRot).invert();
        this.localRotation.mul2(invParentRot, this.localRotation)
      }
      this.dirtyLocal = true
    }
  }(), addChild:function(node) {
    if(node.getParent() !== null) {
      throw new Error("GraphNode is already parented");
    }
    this._children.push(node);
    this._onInsertChild(node)
  }, addChildAndSaveTransform:function(node) {
    var wPos = node.getPosition();
    var wRot = node.getRotation();
    var current = node.getParent();
    if(current) {
      current.removeChild(node)
    }
    if(this.tmpMat4 == undefined) {
      this.tmpMat4 = new pc.Mat4;
      this.tmpQuat = new pc.Quat
    }
    node.setPosition(this.tmpMat4.copy(this.worldTransform).invert().transformPoint(wPos));
    node.setRotation(this.tmpQuat.copy(this.getRotation()).invert().mul(wRot));
    this._children.push(node);
    this._onInsertChild(node)
  }, insertChild:function(node, index) {
    if(node.getParent() !== null) {
      throw new Error("GraphNode is already parented");
    }
    this._children.splice(index, 0, node);
    this._onInsertChild(node)
  }, _onInsertChild:function(node) {
    node._parent = this;
    var enabledInHierarchy = node._enabled && this.enabled;
    if(node._enabledInHierarchy !== enabledInHierarchy) {
      node._enabledInHierarchy = enabledInHierarchy;
      node._notifyHierarchyStateChanged(node, enabledInHierarchy)
    }
    node.dirtyWorld = true
  }, removeChild:function(child) {
    var i;
    var length = this._children.length;
    child._parent = null;
    for(i = 0;i < length;++i) {
      if(this._children[i] === child) {
        this._children.splice(i, 1);
        return
      }
    }
  }, addLabel:function(label) {
    this._labels[label] = true
  }, getLabels:function() {
    return Object.keys(this._labels)
  }, hasLabel:function(label) {
    return!!this._labels[label]
  }, removeLabel:function(label) {
    delete this._labels[label]
  }, findByLabel:function(label, results) {
    var i, length = this._children.length;
    results = results || [];
    if(this.hasLabel(label)) {
      results.push(this)
    }
    for(i = 0;i < length;++i) {
      results = this._children[i].findByLabel(label, results)
    }
    return results
  }, sync:function() {
    if(this.dirtyLocal) {
      this.localTransform.setTRS(this.localPosition, this.localRotation, this.localScale);
      this.dirtyLocal = false;
      this.dirtyWorld = true
    }
    if(this.dirtyWorld) {
      if(this._parent === null) {
        this.worldTransform.copy(this.localTransform)
      }else {
        this.worldTransform.mul2(this._parent.worldTransform, this.localTransform)
      }
      this.dirtyWorld = false;
      for(var i = 0, len = this._children.length;i < len;i++) {
        this._children[i].dirtyWorld = true
      }
    }
  }, syncHierarchy:function() {
    var F = function() {
      if(!this._enabled) {
        return
      }
      this.sync();
      var c = this._children;
      for(var i = 0, len = c.length;i < len;i++) {
        F.call(c[i])
      }
    };
    return F
  }(), lookAt:function() {
    var matrix = new pc.Mat4;
    var target = new pc.Vec3;
    var up = new pc.Vec3;
    var rotation = new pc.Quat;
    return function() {
      switch(arguments.length) {
        case 1:
          target.copy(arguments[0]);
          up.copy(pc.Vec3.UP);
          break;
        case 2:
          target.copy(arguments[0]);
          up.copy(arguments[1]);
          break;
        case 3:
          target.set(arguments[0], arguments[1], arguments[2]);
          up.copy(pc.Vec3.UP);
          break;
        case 6:
          target.set(arguments[0], arguments[1], arguments[2]);
          up.set(arguments[3], arguments[4], arguments[5]);
          break
      }
      matrix.setLookAt(this.getPosition(), target, up);
      rotation.setFromMat4(matrix);
      this.setRotation(rotation)
    }
  }(), translate:function() {
    var translation = new pc.Vec3;
    return function() {
      switch(arguments.length) {
        case 1:
          translation.copy(arguments[0]);
          break;
        case 3:
          translation.set(arguments[0], arguments[1], arguments[2]);
          break
      }
      translation.add(this.getPosition());
      this.setPosition(translation)
    }
  }(), translateLocal:function() {
    var translation = new pc.Vec3;
    return function() {
      switch(arguments.length) {
        case 1:
          translation.copy(arguments[0]);
          break;
        case 3:
          translation.set(arguments[0], arguments[1], arguments[2]);
          break
      }
      this.localRotation.transformVector(translation, translation);
      this.localPosition.add(translation);
      this.dirtyLocal = true
    }
  }(), rotate:function() {
    var quaternion = new pc.Quat;
    var invParentRot = new pc.Quat;
    return function() {
      var ex, ey, ez;
      switch(arguments.length) {
        case 1:
          ex = arguments[0].x;
          ey = arguments[0].y;
          ez = arguments[0].z;
          break;
        case 3:
          ex = arguments[0];
          ey = arguments[1];
          ez = arguments[2];
          break
      }
      quaternion.setFromEulerAngles(ex, ey, ez);
      if(this._parent === null) {
        this.localRotation.mul2(quaternion, this.localRotation)
      }else {
        var rot = this.getRotation();
        var parentRot = this._parent.getRotation();
        invParentRot.copy(parentRot).invert();
        quaternion.mul2(invParentRot, quaternion);
        this.localRotation.mul2(quaternion, rot)
      }
      this.dirtyLocal = true
    }
  }(), rotateLocal:function() {
    var quaternion = new pc.Quat;
    return function() {
      var ex, ey, ez;
      switch(arguments.length) {
        case 1:
          ex = arguments[0].x;
          ey = arguments[0].y;
          ez = arguments[0].z;
          break;
        case 3:
          ex = arguments[0];
          ey = arguments[1];
          ez = arguments[2];
          break
      }
      quaternion.setFromEulerAngles(ex, ey, ez);
      this.localRotation.mul(quaternion);
      this.dirtyLocal = true
    }
  }()});
  return{GraphNode:GraphNode}
}());
pc.extend(pc, function() {
  var Camera = function() {
    this._projection = pc.PROJECTION_PERSPECTIVE;
    this._nearClip = 0.1;
    this._farClip = 1E4;
    this._fov = 45;
    this._orthoHeight = 10;
    this._aspect = 16 / 9;
    this.frustumCulling = false;
    this._projMatDirty = true;
    this._projMat = new pc.Mat4;
    this._viewMat = new pc.Mat4;
    this._viewProjMat = new pc.Mat4;
    this._rect = {x:0, y:0, width:1, height:1};
    this._frustum = new pc.Frustum(this._projMat, this._viewMat);
    this._renderTarget = null;
    this._clearOptions = {color:[186 / 255, 186 / 255, 177 / 255, 1], depth:1, flags:pc.CLEARFLAG_COLOR | pc.CLEARFLAG_DEPTH};
    this._node = null
  };
  Camera.prototype = {clone:function() {
    var clone = new pc.Camera;
    clone.setProjection(this.getProjection());
    clone.setNearClip(this.getNearClip());
    clone.setFarClip(this.getFarClip());
    clone.setFov(this.getFov());
    clone.setAspectRatio(this.getAspectRatio());
    clone.setRenderTarget(this.getRenderTarget());
    clone.setClearOptions(this.getClearOptions());
    clone.frustumCulling = this.frustumCulling;
    return clone
  }, worldToScreen:function(worldCoord, cw, ch, screenCoord) {
    if(screenCoord === undefined) {
      screenCoord = new pc.Vec3
    }
    var projMat = this.getProjectionMatrix();
    var wtm = this._node.getWorldTransform();
    this._viewMat.copy(wtm).invert();
    this._viewProjMat.mul2(projMat, this._viewMat);
    this._viewProjMat.transformPoint(worldCoord, screenCoord);
    var wp = worldCoord.data;
    var vpm = this._viewProjMat.data;
    var w = wp[0] * vpm[3] + wp[1] * vpm[7] + wp[2] * vpm[11] + 1 * vpm[15];
    screenCoord.x = (screenCoord.x / w + 1) * 0.5 * cw;
    screenCoord.y = (1 - screenCoord.y / w) * 0.5 * ch;
    return screenCoord
  }, screenToWorld:function(x, y, z, cw, ch, worldCoord) {
    if(worldCoord === undefined) {
      worldCoord = new pc.Vec3
    }
    var projMat = this.getProjectionMatrix();
    var wtm = this._node.getWorldTransform();
    this._viewMat.copy(wtm).invert();
    this._viewProjMat.mul2(projMat, this._viewMat);
    var invViewProjMat = this._viewProjMat.clone().invert();
    if(this._projection === pc.PROJECTION_PERSPECTIVE) {
      var far = new pc.Vec3(x / cw * 2 - 1, (ch - y) / ch * 2 - 1, 1);
      var farW = invViewProjMat.transformPoint(far);
      var w = far.x * invViewProjMat.data[3] + far.y * invViewProjMat.data[7] + far.z * invViewProjMat.data[11] + invViewProjMat.data[15];
      farW.scale(1 / w);
      var alpha = z / this._farClip;
      worldCoord.lerp(this._node.getPosition(), farW, alpha)
    }else {
      var range = this._farClip - this._nearClip;
      var deviceCoord = new pc.Vec3(x / cw * 2 - 1, (ch - y) / ch * 2 - 1, (this._farClip - z) / range * 2 - 1);
      invViewProjMat.transformPoint(deviceCoord, worldCoord)
    }
    return worldCoord
  }, getAspectRatio:function() {
    return this._aspect
  }, getClearOptions:function() {
    return this._clearOptions
  }, getFarClip:function() {
    return this._farClip
  }, getFov:function() {
    return this._fov
  }, getFrustum:function() {
    return this._frustum
  }, getNearClip:function() {
    return this._nearClip
  }, getOrthoHeight:function() {
    return this._orthoHeight
  }, getProjection:function() {
    return this._projection
  }, getProjectionMatrix:function() {
    if(this._projMatDirty) {
      if(this._projection === pc.PROJECTION_PERSPECTIVE) {
        this._projMat.setPerspective(this._fov, this._aspect, this._nearClip, this._farClip)
      }else {
        var y = this._orthoHeight;
        var x = y * this._aspect;
        this._projMat.setOrtho(-x, x, -y, y, this._nearClip, this._farClip)
      }
      this._projMatDirty = false
    }
    return this._projMat
  }, getRect:function() {
    return this._rect
  }, getRenderTarget:function() {
    return this._renderTarget
  }, setAspectRatio:function(aspect) {
    this._aspect = aspect;
    this._projMatDirty = true
  }, setClearOptions:function(options) {
    this._clearOptions = options
  }, setFarClip:function(far) {
    this._farClip = far;
    this._projMatDirty = true
  }, setFov:function(fov) {
    this._fov = fov;
    this._projMatDirty = true
  }, setNearClip:function(near) {
    this._nearClip = near;
    this._projMatDirty = true
  }, setOrthoHeight:function(height) {
    this._orthoHeight = height;
    this._projMatDirty = true
  }, setProjection:function(type) {
    this._projection = type;
    this._projMatDirty = true
  }, setRect:function(x, y, width, height) {
    this._rect.x = x;
    this._rect.y = y;
    this._rect.width = width;
    this._rect.height = height
  }, setRenderTarget:function(target) {
    this._renderTarget = target
  }};
  return{Camera:Camera}
}());
pc.extend(pc, function() {
  var Light = function Light() {
    this._type = pc.LIGHTTYPE_DIRECTIONAL;
    this._color = new pc.Color(0.8, 0.8, 0.8);
    this._intensity = 1;
    this._castShadows = false;
    this._enabled = false;
    this._attenuationStart = 10;
    this._attenuationEnd = 10;
    this._falloffMode = 0;
    this._shadowType = pc.SHADOW_DEPTH;
    this.mask = 1;
    this._innerConeAngle = 40;
    this._outerConeAngle = 45;
    this._finalColor = new pc.Vec3(0.8, 0.8, 0.8);
    this._linearFinalColor = new pc.Vec3;
    this._position = new pc.Vec3(0, 0, 0);
    this._direction = new pc.Vec3(0, 0, 0);
    this._innerConeAngleCos = Math.cos(this._innerConeAngle * Math.PI / 180);
    this._outerConeAngleCos = Math.cos(this._outerConeAngle * Math.PI / 180);
    this._shadowCamera = null;
    this._shadowMatrix = new pc.Mat4;
    this._shadowDistance = 40;
    this._shadowResolution = 1024;
    this._shadowBias = -5E-4;
    this._normalOffsetBias = 0;
    this.shadowUpdateMode = pc.SHADOWUPDATE_REALTIME;
    this._scene = null;
    this._node = null
  };
  Light.prototype = {clone:function() {
    var clone = new pc.Light;
    clone.setType(this.getType());
    clone.setColor(this.getColor());
    clone.setIntensity(this.getIntensity());
    clone.setCastShadows(this.getCastShadows());
    clone.setEnabled(this.getEnabled());
    clone.setAttenuationStart(this.getAttenuationStart());
    clone.setAttenuationEnd(this.getAttenuationEnd());
    clone.setFalloffMode(this.getFalloffMode());
    clone.setShadowType(this.getShadowType());
    clone.shadowUpdateMode = this.shadowUpdateMode;
    clone.mask = this.mask;
    clone.setInnerConeAngle(this.getInnerConeAngle());
    clone.setOuterConeAngle(this.getOuterConeAngle());
    clone.setShadowBias(this.getShadowBias());
    clone.setNormalOffsetBias(this.getNormalOffsetBias());
    clone.setShadowResolution(this.getShadowResolution());
    clone.setShadowDistance(this.getShadowDistance());
    return clone
  }, getAttenuationEnd:function() {
    return this._attenuationEnd
  }, getAttenuationStart:function() {
    return this._attenuationStart
  }, getFalloffMode:function() {
    return this._falloffMode
  }, getShadowType:function() {
    return this._shadowType
  }, getCastShadows:function() {
    return this._castShadows
  }, getColor:function() {
    return this._color
  }, getEnabled:function() {
    return this._enabled
  }, getInnerConeAngle:function() {
    return this._innerConeAngle
  }, getIntensity:function() {
    return this._intensity
  }, getOuterConeAngle:function() {
    return this._outerConeAngle
  }, getShadowBias:function() {
    return this._shadowBias
  }, getNormalOffsetBias:function() {
    return this._normalOffsetBias
  }, getShadowDistance:function() {
    return this._shadowDistance
  }, getShadowResolution:function() {
    return this._shadowResolution
  }, getType:function() {
    return this._type
  }, setAttenuationEnd:function(radius) {
    this._attenuationEnd = radius
  }, setAttenuationStart:function(radius) {
    this._attenuationStart = radius
  }, setFalloffMode:function(mode) {
    this._falloffMode = mode;
    if(this._scene !== null) {
      this._scene.updateShaders = true
    }
  }, setShadowType:function(mode) {
    this._shadowType = mode;
    if(this._scene !== null) {
      this._scene.updateShaders = true
    }
  }, setCastShadows:function(castShadows) {
    this._castShadows = castShadows;
    if(this._scene !== null) {
      this._scene.updateShaders = true
    }
  }, setColor:function() {
    var r, g, b;
    if(arguments.length === 1) {
      r = arguments[0].r;
      g = arguments[0].g;
      b = arguments[0].b
    }else {
      if(arguments.length === 3) {
        r = arguments[0];
        g = arguments[1];
        b = arguments[2]
      }
    }
    this._color.set(r, g, b);
    var i = this._intensity;
    this._finalColor.set(r * i, g * i, b * i);
    for(var c = 0;c < 3;c++) {
      if(i >= 1) {
        this._linearFinalColor.data[c] = Math.pow(this._finalColor.data[c] / i, 2.2) * i
      }else {
        this._linearFinalColor.data[c] = Math.pow(this._finalColor.data[c], 2.2)
      }
    }
  }, setEnabled:function(enable) {
    if(this._enabled !== enable) {
      this._enabled = enable;
      if(this._scene !== null) {
        this._scene.updateShaders = true
      }
    }
  }, setInnerConeAngle:function(angle) {
    this._innerConeAngle = angle;
    this._innerConeAngleCos = Math.cos(angle * Math.PI / 180)
  }, setIntensity:function(intensity) {
    this._intensity = intensity;
    var c = this._color;
    var r = c.r;
    var g = c.g;
    var b = c.b;
    var i = this._intensity;
    this._finalColor.set(r * i, g * i, b * i);
    for(var j = 0;j < 3;j++) {
      if(i >= 1) {
        this._linearFinalColor.data[j] = Math.pow(this._finalColor.data[j] / i, 2.2) * i
      }else {
        this._linearFinalColor.data[j] = Math.pow(this._finalColor.data[j], 2.2)
      }
    }
  }, setOuterConeAngle:function(angle) {
    this._outerConeAngle = angle;
    this._outerConeAngleCos = Math.cos(angle * Math.PI / 180)
  }, setShadowBias:function(bias) {
    this._shadowBias = bias
  }, setNormalOffsetBias:function(bias) {
    if(!this._normalOffsetBias && bias || this._normalOffsetBias && !bias) {
      this._scene.updateShaders = true
    }
    this._normalOffsetBias = bias
  }, setShadowDistance:function(distance) {
    this._shadowDistance = distance
  }, setShadowResolution:function(resolution) {
    this._shadowResolution = resolution
  }, setType:function(type) {
    this._type = type
  }, updateShadow:function() {
    if(this.shadowUpdateMode !== pc.SHADOWUPDATE_REALTIME) {
      this.shadowUpdateMode = pc.SHADOWUPDATE_THISFRAME
    }
  }};
  return{Light:Light}
}());
pc.extend(pc, function() {
  var id = 0;
  var Material = function Material() {
    this.name = "Untitled";
    this.id = id++;
    this.shader = null;
    this.variants = {};
    this.parameters = {};
    this.alphaTest = 0;
    this.blend = false;
    this.blendSrc = pc.BLENDMODE_ONE;
    this.blendDst = pc.BLENDMODE_ZERO;
    this.blendEquation = pc.BLENDEQUATION_ADD;
    this.cull = pc.CULLFACE_BACK;
    this.depthTest = true;
    this.depthWrite = true;
    this.redWrite = true;
    this.greenWrite = true;
    this.blueWrite = true;
    this.alphaWrite = true;
    this.mask = 1;
    this.meshInstances = []
  };
  Object.defineProperty(Material.prototype, "blendType", {get:function() {
    if(!this.blend && this.blendSrc === pc.BLENDMODE_ONE && this.blendDst === pc.BLENDMODE_ZERO && this.blendEquation === pc.BLENDEQUATION_ADD) {
      return pc.BLEND_NONE
    }else {
      if(this.blend && this.blendSrc === pc.BLENDMODE_SRC_ALPHA && this.blendDst === pc.BLENDMODE_ONE_MINUS_SRC_ALPHA && this.blendEquation === pc.BLENDEQUATION_ADD) {
        return pc.BLEND_NORMAL
      }else {
        if(this.blend && this.blendSrc === pc.BLENDMODE_ONE && this.blendDst === pc.BLENDMODE_ONE && this.blendEquation === pc.BLENDEQUATION_ADD) {
          return pc.BLEND_ADDITIVE
        }else {
          if(this.blend && this.blendSrc === pc.BLENDMODE_DST_COLOR && this.blendDst === pc.BLENDMODE_ZERO && this.blendEquation === pc.BLENDEQUATION_ADD) {
            return pc.BLEND_MULTIPLICATIVE
          }else {
            if(this.blend && this.blendSrc === pc.BLENDMODE_ONE && this.blendDst === pc.BLENDMODE_ONE_MINUS_SRC_ALPHA && this.blendEquation === pc.BLENDEQUATION_ADD) {
              return pc.BLEND_PREMULTIPLIED
            }else {
              return pc.BLEND_NORMAL
            }
          }
        }
      }
    }
  }, set:function(type) {
    switch(type) {
      case pc.BLEND_NONE:
        this.blend = false;
        this.blendSrc = pc.BLENDMODE_ONE;
        this.blendDst = pc.BLENDMODE_ZERO;
        this.blendEquation = pc.BLENDEQUATION_ADD;
        break;
      case pc.BLEND_NORMAL:
        this.blend = true;
        this.blendSrc = pc.BLENDMODE_SRC_ALPHA;
        this.blendDst = pc.BLENDMODE_ONE_MINUS_SRC_ALPHA;
        this.blendEquation = pc.BLENDEQUATION_ADD;
        break;
      case pc.BLEND_PREMULTIPLIED:
        this.blend = true;
        this.blendSrc = pc.BLENDMODE_ONE;
        this.blendDst = pc.BLENDMODE_ONE_MINUS_SRC_ALPHA;
        this.blendEquation = pc.BLENDEQUATION_ADD;
        break;
      case pc.BLEND_ADDITIVE:
        this.blend = true;
        this.blendSrc = pc.BLENDMODE_ONE;
        this.blendDst = pc.BLENDMODE_ONE;
        this.blendEquation = pc.BLENDEQUATION_ADD;
        break;
      case pc.BLEND_MULTIPLICATIVE:
        this.blend = true;
        this.blendSrc = pc.BLENDMODE_DST_COLOR;
        this.blendDst = pc.BLENDMODE_ZERO;
        this.blendEquation = pc.BLENDEQUATION_ADD;
        break
    }
    this._updateMeshInstanceKeys()
  }});
  Material.prototype._cloneInternal = function(clone) {
    clone.name = this.name;
    clone.id = id++;
    clone.shader = null;
    clone.variants = {};
    clone.parameters = {};
    clone.alphaTest = this.alphaTest;
    clone.blend = this.blend;
    clone.blendSrc = this.blendSrc;
    clone.blendDst = this.blendDst;
    clone.blendEquation = this.blendEquation;
    clone.cull = this.cull;
    clone.depthTest = this.depthTest;
    clone.depthWrite = this.depthWrite;
    clone.redWrite = this.redWrite;
    clone.greenWrite = this.greenWrite;
    clone.blueWrite = this.blueWrite;
    clone.alphaWrite = this.alphaWrite;
    clone.mask = this.mask;
    clone.meshInstances = []
  }, Material.prototype.clone = function() {
    var clone = new pc.Material;
    this._cloneInternal(clone);
    return clone
  }, Material.prototype._updateMeshInstanceKeys = function() {
    var i, meshInstances = this.meshInstances;
    for(var i = 0;i < meshInstances.length;i++) {
      meshInstances[i].updateKey()
    }
  };
  Material.prototype.updateShader = function(device, scene, objDefs) {
  };
  Material.prototype.getName = function() {
    return this.name
  };
  Material.prototype.setName = function(name) {
    this.name = name
  };
  Material.prototype.clearParameters = function() {
    this.parameters = {}
  };
  Material.prototype.getParameters = function() {
    return this.parameters
  };
  Material.prototype.clearVariants = function() {
    this.variants = {};
    for(i = 0;i < this.meshInstances.length;i++) {
      this.meshInstances[i]._shader = null
    }
  };
  Material.prototype.getParameter = function(name) {
    return this.parameters[name]
  };
  Material.prototype.setParameter = function(name, data) {
    var param = this.parameters[name];
    if(param) {
      param.data = data
    }else {
      this.parameters[name] = {scopeId:null, data:data}
    }
  };
  Material.prototype.deleteParameter = function(name) {
    if(this.parameters[name]) {
      delete this.parameters[name]
    }
  };
  Material.prototype.setParameters = function() {
    for(var paramName in this.parameters) {
      var parameter = this.parameters[paramName];
      if(!parameter.scopeId) {
        parameter.scopeId = device.scope.resolve(paramName)
      }
      parameter.scopeId.setValue(parameter.data)
    }
  };
  Material.prototype.getShader = function() {
    return this.shader
  };
  Material.prototype.setShader = function(shader) {
    this.shader = shader
  };
  Material.prototype.update = function() {
    throw Error("Not Implemented in base class");
  };
  Material.prototype.init = function(data) {
    throw Error("Not Implemented in base class");
  };
  return{Material:Material}
}());
pc.extend(pc, function() {
  var BasicMaterial = function() {
    this.color = new pc.Color(1, 1, 1, 1);
    this.colorMap = null;
    this.update()
  };
  BasicMaterial = pc.inherits(BasicMaterial, pc.Material);
  pc.extend(BasicMaterial.prototype, {clone:function() {
    var clone = new pc.BasicMaterial;
    Material.prototype._cloneInternal.call(this, clone);
    clone.color.copy(this.color);
    clone.colorMap = this.colorMap;
    clone.update();
    return clone
  }, update:function() {
    this.clearParameters();
    this.setParameter("uColor", this.color.data);
    if(this.colorMap) {
      this.setParameter("texture_diffuseMap", this.colorMap)
    }
  }, updateShader:function(device) {
    var options = {skin:!!this.meshInstances[0].skinInstance};
    var library = device.getProgramLibrary();
    this.shader = library.getProgram("basic", options)
  }});
  return{BasicMaterial:BasicMaterial}
}());
pc.extend(pc, function() {
  var DepthMaterial = function() {
  };
  DepthMaterial = pc.inherits(DepthMaterial, pc.Material);
  pc.extend(DepthMaterial.prototype, {clone:function() {
    var clone = new pc.DepthMaterial;
    Material.prototype._cloneInternal.call(this, clone);
    clone.update();
    return clone
  }, update:function() {
  }, updateShader:function(device) {
    var options = {skin:!!this.meshInstances[0].skinInstance};
    var library = device.getProgramLibrary();
    this.shader = library.getProgram("depth", options)
  }});
  return{DepthMaterial:DepthMaterial}
}());
pc.extend(pc, function() {
  var _tempTiling = new pc.Vec3;
  var _tempOffset = new pc.Vec3;
  var PhongMaterial = function() {
    this.reset();
    this.update()
  };
  var _createTexture = function(param) {
    if(param.data) {
      if(param.data instanceof pc.Texture) {
        return param.data
      }else {
        throw Error("PhongMaterial.init() expects textures to already be created");
      }
    }else {
      return null
    }
  };
  var _createVec2 = function(param) {
    return new pc.Vec2(param.data[0], param.data[1])
  };
  var _createVec3 = function(param) {
    return new pc.Vec3(param.data[0], param.data[1], param.data[2])
  };
  var _createRgb = function(param) {
    return new pc.Color(param.data[0], param.data[1], param.data[2])
  };
  var _beginProperties = function(obj) {
    if(!pc._matSerialProps) {
      obj._tempProps = [];
      for(var p in obj) {
        if(obj.hasOwnProperty(p)) {
          obj._tempProps[p] = true
        }
      }
    }
  };
  var _endProperties = function(obj) {
    if(!pc._matSerialProps) {
      pc._matSerialProps = [];
      for(var p in obj) {
        if(obj.hasOwnProperty(p) && !obj._tempProps[p]) {
          pc._matSerialProps.push(p)
        }
      }
    }
  };
  var _defineTex2D = function(obj, name, uv, channels) {
    obj[name + "Map"] = null;
    obj[name + "MapTiling"] = new pc.Vec2(1, 1);
    obj[name + "MapOffset"] = new pc.Vec2(0, 0);
    obj[name + "MapTransform"] = null;
    obj[name + "MapUv"] = uv;
    if(channels > 0) {
      obj[name + "MapChannel"] = channels > 1 ? "rgb" : "g"
    }
    if(!pc._matTex2D) {
      pc._matTex2D = []
    }
    pc._matTex2D[name] = channels
  };
  PhongMaterial = pc.inherits(PhongMaterial, pc.Material);
  pc.extend(PhongMaterial.prototype, {reset:function() {
    _beginProperties(this);
    this.ambient = new pc.Color(0.7, 0.7, 0.7);
    this.diffuse = new pc.Color(1, 1, 1);
    this.specular = new pc.Color(0, 0, 0);
    this.shininess = 25;
    this.emissive = new pc.Color(0, 0, 0);
    this.opacity = 1;
    this.blendType = pc.BLEND_NONE;
    this.bumpiness = 1;
    this.heightMapFactor = 1;
    _defineTex2D(this, "diffuse", 0, 3);
    _defineTex2D(this, "specular", 0, 3);
    _defineTex2D(this, "emissive", 0, 3);
    _defineTex2D(this, "normal", 0, -1);
    _defineTex2D(this, "metalness", 0, 1);
    _defineTex2D(this, "gloss", 0, 1);
    _defineTex2D(this, "opacity", 0, 1);
    _defineTex2D(this, "height", 0, 1);
    _defineTex2D(this, "ao", 0, 1);
    _defineTex2D(this, "light", 1, 3);
    this.cubeMap = null;
    this.sphereMap = null;
    this.reflectivity = 1;
    this.aoUvSet = 0;
    this.blendMapsWithColors = true;
    this.specularAntialias = false;
    this.conserveEnergy = true;
    this.occludeSpecular = true;
    this.shadingModel = pc.SPECULAR_PHONG;
    this.fresnelModel = pc.FRESNEL_NONE;
    this.fresnelFactor = 0;
    this.ambientTint = false;
    this.diffuseMapTint = false;
    this.specularMapTint = false;
    this.emissiveMapTint = false;
    this.emissiveIntensity = 1;
    this.normalizeNormalMap = true;
    this.fastTbn = false;
    this.useInstancing = false;
    this.cubeMapProjection = 0;
    this.cubeMapProjectionBox = null;
    this.chunks = {};
    this.chunks.copy = function(from) {
      for(var p in from) {
        if(from.hasOwnProperty(p) && p !== "copy") {
          this[p] = from[p]
        }
      }
    };
    this.customFragmentShader = null;
    this.refraction = 0;
    this.refractionIndex = 1 / 1.5;
    this.useMetalness = false;
    this.metalness = 1;
    this.shadowSampleType = pc.SHADOWSAMPLE_PCF3X3;
    this.forceFragmentPrecision = null;
    this.occludeDirect = false;
    this.prefilteredCubeMap128 = null;
    this.prefilteredCubeMap64 = null;
    this.prefilteredCubeMap32 = null;
    this.prefilteredCubeMap16 = null;
    this.prefilteredCubeMap8 = null;
    this.prefilteredCubeMap4 = null;
    _endProperties(this);
    this.ambientUniform = new Float32Array(3);
    this.diffuseUniform = new Float32Array(3);
    this.specularUniform = new Float32Array(3);
    this.emissiveUniform = new Float32Array(3);
    this.cubeMapMinUniform = new Float32Array(3);
    this.cubeMapMaxUniform = new Float32Array(3)
  }, clone:function() {
    var clone = new pc.PhongMaterial;
    pc.Material.prototype._cloneInternal.call(this, clone);
    var pname;
    for(var i = 0;i < pc._matSerialProps.length;i++) {
      pname = pc._matSerialProps[i];
      if(this[pname] !== undefined) {
        if(this[pname] && this[pname].copy) {
          clone[pname].copy(this[pname])
        }else {
          clone[pname] = this[pname]
        }
      }
    }
    clone.update();
    return clone
  }, init:function(data) {
    this.reset();
    this.name = data.name;
    for(var i = 0;i < data.parameters.length;i++) {
      var param = data.parameters[i];
      if(param.type === "vec3") {
        this[param.name] = _createRgb(param)
      }else {
        if(param.type === "vec2") {
          this[param.name] = _createVec2(param)
        }else {
          if(param.type === "texture") {
            this[param.name] = _createTexture(param)
          }else {
            if(param.name === "bumpMapFactor") {
              this.bumpiness = param.data
            }else {
              this[param.name] = param.data
            }
          }
        }
      }
    }
    this.update()
  }, _updateMapTransform:function(transform, tiling, offset) {
    transform = transform || new pc.Vec4;
    transform.set(tiling.x, tiling.y, offset.x, offset.y);
    if(transform.x == 1 && transform.y == 1 && transform.z == 0 && transform.w == 0) {
      return null
    }
    return transform
  }, _collectLights:function(lType, lights, lightsSorted) {
    for(var i = 0;i < lights.length;i++) {
      if(lights[i].getEnabled()) {
        if(lights[i].mask & this.mask) {
          if(lights[i].getType() == lType) {
            lightsSorted.push(lights[i])
          }
        }
      }
    }
  }, _updateMap:function(p) {
    var mname = p + "Map";
    if(this[mname]) {
      this.setParameter("texture_" + mname, this[mname]);
      var tname = mname + "Transform";
      this[tname] = this._updateMapTransform(this[tname], this[mname + "Tiling"], this[mname + "Offset"]);
      if(this[tname]) {
        this.setParameter("texture_" + tname, this[tname].data)
      }
    }
  }, update:function() {
    this.clearParameters();
    this.ambientUniform[0] = this.ambient.r;
    this.ambientUniform[1] = this.ambient.g;
    this.ambientUniform[2] = this.ambient.b;
    this.setParameter("material_ambient", this.ambientUniform);
    if(!this.diffuseMap || this.diffuseMapTint) {
      this.diffuseUniform[0] = this.diffuse.r;
      this.diffuseUniform[1] = this.diffuse.g;
      this.diffuseUniform[2] = this.diffuse.b;
      this.setParameter("material_diffuse", this.diffuseUniform)
    }
    if(!this.useMetalness) {
      if(!this.specularMap || this.specularMapTint) {
        this.specularUniform[0] = this.specular.r;
        this.specularUniform[1] = this.specular.g;
        this.specularUniform[2] = this.specular.b;
        this.setParameter("material_specular", this.specularUniform)
      }
    }else {
      if(!this.metalnessMap || this.metalness < 1) {
        this.setParameter("material_metalness", this.metalness)
      }
    }
    if(this.shadingModel === pc.SPECULAR_PHONG) {
      this.setParameter("material_shininess", Math.pow(2, this.shininess * 0.01 * 11))
    }else {
      this.setParameter("material_shininess", this.shininess * 0.01)
    }
    if(!this.emissiveMap || this.emissiveMapTint) {
      this.emissiveUniform[0] = this.emissive.r * this.emissiveIntensity;
      this.emissiveUniform[1] = this.emissive.g * this.emissiveIntensity;
      this.emissiveUniform[2] = this.emissive.b * this.emissiveIntensity;
      this.setParameter("material_emissive", this.emissiveUniform)
    }
    if(this.refraction > 0) {
      this.setParameter("material_refraction", this.refraction);
      this.setParameter("material_refractionIor", this.refractionIndex)
    }
    this.setParameter("material_opacity", this.opacity);
    if(this.cubeMapProjection === pc.CUBEPROJ_BOX) {
      this.cubeMapMinUniform[0] = this.cubeMapProjectionBox.center.x - this.cubeMapProjectionBox.halfExtents.x;
      this.cubeMapMinUniform[1] = this.cubeMapProjectionBox.center.y - this.cubeMapProjectionBox.halfExtents.y;
      this.cubeMapMinUniform[2] = this.cubeMapProjectionBox.center.z - this.cubeMapProjectionBox.halfExtents.z;
      this.cubeMapMaxUniform[0] = this.cubeMapProjectionBox.center.x + this.cubeMapProjectionBox.halfExtents.x;
      this.cubeMapMaxUniform[1] = this.cubeMapProjectionBox.center.y + this.cubeMapProjectionBox.halfExtents.y;
      this.cubeMapMaxUniform[2] = this.cubeMapProjectionBox.center.z + this.cubeMapProjectionBox.halfExtents.z;
      this.setParameter("envBoxMin", this.cubeMapMinUniform);
      this.setParameter("envBoxMax", this.cubeMapMaxUniform)
    }
    var i = 0;
    this._updateMap("diffuse");
    this._updateMap("specular");
    this._updateMap("gloss");
    this._updateMap("emissive");
    this._updateMap("opacity");
    this._updateMap("normal");
    this._updateMap("metalness");
    this._updateMap("height");
    this._updateMap("light");
    this._updateMap("ao");
    if(this.normalMap) {
      this.setParameter("material_bumpMapFactor", this.bumpiness)
    }
    if(this.heightMap) {
      this.setParameter("material_heightMapFactor", this.heightMapFactor * 0.025)
    }
    if(this.cubeMap) {
      this.setParameter("texture_cubeMap", this.cubeMap)
    }
    if(this.prefilteredCubeMap128) {
      this.setParameter("texture_prefilteredCubeMap128", this.prefilteredCubeMap128)
    }
    if(this.prefilteredCubeMap64) {
      this.setParameter("texture_prefilteredCubeMap64", this.prefilteredCubeMap64)
    }
    if(this.prefilteredCubeMap32) {
      this.setParameter("texture_prefilteredCubeMap32", this.prefilteredCubeMap32)
    }
    if(this.prefilteredCubeMap16) {
      this.setParameter("texture_prefilteredCubeMap16", this.prefilteredCubeMap16)
    }
    if(this.prefilteredCubeMap8) {
      this.setParameter("texture_prefilteredCubeMap8", this.prefilteredCubeMap8)
    }
    if(this.prefilteredCubeMap4) {
      this.setParameter("texture_prefilteredCubeMap4", this.prefilteredCubeMap4)
    }
    if(this.sphereMap) {
      this.setParameter("texture_sphereMap", this.sphereMap)
    }
    this.setParameter("material_reflectionFactor", this.reflectivity);
    if(this.fresnelFactor > 0) {
      this.setParameter("material_fresnelFactor", this.fresnelFactor)
    }
    this.shader = null;
    this.clearVariants()
  }, _getMapTransformID:function(xform, uv) {
    if(!xform) {
      return 0
    }
    if(!this._mapXForms[uv]) {
      this._mapXForms[uv] = []
    }
    var i, j, same;
    for(i = 0;i < this._mapXForms[uv].length;i++) {
      same = true;
      for(j = 0;j < xform.data.length;j++) {
        if(this._mapXForms[uv][i][j] != xform.data[j]) {
          same = false;
          break
        }
      }
      if(same) {
        return i + 1
      }
    }
    var newID = this._mapXForms[uv].length;
    this._mapXForms[uv][newID] = [];
    for(j = 0;j < xform.data.length;j++) {
      this._mapXForms[uv][newID][j] = xform.data[j]
    }
    return newID + 1
  }, updateShader:function(device, scene, objDefs) {
    var i;
    var lights = scene._lights;
    this._mapXForms = [];
    var useTexCubeLod = device.extTextureLod && device.samplerCount < 16;
    var prefilteredCubeMap128 = this.prefilteredCubeMap128 || scene.skyboxPrefiltered128;
    var prefilteredCubeMap64 = this.prefilteredCubeMap64 || scene.skyboxPrefiltered64;
    var prefilteredCubeMap32 = this.prefilteredCubeMap32 || scene.skyboxPrefiltered32;
    var prefilteredCubeMap16 = this.prefilteredCubeMap16 || scene.skyboxPrefiltered16;
    var prefilteredCubeMap8 = this.prefilteredCubeMap8 || scene.skyboxPrefiltered8;
    var prefilteredCubeMap4 = this.prefilteredCubeMap4 || scene.skyboxPrefiltered4;
    if(prefilteredCubeMap128) {
      var allMips = prefilteredCubeMap128 && prefilteredCubeMap64 && prefilteredCubeMap32 && prefilteredCubeMap16 && prefilteredCubeMap8 && prefilteredCubeMap4;
      if(useTexCubeLod) {
        if(prefilteredCubeMap128._levels.length < 6) {
          if(allMips) {
            this.setParameter("texture_prefilteredCubeMap128", prefilteredCubeMap128)
          }else {
            console.log("Can't use prefiltered cubemap: " + allMips + ", " + useTexCubeLod + ", " + prefilteredCubeMap128._levels)
          }
        }else {
          this.setParameter("texture_prefilteredCubeMap128", prefilteredCubeMap128)
        }
      }else {
        if(allMips) {
          this.setParameter("texture_prefilteredCubeMap128", prefilteredCubeMap128);
          this.setParameter("texture_prefilteredCubeMap64", prefilteredCubeMap64);
          this.setParameter("texture_prefilteredCubeMap32", prefilteredCubeMap32);
          this.setParameter("texture_prefilteredCubeMap16", prefilteredCubeMap16);
          this.setParameter("texture_prefilteredCubeMap8", prefilteredCubeMap8);
          this.setParameter("texture_prefilteredCubeMap4", prefilteredCubeMap4)
        }else {
          console.log("Can't use prefiltered cubemap: " + allMips + ", " + useTexCubeLod + ", " + prefilteredCubeMap128._levels)
        }
      }
    }
    var specularTint = false;
    var useSpecular = (this.useMetalness ? !!this.metalnessMap : !!this.specularMap) || !!this.sphereMap || !!this.cubeMap || prefilteredCubeMap128;
    useSpecular = useSpecular || (this.useMetalness ? this.metalness !== 0 : !(this.specular.r === 0 && this.specular.g === 0 && this.specular.b === 0));
    if(useSpecular) {
      if(this.specularMapTint && !this.useMetalness) {
        specularTint = this.specular.r !== 1 || this.specular.g !== 1 || this.specular.b !== 1
      }
    }
    var options = {fog:scene.fog, gamma:scene.gammaCorrection, toneMap:scene.toneMapping, blendMapsWithColors:this.blendMapsWithColors, modulateAmbient:this.ambientTint, diffuseTint:(this.diffuse.r != 1 || this.diffuse.g != 1 || this.diffuse.b != 1) && this.diffuseMapTint, specularTint:specularTint, metalnessTint:this.useMetalness && this.metalness < 1, glossTint:true, emissiveTint:(this.emissive.r != 1 || this.emissive.g != 1 || this.emissive.b != 1 || this.emissiveIntensity != 1) && this.emissiveMapTint,
    opacityTint:this.opacity != 1, needsNormalFloat:this.normalizeNormalMap, sphereMap:!!this.sphereMap, cubeMap:!!this.cubeMap, useSpecular:useSpecular, rgbmReflection:prefilteredCubeMap128 ? prefilteredCubeMap128.rgbm : this.cubeMap ? this.cubeMap.rgbm : this.sphereMap ? this.sphereMap.rgbm : false, hdrReflection:prefilteredCubeMap128 ? prefilteredCubeMap128.rgbm || prefilteredCubeMap128.format === pc.PIXELFORMAT_RGBA32F : this.cubeMap ? this.cubeMap.rgbm || this.cubeMap.format === pc.PIXELFORMAT_RGBA32F :
    this.sphereMap ? this.sphereMap.rgbm || this.sphereMap.format === pc.PIXELFORMAT_RGBA32F : false, fixSeams:prefilteredCubeMap128 ? prefilteredCubeMap128.fixCubemapSeams : this.cubeMap ? this.cubeMap.fixCubemapSeams : false, prefilteredCubemap:!!prefilteredCubeMap128, emissiveFormat:this.emissiveMap ? this.emissiveMap.rgbm ? 1 : this.emissiveMap.format === pc.PIXELFORMAT_RGBA32F ? 2 : 0 : null, specularAA:this.specularAntialias, conserveEnergy:this.conserveEnergy, occludeSpecular:this.occludeSpecular,
    occludeDirect:this.occludeDirect, shadingModel:this.shadingModel, fresnelModel:this.fresnelModel, packedNormal:this.normalMap ? this.normalMap._compressed : false, shadowSampleType:this.shadowSampleType, forceFragmentPrecision:this.forceFragmentPrecision, useInstancing:this.useInstancing, fastTbn:this.fastTbn, cubeMapProjection:this.cubeMapProjection, chunks:this.chunks, customFragmentShader:this.customFragmentShader, refraction:!!this.refraction, useMetalness:this.useMetalness, useTexCubeLod:useTexCubeLod};
    if(objDefs) {
      options.noShadow = (objDefs & pc.SHADERDEF_NOSHADOW) !== 0;
      options.skin = (objDefs & pc.SHADERDEF_SKIN) !== 0
    }
    for(var p in pc._matTex2D) {
      var mname = p + "Map";
      options[mname] = !!this[mname];
      if(options[mname]) {
        var tname = mname + "Transform";
        var cname = mname + "Channel";
        var uname = mname + "Uv";
        options[tname] = this._getMapTransformID(this[tname], this[uname]);
        options[cname] = this[cname];
        options[uname] = this[uname]
      }
    }
    options.aoMapUv = options.aoMapUv || this.aoUvSet;
    this._mapXForms = null;
    var lightsSorted = [];
    this._collectLights(pc.LIGHTTYPE_DIRECTIONAL, lights, lightsSorted);
    this._collectLights(pc.LIGHTTYPE_POINT, lights, lightsSorted);
    this._collectLights(pc.LIGHTTYPE_SPOT, lights, lightsSorted);
    options.lights = lightsSorted;
    for(i = 0;i < 3;i++) {
      if(scene.gammaCorrection) {
        this.ambientUniform[i] = Math.pow(this.ambient.data[i], 2.2);
        this.diffuseUniform[i] = Math.pow(this.diffuse.data[i], 2.2);
        this.specularUniform[i] = Math.pow(this.specular.data[i], 2.2);
        this.emissiveUniform[i] = Math.pow(this.emissive.data[i], 2.2) * this.emissiveIntensity
      }else {
        this.ambientUniform[i] = this.ambient.data[i];
        this.diffuseUniform[i] = this.diffuse.data[i];
        this.specularUniform[i] = this.specular.data[i];
        this.emissiveUniform[i] = this.emissive.data[i] * this.emissiveIntensity
      }
    }
    var library = device.getProgramLibrary();
    this.shader = library.getProgram("phong", options);
    if(!objDefs) {
      this.clearVariants();
      this.variants[0] = this.shader
    }
  }});
  return{PhongMaterial:PhongMaterial}
}());
pc.extend(pc, function() {
  var PickMaterial = function() {
    this.color = new pc.Color(1, 1, 1, 1);
    this.colorMap = null;
    this.update()
  };
  PickMaterial = pc.inherits(PickMaterial, pc.Material);
  pc.extend(PickMaterial.prototype, {clone:function() {
    var clone = new pc.PickMaterial;
    Material.prototype._cloneInternal.call(this, clone);
    clone.color.copy(this.color);
    clone.update();
    return clone
  }, update:function() {
    this.clearParameters();
    this.setParameter("uColor", this.color.data)
  }, updateShader:function(device) {
    var options = {skin:!!this.meshInstances[0].skinInstance};
    var library = device.getProgramLibrary();
    this.shader = library.getProgram("pick", options)
  }});
  return{PickMaterial:PickMaterial}
}());
pc.extend(pc, function() {
  function getKey(layer, blendType, isCommand, materialId) {
    return(layer & 7) << 28 | (blendType & 3) << 26 | (isCommand ? 1 : 0) << 25 | (materialId & 33554431) << 0
  }
  var Mesh = function() {
    this.vertexBuffer = null;
    this.indexBuffer = [null];
    this.primitive = [{type:0, base:0, count:0}];
    this.skin = null;
    this.aabb = new pc.shape.Aabb;
    this.boneAabb = null
  };
  var InstancingData = function(numObjects, dynamic, instanceSize) {
    instanceSize = instanceSize || 16;
    this.buffer = new Float32Array(numObjects * instanceSize);
    this.count = numObjects;
    this.usage = dynamic ? pc.BUFFER_DYNAMIC : pc.BUFFER_STATIC;
    this._buffer = null
  };
  InstancingData.prototype = {update:function() {
    if(this._buffer) {
      this._buffer.setData(this.buffer)
    }
  }};
  var MeshInstance = function MeshInstance(node, mesh, material) {
    this.node = node;
    this.mesh = mesh;
    this.material = material;
    this._shader = null;
    this._shaderDefs = 0;
    this.layer = pc.LAYER_WORLD;
    this.renderStyle = pc.RENDERSTYLE_SOLID;
    this.castShadow = false;
    this._receiveShadow = true;
    this.drawToDepth = true;
    this.key = 0;
    this.updateKey();
    this._skinInstance = null;
    this.aabb = new pc.shape.Aabb;
    this.normalMatrix = new pc.Mat3;
    this._boneAabb = null
  };
  Object.defineProperty(MeshInstance.prototype, "aabb", {get:function() {
    if(this.skinInstance) {
      var numBones = this.mesh.skin.boneNames.length;
      var i;
      if(!this.mesh.boneAabb) {
        this.mesh.boneAabb = [];
        var elems = this.mesh.vertexBuffer.format.elements;
        var numVerts = this.mesh.vertexBuffer.numVertices;
        var vertSize = this.mesh.vertexBuffer.format.size;
        var data = new DataView(this.mesh.vertexBuffer.storage);
        var boneVerts;
        var index;
        var offsetP, offsetI;
        var j, k;
        for(i = 0;i < elems.length;i++) {
          if(elems[i].name === pc.SEMANTIC_POSITION) {
            offsetP = elems[i].offset
          }else {
            if(elems[i].name === pc.SEMANTIC_BLENDINDICES) {
              offsetI = elems[i].offset
            }
          }
        }
        for(i = 0;i < numBones;i++) {
          boneVerts = [];
          for(j = 0;j < numVerts;j++) {
            for(k = 0;k < 4;k++) {
              index = data.getUint8(j * vertSize + offsetI + k, true);
              if(index === i) {
                boneVerts.push(data.getFloat32(j * vertSize + offsetP, true));
                boneVerts.push(data.getFloat32(j * vertSize + offsetP + 4, true));
                boneVerts.push(data.getFloat32(j * vertSize + offsetP + 8, true))
              }
            }
          }
          this.mesh.boneAabb.push(new pc.shape.Aabb);
          this.mesh.boneAabb[i].compute(boneVerts)
        }
      }
      if(!this._boneAabb) {
        this._boneAabb = [];
        for(i = 0;i < this.mesh.boneAabb.length;i++) {
          this._boneAabb[i] = new pc.shape.Aabb
        }
      }
      for(i = 0;i < this.mesh.boneAabb.length;i++) {
        this._boneAabb[i].setFromTransformedAabb(this.mesh.boneAabb[i], this.skinInstance.matrices[i])
      }
      this._aabb.center.copy(this._boneAabb[0].center);
      this._aabb.halfExtents.copy(this._boneAabb[0].halfExtents);
      for(i = 0;i < this.mesh.boneAabb.length;i++) {
        this._aabb.add(this._boneAabb[i])
      }
    }else {
      this._aabb.setFromTransformedAabb(this.mesh.aabb, this.node.worldTransform)
    }
    return this._aabb
  }, set:function(aabb) {
    this._aabb = aabb
  }});
  Object.defineProperty(MeshInstance.prototype, "material", {get:function() {
    return this._material
  }, set:function(material) {
    this._shader = null;
    if(this._material) {
      var meshInstances = this._material.meshInstances;
      var index = meshInstances.indexOf(this);
      if(index !== -1) {
        meshInstances.splice(index, 1)
      }
    }
    this._material = material;
    this._material.meshInstances.push(this);
    this.updateKey()
  }});
  Object.defineProperty(MeshInstance.prototype, "layer", {get:function() {
    return this._layer
  }, set:function(layer) {
    this._layer = layer;
    this.updateKey()
  }});
  Object.defineProperty(MeshInstance.prototype, "receiveShadow", {get:function() {
    return this._receiveShadow
  }, set:function(val) {
    this._receiveShadow = val;
    this._shaderDefs = val ? this._shaderDefs & ~pc.SHADERDEF_NOSHADOW : this._shaderDefs | pc.SHADERDEF_NOSHADOW;
    this._shader = null
  }});
  Object.defineProperty(MeshInstance.prototype, "skinInstance", {get:function() {
    return this._skinInstance
  }, set:function(val) {
    this._skinInstance = val;
    this._shaderDefs = val ? this._shaderDefs | pc.SHADERDEF_SKIN : this._shaderDefs & ~pc.SHADERDEF_SKIN;
    this._shader = null
  }});
  pc.extend(MeshInstance.prototype, {syncAabb:function() {
  }, updateKey:function() {
    var material = this.material;
    this.key = getKey(this.layer, material.blendType, false, material.id)
  }});
  var Command = function(layer, blendType, command) {
    this.key = getKey(layer, blendType, true, 0);
    this.command = command
  };
  return{Command:Command, Mesh:Mesh, MeshInstance:MeshInstance, InstancingData:InstancingData}
}());
pc.extend(pc, function() {
  var Skin = function(graphicsDevice, ibp, boneNames) {
    this.device = graphicsDevice;
    this.inverseBindPose = ibp;
    this.boneNames = boneNames
  };
  var SkinInstance = function(skin) {
    this.skin = skin;
    this.bones = [];
    var numBones = skin.inverseBindPose.length;
    var device = skin.device;
    if(device.supportsBoneTextures) {
      var size;
      if(numBones > 256) {
        size = 64
      }else {
        if(numBones > 64) {
          size = 32
        }else {
          if(numBones > 16) {
            size = 16
          }else {
            size = 8
          }
        }
      }
      this.matrixPalette = new Float32Array(size * size * 4);
      this.boneTexture = new pc.Texture(device, {width:size, height:size, format:pc.PIXELFORMAT_RGBA32F, autoMipmap:false});
      this.boneTexture.minFilter = pc.FILTER_NEAREST;
      this.boneTexture.magFilter = pc.FILTER_NEAREST;
      this.matrixPalette = this.boneTexture.lock()
    }else {
      this.matrixPalette = new Float32Array(numBones * 16)
    }
    this.matrices = [];
    for(var i = 0;i < numBones;i++) {
      this.matrices[i] = new pc.Mat4
    }
  };
  SkinInstance.prototype = {updateMatrixPalette:function() {
    var paletteEntry = new pc.Mat4;
    return function() {
      var pe = paletteEntry.data;
      var mp = this.matrixPalette;
      var base;
      for(var i = this.bones.length - 1;i >= 0;i--) {
        paletteEntry.mul2(this.bones[i].worldTransform, this.skin.inverseBindPose[i]);
        this.matrices[i].copy(paletteEntry);
        base = i * 16;
        mp[base] = pe[0];
        mp[base + 1] = pe[1];
        mp[base + 2] = pe[2];
        mp[base + 3] = pe[3];
        mp[base + 4] = pe[4];
        mp[base + 5] = pe[5];
        mp[base + 6] = pe[6];
        mp[base + 7] = pe[7];
        mp[base + 8] = pe[8];
        mp[base + 9] = pe[9];
        mp[base + 10] = pe[10];
        mp[base + 11] = pe[11];
        mp[base + 12] = pe[12];
        mp[base + 13] = pe[13];
        mp[base + 14] = pe[14];
        mp[base + 15] = pe[15]
      }
      if(this.skin.device.supportsBoneTextures) {
        this.boneTexture.lock();
        this.boneTexture.unlock()
      }
    }
  }()};
  return{Skin:Skin, SkinInstance:SkinInstance}
}());
pc.extend(pc, function() {
  function PartitionedVertex() {
    this.index = 0;
    this.boneIndices = [0, 0, 0, 0]
  }
  function SkinPartition() {
    this.partition = 0;
    this.vertexStart = 0;
    this.vertexCount = 0;
    this.indexStart = 0;
    this.indexCount = 0;
    this.boneIndices = [];
    this.vertices = [];
    this.indices = [];
    this.indexMap = {}
  }
  SkinPartition.prototype = {addVertex:function(vertex, idx, vertexArray) {
    var remappedIndex = -1;
    if(this.indexMap[idx] !== undefined) {
      remappedIndex = this.indexMap[idx];
      this.indices.push(remappedIndex)
    }else {
      for(var influence = 0;influence < 4;influence++) {
        if(vertexArray.blendWeight.data[idx * 4 + influence] === 0) {
          continue
        }
        var originalBoneIndex = vertexArray.blendIndices.data[vertex.index * 4 + influence];
        vertex.boneIndices[influence] = this.getBoneRemap(originalBoneIndex)
      }
      remappedIndex = this.vertices.length;
      this.indices.push(remappedIndex);
      this.vertices.push(vertex);
      this.indexMap[idx] = remappedIndex
    }
  }, addPrimitive:function(vertices, vertexIndices, vertexArray, boneLimit) {
    var i, j;
    var bonesToAdd = [];
    var bonesToAddCount = 0;
    var vertexCount = vertices.length;
    for(i = 0;i < vertexCount;i++) {
      var vertex = vertices[i];
      var idx = vertex.index;
      for(var influence = 0;influence < 4;influence++) {
        if(vertexArray.blendWeight.data[idx * 4 + influence] > 0) {
          var boneIndex = vertexArray.blendIndices.data[idx * 4 + influence];
          var needToAdd = true;
          for(j = 0;j < bonesToAddCount;j++) {
            if(bonesToAdd[j] == boneIndex) {
              needToAdd = false;
              break
            }
          }
          if(needToAdd) {
            bonesToAdd[bonesToAddCount] = boneIndex;
            var boneRemap = this.getBoneRemap(boneIndex);
            bonesToAddCount += boneRemap === -1 ? 1 : 0
          }
        }
      }
    }
    if(this.boneIndices.length + bonesToAddCount > boneLimit) {
      return false
    }
    for(i = 0;i < bonesToAddCount;i++) {
      this.boneIndices.push(bonesToAdd[i])
    }
    for(i = 0;i < vertexCount;i++) {
      this.addVertex(vertices[i], vertexIndices[i], vertexArray)
    }
    return true
  }, getBoneRemap:function(boneIndex) {
    for(var i = 0;i < this.boneIndices.length;i++) {
      if(this.boneIndices[i] === boneIndex) {
        return i
      }
    }
    return-1
  }};
  function indicesToReferences(model) {
    var i;
    var vertices = model.vertices;
    var skins = model.skins;
    var meshes = model.meshes;
    var meshInstances = model.meshInstances;
    for(i = 0;i < meshes.length;i++) {
      meshes[i].vertices = vertices[meshes[i].vertices];
      if(meshes[i].skin !== undefined) {
        meshes[i].skin = skins[meshes[i].skin]
      }
    }
    for(i = 0;i < meshInstances.length;i++) {
      meshInstances[i].mesh = meshes[meshInstances[i].mesh]
    }
  }
  function referencesToIndices(model) {
    var i;
    var vertices = model.vertices;
    var skins = model.skins;
    var meshes = model.meshes;
    var meshInstances = model.meshInstances;
    for(i = 0;i < meshes.length;i++) {
      meshes[i].vertices = vertices.indexOf(meshes[i].vertices);
      if(meshes[i].skin !== undefined) {
        meshes[i].skin = skins.indexOf(meshes[i].skin)
      }
    }
    for(i = 0;i < meshInstances.length;i++) {
      meshInstances[i].mesh = meshes.indexOf(meshInstances[i].mesh)
    }
  }
  function partitionSkin(model, materialMappings, boneLimit) {
    var i, j, k;
    indicesToReferences(model);
    var vertexArrays = model.vertices;
    var skins = model.skins;
    var meshes = model.meshes;
    var meshInstances = model.meshInstances;
    for(i = skins.length - 1;i >= 0;i--) {
      if(skins[i].boneNames.length > boneLimit) {
        var skin = skins.splice(i, 1)[0];
        var meshesToSplit = [];
        for(j = 0;j < meshes.length;j++) {
          if(meshes[j].skin === skin) {
            meshesToSplit.push(meshes[j])
          }
        }
        for(j = 0;j < meshesToSplit.length;j++) {
          var index = meshes.indexOf(meshesToSplit[j]);
          if(index !== -1) {
            meshes.splice(index, 1)
          }
        }
        if(meshesToSplit.length === 0) {
          throw new Error("partitionSkin: There should be at least one mesh that references a skin");
        }
        var vertexArray = meshesToSplit[0].vertices;
        for(j = 1;j < meshesToSplit.length;j++) {
          if(meshesToSplit[j].vertices !== vertexArray) {
            throw new Error("partitionSkin: All meshes that share a skin should also share the same vertex buffer");
          }
        }
        var partition;
        var partitions = [];
        var getVertex = function(idx) {
          var vert = new PartitionedVertex;
          vert.index = idx;
          return vert
        };
        var primitiveVertices = [];
        var primitiveIndices = [];
        var basePartition = 0;
        for(j = 0;j < meshesToSplit.length;j++) {
          var mesh = meshesToSplit[j];
          var indices = mesh.indices;
          for(var iIndex = mesh.base;iIndex < mesh.base + mesh.count;) {
            var index;
            index = indices[iIndex++];
            primitiveVertices[0] = getVertex(index);
            primitiveIndices[0] = index;
            index = indices[iIndex++];
            primitiveVertices[1] = getVertex(index);
            primitiveIndices[1] = index;
            index = indices[iIndex++];
            primitiveVertices[2] = getVertex(index);
            primitiveIndices[2] = index;
            var added = false;
            for(var iBonePartition = basePartition;iBonePartition < partitions.length;iBonePartition++) {
              partition = partitions[iBonePartition];
              if(partition.addPrimitive(primitiveVertices, primitiveIndices, vertexArray, boneLimit)) {
                added = true;
                break
              }
            }
            if(!added) {
              partition = new SkinPartition;
              partition.originalMesh = mesh;
              partition.addPrimitive(primitiveVertices, primitiveIndices, vertexArray, boneLimit);
              partitions.push(partition)
            }
          }
          basePartition = partitions.length
        }
        var partitionedVertices = [];
        var partitionedIndices = [];
        for(j = 0;j < partitions.length;j++) {
          partition = partitions[j];
          if(partition.vertices.length && partition.indices.length) {
            var vertexStart = partitionedVertices.length;
            var vertexCount = partition.vertices.length;
            var indexStart = partitionedIndices.length;
            var indexCount = partition.indices.length;
            partition.partition = j;
            partition.vertexStart = vertexStart;
            partition.vertexCount = vertexCount;
            partition.indexStart = indexStart;
            partition.indexCount = indexCount;
            var iSour;
            var iDest;
            iSour = 0;
            iDest = vertexStart;
            while(iSour < vertexCount) {
              partitionedVertices[iDest++] = partition.vertices[iSour++]
            }
            iSour = 0;
            iDest = indexStart;
            while(iSour < indexCount) {
              partitionedIndices[iDest++] = partition.indices[iSour++] + vertexStart
            }
          }
        }
        var splitSkins = [];
        for(j = 0;j < partitions.length;j++) {
          partition = partitions[j];
          var ibp = [];
          var boneNames = [];
          for(k = 0;k < partition.boneIndices.length;k++) {
            ibp.push(skin.inverseBindMatrices[partition.boneIndices[k]]);
            boneNames.push(skin.boneNames[partition.boneIndices[k]])
          }
          var splitSkin = {inverseBindMatrices:ibp, boneNames:boneNames};
          splitSkins.push(splitSkin);
          skins.push(splitSkin)
        }
        var attrib, attribName;
        var splitVertexArray = {};
        for(attribName in vertexArray) {
          splitVertexArray[attribName] = {components:vertexArray[attribName].components, data:[], type:vertexArray[attribName].type}
        }
        for(attribName in vertexArray) {
          if(attribName === "blendIndices") {
            var dstBoneIndices = splitVertexArray[attribName].data;
            for(j = 0;j < partitionedVertices.length;j++) {
              var srcBoneIndices = partitionedVertices[j].boneIndices;
              dstBoneIndices.push(srcBoneIndices[0], srcBoneIndices[1], srcBoneIndices[2], srcBoneIndices[3])
            }
          }else {
            attrib = vertexArray[attribName];
            data = attrib.data;
            components = attrib.components;
            for(j = 0;j < partitionedVertices.length;j++) {
              var index = partitionedVertices[j].index;
              for(k = 0;k < components;k++) {
                splitVertexArray[attribName].data.push(data[index * components + k])
              }
            }
          }
        }
        vertexArrays[vertexArrays.indexOf(vertexArray)] = splitVertexArray;
        var base = 0;
        for(j = 0;j < partitions.length;j++) {
          partition = partitions[j];
          var mesh = {aabb:{min:[0, 0, 0], max:[0, 0, 0]}, vertices:splitVertexArray, skin:splitSkins[j], indices:partitionedIndices.splice(0, partition.indexCount), type:"triangles", base:0, count:partition.indexCount};
          meshes.push(mesh);
          for(k = meshInstances.length - 1;k >= 0;k--) {
            if(meshInstances[k].mesh === partition.originalMesh) {
              meshInstances.push({mesh:mesh, node:meshInstances[k].node});
              if(materialMappings) {
                materialMappings.push({material:materialMappings[k].material, path:materialMappings[k].path})
              }
            }
          }
          base += partition.indexCount
        }
        for(j = 0;j < partitions.length;j++) {
          partition = partitions[j];
          for(k = meshInstances.length - 1;k >= 0;k--) {
            if(meshInstances[k].mesh === partition.originalMesh) {
              meshInstances.splice(k, 1);
              if(materialMappings) {
                materialMappings.splice(k, 1)
              }
            }
          }
        }
      }
    }
    referencesToIndices(model)
  }
  return{partitionSkin:partitionSkin}
}());
pc.extend(pc, function() {
  var Model = function Model() {
    this.graph = null;
    this.meshInstances = [];
    this.skinInstances = [];
    this.cameras = [];
    this.lights = []
  };
  Model.prototype = {getGraph:function() {
    return this.graph
  }, setGraph:function(graph) {
    this.graph = graph
  }, getCameras:function() {
    return this.cameras
  }, setCameras:function(cameras) {
    this.cameras = cameras
  }, getLights:function() {
    return this.lights
  }, setLights:function(lights) {
    this.lights = lights
  }, getMaterials:function() {
    var i;
    var materials = [];
    for(i = 0;i < this.meshInstances.length;i++) {
      var meshInstance = this.meshInstances[i];
      if(materials.indexOf(meshInstance.material) === -1) {
        materials.push(meshInstance.material)
      }
    }
    return materials
  }, clone:function() {
    var i;
    var srcNodes = [];
    var cloneNodes = [];
    var _duplicate = function(node) {
      var newNode = node.clone();
      srcNodes.push(node);
      cloneNodes.push(newNode);
      var children = node.getChildren();
      for(var i = 0;i < children.length;i++) {
        newNode.addChild(_duplicate(children[i]))
      }
      return newNode
    };
    var cloneGraph = _duplicate(this.graph);
    var cloneMeshInstances = [];
    var cloneSkinInstances = [];
    for(i = 0;i < this.skinInstances.length;i++) {
      var skin = this.skinInstances[i].skin;
      var cloneSkinInstance = new pc.SkinInstance(skin);
      var bones = [];
      for(j = 0;j < skin.boneNames.length;j++) {
        var boneName = skin.boneNames[j];
        var bone = cloneGraph.findByName(boneName);
        bones.push(bone)
      }
      cloneSkinInstance.bones = bones;
      cloneSkinInstances.push(cloneSkinInstance)
    }
    for(i = 0;i < this.meshInstances.length;i++) {
      var meshInstance = this.meshInstances[i];
      var nodeIndex = srcNodes.indexOf(meshInstance.node);
      var cloneMeshInstance = new pc.MeshInstance(cloneNodes[nodeIndex], meshInstance.mesh, meshInstance.material);
      if(meshInstance.skinInstance) {
        var skinInstanceIndex = this.skinInstances.indexOf(meshInstance.skinInstance);
        cloneMeshInstance.skinInstance = cloneSkinInstances[skinInstanceIndex]
      }
      cloneMeshInstances.push(cloneMeshInstance)
    }
    var clone = new pc.Model;
    clone.graph = cloneGraph;
    clone.meshInstances = cloneMeshInstances;
    clone.skinInstances = cloneSkinInstances;
    clone.getGraph().syncHierarchy();
    return clone
  }, generateWireframe:function() {
    var i, j, k;
    var i1, i2;
    var mesh, base, count, indexBuffer, wireBuffer;
    var srcIndices, dstIndices;
    var meshes = [];
    for(i = 0;i < this.meshInstances.length;i++) {
      mesh = this.meshInstances[i].mesh;
      if(meshes.indexOf(mesh) === -1) {
        meshes.push(mesh)
      }
    }
    var offsets = [[0, 1], [1, 2], [2, 0]];
    for(i = 0;i < meshes.length;i++) {
      mesh = meshes[i];
      base = mesh.primitive[pc.RENDERSTYLE_SOLID].base;
      count = mesh.primitive[pc.RENDERSTYLE_SOLID].count;
      indexBuffer = mesh.indexBuffer[pc.RENDERSTYLE_SOLID];
      srcIndices = new Uint16Array(indexBuffer.lock());
      var uniqueLineIndices = {};
      var lines = [];
      for(j = base;j < base + count;j += 3) {
        for(k = 0;k < 3;k++) {
          i1 = srcIndices[j + offsets[k][0]];
          i2 = srcIndices[j + offsets[k][1]];
          var line = i1 > i2 ? i2 << 16 | i1 : i1 << 16 | i2;
          if(uniqueLineIndices[line] === undefined) {
            uniqueLineIndices[line] = 0;
            lines.push(i1, i2)
          }
        }
      }
      indexBuffer.unlock();
      wireBuffer = new pc.IndexBuffer(indexBuffer.device, pc.INDEXFORMAT_UINT16, lines.length);
      dstIndices = new Uint16Array(wireBuffer.lock());
      dstIndices.set(lines);
      wireBuffer.unlock();
      mesh.primitive[pc.RENDERSTYLE_WIREFRAME] = {type:pc.PRIMITIVE_LINES, base:0, count:lines.length, indexed:true};
      mesh.indexBuffer[pc.RENDERSTYLE_WIREFRAME] = wireBuffer
    }
  }};
  return{Model:Model}
}());
pc.extend(pc, function() {
  var particleVerts = [[-1, -1], [1, -1], [1, 1], [-1, 1]];
  var _createTexture = function(device, width, height, pixelData, format, mult8Bit) {
    if(!format) {
      format = pc.PIXELFORMAT_RGBA32F
    }
    var texture = new pc.Texture(device, {width:width, height:height, format:format, cubemap:false, autoMipmap:false});
    texture.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    texture.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    texture.minFilter = pc.FILTER_NEAREST;
    texture.magFilter = pc.FILTER_NEAREST;
    var pixels = texture.lock();
    if(format == pc.PIXELFORMAT_R8_G8_B8_A8) {
      texture.minFilter = pc.FILTER_LINEAR;
      texture.magFilter = pc.FILTER_LINEAR;
      var temp = new Uint8Array(pixelData.length);
      for(var i = 0;i < pixelData.length;i++) {
        temp[i] = pixelData[i] * mult8Bit * 255
      }
      pixelData = temp
    }
    pixels.set(pixelData);
    texture.unlock();
    return texture
  };
  function saturate(x) {
    return Math.max(Math.min(x, 1), 0)
  }
  function glMod(x, y) {
    return x - y * Math.floor(x / y)
  }
  function tex1D(arr, u, chans, outArr, test) {
    var a, b, c;
    if(chans === undefined || chans < 2) {
      u *= arr.length - 1;
      a = arr[Math.floor(u)];
      b = arr[Math.ceil(u)];
      c = u % 1;
      return pc.math.lerp(a, b, c)
    }
    u *= arr.length / chans - 1;
    if(!outArr) {
      outArr = []
    }
    for(var i = 0;i < chans;i++) {
      a = arr[Math.floor(u) * chans + i];
      b = arr[Math.ceil(u) * chans + i];
      c = u % 1;
      outArr[i] = pc.math.lerp(a, b, c)
    }
    return outArr
  }
  var default0Curve = new pc.Curve([0, 0, 1, 0]);
  var default1Curve = new pc.Curve([0, 1, 1, 1]);
  var default0Curve3 = new pc.CurveSet([0, 0, 1, 0], [0, 0, 1, 0], [0, 0, 1, 0]);
  var default1Curve3 = new pc.CurveSet([0, 1, 1, 1], [0, 1, 1, 1], [0, 1, 1, 1]);
  var defaultParamTex = null;
  var velocityVec = new pc.Vec3;
  var localVelocityVec = new pc.Vec3;
  var velocityVec2 = new pc.Vec3;
  var localVelocityVec2 = new pc.Vec3;
  var rndFactor3Vec = new pc.Vec3;
  var particlePosPrev = new pc.Vec3;
  var particlePos = new pc.Vec3;
  var particleFinalPos = new pc.Vec3;
  var moveDirVec = new pc.Vec3;
  var rotMat = new pc.Mat4;
  var spawnMatrix3 = new pc.Mat3;
  var emitterMatrix3 = new pc.Mat3;
  var uniformScale = 1;
  var nonUniformScale;
  var spawnMatrix = new pc.Mat4;
  var randomPos = new pc.Vec3;
  var randomPosTformed = new pc.Vec3;
  var tmpVec3 = new pc.Vec3;
  var velocityV = new pc.Vec3;
  var setPropertyTarget;
  var setPropertyOptions;
  function setProperty(pName, defaultVal) {
    if(setPropertyOptions[pName] !== undefined && setPropertyOptions[pName] !== null) {
      setPropertyTarget[pName] = setPropertyOptions[pName]
    }else {
      setPropertyTarget[pName] = defaultVal
    }
  }
  function pack3NFloats(a, b, c) {
    var packed = a * 255 << 16 | b * 255 << 8 | c * 255;
    return packed / (1 << 24)
  }
  function packTextureXYZ_NXYZ(qXYZ, qXYZ2) {
    var num = qXYZ.length / 3;
    var colors = new Array(num * 4);
    for(var i = 0;i < num;i++) {
      colors[i * 4] = qXYZ[i * 3];
      colors[i * 4 + 1] = qXYZ[i * 3 + 1];
      colors[i * 4 + 2] = qXYZ[i * 3 + 2];
      colors[i * 4 + 3] = pack3NFloats(qXYZ2[i * 3], qXYZ2[i * 3 + 1], qXYZ2[i * 3 + 2])
    }
    return colors
  }
  function packTextureRGBA(qRGB, qA) {
    var colors = new Array(qA.length * 4);
    for(var i = 0;i < qA.length;i++) {
      colors[i * 4] = qRGB[i * 3];
      colors[i * 4 + 1] = qRGB[i * 3 + 1];
      colors[i * 4 + 2] = qRGB[i * 3 + 2];
      colors[i * 4 + 3] = qA[i]
    }
    return colors
  }
  function packTexture5Floats(qA, qB, qC, qD, qE) {
    var colors = new Array(qA.length * 4);
    for(var i = 0;i < qA.length;i++) {
      colors[i * 4] = qA[i];
      colors[i * 4 + 1] = qB[i];
      colors[i * 4 + 2] = 0;
      colors[i * 4 + 3] = pack3NFloats(qC[i], qD[i], qE[i])
    }
    return colors
  }
  function createOffscreenTarget(gd, camera) {
    var rect = camera._rect;
    var width = Math.floor(rect.width * gd.width);
    var height = Math.floor(rect.height * gd.height);
    var colorBuffer = new pc.Texture(gd, {format:pc.PIXELFORMAT_R8_G8_B8_A8, width:width, height:height});
    colorBuffer.minFilter = pc.FILTER_NEAREST;
    colorBuffer.magFilter = pc.FILTER_NEAREST;
    colorBuffer.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    colorBuffer.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    return new pc.RenderTarget(gd, colorBuffer, {depth:true})
  }
  var ParticleEmitter = function(graphicsDevice, options) {
    this.graphicsDevice = graphicsDevice;
    var gd = graphicsDevice;
    var precision = 32;
    this.precision = precision;
    if(!defaultParamTex) {
      var resolution = 16;
      var centerPoint = resolution * 0.5 + 0.5;
      var dtex = new Float32Array(resolution * resolution * 4);
      var x, y, xgrad, ygrad, p, c;
      for(y = 0;y < resolution;y++) {
        for(x = 0;x < resolution;x++) {
          xgrad = x + 1 - centerPoint;
          ygrad = y + 1 - centerPoint;
          c = saturate(1 - saturate(Math.sqrt(xgrad * xgrad + ygrad * ygrad) / resolution) - 0.5);
          p = y * resolution + x;
          dtex[p * 4] = 1;
          dtex[p * 4 + 1] = 1;
          dtex[p * 4 + 2] = 1;
          dtex[p * 4 + 3] = c
        }
      }
      defaultParamTex = _createTexture(gd, resolution, resolution, dtex, pc.PIXELFORMAT_R8_G8_B8_A8, 1);
      defaultParamTex.minFilter = pc.FILTER_LINEAR;
      defaultParamTex.magFilter = pc.FILTER_LINEAR
    }
    setPropertyTarget = this;
    setPropertyOptions = options;
    setProperty("numParticles", 1);
    setProperty("rate", 1);
    setProperty("rate2", this.rate);
    setProperty("lifetime", 50);
    setProperty("emitterExtents", new pc.Vec3(0, 0, 0));
    setProperty("emitterRadius", 0);
    setProperty("emitterShape", pc.EMITTERSHAPE_BOX);
    setProperty("initialVelocity", 1);
    setProperty("wrap", false);
    setProperty("wrapBounds", null);
    setProperty("colorMap", defaultParamTex);
    setProperty("normalMap", null);
    setProperty("loop", true);
    setProperty("preWarm", false);
    setProperty("sort", pc.PARTICLESORT_NONE);
    setProperty("mode", pc.PARTICLEMODE_GPU);
    setProperty("scene", null);
    setProperty("lighting", false);
    setProperty("halfLambert", false);
    setProperty("intensity", 1);
    setProperty("stretch", 0);
    setProperty("alignToMotion", false);
    setProperty("depthSoftening", 0);
    setProperty("mesh", null);
    setProperty("depthWrite", false);
    setProperty("blendType", pc.BLEND_NORMAL);
    setProperty("node", null);
    setProperty("startAngle", 0);
    setProperty("startAngle2", this.startAngle);
    this.frameRandom = new pc.Vec3(0, 0, 0);
    setProperty("colorGraph", default1Curve3);
    setProperty("colorGraph2", this.colorGraph);
    setProperty("scaleGraph", default1Curve);
    setProperty("scaleGraph2", this.scaleGraph);
    setProperty("alphaGraph", default1Curve);
    setProperty("alphaGraph2", this.alphaGraph);
    setProperty("localVelocityGraph", default0Curve3);
    setProperty("localVelocityGraph2", this.localVelocityGraph);
    setProperty("velocityGraph", default0Curve3);
    setProperty("velocityGraph2", this.velocityGraph);
    setProperty("rotationSpeedGraph", default0Curve);
    setProperty("rotationSpeedGraph2", this.rotationSpeedGraph);
    this.constantParticleTexIN = gd.scope.resolve("particleTexIN");
    this.constantParticleTexOUT = gd.scope.resolve("particleTexOUT");
    this.constantEmitterPos = gd.scope.resolve("emitterPos");
    this.constantEmitterScale = gd.scope.resolve("emitterScale");
    this.constantSpawnBounds = gd.scope.resolve("spawnBounds");
    this.constantSpawnBoundsSphere = gd.scope.resolve("spawnBoundsSphere");
    this.constantInitialVelocity = gd.scope.resolve("initialVelocity");
    this.constantFrameRandom = gd.scope.resolve("frameRandom");
    this.constantDelta = gd.scope.resolve("delta");
    this.constantRate = gd.scope.resolve("rate");
    this.constantRateDiv = gd.scope.resolve("rateDiv");
    this.constantLifetime = gd.scope.resolve("lifetime");
    this.constantLightCube = gd.scope.resolve("lightCube[0]");
    this.constantGraphSampleSize = gd.scope.resolve("graphSampleSize");
    this.constantGraphNumSamples = gd.scope.resolve("graphNumSamples");
    this.constantInternalTex0 = gd.scope.resolve("internalTex0");
    this.constantInternalTex1 = gd.scope.resolve("internalTex1");
    this.constantInternalTex2 = gd.scope.resolve("internalTex2");
    this.constantEmitterMatrix = gd.scope.resolve("emitterMatrix");
    this.constantNumParticles = gd.scope.resolve("numParticles");
    this.constantNumParticlesPot = gd.scope.resolve("numParticlesPot");
    this.constantLocalVelocityDivMult = gd.scope.resolve("localVelocityDivMult");
    this.constantVelocityDivMult = gd.scope.resolve("velocityDivMult");
    this.constantRotSpeedDivMult = gd.scope.resolve("rotSpeedDivMult");
    this.constantSeed = gd.scope.resolve("seed");
    this.constantStartAngle = gd.scope.resolve("startAngle");
    this.constantStartAngle2 = gd.scope.resolve("startAngle2");
    this.lightCube = new Float32Array(6 * 3);
    this.lightCubeDir = new Array(6);
    this.lightCubeDir[0] = new pc.Vec3(-1, 0, 0);
    this.lightCubeDir[1] = new pc.Vec3(1, 0, 0);
    this.lightCubeDir[2] = new pc.Vec3(0, -1, 0);
    this.lightCubeDir[3] = new pc.Vec3(0, 1, 0);
    this.lightCubeDir[4] = new pc.Vec3(0, 0, -1);
    this.lightCubeDir[5] = new pc.Vec3(0, 0, 1);
    this.internalTex0 = null;
    this.internalTex1 = null;
    this.internalTex2 = null;
    this.internalTex3 = null;
    this.vbToSort = null;
    this.vbOld = null;
    this.particleDistance = null;
    this.camera = null;
    this.swapTex = false;
    this.useMesh = true;
    this.useCpu = false;
    this.shaderParticleUpdateRespawn = null;
    this.shaderParticleUpdateNoRespawn = null;
    this.shaderParticleUpdateOnStop = null;
    this.numParticleVerts = 0;
    this.numParticleIndices = 0;
    this.material = null;
    this.meshInstance = null;
    this.seed = 0;
    this.rebuild()
  };
  function calcEndTime(emitter) {
    var interval = Math.max(emitter.rate, emitter.rate2) * emitter.numParticles + emitter.lifetime;
    return Date.now() + interval * 1E3
  }
  function subGraph(A, B) {
    var r = new Float32Array(A.length);
    for(var i = 0;i < A.length;i++) {
      r[i] = A[i] - B[i]
    }
    return r
  }
  function maxUnsignedGraphValue(A, outUMax) {
    var i, j;
    var chans = outUMax.length;
    var values = A.length / chans;
    for(i = 0;i < values;i++) {
      for(j = 0;j < chans;j++) {
        var a = Math.abs(A[i * chans + j]);
        outUMax[j] = Math.max(outUMax[j], a)
      }
    }
  }
  function normalizeGraph(A, uMax) {
    var chans = uMax.length;
    var i, j;
    var values = A.length / chans;
    for(i = 0;i < values;i++) {
      for(j = 0;j < chans;j++) {
        A[i * chans + j] /= uMax[j];
        A[i * chans + j] *= 0.5;
        A[i * chans + j] += 0.5
      }
    }
  }
  function divGraphFrom2Curves(curve1, curve2, outUMax) {
    var sub = subGraph(curve2, curve1);
    maxUnsignedGraphValue(sub, outUMax);
    normalizeGraph(sub, outUMax);
    return sub
  }
  function mat4ToMat3(mat4, mat3) {
    mat3.data[0] = mat4.data[0];
    mat3.data[1] = mat4.data[1];
    mat3.data[2] = mat4.data[2];
    mat3.data[3] = mat4.data[4];
    mat3.data[4] = mat4.data[5];
    mat3.data[5] = mat4.data[6];
    mat3.data[6] = mat4.data[8];
    mat3.data[7] = mat4.data[9];
    mat3.data[8] = mat4.data[10]
  }
  ParticleEmitter.prototype = {onChangeCamera:function() {
    if(this.depthSoftening > 0) {
      if(this.camera) {
        if(!this.camera._depthTarget) {
          this.camera._depthTarget = createOffscreenTarget(this.graphicsDevice, this.camera);
          this._depthTarget = this.camera._depthTarget
        }
      }
    }
    this.regenShader();
    this.resetMaterial()
  }, rebuild:function() {
    var i, len;
    var precision = this.precision;
    var gd = this.graphicsDevice;
    this.spawnBounds = this.emitterShape === pc.EMITTERSHAPE_BOX ? this.emitterExtents : this.emitterRadius;
    this.useCpu = this.useCpu || this.sort > pc.PARTICLESORT_NONE || !(gd.extTextureFloat && gd.maxVertexTextures >= 1 && gd.extTextureFloatRenderable) || gd.fragmentUniformsCount < 100;
    this.vertexBuffer = undefined;
    this.useMesh = false;
    if(this.mesh) {
      var totalVertCount = this.numParticles * this.mesh.vertexBuffer.numVertices;
      if(totalVertCount > 65535) {
        console.warn("WARNING: particle system can't render mesh particles because numParticles * numVertices is more than 65k. Reverting to quad particles.")
      }else {
        this.useMesh = true
      }
    }
    this.numParticlesPot = pc.math.nextPowerOfTwo(this.numParticles);
    this.rebuildGraphs();
    this.vbToSort = new Array(this.numParticles);
    this.particleDistance = new Float32Array(this.numParticles);
    this.frameRandom.x = Math.random();
    this.frameRandom.y = Math.random();
    this.frameRandom.z = Math.random();
    this.particleTex = new Float32Array(this.numParticlesPot * 4 * 4);
    var emitterPos = this.node === null ? pc.Vec3.ZERO : this.node.getPosition();
    if(this.emitterShape === pc.EMITTERSHAPE_BOX) {
      if(this.node === null) {
        spawnMatrix.setTRS(pc.Vec3.ZERO, pc.Quat.IDENTITY, this.spawnBounds)
      }else {
        spawnMatrix.setTRS(pc.Vec3.ZERO, this.node.getRotation(), tmpVec3.copy(this.spawnBounds).mul(this.node.getLocalScale()))
      }
    }
    for(i = 0;i < this.numParticles;i++) {
      this.calcSpawnPosition(emitterPos, i)
    }
    this.particleTexStart = new Float32Array(this.numParticlesPot * 4 * 4);
    for(i = 0;i < this.particleTexStart.length;i++) {
      this.particleTexStart[i] = this.particleTex[i]
    }
    if(!this.useCpu) {
      this.particleTexIN = _createTexture(gd, this.numParticlesPot, 4, this.particleTex);
      this.particleTexOUT = _createTexture(gd, this.numParticlesPot, 4, this.particleTex);
      this.particleTexStart = _createTexture(gd, this.numParticlesPot, 4, this.particleTexStart);
      this.rtParticleTexIN = new pc.RenderTarget(gd, this.particleTexIN, {depth:false});
      this.rtParticleTexOUT = new pc.RenderTarget(gd, this.particleTexOUT, {depth:false});
      this.swapTex = false
    }
    var chunks = pc.shaderChunks;
    var shaderCodeStart = chunks.particleUpdaterInitPS + (this.emitterShape === pc.EMITTERSHAPE_BOX ? chunks.particleUpdaterAABBPS : chunks.particleUpdaterSpherePS) + chunks.particleUpdaterStartPS;
    var shaderCodeRespawn = shaderCodeStart + chunks.particleUpdaterRespawnPS + chunks.particleUpdaterEndPS;
    var shaderCodeNoRespawn = shaderCodeStart + chunks.particleUpdaterEndPS;
    var shaderCodeOnStop = shaderCodeStart + chunks.particleUpdaterOnStopPS + chunks.particleUpdaterEndPS;
    this.shaderParticleUpdateRespawn = chunks.createShaderFromCode(gd, chunks.fullscreenQuadVS, shaderCodeRespawn, "fsQuad0");
    this.shaderParticleUpdateNoRespawn = chunks.createShaderFromCode(gd, chunks.fullscreenQuadVS, shaderCodeNoRespawn, "fsQuad1");
    this.shaderParticleUpdateOnStop = chunks.createShaderFromCode(gd, chunks.fullscreenQuadVS, shaderCodeOnStop, "fsQuad2");
    this.numParticleVerts = this.useMesh ? this.mesh.vertexBuffer.numVertices : 4;
    this.numParticleIndices = this.useMesh ? this.mesh.indexBuffer[0].numIndices : 6;
    this._allocate(this.numParticles);
    var mesh = new pc.Mesh;
    mesh.vertexBuffer = this.vertexBuffer;
    mesh.indexBuffer[0] = this.indexBuffer;
    mesh.primitive[0].type = pc.PRIMITIVE_TRIANGLES;
    mesh.primitive[0].base = 0;
    mesh.primitive[0].count = this.numParticles * this.numParticleIndices;
    mesh.primitive[0].indexed = true;
    this.material = new pc.Material;
    this.material.cullMode = pc.CULLFACE_NONE;
    this.material.blend = true;
    this.material.blendType = this.blendType;
    this.material.depthWrite = this.depthWrite;
    this.material.emitter = this;
    this.regenShader();
    this.resetMaterial();
    this.meshInstance = new pc.MeshInstance(this.node, mesh, this.material);
    this.meshInstance.updateKey();
    this.meshInstance.drawToDepth = false;
    this._initializeTextures();
    this.addTime(0);
    if(this.preWarm) {
      this.prewarm(this.lifetime)
    }
    this.resetTime()
  }, calcSpawnPosition:function(emitterPos, i) {
    this.particleTex[i * 4 + 0 + this.numParticlesPot * 2 * 4] = Math.random();
    this.particleTex[i * 4 + 1 + this.numParticlesPot * 2 * 4] = Math.random();
    this.particleTex[i * 4 + 2 + this.numParticlesPot * 2 * 4] = Math.random();
    this.particleTex[i * 4 + 3 + this.numParticlesPot * 2 * 4] = Math.random();
    var rX = this.particleTex[i * 4 + 0 + this.numParticlesPot * 2 * 4];
    var rY = this.particleTex[i * 4 + 1 + this.numParticlesPot * 2 * 4];
    var rZ = this.particleTex[i * 4 + 2 + this.numParticlesPot * 2 * 4];
    var rW = this.particleTex[i * 4 + 3 + this.numParticlesPot * 2 * 4];
    randomPos.data[0] = rX - 0.5;
    randomPos.data[1] = rY - 0.5;
    randomPos.data[2] = rZ - 0.5;
    if(this.emitterShape === pc.EMITTERSHAPE_BOX) {
      randomPosTformed.copy(emitterPos).add(spawnMatrix.transformPoint(randomPos))
    }else {
      randomPos.normalize();
      randomPosTformed.copy(emitterPos).add(randomPos.scale(rW * this.spawnBounds))
    }
    this.particleTex[i * 4] = randomPosTformed.data[0];
    this.particleTex[i * 4 + 1] = randomPosTformed.data[1];
    this.particleTex[i * 4 + 2] = randomPosTformed.data[2];
    this.particleTex[i * 4 + 3] = pc.math.lerp(this.startAngle * pc.math.DEG_TO_RAD, this.startAngle2 * pc.math.DEG_TO_RAD, rX);
    var particleRate = pc.math.lerp(this.rate, this.rate2, rX);
    var startSpawnTime = -particleRate * i;
    this.particleTex[i * 4 + 3 + this.numParticlesPot * 4] = startSpawnTime
  }, rebuildGraphs:function() {
    var precision = this.precision;
    var gd = this.graphicsDevice;
    var i;
    this.qLocalVelocity = this.localVelocityGraph.quantize(precision);
    this.qVelocity = this.velocityGraph.quantize(precision);
    this.qColor = this.colorGraph.quantize(precision);
    this.qRotSpeed = this.rotationSpeedGraph.quantize(precision);
    this.qScale = this.scaleGraph.quantize(precision);
    this.qAlpha = this.alphaGraph.quantize(precision);
    this.qLocalVelocity2 = this.localVelocityGraph2.quantize(precision);
    this.qVelocity2 = this.velocityGraph2.quantize(precision);
    this.qColor2 = this.colorGraph2.quantize(precision);
    this.qRotSpeed2 = this.rotationSpeedGraph2.quantize(precision);
    this.qScale2 = this.scaleGraph2.quantize(precision);
    this.qAlpha2 = this.alphaGraph2.quantize(precision);
    for(i = 0;i < precision;i++) {
      this.qRotSpeed[i] *= pc.math.DEG_TO_RAD;
      this.qRotSpeed2[i] *= pc.math.DEG_TO_RAD
    }
    this.localVelocityUMax = new pc.Vec3(0, 0, 0);
    this.velocityUMax = new pc.Vec3(0, 0, 0);
    this.colorUMax = new pc.Vec3(0, 0, 0);
    this.rotSpeedUMax = [0];
    this.scaleUMax = [0];
    this.alphaUMax = [0];
    this.qLocalVelocityDiv = divGraphFrom2Curves(this.qLocalVelocity, this.qLocalVelocity2, this.localVelocityUMax.data);
    this.qVelocityDiv = divGraphFrom2Curves(this.qVelocity, this.qVelocity2, this.velocityUMax.data);
    this.qColorDiv = divGraphFrom2Curves(this.qColor, this.qColor2, this.colorUMax.data);
    this.qRotSpeedDiv = divGraphFrom2Curves(this.qRotSpeed, this.qRotSpeed2, this.rotSpeedUMax);
    this.qScaleDiv = divGraphFrom2Curves(this.qScale, this.qScale2, this.scaleUMax);
    this.qAlphaDiv = divGraphFrom2Curves(this.qAlpha, this.qAlpha2, this.alphaUMax);
    if(!this.useCpu) {
      this.internalTex0 = _createTexture(gd, precision, 1, packTextureXYZ_NXYZ(this.qLocalVelocity, this.qLocalVelocityDiv));
      this.internalTex1 = _createTexture(gd, precision, 1, packTextureXYZ_NXYZ(this.qVelocity, this.qVelocityDiv));
      this.internalTex2 = _createTexture(gd, precision, 1, packTexture5Floats(this.qRotSpeed, this.qScale, this.qScaleDiv, this.qRotSpeedDiv, this.qAlphaDiv))
    }
    this.internalTex3 = _createTexture(gd, precision, 1, packTextureRGBA(this.qColor, this.qAlpha), pc.PIXELFORMAT_R8_G8_B8_A8, 1)
  }, _initializeTextures:function() {
    if(this.colorMap) {
      this.material.setParameter("colorMap", this.colorMap);
      if(this.lighting && this.normalMap) {
        this.material.setParameter("normalMap", this.normalMap)
      }
    }
  }, _hasDepthTarget:function() {
    if(this.camera) {
      return!!this.camera._depthTarget
    }
    return false
  }, regenShader:function() {
    var programLib = this.graphicsDevice.getProgramLibrary();
    var hasNormal = this.normalMap != null;
    this.normalOption = 0;
    if(this.lighting) {
      this.normalOption = hasNormal ? 2 : 1
    }
    this.material.updateShader = function() {
      var shader = programLib.getProgram("particle", {useCpu:this.emitter.useCpu, normal:this.emitter.normalOption, halflambert:this.emitter.halfLambert, stretch:this.emitter.stretch, alignToMotion:this.emitter.alignToMotion, soft:this.emitter.depthSoftening && this.emitter._hasDepthTarget(), mesh:this.emitter.useMesh, gamma:this.emitter.scene ? this.emitter.scene.gammaCorrection : 0, toneMap:this.emitter.scene ? this.emitter.scene.toneMapping : 0, fog:this.emitter.scene ? this.emitter.scene.fog :
      "none", wrap:this.emitter.wrap && this.emitter.wrapBounds, blend:this.blendType});
      this.setShader(shader)
    };
    this.material.updateShader()
  }, resetMaterial:function() {
    var material = this.material;
    var gd = this.graphicsDevice;
    material.setParameter("stretch", this.stretch);
    material.setParameter("colorMult", this.intensity);
    if(!this.useCpu) {
      material.setParameter("internalTex0", this.internalTex0);
      material.setParameter("internalTex1", this.internalTex1);
      material.setParameter("internalTex2", this.internalTex2)
    }
    material.setParameter("internalTex3", this.internalTex3);
    material.setParameter("numParticles", this.numParticles);
    material.setParameter("numParticlesPot", this.numParticlesPot);
    material.setParameter("lifetime", this.lifetime);
    material.setParameter("rate", this.rate);
    material.setParameter("rateDiv", this.rate2 - this.rate);
    material.setParameter("seed", this.seed);
    material.setParameter("scaleDivMult", this.scaleUMax[0]);
    material.setParameter("alphaDivMult", this.alphaUMax[0]);
    material.setParameter("graphNumSamples", this.precision);
    material.setParameter("graphSampleSize", 1 / this.precision);
    material.setParameter("emitterScale", pc.Vec3.ONE.data);
    if(this.wrap && this.wrapBounds) {
      material.setParameter("wrapBounds", this.wrapBounds.data)
    }
    if(this.colorMap) {
      material.setParameter("colorMap", this.colorMap)
    }
    if(this.lighting) {
      if(this.normalMap) {
        material.setParameter("normalMap", this.normalMap)
      }
    }
    if(this.depthSoftening > 0 && this._hasDepthTarget()) {
      material.setParameter("uDepthMap", this.camera._depthTarget.colorBuffer);
      material.setParameter("screenSize", (new pc.Vec4(gd.width, gd.height, 1 / gd.width, 1 / gd.height)).data);
      material.setParameter("softening", 1 / (this.depthSoftening * this.depthSoftening * 100))
    }
    if(this.stretch > 0) {
      material.cull = pc.CULLFACE_NONE
    }
  }, _allocate:function(numParticles) {
    var psysVertCount = numParticles * this.numParticleVerts;
    var psysIndexCount = numParticles * this.numParticleIndices;
    var elements, particleFormat;
    var i;
    if(this.vertexBuffer === undefined || this.vertexBuffer.getNumVertices() !== psysVertCount) {
      if(!this.useCpu) {
        elements = [{semantic:pc.SEMANTIC_ATTR0, components:4, type:pc.ELEMENTTYPE_FLOAT32}];
        particleFormat = new pc.VertexFormat(this.graphicsDevice, elements);
        this.vertexBuffer = new pc.VertexBuffer(this.graphicsDevice, particleFormat, psysVertCount, pc.BUFFER_DYNAMIC);
        this.indexBuffer = new pc.IndexBuffer(this.graphicsDevice, pc.INDEXFORMAT_UINT16, psysIndexCount)
      }else {
        elements = [{semantic:pc.SEMANTIC_ATTR0, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_ATTR1, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_ATTR2, components:4, type:pc.ELEMENTTYPE_FLOAT32}, {semantic:pc.SEMANTIC_ATTR3, components:2, type:pc.ELEMENTTYPE_FLOAT32}];
        particleFormat = new pc.VertexFormat(this.graphicsDevice, elements);
        this.vertexBuffer = new pc.VertexBuffer(this.graphicsDevice, particleFormat, psysVertCount, pc.BUFFER_DYNAMIC);
        this.indexBuffer = new pc.IndexBuffer(this.graphicsDevice, pc.INDEXFORMAT_UINT16, psysIndexCount)
      }
      var data = new Float32Array(this.vertexBuffer.lock());
      var meshData, stride;
      if(this.useMesh) {
        meshData = new Float32Array(this.mesh.vertexBuffer.lock());
        stride = meshData.length / this.mesh.vertexBuffer.numVertices
      }
      var rnd;
      for(i = 0;i < psysVertCount;i++) {
        id = Math.floor(i / this.numParticleVerts);
        if(i % this.numParticleVerts === 0) {
          rnd = this.particleTex[i * 4 + 0 + this.numParticlesPot * 2 * 4]
        }
        if(!this.useMesh) {
          var vertID = i % 4;
          data[i * 4] = particleVerts[vertID][0];
          data[i * 4 + 1] = particleVerts[vertID][1];
          data[i * 4 + 2] = 0
        }else {
          var vert = i % this.numParticleVerts;
          data[i * 4] = meshData[vert * stride];
          data[i * 4 + 1] = meshData[vert * stride + 1];
          data[i * 4 + 2] = meshData[vert * stride + 2]
        }
        data[i * 4 + 3] = id
      }
      if(this.useCpu) {
        this.vbCPU = new Float32Array(data);
        this.vbOld = new Float32Array(this.vbCPU.length)
      }
      this.vertexBuffer.unlock();
      if(this.useMesh) {
        this.mesh.vertexBuffer.unlock()
      }
      var dst = 0;
      indices = new Uint16Array(this.indexBuffer.lock());
      if(this.useMesh) {
        meshData = new Uint16Array(this.mesh.indexBuffer[0].lock())
      }
      for(i = 0;i < numParticles;i++) {
        if(!this.useMesh) {
          var baseIndex = i * 4;
          indices[dst++] = baseIndex;
          indices[dst++] = baseIndex + 1;
          indices[dst++] = baseIndex + 2;
          indices[dst++] = baseIndex;
          indices[dst++] = baseIndex + 2;
          indices[dst++] = baseIndex + 3
        }else {
          for(var j = 0;j < this.numParticleIndices;j++) {
            indices[i * this.numParticleIndices + j] = meshData[j] + i * this.numParticleVerts
          }
        }
      }
      this.indexBuffer.unlock();
      if(this.useMesh) {
        this.mesh.indexBuffer[0].unlock()
      }
    }
  }, reset:function() {
    this.seed = Math.random();
    this.material.setParameter("seed", this.seed);
    if(this.useCpu) {
      for(var i = 0;i < this.particleTexStart.length;i++) {
        this.particleTex[i] = this.particleTexStart[i]
      }
    }else {
      this._initializeTextures()
    }
    this.resetTime();
    var origLoop = this.loop;
    this.loop = true;
    this.addTime(0);
    this.loop = origLoop;
    if(this.preWarm) {
      this.prewarm(this.lifetime)
    }
  }, prewarm:function(time) {
    var lifetimeFraction = time / this.lifetime;
    var iterations = Math.min(Math.floor(lifetimeFraction * this.precision), this.precision);
    var stepDelta = time / iterations;
    for(var i = 0;i < iterations;i++) {
      this.addTime(stepDelta)
    }
  }, resetTime:function() {
    this.endTime = calcEndTime(this)
  }, addTime:function(delta, isOnStop) {
    var i, j;
    var device = this.graphicsDevice;
    device.setBlending(false);
    device.setColorWrite(true, true, true, true);
    device.setCullMode(pc.CULLFACE_NONE);
    device.setDepthTest(false);
    device.setDepthWrite(false);
    if(this.lighting) {
      if(!this.scene) {
        console.error("There is no scene defined for lighting particles");
        return
      }
      for(i = 0;i < 6;i++) {
        this.lightCube[i * 3] = this.scene.ambientLight.r;
        this.lightCube[i * 3 + 1] = this.scene.ambientLight.g;
        this.lightCube[i * 3 + 2] = this.scene.ambientLight.b
      }
      var dirs = this.scene._globalLights;
      for(i = 0;i < dirs.length;i++) {
        for(var c = 0;c < 6;c++) {
          var weight = Math.max(this.lightCubeDir[c].dot(dirs[i]._direction), 0) * dirs[i]._intensity;
          this.lightCube[c * 3] += dirs[i]._color.r * weight;
          this.lightCube[c * 3 + 1] += dirs[i]._color.g * weight;
          this.lightCube[c * 3 + 2] += dirs[i]._color.b * weight
        }
      }
      this.constantLightCube.setValue(this.lightCube)
    }
    if(this.scene) {
      if(this.camera != this.scene._activeCamera) {
        this.camera = this.scene._activeCamera;
        this.onChangeCamera()
      }
    }
    if(this.emitterShape === pc.EMITTERSHAPE_BOX) {
      if(this.meshInstance.node === null) {
        spawnMatrix.setTRS(pc.Vec3.ZERO, pc.Quat.IDENTITY, this.emitterExtents)
      }else {
        spawnMatrix.setTRS(pc.Vec3.ZERO, this.meshInstance.node.getRotation(), tmpVec3.copy(this.emitterExtents).mul(this.meshInstance.node.getLocalScale()))
      }
    }
    var emitterScale = this.meshInstance.node === null ? pc.Vec3.ONE.data : this.meshInstance.node.getLocalScale().data;
    this.material.setParameter("emitterScale", emitterScale);
    if(!this.useCpu) {
      this.frameRandom.x = Math.random();
      this.frameRandom.y = Math.random();
      this.frameRandom.z = Math.random();
      this.constantGraphSampleSize.setValue(1 / this.precision);
      this.constantGraphNumSamples.setValue(this.precision);
      this.constantNumParticles.setValue(this.numParticles);
      this.constantNumParticlesPot.setValue(this.numParticlesPot);
      this.constantInternalTex0.setValue(this.internalTex0);
      this.constantInternalTex1.setValue(this.internalTex1);
      this.constantInternalTex2.setValue(this.internalTex2);
      var emitterPos = this.meshInstance.node === null ? pc.Vec3.ZERO.data : this.meshInstance.node.getPosition().data;
      var emitterMatrix = this.meshInstance.node === null ? pc.Mat4.IDENTITY : this.meshInstance.node.getWorldTransform();
      if(this.emitterShape === pc.EMITTERSHAPE_BOX) {
        mat4ToMat3(spawnMatrix, spawnMatrix3);
        this.constantSpawnBounds.setValue(spawnMatrix3.data)
      }else {
        this.constantSpawnBoundsSphere.setValue(this.emitterRadius)
      }
      this.constantInitialVelocity.setValue(this.initialVelocity);
      mat4ToMat3(emitterMatrix, emitterMatrix3);
      this.constantEmitterPos.setValue(emitterPos);
      this.constantFrameRandom.setValue(this.frameRandom.data);
      this.constantDelta.setValue(delta);
      this.constantRate.setValue(this.rate);
      this.constantRateDiv.setValue(this.rate2 - this.rate);
      this.constantStartAngle.setValue(this.startAngle * pc.math.DEG_TO_RAD);
      this.constantStartAngle2.setValue(this.startAngle2 * pc.math.DEG_TO_RAD);
      this.constantSeed.setValue(this.seed);
      this.constantLifetime.setValue(this.lifetime);
      this.constantEmitterScale.setValue(emitterScale);
      this.constantEmitterMatrix.setValue(emitterMatrix3.data);
      this.constantLocalVelocityDivMult.setValue(this.localVelocityUMax.data);
      this.constantVelocityDivMult.setValue(this.velocityUMax.data);
      this.constantRotSpeedDivMult.setValue(this.rotSpeedUMax[0]);
      var texIN = this.swapTex ? this.particleTexOUT : this.particleTexIN;
      var texOUT = this.swapTex ? this.particleTexIN : this.particleTexOUT;
      this.constantParticleTexIN.setValue(texIN);
      if(!isOnStop) {
        pc.drawQuadWithShader(device, this.swapTex ? this.rtParticleTexIN : this.rtParticleTexOUT, this.loop ? this.shaderParticleUpdateRespawn : this.shaderParticleUpdateNoRespawn)
      }else {
        pc.drawQuadWithShader(device, this.swapTex ? this.rtParticleTexIN : this.rtParticleTexOUT, this.shaderParticleUpdateOnStop)
      }
      this.constantParticleTexOUT.setValue(texOUT);
      this.material.setParameter("particleTexOUT", texOUT);
      this.material.setParameter("particleTexIN", texIN);
      this.swapTex = !this.swapTex
    }else {
      var data = new Float32Array(this.vertexBuffer.lock());
      if(this.meshInstance.node) {
        var fullMat = this.meshInstance.node.worldTransform;
        for(j = 0;j < 12;j++) {
          rotMat.data[j] = fullMat.data[j]
        }
        nonUniformScale = this.meshInstance.node.getLocalScale();
        uniformScale = Math.max(Math.max(nonUniformScale.x, nonUniformScale.y), nonUniformScale.z)
      }
      var emitterPos = this.meshInstance.node === null ? pc.Vec3.ZERO : this.meshInstance.node.getPosition();
      var posCam = this.camera ? this.camera._node.getPosition() : pc.Vec3.ZERO;
      var vertSize = 14;
      for(i = 0;i < this.numParticles;i++) {
        var id = Math.floor(this.vbCPU[i * this.numParticleVerts * 4 + 3]);
        var rndFactor = this.particleTex[i * 4 + 0 + this.numParticlesPot * 2 * 4];
        rndFactor3Vec.x = rndFactor;
        rndFactor3Vec.y = this.particleTex[i * 4 + 1 + this.numParticlesPot * 2 * 4];
        rndFactor3Vec.z = this.particleTex[i * 4 + 2 + this.numParticlesPot * 2 * 4];
        var particleRate = pc.math.lerp(this.rate, this.rate2, rndFactor);
        var particleLifetime = this.lifetime;
        var startSpawnTime = -particleRate * id;
        var life = this.particleTex[id * 4 + 3 + this.numParticlesPot * 4] + delta;
        var nlife = saturate(life / particleLifetime);
        var scale = 0;
        var alphaDiv = 0;
        var angle = 0;
        var len;
        var interpolation;
        var particleEnabled = life > 0 && life < particleLifetime;
        if(particleEnabled) {
          localVelocityVec.data = tex1D(this.qLocalVelocity, nlife, 3, localVelocityVec.data);
          localVelocityVec2.data = tex1D(this.qLocalVelocity2, nlife, 3, localVelocityVec2.data);
          velocityVec.data = tex1D(this.qVelocity, nlife, 3, velocityVec.data);
          velocityVec2.data = tex1D(this.qVelocity2, nlife, 3, velocityVec2.data);
          var rotSpeed = tex1D(this.qRotSpeed, nlife);
          var rotSpeed2 = tex1D(this.qRotSpeed2, nlife);
          scale = tex1D(this.qScale, nlife);
          var scale2 = tex1D(this.qScale2, nlife);
          var alpha = tex1D(this.qAlpha, nlife);
          var alpha2 = tex1D(this.qAlpha2, nlife);
          localVelocityVec.x = pc.math.lerp(localVelocityVec.x, localVelocityVec2.x, rndFactor3Vec.x);
          localVelocityVec.y = pc.math.lerp(localVelocityVec.y, localVelocityVec2.y, rndFactor3Vec.y);
          localVelocityVec.z = pc.math.lerp(localVelocityVec.z, localVelocityVec2.z, rndFactor3Vec.z);
          if(this.initialVelocity > 0) {
            if(this.emitterShape === pc.EMITTERSHAPE_SPHERE) {
              randomPos.copy(rndFactor3Vec).scale(2).sub(pc.Vec3.ONE).normalize();
              localVelocityVec.add(randomPos.scale(this.initialVelocity))
            }else {
              localVelocityVec.add(pc.Vec3.FORWARD.scale(this.initialVelocity))
            }
          }
          velocityVec.x = pc.math.lerp(velocityVec.x, velocityVec2.x, rndFactor3Vec.x);
          velocityVec.y = pc.math.lerp(velocityVec.y, velocityVec2.y, rndFactor3Vec.y);
          velocityVec.z = pc.math.lerp(velocityVec.z, velocityVec2.z, rndFactor3Vec.z);
          rotSpeed = pc.math.lerp(rotSpeed, rotSpeed2, rndFactor3Vec.y);
          scale = pc.math.lerp(scale, scale2, rndFactor * 1E4 % 1) * uniformScale;
          alphaDiv = (alpha2 - alpha) * (rndFactor * 1E3 % 1);
          if(this.meshInstance.node) {
            rotMat.transformPoint(localVelocityVec, localVelocityVec)
          }
          localVelocityVec.add(velocityVec.mul(nonUniformScale));
          moveDirVec.copy(localVelocityVec);
          particlePosPrev.x = this.particleTex[id * 4];
          particlePosPrev.y = this.particleTex[id * 4 + 1];
          particlePosPrev.z = this.particleTex[id * 4 + 2];
          particlePos.copy(particlePosPrev).add(localVelocityVec.scale(delta));
          particleFinalPos.copy(particlePos);
          this.particleTex[id * 4] = particleFinalPos.x;
          this.particleTex[id * 4 + 1] = particleFinalPos.y;
          this.particleTex[id * 4 + 2] = particleFinalPos.z;
          this.particleTex[id * 4 + 3] += rotSpeed * delta;
          if(this.wrap && this.wrapBounds) {
            particleFinalPos.sub(emitterPos);
            particleFinalPos.x = glMod(particleFinalPos.x, this.wrapBounds.x) - this.wrapBounds.x * 0.5;
            particleFinalPos.y = glMod(particleFinalPos.y, this.wrapBounds.y) - this.wrapBounds.y * 0.5;
            particleFinalPos.z = glMod(particleFinalPos.z, this.wrapBounds.z) - this.wrapBounds.z * 0.5;
            particleFinalPos.add(emitterPos)
          }
          if(this.sort > 0) {
            if(this.sort === 1) {
              tmpVec3.copy(particleFinalPos).sub(posCam);
              this.particleDistance[id] = -(tmpVec3.x * tmpVec3.x + tmpVec3.y * tmpVec3.y + tmpVec3.z * tmpVec3.z)
            }else {
              if(this.sort === 2) {
                this.particleDistance[id] = life
              }else {
                if(this.sort === 3) {
                  this.particleDistance[id] = -life
                }
              }
            }
          }
        }else {
          this.calcSpawnPosition(emitterPos, id)
        }
        if(life > particleLifetime && this.loop) {
          life = -particleRate * id
        }
        if(life <= 0 && isOnStop) {
          life = particleLifetime + 1
        }
        this.particleTex[id * 4 + 3 + this.numParticlesPot * 4] = life;
        for(var v = 0;v < this.numParticleVerts;v++) {
          var quadX = this.vbCPU[i * this.numParticleVerts * 4 + v * 4];
          var quadY = this.vbCPU[i * this.numParticleVerts * 4 + v * 4 + 1];
          var quadZ = this.vbCPU[i * this.numParticleVerts * 4 + v * 4 + 2];
          if(!particleEnabled) {
            quadX = quadY = quadZ = 0
          }
          var w = i * this.numParticleVerts * vertSize + v * vertSize;
          data[w] = particleFinalPos.x;
          data[w + 1] = particleFinalPos.y;
          data[w + 2] = particleFinalPos.z;
          data[w + 3] = nlife;
          data[w + 4] = this.alignToMotion ? angle : this.particleTex[id * 4 + 3];
          data[w + 5] = scale;
          data[w + 6] = alphaDiv;
          data[w + 7] = moveDirVec.x;
          data[w + 8] = quadX;
          data[w + 9] = quadY;
          data[w + 10] = quadZ;
          data[w + 11] = moveDirVec.y;
          data[w + 12] = moveDirVec.z
        }
      }
      if(this.sort > pc.PARTICLESORT_NONE && this.camera) {
        for(i = 0;i < this.numParticles;i++) {
          this.vbToSort[i] = [i, Math.floor(this.vbCPU[i * this.numParticleVerts * 4 + 3])]
        }
        for(i = 0;i < this.vbCPU.length;i++) {
          this.vbOld[i] = this.vbCPU[i]
        }
        var particleDistance = this.particleDistance;
        this.vbToSort.sort(function(a, b) {
          return particleDistance[a[1]] - particleDistance[b[1]]
        });
        for(i = 0;i < this.numParticles;i++) {
          var start = this.vbToSort[i][0];
          for(var corner = 0;corner < this.numParticleVerts;corner++) {
            for(j = 0;j < 4;j++) {
              this.vbCPU[i * this.numParticleVerts * 4 + corner * 4 + j] = this.vbOld[start * this.numParticleVerts * 4 + corner * 4 + j]
            }
          }
        }
      }
      this.vertexBuffer.unlock()
    }
    if(!this.loop) {
      if(this.onFinished) {
        if(Date.now() > this.endTime) {
          this.onFinished()
        }
      }
    }
    device.setDepthTest(true);
    device.setDepthWrite(true)
  }};
  return{ParticleEmitter:ParticleEmitter}
}());
pc.extend(pc, function() {
  var Picker = function(device, width, height) {
    this.device = device;
    var library = device.getProgramLibrary();
    this.pickProgStatic = library.getProgram("pick", {skin:false});
    this.pickProgSkin = library.getProgram("pick", {skin:true});
    this.pickColor = new Float32Array(4);
    this.scene = null;
    this.clearOptions = {color:[1, 1, 1, 1], depth:1, flags:pc.CLEARFLAG_COLOR | pc.CLEARFLAG_DEPTH};
    this.resize(width, height)
  };
  Picker.prototype.getSelection = function(rect) {
    var device = this.device;
    rect.width = rect.width || 1;
    rect.height = rect.height || 1;
    var prevRenderTarget = device.getRenderTarget();
    device.setRenderTarget(this._pickBufferTarget);
    device.updateBegin();
    var pixels = new Uint8Array(4 * rect.width * rect.height);
    device.readPixels(rect.x, rect.y, rect.width, rect.height, pixels);
    device.updateEnd();
    device.setRenderTarget(prevRenderTarget);
    var selection = [];
    for(var i = 0;i < rect.width * rect.height;i++) {
      var r = pixels[4 * i + 0];
      var g = pixels[4 * i + 1];
      var b = pixels[4 * i + 2];
      var index = r << 16 | g << 8 | b;
      if(index !== 16777215) {
        var selectedMeshInstance = this.scene.drawCalls[index];
        if(selection.indexOf(selectedMeshInstance) === -1) {
          selection.push(selectedMeshInstance)
        }
      }
    }
    return selection
  };
  Picker.prototype.prepare = function(camera, scene) {
    var device = this.device;
    this.scene = scene;
    var prevRenderTarget = device.getRenderTarget();
    device.setRenderTarget(this._pickBufferTarget);
    device.updateBegin();
    device.setViewport(0, 0, this._pickBufferTarget.width, this._pickBufferTarget.height);
    device.setScissor(0, 0, this._pickBufferTarget.width, this._pickBufferTarget.height);
    device.clear(this.clearOptions);
    var i;
    var mesh, meshInstance, material;
    var type;
    var drawCalls = scene.drawCalls;
    var numDrawCalls = drawCalls.length;
    var device = this.device;
    var scope = device.scope;
    var modelMatrixId = scope.resolve("matrix_model");
    var boneTextureId = scope.resolve("texture_poseMap");
    var boneTextureSizeId = scope.resolve("texture_poseMapSize");
    var poseMatrixId = scope.resolve("matrix_pose[0]");
    var pickColorId = scope.resolve("uColor");
    var projId = scope.resolve("matrix_projection");
    var viewProjId = scope.resolve("matrix_viewProjection");
    var wtm = camera._node.getWorldTransform();
    var projMat = camera.getProjectionMatrix();
    var viewMat = wtm.clone().invert();
    var viewProjMat = new pc.Mat4;
    viewProjMat.mul2(projMat, viewMat);
    projId.setValue(projMat.data);
    viewProjId.setValue(viewProjMat.data);
    for(i = 0;i < numDrawCalls;i++) {
      if(!drawCalls[i].command) {
        meshInstance = drawCalls[i];
        mesh = meshInstance.mesh;
        material = meshInstance.material;
        type = mesh.primitive[pc.RENDERSTYLE_SOLID].type;
        var isSolid = type === pc.PRIMITIVE_TRIANGLES || type === pc.PRIMITIVE_TRISTRIP || type === pc.PRIMITIVE_TRIFAN;
        var isPickable = material instanceof pc.PhongMaterial || material instanceof pc.BasicMaterial;
        if(isSolid && isPickable) {
          device.setBlending(false);
          device.setCullMode(material.cull);
          device.setDepthWrite(material.depthWrite);
          device.setDepthTest(material.depthTest);
          modelMatrixId.setValue(meshInstance.node.worldTransform.data);
          if(meshInstance.skinInstance) {
            if(device.supportsBoneTextures) {
              boneTextureId.setValue(meshInstance.skinInstance.boneTexture);
              var w = meshInstance.skinInstance.boneTexture.width;
              var h = meshInstance.skinInstance.boneTexture.height;
              boneTextureSizeId.setValue([w, h])
            }else {
              poseMatrixId.setValue(meshInstance.skinInstance.matrixPalette)
            }
          }
          this.pickColor[0] = (i >> 16 & 255) / 255;
          this.pickColor[1] = (i >> 8 & 255) / 255;
          this.pickColor[2] = (i & 255) / 255;
          this.pickColor[3] = 1;
          pickColorId.setValue(this.pickColor);
          device.setShader(mesh.skin ? this.pickProgSkin : this.pickProgStatic);
          device.setVertexBuffer(mesh.vertexBuffer, 0);
          device.setIndexBuffer(mesh.indexBuffer[pc.RENDERSTYLE_SOLID]);
          device.draw(mesh.primitive[pc.RENDERSTYLE_SOLID])
        }
      }
    }
    device.setViewport(0, 0, device.width, device.height);
    device.setScissor(0, 0, device.width, device.height);
    device.updateEnd();
    device.setRenderTarget(prevRenderTarget)
  };
  Picker.prototype.resize = function(width, height) {
    var colorBuffer = new pc.Texture(this.device, {format:pc.PIXELFORMAT_R8_G8_B8_A8, width:width, height:height, autoMipmap:false});
    colorBuffer.minFilter = pc.FILTER_NEAREST;
    colorBuffer.magFilter = pc.FILTER_NEAREST;
    colorBuffer.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    colorBuffer.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    this._pickBufferTarget = new pc.RenderTarget(this.device, colorBuffer, {depth:true})
  };
  Object.defineProperty(Picker.prototype, "renderTarget", {get:function() {
    return this._pickBufferTarget
  }});
  Object.defineProperty(Picker.prototype, "width", {get:function() {
    return this._pickBufferTarget.width
  }});
  Object.defineProperty(Picker.prototype, "height", {get:function() {
    return this._pickBufferTarget.height
  }});
  return{Picker:Picker}
}());
pc.calculateTangents = function(vertices, normals, uvs, indices) {
  var triangleCount = indices.length / 3;
  var vertexCount = vertices.length / 3;
  var i1, i2, i3;
  var x1, x2, y1, y2, z1, z2, s1, s2, t1, t2, r;
  var sdir = new pc.Vec3;
  var tdir = new pc.Vec3;
  var v1 = new pc.Vec3;
  var v2 = new pc.Vec3;
  var v3 = new pc.Vec3;
  var w1 = new pc.Vec2;
  var w2 = new pc.Vec2;
  var w3 = new pc.Vec2;
  var i;
  var tan1 = new Float32Array(vertexCount * 3);
  var tan2 = new Float32Array(vertexCount * 3);
  var tangents = [];
  for(i = 0;i < triangleCount;i++) {
    i1 = indices[i * 3];
    i2 = indices[i * 3 + 1];
    i3 = indices[i * 3 + 2];
    v1.set(vertices[i1 * 3], vertices[i1 * 3 + 1], vertices[i1 * 3 + 2]);
    v2.set(vertices[i2 * 3], vertices[i2 * 3 + 1], vertices[i2 * 3 + 2]);
    v3.set(vertices[i3 * 3], vertices[i3 * 3 + 1], vertices[i3 * 3 + 2]);
    w1.set(uvs[i1 * 2], uvs[i1 * 2 + 1]);
    w2.set(uvs[i2 * 2], uvs[i2 * 2 + 1]);
    w3.set(uvs[i3 * 2], uvs[i3 * 2 + 1]);
    x1 = v2.x - v1.x;
    x2 = v3.x - v1.x;
    y1 = v2.y - v1.y;
    y2 = v3.y - v1.y;
    z1 = v2.z - v1.z;
    z2 = v3.z - v1.z;
    s1 = w2.x - w1.x;
    s2 = w3.x - w1.x;
    t1 = w2.y - w1.y;
    t2 = w3.y - w1.y;
    r = 1 / (s1 * t2 - s2 * t1);
    sdir.set((t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r);
    tdir.set((s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r);
    tan1[i1 * 3 + 0] += sdir.x;
    tan1[i1 * 3 + 1] += sdir.y;
    tan1[i1 * 3 + 2] += sdir.z;
    tan1[i2 * 3 + 0] += sdir.x;
    tan1[i2 * 3 + 1] += sdir.y;
    tan1[i2 * 3 + 2] += sdir.z;
    tan1[i3 * 3 + 0] += sdir.x;
    tan1[i3 * 3 + 1] += sdir.y;
    tan1[i3 * 3 + 2] += sdir.z;
    tan2[i1 * 3 + 0] += tdir.x;
    tan2[i1 * 3 + 1] += tdir.y;
    tan2[i1 * 3 + 2] += tdir.z;
    tan2[i2 * 3 + 0] += tdir.x;
    tan2[i2 * 3 + 1] += tdir.y;
    tan2[i2 * 3 + 2] += tdir.z;
    tan2[i3 * 3 + 0] += tdir.x;
    tan2[i3 * 3 + 1] += tdir.y;
    tan2[i3 * 3 + 2] += tdir.z
  }
  t1 = new pc.Vec3;
  t2 = new pc.Vec3;
  var n = new pc.Vec3;
  var temp = new pc.Vec3;
  for(i = 0;i < vertexCount;i++) {
    n.set(normals[i * 3], normals[i * 3 + 1], normals[i * 3 + 2]);
    t1.set(tan1[i * 3], tan1[i * 3 + 1], tan1[i * 3 + 2]);
    t2.set(tan2[i * 3], tan2[i * 3 + 1], tan2[i * 3 + 2]);
    var ndott = n.dot(t1);
    temp.copy(n).scale(ndott);
    temp.sub2(t1, temp).normalize();
    tangents[i * 4] = temp.x;
    tangents[i * 4 + 1] = temp.y;
    tangents[i * 4 + 2] = temp.z;
    temp.cross(n, t1);
    tangents[i * 4 + 3] = temp.dot(t2) < 0 ? -1 : 1
  }
  return tangents
};
pc.createMesh = function(device, positions, opts) {
  var normals = opts && opts.normals !== undefined ? opts.normals : null;
  var tangents = opts && opts.tangents !== undefined ? opts.tangents : null;
  var uvs = opts && opts.uvs !== undefined ? opts.uvs : null;
  var indices = opts && opts.indices !== undefined ? opts.indices : null;
  var vertexDesc = [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}];
  if(normals !== null) {
    vertexDesc.push({semantic:pc.SEMANTIC_NORMAL, components:3, type:pc.ELEMENTTYPE_FLOAT32})
  }
  if(tangents !== null) {
    vertexDesc.push({semantic:pc.SEMANTIC_TANGENT, components:4, type:pc.ELEMENTTYPE_FLOAT32})
  }
  if(uvs !== null) {
    vertexDesc.push({semantic:pc.SEMANTIC_TEXCOORD0, components:2, type:pc.ELEMENTTYPE_FLOAT32})
  }
  var vertexFormat = new pc.VertexFormat(device, vertexDesc);
  var numVertices = positions.length / 3;
  var vertexBuffer = new pc.VertexBuffer(device, vertexFormat, numVertices);
  var iterator = new pc.VertexIterator(vertexBuffer);
  for(var i = 0;i < numVertices;i++) {
    iterator.element[pc.SEMANTIC_POSITION].set(positions[i * 3], positions[i * 3 + 1], positions[i * 3 + 2]);
    if(normals !== null) {
      iterator.element[pc.SEMANTIC_NORMAL].set(normals[i * 3], normals[i * 3 + 1], normals[i * 3 + 2])
    }
    if(tangents !== null) {
      iterator.element[pc.SEMANTIC_TANGENT].set(tangents[i * 4], tangents[i * 4 + 1], tangents[i * 4 + 2], tangents[i * 4 + 3])
    }
    if(uvs !== null) {
      iterator.element[pc.SEMANTIC_TEXCOORD0].set(uvs[i * 2], uvs[i * 2 + 1])
    }
    iterator.next()
  }
  iterator.end();
  var indexBuffer = null;
  var indexed = indices !== null;
  if(indexed) {
    indexBuffer = new pc.IndexBuffer(device, pc.INDEXFORMAT_UINT16, indices.length);
    var dst = new Uint16Array(indexBuffer.lock());
    dst.set(indices);
    indexBuffer.unlock()
  }
  var aabb = new pc.shape.Aabb;
  aabb.compute(positions);
  var mesh = new pc.Mesh;
  mesh.vertexBuffer = vertexBuffer;
  mesh.indexBuffer[0] = indexBuffer;
  mesh.primitive[0].type = pc.PRIMITIVE_TRIANGLES;
  mesh.primitive[0].base = 0;
  mesh.primitive[0].count = indexed ? indices.length : numVertices;
  mesh.primitive[0].indexed = indexed;
  mesh.aabb = aabb;
  return mesh
};
pc.createTorus = function(device, opts) {
  var rc = opts && opts.tubeRadius !== undefined ? opts.tubeRadius : 0.2;
  var rt = opts && opts.ringRadius !== undefined ? opts.ringRadius : 0.3;
  var segments = opts && opts.segments !== undefined ? opts.segments : 30;
  var sides = opts && opts.sides !== undefined ? opts.sides : 20;
  var i, j;
  var x, y, z, nx, ny, nz, u, v;
  var positions = [];
  var normals = [];
  var uvs = [];
  var indices = [];
  for(i = 0;i <= sides;i++) {
    for(j = 0;j <= segments;j++) {
      x = Math.cos(2 * Math.PI * j / segments) * (rt + rc * Math.cos(2 * Math.PI * i / sides));
      y = Math.sin(2 * Math.PI * i / sides) * rc;
      z = Math.sin(2 * Math.PI * j / segments) * (rt + rc * Math.cos(2 * Math.PI * i / sides));
      nx = Math.cos(2 * Math.PI * j / segments) * Math.cos(2 * Math.PI * i / sides);
      ny = Math.sin(2 * Math.PI * i / sides);
      nz = Math.sin(2 * Math.PI * j / segments) * Math.cos(2 * Math.PI * i / sides);
      u = i / sides;
      v = 1 - j / segments;
      positions.push(x, y, z);
      normals.push(nx, ny, nz);
      uvs.push(u, v);
      if(i < sides && j < segments) {
        var first, second, third, fourth;
        first = i * (segments + 1) + j;
        second = (i + 1) * (segments + 1) + j;
        third = i * (segments + 1) + (j + 1);
        fourth = (i + 1) * (segments + 1) + (j + 1);
        indices.push(first, second, third);
        indices.push(second, fourth, third)
      }
    }
  }
  var options = {normals:normals, uvs:uvs, indices:indices};
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(positions, normals, uvs, indices)
  }
  return pc.createMesh(device, positions, options)
};
pc._createConeData = function(baseRadius, peakRadius, height, heightSegments, capSegments, roundedCaps) {
  var i, j;
  var x, y, z, u, v;
  var pos = new pc.Vec3;
  var bottomToTop = new pc.Vec3;
  var norm = new pc.Vec3;
  var top, bottom, tangent;
  var positions = [];
  var normals = [];
  var uvs = [];
  var indices = [];
  var cosTheta, sinTheta;
  var sinPhi, cosPhi;
  var first, second, third, fourth;
  var offset;
  if(height > 0) {
    for(i = 0;i <= heightSegments;i++) {
      for(j = 0;j <= capSegments;j++) {
        theta = j / capSegments * 2 * Math.PI - Math.PI;
        sinTheta = Math.sin(theta);
        cosTheta = Math.cos(theta);
        bottom = new pc.Vec3(sinTheta * baseRadius, -height / 2, cosTheta * baseRadius);
        top = new pc.Vec3(sinTheta * peakRadius, height / 2, cosTheta * peakRadius);
        pos.lerp(bottom, top, i / heightSegments);
        bottomToTop.sub2(top, bottom).normalize();
        tangent = new pc.Vec3(cosTheta, 0, -sinTheta);
        norm.cross(tangent, bottomToTop).normalize();
        positions.push(pos.x, pos.y, pos.z);
        normals.push(norm.x, norm.y, norm.z);
        uvs.push(j / capSegments, i / heightSegments);
        if(i < heightSegments && j < capSegments) {
          first = i * (capSegments + 1) + j;
          second = i * (capSegments + 1) + (j + 1);
          third = (i + 1) * (capSegments + 1) + j;
          fourth = (i + 1) * (capSegments + 1) + (j + 1);
          indices.push(first, second, third);
          indices.push(second, fourth, third)
        }
      }
    }
  }
  if(roundedCaps) {
    var lat, lon;
    var latitudeBands = Math.floor(capSegments / 2);
    var longitudeBands = capSegments;
    var capOffset = height / 2;
    for(lat = 0;lat <= latitudeBands;lat++) {
      theta = lat * Math.PI * 0.5 / latitudeBands;
      sinTheta = Math.sin(theta);
      cosTheta = Math.cos(theta);
      for(lon = 0;lon <= longitudeBands;lon++) {
        phi = lon * 2 * Math.PI / longitudeBands - Math.PI / 2;
        sinPhi = Math.sin(phi);
        cosPhi = Math.cos(phi);
        x = cosPhi * sinTheta;
        y = cosTheta;
        z = sinPhi * sinTheta;
        u = 1 - lon / longitudeBands;
        v = 1 - lat / latitudeBands;
        positions.push(x * peakRadius, y * peakRadius + capOffset, z * peakRadius);
        normals.push(x, y, z);
        uvs.push(u, v)
      }
    }
    offset = (heightSegments + 1) * (capSegments + 1);
    for(lat = 0;lat < latitudeBands;++lat) {
      for(lon = 0;lon < longitudeBands;++lon) {
        first = lat * (longitudeBands + 1) + lon;
        second = first + longitudeBands + 1;
        indices.push(offset + first + 1, offset + second, offset + first);
        indices.push(offset + first + 1, offset + second + 1, offset + second)
      }
    }
    for(lat = 0;lat <= latitudeBands;lat++) {
      theta = Math.PI * 0.5 + lat * Math.PI * 0.5 / latitudeBands;
      sinTheta = Math.sin(theta);
      cosTheta = Math.cos(theta);
      for(lon = 0;lon <= longitudeBands;lon++) {
        phi = lon * 2 * Math.PI / longitudeBands - Math.PI / 2;
        sinPhi = Math.sin(phi);
        cosPhi = Math.cos(phi);
        x = cosPhi * sinTheta;
        y = cosTheta;
        z = sinPhi * sinTheta;
        u = 1 - lon / longitudeBands;
        v = 1 - lat / latitudeBands;
        positions.push(x * peakRadius, y * peakRadius - capOffset, z * peakRadius);
        normals.push(x, y, z);
        uvs.push(u, v)
      }
    }
    offset = (heightSegments + 1) * (capSegments + 1) + (longitudeBands + 1) * (latitudeBands + 1);
    for(lat = 0;lat < latitudeBands;++lat) {
      for(lon = 0;lon < longitudeBands;++lon) {
        first = lat * (longitudeBands + 1) + lon;
        second = first + longitudeBands + 1;
        indices.push(offset + first + 1, offset + second, offset + first);
        indices.push(offset + first + 1, offset + second + 1, offset + second)
      }
    }
  }else {
    offset = (heightSegments + 1) * (capSegments + 1);
    if(baseRadius > 0) {
      for(i = 0;i < capSegments;i++) {
        theta = i / capSegments * 2 * Math.PI;
        x = Math.sin(theta);
        y = -height / 2;
        z = Math.cos(theta);
        u = 1 - (x + 1) / 2;
        v = (z + 1) / 2;
        positions.push(x * baseRadius, y, z * baseRadius);
        normals.push(0, -1, 0);
        uvs.push(u, v);
        if(i > 1) {
          indices.push(offset, offset + i, offset + i - 1)
        }
      }
    }
    offset += capSegments;
    if(peakRadius > 0) {
      for(i = 0;i < capSegments;i++) {
        theta = i / capSegments * 2 * Math.PI;
        x = Math.sin(theta);
        y = height / 2;
        z = Math.cos(theta);
        u = 1 - (x + 1) / 2;
        v = (z + 1) / 2;
        positions.push(x * peakRadius, y, z * peakRadius);
        normals.push(0, 1, 0);
        uvs.push(u, v);
        if(i > 1) {
          indices.push(offset, offset + i - 1, offset + i)
        }
      }
    }
  }
  return{positions:positions, normals:normals, uvs:uvs, indices:indices}
};
pc.createCylinder = function(device, opts) {
  var baseRadius = opts && opts.baseRadius !== undefined ? opts.baseRadius : 0.5;
  var height = opts && opts.height !== undefined ? opts.height : 1;
  var heightSegments = opts && opts.heightSegments !== undefined ? opts.heightSegments : 5;
  var capSegments = opts && opts.capSegments !== undefined ? opts.capSegments : 20;
  var options = pc._createConeData(baseRadius, baseRadius, height, heightSegments, capSegments, false);
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(options.positions, options.normals, options.uvs, options.indices)
  }
  return pc.createMesh(device, options.positions, options)
};
pc.createCapsule = function(device, opts) {
  var radius = opts && opts.radius !== undefined ? opts.radius : 0.3;
  var height = opts && opts.height !== undefined ? opts.height : 1;
  var heightSegments = opts && opts.heightSegments !== undefined ? opts.heightSegments : 1;
  var sides = opts && opts.sides !== undefined ? opts.sides : 20;
  var options = pc._createConeData(radius, radius, height - 2 * radius, heightSegments, sides, true);
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(options.positions, options.normals, options.uvs, options.indices)
  }
  return pc.createMesh(device, options.positions, options)
};
pc.createCone = function(device, opts) {
  var baseRadius = opts && opts.baseRadius !== undefined ? opts.baseRadius : 0.5;
  var peakRadius = opts && opts.peakRadius !== undefined ? opts.peakRadius : 0;
  var height = opts && opts.height !== undefined ? opts.height : 1;
  var heightSegments = opts && opts.heightSegments !== undefined ? opts.heightSegments : 5;
  var capSegments = opts && opts.capSegments !== undefined ? opts.capSegments : 18;
  var options = pc._createConeData(baseRadius, peakRadius, height, heightSegments, capSegments, false);
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(options.positions, options.normals, options.uvs, options.indices)
  }
  return pc.createMesh(device, options.positions, options)
};
pc.createSphere = function(device, opts) {
  var radius = opts && opts.radius !== undefined ? opts.radius : 0.5;
  var latitudeBands = opts && opts.latitudeBands !== undefined ? opts.latitudeBands : 16;
  var longitudeBands = opts && opts.longitudeBands !== undefined ? opts.longitudeBands : 16;
  var lon, lat;
  var theta, sinTheta, cosTheta, phi, sinPhi, cosPhi;
  var first, second;
  var x, y, z, u, v;
  var positions = [];
  var normals = [];
  var uvs = [];
  var indices = [];
  for(lat = 0;lat <= latitudeBands;lat++) {
    theta = lat * Math.PI / latitudeBands;
    sinTheta = Math.sin(theta);
    cosTheta = Math.cos(theta);
    for(lon = 0;lon <= longitudeBands;lon++) {
      phi = lon * 2 * Math.PI / longitudeBands - Math.PI / 2;
      sinPhi = Math.sin(phi);
      cosPhi = Math.cos(phi);
      x = cosPhi * sinTheta;
      y = cosTheta;
      z = sinPhi * sinTheta;
      u = 1 - lon / longitudeBands;
      v = 1 - lat / latitudeBands;
      positions.push(x * radius, y * radius, z * radius);
      normals.push(x, y, z);
      uvs.push(u, v)
    }
  }
  for(lat = 0;lat < latitudeBands;++lat) {
    for(lon = 0;lon < longitudeBands;++lon) {
      first = lat * (longitudeBands + 1) + lon;
      second = first + longitudeBands + 1;
      indices.push(first + 1, second, first);
      indices.push(first + 1, second + 1, second)
    }
  }
  var options = {normals:normals, uvs:uvs, indices:indices};
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(positions, normals, uvs, indices)
  }
  return pc.createMesh(device, positions, options)
};
pc.createPlane = function(device, opts) {
  var he = opts && opts.halfExtents !== undefined ? opts.halfExtents : new pc.Vec2(0.5, 0.5);
  var ws = opts && opts.widthSegments !== undefined ? opts.widthSegments : 5;
  var ls = opts && opts.lengthSegments !== undefined ? opts.lengthSegments : 5;
  var i, j;
  var x, y, z, u, v;
  var positions = [];
  var normals = [];
  var uvs = [];
  var indices = [];
  for(i = 0;i <= ws;i++) {
    for(j = 0;j <= ls;j++) {
      x = -he.x + 2 * he.x * i / ws;
      y = 0;
      z = -(-he.y + 2 * he.y * j / ls);
      u = i / ws;
      v = j / ls;
      positions.push(x, y, z);
      normals.push(0, 1, 0);
      uvs.push(u, v);
      if(i < ws && j < ls) {
        indices.push(j + i * (ws + 1), j + (i + 1) * (ws + 1), j + i * (ws + 1) + 1);
        indices.push(j + (i + 1) * (ws + 1), j + (i + 1) * (ws + 1) + 1, j + i * (ws + 1) + 1)
      }
    }
  }
  var options = {normals:normals, uvs:uvs, indices:indices};
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(positions, normals, uvs, indices)
  }
  return pc.createMesh(device, positions, options)
};
pc.createBox = function(device, opts) {
  var he = opts && opts.halfExtents !== undefined ? opts.halfExtents : new pc.Vec3(0.5, 0.5, 0.5);
  var ws = opts && opts.widthSegments !== undefined ? opts.widthSegments : 1;
  var ls = opts && opts.lengthSegments !== undefined ? opts.lengthSegments : 1;
  var hs = opts && opts.heightSegments !== undefined ? opts.heightSegments : 1;
  var corners = [new pc.Vec3(-he.x, -he.y, he.z), new pc.Vec3(he.x, -he.y, he.z), new pc.Vec3(he.x, he.y, he.z), new pc.Vec3(-he.x, he.y, he.z), new pc.Vec3(he.x, -he.y, -he.z), new pc.Vec3(-he.x, -he.y, -he.z), new pc.Vec3(-he.x, he.y, -he.z), new pc.Vec3(he.x, he.y, -he.z)];
  var faceAxes = [[0, 1, 3], [4, 5, 7], [3, 2, 6], [1, 0, 4], [1, 4, 2], [5, 0, 6]];
  var faceNormals = [[0, 0, 1], [0, 0, -1], [0, 1, 0], [0, -1, 0], [1, 0, 0], [-1, 0, 0]];
  var sides = {FRONT:0, BACK:1, TOP:2, BOTTOM:3, RIGHT:4, LEFT:5};
  var side, i, j;
  var positions = [];
  var normals = [];
  var uvs = [];
  var indices = [];
  var generateFace = function(side, uSegments, vSegments) {
    var x, y, z, u, v;
    var i, j;
    var offset = positions.length / 3;
    for(i = 0;i <= uSegments;i++) {
      for(j = 0;j <= vSegments;j++) {
        var temp1 = new pc.Vec3;
        var temp2 = new pc.Vec3;
        var temp3 = new pc.Vec3;
        var r = new pc.Vec3;
        temp1.lerp(corners[faceAxes[side][0]], corners[faceAxes[side][1]], i / uSegments);
        temp2.lerp(corners[faceAxes[side][0]], corners[faceAxes[side][2]], j / vSegments);
        temp3.sub2(temp2, corners[faceAxes[side][0]]);
        r.add2(temp1, temp3);
        u = i / uSegments;
        v = j / vSegments;
        positions.push(r.x, r.y, r.z);
        normals.push(faceNormals[side][0], faceNormals[side][1], faceNormals[side][2]);
        uvs.push(u, v);
        if(i < uSegments && j < vSegments) {
          indices.push(offset + j + i * (uSegments + 1), offset + j + (i + 1) * (uSegments + 1), offset + j + i * (uSegments + 1) + 1);
          indices.push(offset + j + (i + 1) * (uSegments + 1), offset + j + (i + 1) * (uSegments + 1) + 1, offset + j + i * (uSegments + 1) + 1)
        }
      }
    }
  };
  generateFace(sides.FRONT, ws, hs);
  generateFace(sides.BACK, ws, hs);
  generateFace(sides.TOP, ws, ls);
  generateFace(sides.BOTTOM, ws, ls);
  generateFace(sides.RIGHT, ls, hs);
  generateFace(sides.LEFT, ls, hs);
  var options = {normals:normals, uvs:uvs, indices:indices};
  if(pc.precalculatedTangents) {
    options.tangents = pc.calculateTangents(positions, normals, uvs, indices)
  }
  return pc.createMesh(device, positions, options)
};
pc.extend(pc, function() {
  var Key = function Key(time, position, rotation, scale) {
    this.time = time;
    this.position = position;
    this.rotation = rotation;
    this.scale = scale
  };
  var Node = function Node() {
    this._name = "";
    this._keys = []
  };
  var Animation = function Animation() {
    this._name = "";
    this._duration = 0;
    this._nodes = [];
    this._nodeDict = {}
  };
  Animation.prototype.getDuration = function() {
    return this._duration
  };
  Animation.prototype.getName = function() {
    return this._name
  };
  Animation.prototype.getNode = function(name) {
    return this._nodeDict[name]
  };
  Animation.prototype.getNodes = function() {
    return this._nodes
  };
  Animation.prototype.setDuration = function(duration) {
    this._duration = duration
  };
  Animation.prototype.setName = function(name) {
    this._name = name
  };
  Animation.prototype.addNode = function(node) {
    this._nodes.push(node);
    this._nodeDict[node._name] = node
  };
  return{Animation:Animation, Key:Key, Node:Node}
}());
pc.extend(pc, function() {
  function InterpolatedKey() {
    this._written = false;
    this._name = "";
    this._keyFrames = [];
    this._quat = new pc.Quat;
    this._pos = new pc.Vec3;
    this._scale = new pc.Vec3;
    this._targetNode = null
  }
  InterpolatedKey.prototype = {getTarget:function() {
    return this._targetNode
  }, setTarget:function(node) {
    this._targetNode = node
  }};
  var Skeleton = function Skeleton(graph) {
    this._animation = null;
    this._time = 0;
    this.looping = true;
    this._interpolatedKeys = [];
    this._interpolatedKeyDict = {};
    this._currKeyIndices = {};
    this.graph = null;
    var self = this;
    function addInterpolatedKeys(node) {
      var name = node.getName();
      var interpKey = new InterpolatedKey;
      interpKey._name = name;
      self._interpolatedKeys.push(interpKey);
      self._interpolatedKeyDict[name] = interpKey;
      self._currKeyIndices[name] = 0;
      var children = node.getChildren();
      for(var i = 0;i < children.length;i++) {
        addInterpolatedKeys(children[i])
      }
    }
    addInterpolatedKeys(graph)
  };
  Skeleton.prototype.addTime = function(delta) {
    if(this._animation !== null) {
      if(this._time === duration && !this.looping) {
        return
      }
      var i;
      var node, nodeName;
      var keys, interpKey;
      var k1, k2, alpha;
      var nodes = this._animation.getNodes();
      this._time += delta;
      var duration = this._animation.getDuration();
      if(this._time > duration) {
        this._time = this.looping ? 0 : duration;
        for(i = 0;i < nodes.length;i++) {
          node = nodes[i];
          nodeName = node._name;
          this._currKeyIndices[nodeName] = 0
        }
      }else {
        if(this._time < 0) {
          this._time = this.looping ? duration : 0;
          for(i = 0;i < nodes.length;i++) {
            node = nodes[i];
            nodeName = node._name;
            this._currKeyIndices[nodeName] = node._keys.length - 2
          }
        }
      }
      var offset = delta > 0 ? 1 : -1;
      for(i = 0;i < nodes.length;i++) {
        node = nodes[i];
        nodeName = node._name;
        keys = node._keys;
        interpKey = this._interpolatedKeyDict[nodeName];
        if(keys.length === 1) {
          interpKey._pos.copy(keys[0].position);
          interpKey._quat.copy(keys[0].rotation);
          interpKey._scale(keys[0].scale)
        }else {
          for(var currKeyIndex = this._currKeyIndices[nodeName];currKeyIndex < keys.length - 1 && currKeyIndex >= 0;currKeyIndex += offset) {
            k1 = keys[currKeyIndex];
            k2 = keys[currKeyIndex + 1];
            if(k1.time <= this._time && k2.time >= this._time) {
              alpha = (this._time - k1.time) / (k2.time - k1.time);
              interpKey._pos.lerp(k1.position, k2.position, alpha);
              interpKey._quat.slerp(k1.rotation, k2.rotation, alpha);
              interpKey._scale.lerp(k1.scale, k2.scale, alpha);
              interpKey._written = true;
              this._currKeyIndices[nodeName] = currKeyIndex;
              break
            }
          }
        }
      }
    }
  };
  Skeleton.prototype.blend = function(skel1, skel2, alpha) {
    var numNodes = this._interpolatedKeys.length;
    for(var i = 0;i < numNodes;i++) {
      var key1 = skel1._interpolatedKeys[i];
      var key2 = skel2._interpolatedKeys[i];
      var dstKey = this._interpolatedKeys[i];
      if(key1._written && key2._written) {
        dstKey._quat.slerp(key1._quat, skel2._interpolatedKeys[i]._quat, alpha);
        dstKey._pos.lerp(key1._pos, skel2._interpolatedKeys[i]._pos, alpha);
        dstKey._scale.lerp(key1._scale, key2._scale, alpha);
        dstKey._written = true
      }else {
        if(key1._written) {
          dstKey._quat.copy(key1._quat);
          dstKey._pos.copy(key1._pos);
          dstKey._scale.copy(key1._scale);
          dstKey._written = true
        }else {
          if(key2._written) {
            dstKey._quat.copy(key2._quat);
            dstKey._pos.copy(key2._pos);
            dstKey._scale.copy(key2._scale);
            dstKey._written = true
          }
        }
      }
    }
  };
  Skeleton.prototype.getAnimation = function() {
    return this._animation
  };
  Skeleton.prototype.getCurrentTime = function() {
    return this._time
  };
  Skeleton.prototype.setCurrentTime = function(time) {
    this._time = time;
    var numNodes = this._interpolatedKeys.length;
    for(var i = 0;i < numNodes;i++) {
      var node = this._interpolatedKeys[i];
      var nodeName = node._name;
      this._currKeyIndices[nodeName] = 0
    }
    this.addTime(0);
    this.updateGraph()
  };
  Skeleton.prototype.getNumNodes = function() {
    return this._interpolatedKeys.length
  };
  Skeleton.prototype.setAnimation = function(animation) {
    this._animation = animation;
    this.setCurrentTime(0)
  };
  Skeleton.prototype.setGraph = function(graph) {
    var i;
    this.graph = graph;
    if(graph) {
      for(i = 0;i < this._interpolatedKeys.length;i++) {
        var interpKey = this._interpolatedKeys[i];
        var graphNode = graph.findByName(interpKey._name);
        this._interpolatedKeys[i].setTarget(graphNode)
      }
    }else {
      for(i = 0;i < this._interpolatedKeys.length;i++) {
        this._interpolatedKeys[i].setTarget(null)
      }
    }
  };
  Skeleton.prototype.updateGraph = function() {
    if(this.graph) {
      for(var i = 0;i < this._interpolatedKeys.length;i++) {
        var interpKey = this._interpolatedKeys[i];
        if(interpKey._written) {
          var transform = interpKey.getTarget();
          transform.localPosition.copy(interpKey._pos);
          transform.localRotation.copy(interpKey._quat);
          transform.localScale.copy(interpKey._scale);
          transform.dirtyLocal = true;
          interpKey._written = false
        }
      }
    }
  };
  Skeleton.prototype.setLooping = function(looping) {
    this.looping = looping
  };
  Skeleton.prototype.getLooping = function() {
    return this.looping
  };
  return{Skeleton:Skeleton}
}());
pc.extend(pc, function() {
  function hasAudio() {
    return typeof Audio !== "undefined"
  }
  function hasAudioContext() {
    return!!(typeof AudioContext !== "undefined" || typeof webkitAudioContext !== "undefined")
  }
  function isSupported(url, audio) {
    var toMIME = {".ogg":"audio/ogg", ".mp3":"audio/mpeg", ".wav":"audio/x-wav"};
    var ext = pc.path.getExtension(url);
    if(toMIME[ext]) {
      if(!audio) {
        audio = new Audio
      }
      return audio.canPlayType(toMIME[ext]) !== ""
    }else {
      return false
    }
  }
  var AudioManager = function() {
    if(hasAudioContext()) {
      if(typeof AudioContext !== "undefined") {
        this.context = new AudioContext
      }else {
        if(typeof webkitAudioContext !== "undefined") {
          this.context = new webkitAudioContext
        }
      }
    }
    this.listener = new pc.Listener(this);
    this.volume = 1;
    this.suspended = false;
    pc.events.attach(this)
  };
  AudioManager.hasAudio = hasAudio;
  AudioManager.hasAudioContext = hasAudioContext;
  AudioManager.isSupported = isSupported;
  AudioManager.prototype = {createSound:function(url, success, error) {
    var sound = null;
    if(pc.Sound) {
      sound = new pc.Sound(this, url, success, error)
    }else {
      error()
    }
    return sound
  }, playSound:function(sound, options) {
    options = options || {};
    var channel = null;
    if(pc.Channel) {
      channel = new pc.Channel(this, sound, options);
      channel.play()
    }
    return channel
  }, playSound3d:function(sound, position, options) {
    options = options || {};
    var channel = null;
    if(pc.Channel3d) {
      channel = new pc.Channel3d(this, sound, options);
      channel.setPosition(position);
      if(options.volume) {
        channel.setVolume(options.volume)
      }
      if(options.loop) {
        channel.setLoop(options.loop)
      }
      if(options.maxDistance) {
        channel.setMaxDistance(options.maxDistance)
      }
      if(options.minDistance) {
        channel.setMinDistance(options.minDistance)
      }
      if(options.rollOffFactor) {
        channel.setRollOffFactor(options.rollOffFactor)
      }
      channel.play()
    }
    return channel
  }, getListener:function() {
    return this.listener
  }, getVolume:function() {
    return this.volume
  }, setVolume:function(volume) {
    this.volume = volume;
    this.fire("volumechange", volume)
  }, suspend:function() {
    this.suspended = true;
    this.fire("suspend")
  }, resume:function() {
    this.suspended = false;
    this.fire("resume")
  }};
  return{AudioManager:AudioManager}
}());
pc.extend(pc, function() {
  var Sound;
  if(pc.AudioManager.hasAudioContext()) {
    Sound = function(manager, url, success, error) {
      this.buffer = null;
      this.isLoaded = false;
      if(!pc.AudioManager.isSupported(url, this.audio)) {
        setTimeout(function() {
          error(pc.string.format("Audio format for {0} not supported", url))
        }, 0)
      }else {
        if(manager.context) {
          pc.net.http.get(url, function(response) {
            manager.context.decodeAudioData(response, function(buffer) {
              this.buffer = buffer;
              this.isLoaded = true;
              success(this)
            }.bind(this), error)
          }.bind(this), {error:error})
        }
      }
    }
  }else {
    if(pc.AudioManager.hasAudio()) {
      Sound = function(manager, url, success, error) {
        this.isLoaded = false;
        this.audio = new Audio;
        this.audio.oncanplaythrough = function() {
          if(!this.isLoaded) {
            this.isLoaded = true;
            success(this)
          }
        }.bind(this);
        this.audio.src = url
      }
    }
  }
  return{Sound:Sound}
}());
pc.extend(pc, function() {
  var Listener = function(manager) {
    this.position = new pc.Vec3;
    this.velocity = new pc.Vec3;
    this.orientation = new pc.Mat4;
    if(pc.AudioManager.hasAudioContext()) {
      this.listener = manager.context.listener
    }
  };
  Listener.prototype = {getPosition:function() {
    return this.position
  }, setPosition:function(position) {
    this.position.copy(position);
    if(this.listener) {
      this.listener.setPosition(position.x, position.y, position.z)
    }
  }, getVelocity:function() {
    return this.velocity
  }, setVelocity:function(velocity) {
    this.velocity.copy(velocity);
    if(this.listener) {
      this.listener.setPosition(velocity.x, velocity.y, velocity.z)
    }
  }, setOrientation:function(orientation) {
    this.orientation.copy(orientation);
    if(this.listener) {
      this.listener.setOrientation(-orientation.data[8], -orientation.data[9], -orientation.data[10], orientation.data[4], orientation.data[5], orientation.data[6])
    }
  }, getOrientation:function() {
    return this.orientation
  }};
  return{Listener:Listener}
}());
pc.extend(pc, function() {
  var Channel;
  if(pc.AudioManager.hasAudioContext()) {
    Channel = function(manager, sound, options) {
      options = options || {};
      this.volume = options.volume === undefined ? 1 : options.volume;
      this.loop = options.loop === undefined ? false : options.loop;
      this.pitch = options.pitch === undefined ? 1 : options.pitch;
      this.sound = sound;
      this.paused = false;
      this.suspended = false;
      this.startTime = 0;
      this.startOffset = 0;
      this.manager = manager;
      this.source = null;
      var context = manager.context;
      this.gain = context.createGain()
    };
    Channel.prototype = {play:function() {
      if(this.source) {
        throw new Error("Call stop() before calling play()");
      }
      this._createSource();
      this.setVolume(this.volume);
      this.setLoop(this.loop);
      this.setPitch(this.pitch);
      this.startTime = this.manager.context.currentTime;
      this.source.start(0, this.startOffset % this.source.buffer.duration);
      this.manager.on("volumechange", this.onManagerVolumeChange, this);
      this.manager.on("suspend", this.onManagerSuspend, this);
      this.manager.on("resume", this.onManagerResume, this)
    }, pause:function() {
      if(this.source) {
        this.paused = true;
        this.startOffset += this.manager.context.currentTime - this.startTime;
        this.source.stop(0);
        this.source = null
      }
    }, unpause:function() {
      if(this.source || !this.paused) {
        throw new Error("Call pause() before unpausing.");
      }
      this._createSource();
      this.setVolume(this.volume);
      this.setLoop(this.loop);
      this.setPitch(this.pitch);
      this.startTime = this.manager.context.currentTime;
      this.source.start(0, this.startOffset % this.source.buffer.duration);
      this.paused = false
    }, stop:function() {
      if(this.source) {
        this.source.stop(0);
        this.source = null
      }
      this.manager.off("volumechange", this.onManagerVolumeChange, this);
      this.manager.off("suspend", this.onManagerSuspend, this);
      this.manager.off("resume", this.onManagerResume, this)
    }, setLoop:function(loop) {
      this.loop = loop;
      if(this.source) {
        this.source.loop = loop
      }
    }, setVolume:function(volume) {
      this.volume = volume;
      if(this.gain) {
        this.gain.gain.value = volume * this.manager.getVolume()
      }
    }, setPitch:function(pitch) {
      this.pitch = pitch;
      if(this.source) {
        this.source.playbackRate.value = pitch
      }
    }, isPlaying:function() {
      return!this.paused && this.source.playbackState === this.source.PLAYING_STATE
    }, getDuration:function() {
      if(this.source) {
        return this.source.buffer.duration
      }else {
        return 0
      }
    }, _createSource:function() {
      var context = this.manager.context;
      this.source = context.createBufferSource();
      this.source.buffer = this.sound.buffer;
      this.source.connect(this.gain);
      this.gain.connect(context.destination)
    }}
  }else {
    if(pc.AudioManager.hasAudio()) {
      Channel = function(manager, sound, options) {
        this.volume = options.volume || 1;
        this.loop = options.loop || false;
        this.sound = sound;
        this.pitch = options.pitch !== undefined ? options.pitch : 1;
        this.paused = false;
        this.suspended = false;
        this.manager = manager;
        this.source = sound.audio.cloneNode(false);
        this.source.pause()
      };
      Channel.prototype = {play:function() {
        if(this.source) {
          this.paused = false;
          this.setVolume(this.volume);
          this.setLoop(this.loop);
          this.setPitch(this.pitch);
          this.source.play()
        }
        this.manager.on("volumechange", this.onManagerVolumeChange, this);
        this.manager.on("suspend", this.onManagerSuspend, this);
        this.manager.on("resume", this.onManagerResume, this)
      }, pause:function() {
        if(this.source) {
          this.paused = true;
          this.source.pause()
        }
      }, unpause:function() {
        if(this.source) {
          this.paused = false;
          this.source.play()
        }
      }, stop:function() {
        if(this.source) {
          this.source.pause()
        }
        this.manager.off("volumechange", this.onManagerVolumeChange, this);
        this.manager.off("suspend", this.onManagerSuspend, this);
        this.manager.off("resume", this.onManagerResume, this)
      }, setVolume:function(volume) {
        this.volume = volume;
        if(this.source) {
          this.source.volume = volume * this.manager.getVolume()
        }
      }, setLoop:function(loop) {
        this.loop = loop;
        if(this.source) {
          this.source.loop = loop
        }
      }, setPitch:function(pitch) {
        this.pitch = pitch;
        if(this.source) {
          this.source.playbackRate = pitch
        }
      }, getDuration:function() {
        if(this.source) {
          var d = this.source.duration;
          if(d === d) {
            return d
          }
        }
        return 0
      }, isPlaying:function() {
        return!this.source.paused
      }}
    }else {
      console.warn("No support for 2D audio found");
      Channel = function() {
      }
    }
  }
  pc.extend(Channel.prototype, {getVolume:function() {
    return this.volume
  }, getLoop:function() {
    return this.loop
  }, getPitch:function() {
    return this.pitch
  }, onManagerVolumeChange:function() {
    this.setVolume(this.getVolume())
  }, onManagerSuspend:function() {
    if(this.isPlaying() && !this.suspended) {
      this.suspended = true;
      this.pause()
    }
  }, onManagerResume:function() {
    if(this.suspended) {
      this.suspended = false;
      this.unpause()
    }
  }});
  return{Channel:Channel}
}());
pc.extend(pc, function() {
  var MAX_DISTANCE = 1E4;
  var Channel3d;
  if(pc.AudioManager.hasAudioContext()) {
    Channel3d = function(manager, sound, options) {
      this.position = new pc.Vec3;
      this.velocity = new pc.Vec3;
      var context = manager.context;
      this.panner = context.createPanner()
    };
    Channel3d = pc.inherits(Channel3d, pc.Channel);
    Channel3d.prototype = pc.extend(Channel3d.prototype, {getPosition:function() {
      return this.position
    }, setPosition:function(position) {
      this.position.copy(position);
      this.panner.setPosition(position.x, position.y, position.z)
    }, getVelocity:function() {
      return this.velocity
    }, setVelocity:function(velocity) {
      this.velocity.copy(velocity);
      this.panner.setVelocity(velocity.x, velocity.y, velocity.z)
    }, getMaxDistance:function() {
      return this.panner.maxDistance
    }, setMaxDistance:function(max) {
      this.panner.maxDistance = max
    }, getMinDistance:function() {
      return this.panner.refDistance
    }, setMinDistance:function(min) {
      this.panner.refDistance = min
    }, getRollOffFactor:function() {
      return this.panner.rolloffFactor
    }, setRollOffFactor:function(factor) {
      this.panner.rolloffFactor = factor
    }, _createSource:function() {
      var context = this.manager.context;
      this.source = context.createBufferSource();
      this.source.buffer = this.sound.buffer;
      this.source.connect(this.panner);
      this.panner.connect(this.gain);
      this.gain.connect(context.destination)
    }})
  }else {
    if(pc.AudioManager.hasAudio()) {
      var offset = new pc.Vec3;
      var distance;
      var fallOff = function(posOne, posTwo, refDistance, maxDistance, rolloffFactor) {
        var min = 0;
        offset = offset.sub2(posOne, posTwo);
        distance = offset.length();
        if(distance < refDistance) {
          return 1
        }else {
          if(distance > maxDistance) {
            return 0
          }else {
            var numerator = refDistance + rolloffFactor * (distance - refDistance);
            if(numerator !== 0) {
              return refDistance / numerator
            }else {
              return 1
            }
          }
        }
      };
      Channel3d = function(manager, sound) {
        this.position = new pc.Vec3;
        this.velocity = new pc.Vec3;
        this.maxDistance = MAX_DISTANCE;
        this.minDistance = 1;
        this.rollOffFactor = 1
      };
      Channel3d = pc.inherits(Channel3d, pc.Channel);
      Channel3d.prototype = pc.extend(Channel3d.prototype, {getPosition:function() {
        return this.position
      }, setPosition:function(position) {
        this.position.copy(position);
        if(this.source) {
          var listener = this.manager.getListener();
          var lpos = listener.getPosition();
          var factor = fallOff(lpos, this.position, this.minDistance, this.maxDistance, this.rollOffFactor);
          var v = this.getVolume();
          this.source.volume = v * factor
        }
      }, getVelocity:function() {
        return this.velocity
      }, setVelocity:function(velocity) {
        this.velocity.copy(velocity)
      }, getMaxDistance:function() {
        return this.maxDistance
      }, setMaxDistance:function(max) {
        this.maxDistance = max
      }, getMinDistance:function() {
        return this.minDistance
      }, setMinDistance:function(min) {
        this.minDistance = min
      }, getRollOffFactor:function() {
        return this.rolloffFactor
      }, setRollOffFactor:function(factor) {
        this.rolloffFactor = factor
      }})
    }else {
      console.warn("No support for 3D audio found");
      Channel3d = function() {
      }
    }
  }
  return{Channel3d:Channel3d}
}());
(function() {
  var enums = {ACTION_MOUSE:"mouse", ACTION_KEYBOARD:"keyboard", ACTION_GAMEPAD:"gamepad", AXIS_MOUSE_X:"mousex", AXIS_MOUSE_Y:"mousey", AXIS_PAD_L_X:"padlx", AXIS_PAD_L_Y:"padly", AXIS_PAD_R_X:"padrx", AXIS_PAD_R_Y:"padry", AXIS_KEY:"key", EVENT_KEYDOWN:"keydown", EVENT_KEYUP:"keyup", EVENT_MOUSEDOWN:"mousedown", EVENT_MOUSEMOVE:"mousemove", EVENT_MOUSEUP:"mouseup", EVENT_MOUSEWHEEL:"mousewheel", EVENT_TOUCHSTART:"touchstart", EVENT_TOUCHEND:"touchend", EVENT_TOUCHMOVE:"touchmove", EVENT_TOUCHCANCEL:"touchcancel",
  KEY_BACKSPACE:8, KEY_TAB:9, KEY_RETURN:13, KEY_ENTER:14, KEY_SHIFT:16, KEY_CONTROL:17, KEY_ALT:18, KEY_PAUSE:19, KEY_CAPS_LOCK:20, KEY_ESCAPE:27, KEY_SPACE:32, KEY_PAGE_UP:33, KEY_PAGE_DOWN:34, KEY_END:35, KEY_HOME:36, KEY_LEFT:37, KEY_UP:38, KEY_RIGHT:39, KEY_DOWN:40, KEY_PRINT_SCREEN:44, KEY_INSERT:45, KEY_DELETE:46, KEY_0:48, KEY_1:49, KEY_2:50, KEY_3:51, KEY_4:52, KEY_5:53, KEY_6:54, KEY_7:55, KEY_8:56, KEY_9:57, KEY_SEMICOLON:59, KEY_EQUAL:61, KEY_A:65, KEY_B:66, KEY_C:67, KEY_D:68, KEY_E:69,
  KEY_F:70, KEY_G:71, KEY_H:72, KEY_I:73, KEY_J:74, KEY_K:75, KEY_L:76, KEY_M:77, KEY_N:78, KEY_O:79, KEY_P:80, KEY_Q:81, KEY_R:82, KEY_S:83, KEY_T:84, KEY_U:85, KEY_V:86, KEY_W:87, KEY_X:88, KEY_Y:89, KEY_Z:90, KEY_WINDOWS:91, KEY_CONTEXT_MENU:93, KEY_NUMPAD_0:96, KEY_NUMPAD_1:97, KEY_NUMPAD_2:98, KEY_NUMPAD_3:99, KEY_NUMPAD_4:100, KEY_NUMPAD_5:101, KEY_NUMPAD_6:102, KEY_NUMPAD_7:103, KEY_NUMPAD_8:104, KEY_NUMPAD_9:105, KEY_MULTIPLY:106, KEY_ADD:107, KEY_SEPARATOR:108, KEY_SUBTRACT:109, KEY_DECIMAL:110,
  KEY_DIVIDE:111, KEY_F1:112, KEY_F2:113, KEY_F3:114, KEY_F4:115, KEY_F5:116, KEY_F6:117, KEY_F7:118, KEY_F8:119, KEY_F9:120, KEY_F10:121, KEY_F11:122, KEY_F12:123, KEY_COMMA:188, KEY_PERIOD:190, KEY_SLASH:191, KEY_OPEN_BRACKET:219, KEY_BACK_SLASH:220, KEY_CLOSE_BRACKET:221, KEY_META:224, MOUSEBUTTON_NONE:-1, MOUSEBUTTON_LEFT:0, MOUSEBUTTON_MIDDLE:1, MOUSEBUTTON_RIGHT:2, PAD_1:0, PAD_2:1, PAD_3:2, PAD_4:3, PAD_FACE_1:0, PAD_FACE_2:1, PAD_FACE_3:2, PAD_FACE_4:3, PAD_L_SHOULDER_1:4, PAD_R_SHOULDER_1:5,
  PAD_L_SHOULDER_2:6, PAD_R_SHOULDER_2:7, PAD_SELECT:8, PAD_START:9, PAD_L_STICK_BUTTON:10, PAD_R_STICK_BUTTON:11, PAD_UP:12, PAD_DOWN:13, PAD_LEFT:14, PAD_RIGHT:15, PAD_VENDOR:16, PAD_L_STICK_X:0, PAD_L_STICK_Y:1, PAD_R_STICK_X:2, PAD_R_STICK_Y:3};
  pc.extend(pc, enums);
  pc.input = {};
  pc.extend(pc.input, enums)
})();
pc.extend(pc, function() {
  var MouseEvent = function(mouse, event) {
    var coords = {x:0, y:0};
    if(event) {
      if(event instanceof MouseEvent) {
        throw Error("Expected MouseEvent");
      }
      coords = mouse._getTargetCoords(event)
    }else {
      event = {}
    }
    if(coords) {
      this.x = coords.x;
      this.y = coords.y
    }else {
      if(pc.Mouse.isPointerLocked()) {
        this.x = 0;
        this.y = 0
      }else {
        return
      }
    }
    if(event.detail) {
      this.wheel = -1 * event.detail
    }else {
      if(event.wheelDelta) {
        this.wheel = event.wheelDelta / 120
      }else {
        this.wheel = 0
      }
    }
    if(pc.Mouse.isPointerLocked()) {
      this.dx = event.movementX || event.webkitMovementX || event.mozMovementX || 0;
      this.dy = event.movementY || event.webkitMovementY || event.mozMovementY || 0
    }else {
      this.dx = this.x - mouse._lastX;
      this.dy = this.y - mouse._lastY
    }
    if(event.type === "mousedown" || event.type === "mouseup") {
      this.button = event.button
    }else {
      this.button = pc.MOUSEBUTTON_NONE
    }
    this.buttons = mouse._buttons.slice(0);
    this.element = event.target;
    this.ctrlKey = event.ctrlKey || false;
    this.altKey = event.altKey || false;
    this.shiftKey = event.shiftKey || false;
    this.metaKey = event.metaKey || false;
    this.event = event
  };
  var Mouse = function(element) {
    this._lastX = 0;
    this._lastY = 0;
    this._buttons = [false, false, false];
    this._lastbuttons = [false, false, false];
    this._upHandler = this._handleUp.bind(this);
    this._downHandler = this._handleDown.bind(this);
    this._moveHandler = this._handleMove.bind(this);
    this._wheelHandler = this._handleWheel.bind(this);
    this._contextMenuHandler = function(event) {
      event.preventDefault()
    };
    this._target = null;
    this._attached = false;
    this.attach(element);
    pc.events.attach(this)
  };
  Mouse.isPointerLocked = function() {
    return!!(document.pointerLockElement || document.mozPointerLockElement || document.webkitPointerLockElement)
  };
  Mouse.prototype = {attach:function(element) {
    this._target = element;
    if(this._attached) {
      return
    }
    this._attached = true;
    window.addEventListener("mouseup", this._upHandler, false);
    window.addEventListener("mousedown", this._downHandler, false);
    window.addEventListener("mousemove", this._moveHandler, false);
    window.addEventListener("mousewheel", this._wheelHandler, false);
    window.addEventListener("DOMMouseScroll", this._wheelHandler, false)
  }, detach:function() {
    if(!this._attached) {
      return
    }
    this._attached = false;
    window.removeEventListener("mouseup", this._upHandler);
    window.removeEventListener("mousedown", this._downHandler);
    window.removeEventListener("mousemove", this._moveHandler);
    window.removeEventListener("mousewheel", this._wheelHandler);
    window.removeEventListener("DOMMouseScroll", this._wheelHandler)
  }, disableContextMenu:function() {
    if(!this._target) {
      return
    }
    this._target.addEventListener("contextmenu", this._contextMenuHandler)
  }, enableContextMenu:function() {
    if(!this._target) {
      return
    }
    this._target.removeEventListener("contextmenu", this._contextMenuHandler)
  }, enablePointerLock:function(success, error) {
    var s = function() {
      success();
      document.removeEventListener("pointerlockchange", s)
    };
    var e = function() {
      error();
      document.removeEventListener("pointerlockerror", e)
    };
    if(success) {
      document.addEventListener("pointerlockchange", s, false)
    }
    if(error) {
      document.addEventListener("pointerlockerror", e, false)
    }
    document.body.requestPointerLock()
  }, disablePointerLock:function(success) {
    var s = function() {
      success();
      document.removeEventListener("pointerlockchange", s)
    };
    if(success) {
      document.addEventListener("pointerlockchange", s, false)
    }
    document.exitPointerLock()
  }, update:function(dt) {
    this._lastbuttons[0] = this._buttons[0];
    this._lastbuttons[1] = this._buttons[1];
    this._lastbuttons[2] = this._buttons[2]
  }, isPressed:function(button) {
    return this._buttons[button]
  }, wasPressed:function(button) {
    return this._buttons[button] && !this._lastbuttons[button]
  }, wasReleased:function(button) {
    return!this._buttons[button] && this._lastbuttons[button]
  }, _handleUp:function(event) {
    this._buttons[event.button] = false;
    var e = new MouseEvent(this, event);
    if(!e.event) {
      return
    }
    this.fire(pc.EVENT_MOUSEUP, e)
  }, _handleDown:function(event) {
    this._buttons[event.button] = true;
    var e = new MouseEvent(this, event);
    if(!e.event) {
      return
    }
    this.fire(pc.EVENT_MOUSEDOWN, e)
  }, _handleMove:function(event) {
    var e = new MouseEvent(this, event);
    if(!e.event) {
      return
    }
    this.fire(pc.EVENT_MOUSEMOVE, e);
    this._lastX = e.x;
    this._lastY = e.y
  }, _handleWheel:function(event) {
    var e = new MouseEvent(this, event);
    if(!e.event) {
      return
    }
    this.fire(pc.EVENT_MOUSEWHEEL, e)
  }, _getTargetCoords:function(event) {
    var rect = this._target.getBoundingClientRect();
    var left = Math.floor(rect.left);
    var top = Math.floor(rect.top);
    if(event.clientX < left || event.clientX >= left + this._target.clientWidth || event.clientY < top || event.clientY >= top + this._target.clientHeight) {
      return null
    }
    return{x:event.clientX - left, y:event.clientY - top}
  }};
  (function() {
    if(typeof navigator === "undefined" || typeof document === "undefined") {
      return
    }
    navigator.pointer = navigator.pointer || navigator.webkitPointer || navigator.mozPointer;
    var pointerlockchange = function() {
      var e = document.createEvent("CustomEvent");
      e.initCustomEvent("pointerlockchange", true, false, null);
      document.dispatchEvent(e)
    };
    var pointerlockerror = function() {
      var e = document.createEvent("CustomEvent");
      e.initCustomEvent("pointerlockerror", true, false, null);
      document.dispatchEvent(e)
    };
    document.addEventListener("webkitpointerlockchange", pointerlockchange, false);
    document.addEventListener("webkitpointerlocklost", pointerlockchange, false);
    document.addEventListener("mozpointerlockchange", pointerlockchange, false);
    document.addEventListener("mozpointerlocklost", pointerlockchange, false);
    document.addEventListener("webkitpointerlockerror", pointerlockerror, false);
    document.addEventListener("mozpointerlockerror", pointerlockerror, false);
    if(Element.prototype.mozRequestPointerLock) {
      Element.prototype.requestPointerLock = function() {
        this.mozRequestPointerLock()
      }
    }else {
      Element.prototype.requestPointerLock = Element.prototype.requestPointerLock || Element.prototype.webkitRequestPointerLock || Element.prototype.mozRequestPointerLock
    }
    if(!Element.prototype.requestPointerLock && navigator.pointer) {
      Element.prototype.requestPointerLock = function() {
        var el = this;
        document.pointerLockElement = el;
        navigator.pointer.lock(el, pointerlockchange, pointerlockerror)
      }
    }
    document.exitPointerLock = document.exitPointerLock || document.webkitExitPointerLock || document.mozExitPointerLock;
    if(!document.exitPointerLock) {
      document.exitPointerLock = function() {
        if(navigator.pointer) {
          document.pointerLockElement = null;
          navigator.pointer.unlock()
        }
      }
    }
  })();
  return{Mouse:Mouse, MouseEvent:MouseEvent}
}());
pc.extend(pc, function() {
  var KeyboardEvent = function(keyboard, event) {
    this.key = event.keyCode;
    this.element = event.target;
    this.event = event
  };
  function toKeyCode(s) {
    if(typeof s == "string") {
      return s.toUpperCase().charCodeAt(0)
    }else {
      return s
    }
  }
  var _keyCodeToKeyIdentifier = {9:"Tab", 13:"Enter", 16:"Shift", 17:"Control", 18:"Alt", 27:"Escape", 37:"Left", 38:"Up", 39:"Right", 40:"Down", 46:"Delete", 91:"Win"};
  var Keyboard = function(element, options) {
    options = options || {};
    this._element = null;
    this._keyDownHandler = this._handleKeyDown.bind(this);
    this._keyUpHandler = this._handleKeyUp.bind(this);
    this._keyPressHandler = this._handleKeyPress.bind(this);
    pc.events.attach(this);
    this._keymap = {};
    this._lastmap = {};
    if(element) {
      this.attach(element)
    }
    this.preventDefault = options.preventDefault || false;
    this.stopPropagation = options.stopPropagation || false
  };
  Keyboard.prototype.attach = function(element) {
    if(this._element) {
      this.detach()
    }
    this._element = element;
    this._element.addEventListener("keydown", this._keyDownHandler, false);
    this._element.addEventListener("keypress", this._keyPressHandler, false);
    this._element.addEventListener("keyup", this._keyUpHandler, false)
  };
  Keyboard.prototype.detach = function() {
    this._element.removeEventListener("keydown", this._keyDownHandler);
    this._element.removeEventListener("keypress", this._keyPressHandler);
    this._element.removeEventListener("keyup", this._keyUpHandler);
    this._element = null
  };
  Keyboard.prototype.toKeyIdentifier = function(keyCode) {
    keyCode = toKeyCode(keyCode);
    var count;
    var hex;
    var length;
    var id = _keyCodeToKeyIdentifier[keyCode.toString()];
    if(id) {
      return id
    }
    hex = keyCode.toString(16).toUpperCase();
    length = hex.length;
    for(count = 0;count < 4 - length;count++) {
      hex = "0" + hex
    }
    return"U+" + hex
  };
  Keyboard.prototype._handleKeyDown = function(event) {
    var code = event.keyCode || event.charCode;
    var id = event.keyIdentifier || this.toKeyIdentifier(code);
    this._keymap[id] = true;
    this.fire("keydown", new KeyboardEvent(this, event));
    if(this.preventDefault) {
      event.preventDefault()
    }
    if(this.stopPropagation) {
      event.stopPropagation()
    }
  };
  Keyboard.prototype._handleKeyUp = function(event) {
    var code = event.keyCode || event.charCode;
    var id = event.keyIdentifier || this.toKeyIdentifier(code);
    delete this._keymap[id];
    this.fire("keyup", new KeyboardEvent(this, event));
    if(this.preventDefault) {
      event.preventDefault()
    }
    if(this.stopPropagation) {
      event.stopPropagation()
    }
  };
  Keyboard.prototype._handleKeyPress = function(event) {
    var code = event.keyCode || event.charCode;
    var id = event.keyIdentifier || this.toKeyIdentifier(code);
    this.fire("keypress", new KeyboardEvent(this, event));
    if(this.preventDefault) {
      event.preventDefault()
    }
    if(this.stopPropagation) {
      event.stopPropagation()
    }
  };
  Keyboard.prototype.update = function(dt) {
    var prop;
    this._lastmap = {};
    for(prop in this._keymap) {
      if(this._keymap.hasOwnProperty(prop)) {
        this._lastmap[prop] = this._keymap[prop]
      }
    }
  };
  Keyboard.prototype.isPressed = function(key) {
    var keyCode = toKeyCode(key);
    var id = this.toKeyIdentifier(keyCode);
    return!!this._keymap[id]
  };
  Keyboard.prototype.wasPressed = function(key) {
    var keyCode = toKeyCode(key);
    var id = this.toKeyIdentifier(keyCode);
    return!!this._keymap[id] && !!!this._lastmap[id]
  };
  Keyboard.prototype.wasReleased = function(key) {
    var keyCode = toKeyCode(key);
    var id = this.toKeyIdentifier(keyCode);
    return!!!this._keymap[id] && !!this._lastmap[id]
  };
  return{Keyboard:Keyboard}
}());
pc.extend(pc, function() {
  var GamePads = function() {
    this.gamepadsSupported = !!navigator.getGamepads || !!navigator.webkitGetGamepads;
    this.current = [];
    this.previous = [];
    this.deadZone = 0.25
  };
  var MAPS = {DEFAULT:{buttons:["PAD_FACE_1", "PAD_FACE_2", "PAD_FACE_3", "PAD_FACE_4", "PAD_L_SHOULDER_1", "PAD_R_SHOULDER_1", "PAD_L_SHOULDER_2", "PAD_R_SHOULDER_2", "PAD_SELECT", "PAD_START", "PAD_L_STICK_BUTTON", "PAD_R_STICK_BUTTON", "PAD_UP", "PAD_DOWN", "PAD_LEFT", "PAD_RIGHT", "PAD_VENDOR"], axes:["PAD_L_STICK_X", "PAD_L_STICK_Y", "PAD_R_STICK_X", "PAD_R_STICK_Y"]}, PS3:{buttons:["PAD_FACE_1", "PAD_FACE_2", "PAD_FACE_4", "PAD_FACE_3", "PAD_L_SHOULDER_1", "PAD_R_SHOULDER_1", "PAD_L_SHOULDER_2",
  "PAD_R_SHOULDER_2", "PAD_SELECT", "PAD_START", "PAD_L_STICK_BUTTON", "PAD_R_STICK_BUTTON", "PAD_UP", "PAD_DOWN", "PAD_LEFT", "PAD_RIGHT", "PAD_VENDOR"], axes:["PAD_L_STICK_X", "PAD_L_STICK_Y", "PAD_R_STICK_X", "PAD_R_STICK_Y"]}};
  var PRODUCT_CODES = {"Product: 0268":"PS3"};
  GamePads.prototype = {update:function(dt) {
    var pads = this.poll();
    var i, len = pads.length;
    for(i = 0;i < len;i++) {
      this.previous[i] = this.current[i];
      this.current[i] = pads[i]
    }
  }, poll:function() {
    var pads = [];
    if(this.gamepadsSupported) {
      var padDevices = navigator.getGamepads ? navigator.getGamepads() : navigator.webkitGetGamepads();
      var i, len = padDevices.length;
      for(i = 0;i < len;i++) {
        if(padDevices[i]) {
          pads.push({map:this.getMap(padDevices[i]), pad:padDevices[i]})
        }
      }
    }
    return pads
  }, getMap:function(pad) {
    for(var code in PRODUCT_CODES) {
      if(pad.id.indexOf(code) >= 0) {
        return MAPS[PRODUCT_CODES[code]]
      }
    }
    return MAPS.DEFAULT
  }, isPressed:function(index, button) {
    if(!this.current[index]) {
      return false
    }
    var key = this.current[index].map.buttons[button];
    return this.current[index].pad.buttons[pc[key]].pressed
  }, wasPressed:function(index, button) {
    if(!this.current[index]) {
      return false
    }
    var key = this.current[index].map.buttons[button];
    var i = pc[key];
    return this.current[index].pad.buttons[i].pressed && !this.previous[index].pad.buttons[i].pressed
  }, getAxis:function(index, axes) {
    if(!this.current[index]) {
      return false
    }
    var key = this.current[index].map.axes[axes];
    var value = this.current[index].pad.axes[pc[key]];
    if(Math.abs(value) < this.deadZone) {
      value = 0
    }
    return value
  }};
  return{GamePads:GamePads}
}());
pc.extend(pc, function() {
  var TouchEvent = function(device, event) {
    this.element = event.target;
    this.event = event;
    this.touches = [];
    this.changedTouches = [];
    if(event) {
      var i, l = event.touches.length;
      for(i = 0;i < l;i++) {
        this.touches.push(new Touch(event.touches[i]))
      }
      l = event.changedTouches.length;
      for(i = 0;i < l;i++) {
        this.changedTouches.push(new Touch(event.changedTouches[i]))
      }
    }
  };
  TouchEvent.prototype = {getTouchById:function(id, list) {
    var i, l = list.length;
    for(i = 0;i < l;i++) {
      if(list[i].id === id) {
        return list[i]
      }
    }
    return null
  }};
  var Touch = function(touch) {
    var coords = pc.getTouchTargetCoords(touch);
    this.id = touch.identifier;
    this.x = coords.x;
    this.y = coords.y;
    this.target = touch.target;
    this.touch = touch
  };
  var TouchDevice = function(element) {
    this._startHandler = this._handleTouchStart.bind(this);
    this._endHandler = this._handleTouchEnd.bind(this);
    this._moveHandler = this._handleTouchMove.bind(this);
    this._cancelHandler = this._handleTouchCancel.bind(this);
    this.attach(element);
    pc.events.attach(this)
  };
  TouchDevice.prototype = {attach:function(element) {
    if(this._element) {
      this.detach()
    }
    this._element = element;
    this._element.addEventListener("touchstart", this._startHandler, false);
    this._element.addEventListener("touchend", this._endHandler, false);
    this._element.addEventListener("touchmove", this._moveHandler, false);
    this._element.addEventListener("touchcancel", this._cancelHandler, false)
  }, detach:function() {
    if(this._element) {
      this._element.removeEventListener("touchstart", this._startHandler, false);
      this._element.removeEventListener("touchend", this._endHandler, false);
      this._element.removeEventListener("touchmove", this._moveHandler, false);
      this._element.removeEventListener("touchcancel", this._cancelHandler, false)
    }
    this._element = null
  }, _handleTouchStart:function(e) {
    this.fire("touchstart", new TouchEvent(this, e))
  }, _handleTouchEnd:function(e) {
    this.fire("touchend", new TouchEvent(this, e))
  }, _handleTouchMove:function(e) {
    e.preventDefault();
    this.fire("touchmove", new TouchEvent(this, e))
  }, _handleTouchCancel:function(e) {
    this.fire("touchcancel", new TouchEvent(this, e))
  }};
  return{getTouchTargetCoords:function(touch) {
    var totalOffsetX = 0;
    var totalOffsetY = 0;
    var canvasX = 0;
    var canvasY = 0;
    var target = touch.target;
    while(!(target instanceof HTMLElement)) {
      target = target.parentNode
    }
    var currentElement = target;
    do {
      totalOffsetX += currentElement.offsetLeft - currentElement.scrollLeft;
      totalOffsetY += currentElement.offsetTop - currentElement.scrollTop;
      currentElement = currentElement.offsetParent
    }while(currentElement);
    return{x:touch.pageX - totalOffsetX, y:touch.pageY - totalOffsetY}
  }, TouchDevice:TouchDevice}
}());
pc.extend(pc, function() {
  var Controller = function(element, options) {
    options = options || {};
    this._keyboard = options.keyboard || null;
    this._mouse = options.mouse || null;
    this._gamepads = options.gamepads || null;
    this._element = null;
    this._actions = {};
    this._axes = {};
    this._axesValues = {};
    if(element) {
      this.attach(element)
    }
  };
  Controller.prototype.attach = function(element) {
    this._element = element;
    if(this._keyboard) {
      this._keyboard.attach(element)
    }
    if(this._mouse) {
      this._mouse.attach(element)
    }
  };
  Controller.prototype.detach = function() {
    if(this._keyboard) {
      this._keyboard.detach()
    }
    if(this._mouse) {
      this._mouse.detach()
    }
    this._element = null
  };
  Controller.prototype.disableContextMenu = function() {
    if(!this._mouse) {
      this._enableMouse()
    }
    this._mouse.disableContextMenu()
  };
  Controller.prototype.enableContextMenu = function() {
    if(!this._mouse) {
      this._enableMouse()
    }
    this._mouse.enableContextMenu()
  };
  Controller.prototype.update = function(dt) {
    if(this._keyboard) {
      this._keyboard.update(dt)
    }
    if(this._mouse) {
      this._mouse.update(dt)
    }
    if(this._gamepads) {
      this._gamepads.update(dt)
    }
    this._axesValues = {};
    for(var key in this._axes) {
      this._axesValues[key] = []
    }
  };
  Controller.prototype.registerKeys = function(action, keys) {
    if(!this._keyboard) {
      this._enableKeyboard()
    }
    if(this._actions[action]) {
      throw new Error(pc.string.format("Action: {0} already registered", action));
    }
    if(keys === undefined) {
      throw new Error("Invalid button");
    }
    if(!keys.length) {
      keys = [keys]
    }
    if(this._actions[action]) {
      this._actions[action].push({type:pc.ACTION_KEYBOARD, keys:keys})
    }else {
      this._actions[action] = [{type:pc.ACTION_KEYBOARD, keys:keys}]
    }
  };
  Controller.prototype.registerMouse = function(action, button) {
    if(!this._mouse) {
      this._enableMouse()
    }
    if(button === undefined) {
      throw new Error("Invalid button");
    }
    if(this._actions[action]) {
      this._actions[action].push({type:pc.ACTION_MOUSE, button:button})
    }else {
      this._actions[action] = [{type:pc.ACTION_MOUSE, button:-button}]
    }
  };
  Controller.prototype.registerPadButton = function(action, pad, button) {
    if(button === undefined) {
      throw new Error("Invalid button");
    }
    if(this._actions[action]) {
      this._actions[action].push({type:pc.ACTION_GAMEPAD, button:button, pad:pad})
    }else {
      this._actions[action] = [{type:pc.ACTION_GAMEPAD, button:button, pad:pad}]
    }
  };
  Controller.prototype.registerAxis = function(options) {
    var name = options.name;
    if(!this._axes[name]) {
      this._axes[name] = []
    }
    var i = this._axes[name].push(name);
    options = options || {};
    options.pad = options.pad || pc.PAD_1;
    var bind = function(controller, source, value, key) {
      switch(source) {
        case "mousex":
          controller._mouse.on(pc.EVENT_MOUSEMOVE, function(e) {
            controller._axesValues[name][i] = e.dx / 10
          });
          break;
        case "mousey":
          controller._mouse.on(pc.EVENT_MOUSEMOVE, function(e) {
            controller._axesValues[name][i] = e.dy / 10
          });
          break;
        case "key":
          controller._axes[name].push(function() {
            return controller._keyboard.isPressed(key) ? value : 0
          });
          break;
        case "padrx":
          controller._axes[name].push(function() {
            return controller._gamepads.getAxis(options.pad, pc.PAD_R_STICK_X)
          });
          break;
        case "padry":
          controller._axes[name].push(function() {
            return controller._gamepads.getAxis(options.pad, pc.PAD_R_STICK_Y)
          });
          break;
        case "padlx":
          controller._axes[name].push(function() {
            return controller._gamepads.getAxis(options.pad, pc.PAD_L_STICK_X)
          });
          break;
        case "padly":
          controller._axes[name].push(function() {
            return controller._gamepads.getAxis(options.pad, pc.PAD_L_STICK_Y)
          });
          break;
        default:
          throw new Error("Unknown axis");
      }
    };
    bind(this, options.positive, 1, options.positiveKey);
    if(options.negativeKey || options.negative !== options.positive) {
      bind(this, options.negative, -1, options.negativeKey)
    }
  };
  Controller.prototype.isPressed = function(actionName) {
    if(!this._actions[actionName]) {
      return false
    }
    var action;
    var index = 0;
    var length = this._actions[actionName].length;
    for(index = 0;index < length;++index) {
      action = this._actions[actionName][index];
      switch(action.type) {
        case pc.ACTION_KEYBOARD:
          if(this._keyboard) {
            var i, len = action.keys.length;
            for(i = 0;i < len;i++) {
              if(this._keyboard.isPressed(action.keys[i])) {
                return true
              }
            }
          }
          break;
        case pc.ACTION_MOUSE:
          if(this._mouse && this._mouse.isPressed(action.button)) {
            return true
          }
          break;
        case pc.ACTION_GAMEPAD:
          if(this._gamepads && this._gamepads.isPressed(action.pad, action.button)) {
            return true
          }
          break
      }
    }
    return false
  };
  Controller.prototype.wasPressed = function(actionName) {
    if(!this._actions[actionName]) {
      return false
    }
    var index = 0;
    var length = this._actions[actionName].length;
    for(index = 0;index < length;++index) {
      var action = this._actions[actionName][index];
      switch(action.type) {
        case pc.ACTION_KEYBOARD:
          if(this._keyboard) {
            var i, len = action.keys.length;
            for(i = 0;i < len;i++) {
              if(this._keyboard.wasPressed(action.keys[i])) {
                return true
              }
            }
          }
          break;
        case pc.ACTION_MOUSE:
          if(this._mouse && this._mouse.wasPressed(action.button)) {
            return true
          }
          break;
        case pc.ACTION_GAMEPAD:
          if(this._gamepads && this._gamepads.wasPressed(action.pad, action.button)) {
            return true
          }
          break
      }
    }
    return false
  };
  Controller.prototype.getAxis = function(name) {
    var value = 0;
    if(this._axes[name]) {
      var i, len = this._axes[name].length;
      for(i = 0;i < len;i++) {
        if(pc.type(this._axes[name][i]) === "function") {
          var v = this._axes[name][i]();
          if(Math.abs(v) > Math.abs(value)) {
            value = v
          }
        }else {
          if(this._axesValues[name]) {
            if(Math.abs(this._axesValues[name][i]) > Math.abs(value)) {
              value = this._axesValues[name][i]
            }
          }
        }
      }
    }
    return value
  };
  Controller.prototype._enableMouse = function() {
    this._mouse = new pc.Mouse;
    if(!this._element) {
      throw new Error("Controller must be attached to a DOMElement");
    }
    this._mouse.attach(this._element)
  };
  Controller.prototype._enableKeyboard = function() {
    this._keyboard = new pc.Keyboard;
    if(!this._element) {
      throw new Error("Controller must be attached to a DOMElement");
    }
    this._keyboard.attach(this._element)
  };
  return{Controller:Controller}
}());
pc.net = function() {
  return{}
}();
pc.extend(pc.net, function() {
  var Http = function Http() {
  };
  Http.ContentType = {FORM_URLENCODED:"application/x-www-form-urlencoded", GIF:"image/gif", JPEG:"image/jpeg", DDS:"image/dds", JSON:"application/json", PNG:"image/png", TEXT:"text/plain", XML:"application/xml", WAV:"audio/x-wav", OGG:"audio/ogg", MP3:"audio/mpeg", BIN:"application/octet-stream"};
  Http.ResponseType = {TEXT:"text", ARRAY_BUFFER:"arraybuffer", BLOB:"blob", DOCUMENT:"document"};
  Http.binaryExtensions = [".model", ".wav", ".ogg", ".mp3", ".dds"];
  Http.prototype = {ContentType:Http.ContentType, ResponseType:Http.ResponseType, binaryExtensions:Http.binaryExtensions, get:function(url, success, options, xhr) {
    options = options || {};
    options.success = success;
    return this.request("GET", url, options, xhr)
  }, post:function(url, success, data, options, xhr) {
    options = options || {};
    options.success = success;
    options.postdata = data;
    return this.request("POST", url, options, xhr)
  }, put:function(url, success, data, options, xhr) {
    options = options || {};
    options.success = success;
    options.postdata = data;
    return this.request("PUT", url, options, xhr)
  }, del:function(url, success, options, xhr) {
    options = options || {};
    options.success = success;
    return this.request("DELETE", url, options, xhr)
  }, request:function(method, url, options, xhr) {
    var uri, query, timestamp, postdata;
    var errored = false;
    options = options || {};
    if(options.success == null) {
      options.success = function() {
      }
    }
    if(options.error == null) {
      options.error = function() {
      }
    }
    if(options.async == null) {
      options.async = true
    }
    if(options.headers == null) {
      options.headers = {}
    }
    if(options.postdata != null) {
      if(options.postdata instanceof Document) {
        postdata = options.postdata
      }else {
        if(options.postdata instanceof FormData) {
          postdata = options.postdata
        }else {
          if(options.postdata instanceof Object) {
            var contentType = options.headers["Content-Type"];
            if(!pc.isDefined(contentType)) {
              options.headers["Content-Type"] = Http.ContentType.FORM_URLENCODED;
              contentType = options.headers["Content-Type"]
            }
            switch(contentType) {
              case Http.ContentType.FORM_URLENCODED:
                postdata = "";
                var bFirstItem = true;
                for(var key in options.postdata) {
                  if(options.postdata.hasOwnProperty(key)) {
                    if(bFirstItem) {
                      bFirstItem = false
                    }else {
                      postdata += "&"
                    }
                    postdata += escape(key) + "=" + escape(options.postdata[key])
                  }
                }
                break;
              case Http.ContentType.JSON:
              ;
              default:
                if(contentType == null) {
                  options.headers["Content-Type"] = Http.ContentType.JSON
                }
                postdata = JSON.stringify(options.postdata);
                break
            }
          }else {
            postdata = options.postdata
          }
        }
      }
    }
    if(!xhr) {
      xhr = new XMLHttpRequest
    }
    if(options.cache === false) {
      timestamp = pc.time.now();
      uri = new pc.URI(url);
      if(!uri.query) {
        uri.query = "ts=" + timestamp
      }else {
        uri.query = uri.query + "&ts=" + timestamp
      }
      url = uri.toString()
    }
    if(options.query) {
      uri = new pc.URI(url);
      query = pc.extend(uri.getQuery(), options.query);
      uri.setQuery(query);
      url = uri.toString()
    }
    xhr.open(method, url, options.async);
    xhr.withCredentials = true;
    xhr.responseType = options.responseType || this.guessResponseType(url);
    for(var header in options.headers) {
      if(options.headers.hasOwnProperty(header)) {
        xhr.setRequestHeader(header, options.headers[header])
      }
    }
    xhr.onreadystatechange = function() {
      this.onReadyStateChange(method, url, options, xhr)
    }.bind(this);
    xhr.onerror = function() {
      this.onError(method, url, options, xhr);
      errored = true
    }.bind(this);
    try {
      xhr.send(postdata)
    }catch(e) {
      if(!errored) {
        options.error(xhr.status, xhr, e)
      }
    }
    return xhr
  }, guessResponseType:function(url) {
    var uri = new pc.URI(url);
    var ext = pc.path.getExtension(uri.path);
    if(Http.binaryExtensions.indexOf(ext) >= 0) {
      return Http.ResponseType.ARRAY_BUFFER
    }
    return Http.ResponseType.TEXT
  }, isBinaryContentType:function(contentType) {
    var binTypes = [Http.ContentType.WAV, Http.ContentType.OGG, Http.ContentType.MP3, Http.ContentType.BIN, Http.ContentType.DDS];
    if(binTypes.indexOf(contentType) >= 0) {
      return true
    }
    return false
  }, onReadyStateChange:function(method, url, options, xhr) {
    if(xhr.readyState === 4) {
      switch(xhr.status) {
        case 0:
          if(url[0] != "/") {
            this.onSuccess(method, url, options, xhr)
          }
          break;
        case 200:
        ;
        case 201:
        ;
        case 206:
        ;
        case 304:
          this.onSuccess(method, url, options, xhr);
          break;
        default:
          this.onError(method, url, options, xhr);
          break
      }
    }
  }, onSuccess:function(method, url, options, xhr) {
    var response;
    var header;
    var contentType;
    var parameter;
    var parts;
    header = xhr.getResponseHeader("Content-Type");
    if(header) {
      parts = header.split(";");
      contentType = parts[0].trim();
      if(parts[1]) {
        parameter = parts[1].trim()
      }
    }
    if(contentType === this.ContentType.JSON || pc.string.endsWith(url, ".json")) {
      response = JSON.parse(xhr.responseText)
    }else {
      if(this.isBinaryContentType(contentType)) {
        response = xhr.response
      }else {
        if(xhr.responseType === Http.ResponseType.ARRAY_BUFFER) {
          logWARNING(pc.string.format("responseType: {0} being served with Content-Type: {1}", Http.ResponseType.ARRAY_BUFFER, contentType));
          response = xhr.response
        }else {
          if(xhr.responseType === Http.ResponseType.DOCUMENT || contentType === this.ContentType.XML) {
            response = xhr.responseXML
          }else {
            response = xhr.responseText
          }
        }
      }
    }
    options.success(response, xhr.status, xhr)
  }, onError:function(method, url, options, xhr) {
    options.error(xhr.status, xhr, null)
  }};
  Http.prototype.delete_ = Http.prototype.del;
  return{Http:Http, http:new Http}
}());
pc.extend(pc.net, function() {
  var refreshCounter = 0;
  var OAuth = function OAuth(endpoint, redirectUrl, origin, clientId, scope) {
    this.clientId = clientId;
    this.endpoint = endpoint;
    this.redirectUrl = redirectUrl;
    this.origin = origin;
    this.scope = scope;
    this.responseType = "token";
    this.accessToken = null;
    this.OAUTH_IFRAME_ID_BASE = "pc-oauth-access-token-"
  };
  OAuth = pc.inherits(OAuth, pc.net.Http);
  OAuth.prototype.refreshAccessToken = function(success) {
    var id = this.OAUTH_IFRAME_ID_BASE + refreshCounter++;
    var handleMessage = function handleMessage(msg) {
      if(msg.origin !== this.origin) {
        return
      }
      if(msg.data.access_token) {
        var iframe = document.getElementById(id);
        if(iframe) {
          iframe.parentNode.removeChild(iframe)
        }
        this.accessToken = msg.data.access_token;
        success(msg.data.access_token)
      }else {
        if(msg.data.error) {
          logERROR(msg.data.error)
        }else {
          logWARNING("Invalid message posted to Corazon API")
        }
      }
      clearEvent()
    }.bind(this);
    window.addEventListener("message", handleMessage, false);
    var clearEvent = function() {
      window.removeEventListener("message", handleMessage)
    };
    var params = {client_id:this.clientId, redirect_url:this.redirectUrl, scope:this.scope, response_type:this.responseType};
    var url = new pc.URI(this.endpoint);
    url.setQuery(params);
    var iframe = document.getElementById(id);
    if(iframe) {
      throw new Error("accessToken request already in progress");
    }
    iframe = document.createElement("iframe");
    iframe.src = url.toString();
    iframe.id = id;
    iframe.style.display = "none";
    document.body.appendChild(iframe)
  };
  OAuth.prototype.request = function(method, url, options, xhr) {
    options.query = options.query || {};
    options.query = pc.extend(options.query, {"access_token":this.accessToken});
    return pc.net.OAuth._super.request.call(this, method, url, options, xhr)
  };
  OAuth.prototype.onError = function(method, url, options, xhr) {
    if(xhr.status == 401) {
      this.refreshAccessToken(function(accessToken) {
        options.query.access_token = accessToken;
        this.request(method, url, options, xhr)
      }.bind(this))
    }else {
      options.error(xhr.status, xhr, null)
    }
  };
  return{OAuth:OAuth, oauth:new OAuth}
}());
pc.extend(pc.net, function() {
  var Socket = function(url) {
    this._ws = new WebSocket(url);
    this._ws.onopen = this._handleOpen.bind(this);
    this._ws.onerror = this._handleError.bind(this);
    this._ws.onmessage = this._handleMessage.bind(this);
    this._ws.onclose = this._handleClose.bind(this)
  };
  Socket.prototype = {onopen:null, onerror:null, onmessage:null, get binaryType() {
    return this._ws.binaryType
  }, set binaryType(type) {
    this._ws.binaryType = type
  }, get readyState() {
    return this._ws.readyState
  }, get bufferedAmount() {
    return this._ws.bufferedAmount
  }, get extensions() {
    return this._ws.extensions
  }, get protocol() {
    return this._ws.protocol
  }, _handleOpen:function() {
    if(this.onopen) {
      this.onopen()
    }
  }, _handleError:function(error) {
    if(this.onerror) {
      this.onerror(error)
    }
  }, _handleMessage:function(msg) {
    if(this.onmessage) {
      this.onmessage(msg)
    }
  }, _handleClose:function() {
    if(this.onclose) {
      this.onclose()
    }
  }, send:function(msg) {
    this._ws.send(msg)
  }};
  return{Socket:Socket}
}());
pc.script = function() {
  var _main = null;
  var _loader = null;
  var script = {main:function(callback) {
    if(_main) {
      throw new Error("'main' Object already registered");
    }
    _main = callback
  }, setLoader:function(loader) {
    if(loader && _loader) {
      throw new Error("pc.script already has loader object.");
    }
    _loader = loader
  }, create:function(name, callback) {
    if(callback === undefined) {
      callback = attributes
    }
    this.fire("created", name, callback)
  }, attribute:function(name, type, defaultValue, options) {
  }, start:function() {
    _main()
  }};
  pc.events.attach(script);
  return script
}();
var designer = designer || {};
pc.extend(designer, function() {
  var LinkInterface = function() {
    this.exposed = {};
    this.added = {};
    this.scripts = {};
    this.systems = []
  };
  LinkInterface.prototype = {addComponentType:function() {
  }, expose:function() {
  }, add:function() {
  }, scriptexpose:function() {
  }};
  return{LinkInterface:LinkInterface, link:new LinkInterface}
}());
pc.extend(designer, function() {
  var LinkInterface = function() {
    this.exposed = {};
    this.added = {};
    this.scripts = {};
    this.systems = []
  };
  LinkInterface.prototype.addComponentType = function(componentSystem) {
    var name = componentSystem.id;
    var i;
    var systems = this.systems;
    var length = systems.length;
    var exists = false;
    for(i = 0;i < length;i++) {
      if(systems[i].name === name) {
        exists = true;
        break
      }
    }
    if(!exists) {
      this.systems.push({"name":name, "description":componentSystem.description})
    }
    if(!this.exposed[name]) {
      this.exposed[name] = {}
    }
  };
  LinkInterface.prototype.expose = function(system, details) {
    if(!details.name) {
      throw new Error("Missing option 'name'");
    }
    details.options = details.options || {};
    if(details.type === "vector") {
      details.array = true;
      if(details.defaultValue) {
        switch(details.defaultValue.length) {
          case 2:
            details.RuntimeType = pc.Vec2;
            break;
          case 3:
            details.RuntimeType = pc.Vec3;
            break;
          case 4:
            details.RuntimeType = pc.Vec4;
            break
        }
      }else {
        details.RuntimeType = pc.Vec3
      }
    }else {
      if(details.type === "rgb" || details.type === "rgba") {
        details.array = true;
        details.RuntimeType = pc.Color
      }else {
        if(details.type === "curve") {
          details.object = true;
          details.RuntimeType = pc.Curve
        }else {
          if(details.type === "curveset") {
            details.object = true;
            details.RuntimeType = pc.CurveSet
          }
        }
      }
    }
    if(!this.exposed[system][details.name]) {
      this.exposed[system][details.name] = {}
    }
    this.exposed[system][details.name] = details
  };
  LinkInterface.prototype.add = function(details) {
    logASSERT(details.system, "Missing option: 'system'");
    logASSERT(details.variable, "Missing option: 'variable'");
    if(!this.added[details.system]) {
      this.added[details.system] = {}
    }
    if(!this.added[details.system][details.variable]) {
      this.added[details.system][details.variable] = {}
    }
    this.added[details.system][details.variable] = details
  };
  LinkInterface.prototype.scriptexpose = function(details) {
    this.scripts[details.script] = details
  };
  return{LinkInterface:LinkInterface, link:new LinkInterface}
}());
pc.extend(pc, function() {
  var ContentFile = function(data) {
    this.packs = data.packs || {};
    this.appProperties = data.application_properties || {};
    this.toc = data.toc || {}
  };
  return{ContentFile:ContentFile}
}());
pc.extend(pc, function() {
  var Pack = function(data) {
    this.hierarchy = data.hierarchy;
    this.settings = data.settings
  };
  return{Pack:Pack}
}());
pc.extend(pc, function() {
  var Application = function(canvas, options) {
    options = options || {};
    pc.log.open();
    pc.events.attach(this);
    this._time = 0;
    this.timeScale = 1;
    this._librariesLoaded = false;
    this._fillMode = pc.FILLMODE_KEEP_ASPECT;
    this._resolutionMode = pc.RESOLUTION_FIXED;
    this.context = this;
    this.graphicsDevice = new pc.GraphicsDevice(canvas);
    this.systems = new pc.ComponentSystemRegistry;
    this._audioManager = new pc.AudioManager;
    this.loader = new pc.resources.ResourceLoader;
    this.scene = new pc.Scene;
    this.root = new pc.fw.Entity(this);
    this.assets = new pc.asset.AssetRegistry(this.loader);
    this.renderer = new pc.ForwardRenderer(this.graphicsDevice);
    this.keyboard = options.keyboard || null;
    this.mouse = options.mouse || null;
    this.touch = options.touch || null;
    this.gamepads = options.gamepads || null;
    this.content = null;
    this._inTools = false;
    this._link = new pc.LiveLink("application");
    this._link.addDestinationWindow(window);
    this._link.listen(this._handleMessage.bind(this));
    if(options.cache === false) {
      this.loader.cache = false
    }
    if(options.displayLoader) {
      var loaderdisplay = new pc.resources.ResourceLoaderDisplay(document.body, this.loader)
    }
    if(options.content) {
      this.content = options.content;
      Object.keys(this.content.toc).forEach(function(key) {
        this.assets.addGroup(key, this.content.toc[key])
      }.bind(this))
    }
    var textureCache = new pc.resources.TextureCache(this.loader);
    this.loader.registerHandler(pc.resources.JsonRequest, new pc.resources.JsonResourceHandler);
    this.loader.registerHandler(pc.resources.TextRequest, new pc.resources.TextResourceHandler);
    this.loader.registerHandler(pc.resources.ImageRequest, new pc.resources.ImageResourceHandler);
    this.loader.registerHandler(pc.resources.MaterialRequest, new pc.resources.MaterialResourceHandler(this.graphicsDevice, this.assets));
    this.loader.registerHandler(pc.resources.TextureRequest, new pc.resources.TextureResourceHandler(this.graphicsDevice, this.assets));
    this.loader.registerHandler(pc.resources.CubemapRequest, new pc.resources.CubemapResourceHandler(this.graphicsDevice, this.assets));
    this.loader.registerHandler(pc.resources.ModelRequest, new pc.resources.ModelResourceHandler(this.graphicsDevice, this.assets));
    this.loader.registerHandler(pc.resources.AnimationRequest, new pc.resources.AnimationResourceHandler);
    this.loader.registerHandler(pc.resources.PackRequest, new pc.resources.PackResourceHandler(this, options.depot));
    this.loader.registerHandler(pc.resources.AudioRequest, new pc.resources.AudioResourceHandler(this._audioManager));
    this.loader.registerHandler(pc.resources.ScriptRequest, new pc.resources.ScriptResourceHandler(this, options.scriptPrefix));
    var rigidbodysys = new pc.RigidBodyComponentSystem(this);
    var collisionsys = new pc.CollisionComponentSystem(this);
    var ballsocketjointsys = new pc.BallSocketJointComponentSystem(this);
    var animationsys = new pc.AnimationComponentSystem(this);
    var modelsys = new pc.ModelComponentSystem(this);
    var camerasys = new pc.CameraComponentSystem(this);
    var lightsys = new pc.LightComponentSystem(this);
    var packsys = new pc.PackComponentSystem(this);
    var skyboxsys = new pc.SkyboxComponentSystem(this);
    var scriptsys = new pc.ScriptComponentSystem(this);
    var picksys = new pc.PickComponentSystem(this);
    var audiosourcesys = new pc.AudioSourceComponentSystem(this, this._audioManager);
    var audiolistenersys = new pc.AudioListenerComponentSystem(this, this._audioManager);
    var particlesystemsys = new pc.ParticleSystemComponentSystem(this);
    var designersys = new pc.DesignerComponentSystem(this);
    this.on("librariesloaded", this.onLibrariesLoaded, this);
    if(options.libraries && options.libraries.length) {
      var requests = options.libraries.map(function(url) {
        return new pc.resources.ScriptRequest(url)
      });
      this.loader.request(requests).then(function(resources) {
        this.fire("librariesloaded", this);
        this._librariesLoaded = true
      }.bind(this))
    }else {
      this.fire("librariesloaded", this);
      this._librariesLoaded = true
    }
    if(document.hidden !== undefined) {
      this._hiddenAttr = "hidden";
      document.addEventListener("visibilitychange", this.onVisibilityChange.bind(this), false)
    }else {
      if(document.mozHidden !== undefined) {
        this._hiddenAttr = "mozHidden";
        document.addEventListener("mozvisibilitychange", this.onVisibilityChange.bind(this), false)
      }else {
        if(document.msHidden !== undefined) {
          this._hiddenAttr = "msHidden";
          document.addEventListener("msvisibilitychange", this.onVisibilityChange.bind(this), false)
        }else {
          if(document.webkitHidden !== undefined) {
            this._hiddenAttr = "webkitHidden";
            document.addEventListener("webkitvisibilitychange", this.onVisibilityChange.bind(this), false)
          }
        }
      }
    }
    Application._applications[this.graphicsDevice.canvas.id] = this;
    Application._currentApplication = this
  };
  Application._currentApplication = null;
  Application._applications = {};
  Application.getApplication = function(id) {
    if(id) {
      return Application._applications[id]
    }else {
      return Application._currentApplication
    }
  };
  Application.prototype = {loadFromToc:function(name, success, error, progress) {
    if(!this.content) {
      error("No content")
    }
    var toc = this.content.toc[name];
    success = success || function() {
    };
    error = error || function() {
    };
    progress = progress || function() {
    };
    var requests = [];
    var guid = toc.packs[0];
    var onLoaded = function(resources) {
      this.loader.request(new pc.resources.PackRequest(guid)).then(function(resources) {
        var pack = resources[0];
        this.root.addChild(pack.hierarchy);
        pc.ComponentSystem.initialize(pack.hierarchy);
        pc.ComponentSystem.postInitialize(pack.hierarchy);
        if(this.systems.rigidbody && typeof Ammo !== "undefined") {
          var gravity = pack.settings.physics.gravity;
          this.systems.rigidbody.setGravity(gravity[0], gravity[1], gravity[2])
        }
        var ambientLight = pack.settings.render.global_ambient;
        this.scene.ambientLight = new pc.Color(ambientLight[0], ambientLight[1], ambientLight[2]);
        this.scene.fog = pack.settings.render.fog;
        var fogColor = pack.settings.render.fog_color;
        this.scene.fogColor = new pc.Color(fogColor[0], fogColor[1], fogColor[2]);
        this.scene.fogStart = pack.settings.render.fog_start;
        this.scene.fogEnd = pack.settings.render.fog_end;
        this.scene.fogDensity = pack.settings.render.fog_density;
        this.scene.gammaCorrection = pack.settings.render.gamma_correction;
        this.scene.toneMapping = pack.settings.render.tonemapping;
        this.scene.exposure = pack.settings.render.exposure;
        if(pack.settings.render.skybox) {
          var skybox = this.assets.getAssetById(pack.settings.render.skybox);
          if(skybox) {
            this._setSkybox(skybox.resources);
            skybox.on("change", this._onSkyBoxChanged, this);
            skybox.on("remove", this._onSkyBoxRemoved, this)
          }else {
            this.scene.skybox = null
          }
        }
        success(pack);
        this.loader.off("progress", progress)
      }.bind(this), function(msg) {
        error(msg)
      }).then(null, function(error) {
        setTimeout(function() {
          throw error;
        }, 0)
      })
    }.bind(this);
    var load = function() {
      var assets = this.assets.list(guid);
      this.loader.on("progress", progress);
      if(assets.length) {
        this.assets.load(assets).then(function(resources) {
          onLoaded(resources)
        })
      }else {
        setTimeout(function() {
          onLoaded([])
        }, 0)
      }
    }.bind(this);
    if(!this._librariesLoaded) {
      this.on("librariesloaded", function() {
        load()
      })
    }else {
      load()
    }
  }, start:function() {
    if(!this._librariesLoaded) {
      this.on("librariesloaded", function() {
        this.tick()
      }, this)
    }else {
      this.tick()
    }
  }, update:function(dt) {
    pc.ComponentSystem.fixedUpdate(1 / 60, this._inTools);
    pc.ComponentSystem.update(dt, this._inTools);
    pc.ComponentSystem.postUpdate(dt, this._inTools);
    this.fire("update", dt);
    if(this.controller) {
      this.controller.update(dt)
    }
    if(this.mouse) {
      this.mouse.update(dt)
    }
    if(this.keyboard) {
      this.keyboard.update(dt)
    }
    if(this.gamepads) {
      this.gamepads.update(dt)
    }
  }, render:function() {
    var cameras = this.systems.camera.cameras;
    var camera = null;
    var renderer = this.renderer;
    this.root.syncHierarchy();
    for(var i = 0, len = cameras.length;i < len;i++) {
      camera = cameras[i];
      camera.frameBegin();
      renderer.render(this.scene, camera.camera);
      camera.frameEnd()
    }
  }, tick:function() {
    Application._currentApplication = this;
    window.requestAnimationFrame(this.tick.bind(this));
    var now = window.performance && window.performance.now ? performance.now() : Date.now();
    var dt = (now - (this._time || now)) / 1E3;
    this._time = now;
    dt = pc.math.clamp(dt, 0, 0.1);
    dt *= this.timeScale;
    this.update(dt);
    this.render()
  }, setCanvasFillMode:function(mode, width, height) {
    this._fillMode = mode;
    this.resizeCanvas(width, height)
  }, setCanvasResolution:function(mode, width, height) {
    this._resolutionMode = mode;
    if(mode === pc.RESOLUTION_AUTO && width === undefined) {
      width = this.graphicsDevice.canvas.clientWidth;
      height = this.graphicsDevice.canvas.clientHeight
    }
    this.graphicsDevice.resizeCanvas(width, height)
  }, isFullscreen:function() {
    return!!document.fullscreenElement
  }, enableFullscreen:function(element, success, error) {
    element = element || this.graphicsDevice.canvas;
    var s = function() {
      success();
      document.removeEventListener("fullscreenchange", s)
    };
    var e = function() {
      error();
      document.removeEventListener("fullscreenerror", e)
    };
    if(success) {
      document.addEventListener("fullscreenchange", s, false)
    }
    if(error) {
      document.addEventListener("fullscreenerror", e, false)
    }
    element.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT)
  }, disableFullscreen:function(success) {
    var s = function() {
      success();
      document.removeEventListener("fullscreenchange", s)
    };
    if(success) {
      document.addEventListener("fullscreenchange", s, false)
    }
    document.exitFullscreen()
  }, isHidden:function() {
    return document[this._hiddenAttr]
  }, onVisibilityChange:function(e) {
    if(this.isHidden()) {
      this._audioManager.suspend()
    }else {
      this._audioManager.resume()
    }
  }, resizeCanvas:function(width, height) {
    var windowWidth = window.innerWidth;
    var windowHeight = window.innerHeight;
    if(navigator.isCocoonJS) {
      width = windowWidth;
      height = windowHeight;
      var ratio = window.devicePixelRatio;
      this.graphicsDevice.resizeCanvas(width * ratio, height * ratio)
    }else {
      if(this._fillMode === pc.FILLMODE_KEEP_ASPECT) {
        var r = this.graphicsDevice.canvas.width / this.graphicsDevice.canvas.height;
        var winR = windowWidth / windowHeight;
        if(r > winR) {
          width = windowWidth;
          height = width / r
        }else {
          height = windowHeight;
          width = height * r
        }
      }else {
        if(this._fillMode === pc.FILLMODE_FILL_WINDOW) {
          width = windowWidth;
          height = windowHeight
        }else {
        }
      }
      this.graphicsDevice.canvas.style.width = width + "px";
      this.graphicsDevice.canvas.style.height = height + "px";
      if(this._resolutionMode === pc.RESOLUTION_AUTO) {
        this.setCanvasResolution(pc.RESOLUTION_AUTO)
      }
    }
    return{width:width, height:height}
  }, onLibrariesLoaded:function() {
    this.systems.rigidbody.onLibraryLoaded();
    this.systems.collision.onLibraryLoaded()
  }, _handleMessage:function(msg) {
    var entity;
    switch(msg.type) {
      case pc.LiveLinkMessageType.UPDATE_COMPONENT:
        this._linkUpdateComponent(msg.content.id, msg.content.component, msg.content.attribute, msg.content.value);
        break;
      case pc.LiveLinkMessageType.UPDATE_ENTITY:
        this._linkUpdateEntity(msg.content.id, msg.content.components);
        break;
      case pc.LiveLinkMessageType.UPDATE_ENTITY_TRANSFORM:
        this._linkUpdateEntityTransform(msg.content.id, msg.content.position, msg.content.rotation, msg.content.scale);
        break;
      case pc.LiveLinkMessageType.UPDATE_ENTITY_NAME:
        entity = this.root.findOne("getGuid", msg.content.id);
        entity.setName(msg.content.name);
        break;
      case pc.LiveLinkMessageType.UPDATE_ENTITY_ENABLED:
        entity = this.root.findOne("getGuid", msg.content.id);
        entity.enabled = msg.content.enabled;
        break;
      case pc.LiveLinkMessageType.REPARENT_ENTITY:
        this._linkReparentEntity(msg.content.id, msg.content.newParentId, msg.content.index);
        break;
      case pc.LiveLinkMessageType.CLOSE_ENTITY:
        entity = this.root.findOne("getGuid", msg.content.id);
        if(entity) {
          logDEBUG(pc.string.format("RT: Removed '{0}' from parent {1}", msg.content.id, entity.getParent().getGuid()));
          entity.destroy()
        }
        break;
      case pc.LiveLinkMessageType.OPEN_PACK:
        var pack = this.loader.open(pc.resources.PackRequest, msg.content.pack);
        var entity = pack.hierarchy;
        if(entity.__parent) {
          parent = this.root.findByGuid(entity.__parent);
          parent.addChild(entity)
        }else {
          this.root.addChild(entity)
        }
        break;
      case pc.LiveLinkMessageType.OPEN_ENTITY:
        var parent;
        var entities = {};
        var guid = null;
        if(msg.content.entity) {
          var pack = {application_data:{}, hierarchy:msg.content.entity};
          pack = this.loader.open(pc.resources.PackRequest, pack);
          entity = pack.hierarchy;
          if(entity.__parent) {
            parent = this.root.findByGuid(entity.__parent);
            parent.addChild(entity)
          }else {
            this.root.addChild(entity)
          }
        }
        break;
      case pc.LiveLinkMessageType.UPDATE_ASSET:
        this._linkUpdateAsset(msg.content.id, msg.content.attribute, msg.content.value);
        break;
      case pc.LiveLinkMessageType.UPDATE_ASSETCACHE:
        var id;
        var asset;
        for(id in msg.content.assets) {
          asset = this.assets.getAssetById(id);
          if(!asset) {
            this.assets.createAndAddAsset(id, msg.content.assets[id])
          }else {
            var data = msg.content.assets[id];
            for(var key in data) {
              if(data.hasOwnProperty(key)) {
                asset[key] = data[key]
              }
            }
          }
        }
        for(id in msg.content.deleted) {
          asset = this.assets.getAssetById(id);
          if(asset) {
            this.assets.removeAsset(asset)
          }
        }
        break;
      case pc.LiveLinkMessageType.UPDATE_PACK_SETTINGS:
        this._linkUpdatePackSettings(msg.content.settings);
        break
    }
  }, _linkUpdateComponent:function(guid, componentName, attributeName, value) {
    var entity = this.root.findOne("getGuid", guid);
    var attribute;
    if(entity) {
      if(componentName) {
        if(entity[componentName]) {
          attribute = designer.link.exposed[componentName][attributeName];
          if(designer && attribute) {
            if(attribute.RuntimeType) {
              if(attribute.RuntimeType === pc.Vec3) {
                entity[componentName][attributeName] = new attribute.RuntimeType(value[0], value[1], value[2])
              }else {
                if(attribute.RuntimeType === pc.Vec4) {
                  entity[componentName][attributeName] = new attribute.RuntimeType(value[0], value[1], value[2], value[3])
                }else {
                  if(attribute.RuntimeType === pc.Vec2) {
                    entity[componentName][attributeName] = new attribute.RuntimeType(value[0], value[1])
                  }else {
                    if(attribute.RuntimeType === pc.Color) {
                      if(value.length === 3) {
                        entity[componentName][attributeName] = new attribute.RuntimeType(value[0], value[1], value[2])
                      }else {
                        entity[componentName][attributeName] = new attribute.RuntimeType(value[0], value[1], value[2], value[3])
                      }
                    }else {
                      if(attribute.RuntimeType === pc.Curve || attribute.RuntimeType === pc.CurveSet) {
                        entity[componentName][attributeName] = new attribute.RuntimeType(value.keys);
                        entity[componentName][attributeName].type = value.type
                      }else {
                        entity[componentName][attributeName] = new attribute.RuntimeType(value)
                      }
                    }
                  }
                }
              }
            }else {
              entity[componentName][attributeName] = value
            }
          }else {
            entity[componentName][attributeName] = value
          }
        }else {
          logWARNING(pc.string.format("No component system called '{0}' exists", componentName))
        }
      }else {
        entity[attributeName] = value
      }
    }
  }, _linkUpdateEntityTransform:function(guid, position, rotation, scale) {
    var entity = this.root.findByGuid(guid);
    if(entity) {
      entity.setLocalPosition(position[0], position[1], position[2]);
      entity.setLocalEulerAngles(rotation[0], rotation[1], rotation[2]);
      entity.setLocalScale(scale[0], scale[1], scale[2]);
      entity.fire("livelink:updatetransform", position, rotation, scale)
    }
  }, _linkReparentEntity:function(guid, parentId, index) {
    var entity = this.root.findByGuid(guid);
    var parent = this.root.findByGuid(parentId);
    entity.reparent(parent, index)
  }, _linkUpdateEntity:function(guid, components) {
    var type;
    var entity = this.root.findOne("getGuid", guid);
    if(entity) {
      var order = this.systems.getComponentSystemOrder();
      var i, len = order.length;
      for(i = 0;i < len;i++) {
        type = order[i];
        if(components.hasOwnProperty(type) && this.systems.hasOwnProperty(type)) {
          if(!entity[type]) {
            this.systems[type].addComponent(entity, {})
          }
        }
      }
      for(type in this.systems) {
        if(type === "gizmo" || type === "pick") {
          continue
        }
        if(this.systems.hasOwnProperty(type)) {
          if(!components.hasOwnProperty(type) && entity[type]) {
            this.systems[type].removeComponent(entity)
          }
        }
      }
    }
  }, _linkUpdateAsset:function(id, attribute, value) {
    var asset = this.assets.getAssetById(id);
    if(asset) {
      asset[attribute] = value
    }
  }, _linkUpdatePackSettings:function(settings) {
    var self = this;
    var ambient = settings.render.global_ambient;
    self.scene.ambientLight.set(ambient[0], ambient[1], ambient[2]);
    if(self.systems.rigidbody && typeof Ammo !== "undefined") {
      var gravity = settings.physics.gravity;
      self.systems.rigidbody.setGravity(gravity[0], gravity[1], gravity[2])
    }
    self.scene.fog = settings.render.fog;
    self.scene.fogStart = settings.render.fog_start;
    self.scene.fogEnd = settings.render.fog_end;
    var fog = settings.render.fog_color;
    self.scene.fogColor = new pc.Color(fog[0], fog[1], fog[2]);
    self.scene.fogDensity = settings.render.fog_density;
    self.scene.gammaCorrection = settings.render.gamma_correction;
    self.scene.toneMapping = settings.render.tonemapping;
    self.scene.exposure = settings.render.exposure;
    if(settings.render.skybox) {
      var skybox = self.assets.getAssetById(settings.render.skybox);
      if(!skybox) {
        pc.log.error("Could not initialize scene skybox. Missing cubemap asset " + settings.render.skybox)
      }else {
        if(!skybox.resource) {
          self.assets.load([skybox]).then(function(resources) {
            self._setSkybox(resources[0]);
            skybox.off("change", self._onSkyBoxChanged, self);
            skybox.on("change", self._onSkyBoxChanged, self);
            skybox.off("remove", self._onSkyBoxRemoved, self);
            skybox.on("remove", self._onSkyBoxRemoved, self)
          }, function(error) {
            pc.log.error("Could not initialize scene skybox. Missing cubemap asset " + settings.render.skybox)
          })
        }else {
          self._setSkybox(skybox.resources);
          skybox.off("change", self._onSkyBoxChanged, self);
          skybox.on("change", self._onSkyBoxChanged, self);
          skybox.off("remove", self._onSkyBoxRemoved, self);
          skybox.on("remove", self._onSkyBoxRemoved, self)
        }
      }
    }else {
      self.scene.skybox = null;
      var mipSize = 128;
      for(var i = 0;i < 6;i++) {
        self.scene["skyboxPrefiltered" + mipSize] = null;
        mipSize *= 0.5
      }
    }
  }, _setSkybox:function(cubemaps) {
    var scene = this.scene;
    scene.skybox = cubemaps[0];
    scene.skyboxPrefiltered128 = cubemaps[1];
    scene.skyboxPrefiltered64 = cubemaps[2];
    scene.skyboxPrefiltered32 = cubemaps[3];
    scene.skyboxPrefiltered16 = cubemaps[4];
    scene.skyboxPrefiltered8 = cubemaps[5];
    scene.skyboxPrefiltered4 = cubemaps[6]
  }, _onSkyBoxChanged:function(asset, attribute, newValue, oldValue) {
    if(attribute !== "resources") {
      return
    }
    if(this.scene.skybox === oldValue[0]) {
      this._setSkybox(newValue)
    }else {
      skybox.off("change", this._onSkyBoxChanged, this)
    }
  }, _onSkyBoxRemoved:function(asset) {
    asset.off("change", this._onSkyBoxRemoved, this);
    if(this.scene.skybox === asset.resources[0]) {
      this.scene.skybox = null
    }
    var mipSize = 128;
    for(var i = 0;i < 6;i++) {
      var prop = "skyboxPrefiltered" + mipSize;
      if(this.scene[prop] === asset.resources[i + 1]) {
        this.scene[prop] = null
      }
      mipSize *= 0.5
    }
  }};
  return{FILLMODE_NONE:"NONE", FILLMODE_FILL_WINDOW:"FILL_WINDOW", FILLMODE_KEEP_ASPECT:"KEEP_ASPECT", RESOLUTION_AUTO:"AUTO", RESOLUTION_FIXED:"FIXED", Application:Application}
}());
pc.extend(pc, function() {
  var ComponentSystemRegistry = function() {
  };
  ComponentSystemRegistry.prototype = {add:function(name, system) {
    if(!this[name]) {
      this[name] = system;
      system.name = name
    }else {
      throw new Error(pc.string.format("ComponentSystem name '{0}' already registered or not allowed", name));
    }
  }, remove:function(name) {
    if(!this[name]) {
      throw new Error(pc.string.format("No ComponentSystem named '{0}' registered", name));
    }
    delete this[name]
  }, list:function() {
    var list = Object.keys(this);
    var defaultPriority = 1;
    var priorities = {"collisionrect":0.5, "collisioncircle":0.5};
    list.sort(function(a, b) {
      var pa = priorities[a] || defaultPriority;
      var pb = priorities[b] || defaultPriority;
      if(pa < pb) {
        return-1
      }else {
        if(pa > pb) {
          return 1
        }
      }
      return 0
    });
    return list.map(function(key) {
      return this[key]
    }, this)
  }, getComponentSystemOrder:function() {
    var index;
    var names = Object.keys(this);
    index = names.indexOf("collisionrect");
    names.splice(index, 1);
    names.unshift("collisionrect");
    index = names.indexOf("collisioncircle");
    names.splice(index, 1);
    names.unshift("collisioncircle");
    return names
  }};
  return{ComponentSystemRegistry:ComponentSystemRegistry}
}());
pc.extend(pc, function() {
  var ComponentSystem = function(app) {
    this.app = app;
    this.dataStore = {};
    this.schema = [];
    pc.events.attach(this)
  };
  pc.extend(ComponentSystem, {initialize:function(root) {
    ComponentSystem.fire("initialize", root)
  }, postInitialize:function(root) {
    ComponentSystem.fire("postInitialize", root)
  }, update:function(dt, inTools) {
    if(inTools) {
      ComponentSystem.fire("toolsUpdate", dt)
    }else {
      ComponentSystem.fire("update", dt)
    }
  }, fixedUpdate:function(dt, inTools) {
    ComponentSystem.fire("fixedUpdate", dt)
  }, postUpdate:function(dt, inTools) {
    ComponentSystem.fire("postUpdate", dt)
  }});
  ComponentSystem.prototype = {get store() {
    return this.dataStore
  }, addComponent:function(entity, data) {
    var component = new this.ComponentType(this, entity);
    var componentData = new this.DataType;
    data = data || {};
    this.dataStore[entity.getGuid()] = {entity:entity, data:componentData};
    entity[this.id] = component;
    entity.c[this.id] = component;
    this.initializeComponentData(component, data, []);
    this.fire("add", entity, component);
    return component
  }, removeComponent:function(entity) {
    var record = this.dataStore[entity.getGuid()];
    var component = entity.c[this.id];
    this.fire("beforeremove", entity, component);
    delete this.dataStore[entity.getGuid()];
    delete entity[this.id];
    delete entity.c[this.id];
    this.fire("remove", entity, record.data)
  }, cloneComponent:function(entity, clone) {
    var src = this.dataStore[entity.getGuid()];
    return this.addComponent(clone, src.data)
  }, initializeComponentData:function(component, data, properties) {
    data = data || {};
    properties.forEach(function(value) {
      if(data[value] !== undefined) {
        component[value] = data[value]
      }else {
        component[value] = component.data[value]
      }
    }, this);
    if(component.enabled && component.entity.enabled) {
      component.onEnable()
    }
  }, exposeProperties:function() {
    designer.link.addComponentType(this);
    this.schema.forEach(function(prop) {
      if(prop.exposed !== false) {
        designer.link.expose(this.id, prop)
      }
    }.bind(this))
  }};
  pc.events.attach(ComponentSystem);
  return{ComponentSystem:ComponentSystem}
}());
pc.extend(pc, function() {
  var Component = function(system, entity) {
    this.system = system;
    this.entity = entity;
    pc.events.attach(this);
    this.buildAccessors(this.system.schema);
    this.on("set", function(name, oldValue, newValue) {
      this.fire("set_" + name, name, oldValue, newValue)
    });
    this.on("set_enabled", this.onSetEnabled, this)
  };
  Component.prototype = {get data() {
    var record = this.system.store[this.entity.getGuid()];
    if(record) {
      return record.data
    }else {
      return null
    }
  }, buildAccessors:function(schema) {
    schema.forEach(function(prop) {
      var set;
      if(prop.readOnly) {
        Object.defineProperty(this, prop.name, {get:function() {
          return this.data[prop.name]
        }, configurable:true})
      }else {
        Object.defineProperty(this, prop.name, {get:function() {
          return this.data[prop.name]
        }, set:function(value) {
          var data = this.data;
          var oldValue = data[prop.name];
          data[prop.name] = value;
          this.fire("set", prop.name, oldValue, value)
        }, configurable:true})
      }
    }.bind(this))
  }, onSetEnabled:function(name, oldValue, newValue) {
    if(oldValue !== newValue) {
      if(this.entity.enabled) {
        if(newValue) {
          this.onEnable()
        }else {
          this.onDisable()
        }
      }
    }
  }, onEnable:function() {
  }, onDisable:function() {
  }};
  return{Component:Component}
}());
pc.extend(pc, function() {
  var ComponentData = function() {
  };
  return{ComponentData:ComponentData}
}());
pc.extend(pc, function() {
  var AnimationComponent = function(system, entity) {
    this.on("set_animations", this.onSetAnimations, this);
    this.on("set_assets", this.onSetAssets, this);
    this.on("set_loop", this.onSetLoop, this)
  };
  AnimationComponent = pc.inherits(AnimationComponent, pc.Component);
  pc.extend(AnimationComponent.prototype, {play:function(name, blendTime) {
    if(!this.data.animations[name]) {
      console.error(pc.string.format("Trying to play animation '{0}' which doesn't exist", name));
      return
    }
    if(!this.enabled || !this.entity.enabled) {
      return
    }
    blendTime = blendTime || 0;
    var data = this.data;
    data.prevAnim = data.currAnim;
    data.currAnim = name;
    if(data.model) {
      data.blending = blendTime > 0;
      if(data.blending) {
        data.blendTime = blendTime;
        data.blendTimeRemaining = blendTime;
        data.fromSkel.setAnimation(data.animations[data.prevAnim]);
        data.fromSkel.addTime(data.skeleton.getCurrentTime());
        data.toSkel.setAnimation(data.animations[data.currAnim])
      }else {
        data.skeleton.setAnimation(data.animations[data.currAnim])
      }
    }
    data.playing = true
  }, getAnimation:function(name) {
    return this.data.animations[name]
  }, setModel:function(model) {
    var data = this.data;
    if(model) {
      var graph = model.getGraph();
      data.fromSkel = new pc.Skeleton(graph);
      data.toSkel = new pc.Skeleton(graph);
      data.skeleton = new pc.Skeleton(graph);
      data.skeleton.setLooping(data.loop);
      data.skeleton.setGraph(graph)
    }
    data.model = model;
    if(data.animations && data.currAnim && data.animations[data.currAnim]) {
      this.play(data.currAnim)
    }
  }, loadAnimationAssets:function(ids) {
    if(!ids || !ids.length) {
      return
    }
    var options = {parent:this.entity.getRequest()};
    var assets = ids.map(function(id) {
      return this.system.app.assets.getAssetById(id)
    }, this);
    var animations = {};
    var names = [];
    var requests = [];
    for(var i = 0, len = assets.length;i < len;i++) {
      var asset = assets[i];
      if(!asset) {
        logERROR(pc.string.format("Trying to load animation component before assets {0} are loaded", ids))
      }else {
        asset.off("change", this.onAssetChanged, this);
        asset.on("change", this.onAssetChanged, this);
        asset.off("remove", this.onAssetRemoved, this);
        asset.on("remove", this.onAssetRemoved, this);
        if(asset.resource) {
          animations[asset.name] = asset.resource
        }else {
          names.push(asset.name);
          requests.push(new pc.resources.AnimationRequest(asset.getFileUrl()))
        }
      }
    }
    if(requests.length) {
      this.system.app.loader.request(requests, options).then(function(animResources) {
        for(var i = 0;i < requests.length;i++) {
          animations[names[i]] = animResources[i]
        }
        this.animations = animations
      }.bind(this))
    }else {
      this.animations = animations
    }
  }, onAssetChanged:function(asset, attribute, newValue, oldValue) {
    if(attribute === "resource") {
      if(newValue) {
        this.animations[asset.name] = newValue;
        if(this.data.currAnim === asset.name) {
          if(this.data.playing && this.data.enabled && this.entity.enabled) {
            this.play(asset.name, 0)
          }
        }
      }else {
        delete this.animations[asset.name]
      }
    }
  }, onAssetRemoved:function(asset) {
    asset.off("remove", this.onAssetRemoved, this);
    if(this.animations && this.animations[asset.name]) {
      delete this.animations[asset.name];
      if(this.data.currAnim === asset.name) {
        this.data.currAnim = null;
        this.speed = 0;
        this.data.playing = false;
        if(this.data.skeleton) {
          this.data.skeleton.setCurrentTime(0);
          this.data.skeleton.setAnimation(null)
        }
      }
    }
  }, onSetAnimations:function(name, oldValue, newValue) {
    var data = this.data;
    var modelComponent = this.entity.model;
    if(modelComponent) {
      var m = modelComponent.model;
      if(m) {
        this.entity.animation.setModel(m)
      }
    }
    for(var animName in data.animations) {
      if(data.activate && data.enabled && this.entity.enabled && !this.system._inTools) {
        this.play(animName, 0)
      }
      break
    }
  }, onSetAssets:function(name, oldValue, newValue) {
    if(oldValue && oldValue.length) {
      for(var i = 0;i < oldValue.length;i++) {
        if(oldValue[i]) {
          var asset = this.system.app.assets.getAssetById(oldValue[i]);
          if(asset) {
            asset.off("change", this.onAssetChanged, this);
            asset.off("remove", this.onAssetRemoved, this)
          }
        }
      }
    }
    this.loadAnimationAssets(newValue)
  }, onSetLoop:function(name, oldValue, newValue) {
    if(this.data.skeleton) {
      this.data.skeleton.setLooping(this.data.loop)
    }
  }, onSetCurrentTime:function(name, oldValue, newValue) {
    this.data.skeleton.setCurrentTime(newValue);
    this.data.skeleton.addTime(0);
    this.data.skeleton.updateGraph()
  }, onEnable:function() {
    AnimationComponent._super.onEnable.call(this);
    if(this.data.activate && !this.data.currAnim && !this.system._inTools) {
      for(var animName in this.data.animations) {
        this.play(animName, 0);
        break
      }
    }
  }});
  Object.defineProperties(AnimationComponent.prototype, {currentTime:{get:function() {
    return this.data.skeleton.getCurrentTime()
  }, set:function(currentTime) {
    this.data.skeleton.setCurrentTime(currentTime);
    this.data.skeleton.addTime(0);
    this.data.skeleton.updateGraph()
  }}, duration:{get:function() {
    return this.data.animations[this.data.currAnim].getDuration()
  }}});
  return{AnimationComponent:AnimationComponent}
}());
pc.extend(pc, function() {
  var AnimationComponentSystem = function AnimationComponentSystem(app) {
    this.id = "animation";
    this.description = "Specifies the animation assets that can run on the model specified by the Entity's model Component.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.AnimationComponent;
    this.DataType = pc.AnimationComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enable or disable the component", type:"boolean", defaultValue:true}, {name:"assets", displayName:"Asset", description:"Animation Asset", type:"asset", options:{max:100, type:"animation"}, defaultValue:[]}, {name:"speed", displayName:"Speed Factor", description:"Scale the animation playback speed", type:"number", options:{step:0.1}, defaultValue:1}, {name:"loop", displayName:"Loop", description:"Loop the animation back to the start on completion",
    type:"boolean", defaultValue:true}, {name:"activate", displayName:"Activate", description:"Play the configured animation on load", type:"boolean", defaultValue:true}, {name:"animations", exposed:false}, {name:"skeleton", exposed:false, readOnly:true}, {name:"model", exposed:false, readOnly:true}, {name:"prevAnim", exposed:false, readOnly:true}, {name:"currAnim", exposed:false, readOnly:true}, {name:"fromSkel", exposed:false, readOnly:true}, {name:"toSkel", exposed:false, readOnly:true}, {name:"blending",
    exposed:false, readOnly:true}, {name:"blendTime", exposed:false, readOnly:true}, {name:"blendTimeRemaining", exposed:false, readOnly:true}, {name:"playing", exposed:false, readOnly:true}];
    this.exposeProperties();
    this.on("remove", this.onRemove, this);
    this.on("update", this.onUpdate, this);
    pc.ComponentSystem.on("update", this.onUpdate, this)
  };
  AnimationComponentSystem = pc.inherits(AnimationComponentSystem, pc.ComponentSystem);
  pc.extend(AnimationComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    properties = ["activate", "loop", "speed", "assets", "enabled"];
    AnimationComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, cloneComponent:function(entity, clone) {
    var component = this.addComponent(clone, {});
    clone.animation.data.assets = pc.extend([], entity.animation.assets);
    clone.animation.data.speed = entity.animation.speed;
    clone.animation.data.loop = entity.animation.loop;
    clone.animation.data.activate = entity.animation.activate;
    clone.animation.data.enabled = entity.animation.enabled;
    clone.animation.animations = pc.extend({}, entity.animation.animations)
  }, onRemove:function(entity, data) {
    delete data.animation;
    delete data.skeleton;
    delete data.fromSkel;
    delete data.toSkel
  }, onUpdate:function(dt) {
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var component = components[id];
        var componentData = component.data;
        if(componentData.enabled && componentData.playing && component.entity.enabled) {
          var skeleton = componentData.skeleton;
          if(skeleton !== null && componentData.model !== null) {
            if(componentData.blending) {
              componentData.blendTimeRemaining -= dt;
              if(componentData.blendTimeRemaining < 0) {
                componentData.blendTimeRemaining = 0
              }
              var alpha = 1 - componentData.blendTimeRemaining / componentData.blendTime;
              skeleton.blend(componentData.fromSkel, componentData.toSkel, alpha)
            }else {
              var delta = dt * componentData.speed;
              skeleton.addTime(delta);
              if(skeleton.getCurrentTime() === skeleton.getAnimation().getDuration() && !componentData.loop) {
                componentData.playing = false
              }
            }
            if(componentData.blending && componentData.blendTimeRemaining === 0) {
              componentData.blending = false;
              skeleton.setAnimation(componentData.toSkel.getAnimation())
            }
            skeleton.updateGraph()
          }
        }
      }
    }
  }});
  return{AnimationComponentSystem:AnimationComponentSystem}
}());
pc.extend(pc, function() {
  var AnimationComponentData = function() {
    this.assets = [];
    this.speed = 1;
    this.loop = true;
    this.activate = true;
    this.enabled = true;
    this.animations = null;
    this.skeleton = null;
    this.model = null;
    this.prevAnim = null;
    this.currAnim = null;
    this.fromSkel = null;
    this.toSkel = null;
    this.blending = false;
    this.blendTime = 0;
    this.blendTimeRemaining = 0;
    this.playing = false
  };
  AnimationComponentData = pc.inherits(AnimationComponentData, pc.ComponentData);
  return{AnimationComponentData:AnimationComponentData}
}());
pc.extend(pc, function() {
  var ModelComponentSystem = function ModelComponentSystem(app) {
    this.id = "model";
    this.description = "Renders a 3D model at the location of the Entity.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.ModelComponent;
    this.DataType = pc.ModelComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enable or disable rendering of the Model", type:"boolean", defaultValue:true}, {name:"type", displayName:"Type", description:"Type of model", type:"enumeration", options:{enumerations:[{name:"Asset", value:"asset"}, {name:"Box", value:"box"}, {name:"Capsule", value:"capsule"}, {name:"Sphere", value:"sphere"}, {name:"Cylinder", value:"cylinder"}, {name:"Cone", value:"cone"}, {name:"Plane", value:"plane"}]}, defaultValue:"asset"},
    {name:"asset", displayName:"Asset", description:"Model Asset to render", type:"asset", options:{max:1, type:"model"}, defaultValue:null, filter:{type:"asset"}}, {name:"materialAsset", displayName:"Material", description:"The material of the model", type:"asset", options:{max:1, type:"material"}, defaultValue:null, filter:{type:function(value) {
      return false
    }}}, {name:"castShadows", displayName:"Cast shadows", description:"Occlude light", type:"boolean", defaultValue:false}, {name:"receiveShadows", displayName:"Receive shadows", description:"Receive shadows cast from occluders", type:"boolean", defaultValue:true}, {name:"material", exposed:false}, {name:"model", exposed:false}];
    this.exposeProperties();
    var gd = app.graphicsDevice;
    this.box = pc.createBox(gd, {halfExtents:new pc.Vec3(0.5, 0.5, 0.5)});
    this.capsule = pc.createCapsule(gd, {radius:0.5, height:2});
    this.sphere = pc.createSphere(gd, {radius:0.5});
    this.cone = pc.createCone(gd, {baseRadius:0.5, peakRadius:0, height:1});
    this.cylinder = pc.createCylinder(gd, {radius:0.5, height:1});
    this.plane = pc.createPlane(gd, {halfExtents:new pc.Vec2(0.5, 0.5), widthSegments:1, lengthSegments:1});
    this.defaultMaterial = new pc.PhongMaterial
  };
  ModelComponentSystem = pc.inherits(ModelComponentSystem, pc.ComponentSystem);
  pc.extend(ModelComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    data.material = this.defaultMaterial;
    properties = ["material", "materialAsset", "asset", "castShadows", "receiveShadows", "type", "enabled"];
    ModelComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, removeComponent:function(entity) {
    var data = entity.model.data;
    entity.model.asset = null;
    if(data.type !== "asset" && data.model) {
      this.app.scene.removeModel(data.model);
      entity.removeChild(data.model.getGraph());
      data.model = null
    }
    ModelComponentSystem._super.removeComponent.call(this, entity)
  }, cloneComponent:function(entity, clone) {
    var component = this.addComponent(clone, {});
    clone.model.data.type = entity.model.type;
    clone.model.data.materialAsset = entity.model.materialAsset;
    clone.model.data.asset = entity.model.asset;
    clone.model.data.castShadows = entity.model.castShadows;
    clone.model.data.receiveShadows = entity.model.receiveShadows;
    clone.model.data.material = entity.model.material;
    clone.model.data.enabled = entity.model.enabled;
    if(entity.model.model) {
      clone.model.model = entity.model.model.clone()
    }
  }});
  return{ModelComponentSystem:ModelComponentSystem}
}());
pc.extend(pc, function() {
  var ModelComponent = function ModelComponent(system, entity) {
    this.on("set_type", this.onSetType, this);
    this.on("set_asset", this.onSetAsset, this);
    this.on("set_castShadows", this.onSetCastShadows, this);
    this.on("set_model", this.onSetModel, this);
    this.on("set_receiveShadows", this.onSetReceiveShadows, this);
    this.on("set_material", this.onSetMaterial, this);
    Object.defineProperty(this, "materialAsset", {set:this.setMaterialAsset.bind(this), get:this.getMaterialAsset.bind(this)})
  };
  ModelComponent = pc.inherits(ModelComponent, pc.Component);
  pc.extend(ModelComponent.prototype, {setVisible:function(visible) {
    console.warn("WARNING: setVisible: Function is deprecated. Set enabled property instead.");
    this.enabled = visible
  }, loadModelAsset:function(id) {
    var options = {parent:this.entity.getRequest()};
    var asset = this.system.app.assets.getAssetById(id);
    if(!asset) {
      logERROR(pc.string.format("Trying to load model before asset {0} is loaded.", id));
      return
    }
    asset.off("change", this.onAssetChange, this);
    asset.on("change", this.onAssetChange, this);
    asset.off("remove", this.onAssetRemoved, this);
    asset.on("remove", this.onAssetRemoved, this);
    if(asset.resource) {
      var model = asset.resource.clone();
      this._onModelLoaded(model)
    }else {
      this.system.app.assets.load(asset, [], options).then(function(resources) {
        this._onModelLoaded(resources[0])
      }.bind(this))
    }
  }, _onModelLoaded:function(model) {
    if(this.system.app.designer) {
      model.generateWireframe()
    }
    if(this.data.type === "asset") {
      this.model = model
    }
  }, onSetType:function(name, oldValue, newValue) {
    var data = this.data;
    if(newValue) {
      var mesh = null;
      if(newValue === "asset") {
        if(this.data.asset !== null) {
          this.loadModelAsset(this.data.asset)
        }else {
          this.model = null
        }
      }else {
        switch(newValue) {
          case "box":
            mesh = this.system.box;
            break;
          case "capsule":
            mesh = this.system.capsule;
            break;
          case "sphere":
            mesh = this.system.sphere;
            break;
          case "cone":
            mesh = this.system.cone;
            break;
          case "cylinder":
            mesh = this.system.cylinder;
            break;
          case "plane":
            mesh = this.system.plane;
            break;
          default:
            throw new Error("Invalid model type: " + newValue);
        }
        var node = new pc.GraphNode;
        var model = new pc.Model;
        model.graph = node;
        model.meshInstances = [new pc.MeshInstance(node, mesh, data.material)];
        if(this.system.app.designer) {
          model.generateWireframe()
        }
        this.model = model;
        this.asset = null
      }
    }
  }, onSetAsset:function(name, oldValue, newValue) {
    if(oldValue) {
      var asset = this.system.app.assets.getAssetById(oldValue);
      if(asset) {
        asset.off("change", this.onAssetChange, this);
        asset.off("remove", this.onAssetRemoved, this)
      }
    }
    if(this.data.type === "asset") {
      if(newValue) {
        if(newValue instanceof pc.asset.Asset) {
          this.data.asset = newValue.id;
          this.loadModelAsset(newValue.id)
        }else {
          this.loadModelAsset(newValue)
        }
      }else {
        this.model = null
      }
    }else {
      if(!newValue) {
        this.data.asset = null
      }
    }
  }, onSetCastShadows:function(name, oldValue, newValue) {
    var model = this.data.model;
    if(model) {
      var scene = this.system.app.scene;
      var inScene = scene.containsModel(model);
      if(inScene) {
        scene.removeModel(model)
      }
      var meshInstances = model.meshInstances;
      for(var i = 0;i < meshInstances.length;i++) {
        meshInstances[i].castShadow = newValue
      }
      if(inScene) {
        scene.addModel(model)
      }
    }
  }, onSetModel:function(name, oldValue, newValue) {
    if(oldValue) {
      this.system.app.scene.removeModel(oldValue);
      this.entity.removeChild(oldValue.getGraph());
      delete oldValue._entity
    }
    if(newValue) {
      var componentData = this.data;
      var meshInstances = newValue.meshInstances;
      for(var i = 0;i < meshInstances.length;i++) {
        meshInstances[i].castShadow = componentData.castShadows;
        meshInstances[i].receiveShadow = componentData.receiveShadows
      }
      this.entity.addChild(newValue.graph);
      if(this.enabled && this.entity.enabled) {
        this.system.app.scene.addModel(newValue)
      }
      newValue._entity = this.entity;
      if(this.entity.animation) {
        this.entity.animation.setModel(newValue)
      }
    }
  }, setMaterialAsset:function(newValue) {
    var id = typeof newValue === "number" || !newValue ? newValue : newValue.id;
    var material;
    if(id !== undefined && id !== null) {
      var asset = this.system.app.assets.getAssetById(id);
      if(asset) {
        if(asset.resource) {
          material = asset.resource;
          this.material = material
        }else {
          this.system.app.assets.load(asset).then(function(materials) {
            this.material = materials[0]
          }.bind(this))
        }
      }else {
        console.error(pc.string.format("Entity '{0}' is trying to load Material Asset {1} which no longer exists. Maybe this model was once a primitive shape?", this.entity.getPath(), id))
      }
    }
    if(!material) {
      material = this.system.defaultMaterial
    }
    this.material = material;
    var oldValue = this.data.materialAsset;
    this.data.materialAsset = id;
    this.fire("set", "materialAsset", oldValue, id)
  }, getMaterialAsset:function() {
    return this.system.app.assets.getAssetById(this.data.materialAsset)
  }, onSetMaterial:function(name, oldValue, newValue) {
    if(newValue !== oldValue) {
      this.data.material = newValue;
      if(this.data.model && this.data.type !== "asset") {
        var meshInstances = this.data.model.meshInstances;
        for(var i = 0;i < meshInstances.length;i++) {
          meshInstances[i].material = newValue
        }
      }
    }
  }, onSetReceiveShadows:function(name, oldValue, newValue) {
    if(newValue !== undefined) {
      var componentData = this.data;
      if(componentData.model) {
        var meshInstances = componentData.model.meshInstances;
        for(var i = 0;i < meshInstances.length;i++) {
          meshInstances[i].receiveShadow = newValue
        }
      }
    }
  }, onEnable:function() {
    ModelComponent._super.onEnable.call(this);
    var model = this.data.model;
    if(model) {
      var inScene = this.system.app.scene.containsModel(model);
      if(!inScene) {
        this.system.app.scene.addModel(model)
      }
    }
  }, onDisable:function() {
    ModelComponent._super.onDisable.call(this);
    var model = this.data.model;
    if(model) {
      var inScene = this.system.app.scene.containsModel(model);
      if(inScene) {
        this.system.app.scene.removeModel(model)
      }
    }
  }, onAssetChange:function(asset, attribute, newValue, oldValue) {
    if(attribute === "resource" && newValue) {
      this._onModelLoaded(newValue.clone())
    }
  }, onAssetRemoved:function(asset) {
    asset.off("remove", this.onAssetRemoved, this);
    if(this.asset === asset.id) {
      this.asset = null
    }
  }});
  return{ModelComponent:ModelComponent}
}());
pc.extend(pc, function() {
  var ModelComponentData = function() {
    this.enabled = true;
    this.type = "asset";
    this.asset = null;
    this.castShadows = false;
    this.receiveShadows = true;
    this.materialAsset = null;
    this.material = null;
    this.model = null
  };
  ModelComponentData = pc.inherits(ModelComponentData, pc.ComponentData);
  return{ModelComponentData:ModelComponentData}
}());
pc.extend(pc, function() {
  var SkyboxComponentSystem = function SkyboxComponentSystem(app) {
    this.id = "skybox";
    this.description = "Renders a skybox in the scene.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.SkyboxComponent;
    this.DataType = pc.SkyboxComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enables or disables the component", type:"boolean", defaultValue:true}, {name:"posx", displayName:"POSX", description:"URL of the positive X face of skybox cubemap", type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"negx", displayName:"NEGX", description:"URL of the negative X face of skybox cubemap", type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"posy", displayName:"POSY", description:"URL of the positive Y face of skybox cubemap",
    type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"negy", displayName:"NEGY", description:"URL of the negative Y face of skybox cubemap", type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"posz", displayName:"POSZ", description:"URL of the positive Z face of skybox cubemap", type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"negz", displayName:"NEGZ", description:"URL of the negative Z face of skybox cubemap", type:"asset",
    options:{max:1, type:"texture"}, defaultValue:null}, {name:"model", exposed:false, readOnly:true}, {name:"assets", exposed:false, readOnly:true}, {name:"cubemap", exposed:false}];
    this.exposeProperties();
    this.on("remove", this.onRemove, this)
  };
  SkyboxComponentSystem = pc.inherits(SkyboxComponentSystem, pc.ComponentSystem);
  pc.extend(SkyboxComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    var properties = ["enabled", "posx", "negx", "posy", "negy", "posz", "negz", "cubemap"];
    SkyboxComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, onRemove:function(entity, data) {
    if(data.model) {
      this.app.scene.removeModel(data.model);
      entity.removeChild(data.model.getGraph());
      data.model = null
    }
  }});
  return{SkyboxComponentSystem:SkyboxComponentSystem}
}());
pc.extend(pc, function() {
  var SkyboxComponent = function SkyboxComponent(system, entity) {
    this.on("set", this.onSet, this)
  };
  SkyboxComponent = pc.inherits(SkyboxComponent, pc.Component);
  pc.extend(SkyboxComponent.prototype, {onSet:function(name, oldValue, newValue) {
    if(name == "cubemap" && newValue) {
      this.data.model = _createSkyboxFromCubemap(this.entity, this.system.app, newValue);
      if(this.enabled && this.entity.enabled) {
        this.system.app.scene.addModel(this.data.model);
        this.entity.addChild(this.data.model.graph)
      }
      return
    }
    function _loadTextureAsset(name, id) {
      if(id === undefined || id === null) {
        return
      }
      var index = CUBE_MAP_NAMES.indexOf(name);
      var assets = this.entity.skybox.assets;
      this.data.model = null;
      assets[index] = this.system.app.assets.getAssetById(id);
      if(!assets[index]) {
        logERROR(pc.string.format("Trying to load skybox component before asset {0} has loaded", id));
        return
      }
      this.data.assets = assets;
      if(assets[0] && assets[1] && assets[2] && assets[3] && assets[4] && assets[5]) {
        this.data.model = _createSkybox(this.entity, this.system.app, assets);
        if(this.enabled && this.entity.enabled) {
          this.system.app.scene.addModel(this.data.model);
          this.entity.addChild(this.data.model.graph)
        }
      }
    }
    var functions = {"posx":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }, "negx":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }, "posy":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }, "negy":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }, "posz":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }, "negz":function(entity, name, oldValue, newValue) {
      _loadTextureAsset.call(this, name, newValue)
    }};
    if(functions[name]) {
      functions[name].call(this, this.entity, name, oldValue, newValue)
    }
  }, onEnable:function() {
    SkyboxComponent._super.onEnable.call(this);
    if(this.data.model) {
      if(!this.system.app.scene.containsModel(this.data.model)) {
        this.system.app.scene.addModel(this.data.model);
        this.entity.addChild(this.data.model.graph)
      }
    }
  }, onDisable:function() {
    SkyboxComponent._super.onDisable.call(this);
    if(this.data.model) {
      if(this.system.app.scene.containsModel(this.data.model)) {
        this.entity.removeChild(this.data.model.graph);
        this.system.app.scene.removeModel(this.data.model)
      }
    }
  }});
  var _createSkybox = function(entity, app, assets) {
    var gd = app.graphicsDevice;
    var sources = [];
    var requests = [];
    var indexes = [];
    var image;
    for(var i = 0;i < assets.length;i++) {
      var asset = assets[i];
      if(!asset) {
        logERROR(pc.string.format("Trying to load skybox component before assets are loaded"));
        return
      }else {
        if(asset.resource) {
          image = asset.resource.getSource();
          if(!image) {
            logERROR(pc.string.format("Trying to load skybox component with invalid texture types"));
            return
          }
          sources.push(image)
        }else {
          indexes.push(i);
          requests.push(new pc.resources.TextureRequest(asset.getFileUrl()))
        }
      }
    }
    var texture = new pc.Texture(gd, {format:pc.PIXELFORMAT_R8_G8_B8, cubemap:true});
    texture.minFilter = pc.FILTER_LINEAR_MIPMAP_LINEAR;
    texture.magFilter = pc.FILTER_LINEAR;
    texture.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    texture.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    if(requests.length) {
      var options = {parent:entity.getRequest()};
      app.loader.request(requests, options).then(function(resources) {
        for(var i = 0;i < resources.length;i++) {
          sources[indexes[i]] = resources[i].getSource()
        }
        texture.setSource(sources)
      })
    }else {
      texture.setSource(sources)
    }
    var material = new pc.Material;
    material.updateShader = function() {
      var library = gd.getProgramLibrary();
      var shader = library.getProgram("skybox", {hdr:false, gamma:app.scene.gammaCorrection, toneMapping:app.scene.toneMapping});
      this.setShader(shader)
    };
    material.updateShader();
    material.setParameter("texture_cubeMap", texture);
    material.cull = pc.CULLFACE_NONE;
    var node = new pc.GraphNode;
    var mesh = pc.createBox(gd);
    var meshInstance = new pc.MeshInstance(node, mesh, material);
    var model = new pc.Model;
    model.graph = node;
    model.meshInstances = [meshInstance];
    return model
  };
  var _createSkyboxFromCubemap = function(entity, app, cubemap) {
    var gd = app.graphicsDevice;
    var material = new pc.Material;
    material.updateShader = function() {
      var library = gd.getProgramLibrary();
      var shader = library.getProgram("skybox", {hdr:cubemap.hdr, prefiltered:true, gamma:app.scene.gammaCorrection, toneMapping:app.scene.toneMapping});
      this.setShader(shader)
    };
    material.updateShader();
    material.setParameter("texture_cubeMap", cubemap);
    material.cull = pc.CULLFACE_NONE;
    var node = new pc.GraphNode;
    var mesh = pc.createBox(gd);
    var meshInstance = new pc.MeshInstance(node, mesh, material);
    var model = new pc.Model;
    model.graph = node;
    model.meshInstances = [meshInstance];
    return model
  };
  var CUBE_MAP_NAMES = ["posx", "negx", "posy", "negy", "posz", "negz"];
  return{SkyboxComponent:SkyboxComponent}
}());
pc.extend(pc, function() {
  var SkyboxComponentData = function() {
    this.enabled = true;
    this.posx = null;
    this.negx = null;
    this.posy = null;
    this.negy = null;
    this.posz = null;
    this.negz = null;
    this.assets = [];
    this.model = null
  };
  SkyboxComponentData = pc.inherits(SkyboxComponentData, pc.ComponentData);
  return{SkyboxComponentData:SkyboxComponentData}
}());
pc.extend(pc, function() {
  var REMOTE_CAMERA_NEAR_CLIP = 0.5;
  var REMOTE_CAMERA_FAR_CLIP = 2;
  var CameraComponentSystem = function(app) {
    this.id = "camera";
    this.description = "Renders the scene from the location of the Entity.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.CameraComponent;
    this.DataType = pc.CameraComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enable or disable the component", type:"boolean", defaultValue:true}, {name:"clearColorBuffer", displayName:"Clear Color Buffer", description:"Clear color buffer", type:"boolean", defaultValue:true}, {name:"clearColor", displayName:"Clear Color", description:"Clear Color", type:"rgba", defaultValue:[0.7294117647058823, 0.7294117647058823, 0.6941176470588235, 1], filter:{clearColorBuffer:true}}, {name:"clearDepthBuffer", displayName:"Clear Depth Buffer",
    description:"Clear depth buffer", type:"boolean", defaultValue:true}, {name:"frustumCulling", displayName:"Frustum culling", type:"boolean", defaultValue:false, exposed:false}, {name:"projection", displayName:"Projection", description:"Projection type of camera", type:"enumeration", options:{enumerations:[{name:"Perspective", value:0}, {name:"Orthographic", value:1}]}, defaultValue:0}, {name:"fov", displayName:"Field of View", description:"Field of view in Y axis", type:"number", defaultValue:45,
    options:{min:0, max:90}, filter:{projection:0}}, {name:"orthoHeight", displayName:"Ortho Height", description:"View window half extent of camera in Y axis", type:"number", defaultValue:100, filter:{projection:1}}, {name:"nearClip", displayName:"Near Clip", description:"Near clipping distance", type:"number", defaultValue:0.3, options:{min:1E-4, decimalPrecision:5}}, {name:"farClip", displayName:"Far Clip", description:"Far clipping distance", type:"number", defaultValue:1E3, options:{min:1E-4,
    decimalPrecision:5}}, {name:"priority", displayName:"Priority", description:"Controls which camera will be rendered first. Smaller numbers are rendered first.", type:"number", defaultValue:0}, {name:"rect", displayName:"Viewport", description:"Controls where on the screen the camera will be rendered in normalized coordinates.", type:"vector", defaultValue:[0, 0, 1, 1]}, {name:"camera", exposed:false}, {name:"aspectRatio", exposed:false}, {name:"model", exposed:false}, {name:"renderTarget", exposed:false}];
    this.exposeProperties();
    this.cameras = [];
    this.on("beforeremove", this.onBeforeRemove, this);
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("toolsUpdate", this.toolsUpdate, this)
  };
  CameraComponentSystem = pc.inherits(CameraComponentSystem, pc.ComponentSystem);
  pc.extend(CameraComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    data = data || {};
    if(data.clearColor && pc.type(data.clearColor) === "array") {
      var c = data.clearColor;
      data.clearColor = new pc.Color(c[0], c[1], c[2], c[3])
    }
    if(data.rect && pc.type(data.rect) === "array") {
      var rect = data.rect;
      data.rect = new pc.Vec4(rect[0], rect[1], rect[2], rect[3])
    }
    if(data.activate) {
      console.warn("WARNING: activate: Property is deprecated. Set enabled property instead.");
      data.enabled = data.activate
    }
    data.camera = new pc.Camera;
    data._node = component.entity;
    data.postEffects = new pc.PostEffectQueue(this.app, component);
    if(this.app.designer && this.displayInTools(component.entity)) {
      var material = new pc.BasicMaterial;
      material.color = new pc.Color(1, 1, 0, 1);
      material.update();
      var indexBuffer = new pc.IndexBuffer(this.app.graphicsDevice, pc.INDEXFORMAT_UINT8, 24);
      var indices = new Uint8Array(indexBuffer.lock());
      indices.set([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]);
      indexBuffer.unlock();
      var format = new pc.VertexFormat(this.app.graphicsDevice, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
      var vertexBuffer = new pc.VertexBuffer(this.app.graphicsDevice, format, 8, pc.BUFFER_DYNAMIC);
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffer;
      mesh.indexBuffer[0] = indexBuffer;
      mesh.primitive[0].type = pc.PRIMITIVE_LINES;
      mesh.primitive[0].base = 0;
      mesh.primitive[0].count = indexBuffer.getNumIndices();
      mesh.primitive[0].indexed = true;
      var model = new pc.Model;
      model.graph = component.entity;
      model.meshInstances = [new pc.MeshInstance(model.graph, mesh, material)];
      this.app.scene.addModel(model);
      data.model = model
    }
    properties = ["postEffects", "enabled", "model", "camera", "aspectRatio", "renderTarget", "clearColor", "fov", "orthoHeight", "nearClip", "farClip", "projection", "priority", "clearColorBuffer", "clearDepthBuffer", "frustumCulling", "rect"];
    CameraComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, onBeforeRemove:function(entity, component) {
    this.removeCamera(component)
  }, onRemove:function(entity, data) {
    if(this.app.designer && this.displayInTools(entity)) {
      if(this.app.scene.containsModel(data.model)) {
        this.app.scene.removeModel(data.model)
      }
    }
    data.camera = null
  }, toolsUpdate:function(fn) {
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var entity = components[id].entity;
        var data = components[id].data;
        if(this.displayInTools(entity)) {
          this._updateGfx(entity.camera)
        }
      }
    }
  }, _updateGfx:function(component) {
    if(component.model && component.model.meshInstances.length) {
      var vertexBuffer = component.model.meshInstances[0].mesh.vertexBuffer;
      var aspectRatio = component.camera.getAspectRatio();
      var nearClip = this.isToolsCamera(component.entity) ? REMOTE_CAMERA_NEAR_CLIP : component.nearClip;
      var farClip = this.isToolsCamera(component.entity) ? REMOTE_CAMERA_FAR_CLIP : component.farClip;
      var fov = component.fov * Math.PI / 180;
      var projection = component.projection;
      var x, y;
      if(projection === pc.PROJECTION_PERSPECTIVE) {
        y = Math.tan(fov / 2) * nearClip
      }else {
        y = component.camera.getOrthoHeight()
      }
      x = y * aspectRatio;
      var positions = new Float32Array(vertexBuffer.lock());
      positions[0] = x;
      positions[1] = -y;
      positions[2] = -nearClip;
      positions[3] = x;
      positions[4] = y;
      positions[5] = -nearClip;
      positions[6] = -x;
      positions[7] = y;
      positions[8] = -nearClip;
      positions[9] = -x;
      positions[10] = -y;
      positions[11] = -nearClip;
      if(projection === pc.PROJECTION_PERSPECTIVE) {
        y = Math.tan(fov / 2) * farClip;
        x = y * aspectRatio
      }
      positions[12] = x;
      positions[13] = -y;
      positions[14] = -farClip;
      positions[15] = x;
      positions[16] = y;
      positions[17] = -farClip;
      positions[18] = -x;
      positions[19] = y;
      positions[20] = -farClip;
      positions[21] = -x;
      positions[22] = -y;
      positions[23] = -farClip;
      vertexBuffer.unlock()
    }
  }, addCamera:function(camera) {
    this.cameras.push(camera);
    this.sortCamerasByPriority();
    if(this.app.designer) {
      var model = camera.data.model;
      if(model) {
        var scene = this.app.scene;
        if(!scene.containsModel(model)) {
          scene.addModel(model)
        }
      }
    }
  }, removeCamera:function(camera) {
    var index = this.cameras.indexOf(camera);
    if(index >= 0) {
      this.cameras.splice(index, 1);
      this.sortCamerasByPriority();
      if(this.app.designer) {
        var model = camera.data.model;
        if(model) {
          this.app.scene.removeModel(model)
        }
      }
    }
  }, sortCamerasByPriority:function() {
    this.cameras.sort(function(a, b) {
      return a.priority - b.priority
    })
  }, isToolsCamera:function(entity) {
    return entity.hasLabel("pc:designer")
  }, displayInTools:function(entity) {
    return!this.isToolsCamera(entity) || entity.getName() === "Perspective"
  }});
  return{CameraComponentSystem:CameraComponentSystem}
}());
pc.extend(pc, function() {
  var CameraComponent = function CameraComponent(system, entity) {
    this.on("set_aspectRatio", this.onSetAspectRatio, this);
    this.on("set_camera", this.onSetCamera, this);
    this.on("set_clearColor", this.onSetClearColor, this);
    this.on("set_fov", this.onSetFov, this);
    this.on("set_orthoHeight", this.onSetOrthoHeight, this);
    this.on("set_nearClip", this.onSetNearClip, this);
    this.on("set_farClip", this.onSetFarClip, this);
    this.on("set_projection", this.onSetProjection, this);
    this.on("set_priority", this.onSetPriority, this);
    this.on("set_clearColorBuffer", this.updateClearFlags, this);
    this.on("set_clearDepthBuffer", this.updateClearFlags, this);
    this.on("set_renderTarget", this.onSetRenderTarget, this);
    this.on("set_rect", this.onSetRect, this);
    this.on("set_frustumCulling", this.onSetFrustumCulling, this)
  };
  CameraComponent = pc.inherits(CameraComponent, pc.Component);
  Object.defineProperty(CameraComponent.prototype, "activate", {get:function() {
    console.warn("WARNING: activate: Property is deprecated. Query enabled property instead.");
    return this.enabled
  }, set:function(value) {
    console.warn("WARNING: activate: Property is deprecated. Set enabled property instead.");
    this.enabled = value
  }});
  Object.defineProperty(CameraComponent.prototype, "projectionMatrix", {get:function() {
    return this.data.camera.getProjectionMatrix()
  }});
  Object.defineProperty(CameraComponent.prototype, "viewMatrix", {get:function() {
    var wtm = this.data.camera._node.getWorldTransform();
    return wtm.clone().invert()
  }});
  Object.defineProperty(CameraComponent.prototype, "frustum", {get:function() {
    return this.data.camera.getFrustum()
  }});
  pc.extend(CameraComponent.prototype, {screenToWorld:function(screenx, screeny, cameraz, worldCoord) {
    var device = this.system.app.graphicsDevice;
    var width = parseInt(device.canvas.clientWidth);
    var height = parseInt(device.canvas.clientHeight);
    return this.data.camera.screenToWorld(screenx, screeny, cameraz, width, height, worldCoord)
  }, worldToScreen:function(worldCoord, screenCoord) {
    var device = this.system.app.graphicsDevice;
    var width = parseInt(device.canvas.clientWidth);
    var height = parseInt(device.canvas.clientHeight);
    return this.data.camera.worldToScreen(worldCoord, width, height, screenCoord)
  }, onSetAspectRatio:function(name, oldValue, newValue) {
    this.data.camera.setAspectRatio(newValue)
  }, onSetCamera:function(name, oldValue, newValue) {
    if(oldValue) {
      oldValue._node = null
    }
    newValue._node = this.entity
  }, onSetClearColor:function(name, oldValue, newValue) {
    var clearOptions = this.data.camera.getClearOptions();
    clearOptions.color[0] = newValue.r;
    clearOptions.color[1] = newValue.g;
    clearOptions.color[2] = newValue.b;
    clearOptions.color[3] = newValue.a
  }, onSetFov:function(name, oldValue, newValue) {
    this.data.camera.setFov(newValue)
  }, onSetOrthoHeight:function(name, oldValue, newValue) {
    this.data.camera.setOrthoHeight(newValue)
  }, onSetNearClip:function(name, oldValue, newValue) {
    this.data.camera.setNearClip(newValue)
  }, onSetFarClip:function(name, oldValue, newValue) {
    this.data.camera.setFarClip(newValue)
  }, onSetFrustumCulling:function(name, oldValue, newValue) {
    this.data.camera.frustumCulling = newValue
  }, onSetProjection:function(name, oldValue, newValue) {
    this.data.camera.setProjection(newValue)
  }, onSetPriority:function(name, oldValue, newValue) {
    this.system.sortCamerasByPriority()
  }, updateClearFlags:function() {
    var clearOptions = this.data.camera.getClearOptions();
    var flags = 0;
    if(this.clearColorBuffer) {
      flags = flags | pc.CLEARFLAG_COLOR
    }
    if(this.clearDepthBuffer) {
      flags = flags | pc.CLEARFLAG_DEPTH
    }
    clearOptions.flags = flags
  }, onSetRenderTarget:function(name, oldValue, newValue) {
    this.data.camera.setRenderTarget(newValue)
  }, onSetRect:function(name, oldValue, newValue) {
    this.data.camera.setRect(newValue.data[0], newValue.data[1], newValue.data[2], newValue.data[3]);
    this._resetAspectRatio()
  }, onEnable:function() {
    CameraComponent._super.onEnable.call(this);
    this.system.addCamera(this);
    this.postEffects.enable()
  }, onDisable:function() {
    CameraComponent._super.onDisable.call(this);
    this.postEffects.disable();
    this.system.removeCamera(this)
  }, _resetAspectRatio:function() {
    var camera = this.camera;
    if(camera) {
      var device = this.system.app.graphicsDevice;
      var rect = this.rect;
      var aspect = device.width * rect.z / (device.height * rect.w);
      if(aspect !== camera.getAspectRatio()) {
        camera.setAspectRatio(aspect)
      }
    }
  }, frameBegin:function() {
    this._resetAspectRatio();
    this.data.isRendering = true
  }, frameEnd:function() {
    this.data.isRendering = false
  }});
  return{CameraComponent:CameraComponent}
}());
pc.extend(pc, function() {
  CameraComponentData = function() {
    this.clearColor = new pc.Color(0.729411780834198, 0.729411780834198, 0.6941176652908325, 1);
    this.clearColorBuffer = true;
    this.clearDepthBuffer = true;
    this.nearClip = 0.1;
    this.farClip = 1E3;
    this.fov = 45;
    this.orthoHeight = 100;
    this.projection = pc.PROJECTION_PERSPECTIVE;
    this.priority = 0;
    this.rect = new pc.Vec4(0, 0, 1, 1);
    this.enabled = true;
    this.frustumCulling = false;
    this.camera = null;
    this.aspectRatio = 16 / 9;
    this.renderTarget = null;
    this.postEffects = null;
    this.isRendering = false
  };
  CameraComponentData = pc.inherits(CameraComponentData, pc.ComponentData);
  return{CameraComponentData:CameraComponentData}
}());
pc.extend(pc, function() {
  var LightComponentSystem = function(app) {
    this.id = "light";
    this.description = "Enables the Entity to emit light.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.LightComponent;
    this.DataType = pc.LightComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enable or disable the light", type:"boolean", defaultValue:true}, {name:"type", displayName:"Type", description:"The type of the light", type:"enumeration", options:{enumerations:[{name:"Directional", value:"directional"}, {name:"Point", value:"point"}, {name:"Spot", value:"spot"}]}, defaultValue:"directional"}, {name:"color", displayName:"Color", description:"Light Color", type:"rgb", defaultValue:[1, 1, 1]}, {name:"intensity",
    displayName:"Intensity", description:"The intensity of the light", type:"number", defaultValue:1, options:{min:0, max:10, step:0.05}}, {name:"castShadows", displayName:"Cast Shadows", description:"Cast shadows from this light", type:"boolean", defaultValue:false}, {name:"shadowDistance", displayName:"Shadow Distance", description:"Camera distance at which shadows are no longer rendered", type:"number", options:{min:0, decimalPrecision:5}, defaultValue:40, filter:{castShadows:true, type:"directional"}},
    {name:"shadowResolution", displayName:"Shadow Resolution", description:"Resolution of shadowmap generated by this light", type:"enumeration", options:{enumerations:[{name:"128", value:128}, {name:"256", value:256}, {name:"512", value:512}, {name:"1024", value:1024}, {name:"2048", value:2048}]}, defaultValue:1024, filter:{castShadows:true}}, {name:"shadowBias", displayName:"Shadow Bias", description:"Tunes the shadows to reduce rendering artifacts", type:"number", options:{min:0, max:1, decimalPrecision:5,
    step:0.01}, defaultValue:0.05, filter:{castShadows:true}}, {name:"normalOffsetBias", displayName:"Normal Offset Shadow Bias", description:"Tunes the shadows to reduce rendering artifacts", type:"number", options:{min:0, max:1, decimalPrecision:5, step:0.01}, defaultValue:0, filter:{castShadows:true}}, {name:"range", displayName:"Range", description:"The distance from the light where its contribution falls to zero", type:"number", defaultValue:10, options:{min:0}, filter:{type:["point", "spot"]}},
    {name:"falloffMode", displayName:"Falloff mode", description:"Controls the rate at which a light attentuates from its position", type:"enumeration", options:{enumerations:[{name:"Linear", value:pc.LIGHTFALLOFF_LINEAR}, {name:"Inverse squared", value:pc.LIGHTFALLOFF_INVERSESQUARED}]}, defaultValue:0, filter:{type:["point", "spot"]}}, {name:"shadowType", exposed:false}, {name:"shadowUpdateMode", exposed:false}, {name:"mask", displayName:"Mask", description:"Bit mask", type:"number", defaultValue:1,
    exposed:false}, {name:"innerConeAngle", displayName:"Inner Cone Angle", description:"Spotlight inner cone angle", type:"number", defaultValue:40, options:{min:0, max:90}, filter:{type:"spot"}}, {name:"outerConeAngle", displayName:"Outer Cone Angle", description:"Spotlight outer cone angle", type:"number", defaultValue:45, options:{min:0, max:90}, filter:{type:"spot"}}, {name:"light", exposed:false}, {name:"model", exposed:false}];
    this.exposeProperties();
    this.implementations = {};
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("toolsUpdate", this.toolsUpdate, this)
  };
  LightComponentSystem = pc.inherits(LightComponentSystem, pc.ComponentSystem);
  pc.extend(LightComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    if(!data.type) {
      data.type = component.data.type
    }
    component.data.type = data.type;
    if(data.color && pc.type(data.color) === "array") {
      data.color = new pc.Color(data.color[0], data.color[1], data.color[2])
    }
    if(data.enable) {
      console.warn("WARNING: enable: Property is deprecated. Set enabled property instead.");
      data.enabled = data.enable
    }
    var implementation = this._createImplementation(data.type);
    implementation.initialize(component, data);
    properties = ["type", "light", "model", "enabled", "color", "intensity", "range", "falloffMode", "innerConeAngle", "outerConeAngle", "castShadows", "shadowDistance", "shadowResolution", "shadowUpdateMode", "shadowBias", "normalOffsetBias"];
    LightComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, _createImplementation:function(type) {
    var implementation = this.implementations[type];
    if(!implementation) {
      switch(type) {
        case "directional":
          implementation = new DirectionalLightImplementation(this);
          break;
        case "point":
          implementation = new PointLightImplementation(this);
          break;
        case "spot":
          implementation = new SpotLightImplementation(this);
          break;
        default:
          throw new Error("Invalid light type: " + type);
      }
      this.implementations[type] = implementation
    }
    return implementation
  }, onRemove:function(entity, data) {
    this.implementations[data.type].remove(entity, data)
  }, cloneComponent:function(entity, clone) {
    var light = entity.light;
    var data = {type:light.type, enabled:light.enabled, color:[light.color.r, light.color.g, light.color.b], intensity:light.intensity, range:light.range, innerConeAngle:light.innerConeAngle, outerConeAngle:light.outerConeAngle, castShadows:light.castShadows, shadowDistance:light.shadowDistance, shadowResolution:light.shadowResolution, falloffMode:light.falloffMode, shadowUpdateMode:light.shadowUpdateMode, shadowBias:light.shadowBias, normalOffsetBias:light.normalOffsetBias};
    this.addComponent(clone, data)
  }, toolsUpdate:function(fn) {
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var entity = components[id].entity;
        var componentData = components[id].data;
        var implementation = this.implementations[componentData.type];
        if(implementation) {
          implementation.toolsUpdate(componentData)
        }
      }
    }
  }, changeType:function(component, oldType, newType) {
    this.implementations[oldType].remove(component.entity, component.data);
    this._createImplementation(newType).initialize(component, component.data)
  }});
  LightComponentImplementation = function(system) {
    this.system = system
  };
  LightComponentImplementation.prototype = {initialize:function(component, data) {
    var light = new pc.Light;
    light.setType(this._getLightType());
    light._node = component.entity;
    var app = this.system.app;
    app.scene.addLight(light);
    this._createDebugShape(component, data, light)
  }, _getLightType:function() {
    return undefined
  }, _createDebugShape:function(component, data, light) {
    var app = this.system.app;
    data = data || {};
    data.light = light;
    if(app.designer) {
      this.mesh = this._createDebugMesh();
      if(!this.material) {
        this.material = this._createDebugMaterial()
      }
      var model = new pc.Model;
      model.graph = component.entity;
      model.meshInstances = [new pc.MeshInstance(component.entity, this.mesh, this.material)];
      data.model = model
    }
  }, _createDebugMesh:function() {
    return undefined
  }, _createDebugMaterial:function() {
    return undefined
  }, remove:function(entity, data) {
    var app = this.system.app;
    app.scene.removeModel(data.model);
    delete data.model;
    app.scene.removeLight(data.light);
    if(app.designer) {
      app.scene.removeModel(data.model);
      delete data.model
    }
  }, toolsUpdate:function(data) {
  }};
  DirectionalLightImplementation = function(system) {
  };
  DirectionalLightImplementation = pc.inherits(DirectionalLightImplementation, LightComponentImplementation);
  DirectionalLightImplementation.prototype = pc.extend(DirectionalLightImplementation.prototype, {_getLightType:function() {
    return pc.LIGHTTYPE_DIRECTIONAL
  }, _createDebugMesh:function() {
    if(this.mesh) {
      return this.mesh
    }
    var app = this.system.app;
    var format = new pc.VertexFormat(app.graphicsDevice, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
    vertexData = [0, 0, 0, 0, -8, 0, -0.5, -8, 0, 0.5, -8, 0, 0.5, -8, 0, 0, -10, 0, 0, -10, 0, -0.5, -8, 0, 0, 0, -2, 0, -8, -2, -0.25, -8, -2, 0.25, -8, -2, 0.25, -8, -2, 0, -10, -2, 0, -10, -2, -0.25, -8, -2, 0, 0, 2, 0, -8, 2, -0.25, -8, 2, 0.25, -8, 2, 0.25, -8, 2, 0, -10, 2, 0, -10, 2, -0.25, -8, 2];
    var rot = (new pc.Mat4).setFromAxisAngle(pc.Vec3.UP, 120);
    var i;
    for(i = 0;i < 24;i++) {
      var pos = new pc.Vec3(vertexData[(i + 8) * 3], vertexData[(i + 8) * 3 + 1], vertexData[(i + 8) * 3 + 2]);
      var posRot = rot.transformPoint(pos, pos);
      vertexData[(i + 24) * 3] = posRot[0];
      vertexData[(i + 24) * 3 + 1] = posRot[1];
      vertexData[(i + 24) * 3 + 2] = posRot[2]
    }
    var vertexBuffer = new pc.VertexBuffer(app.graphicsDevice, format, 32);
    var positions = new Float32Array(vertexBuffer.lock());
    for(i = 0;i < vertexData.length;i++) {
      positions[i] = vertexData[i]
    }
    vertexBuffer.unlock();
    var mesh = new pc.Mesh;
    mesh.vertexBuffer = vertexBuffer;
    mesh.indexBuffer[0] = null;
    mesh.primitive[0].type = pc.PRIMITIVE_LINES;
    mesh.primitive[0].base = 0;
    mesh.primitive[0].count = vertexBuffer.getNumVertices();
    mesh.primitive[0].indexed = false;
    return mesh
  }, _createDebugMaterial:function() {
    var material = new pc.BasicMaterial;
    material.color = new pc.Color(1, 1, 0, 1);
    material.update();
    return material
  }});
  PointLightImplementation = function(system) {
  };
  PointLightImplementation = pc.inherits(PointLightImplementation, LightComponentImplementation);
  PointLightImplementation.prototype = pc.extend(PointLightImplementation.prototype, {_getLightType:function() {
    return pc.LIGHTTYPE_POINT
  }, _createDebugMesh:function() {
    if(this.mesh) {
      return this.mesh
    }
    var app = this.system.app;
    return pc.createSphere(app.graphicsDevice, {radius:0.1})
  }, _createDebugMaterial:function() {
    var material = new pc.BasicMaterial;
    material.color = new pc.Color(1, 1, 0, 1);
    material.update();
    return material
  }});
  SpotLightImplementation = function(system) {
  };
  SpotLightImplementation = pc.inherits(SpotLightImplementation, LightComponentImplementation);
  SpotLightImplementation.prototype = pc.extend(SpotLightImplementation.prototype, {_getLightType:function() {
    return pc.LIGHTTYPE_SPOT
  }, _createDebugMesh:function() {
    var app = this.system.app;
    var indexBuffer = this.indexBuffer;
    if(!indexBuffer) {
      var indexBuffer = new pc.IndexBuffer(app.graphicsDevice, pc.INDEXFORMAT_UINT8, 88);
      var inds = new Uint8Array(indexBuffer.lock());
      inds[0] = 0;
      inds[1] = 1;
      inds[2] = 0;
      inds[3] = 11;
      inds[4] = 0;
      inds[5] = 21;
      inds[6] = 0;
      inds[7] = 31;
      for(var i = 0;i < 40;i++) {
        inds[8 + i * 2 + 0] = i + 1;
        inds[8 + i * 2 + 1] = i + 2
      }
      indexBuffer.unlock();
      this.indexBuffer = indexBuffer
    }
    var vertexFormat = new pc.VertexFormat(app.graphicsDevice, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
    var vertexBuffer = new pc.VertexBuffer(app.graphicsDevice, vertexFormat, 42, pc.BUFFER_DYNAMIC);
    var mesh = new pc.Mesh;
    mesh.vertexBuffer = vertexBuffer;
    mesh.indexBuffer[0] = indexBuffer;
    mesh.primitive[0].type = pc.PRIMITIVE_LINES;
    mesh.primitive[0].base = 0;
    mesh.primitive[0].count = indexBuffer.getNumIndices();
    mesh.primitive[0].indexed = true;
    return mesh
  }, _createDebugMaterial:function() {
    return new pc.BasicMaterial
  }, toolsUpdate:function(data) {
    var model = data.model;
    var meshInstance = model.meshInstances[0];
    var vertexBuffer = meshInstance.mesh.vertexBuffer;
    var oca = Math.PI * data.outerConeAngle / 180;
    var ae = data.range;
    var y = -ae * Math.cos(oca);
    var r = ae * Math.sin(oca);
    var positions = new Float32Array(vertexBuffer.lock());
    positions[0] = 0;
    positions[1] = 0;
    positions[2] = 0;
    var numVerts = vertexBuffer.getNumVertices();
    for(var i = 0;i < numVerts - 1;i++) {
      var theta = 2 * Math.PI * (i / (numVerts - 2));
      var x = r * Math.cos(theta);
      var z = r * Math.sin(theta);
      positions[(i + 1) * 3 + 0] = x;
      positions[(i + 1) * 3 + 1] = y;
      positions[(i + 1) * 3 + 2] = z
    }
    vertexBuffer.unlock()
  }});
  return{LightComponentSystem:LightComponentSystem}
}());
pc.extend(pc, function() {
  var LightComponent = function LightComponent(system, entity) {
    this.on("set_type", this.onSetType, this);
    this.on("set_color", this.onSetColor, this);
    this.on("set_intensity", this.onSetIntensity, this);
    this.on("set_castShadows", this.onSetCastShadows, this);
    this.on("set_shadowDistance", this.onSetShadowDistance, this);
    this.on("set_shadowResolution", this.onSetShadowResolution, this);
    this.on("set_shadowBias", this.onSetShadowBias, this);
    this.on("set_normalOffsetBias", this.onSetNormalOffsetBias, this);
    this.on("set_range", this.onSetRange, this);
    this.on("set_innerConeAngle", this.onSetInnerConeAngle, this);
    this.on("set_outerConeAngle", this.onSetOuterConeAngle, this);
    this.on("set_falloffMode", this.onSetFalloffMode, this);
    this.on("set_shadowType", this.onSetShadowType, this);
    this.on("set_shadowUpdateMode", this.onSetShadowUpdateMode, this);
    this.on("set_mask", this.onSetMask, this)
  };
  LightComponent = pc.inherits(LightComponent, pc.Component);
  Object.defineProperty(LightComponent.prototype, "enable", {get:function() {
    console.warn("WARNING: enable: Property is deprecated. Query enabled property instead.");
    return this.enabled
  }, set:function(value) {
    console.warn("WARNING: enable: Property is deprecated. Set enabled property instead.");
    this.enabled = value
  }});
  pc.extend(LightComponent.prototype, {onSetType:function(name, oldValue, newValue) {
    if(oldValue !== newValue) {
      this.system.changeType(this, oldValue, newValue);
      this.refreshProperties()
    }
  }, refreshProperties:function() {
    this.onSetCastShadows("castShadows", this.castShadows, this.castShadows);
    this.onSetColor("color", this.color, this.color);
    this.onSetIntensity("intensity", this.intensity, this.intensity);
    this.onSetShadowDistance("shadowDistance", this.shadowDistance, this.shadowDistance);
    this.onSetShadowResolution("shadowResolution", this.shadowResolution, this.shadowResolution);
    this.onSetShadowBias("shadowBias", this.shadowBias, this.shadowBias);
    this.onSetNormalOffsetBias("normalOffsetBias", this.normalOffsetBias, this.normalOffsetBias);
    this.onSetRange("range", this.range, this.range);
    this.onSetInnerConeAngle("innerConeAngle", this.innerConeAngle, this.innerConeAngle);
    this.onSetOuterConeAngle("outerConeAngle", this.outerConeAngle, this.outerConeAngle);
    this.onSetFalloffMode("falloffMode", this.falloffMode, this.falloffMode);
    this.onSetShadowType("shadowType", this.shadowType, this.shadowType);
    this.onSetShadowUpdateMode("shadowUpdateMode", this.shadowUpdateMode, this.shadowUpdateMode);
    this.onSetMask("mask", this.mask, this.mask);
    if(this.enabled && this.entity.enabled) {
      this.onEnable()
    }
  }, updateShadow:function() {
    this.light.updateShadow()
  }, onSetCastShadows:function(name, oldValue, newValue) {
    this.light.setCastShadows(newValue)
  }, onSetColor:function(name, oldValue, newValue) {
    this.light.setColor(newValue)
  }, onSetIntensity:function(name, oldValue, newValue) {
    this.light.setIntensity(newValue)
  }, onSetShadowDistance:function(name, oldValue, newValue) {
    if(this.data.type === "directional") {
      this.light.setShadowDistance(newValue)
    }
  }, onSetShadowResolution:function(name, oldValue, newValue) {
    this.light.setShadowResolution(newValue)
  }, onSetShadowBias:function(name, oldValue, newValue) {
    this.light.setShadowBias(-0.01 * newValue)
  }, onSetNormalOffsetBias:function(name, oldValue, newValue) {
    this.light.setNormalOffsetBias(newValue)
  }, onSetRange:function(name, oldValue, newValue) {
    if(this.data.type === "point" || this.data.type === "spot") {
      this.light.setAttenuationEnd(newValue)
    }
  }, onSetInnerConeAngle:function(name, oldValue, newValue) {
    if(this.data.type === "spot") {
      this.light.setInnerConeAngle(newValue)
    }
  }, onSetOuterConeAngle:function(name, oldValue, newValue) {
    if(this.data.type === "spot") {
      this.light.setOuterConeAngle(newValue)
    }
  }, onSetFalloffMode:function(name, oldValue, newValue) {
    if(this.data.type === "point" || this.data.type === "spot") {
      this.light.setFalloffMode(newValue)
    }
  }, onSetShadowType:function(name, oldValue, newValue) {
    this.light.setShadowType(newValue)
  }, onSetShadowUpdateMode:function(name, oldValue, newValue) {
    this.light.shadowUpdateMode = newValue
  }, onSetMask:function(name, oldValue, newValue) {
    this.light.mask = newValue
  }, onEnable:function() {
    LightComponent._super.onEnable.call(this);
    this.light.setEnabled(true);
    var model = this.data.model;
    if(model) {
      var scene = this.system.app.scene;
      if(!scene.containsModel(model)) {
        scene.addModel(model)
      }
    }
  }, onDisable:function() {
    LightComponent._super.onDisable.call(this);
    this.light.setEnabled(false);
    var model = this.data.model;
    if(model) {
      var scene = this.system.app.scene;
      scene.removeModel(model)
    }
  }});
  return{LightComponent:LightComponent}
}());
pc.extend(pc, function() {
  var LightComponentData = function() {
    this.type = "directional";
    this.enabled = true;
    this.color = new pc.Color(1, 1, 1);
    this.intensity = 1;
    this.castShadows = false;
    this.shadowDistance = 40;
    this.shadowResolution = 1024;
    this.shadowBias = 0.05;
    this.normalOffsetBias = 0;
    this.range = 10;
    this.innerConeAngle = 40;
    this.outerConeAngle = 45;
    this.falloffMode = pc.LIGHTFALLOFF_LINEAR;
    this.shadowType = pc.SHADOW_DEPTH;
    this.shadowUpdateMode = pc.SHADOWUPDATE_REALTIME;
    this.mask = 1;
    this.light = null;
    this.model = null
  };
  LightComponentData = pc.inherits(LightComponentData, pc.ComponentData);
  return{LightComponentData:LightComponentData}
}());
pc.extend(pc, function() {
  var INITIALIZE = "initialize";
  var POST_INITIALIZE = "postInitialize";
  var UPDATE = "update";
  var POST_UPDATE = "postUpdate";
  var FIXED_UPDATE = "fixedUpdate";
  var TOOLS_UPDATE = "toolsUpdate";
  var ON_ENABLE = "onEnable";
  var ON_DISABLE = "onDisable";
  var ScriptComponentSystem = function ScriptComponentSystem(app) {
    this.id = "script";
    this.description = "Allows the Entity to run JavaScript fragments to implement custom behavior.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.ScriptComponent;
    this.DataType = pc.ScriptComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Disabled components are not updated", type:"boolean", defaultValue:true}, {name:"scripts", displayName:"URLs", description:"Attach scripts to this Entity", type:"script", defaultValue:[]}, {name:"instances", exposed:false}, {name:"runInTools", description:"Allows scripts to be loaded and executed while in the tools", defaultValue:false, exposed:false}];
    this.exposeProperties();
    this.instancesWithUpdate = [];
    this.instancesWithFixedUpdate = [];
    this.instancesWithPostUpdate = [];
    this.instancesWithToolsUpdate = [];
    this.on("beforeremove", this.onBeforeRemove, this);
    pc.ComponentSystem.on(INITIALIZE, this.onInitialize, this);
    pc.ComponentSystem.on(POST_INITIALIZE, this.onPostInitialize, this);
    pc.ComponentSystem.on(UPDATE, this.onUpdate, this);
    pc.ComponentSystem.on(FIXED_UPDATE, this.onFixedUpdate, this);
    pc.ComponentSystem.on(POST_UPDATE, this.onPostUpdate, this);
    pc.ComponentSystem.on(TOOLS_UPDATE, this.onToolsUpdate, this)
  };
  ScriptComponentSystem = pc.inherits(ScriptComponentSystem, pc.ComponentSystem);
  pc.extend(ScriptComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    properties = ["runInTools", "enabled", "scripts"];
    if(data.scripts && data.scripts.length) {
      data.scripts.forEach(function(script) {
        if(script.attributes && pc.type(script.attributes) === "array") {
          var dict = {};
          for(var i = 0;i < script.attributes.length;i++) {
            dict[script.attributes[i].name] = script.attributes[i]
          }
          script.attributes = dict
        }
      })
    }
    ScriptComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, cloneComponent:function(entity, clone) {
    var src = this.dataStore[entity.getGuid()];
    var data = {runInTools:src.data.runInTools, scripts:pc.extend([], src.data.scripts), enabled:src.data.enabled};
    return this.addComponent(clone, data)
  }, onBeforeRemove:function(entity, component) {
    if(component.enabled) {
      this._disableScriptComponent(component)
    }
    this._destroyScriptComponent(component)
  }, onInitialize:function(root) {
    this._registerInstances(root);
    if(root.enabled) {
      if(root.script && root.script.enabled) {
        this._initializeScriptComponent(root.script)
      }
      var children = root.getChildren();
      var i, len = children.length;
      for(i = 0;i < len;i++) {
        if(children[i] instanceof pc.Entity) {
          this.onInitialize(children[i])
        }
      }
    }
  }, onPostInitialize:function(root) {
    if(root.enabled) {
      if(root.script && root.script.enabled) {
        this._postInitializeScriptComponent(root.script)
      }
      var children = root.getChildren();
      var i, len = children.length;
      for(i = 0;i < len;i++) {
        if(children[i] instanceof pc.Entity) {
          this.onPostInitialize(children[i])
        }
      }
    }
  }, _callInstancesMethod:function(script, method) {
    var instances = script.data.instances;
    for(var name in instances) {
      if(instances.hasOwnProperty(name)) {
        var instance = instances[name].instance;
        if(instance[method]) {
          instance[method].call(instance)
        }
      }
    }
  }, _initializeScriptComponent:function(script) {
    this._callInstancesMethod(script, INITIALIZE);
    script.data.initialized = true;
    if(script.enabled && script.entity.enabled) {
      this._enableScriptComponent(script)
    }
  }, _enableScriptComponent:function(script) {
    this._callInstancesMethod(script, ON_ENABLE)
  }, _disableScriptComponent:function(script) {
    this._callInstancesMethod(script, ON_DISABLE)
  }, _destroyScriptComponent:function(script) {
    var index;
    var instances = script.data.instances;
    for(var name in instances) {
      if(instances.hasOwnProperty(name)) {
        var instance = instances[name].instance;
        if(instance.destroy) {
          instance.destroy()
        }
        if(instance.update) {
          index = this.instancesWithUpdate.indexOf(instance);
          if(index >= 0) {
            this.instancesWithUpdate.splice(index, 1)
          }
        }
        if(instance.fixedUpdate) {
          index = this.instancesWithFixedUpdate.indexOf(instance);
          if(index >= 0) {
            this.instancesWithFixedUpdate.splice(index, 1)
          }
        }
        if(instance.postUpdate) {
          index = this.instancesWithPostUpdate.indexOf(instance);
          if(index >= 0) {
            this.instancesWithPostUpdate.splice(index, 1)
          }
        }
        if(instance.toolsUpdate) {
          index = this.instancesWithToolsUpdate.indexOf(instance);
          if(index >= 0) {
            this.instancesWithToolsUpdate.splice(index, 1)
          }
        }
        if(script.instances[name].instance === script[name]) {
          delete script[name]
        }
        delete script.instances[name]
      }
    }
  }, _postInitializeScriptComponent:function(script) {
    this._callInstancesMethod(script, POST_INITIALIZE);
    script.data.postInitialized = true
  }, _updateInstances:function(method, updateList, dt) {
    var item;
    for(var i = 0, len = updateList.length;i < len;i++) {
      item = updateList[i];
      if(item && item.entity.script.enabled && item.entity.enabled) {
        item[method].call(item, dt)
      }
    }
  }, onUpdate:function(dt) {
    this._updateInstances(UPDATE, this.instancesWithUpdate, dt)
  }, onFixedUpdate:function(dt) {
    this._updateInstances(FIXED_UPDATE, this.instancesWithFixedUpdate, dt)
  }, onPostUpdate:function(dt) {
    this._updateInstances(POST_UPDATE, this.instancesWithPostUpdate, dt)
  }, onToolsUpdate:function(dt) {
    this._updateInstances(TOOLS_UPDATE, this.instancesWithToolsUpdate, dt)
  }, broadcast:function(name, functionName) {
    console.warn("DEPRECATED: ScriptComponentSystem.broadcast() is deprecated and will be removed soon. Please use: http://developer.playcanvas.com/user-manual/scripting/communication/");
    var args = pc.makeArray(arguments).slice(2);
    var id, data, fn;
    var dataStore = this.store;
    for(id in dataStore) {
      if(dataStore.hasOwnProperty(id)) {
        data = dataStore[id].data;
        if(data.instances[name]) {
          fn = data.instances[name].instance[functionName];
          if(fn) {
            fn.apply(data.instances[name].instance, args)
          }
        }
      }
    }
  }, _preRegisterInstance:function(entity, url, name, instance) {
    if(entity.script) {
      entity.script.data._instances = entity.script.data._instances || {};
      if(entity.script.data._instances[name]) {
        throw Error(pc.string.format("Script name collision '{0}'. Scripts from '{1}' and '{2}' {{3}}", name, url, entity.script.data._instances[name].url, entity.getGuid()));
      }
      entity.script.data._instances[name] = {url:url, name:name, instance:instance}
    }
  }, _registerInstances:function(entity) {
    var preRegistered, instance, instanceName;
    if(entity.script) {
      if(entity.script.data._instances) {
        entity.script.instances = entity.script.data._instances;
        for(instanceName in entity.script.instances) {
          preRegistered = entity.script.instances[instanceName];
          instance = preRegistered.instance;
          pc.events.attach(instance);
          if(instance.update) {
            this.instancesWithUpdate.push(instance)
          }
          if(instance.fixedUpdate) {
            this.instancesWithFixedUpdate.push(instance)
          }
          if(instance.postUpdate) {
            this.instancesWithPostUpdate.push(instance)
          }
          if(instance.toolsUpdate) {
            this.instancesWithToolsUpdate.push(instance)
          }
          if(entity.script.scripts) {
            this._createAccessors(entity, preRegistered)
          }
          if(entity.script[instanceName]) {
            throw Error(pc.string.format("Script with name '{0}' is already attached to Script Component", instanceName));
          }else {
            entity.script[instanceName] = instance
          }
        }
        delete entity.script.data._instances
      }
    }
    var children = entity.getChildren();
    var i, len = children.length;
    for(i = 0;i < len;i++) {
      if(children[i] instanceof pc.Entity) {
        this._registerInstances(children[i])
      }
    }
  }, _createAccessors:function(entity, instance) {
    var self = this;
    var i;
    var len = entity.script.scripts.length;
    var url = instance.url;
    for(i = 0;i < len;i++) {
      var script = entity.script.scripts[i];
      if(script.url === url) {
        var attributes = script.attributes;
        if(script.name && attributes) {
          for(var key in attributes) {
            if(attributes.hasOwnProperty(key)) {
              self._createAccessor(attributes[key], instance)
            }
          }
          entity.script.data.attributes[script.name] = pc.extend({}, attributes)
        }
        break
      }
    }
  }, _createAccessor:function(attribute, instance) {
    var self = this;
    self._convertAttributeValue(attribute);
    Object.defineProperty(instance.instance, attribute.name, {get:function() {
      return attribute.value
    }, set:function(value) {
      var oldValue = attribute.value;
      attribute.value = value;
      self._convertAttributeValue(attribute);
      instance.instance.fire("set", attribute.name, oldValue, attribute.value)
    }, configurable:true})
  }, _updateAccessors:function(entity, instance) {
    var self = this;
    var i;
    var len = entity.script.scripts.length;
    var key;
    var url = instance.url;
    var scriptComponent, script, name, attributes;
    var previousAttributes;
    var oldAttribute;
    for(i = 0;i < len;i++) {
      scriptComponent = entity.script;
      script = scriptComponent.scripts[i];
      if(script.url === url) {
        name = script.name;
        attributes = script.attributes;
        if(name) {
          if(attributes) {
            for(key in attributes) {
              if(attributes.hasOwnProperty(key)) {
                self._createAccessor(attributes[key], instance)
              }
            }
          }
          previousAttributes = scriptComponent.data.attributes[name];
          if(previousAttributes) {
            for(key in previousAttributes) {
              oldAttribute = previousAttributes[key];
              if(!(key in attributes)) {
                delete instance.instance[oldAttribute.name]
              }else {
                if(attributes[key].value !== oldAttribute.value) {
                  if(instance.instance.onAttributeChanged) {
                    instance.instance.onAttributeChanged(oldAttribute.name, oldAttribute.value, attributes[key].value)
                  }
                }
              }
            }
          }
          if(attributes) {
            scriptComponent.data.attributes[name] = pc.extend([], attributes)
          }else {
            delete scriptComponent.data.attributes[name]
          }
        }
        break
      }
    }
  }, _convertAttributeValue:function(attribute) {
    if(attribute.type === "rgb" || attribute.type === "rgba") {
      if(pc.type(attribute.value) === "array") {
        attribute.value = attribute.value.length === 3 ? new pc.Color(attribute.value[0], attribute.value[1], attribute.value[2]) : new pc.Color(attribute.value[0], attribute.value[1], attribute.value[2], attribute.value[3])
      }
    }else {
      if(attribute.type === "vector") {
        if(pc.type(attribute.value) === "array") {
          attribute.value = new pc.Vec3(attribute.value[0], attribute.value[1], attribute.value[2])
        }
      }
    }
  }});
  return{ScriptComponentSystem:ScriptComponentSystem}
}());
pc.extend(pc, function() {
  var ScriptComponent = function ScriptComponent(system, entity) {
    this.on("set_scripts", this.onSetScripts, this)
  };
  ScriptComponent = pc.inherits(ScriptComponent, pc.Component);
  pc.extend(ScriptComponent.prototype, {send:function(name, functionName) {
    console.warn("DEPRECATED: ScriptComponent.send() is deprecated and will be removed soon. Please use: http://developer.playcanvas.com/user-manual/scripting/communication/");
    var args = pc.makeArray(arguments).slice(2);
    var instances = this.entity.script.instances;
    var fn;
    if(instances && instances[name]) {
      fn = instances[name].instance[functionName];
      if(fn) {
        return fn.apply(instances[name].instance, args)
      }
    }
  }, onEnable:function() {
    ScriptComponent._super.onEnable.call(this);
    if(this.data.areScriptsLoaded) {
      if(!this.data.initialized) {
        this.system._initializeScriptComponent(this)
      }else {
        this.system._enableScriptComponent(this)
      }
      if(!this.data.postInitialized) {
        this.system._postInitializeScriptComponent(this)
      }
    }
  }, onDisable:function() {
    ScriptComponent._super.onDisable.call(this);
    this.system._disableScriptComponent(this)
  }, onSetScripts:function(name, oldValue, newValue) {
    if(!this.system._inTools || this.runInTools) {
      if(this._updateScriptAttributes(oldValue, newValue)) {
        return
      }
      if(this.enabled) {
        this.system._disableScriptComponent(this)
      }
      this.system._destroyScriptComponent(this);
      this.data.areScriptsLoaded = false;
      var scripts = newValue;
      var urls = scripts.map(function(s) {
        return s.url
      });
      if(this._loadFromCache(urls)) {
        return
      }
      this._loadScripts(urls)
    }
  }, _updateScriptAttributes:function(oldValue, newValue) {
    var onlyUpdateAttributes = true;
    if(oldValue.length !== newValue.length) {
      onlyUpdateAttributes = false
    }else {
      var i;
      len = newValue.length;
      for(i = 0;i < len;i++) {
        if(oldValue[i].url !== newValue[i].url) {
          onlyUpdateAttributes = false;
          break
        }
      }
    }
    if(onlyUpdateAttributes) {
      for(var key in this.instances) {
        if(this.instances.hasOwnProperty(key)) {
          this.system._updateAccessors(this.entity, this.instances[key])
        }
      }
    }
    return onlyUpdateAttributes
  }, _loadFromCache:function(urls) {
    var cached = [];
    for(var i = 0, len = urls.length;i < len;i++) {
      var type = this.system.app.loader.getFromCache(urls[i]);
      if(!type) {
        return false
      }else {
        cached.push(type)
      }
    }
    for(var i = 0, len = cached.length;i < len;i++) {
      var ScriptType = cached[i];
      if(ScriptType == true) {
        continue
      }
      if(ScriptType && this.entity.script) {
        if(!this.entity.script.instances[ScriptType._pcScriptName]) {
          var instance = new ScriptType(this.entity);
          this.system._preRegisterInstance(this.entity, urls[i], ScriptType._pcScriptName, instance)
        }
      }
    }
    if(this.data) {
      this.data.areScriptsLoaded = true
    }
    this.system.onInitialize(this.entity);
    this.system.onPostInitialize(this.entity);
    return true
  }, _loadScripts:function(urls) {
    var requests = urls.map(function(url) {
      return new pc.resources.ScriptRequest(url)
    });
    var options = {parent:this.entity.getRequest()};
    var promise = this.system.app.loader.request(requests, options);
    promise.then(function(resources) {
      resources.forEach(function(ScriptType, index) {
        if(ScriptType && this.entity.script) {
          if(!this.entity.script.instances[ScriptType._pcScriptName]) {
            var instance = new ScriptType(this.entity);
            this.system._preRegisterInstance(this.entity, urls[index], ScriptType._pcScriptName, instance)
          }
        }
      }, this);
      if(this.data) {
        this.data.areScriptsLoaded = true
      }
      if(!options.parent) {
        this.system.onInitialize(this.entity);
        this.system.onPostInitialize(this.entity)
      }
    }.bind(this)).then(null, function(error) {
      setTimeout(function() {
        throw error;
      })
    })
  }});
  return{ScriptComponent:ScriptComponent}
}());
pc.extend(pc, function() {
  var ScriptComponentData = function() {
    this.scripts = [];
    this.enabled = true;
    this.instances = {};
    this._instances = {};
    this.runInTools = false;
    this.attributes = {};
    this.initialized = false;
    this.postInitialized = false;
    this.areScriptsLoaded = false
  };
  ScriptComponentData = pc.inherits(ScriptComponentData, pc.ComponentData);
  return{ScriptComponentData:ScriptComponentData}
}());
pc.extend(pc, function() {
  var PackComponentSystem = function PackComponentSystem(app) {
    this.id = "pack";
    app.systems.add(this.id, this);
    this.ComponentType = pc.PackComponent;
    this.DataType = pc.PackComponentData;
    this.schema = []
  };
  PackComponentSystem = pc.inherits(PackComponentSystem, pc.ComponentSystem);
  return{PackComponentSystem:PackComponentSystem}
}());
pc.extend(pc, function() {
  var PackComponent = function PackComponent(system, entity) {
  };
  PackComponent = pc.inherits(PackComponent, pc.Component);
  return{PackComponent:PackComponent}
}());
pc.extend(pc, function() {
  var PackComponentData = function() {
  };
  PackComponentData = pc.inherits(PackComponentData, pc.ComponentData);
  return{PackComponentData:PackComponentData}
}());
pc.extend(pc, function() {
  var PickComponentSystem = function PickComponentSystem(app) {
    this.id = "pick";
    app.systems.add(this.id, this);
    this.ComponentType = pc.PickComponent;
    this.DataType = pc.PickComponentData;
    this.schema = [{name:"layer", exposed:false}, {name:"shapes", exposed:false}, {name:"material", exposed:false}];
    this.layers = {"default":[]};
    this.display = false;
    this.on("remove", this.onRemove, this)
  };
  PickComponentSystem = pc.inherits(PickComponentSystem, pc.ComponentSystem);
  pc.extend(PickComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    data.material = new pc.PhongMaterial;
    properties = ["material"];
    PickComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, onRemove:function(entity, data) {
    this.deleteShapes(data.layer, data.shapes)
  }, addShape:function(layer, shape) {
    if(this.layers[layer] === undefined) {
      this.layers[layer] = []
    }
    this.layers[layer].push(shape.model);
    if(this.display) {
      this.app.scene.addModel(shape.model)
    }
  }, deleteShapes:function(layer, shapes) {
    var layerModels = this.layers[layer];
    for(var i = 0;i < shapes.length;i++) {
      var model = shapes[i].model;
      var index = layerModels.indexOf(model);
      if(index !== -1) {
        layerModels.splice(index, 1)
      }
      if(this.display) {
        this.app.scene.removeModel(model)
      }
    }
  }, getLayerModels:function(layerName) {
    return this.layers[layerName]
  }});
  return{PickComponentSystem:PickComponentSystem}
}());
pc.extend(pc, function() {
  var PickComponent = function PickComponent(system, entity) {
  };
  PickComponent = pc.inherits(PickComponent, pc.Component);
  pc.extend(PickComponent.prototype, {addShape:function(shape, shapeName) {
    var material = this.data.material;
    var mesh = null;
    switch(shape.type) {
      case pc.shape.Type.BOX:
        mesh = pc.createBox(this.system.app.graphicsDevice, {halfExtents:shape.halfExtents});
        break;
      case pc.shape.Type.SPHERE:
        mesh = pc.createSphere(this.system.app.graphicsDevice, {radius:shape.radius});
        break;
      case pc.shape.Type.TORUS:
        mesh = pc.createTorus(this.system.app.graphicsDevice, {tubeRadius:shape.iradius, ringRadius:shape.oradius});
        break
    }
    var node = new pc.GraphNode;
    var meshInstance = new pc.MeshInstance(node, mesh, material);
    meshInstance._entity = this.entity;
    var model = new pc.Model;
    model.graph = node;
    model.meshInstances = [meshInstance];
    var shape = {shape:shape, shapeName:shapeName, model:model};
    this.data.shapes.push(shape);
    this.system.addShape(this.data.layer, shape)
  }, deleteShapes:function() {
    this.system.deleteShapes(this.data.layer, this.data.shapes);
    this.data.shapes = []
  }});
  return{PickComponent:PickComponent}
}());
pc.extend(pc, function() {
  function PickComponentData() {
    this.layer = "default";
    this.shapes = [];
    this.material = null
  }
  PickComponentData = pc.inherits(PickComponentData, pc.ComponentData);
  return{PickComponentData:PickComponentData}
}());
pc.extend(pc, function() {
  var AudioSourceComponentSystem = function(app, manager) {
    this.id = "audiosource";
    this.description = "Specifies audio assets that can be played at the position of the Entity.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.AudioSourceComponent;
    this.DataType = pc.AudioSourceComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Disabled audiosource components do not play any sounds", type:"boolean", defaultValue:true}, {name:"assets", displayName:"Assets", description:"Audio assets", type:"asset", options:{max:100, type:"audio"}, defaultValue:[]}, {name:"volume", displayName:"Volume", description:"The sound volume", type:"number", options:{max:1, min:0, step:0.1}, defaultValue:1}, {name:"pitch", displayName:"Pitch", description:"The sound pitch", type:"number",
    defaultValue:1, options:{min:0.01, step:0.01}}, {name:"loop", displayName:"Loop", description:"Set whether sound loops or not", type:"boolean", defaultValue:false}, {name:"activate", displayName:"Activate", description:"Play first audio sample when scene loads", type:"boolean", defaultValue:true}, {name:"3d", displayName:"3d", description:"3d sounds are positioned in space, and their sound is dependent on listener position/orientation. Non-3d sounds are uniform across space", type:"boolean",
    defaultValue:true}, {name:"minDistance", displayName:"Min Distance", description:"Distance from listener under which the sound is at full volume", type:"number", defaultValue:1, options:{min:0}}, {name:"maxDistance", displayName:"Max Distance", description:"Distance from listener over which the sound cannot be heard", type:"number", defaultValue:1E4, options:{min:0}}, {name:"rollOffFactor", displayName:"Roll-off factor", description:"Strength of the roll off", type:"number", defaultValue:1, options:{min:0}},
    {name:"sources", exposed:false, readOnly:true}, {name:"currentSource", exposed:false, readOnly:true}, {name:"channel", exposed:false, readOnly:true}];
    this.exposeProperties();
    this.manager = manager;
    this.initialized = false;
    pc.ComponentSystem.on("initialize", this.onInitialize, this);
    pc.ComponentSystem.on("update", this.onUpdate, this)
  };
  AudioSourceComponentSystem = pc.inherits(AudioSourceComponentSystem, pc.ComponentSystem);
  pc.extend(AudioSourceComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    properties = ["activate", "volume", "pitch", "loop", "3d", "minDistance", "maxDistance", "rollOffFactor", "enabled", "assets"];
    AudioSourceComponentSystem._super.initializeComponentData.call(this, component, data, properties);
    component.paused = !(component.enabled && component.activate)
  }, onInitialize:function(root) {
    if(root.audiosource && root.enabled && root.audiosource.enabled && root.audiosource.activate) {
      root.audiosource.play(root.audiosource.currentSource)
    }
    var children = root.getChildren();
    var i, len = children.length;
    for(i = 0;i < len;i++) {
      if(children[i] instanceof pc.Entity) {
        this.onInitialize(children[i])
      }
    }
    this.initialized = true
  }, onUpdate:function(dt) {
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var component = components[id];
        var entity = component.entity;
        var componentData = component.data;
        if(componentData.enabled && entity.enabled && componentData.channel instanceof pc.Channel3d) {
          var pos = entity.getPosition();
          componentData.channel.setPosition(pos)
        }
      }
    }
  }, setVolume:function(volume) {
    this.manager.setVolume(volume)
  }});
  return{AudioSourceComponentSystem:AudioSourceComponentSystem}
}());
pc.extend(pc, function() {
  var AudioSourceComponent = function(system, entity) {
    this.on("set_assets", this.onSetAssets, this);
    this.on("set_loop", this.onSetLoop, this);
    this.on("set_volume", this.onSetVolume, this);
    this.on("set_pitch", this.onSetPitch, this);
    this.on("set_minDistance", this.onSetMinDistance, this);
    this.on("set_maxDistance", this.onSetMaxDistance, this);
    this.on("set_rollOffFactor", this.onSetRollOffFactor, this)
  };
  AudioSourceComponent = pc.inherits(AudioSourceComponent, pc.Component);
  pc.extend(AudioSourceComponent.prototype, {play:function(name) {
    if(!this.enabled || !this.entity.enabled) {
      return
    }
    if(this.channel) {
      this.stop()
    }
    var channel;
    var componentData = this.data;
    if(componentData.sources[name]) {
      if(!componentData.sources[name].isLoaded) {
        logWARNING(pc.string.format("Audio asset '{0}' is not loaded (probably an unsupported format) and will not be played", name));
        return
      }
      if(!componentData["3d"]) {
        channel = this.system.manager.playSound(componentData.sources[name], componentData);
        componentData.currentSource = name;
        componentData.channel = channel
      }else {
        var pos = this.entity.getPosition();
        channel = this.system.manager.playSound3d(componentData.sources[name], pos, componentData);
        componentData.currentSource = name;
        componentData.channel = channel
      }
    }
  }, pause:function() {
    if(this.channel) {
      this.channel.pause()
    }
  }, unpause:function() {
    if(this.channel && this.channel.paused) {
      this.channel.unpause()
    }
  }, stop:function() {
    if(this.channel) {
      this.channel.stop();
      this.channel = null
    }
  }, onSetAssets:function(name, oldValue, newValue) {
    var componentData = this.data;
    var newAssets = [];
    var i, len = newValue.length;
    if(oldValue && oldValue.length) {
      for(var i = 0;i < oldValue.length;i++) {
        if(oldValue[i]) {
          var asset = this.system.app.assets.getAssetById(oldValue[i]);
          if(asset) {
            asset.off("change", this.onAssetChanged, this);
            asset.off("remove", this.onAssetRemoved, this)
          }
        }
      }
    }
    if(len) {
      for(i = 0;i < len;i++) {
        if(oldValue.indexOf(newValue[i]) < 0) {
          newAssets.push(newValue[i])
        }
      }
    }
    if(!this.system._inTools && newAssets.length) {
      this.loadAudioSourceAssets(newAssets)
    }
  }, onAssetChanged:function(asset, attribute, newValue, oldValue) {
    if(attribute === "resource") {
      var sources = this.data.sources;
      if(sources) {
        this.data.sources[asset.name] = newValue;
        if(this.data.currentSource === asset.name) {
          if(this.channel) {
            if(this.channel.paused) {
              this.play(asset.name);
              this.pause()
            }else {
              this.play(asset.name)
            }
          }
        }
      }
    }
  }, onAssetRemoved:function(asset) {
    asset.off("remove", this.onAssetRemoved, this);
    if(this.data.sources[asset.name]) {
      delete this.data.sources[asset.name];
      if(this.data.currentSource === asset.name) {
        this.stop();
        this.data.currentSource = null
      }
    }
  }, onSetLoop:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel) {
        this.channel.setLoop(newValue)
      }
    }
  }, onSetVolume:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel) {
        this.channel.setVolume(newValue)
      }
    }
  }, onSetPitch:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel) {
        this.channel.setPitch(newValue)
      }
    }
  }, onSetMaxDistance:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel instanceof pc.Channel3d) {
        this.channel.setMaxDistance(newValue)
      }
    }
  }, onSetMinDistance:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel instanceof pc.Channel3d) {
        this.channel.setMinDistance(newValue)
      }
    }
  }, onSetRollOffFactor:function(name, oldValue, newValue) {
    if(oldValue != newValue) {
      if(this.channel instanceof pc.Channel3d) {
        this.channel.setRollOffFactor(newValue)
      }
    }
  }, onEnable:function() {
    AudioSourceComponent._super.onEnable.call(this);
    if(this.system.initialized) {
      if(this.data.activate && !this.channel) {
        this.play(this.currentSource)
      }else {
        this.unpause()
      }
    }
  }, onDisable:function() {
    AudioSourceComponent._super.onDisable.call(this);
    this.pause()
  }, loadAudioSourceAssets:function(ids) {
    var options = {parent:this.entity.getRequest()};
    var assets = ids.map(function(id) {
      return this.system.app.assets.getAssetById(id)
    }, this);
    var requests = [];
    var names = [];
    var sources = {};
    var currentSource = null;
    assets.forEach(function(asset) {
      if(!asset) {
        logERROR(pc.string.format("Trying to load audiosource component before assets {0} are loaded", ids))
      }else {
        currentSource = currentSource || asset.name;
        asset.off("change", this.onAssetChanged, this);
        asset.on("change", this.onAssetChanged, this);
        asset.off("remove", this.onAssetRemoved, this);
        asset.on("remove", this.onAssetRemoved, this);
        if(asset.resource) {
          sources[asset.name] = asset.resource
        }else {
          requests.push(new pc.resources.AudioRequest(asset.getFileUrl()));
          names.push(asset.name)
        }
      }
    }.bind(this));
    if(requests.length) {
      this.system.app.loader.request(requests, options).then(function(audioResources) {
        for(var i = 0;i < requests.length;i++) {
          sources[names[i]] = audioResources[i]
        }
        this.data.sources = sources;
        this.data.currentSource = currentSource;
        if(!options.parent && this.enabled && this.activate && currentSource) {
          this.onEnable()
        }
      }.bind(this))
    }else {
      this.data.sources = sources;
      this.data.currentSource = currentSource;
      if(this.enabled && this.activate && currentSource) {
        this.onEnable()
      }
    }
  }});
  return{AudioSourceComponent:AudioSourceComponent}
}());
pc.AudioSourceComponentData = function AudioSourceComponentData() {
  this.enabled = true;
  this.assets = [];
  this.activate = true;
  this.volume = 1;
  this.pitch = 1;
  this.loop = false;
  this["3d"] = true;
  this.minDistance = 1;
  this.maxDistance = 1E4;
  this.rollOffFactor = 1;
  this.paused = true;
  this.sources = {};
  this.currentSource = null;
  this.channel = null
};
pc.extend(pc, function() {
  var AudioListenerComponentSystem = function(app, manager) {
    this.id = "audiolistener";
    this.description = "Specifies the location of the listener for 3D audio playback.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.AudioListenerComponent;
    this.DataType = pc.AudioListenerComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Disabled audio listener components do not affect audiosources", type:"boolean", defaultValue:true}];
    this.exposeProperties();
    this.manager = manager;
    this.current = null;
    pc.ComponentSystem.on("update", this.onUpdate, this)
  };
  AudioListenerComponentSystem = pc.inherits(AudioListenerComponentSystem, pc.ComponentSystem);
  pc.extend(AudioListenerComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    properties = ["enabled"];
    AudioListenerComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, onUpdate:function(dt) {
    if(this.current) {
      var position = this.current.getPosition();
      this.manager.listener.setPosition(position);
      var wtm = this.current.getWorldTransform();
      this.manager.listener.setOrientation(wtm)
    }
  }});
  return{AudioListenerComponentSystem:AudioListenerComponentSystem}
}());
pc.extend(pc, function() {
  var AudioListenerComponent = function(system, entity) {
  };
  AudioListenerComponent = pc.inherits(AudioListenerComponent, pc.Component);
  pc.extend(AudioListenerComponent.prototype, {setCurrentListener:function() {
    if(this.enabled && this.entity.audiolistener && this.entity.enabled) {
      this.system.current = this.entity;
      var position = this.system.current.getPosition();
      this.system.manager.listener.setPosition(position)
    }
  }, onEnable:function() {
    AudioListenerComponent._super.onEnable.call(this);
    this.setCurrentListener()
  }, onDisable:function() {
    AudioListenerComponent._super.onDisable.call(this);
    if(this.system.current === this.entity) {
      this.system.current = null
    }
  }});
  return{AudioListenerComponent:AudioListenerComponent}
}());
pc.extend(pc, function() {
  var AudioListenerComponentData = function() {
    this.enabled = true
  };
  AudioListenerComponentData = pc.inherits(AudioListenerComponentData, pc.ComponentData);
  return{AudioListenerComponentData:AudioListenerComponentData}
}());
pc.extend(pc, function() {
  var DesignerComponentSystem = function(app) {
    app.systems.add("designer", this)
  };
  DesignerComponentSystem = pc.inherits(DesignerComponentSystem, pc.ComponentSystem);
  DesignerComponentSystem.prototype.createComponent = function(entity, data) {
    var componentData = new pc.DesignerComponentData;
    this.initializeComponent(entity, componentData, data, ["fillWindow", "width", "height"]);
    return componentData
  };
  return{DesignerComponentSystem:DesignerComponentSystem}
}());
pc.extend(pc, function() {
  DesignerComponentData = function() {
    this.fillWindow = true;
    this.width = 800;
    this.height = 450
  };
  DesignerComponentData = pc.inherits(DesignerComponentData, pc.ComponentData);
  return{DesignerComponentData:DesignerComponentData}
}());
pc.extend(pc, {BODYTYPE_STATIC:"static", BODYTYPE_DYNAMIC:"dynamic", BODYTYPE_KINEMATIC:"kinematic", BODYFLAG_STATIC_OBJECT:1, BODYFLAG_KINEMATIC_OBJECT:2, BODYFLAG_NORESPONSE_OBJECT:4, BODYSTATE_ACTIVE_TAG:1, BODYSTATE_ISLAND_SLEEPING:2, BODYSTATE_WANTS_DEACTIVATION:3, BODYSTATE_DISABLE_DEACTIVATION:4, BODYSTATE_DISABLE_SIMULATION:5, BODYGROUP_NONE:0, BODYGROUP_DEFAULT:1, BODYGROUP_DYNAMIC:1, BODYGROUP_STATIC:2, BODYGROUP_KINEMATIC:4, BODYGROUP_ENGINE_1:8, BODYGROUP_TRIGGER:16, BODYGROUP_ENGINE_2:32,
BODYGROUP_ENGINE_3:64, BODYGROUP_USER_1:128, BODYGROUP_USER_2:256, BODYGROUP_USER_3:512, BODYGROUP_USER_4:1024, BODYGROUP_USER_5:2048, BODYGROUP_USER_6:4096, BODYGROUP_USER_7:8192, BODYGROUP_USER_8:16384, BODYMASK_NONE:0, BODYMASK_ALL:65535, BODYMASK_STATIC:2, BODYMASK_NOT_STATIC:65535 ^ 2, BODYMASK_NOT_STATIC_KINEMATIC:65535 ^ (2 | 4)});
pc.extend(pc, function() {
  var transform = new pc.Mat4;
  var newWtm = new pc.Mat4;
  var position = new pc.Vec3;
  var rotation = new pc.Vec3;
  var scale = new pc.Vec3;
  var ammoRayStart, ammoRayEnd;
  var collisions = {};
  var frameCollisions = {};
  var RaycastResult = function RaycastResult(entity, point, normal) {
    this.entity = entity;
    this.point = point;
    this.normal = normal
  };
  var SingleContactResult = function SingleContactResult(a, b, contactPoint) {
    if(arguments.length === 0) {
      this.a = null;
      this.b = null;
      this.localPointA = new pc.Vec3;
      this.localPointB = new pc.Vec3;
      this.pointA = new pc.Vec3;
      this.pointB = new pc.Vec3;
      this.normal = new pc.Vec3
    }else {
      this.a = a;
      this.b = b;
      this.localPointA = contactPoint.localPoint;
      this.localPointB = contactPoint.localPointOther;
      this.pointA = contactPoint.point;
      this.pointB = contactPoint.pointOther;
      this.normal = contactPoint.normal
    }
  };
  var ContactPoint = function ContactPoint(localPoint, localPointOther, point, pointOther, normal) {
    if(arguments.length === 0) {
      this.localPoint = new pc.Vec3;
      this.localPointOther = new pc.Vec3;
      this.point = new pc.Vec3;
      this.pointOther = new pc.Vec3;
      this.normal = new pc.Vec3
    }else {
      this.localPoint = localPoint;
      this.localPointOther = localPointOther;
      this.point = point;
      this.pointOther = pointOther;
      this.normal = normal
    }
  };
  var ContactResult = function ContactResult(other, contacts) {
    this.other = other;
    this.contacts = contacts
  };
  var RigidBodyComponentSystem = function RigidBodyComponentSystem(app) {
    this.id = "rigidbody";
    this.description = "Adds the entity to the scene's physical simulation.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.RigidBodyComponent;
    this.DataType = pc.RigidBodyComponentData;
    this.contactPointPool = new pc.AllocatePool(ContactPoint, 1);
    this.contactResultPool = new pc.AllocatePool(ContactResult, 1);
    this.singleContactResultPool = new pc.AllocatePool(SingleContactResult, 1);
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enables or disables the rigid body", type:"boolean", defaultValue:true}, {name:"type", displayName:"Type", description:"The type of body determines how it moves and collides with other bodies. Dynamic is a normal body. Static will never move. Kinematic can be moved in code, but will not respond to collisions.", type:"enumeration", options:{enumerations:[{name:"Static", value:pc.BODYTYPE_STATIC}, {name:"Dynamic", value:pc.BODYTYPE_DYNAMIC},
    {name:"Kinematic", value:pc.BODYTYPE_KINEMATIC}]}, defaultValue:pc.BODYTYPE_STATIC}, {name:"mass", displayName:"Mass", description:"The mass of the body", type:"number", options:{min:0, step:1}, defaultValue:1, filter:{"type":[pc.BODYTYPE_DYNAMIC, pc.BODYTYPE_KINEMATIC]}}, {name:"linearDamping", displayName:"Linear Damping", description:"The linear damping applied to the body", type:"number", options:{min:0, step:1}, defaultValue:0, filter:{"type":[pc.BODYTYPE_DYNAMIC, pc.BODYTYPE_KINEMATIC]}},
    {name:"angularDamping", displayName:"Angular Damping", description:"The angular damping applied to the body", type:"number", options:{min:0, step:1}, defaultValue:0, filter:{"type":[pc.BODYTYPE_DYNAMIC, pc.BODYTYPE_KINEMATIC]}}, {name:"linearFactor", displayName:"Linear Factor", description:"The linear factor applied to the linear motion of the body, used to contrain linear movement in each axis", type:"vector", options:{min:0, step:0.1}, defaultValue:[1, 1, 1], filter:{"type":[pc.BODYTYPE_DYNAMIC,
    pc.BODYTYPE_KINEMATIC]}}, {name:"angularFactor", displayName:"Angular Factor", description:"The angular factor applied to the angular motion of the body, used to contrain angular movement in each axis", type:"vector", options:{min:0, step:0.1}, defaultValue:[1, 1, 1], filter:{"type":[pc.BODYTYPE_DYNAMIC, pc.BODYTYPE_KINEMATIC]}}, {name:"friction", displayName:"Friction", description:"The friction when the body slides along another body", type:"number", options:{min:0, step:0.01}, defaultValue:0.5},
    {name:"restitution", displayName:"Restitution", description:"The restitution determines the elasticity of collisions. 0 means an object does not bounce at all, a value of 1 will be a perfect reflection", type:"number", options:{min:0, step:0.01}, defaultValue:0}, {name:"group", displayName:"Group", description:"The collision group this rigidbody belongs to", type:"number", defaultValue:pc.BODYGROUP_STATIC, exposed:false}, {name:"mask", displayName:"Mask", description:"The collision mask this rigidbody uses to collide",
    type:"number", defaultValue:pc.BODYMASK_NOT_STATIC, exposed:false}, {name:"body", exposed:false}];
    this.exposeProperties();
    this.maxSubSteps = 10;
    this.fixedTimeStep = 1 / 60;
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("update", this.onUpdate, this)
  };
  RigidBodyComponentSystem = pc.inherits(RigidBodyComponentSystem, pc.ComponentSystem);
  pc.extend(RigidBodyComponentSystem.prototype, {onLibraryLoaded:function() {
    if(typeof Ammo !== "undefined") {
      var collisionConfiguration = new Ammo.btDefaultCollisionConfiguration;
      var dispatcher = new Ammo.btCollisionDispatcher(collisionConfiguration);
      var overlappingPairCache = new Ammo.btDbvtBroadphase;
      var solver = new Ammo.btSequentialImpulseConstraintSolver;
      this.dynamicsWorld = new Ammo.btDiscreteDynamicsWorld(dispatcher, overlappingPairCache, solver, collisionConfiguration);
      this._ammoGravity = new Ammo.btVector3(0, -9.82, 0);
      this.dynamicsWorld.setGravity(this._ammoGravity);
      ammoRayStart = new Ammo.btVector3;
      ammoRayEnd = new Ammo.btVector3
    }else {
      pc.ComponentSystem.off("update", this.onUpdate, this)
    }
  }, initializeComponentData:function(component, data, properties) {
    if(data.bodyType) {
      data.type = data.bodyType;
      console.warn("WARNING: rigidbody.bodyType: Property is deprecated. Use type instead.")
    }
    if(data.linearFactor && pc.type(data.linearFactor) === "array") {
      data.linearFactor = new pc.Vec3(data.linearFactor[0], data.linearFactor[1], data.linearFactor[2])
    }
    if(data.angularFactor && pc.type(data.angularFactor) === "array") {
      data.angularFactor = new pc.Vec3(data.angularFactor[0], data.angularFactor[1], data.angularFactor[2])
    }
    properties = ["enabled", "mass", "linearDamping", "angularDamping", "linearFactor", "angularFactor", "friction", "restitution", "type", "group", "mask"];
    RigidBodyComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, cloneComponent:function(entity, clone) {
    var data = {enabled:entity.rigidbody.enabled, mass:entity.rigidbody.mass, linearDamping:entity.rigidbody.linearDamping, angularDamping:entity.rigidbody.angularDamping, linearFactor:[entity.rigidbody.linearFactor.x, entity.rigidbody.linearFactor.y, entity.rigidbody.linearFactor.z], angularFactor:[entity.rigidbody.angularFactor.x, entity.rigidbody.angularFactor.y, entity.rigidbody.angularFactor.z], friction:entity.rigidbody.friction, restitution:entity.rigidbody.restitution, type:entity.rigidbody.type,
    group:entity.rigidbody.group, mask:entity.rigidbody.mask};
    this.addComponent(clone, data)
  }, onRemove:function(entity, data) {
    if(data.body) {
      this.removeBody(data.body);
      Ammo.destroy(data.body)
    }
    data.body = null
  }, addBody:function(body, group, mask) {
    if(group !== undefined && mask !== undefined) {
      this.dynamicsWorld.addRigidBody(body, group, mask)
    }else {
      this.dynamicsWorld.addRigidBody(body)
    }
    return body
  }, removeBody:function(body) {
    this.dynamicsWorld.removeRigidBody(body)
  }, addConstraint:function(constraint) {
    this.dynamicsWorld.addConstraint(constraint);
    return constraint
  }, removeConstraint:function(constraint) {
    this.dynamicsWorld.removeConstraint(constraint)
  }, setGravity:function() {
    var x, y, z;
    if(arguments.length === 1) {
      x = arguments[0].x;
      y = arguments[0].y;
      z = arguments[0].z
    }else {
      x = arguments[0];
      y = arguments[1];
      z = arguments[2]
    }
    this._ammoGravity.setValue(x, y, z);
    this.dynamicsWorld.setGravity(this._ammoGravity)
  }, raycastFirst:function(start, end, callback) {
    ammoRayStart.setValue(start.x, start.y, start.z);
    ammoRayEnd.setValue(end.x, end.y, end.z);
    var rayCallback = new Ammo.ClosestRayResultCallback(ammoRayStart, ammoRayEnd);
    this.dynamicsWorld.rayTest(ammoRayStart, ammoRayEnd, rayCallback);
    if(rayCallback.hasHit()) {
      var collisionObj = rayCallback.get_m_collisionObject();
      var body = Ammo.castObject(collisionObj, Ammo.btRigidBody);
      var point = rayCallback.get_m_hitPointWorld();
      var normal = rayCallback.get_m_hitNormalWorld();
      if(body) {
        callback(new RaycastResult(body.entity, new pc.Vec3(point.x(), point.y(), point.z()), new pc.Vec3(normal.x(), normal.y(), normal.z())))
      }
    }
    Ammo.destroy(rayCallback)
  }, _storeCollision:function(entity, other) {
    var isNewCollision = false;
    var guid = entity.getGuid();
    collisions[guid] = collisions[guid] || {others:[], entity:entity};
    if(collisions[guid].others.indexOf(other) < 0) {
      collisions[guid].others.push(other);
      isNewCollision = true
    }
    frameCollisions[guid] = frameCollisions[guid] || {others:[], entity:entity};
    frameCollisions[guid].others.push(other);
    return isNewCollision
  }, _createContactPointFromAmmo:function(contactPoint) {
    var contact = this.contactPointPool.allocate();
    contact.localPoint.set(contactPoint.get_m_localPointA().x(), contactPoint.get_m_localPointA().y(), contactPoint.get_m_localPointA().z());
    contact.localPointOther.set(contactPoint.get_m_localPointB().x(), contactPoint.get_m_localPointB().y(), contactPoint.get_m_localPointB().z());
    contact.point.set(contactPoint.getPositionWorldOnA().x(), contactPoint.getPositionWorldOnA().y(), contactPoint.getPositionWorldOnA().z());
    contact.pointOther.set(contactPoint.getPositionWorldOnB().x(), contactPoint.getPositionWorldOnB().y(), contactPoint.getPositionWorldOnB().z());
    contact.normal.set(contactPoint.get_m_normalWorldOnB().x(), contactPoint.get_m_normalWorldOnB().y(), contactPoint.get_m_normalWorldOnB().z());
    return contact
  }, _createReverseContactPointFromAmmo:function(contactPoint) {
    var contact = this.contactPointPool.allocate();
    contact.localPointOther.set(contactPoint.get_m_localPointA().x(), contactPoint.get_m_localPointA().y(), contactPoint.get_m_localPointA().z());
    contact.localPoint.set(contactPoint.get_m_localPointB().x(), contactPoint.get_m_localPointB().y(), contactPoint.get_m_localPointB().z());
    contact.pointOther.set(contactPoint.getPositionWorldOnA().x(), contactPoint.getPositionWorldOnA().y(), contactPoint.getPositionWorldOnA().z());
    contact.point.set(contactPoint.getPositionWorldOnB().x(), contactPoint.getPositionWorldOnB().y(), contactPoint.getPositionWorldOnB().z());
    contact.normal.set(contactPoint.get_m_normalWorldOnB().x(), contactPoint.get_m_normalWorldOnB().y(), contactPoint.get_m_normalWorldOnB().z());
    return contact
  }, _createSingleContactResult:function(a, b, contactPoint) {
    var result = this.singleContactResultPool.allocate();
    result.a = a;
    result.b = b;
    result.localPointA = contactPoint.localPoint;
    result.localPointB = contactPoint.localPointOther;
    result.pointA = contactPoint.point;
    result.pointB = contactPoint.pointOther;
    result.normal = contactPoint.normal;
    return result
  }, _createContactResult:function(other, contacts) {
    var result = this.contactResultPool.allocate();
    result.other = other;
    result.contacts = contacts;
    return result
  }, _cleanOldCollisions:function() {
    for(var guid in collisions) {
      if(collisions.hasOwnProperty(guid)) {
        var entity = collisions[guid].entity;
        var entityCollision = entity.collision;
        var others = collisions[guid].others;
        var length = others.length;
        var i = length;
        while(i--) {
          var other = others[i];
          if(!frameCollisions[guid] || frameCollisions[guid].others.indexOf(other) < 0) {
            others.splice(i, 1);
            if(entityCollision && other.collision) {
              if(entity.rigidbody && other.rigidbody) {
                entityCollision.fire("collisionend", other)
              }else {
                if(entity.trigger) {
                  entityCollision.fire("triggerleave", other)
                }
              }
            }
          }
        }
        if(others.length === 0) {
          delete collisions[guid]
        }
      }
    }
  }, onUpdate:function(dt) {
    frameContacts = 0;
    this.dynamicsWorld.stepSimulation(dt, this.maxSubSteps, this.fixedTimeStep);
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var entity = components[id].entity;
        var componentData = components[id].data;
        if(componentData.body && componentData.body.isActive() && componentData.enabled && entity.enabled) {
          if(componentData.type === pc.BODYTYPE_DYNAMIC) {
            entity.rigidbody.syncBodyToEntity()
          }else {
            if(componentData.type === pc.BODYTYPE_KINEMATIC) {
              entity.rigidbody._updateKinematic(dt)
            }
          }
        }
      }
    }
    var dispatcher = this.dynamicsWorld.getDispatcher();
    var numManifolds = dispatcher.getNumManifolds();
    var i, j;
    frameCollisions = {};
    for(i = 0;i < numManifolds;i++) {
      var manifold = dispatcher.getManifoldByIndexInternal(i);
      var body0 = manifold.getBody0();
      var body1 = manifold.getBody1();
      var wb0 = Ammo.castObject(body0, Ammo.btRigidBody);
      var wb1 = Ammo.castObject(body1, Ammo.btRigidBody);
      var e0 = wb0.entity;
      var e1 = wb1.entity;
      if(!e0 || !e1) {
        continue
      }
      var flags0 = body0.getCollisionFlags();
      var flags1 = body1.getCollisionFlags();
      var numContacts = manifold.getNumContacts();
      var forwardContacts = [];
      var reverseContacts = [];
      if(numContacts > 0) {
        if(flags0 & pc.BODYFLAG_NORESPONSE_OBJECT || flags1 & pc.BODYFLAG_NORESPONSE_OBJECT) {
          var e0Events = e0.collision ? e0.collision.hasEvent("triggerenter") || e0.collision.hasEvent("triggerleave") : false;
          var e1Events = e1.collision ? e1.collision.hasEvent("triggerenter") || e1.collision.hasEvent("triggerleave") : false;
          if(e0Events) {
            var newCollision = this._storeCollision(e0, e1);
            if(newCollision) {
              if(e0.collision && !(flags1 & pc.BODYFLAG_NORESPONSE_OBJECT)) {
                e0.collision.fire("triggerenter", e1)
              }
            }
          }
          if(e1Events) {
            var newCollision = this._storeCollision(e1, e0);
            if(newCollision) {
              if(e1.collision && !(flags0 & pc.BODYFLAG_NORESPONSE_OBJECT)) {
                e1.collision.fire("triggerenter", e0)
              }
            }
          }
        }else {
          var e0Events = e0.collision ? e0.collision.hasEvent("collisionstart") || e0.collision.hasEvent("collisionend") || e0.collision.hasEvent("contact") : false;
          var e1Events = e1.collision ? e1.collision.hasEvent("collisionstart") || e1.collision.hasEvent("collisionend") || e1.collision.hasEvent("contact") : false;
          var globalEvents = this.hasEvent("contact");
          if(globalEvents || e0Events || e1Events) {
            for(j = 0;j < numContacts;j++) {
              var btContactPoint = manifold.getContactPoint(j);
              var contactPoint = this._createContactPointFromAmmo(btContactPoint);
              var reverseContactPoint = null;
              if(e0Events || e1Events) {
                reverseContactPoint = this._createReverseContactPointFromAmmo(btContactPoint);
                forwardContacts.push(contactPoint);
                reverseContacts.push(reverseContactPoint)
              }
              if(globalEvents) {
                var result = this._createSingleContactResult(e0, e1, contactPoint);
                this.fire("contact", result)
              }
            }
            if(e0Events) {
              var forwardResult = this._createContactResult(e1, forwardContacts);
              if(e0.collision) {
                e0.collision.fire("contact", forwardResult)
              }
              var newCollision = this._storeCollision(e0, e1);
              if(newCollision && e0.collision) {
                e0.collision.fire("collisionstart", forwardResult)
              }
            }
            if(e1Events) {
              var reverseResult = this._createContactResult(e0, reverseContacts);
              if(e1.collision) {
                e1.collision.fire("contact", reverseResult)
              }
              var newCollision = this._storeCollision(e1, e0);
              if(newCollision && e1.collision) {
                e1.collision.fire("collisionstart", reverseResult)
              }
            }
          }
        }
      }
    }
    this._cleanOldCollisions();
    this.contactPointPool.freeAll();
    this.contactResultPool.freeAll();
    this.singleContactResultPool.freeAll()
  }});
  return{RIGIDBODY_TYPE_STATIC:"static", RIGIDBODY_TYPE_DYNAMIC:"dynamic", RIGIDBODY_TYPE_KINEMATIC:"kinematic", RIGIDBODY_CF_STATIC_OBJECT:1, RIGIDBODY_CF_KINEMATIC_OBJECT:2, RIGIDBODY_CF_NORESPONSE_OBJECT:4, RIGIDBODY_ACTIVE_TAG:1, RIGIDBODY_ISLAND_SLEEPING:2, RIGIDBODY_WANTS_DEACTIVATION:3, RIGIDBODY_DISABLE_DEACTIVATION:4, RIGIDBODY_DISABLE_SIMULATION:5, RigidBodyComponentSystem:RigidBodyComponentSystem}
}());
pc.extend(pc, function() {
  var ammoTransform;
  var ammoVec1, ammoVec2, ammoQuat, ammoOrigin;
  var RigidBodyComponent = function RigidBodyComponent(system, entity) {
    if(typeof Ammo !== "undefined" && !ammoTransform) {
      ammoTransform = new Ammo.btTransform;
      ammoVec1 = new Ammo.btVector3;
      ammoVec2 = new Ammo.btVector3;
      ammoQuat = new Ammo.btQuaternion;
      ammoOrigin = new Ammo.btVector3(0, 0, 0)
    }
    this.on("set_mass", this.onSetMass, this);
    this.on("set_linearDamping", this.onSetLinearDamping, this);
    this.on("set_angularDamping", this.onSetAngularDamping, this);
    this.on("set_linearFactor", this.onSetLinearFactor, this);
    this.on("set_angularFactor", this.onSetAngularFactor, this);
    this.on("set_friction", this.onSetFriction, this);
    this.on("set_restitution", this.onSetRestitution, this);
    this.on("set_type", this.onSetType, this);
    this.on("set_group", this.onSetGroupOrMask, this);
    this.on("set_mask", this.onSetGroupOrMask, this);
    this.on("set_body", this.onSetBody, this);
    entity.on("livelink:updatetransform", this.onLiveLinkUpdateTransform, this);
    this.system.on("beforeremove", this.onBeforeRemove, this);
    this._displacement = new pc.Vec3(0, 0, 0);
    this._linearVelocity = new pc.Vec3(0, 0, 0);
    this._angularVelocity = new pc.Vec3(0, 0, 0)
  };
  RigidBodyComponent = pc.inherits(RigidBodyComponent, pc.Component);
  Object.defineProperty(RigidBodyComponent.prototype, "bodyType", {get:function() {
    console.warn("WARNING: bodyType: Function is deprecated. Query type property instead.");
    return this.type
  }, set:function(type) {
    console.warn("WARNING: bodyType: Function is deprecated. Set type property instead.");
    this.type = type
  }});
  Object.defineProperty(RigidBodyComponent.prototype, "linearVelocity", {get:function() {
    if(!this.isKinematic()) {
      if(this.body) {
        var vel = this.body.getLinearVelocity();
        this._linearVelocity.set(vel.x(), vel.y(), vel.z());
        return this._linearVelocity
      }
    }else {
      return this._linearVelocity
    }
  }, set:function(lv) {
    this.activate();
    if(!this.isKinematic()) {
      var body = this.body;
      if(body) {
        ammoVec1.setValue(lv.x, lv.y, lv.z);
        body.setLinearVelocity(ammoVec1)
      }
    }else {
      this._linearVelocity.copy(lv)
    }
  }});
  Object.defineProperty(RigidBodyComponent.prototype, "angularVelocity", {get:function() {
    if(!this.isKinematic()) {
      if(this.body) {
        var vel = this.body.getAngularVelocity();
        this._angularVelocity.set(vel.x(), vel.y(), vel.z());
        return this._angularVelocity
      }
    }else {
      return this._angularVelocity
    }
  }, set:function(av) {
    this.activate();
    if(!this.isKinematic()) {
      var body = this.body;
      if(body) {
        ammoVec1.setValue(av.x, av.y, av.z);
        body.setAngularVelocity(ammoVec1)
      }
    }else {
      this._angularVelocity.copy(av)
    }
  }});
  pc.extend(RigidBodyComponent.prototype, {createBody:function() {
    var entity = this.entity;
    var shape;
    if(entity.collision) {
      shape = entity.collision.shape;
      if(entity.trigger) {
        entity.trigger.destroy();
        delete entity.trigger
      }
    }
    if(shape) {
      if(this.body) {
        this.system.removeBody(this.body);
        Ammo.destroy(this.body)
      }
      var isStaticOrKinematic = this.isStaticOrKinematic();
      var mass = isStaticOrKinematic ? 0 : this.mass;
      var localInertia = new Ammo.btVector3(0, 0, 0);
      if(!isStaticOrKinematic) {
        shape.calculateLocalInertia(mass, localInertia)
      }
      var pos = entity.getPosition();
      var rot = entity.getRotation();
      ammoQuat.setValue(rot.x, rot.y, rot.z, rot.w);
      var startTransform = new Ammo.btTransform;
      startTransform.setIdentity();
      startTransform.getOrigin().setValue(pos.x, pos.y, pos.z);
      startTransform.setRotation(ammoQuat);
      var motionState = new Ammo.btDefaultMotionState(startTransform);
      var bodyInfo = new Ammo.btRigidBodyConstructionInfo(mass, motionState, shape, localInertia);
      var body = new Ammo.btRigidBody(bodyInfo);
      body.setRestitution(this.restitution);
      body.setFriction(this.friction);
      body.setDamping(this.linearDamping, this.angularDamping);
      var v;
      v = this.linearFactor;
      ammoVec1.setValue(v.x, v.y, v.z);
      body.setLinearFactor(ammoVec1);
      v = this.angularFactor;
      ammoVec1.setValue(v.x, v.y, v.z);
      body.setAngularFactor(ammoVec1);
      body.entity = entity;
      if(this.isKinematic()) {
        body.setCollisionFlags(body.getCollisionFlags() | pc.BODYFLAG_KINEMATIC_OBJECT);
        body.setActivationState(pc.BODYSTATE_DISABLE_DEACTIVATION)
      }
      entity.rigidbody.body = body;
      if(this.enabled && this.entity.enabled) {
        this.enableSimulation()
      }
    }
  }, isActive:function() {
    if(this.body) {
      return this.body.isActive()
    }
    return false
  }, activate:function() {
    if(this.body) {
      this.body.activate()
    }
  }, enableSimulation:function() {
    if(this.entity.collision && this.entity.collision.enabled && !this.data.simulationEnabled) {
      var body = this.body;
      if(body) {
        this.system.addBody(body, this.group, this.mask);
        if(this.isKinematic()) {
          body.forceActivationState(pc.BODYSTATE_DISABLE_DEACTIVATION);
          body.activate()
        }else {
          body.forceActivationState(pc.BODYFLAG_ACTIVE_TAG);
          this.syncEntityToBody()
        }
        this.data.simulationEnabled = true
      }
    }
  }, disableSimulation:function() {
    var body = this.body;
    if(body && this.data.simulationEnabled) {
      this.system.removeBody(body);
      body.forceActivationState(pc.BODYSTATE_DISABLE_SIMULATION);
      this.data.simulationEnabled = false
    }
  }, applyForce:function() {
    var x, y, z;
    var px, py, pz;
    switch(arguments.length) {
      case 1:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        break;
      case 2:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        px = arguments[1].x;
        py = arguments[1].y;
        pz = arguments[1].z;
        break;
      case 3:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        break;
      case 6:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        px = arguments[3];
        py = arguments[4];
        pz = arguments[5];
        break
    }
    var body = this.body;
    if(body) {
      body.activate();
      ammoVec1.setValue(x, y, z);
      if(px !== undefined) {
        ammoVec2.setValue(px, py, pz);
        body.applyForce(ammoVec1, ammoVec2)
      }else {
        body.applyForce(ammoVec1, ammoOrigin)
      }
    }
  }, applyTorque:function() {
    var x, y, z;
    switch(arguments.length) {
      case 1:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        break;
      case 3:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        break;
      default:
        console.error("ERROR: applyTorque: function takes 1 or 3 arguments");
        return
    }
    var body = this.body;
    if(body) {
      body.activate();
      ammoVec1.setValue(x, y, z);
      body.applyTorque(ammoVec1)
    }
  }, applyImpulse:function() {
    var x, y, z;
    var px, py, pz;
    switch(arguments.length) {
      case 1:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        break;
      case 2:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        px = arguments[1].x;
        py = arguments[1].y;
        pz = arguments[1].z;
        break;
      case 3:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        break;
      case 6:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        px = arguments[0];
        py = arguments[1];
        pz = arguments[2];
        break
    }
    var body = this.body;
    if(body) {
      body.activate();
      ammoVec1.setValue(x, y, z);
      if(px !== undefined) {
        ammoVec2.setValue(px, py, pz);
        body.applyImpulse(ammoVec1, ammoVec2)
      }else {
        body.applyImpulse(ammoVec1, ammoOrigin)
      }
    }
  }, applyTorqueImpulse:function() {
    var x, y, z;
    switch(arguments.length) {
      case 1:
        x = arguments[0].x;
        y = arguments[0].y;
        z = arguments[0].z;
        break;
      case 3:
        x = arguments[0];
        y = arguments[1];
        z = arguments[2];
        break;
      default:
        console.error("ERROR: applyTorqueImpulse: function takes 1 or 3 arguments");
        return
    }
    var body = this.body;
    if(body) {
      body.activate();
      ammoVec1.setValue(x, y, z);
      body.applyTorqueImpulse(ammoVec1)
    }
  }, isStatic:function() {
    return this.type === pc.BODYTYPE_STATIC
  }, isStaticOrKinematic:function() {
    return this.type === pc.BODYTYPE_STATIC || this.type === pc.BODYTYPE_KINEMATIC
  }, isKinematic:function() {
    return this.type === pc.BODYTYPE_KINEMATIC
  }, syncEntityToBody:function() {
    var body = this.body;
    if(body) {
      var pos = this.entity.getPosition();
      var rot = this.entity.getRotation();
      var transform = body.getWorldTransform();
      transform.getOrigin().setValue(pos.x, pos.y, pos.z);
      ammoQuat.setValue(rot.x, rot.y, rot.z, rot.w);
      transform.setRotation(ammoQuat);
      body.activate()
    }
  }, syncBodyToEntity:function() {
    var body = this.body;
    if(body.isActive()) {
      var motionState = body.getMotionState();
      if(motionState) {
        motionState.getWorldTransform(ammoTransform);
        var p = ammoTransform.getOrigin();
        var q = ammoTransform.getRotation();
        this.entity.setPosition(p.x(), p.y(), p.z());
        this.entity.setRotation(q.x(), q.y(), q.z(), q.w())
      }
    }
  }, teleport:function() {
    if(arguments.length < 3) {
      if(arguments[0]) {
        this.entity.setPosition(arguments[0])
      }
      if(arguments[1]) {
        if(arguments[1] instanceof pc.Quat) {
          this.entity.setRotation(arguments[1])
        }else {
          this.entity.setEulerAngles(arguments[1])
        }
      }
    }else {
      if(arguments.length === 6) {
        this.entity.setEulerAngles(arguments[3], arguments[4], arguments[5])
      }
      this.entity.setPosition(arguments[0], arguments[1], arguments[2])
    }
    this.syncEntityToBody()
  }, _updateKinematic:function(dt) {
    this._displacement.copy(this._linearVelocity).scale(dt);
    this.entity.translate(this._displacement);
    this._displacement.copy(this._angularVelocity).scale(dt);
    this.entity.rotate(this._displacement.x, this._displacement.y, this._displacement.z);
    if(this.body.getMotionState()) {
      var pos = this.entity.getPosition();
      var rot = this.entity.getRotation();
      ammoTransform.getOrigin().setValue(pos.x, pos.y, pos.z);
      ammoQuat.setValue(rot.x, rot.y, rot.z, rot.w);
      ammoTransform.setRotation(ammoQuat);
      this.body.getMotionState().setWorldTransform(ammoTransform)
    }
  }, onEnable:function() {
    RigidBodyComponent._super.onEnable.call(this);
    if(!this.body) {
      this.createBody()
    }
    this.enableSimulation()
  }, onDisable:function() {
    RigidBodyComponent._super.onDisable.call(this);
    this.disableSimulation()
  }, onSetMass:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      var isEnabled = this.enabled && this.entity.enabled;
      if(isEnabled) {
        this.disableSimulation()
      }
      var mass = newValue;
      var localInertia = new Ammo.btVector3(0, 0, 0);
      body.getCollisionShape().calculateLocalInertia(mass, localInertia);
      body.setMassProps(mass, localInertia);
      body.updateInertiaTensor();
      if(isEnabled) {
        this.enableSimulation()
      }
    }
  }, onSetLinearDamping:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      body.setDamping(newValue, this.data.angularDamping)
    }
  }, onSetAngularDamping:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      body.setDamping(this.data.linearDamping, newValue)
    }
  }, onSetLinearFactor:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      ammoVec1.setValue(newValue.x, newValue.y, newValue.z);
      body.setLinearFactor(ammoVec1)
    }
  }, onSetAngularFactor:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      ammoVec1.setValue(newValue.x, newValue.y, newValue.z);
      body.setAngularFactor(ammoVec1)
    }
  }, onSetFriction:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      body.setFriction(newValue)
    }
  }, onSetRestitution:function(name, oldValue, newValue) {
    var body = this.data.body;
    if(body) {
      body.setRestitution(newValue)
    }
  }, onSetType:function(name, oldValue, newValue) {
    if(newValue !== oldValue) {
      this.disableSimulation();
      if(newValue === pc.BODYTYPE_DYNAMIC) {
        this.data.group = pc.BODYGROUP_DYNAMIC;
        this.data.mask = pc.BODYMASK_ALL
      }else {
        if(newValue === pc.BODYTYPE_KINEMATIC) {
          this.data.group = pc.BODYGROUP_KINEMATIC;
          this.data.mask = pc.BODYMASK_ALL
        }else {
          this.data.group = pc.BODYGROUP_STATIC;
          this.data.mask = pc.BODYMASK_NOT_STATIC
        }
      }
      this.createBody()
    }
  }, onSetGroupOrMask:function(name, oldValue, newValue) {
    if(newValue !== oldValue) {
      var isEnabled = this.enabled && this.entity.enabled;
      if(isEnabled) {
        this.disableSimulation();
        this.enableSimulation()
      }
    }
  }, onSetBody:function(name, oldValue, newValue) {
    if(this.body && this.data.simulationEnabled) {
      this.body.activate()
    }
  }, onLiveLinkUpdateTransform:function(position, rotation, scale) {
    this.syncEntityToBody();
    this.linearVelocity = pc.Vec3.ZERO;
    this.angularVelocity = pc.Vec3.ZERO
  }, onBeforeRemove:function(entity, component) {
    if(this === component) {
      entity.off("livelink:updatetransform", this.onLiveLinkUpdateTransform, this);
      this.system.off("beforeremove", this.onBeforeRemove, this)
    }
  }});
  return{RigidBodyComponent:RigidBodyComponent}
}());
pc.extend(pc, function() {
  var RigidBodyComponentData = function() {
    this.enabled = true;
    this.mass = 1;
    this.linearDamping = 0;
    this.angularDamping = 0;
    this.linearFactor = new pc.Vec3(1, 1, 1);
    this.angularFactor = new pc.Vec3(1, 1, 1);
    this.friction = 0.5;
    this.restitution = 0;
    this.type = pc.BODYTYPE_STATIC;
    this.group = pc.BODYGROUP_STATIC;
    this.mask = pc.BODYMASK_NOT_STATIC;
    this.body = null;
    this.simulationEnabled = false
  };
  RigidBodyComponentData = pc.inherits(RigidBodyComponentData, pc.ComponentData);
  return{RigidBodyComponentData:RigidBodyComponentData}
}());
pc.extend(pc, function() {
  var ammoVec1, ammoQuat;
  var Trigger = function Trigger(app, component, data) {
    this.entity = component.entity;
    this.component = component;
    this.app = app;
    if(typeof Ammo !== "undefined") {
      ammoVec1 = new Ammo.btVector3;
      ammoQuat = new Ammo.btQuaternion
    }
    this.initialize(data)
  };
  Trigger.prototype = {initialize:function(data) {
    var entity = this.entity;
    var shape = data.shape;
    if(shape && typeof Ammo !== "undefined") {
      if(entity.trigger) {
        entity.trigger.destroy()
      }
      var mass = 1;
      var localInertia = new Ammo.btVector3(0, 0, 0);
      shape.calculateLocalInertia(mass, localInertia);
      var pos = entity.getPosition();
      var rot = entity.getRotation();
      ammoQuat.setValue(rot.x, rot.y, rot.z, rot.w);
      var startTransform = new Ammo.btTransform;
      startTransform.setIdentity();
      startTransform.getOrigin().setValue(pos.x, pos.y, pos.z);
      startTransform.setRotation(ammoQuat);
      var motionState = new Ammo.btDefaultMotionState(startTransform);
      var bodyInfo = new Ammo.btRigidBodyConstructionInfo(mass, motionState, shape, localInertia);
      var body = new Ammo.btRigidBody(bodyInfo);
      this.body = body;
      body.setRestitution(0);
      body.setFriction(0);
      body.setDamping(0, 0);
      ammoVec1.setValue(0, 0, 0);
      body.setLinearFactor(ammoVec1);
      body.setAngularFactor(ammoVec1);
      body.setCollisionFlags(body.getCollisionFlags() | pc.BODYFLAG_NORESPONSE_OBJECT);
      body.entity = entity;
      if(this.component.enabled && entity.enabled) {
        this.enable()
      }
    }
  }, destroy:function() {
    if(this.body) {
      this.app.systems.rigidbody.removeBody(this.body)
    }
  }, syncEntityToBody:function() {
    var body = this.body;
    if(body) {
      var position = this.entity.getPosition();
      var rotation = this.entity.getRotation();
      var transform = body.getWorldTransform();
      transform.getOrigin().setValue(position.x, position.y, position.z);
      ammoQuat.setValue(rotation.x, rotation.y, rotation.z, rotation.w);
      transform.setRotation(ammoQuat);
      body.activate()
    }
  }, enable:function() {
    var body = this.body;
    this.app.systems.rigidbody.addBody(body, pc.BODYGROUP_TRIGGER, pc.BODYMASK_NOT_STATIC ^ pc.BODYGROUP_TRIGGER);
    body.forceActivationState(pc.BODYSTATE_ACTIVE_TAG);
    body.activate()
  }, disable:function() {
    var body = this.body;
    this.app.systems.rigidbody.removeBody(body);
    body.forceActivationState(pc.BODYSTATE_DISABLE_SIMULATION)
  }};
  return{Trigger:Trigger}
}());
pc.extend(pc, function() {
  var CollisionComponentSystem = function CollisionComponentSystem(app) {
    this.id = "collision";
    this.description = "Specifies a collision volume.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.CollisionComponent;
    this.DataType = pc.CollisionComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enables or disables the collision", type:"boolean", defaultValue:true}, {name:"type", displayName:"Type", description:"The type of the collision volume", type:"enumeration", options:{enumerations:[{name:"Box", value:"box"}, {name:"Sphere", value:"sphere"}, {name:"Capsule", value:"capsule"}, {name:"Cylinder", value:"cylinder"}, {name:"Mesh", value:"mesh"}]}, defaultValue:"box"}, {name:"halfExtents", displayName:"Half Extents",
    description:"The half-extents of the box", type:"vector", options:{min:0, step:0.1}, defaultValue:[0.5, 0.5, 0.5], filter:{type:"box"}}, {name:"radius", displayName:"Radius", description:"The radius of the collision volume", type:"number", options:{min:0, step:0.1}, defaultValue:0.5, filter:{type:["sphere", "capsule", "cylinder"]}}, {name:"axis", displayName:"Axis", description:"Major axis of the volume", type:"enumeration", options:{enumerations:[{name:"X", value:0}, {name:"Y", value:1}, {name:"Z",
    value:2}]}, defaultValue:1, filter:{type:["capsule", "cylinder"]}}, {name:"height", displayName:"Height", description:"Height of the volume", type:"number", options:{min:0, step:0.1}, defaultValue:2, filter:{type:["capsule", "cylinder"]}}, {name:"asset", displayName:"Asset", description:"Collision mesh asset", type:"asset", options:{max:1, type:"model"}, defaultValue:null, filter:{type:"mesh"}}, {name:"shape", exposed:false}, {name:"model", exposed:false}];
    this.exposeProperties();
    this.implementations = {};
    this.debugRender = false;
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("update", this.onUpdate, this);
    pc.ComponentSystem.on("toolsUpdate", this.onToolsUpdate, this)
  };
  CollisionComponentSystem = pc.inherits(CollisionComponentSystem, pc.ComponentSystem);
  CollisionComponentSystem.prototype = pc.extend(CollisionComponentSystem.prototype, {onLibraryLoaded:function() {
    if(typeof Ammo !== "undefined") {
    }else {
      pc.ComponentSystem.off("update", this.onUpdate, this)
    }
  }, initializeComponentData:function(component, data, properties) {
    if(!data.type) {
      data.type = component.data.type
    }
    component.data.type = data.type;
    if(data.halfExtents && pc.type(data.halfExtents) === "array") {
      data.halfExtents = new pc.Vec3(data.halfExtents[0], data.halfExtents[1], data.halfExtents[2])
    }
    var impl = this._createImplementation(data.type);
    impl.beforeInitialize(component, data);
    properties = ["type", "halfExtents", "radius", "axis", "height", "shape", "model", "asset", "enabled"];
    CollisionComponentSystem._super.initializeComponentData.call(this.system, component, data, properties);
    impl.afterInitialize(component, data)
  }, _createImplementation:function(type) {
    if(this.implementations[type] === undefined) {
      var impl;
      switch(type) {
        case "box":
          impl = new CollisionBoxSystemImpl(this);
          break;
        case "sphere":
          impl = new CollisionSphereSystemImpl(this);
          break;
        case "capsule":
          impl = new CollisionCapsuleSystemImpl(this);
          break;
        case "cylinder":
          impl = new CollisionCylinderSystemImpl(this);
          break;
        case "mesh":
          impl = new CollisionMeshSystemImpl(this);
          break;
        default:
          throw"Invalid collision system type: " + type;break
      }
      this.implementations[type] = impl
    }
    return this.implementations[type]
  }, _getImplementation:function(entity) {
    return this.implementations[entity.collision.data.type]
  }, cloneComponent:function(entity, clone) {
    return this._getImplementation(entity).clone(entity, clone)
  }, onRemove:function(entity, data) {
    this.implementations[data.type].remove(entity, data)
  }, onUpdate:function(dt) {
    var id, entity, data;
    var components = this.store;
    for(id in components) {
      entity = components[id].entity;
      data = components[id].data;
      if(data.enabled && entity.enabled) {
        if(!entity.rigidbody && entity.trigger) {
          entity.trigger.syncEntityToBody()
        }
      }
      if(this.debugRender) {
        this.updateDebugShape(entity, data, this._getImplementation(entity))
      }
    }
  }, updateDebugShape:function(entity, data, impl) {
    var app = this.app;
    if(impl !== undefined) {
      if(impl.hasDebugShape) {
        if(data.model) {
          if(!app.scene.containsModel(data.model)) {
            if(entity.enabled && data.enabled) {
              app.scene.addModel(data.model);
              app.root.addChild(data.model.graph)
            }
          }else {
            if(!data.enabled || !entity.enabled) {
              app.root.removeChild(data.model.graph);
              app.scene.removeModel(data.model)
            }
          }
        }
        if(data.enabled && entity.enabled) {
          impl.updateDebugShape(entity, data)
        }
      }
    }
  }, onTransformChanged:function(component, position, rotation, scale) {
    this.implementations[component.data.type].updateTransform(component, position, rotation, scale)
  }, onToolsUpdate:function(dt) {
    var id, entity;
    var components = this.store;
    for(id in components) {
      entity = components[id].entity;
      this.updateDebugShape(entity, components[id].data, this._getImplementation(entity))
    }
  }, setDebugRender:function(value) {
    this.debugRender = value
  }, changeType:function(component, previousType, newType) {
    this.implementations[previousType].remove(component.entity, component.data);
    this._createImplementation(newType).reset(component, component.data)
  }, recreatePhysicalShapes:function(component) {
    this.implementations[component.data.type].recreatePhysicalShapes(component)
  }});
  CollisionSystemImpl = function(system) {
    this.system = system;
    this.hasDebugShape = true
  };
  CollisionSystemImpl.prototype = {beforeInitialize:function(component, data) {
    data.shape = this.createPhysicalShape(component.entity, data);
    data.model = new pc.Model;
    data.model.graph = new pc.GraphNode;
    data.model.meshInstances = [this.createDebugMesh(data)]
  }, afterInitialize:function(component, data) {
    this.recreatePhysicalShapes(component);
    component.data.initialized = true
  }, reset:function(component, data) {
    this.beforeInitialize(component, data);
    this.afterInitialize(component, data)
  }, recreatePhysicalShapes:function(component) {
    var entity = component.entity;
    var data = component.data;
    if(typeof Ammo !== "undefined") {
      data.shape = this.createPhysicalShape(component.entity, data);
      if(entity.rigidbody) {
        entity.rigidbody.disableSimulation();
        entity.rigidbody.createBody()
      }else {
        if(!entity.trigger) {
          entity.trigger = new pc.Trigger(this.system.app, component, data)
        }else {
          entity.trigger.initialize(data)
        }
      }
    }
  }, createDebugMesh:function(data) {
    return undefined
  }, createPhysicalShape:function(entity, data) {
    return undefined
  }, updateDebugShape:function(entity, data) {
  }, updateTransform:function(component, position, rotation, scale) {
    if(component.entity.trigger) {
      component.entity.trigger.syncEntityToBody()
    }
  }, remove:function(entity, data) {
    var app = this.system.app;
    if(entity.rigidbody && entity.rigidbody.body) {
      app.systems.rigidbody.removeBody(entity.rigidbody.body)
    }
    if(entity.trigger) {
      entity.trigger.destroy();
      delete entity.trigger
    }
    if(app.scene.containsModel(data.model)) {
      app.root.removeChild(data.model.graph);
      app.scene.removeModel(data.model)
    }
  }, clone:function(entity, clone) {
    var src = this.system.dataStore[entity.getGuid()];
    var data = {enabled:src.data.enabled, type:src.data.type, halfExtents:[src.data.halfExtents.x, src.data.halfExtents.y, src.data.halfExtents.z], radius:src.data.radius, axis:src.data.axis, height:src.data.height, asset:src.data.asset, model:src.data.model};
    return this.system.addComponent(clone, data)
  }};
  CollisionBoxSystemImpl = function(system) {
  };
  CollisionBoxSystemImpl = pc.inherits(CollisionBoxSystemImpl, CollisionSystemImpl);
  CollisionBoxSystemImpl.prototype = pc.extend(CollisionBoxSystemImpl.prototype, {createDebugMesh:function(data) {
    if(!this.mesh) {
      var gd = this.system.app.graphicsDevice;
      var format = new pc.VertexFormat(gd, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
      var vertexBuffer = new pc.VertexBuffer(gd, format, 8);
      var positions = new Float32Array(vertexBuffer.lock());
      positions.set([-0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5]);
      vertexBuffer.unlock();
      var indexBuffer = new pc.IndexBuffer(gd, pc.INDEXFORMAT_UINT8, 24);
      var indices = new Uint8Array(indexBuffer.lock());
      indices.set([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]);
      indexBuffer.unlock();
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffer;
      mesh.indexBuffer[0] = indexBuffer;
      mesh.primitive[0].type = pc.PRIMITIVE_LINES;
      mesh.primitive[0].base = 0;
      mesh.primitive[0].count = indexBuffer.getNumIndices();
      mesh.primitive[0].indexed = true;
      this.mesh = mesh
    }
    if(!this.material) {
      var material = new pc.BasicMaterial;
      material.color = new pc.Color(0, 0, 1, 1);
      material.update();
      this.material = material
    }
    return new pc.MeshInstance(data.model.graph, this.mesh, this.material)
  }, createPhysicalShape:function(entity, data) {
    if(typeof Ammo !== "undefined") {
      var he = data.halfExtents;
      var ammoHe = new Ammo.btVector3(he.x, he.y, he.z);
      return new Ammo.btBoxShape(ammoHe)
    }else {
      return undefined
    }
  }, updateDebugShape:function(entity, data) {
    var he = data.halfExtents;
    var x = he.x;
    var y = he.y;
    var z = he.z;
    var root = data.model.graph;
    root.setPosition(entity.getPosition());
    root.setRotation(entity.getRotation());
    root.setLocalScale(x * 2, y * 2, z * 2)
  }});
  CollisionSphereSystemImpl = function(system) {
  };
  CollisionSphereSystemImpl = pc.inherits(CollisionSphereSystemImpl, CollisionSystemImpl);
  CollisionSphereSystemImpl.prototype = pc.extend(CollisionSphereSystemImpl.prototype, {createDebugMesh:function(data) {
    if(!this.mesh) {
      var app = this.system.app;
      var gd = app.graphicsDevice;
      var format = new pc.VertexFormat(gd, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
      var vertexBuffer = new pc.VertexBuffer(gd, format, 240);
      var positions = new Float32Array(vertexBuffer.lock());
      var i, x = 0;
      var theta;
      for(var ring = 0;ring < 3;ring++) {
        var xo = 0;
        var yo = 1;
        var zo = 2;
        if(ring === 1) {
          xo = 1;
          yo = 0;
          zo = 2
        }else {
          if(ring === 2) {
            xo = 0;
            yo = 2;
            zo = 1
          }
        }
        for(i = 0;i < 40;i++) {
          theta = 2 * Math.PI * (i / 40);
          positions[x + xo] = 0.5 * Math.cos(theta);
          positions[x + yo] = 0;
          positions[x + zo] = 0.5 * Math.sin(theta);
          x += 3;
          theta = 2 * Math.PI * ((i + 1) / 40);
          positions[x + xo] = 0.5 * Math.cos(theta);
          positions[x + yo] = 0;
          positions[x + zo] = 0.5 * Math.sin(theta);
          x += 3
        }
      }
      vertexBuffer.unlock();
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffer;
      mesh.primitive[0].type = pc.PRIMITIVE_LINES;
      mesh.primitive[0].base = 0;
      mesh.primitive[0].count = vertexBuffer.getNumVertices();
      mesh.primitive[0].indexed = false;
      this.mesh = mesh
    }
    if(!this.material) {
      var material = new pc.BasicMaterial;
      material.color = new pc.Color(0, 0, 1, 1);
      material.update();
      this.material = material
    }
    return new pc.MeshInstance(data.model.graph, this.mesh, this.material)
  }, createPhysicalShape:function(entity, data) {
    if(typeof Ammo !== "undefined") {
      return new Ammo.btSphereShape(data.radius)
    }else {
      return undefined
    }
  }, updateDebugShape:function(entity, data) {
    var root = data.model.graph;
    root.setPosition(entity.getPosition());
    root.setRotation(entity.getRotation());
    var s = data.radius * 2;
    root.setLocalScale(s, s, s)
  }});
  CollisionCapsuleSystemImpl = function(system) {
  };
  CollisionCapsuleSystemImpl = pc.inherits(CollisionCapsuleSystemImpl, CollisionSystemImpl);
  CollisionCapsuleSystemImpl.prototype = pc.extend(CollisionCapsuleSystemImpl.prototype, {createDebugMesh:function(data) {
    if(data.model && data.model.meshInstances && data.model.meshInstances.length) {
      return data.model.meshInstances[0]
    }else {
      var gd = this.system.app.graphicsDevice;
      var format = new pc.VertexFormat(gd, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
      var vertexBuffer = new pc.VertexBuffer(gd, format, 328, pc.BUFFER_DYNAMIC);
      this.updateCapsuleShape(data, vertexBuffer);
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffer;
      mesh.primitive[0].type = pc.PRIMITIVE_LINES;
      mesh.primitive[0].base = 0;
      mesh.primitive[0].count = vertexBuffer.getNumVertices();
      mesh.primitive[0].indexed = false;
      this.mesh = mesh
    }
    if(!this.material) {
      var material = new pc.BasicMaterial;
      material.color = new pc.Color(0, 0, 1, 1);
      material.update();
      this.material = material
    }
    return new pc.MeshInstance(data.model.graph, mesh, this.material)
  }, updateCapsuleShape:function(data, vertexBuffer) {
    var axis = data.axis !== undefined ? data.axis : 1;
    var radius = data.radius || 0.5;
    var height = Math.max((data.height || 2) - 2 * radius, 0);
    var positions = new Float32Array(vertexBuffer.lock());
    var xo = 0;
    var yo = 1;
    var zo = 2;
    if(axis === 0) {
      xo = 1;
      yo = 0;
      zo = 2
    }else {
      if(axis === 2) {
        xo = 0;
        yo = 2;
        zo = 1
      }
    }
    var i, x = 0;
    var theta;
    for(cap = -1;cap < 2;cap += 2) {
      for(i = 0;i < 40;i++) {
        theta = 2 * Math.PI * (i / 40);
        positions[x + xo] = radius * Math.cos(theta);
        positions[x + yo] = cap * height * 0.5;
        positions[x + zo] = radius * Math.sin(theta);
        x += 3;
        theta = 2 * Math.PI * ((i + 1) / 40);
        positions[x + xo] = radius * Math.cos(theta);
        positions[x + yo] = cap * height * 0.5;
        positions[x + zo] = radius * Math.sin(theta);
        x += 3
      }
      for(i = 0;i < 20;i++) {
        theta = Math.PI * (i / 20) + Math.PI * 1.5;
        positions[x + xo] = 0;
        positions[x + yo] = cap * (height * 0.5 + radius * Math.cos(theta));
        positions[x + zo] = cap * radius * Math.sin(theta);
        x += 3;
        theta = Math.PI * ((i + 1) / 20) + Math.PI * 1.5;
        positions[x + xo] = 0;
        positions[x + yo] = cap * (height * 0.5 + radius * Math.cos(theta));
        positions[x + zo] = cap * radius * Math.sin(theta);
        x += 3
      }
      for(i = 0;i < 20;i++) {
        theta = Math.PI * (i / 20) + Math.PI * 1.5;
        positions[x + xo] = cap * radius * Math.sin(theta);
        positions[x + yo] = cap * (height * 0.5 + radius * Math.cos(theta));
        positions[x + zo] = 0;
        x += 3;
        theta = Math.PI * ((i + 1) / 20) + Math.PI * 1.5;
        positions[x + xo] = cap * radius * Math.sin(theta);
        positions[x + yo] = cap * (height * 0.5 + radius * Math.cos(theta));
        positions[x + zo] = 0;
        x += 3
      }
    }
    for(i = 0;i < 4;i++) {
      theta = 2 * Math.PI * (i / 4);
      positions[x + xo] = radius * Math.cos(theta);
      positions[x + yo] = height * 0.5;
      positions[x + zo] = radius * Math.sin(theta);
      x += 3;
      theta = 2 * Math.PI * (i / 4);
      positions[x + xo] = radius * Math.cos(theta);
      positions[x + yo] = -height * 0.5;
      positions[x + zo] = radius * Math.sin(theta);
      x += 3
    }
    vertexBuffer.unlock()
  }, createPhysicalShape:function(entity, data) {
    var shape = null;
    var axis = data.axis !== undefined ? data.axis : 1;
    var radius = data.radius || 0.5;
    var height = Math.max((data.height || 2) - 2 * radius, 0);
    if(typeof Ammo !== "undefined") {
      switch(axis) {
        case 0:
          shape = new Ammo.btCapsuleShapeX(radius, height);
          break;
        case 1:
          shape = new Ammo.btCapsuleShape(radius, height);
          break;
        case 2:
          shape = new Ammo.btCapsuleShapeZ(radius, height);
          break
      }
    }
    return shape
  }, updateDebugShape:function(entity, data) {
    var root = data.model.graph;
    root.setPosition(entity.getPosition());
    root.setRotation(entity.getRotation());
    root.setLocalScale(1, 1, 1)
  }, recreatePhysicalShapes:function(component) {
    var model = component.data.model;
    if(model) {
      var vertexBuffer = this.createDebugMesh(component.data).mesh.vertexBuffer;
      this.updateCapsuleShape(component.data, vertexBuffer);
      CollisionCapsuleSystemImpl._super.recreatePhysicalShapes.call(this, component)
    }
  }});
  CollisionCylinderSystemImpl = function(system) {
  };
  CollisionCylinderSystemImpl = pc.inherits(CollisionCylinderSystemImpl, CollisionSystemImpl);
  CollisionCylinderSystemImpl.prototype = pc.extend(CollisionCylinderSystemImpl.prototype, {createDebugMesh:function(data) {
    if(data.model && data.model.meshInstances && data.model.meshInstances.length) {
      return data.model.meshInstances[0]
    }else {
      var gd = this.system.app.graphicsDevice;
      var format = new pc.VertexFormat(gd, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
      var vertexBuffer = new pc.VertexBuffer(gd, format, 168, pc.BUFFER_DYNAMIC);
      this.updateCylinderShape(data, vertexBuffer);
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffer;
      mesh.primitive[0].type = pc.PRIMITIVE_LINES;
      mesh.primitive[0].base = 0;
      mesh.primitive[0].count = vertexBuffer.getNumVertices();
      mesh.primitive[0].indexed = false;
      if(!this.material) {
        var material = new pc.BasicMaterial;
        material.color = new pc.Color(0, 0, 1, 1);
        material.update();
        this.material = material
      }
      return new pc.MeshInstance(data.model.graph, mesh, this.material)
    }
  }, updateCylinderShape:function(data, vertexBuffer) {
    var axis = data.axis !== undefined ? data.axis : 1;
    var radius = data.radius !== undefined ? data.radius : 0.5;
    var height = data.height !== undefined ? data.height : 1;
    var positions = new Float32Array(vertexBuffer.lock());
    var xo = 0;
    var yo = 1;
    var zo = 2;
    if(axis === 0) {
      xo = 1;
      yo = 0;
      zo = 2
    }else {
      if(axis === 2) {
        xo = 0;
        yo = 2;
        zo = 1
      }
    }
    var i, x = 0;
    var theta;
    for(cap = -1;cap < 2;cap += 2) {
      for(i = 0;i < 40;i++) {
        theta = 2 * Math.PI * (i / 40);
        positions[x + xo] = radius * Math.cos(theta);
        positions[x + yo] = cap * height * 0.5;
        positions[x + zo] = radius * Math.sin(theta);
        x += 3;
        theta = 2 * Math.PI * ((i + 1) / 40);
        positions[x + xo] = radius * Math.cos(theta);
        positions[x + yo] = cap * height * 0.5;
        positions[x + zo] = radius * Math.sin(theta);
        x += 3
      }
    }
    for(i = 0;i < 4;i++) {
      theta = 2 * Math.PI * (i / 4);
      positions[x + xo] = radius * Math.cos(theta);
      positions[x + yo] = height * 0.5;
      positions[x + zo] = radius * Math.sin(theta);
      x += 3;
      theta = 2 * Math.PI * (i / 4);
      positions[x + xo] = radius * Math.cos(theta);
      positions[x + yo] = -height * 0.5;
      positions[x + zo] = radius * Math.sin(theta);
      x += 3
    }
    vertexBuffer.unlock()
  }, createPhysicalShape:function(entity, data) {
    var halfExtents = null;
    var shape = null;
    var axis = data.axis !== undefined ? data.axis : 1;
    var radius = data.radius !== undefined ? data.radius : 0.5;
    var height = data.height !== undefined ? data.height : 1;
    if(typeof Ammo !== "undefined") {
      switch(axis) {
        case 0:
          halfExtents = new Ammo.btVector3(height * 0.5, radius, radius);
          shape = new Ammo.btCylinderShapeX(halfExtents);
          break;
        case 1:
          halfExtents = new Ammo.btVector3(radius, height * 0.5, radius);
          shape = new Ammo.btCylinderShape(halfExtents);
          break;
        case 2:
          halfExtents = new Ammo.btVector3(radius, radius, height * 0.5);
          shape = new Ammo.btCylinderShapeZ(halfExtents);
          break
      }
    }
    return shape
  }, updateDebugShape:function(entity, data) {
    var root = data.model.graph;
    root.setPosition(entity.getPosition());
    root.setRotation(entity.getRotation());
    root.setLocalScale(1, 1, 1)
  }, recreatePhysicalShapes:function(component) {
    var model = component.data.model;
    if(model) {
      var vertexBuffer = this.createDebugMesh(component.data).mesh.vertexBuffer;
      this.updateCylinderShape(component.data, vertexBuffer);
      CollisionCylinderSystemImpl._super.recreatePhysicalShapes.call(this, component)
    }
  }});
  CollisionMeshSystemImpl = function(system) {
    this.hasDebugShape = false
  };
  CollisionMeshSystemImpl = pc.inherits(CollisionMeshSystemImpl, CollisionSystemImpl);
  CollisionMeshSystemImpl.prototype = pc.extend(CollisionMeshSystemImpl.prototype, {beforeInitialize:function(component, data) {
  }, createPhysicalShape:function(entity, data) {
    if(typeof Ammo !== "undefined" && data.model) {
      var model = data.model;
      var shape = new Ammo.btCompoundShape;
      var i, j;
      for(i = 0;i < model.meshInstances.length;i++) {
        var meshInstance = model.meshInstances[i];
        var mesh = meshInstance.mesh;
        var ib = mesh.indexBuffer[pc.RENDERSTYLE_SOLID];
        var vb = mesh.vertexBuffer;
        var format = vb.getFormat();
        var stride = format.size / 4;
        var positions;
        for(j = 0;j < format.elements.length;j++) {
          var element = format.elements[j];
          if(element.name === pc.SEMANTIC_POSITION) {
            positions = new Float32Array(vb.lock(), element.offset)
          }
        }
        var indices = new Uint16Array(ib.lock());
        var numTriangles = mesh.primitive[0].count / 3;
        var v1 = new Ammo.btVector3;
        var v2 = new Ammo.btVector3;
        var v3 = new Ammo.btVector3;
        var i1, i2, i3;
        var base = mesh.primitive[0].base;
        var triMesh = new Ammo.btTriangleMesh;
        for(j = 0;j < numTriangles;j++) {
          i1 = indices[base + j * 3] * stride;
          i2 = indices[base + j * 3 + 1] * stride;
          i3 = indices[base + j * 3 + 2] * stride;
          v1.setValue(positions[i1], positions[i1 + 1], positions[i1 + 2]);
          v2.setValue(positions[i2], positions[i2 + 1], positions[i2 + 2]);
          v3.setValue(positions[i3], positions[i3 + 1], positions[i3 + 2]);
          triMesh.addTriangle(v1, v2, v3, true)
        }
        var useQuantizedAabbCompression = true;
        var triMeshShape = new Ammo.btBvhTriangleMeshShape(triMesh, useQuantizedAabbCompression);
        var wtm = meshInstance.node.getWorldTransform();
        var scl = wtm.getScale();
        triMeshShape.setLocalScaling(new Ammo.btVector3(scl.x, scl.y, scl.z));
        var pos = meshInstance.node.getPosition();
        var rot = meshInstance.node.getRotation();
        var transform = new Ammo.btTransform;
        transform.setIdentity();
        transform.getOrigin().setValue(pos.x, pos.y, pos.z);
        var ammoQuat = new Ammo.btQuaternion;
        ammoQuat.setValue(rot.x, rot.y, rot.z, rot.w);
        transform.setRotation(ammoQuat);
        shape.addChildShape(transform, triMeshShape)
      }
      var entityTransform = entity.getWorldTransform();
      var scale = entityTransform.getScale();
      var vec = new Ammo.btVector3;
      vec.setValue(scale.x, scale.y, scale.z);
      shape.setLocalScaling(vec);
      return shape
    }else {
      return undefined
    }
  }, recreatePhysicalShapes:function(component) {
    var data = component.data;
    if(data.asset !== null) {
      this.loadModelAsset(component)
    }else {
      data.model = null;
      this.doRecreatePhysicalShape(component)
    }
  }, loadModelAsset:function(component) {
    var id = component.data.asset;
    var entity = component.entity;
    var data = component.data;
    var options = {parent:entity.getRequest()};
    var asset = this.system.app.assets.getAssetById(id);
    if(!asset) {
      logERROR(pc.string.format("Trying to load model before asset {0} is loaded.", id));
      return
    }
    if(asset.resource) {
      data.model = asset.resource;
      this.doRecreatePhysicalShape(component)
    }else {
      this.system.app.assets.load(asset, [], options).then(function(resources) {
        var model = resources[0];
        data.model = model;
        this.doRecreatePhysicalShape(component)
      }.bind(this))
    }
  }, doRecreatePhysicalShape:function(component) {
    var entity = component.entity;
    var data = component.data;
    if(data.model) {
      if(data.shape) {
        Ammo.destroy(data.shape)
      }
      data.shape = this.createPhysicalShape(entity, data);
      if(entity.rigidbody) {
        entity.rigidbody.createBody()
      }else {
        if(!entity.trigger) {
          entity.trigger = new pc.Trigger(this.system.app, component, data)
        }else {
          entity.trigger.initialize(data)
        }
      }
    }else {
      this.remove(entity, data)
    }
  }, updateTransform:function(component, position, rotation, scale) {
    if(component.shape) {
      var entityTransform = component.entity.getWorldTransform();
      var worldScale = entityTransform.getScale();
      var previousScale = component.shape.getLocalScaling();
      if(worldScale.x !== previousScale.x() || worldScale.y !== previousScale.y() || worldScale.z !== previousScale.z()) {
        this.doRecreatePhysicalShape(component)
      }
    }
    CollisionMeshSystemImpl._super.updateTransform.call(this, component, position, rotation, scale)
  }});
  return{CollisionComponentSystem:CollisionComponentSystem}
}());
pc.extend(pc, function() {
  var CollisionComponent = function CollisionComponent(system, entity) {
    this.on("set_type", this.onSetType, this);
    this.on("set_halfExtents", this.onSetHalfExtents, this);
    this.on("set_radius", this.onSetRadius, this);
    this.on("set_height", this.onSetHeight, this);
    this.on("set_axis", this.onSetAxis, this);
    this.on("set_asset", this.onSetAsset, this);
    entity.on("livelink:updatetransform", this.onLiveLinkUpdateTransform, this);
    system.on("beforeremove", this.onBeforeRemove, this)
  };
  CollisionComponent = pc.inherits(CollisionComponent, pc.Component);
  pc.extend(CollisionComponent.prototype, {onSetType:function(name, oldValue, newValue) {
    if(oldValue !== newValue) {
      this.system.changeType(this, oldValue, newValue)
    }
  }, onSetHalfExtents:function(name, oldValue, newValue) {
    if(this.data.initialized && this.data.type === "box") {
      this.system.recreatePhysicalShapes(this)
    }
  }, onSetRadius:function(name, oldValue, newValue) {
    if(this.data.initialized && (this.data.type === "sphere" || this.data.type === "capsule" || this.data.type === "cylinder")) {
      this.system.recreatePhysicalShapes(this)
    }
  }, onSetHeight:function(name, oldValue, newValue) {
    if(this.data.initialized && (this.data.type === "capsule" || this.data.type === "cylinder")) {
      this.system.recreatePhysicalShapes(this)
    }
  }, onSetAxis:function(name, oldValue, newValue) {
    if(this.data.initialized && (this.data.type === "capsule" || this.data.type === "cylinder")) {
      this.system.recreatePhysicalShapes(this)
    }
  }, onSetAsset:function(name, oldValue, newValue) {
    var asset;
    if(oldValue) {
      asset = this.system.app.assets.getAssetById(oldValue);
      if(asset) {
        asset.off("remove", this.onAssetRemoved, this)
      }
    }
    if(newValue) {
      if(newValue instanceof pc.asset.Asset) {
        this.data.asset = newValue.id
      }
      asset = this.system.app.assets.getAssetById(this.data.asset);
      if(asset) {
        asset.off("remove", this.onAssetRemoved, this);
        asset.on("remove", this.onAssetRemoved, this)
      }
    }
    if(this.data.initialized && this.data.type === "mesh") {
      this.system.recreatePhysicalShapes(this)
    }
  }, onAssetRemoved:function(asset) {
    asset.off("remove", this.onAssetRemoved, this);
    if(this.data.asset === asset.id) {
      this.asset = null
    }
  }, onEnable:function() {
    CollisionComponent._super.onEnable.call(this);
    if(this.entity.trigger) {
      this.entity.trigger.enable()
    }else {
      if(this.entity.rigidbody) {
        if(this.entity.rigidbody.enabled) {
          this.entity.rigidbody.enableSimulation()
        }
      }
    }
  }, onDisable:function() {
    CollisionComponent._super.onDisable.call(this);
    if(this.entity.trigger) {
      this.entity.trigger.disable()
    }else {
      if(this.entity.rigidbody) {
        this.entity.rigidbody.disableSimulation()
      }
    }
  }, onLiveLinkUpdateTransform:function(position, rotation, scale) {
    if(this.enabled && this.entity.enabled) {
      this.system.onTransformChanged(this, position, rotation, scale)
    }
  }, onBeforeRemove:function(entity, component) {
    if(this === component) {
      entity.off("livelink:updatetransform", this.onLiveLinkUpdateTransform, this);
      this.system.off("beforeremove", this.onBeforeRemove, this)
    }
  }});
  return{CollisionComponent:CollisionComponent}
}());
pc.extend(pc, function() {
  var CollisionComponentData = function() {
    this.enabled = true;
    this.type = "box";
    this.halfExtents = new pc.Vec3(0.5, 0.5, 0.5);
    this.radius = 0.5;
    this.axis = 1;
    this.height = 2;
    this.asset = null;
    this.shape = null;
    this.model = null;
    this.initialized = false
  };
  CollisionComponentData = pc.inherits(CollisionComponentData, pc.ComponentData);
  return{CollisionComponentData:CollisionComponentData}
}());
pc.extend(pc, function() {
  var BallSocketJointComponentSystem = function BallSocketJointComponentSystem(app) {
    this.id = "ballsocketjoint";
    app.systems.add(this.id, this);
    this.ComponentType = pc.BallSocketJointComponent;
    this.DataType = pc.BallSocketJointComponentData;
    this.schema = [{name:"pivot", displayName:"Pivot", description:"Local space pivot", type:"vector", options:{min:0, step:0.1}, defaultValue:[0, 0, 0]}, {name:"position", displayName:"Position", description:"World space joint position", type:"vector", options:{min:0, step:0.1}, defaultValue:[0, 0, 0]}, {name:"tau", displayName:"Tau", description:"TBD", type:"number", defaultValue:0.001, options:{min:0, max:1}}, {name:"damping", displayName:"Damping", description:"Damping", type:"number", defaultValue:1,
    options:{min:0, max:1}}, {name:"impulseClamp", displayName:"Impulse Clamp", description:"Impulse Clamp", type:"number", defaultValue:0, options:{min:0, max:100}}, {name:"constraint", exposed:false}];
    this.debugRender = false;
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("update", this.onUpdate, this);
    pc.ComponentSystem.on("toolsUpdate", this.onToolsUpdate, this)
  };
  BallSocketJointComponentSystem = pc.inherits(BallSocketJointComponentSystem, pc.ComponentSystem);
  BallSocketJointComponentSystem.prototype = pc.extend(BallSocketJointComponentSystem.prototype, {onLibraryLoaded:function() {
    if(typeof Ammo !== "undefined") {
    }else {
      pc.ComponentSystem.off("update", this.onUpdate, this)
    }
  }, initializeComponentData:function(component, data, properties) {
    if(typeof Ammo !== "undefined") {
      if(component.entity.rigidbody) {
        if(data.pivot && pc.type(data.pivot) === "array") {
          data.pivot = new pc.Vec3(data.pivot[0], data.pivot[1], data.pivot[2])
        }
        if(data.position && pc.type(data.position) === "array") {
          data.position = new pc.Vec3(data.position[0], data.position[1], data.position[2])
        }
        var pivotA = new Ammo.btVector3(data.pivot.x, data.pivot.y, data.pivot.z);
        var body = component.entity.rigidbody.body;
        data.constraint = new Ammo.btPoint2PointConstraint(body, pivotA);
        var pivotB = data.constraint.getPivotInB();
        data.position = [pivotB.x(), pivotB.y(), pivotB.z()];
        var app = this.app;
        app.systems.rigidbody.addConstraint(data.constraint)
      }
    }
    properties = ["constraint", "pivot", "position", "tau", "damping", "impulseClamp"];
    BallSocketJointComponentSystem._super.initializeComponentData.call(this, component, data, properties)
  }, cloneComponent:function(entity, clone) {
    var data = {pivot:[entity.ballsocketjoint.pivot.x, entity.ballsocketjoint.pivot.y, entity.ballsocketjoint.pivot.z], position:[entity.ballsocketjoint.position.x, entity.ballsocketjoint.position.y, entity.ballsocketjoint.position.z], tau:entity.ballsocketjoint.tau, damping:entity.ballsocketjoint.damping, impulseClamp:entity.ballsocketjoint.impulseClamp};
    return this.addComponent(clone, data)
  }, onRemove:function(entity, data) {
    if(data.constraint) {
      this.app.systems.rigidbody.removeConstraint(data.constraint)
    }
  }, setDebugRender:function(value) {
    this.debugRender = value
  }, onUpdate:function(dt) {
    if(this.debugRender) {
      this.updateDebugShapes()
    }
  }, onToolsUpdate:function(dt) {
    this.updateDebugShapes()
  }, updateDebugShapes:function() {
    var components = this.store;
    for(var id in components) {
      var entity = components[id].entity;
      var data = components[id].data
    }
  }});
  return{BallSocketJointComponentSystem:BallSocketJointComponentSystem}
}());
pc.extend(pc, function() {
  var BallSocketJointComponent = function BallSocketJointComponent(system, entity) {
    this.on("set_pivot", this.onSetPivot, this);
    this.on("set_position", this.onSetPosition, this);
    this.on("set_tau", this.onSetTau, this);
    this.on("set_damping", this.onSetDamping, this);
    this.on("set_impulseClamp", this.onSetImpulseClamp, this)
  };
  BallSocketJointComponent = pc.inherits(BallSocketJointComponent, pc.Component);
  pc.extend(BallSocketJointComponent.prototype, {onSetPivot:function(name, oldValue, newValue) {
    if(typeof Ammo !== "undefined") {
      if(this.data.constraint) {
        var pivotA = new Ammo.btVector3(newValue.x, newValue.y, newValue.z);
        this.data.constraint.setPivotA(pivotA)
      }
    }
  }, onSetPosition:function(name, oldValue, newValue) {
    if(typeof Ammo !== "undefined") {
      if(this.data.constraint) {
        var pivotB = new Ammo.btVector3(newValue.x, newValue.y, newValue.z);
        this.data.constraint.setPivotB(pivotB)
      }
    }
  }, onSetTau:function(name, oldValue, newValue) {
    if(typeof Ammo !== "undefined") {
      if(this.data.constraint) {
        this.data.constraint.get_m_setting().set_m_tau(newValue)
      }
    }
  }, onSetDamping:function(name, oldValue, newValue) {
    if(typeof Ammo !== "undefined") {
      if(this.data.constraint) {
        this.data.constraint.get_m_setting().set_m_damping(newValue)
      }
    }
  }, onSetImpulseClamp:function(name, oldValue, newValue) {
    if(typeof Ammo !== "undefined") {
      if(this.data.constraint) {
        this.data.constraint.get_m_setting().set_m_impulseClamp(newValue)
      }
    }
  }});
  return{BallSocketJointComponent:BallSocketJointComponent}
}());
pc.extend(pc, function() {
  var BallSocketJointComponentData = function() {
    this.pivot = new pc.Vec3(0, 0, 0);
    this.position = new pc.Vec3(0, 0, 0);
    this.tau = 0.3;
    this.damping = 1;
    this.impulseClamp = 0;
    this.constraint = null
  };
  BallSocketJointComponentData = pc.inherits(BallSocketJointComponentData, pc.ComponentData);
  return{BallSocketJointComponentData:BallSocketJointComponentData}
}());
pc.extend(pc, function() {
  var ParticleSystemComponentSystem = function ParticleSystemComponentSystem(app) {
    this.id = "particlesystem";
    this.description = "Updates and renders particle system in the scene.";
    app.systems.add(this.id, this);
    this.ComponentType = pc.ParticleSystemComponent;
    this.DataType = pc.ParticleSystemComponentData;
    this.schema = [{name:"enabled", displayName:"Enabled", description:"Enable or disable the component", type:"boolean", defaultValue:true}, {name:"autoPlay", displayName:"Auto Play", description:"Play automatically on start", type:"boolean", defaultValue:true}, {name:"numParticles", displayName:"Particle Count", description:"Total number of particles allocated", type:"number", defaultValue:30, options:{min:1, max:4096, step:1}}, {name:"lifetime", displayName:"Lifetime", description:"The lifetime of each particle in seconds",
    type:"number", defaultValue:5, options:{min:0, step:0.01}}, {name:"rate", displayName:"Emission Rate", description:"Delay between emission of each particle in seconds", type:"number", defaultValue:0.1, options:{min:0, step:0.01}}, {name:"rate2", displayName:"Emission Rate 2", description:"Defines the random range of Emission Rate", type:"number", defaultValue:0.1, options:{min:0, step:0.01}}, {name:"startAngle", displayName:"Start Angle", description:"The starting angle of each particle in degrees",
    type:"number", defaultValue:0, options:{min:0, step:0.01}}, {name:"startAngle2", displayName:"Start Angle 2", description:"Defines the random range of Start Angle", type:"number", defaultValue:0, options:{min:0, step:0.01}}, {name:"loop", displayName:"Loop", description:"Enables looping", type:"boolean", defaultValue:true}, {name:"preWarm", displayName:"Pre Warm", description:"Starts particles in the middle of simulation", type:"boolean", defaultValue:false, filter:{loop:true}}, {name:"lighting",
    displayName:"Lighting", description:"Enables particle lighting; Only ambient and directional lights are used", type:"boolean", defaultValue:false}, {name:"halfLambert", displayName:"Half-Lambert", description:"Uses Half-Lambert shading instead of Lambert, for softer lighting.", type:"boolean", defaultValue:false, filter:{lighting:true}}, {name:"intensity", displayName:"Color Intensity", description:"Controls the intensity of the colors for each particle", type:"number", defaultValue:1, options:{min:0,
    max:10, step:0.1}}, {name:"depthWrite", displayName:"Depth Write", description:"Enables writing to depth buffer, therefore giving accurate occlusion between particles. Do not use it for semi-transparent particles", type:"boolean", defaultValue:false}, {name:"depthSoftening", displayName:"Depth Softening", description:"Softens particle intersections with scene geometry", type:"number", defaultValue:0, options:{min:0, max:1, step:0.01}}, {name:"sort", displayName:"Sorting Mode", description:"How to sort particles; Any value other than None will force CPU mode",
    type:"enumeration", options:{enumerations:[{name:"None", value:pc.PARTICLESORT_NONE}, {name:"Camera Distance", value:pc.PARTICLESORT_DISTANCE}, {name:"Newer First", value:pc.PARTICLESORT_NEWER_FIRST}, {name:"Older First", value:pc.PARTICLESORT_OLDER_FIRST}]}, defaultValue:0}, {name:"blendType", displayName:"Blending Mode", description:"How to blend particles", type:"enumeration", options:{enumerations:[{name:"Alpha", value:pc.BLEND_NORMAL}, {name:"Add", value:pc.BLEND_ADDITIVE}, {name:"Multiply",
    value:pc.BLEND_MULTIPLICATIVE}]}, defaultValue:pc.BLEND_NORMAL}, {name:"stretch", displayName:"Stretch", description:"Stretch particles in the direction of motion", type:"number", defaultValue:0, options:{min:0, step:0.01}}, {name:"alignToMotion", displayName:"Align To Motion", description:"Rotates particles along the direction of motion", type:"boolean", defaultValue:false}, {name:"emitterShape", displayName:"Emitter Shape", description:"Defines a shape in which particles are allowed to spawn",
    type:"enumeration", options:{enumerations:[{name:"Box", value:pc.EMITTERSHAPE_BOX}, {name:"Sphere", value:pc.EMITTERSHAPE_SPHERE}]}, defaultValue:pc.EMITTERSHAPE_BOX}, {name:"emitterExtents", displayName:"Emitter Extents", description:"Defines a local box in which particles are allowed to spawn", type:"vector", filter:{emitterShape:pc.EMITTERSHAPE_BOX}, defaultValue:[0, 0, 0]}, {name:"emitterRadius", displayName:"Emitter Radius", description:"Defines radius in which particles are allowed to spawn",
    type:"number", filter:{emitterShape:pc.EMITTERSHAPE_SPHERE}, defaultValue:0}, {name:"initialVelocity", displayName:"Initial velocity", description:"Adds initial local velocity with defined length and direction based on spawn shape", type:"number", defaultValue:0, options:{min:0, step:0.1}}, {name:"wrap", displayName:"Wrap", description:"Set to true to wrap particles around the camera. Used for infinite atmospheric effect like rain or mist.", type:"boolean", defaultValue:false}, {name:"wrapBounds",
    displayName:"Wrap Bounds", description:"AABB around to camera to wrap particles. Used for infinite atmospheric effect like rain or mist.", type:"vector", filter:{wrap:true}, defaultValue:[0, 0, 0]}, {name:"colorMapAsset", displayName:"Color Map", description:"Color map used for each particle, with alpha channel", type:"asset", options:{max:1, type:"texture"}, defaultValue:null}, {name:"normalMapAsset", displayName:"Normal Map", description:"Normal map used for each particle", type:"asset", options:{max:1,
    type:"texture"}, defaultValue:null}, {name:"mesh", displayName:"Particle Mesh", description:"Mesh to use as particle; Will be quad, if not set", type:"asset", options:{max:1, type:"model"}, defaultValue:null}, {name:"localVelocityGraph", displayName:"Local Velocity", description:"Curves that define the local velocity of particles over time.", type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, 0], [0, 0], [0, 0]], betweenCurves:false}, options:{curveNames:["X", "Y", "Z"], secondCurve:"localVelocityGraph2"}},
    {name:"localVelocityGraph2", displayName:"Local Velocity 2", description:"Curves that define the range of the Local Velocity", type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, 0], [0, 0], [0, 0]]}, filter:{always:false}}, {name:"velocityGraph", displayName:"Velocity", description:"Curves that define the world velocity of particles over time.", type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, -1], [0, -1], [0, -1]], betweenCurves:true}, options:{curveNames:["X",
    "Y", "Z"], secondCurve:"velocityGraph2"}}, {name:"velocityGraph2", displayName:"Velocity 2", description:"Curves that define the range of the Velocity", type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, 1], [0, 1], [0, 1]]}, options:{curveNames:["X", "Y", "Z"]}, filter:{always:false}}, {name:"rotationSpeedGraph", displayName:"Rotation Speed", description:"Curve that defines how fast particles rotate over time.", type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 0],
    betweenCurves:false}, options:{curveNames:["Angle"], secondCurve:"rotationSpeedGraph2", verticalAxisValue:360}, filter:{alignToMotion:false}}, {name:"rotationSpeedGraph2", displayName:"Rotation Speed 2", description:"Curve that defines the range of Rotation Speed", type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 0]}, options:{curveNames:["Angle"], verticalAxisValue:360}, filter:{always:false}}, {name:"scaleGraph", displayName:"Scale", description:"Curve that defines the scale of particles over time",
    type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 0.1], betweenCurves:false}, options:{curveNames:["Scale"], verticalAxisValue:1, secondCurve:"scaleGraph2", min:0}}, {name:"scaleGraph2", displayName:"Scale 2", description:"Curve that defines the range of Scale", type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 0.1]}, options:{curveNames:["Scale"], verticalAxisValue:1, min:0}, filter:{always:false}}, {name:"colorGraph", displayName:"Color", description:"Curves that define the color of particles over time",
    type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, 1], [0, 1], [0, 1]], betweenCurves:false}, options:{curveNames:["R", "G", "B"], max:1, min:0}}, {name:"colorGraph2", displayName:"Color 2", description:"Curves that define the range of Color", exposed:false, type:"curveset", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[[0, 1, 1, 1], [0, 1, 1, 1], [0, 1, 1, 1]]}, options:{curveNames:["R", "G", "B"], max:1, min:0}}, {name:"alphaGraph", displayName:"Opacity", description:"Curve that defines the opacity of particles over time",
    type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 1], betweenCurves:false}, options:{curveNames:["Opacity"], max:1, min:0, secondCurve:"alphaGraph2"}}, {name:"alphaGraph2", displayName:"Opacity 2", description:"Curve that defines the range of Opacity", type:"curve", defaultValue:{type:pc.CURVE_SMOOTHSTEP, keys:[0, 1]}, options:{curveNames:["Opacity"], max:1, min:0}, filter:{always:false}}, {name:"colorMap", exposed:false}, {name:"normalMap", exposed:false}];
    this.exposeProperties();
    this.propertyTypes = {};
    for(var i = 0;i < this.schema.length;i++) {
      var s = this.schema[i];
      this.propertyTypes[s.name] = s.type
    }
    this.on("remove", this.onRemove, this);
    pc.ComponentSystem.on("update", this.onUpdate, this);
    pc.ComponentSystem.on("toolsUpdate", this.onToolsUpdate, this);
    var gd = app.graphicsDevice;
    this.debugMesh = this._createDebugMesh();
    this.debugMaterial = new pc.BasicMaterial;
    this.debugMaterial.color = new pc.Color(1, 0.5, 0, 1);
    this.debugMaterial.update()
  };
  ParticleSystemComponentSystem = pc.inherits(ParticleSystemComponentSystem, pc.ComponentSystem);
  pc.extend(ParticleSystemComponentSystem.prototype, {initializeComponentData:function(component, data, properties) {
    properties = [];
    var types = this.propertyTypes;
    var type;
    for(var prop in data) {
      if(data.hasOwnProperty(prop)) {
        properties.push(prop)
      }
      if(types[prop] === "vector") {
        if(pc.type(data[prop]) === "array") {
          data[prop] = new pc.Vec3(data[prop][0], data[prop][1], data[prop][2])
        }
      }else {
        if(types[prop] === "curve") {
          if(!(data[prop] instanceof pc.Curve)) {
            type = data[prop].type;
            data[prop] = new pc.Curve(data[prop].keys);
            data[prop].type = type
          }
        }else {
          if(types[prop] === "curveset") {
            if(!(data[prop] instanceof pc.CurveSet)) {
              type = data[prop].type;
              data[prop] = new pc.CurveSet(data[prop].keys);
              data[prop].type = type
            }
          }
        }
      }
    }
    ParticleSystemComponentSystem._super.initializeComponentData.call(this, component, data, properties);
    if(this._inTools) {
      this._createDebugShape(component)
    }
  }, cloneComponent:function(entity, clone) {
    var source = entity.particlesystem.data;
    var schema = this.schema;
    var data = {};
    for(var i = 0, len = schema.length;i < len;i++) {
      var prop = schema[i];
      var sourceProp = source[prop.name];
      if(sourceProp instanceof pc.Vec3 || sourceProp instanceof pc.Curve || sourceProp instanceof pc.CurveSet) {
        sourceProp = sourceProp.clone();
        data[prop.name] = sourceProp
      }else {
        if(sourceProp !== null && sourceProp !== undefined) {
          data[prop.name] = sourceProp
        }
      }
    }
    return this.addComponent(clone, data)
  }, onUpdate:function(dt) {
    var components = this.store;
    var currentCamera;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var c = components[id];
        var entity = c.entity;
        var data = c.data;
        if(data.enabled && entity.enabled) {
          var emitter = data.model.emitter;
          if(!data.paused) {
            emitter.addTime(dt)
          }
        }
      }
    }
  }, onToolsUpdate:function(dt) {
    var components = this.store;
    for(var id in components) {
      if(components.hasOwnProperty(id)) {
        var c = components[id];
        if(c.data.enabled && c.entity.enabled) {
          this._updateDebugShape(c)
        }
      }
    }
  }, onRemove:function(entity, data) {
    if(data.model) {
      this.app.scene.removeModel(data.model);
      entity.removeChild(data.model.getGraph());
      data.model = null
    }
  }, _createDebugMesh:function() {
    var gd = this.app.graphicsDevice;
    var format = new pc.VertexFormat(gd, [{semantic:pc.SEMANTIC_POSITION, components:3, type:pc.ELEMENTTYPE_FLOAT32}]);
    var vertexBuffer = new pc.VertexBuffer(gd, format, 8);
    var positions = new Float32Array(vertexBuffer.lock());
    positions.set([-0.5, -0.5, -0.5, -0.5, -0.5, 0.5, 0.5, -0.5, 0.5, 0.5, -0.5, -0.5, -0.5, 0.5, -0.5, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, -0.5]);
    vertexBuffer.unlock();
    var indexBuffer = new pc.IndexBuffer(gd, pc.INDEXFORMAT_UINT8, 24);
    var indices = new Uint8Array(indexBuffer.lock());
    indices.set([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]);
    indexBuffer.unlock();
    var mesh = new pc.Mesh;
    mesh.vertexBuffer = vertexBuffer;
    mesh.indexBuffer[0] = indexBuffer;
    mesh.primitive[0].type = pc.PRIMITIVE_LINES;
    mesh.primitive[0].base = 0;
    mesh.primitive[0].count = indexBuffer.getNumIndices();
    mesh.primitive[0].indexed = true;
    return mesh
  }, _createDebugShape:function(component) {
    var node = new pc.GraphNode;
    var model = new pc.Model;
    model.graph = node;
    model.meshInstances = [new pc.MeshInstance(node, this.debugMesh, this.debugMaterial)];
    component.data.debugShape = model;
    if(component.data.enabled && component.entity.enabled) {
      this.app.root.addChild(node);
      this.app.scene.addModel(model)
    }
    return model
  }, _updateDebugShape:function(component) {
    var he = component.data.emitterExtents;
    var x = he.x;
    var y = he.y;
    var z = he.z;
    var entity = component.entity;
    var root = component.data.debugShape.graph;
    root.setPosition(entity.getPosition());
    root.setRotation(entity.getRotation());
    x = x || 5E-4;
    y = y || 5E-4;
    z = z || 5E-4;
    root.setLocalScale(x, y, z)
  }});
  return{ParticleSystemComponentSystem:ParticleSystemComponentSystem}
}());
pc.extend(pc, function() {
  var SIMPLE_PROPERTIES = ["emitterExtents", "emitterRadius", "colorMap", "normalMap", "loop", "initialVelocity"];
  var COMPLEX_PROPERTIES = ["numParticles", "lifetime", "rate", "rate2", "startAngle", "startAngle2", "lighting", "halfLambert", "intensity", "wrap", "wrapBounds", "depthWrite", "depthSoftening", "sort", "stretch", "alignToMotion", "preWarm", "emitterShape"];
  var GRAPH_PROPERTIES = ["scaleGraph", "scaleGraph2", "colorGraph", "colorGraph2", "alphaGraph", "alphaGraph2", "velocityGraph", "velocityGraph2", "localVelocityGraph", "localVelocityGraph2", "rotationSpeedGraph", "rotationSpeedGraph2"];
  var ParticleSystemComponent = function ParticleSystemComponent(system, entity) {
    this.on("set_colorMapAsset", this.onSetColorMapAsset, this);
    this.on("set_normalMapAsset", this.onSetNormalMapAsset, this);
    this.on("set_mesh", this.onSetMesh, this);
    this.on("set_loop", this.onSetLoop, this);
    this.on("set_blendType", this.onSetBlendType, this);
    SIMPLE_PROPERTIES.forEach(function(prop) {
      this.on("set_" + prop, this.onSetSimpleProperty, this)
    }.bind(this));
    COMPLEX_PROPERTIES.forEach(function(prop) {
      this.on("set_" + prop, this.onSetComplexProperty, this)
    }.bind(this));
    GRAPH_PROPERTIES.forEach(function(prop) {
      this.on("set_" + prop, this.onSetGraphProperty, this)
    }.bind(this))
  };
  ParticleSystemComponent = pc.inherits(ParticleSystemComponent, pc.Component);
  pc.extend(ParticleSystemComponent.prototype, {onSetColorMapAsset:function(name, oldValue, newValue) {
    var asset;
    if(oldValue) {
      asset = this.system.app.assets.getAssetById(oldValue);
      if(asset) {
        asset.off("remove", this.onColorMapRemoved, this)
      }
    }
    if(newValue) {
      asset = this._loadAsset(newValue, function(resource) {
        this.colorMap = resource
      }.bind(this));
      if(asset) {
        asset.on("remove", this.onColorMapRemoved, this)
      }
    }else {
      this.colorMap = null
    }
  }, onColorMapRemoved:function(asset) {
    asset.off("remove", this.onColorMapRemoved, this);
    this.colorMapAsset = null
  }, onSetNormalMapAsset:function(name, oldValue, newValue) {
    var asset;
    if(oldValue) {
      asset = this.system.app.assets.getAssetById(oldValue);
      if(asset) {
        asset.off("remove", this.onNormalMapRemoved, this)
      }
    }
    if(newValue) {
      asset = this._loadAsset(newValue, function(resource) {
        this.normalMap = resource
      }.bind(this));
      if(asset) {
        asset.on("remove", this.onNormalMapRemoved, this)
      }
    }else {
      this.normalMap = null
    }
  }, onNormalMapRemoved:function(asset) {
    asset.off("remove", this.onNormalMapRemoved, this);
    this.normalMapAsset = null
  }, _loadAsset:function(assetId, callback) {
    var asset = assetId instanceof pc.asset.Asset ? assetId : this.system.app.assets.getAssetById(assetId);
    if(!asset) {
      logERROR(pc.string.format("Trying to load particle system before asset {0} is loaded.", assetId));
      return
    }
    var resource;
    if(asset.resource) {
      callback(asset.resource)
    }else {
      var options = {parent:this.entity.getRequest()};
      this.system.app.assets.load(asset, [], options).then(function(resources) {
        callback(resources[0])
      })
    }
    return asset
  }, onSetMesh:function(name, oldValue, newValue) {
    var asset;
    if(oldValue && pc.type(oldValue) === "number") {
      asset = this.system.app.assets.getAssetById(oldValue);
      if(asset) {
        asset.off("remove", this.onMeshRemoved, this)
      }
    }
    if(newValue) {
      if(newValue instanceof pc.asset.Asset || pc.type(newValue) === "number") {
        asset = this._loadAsset(newValue, function(model) {
          this._onMeshChanged(model)
        }.bind(this));
        if(asset) {
          asset.on("remove", this.onMeshRemoved, this)
        }
      }else {
        this._onMeshChanged(newValue)
      }
    }else {
      this._onMeshChanged(null)
    }
  }, _onMeshChanged:function(mesh) {
    if(mesh) {
      if(mesh.meshInstances[0]) {
        mesh = mesh.meshInstances[0].mesh
      }else {
        mesh = null
      }
    }
    this.data.mesh = mesh;
    if(this.emitter) {
      this.emitter.mesh = mesh;
      this.emitter.resetMaterial();
      this.rebuild()
    }
  }, onMeshRemoved:function(asset) {
    asset.off("remove", this.onMeshRemoved, this);
    this.mesh = null
  }, onSetLoop:function(name, oldValue, newValue) {
    if(this.emitter) {
      this.emitter[name] = newValue;
      this.emitter.resetTime()
    }
  }, onSetBlendType:function(name, oldValue, newValue) {
    if(this.emitter) {
      this.emitter[name] = newValue;
      this.emitter.material.blendType = newValue;
      this.emitter.resetMaterial();
      this.rebuild()
    }
  }, onSetSimpleProperty:function(name, oldValue, newValue) {
    if(this.emitter) {
      this.emitter[name] = newValue;
      this.emitter.resetMaterial()
    }
  }, onSetComplexProperty:function(name, oldValue, newValue) {
    if(this.emitter) {
      this.emitter[name] = newValue;
      this.reset();
      this.emitter.resetMaterial();
      this.rebuild()
    }
  }, onSetGraphProperty:function(name, oldValue, newValue) {
    if(this.emitter) {
      this.emitter[name] = newValue;
      this.emitter.rebuildGraphs();
      this.emitter.resetMaterial()
    }
  }, onEnable:function() {
    if(!this.emitter && !this.system._inTools) {
      this.emitter = new pc.ParticleEmitter(this.system.app.graphicsDevice, {numParticles:this.data.numParticles, emitterExtents:this.data.emitterExtents, emitterRadius:this.data.emitterRadius, emitterShape:this.data.emitterShape, initialVelocity:this.data.initialVelocity, wrap:this.data.wrap, wrapBounds:this.data.wrapBounds, lifetime:this.data.lifetime, rate:this.data.rate, rate2:this.data.rate2, startAngle:this.data.startAngle, startAngle2:this.data.startAngle2, scaleGraph:this.data.scaleGraph,
      scaleGraph2:this.data.scaleGraph2, colorGraph:this.data.colorGraph, colorGraph2:this.data.colorGraph2, alphaGraph:this.data.alphaGraph, alphaGraph2:this.data.alphaGraph2, localVelocityGraph:this.data.localVelocityGraph, localVelocityGraph2:this.data.localVelocityGraph2, velocityGraph:this.data.velocityGraph, velocityGraph2:this.data.velocityGraph2, rotationSpeedGraph:this.data.rotationSpeedGraph, rotationSpeedGraph2:this.data.rotationSpeedGraph2, colorMap:this.data.colorMap, normalMap:this.data.normalMap,
      loop:this.data.loop, preWarm:this.data.preWarm, sort:this.data.sort, stretch:this.data.stretch, alignToMotion:this.data.alignToMotion, lighting:this.data.lighting, halfLambert:this.data.halfLambert, intensity:this.data.intensity, depthSoftening:this.data.depthSoftening, scene:this.system.app.scene, mesh:this.data.mesh, depthWrite:this.data.depthWrite, node:this.entity, blendType:this.data.blendType});
      this.emitter.meshInstance.node = this.entity;
      this.psys = new pc.Model;
      this.psys.graph = this.entity;
      this.psys.emitter = this.emitter;
      this.psys.meshInstances = [this.emitter.meshInstance];
      this.data.model = this.psys;
      this.emitter.psys = this.psys;
      if(!this.data.loop && !this.data.autoPlay) {
        this.pause()
      }
    }
    if(this.data.model) {
      if(!this.system.app.scene.containsModel(this.data.model)) {
        if(this.emitter.colorMap) {
          this.system.app.scene.addModel(this.data.model)
        }
      }
    }
    if(this.data.debugShape) {
      if(!this.system.app.scene.containsModel(this.data.debugShape)) {
        this.system.app.scene.addModel(this.data.debugShape);
        this.system.app.root.addChild(this.data.debugShape.graph)
      }
    }
    ParticleSystemComponent._super.onEnable.call(this)
  }, onDisable:function() {
    ParticleSystemComponent._super.onDisable.call(this);
    if(this.data.model) {
      if(this.system.app.scene.containsModel(this.data.model)) {
        this.system.app.scene.removeModel(this.data.model)
      }
    }
    if(this.data.debugShape) {
      this.system.app.root.removeChild(this.data.debugShape.graph);
      this.system.app.scene.removeModel(this.data.debugShape)
    }
  }, reset:function() {
    this.stop();
    if(this.emitter) {
      this.emitter.addTime(1E3);
      this.emitter.loop = this.data.loop;
      this.emitter.reset()
    }
  }, stop:function() {
    if(this.emitter) {
      this.emitter.loop = false;
      this.emitter.resetTime();
      this.emitter.addTime(0, true)
    }
  }, pause:function() {
    this.data.paused = true
  }, unpause:function() {
    this.data.paused = false
  }, play:function() {
    this.data.paused = false;
    if(this.emitter) {
      this.emitter.loop = this.data.loop;
      this.emitter.resetTime()
    }
  }, isPlaying:function() {
    if(this.data.paused) {
      return false
    }else {
      if(this.emitter && this.emitter.loop) {
        return true
      }else {
        return Date.now() <= this.emitter.endTime
      }
    }
  }, rebuild:function() {
    var enabled = this.enabled;
    this.enabled = false;
    if(this.emitter) {
      this.emitter.rebuild();
      this.emitter.meshInstance.node = this.entity;
      this.data.model.meshInstances = [this.emitter.meshInstance]
    }
    this.enabled = enabled
  }});
  return{ParticleSystemComponent:ParticleSystemComponent}
}());
pc.extend(pc, function() {
  var ParticleSystemComponentData = function() {
    this.numParticles = 1;
    this.rate = 1;
    this.rate2 = null;
    this.startAngle = 0;
    this.startAngle2 = null;
    this.lifetime = 50;
    this.emitterExtents = new pc.Vec3;
    this.emitterRadius = 0;
    this.emitterShape = pc.EMITTERSHAPE_BOX;
    this.initialVelocity = 0;
    this.wrapBounds = new pc.Vec3;
    this.colorMap = null;
    this.colorMapAsset = null;
    this.normalMap = null;
    this.normalMapAsset = null;
    this.loop = true;
    this.preWarm = false;
    this.sort = 0;
    this.mode = pc.PARTICLEMODE_GPU;
    this.scene = null;
    this.lighting = false;
    this.halfLambert = false;
    this.intensity = 1;
    this.stretch = 0;
    this.alignToMotion = false;
    this.depthSoftening = 0;
    this.mesh = null;
    this.depthWrite = false;
    this.scaleGraph = null;
    this.scaleGraph2 = null;
    this.colorGraph = null;
    this.colorGraph2 = null;
    this.alphaGraph = null;
    this.alphaGraph2 = null;
    this.localVelocityGraph = null;
    this.localVelocityGraph2 = null;
    this.velocityGraph = null;
    this.velocityGraph2 = null;
    this.rotationSpeedGraph = null;
    this.rotationSpeedGraph2 = null;
    this.blendType = pc.BLEND_NORMAL;
    this.model = null;
    this.enabled = true;
    this.paused = false;
    this.debugShape = null
  };
  ParticleSystemComponentData = pc.inherits(ParticleSystemComponentData, pc.ComponentData);
  return{ParticleSystemComponentData:ParticleSystemComponentData}
}());
pc.extend(pc, function() {
  var LiveLink = function(senderIdPrefix) {
    senderIdPrefix = senderIdPrefix || "";
    this._destinations = [];
    this._callbacks = {};
    this._linkid = senderIdPrefix + "-" + pc.guid.create();
    this._listener = null;
    this._handler = this._handleMessage.bind(this);
    window.addEventListener("message", this._handler, false);
    if(!pc.livelinks) {
      pc.livelinks = []
    }
    pc.livelinks.push(this)
  };
  LiveLink.prototype.detach = function() {
    this._listener = null;
    window.removeEventListener("message", this._handler, false)
  };
  LiveLink.prototype.addDestinationWindow = function(_window) {
    this._destinations.push(_window)
  };
  LiveLink.prototype.removeDestinationWindow = function(window) {
    var i;
    for(i = 0;i < this._destinations.length;++i) {
      if(this._destinations[i] == window) {
        this._destinations.splice(i, 1);
        break
      }
    }
  };
  LiveLink.prototype.send = function(msg, success, destinations) {
    success = success || function() {
    };
    destinations = destinations || this._destinations;
    var i, length = destinations.length;
    var closed = [];
    for(i = 0;i < length;i++) {
      var w = destinations[i];
      if(!w.closed) {
        var origin = w.location.protocol + "//" + w.location.host;
        this._send(msg, success, w, origin)
      }else {
        closed.push(w)
      }
    }
    length = closed.length;
    for(i = 0;i < length;i++) {
      this.removeDestinationWindow(closed[i])
    }
  };
  LiveLink.prototype._send = function(msg, success, _window, origin) {
    msg.senderid = this._linkid;
    if(this._callbacks[msg.id]) {
      this._callbacks[msg.id].count++
    }else {
      this._callbacks[msg.id] = {count:1, callback:success ? success.bind(this) : function() {
      }}
    }
    var data = pc.LiveLinkMessage.serialize(msg);
    if(_window === window) {
      pc.livelinks.forEach(function(link) {
        link._handleMessage({source:window, data:data})
      })
    }else {
      _window.postMessage(data, origin)
    }
  };
  LiveLink.prototype.listen = function(callback, _window) {
    if(this._listener) {
      throw new Error("LiveLink already listening");
    }
    this._listener = callback
  };
  LiveLink.prototype._handleMessage = function(event) {
    var msg, newmsg;
    var data = pc.LiveLinkMessage.deserialize(event.data);
    if(!data) {
      return
    }
    msg = new pc.LiveLinkMessage(data, event.source);
    if(this._linkid === msg.senderid) {
      return
    }
    if(msg.type == pc.LiveLinkMessageType.RECEIVED) {
      if(msg.content.received_from == this._linkid) {
        this._callbacks[msg.content.id].count--;
        if(this._callbacks[msg.content.id].count === 0) {
          this._callbacks[msg.content.id].callback();
          delete this._callbacks[msg.content.id]
        }
      }
    }else {
      if(this._listener) {
        this._listener(msg);
        newmsg = new pc.LiveLinkMessage;
        newmsg.type = pc.LiveLinkMessageType.RECEIVED;
        newmsg.content = {id:msg.id, received_from:msg.senderid};
        this._send(newmsg, null, event.source, event.origin)
      }else {
      }
    }
  };
  return{LiveLink:LiveLink}
}());
pc.extend(pc, function() {
  var LiveLinkMessage = function(data, source) {
    data = data || {};
    this.type = data.type || pc.LiveLinkMessageType.NO_TYPE;
    this.content = data.content || {};
    this.id = data.id || pc.guid.create();
    this.senderid = data.senderid || null;
    this.source = source || null
  };
  LiveLinkMessage.register = function(type) {
    pc.LiveLinkMessageType[type] = type
  };
  LiveLinkMessage.serialize = function(msg) {
    var o = {type:msg.type, content:msg.content, id:msg.id, senderid:msg.senderid};
    return JSON.stringify(o, function(key, value) {
      if(this[key] instanceof Float32Array) {
        return pc.makeArray(this[key])
      }else {
        return this[key]
      }
    })
  };
  LiveLinkMessage.deserialize = function(data) {
    try {
      var o = JSON.parse(data);
      return o
    }catch(e) {
      return null
    }
  };
  return{LiveLinkMessage:LiveLinkMessage, LiveLinkMessageRegister:{}, LiveLinkMessageType:{NO_TYPE:"NO_TYPE", RECEIVED:"RECEIVED"}}
}());
pc.extend(pc, function() {
  var LiveLinkUpdateComponentMessage = function(id, component, attribute, value) {
    this.type = pc.LiveLinkMessageType.UPDATE_COMPONENT;
    this.content = {id:id, component:component, attribute:attribute, value:value}
  };
  LiveLinkUpdateComponentMessage = pc.inherits(LiveLinkUpdateComponentMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_COMPONENT");
  return{LiveLinkUpdateComponentMessage:LiveLinkUpdateComponentMessage}
}());
pc.extend(pc, function() {
  var LiveLinkUpdateEntityMessage = function(id, components) {
    this.type = pc.LiveLinkMessageType.UPDATE_ENTITY;
    this.content = {id:id, components:components}
  };
  LiveLinkUpdateEntityMessage = pc.inherits(LiveLinkUpdateEntityMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ENTITY");
  var LiveLinkUpdateEntityTransformMessage = function(id, position, rotation, scale) {
    this.type = pc.LiveLinkMessageType.UPDATE_ENTITY_TRANSFORM;
    this.content = {id:id, position:position, rotation:rotation, scale:scale}
  };
  LiveLinkUpdateEntityTransformMessage = pc.inherits(LiveLinkUpdateEntityTransformMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ENTITY_TRANSFORM");
  var LiveLinkUpdateEntityNameMessage = function(id, name) {
    this.type = pc.LiveLinkMessageType.UPDATE_ENTITY_NAME;
    this.content = {id:id, name:name}
  };
  LiveLinkUpdateEntityNameMessage = pc.inherits(LiveLinkUpdateEntityNameMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ENTITY_NAME");
  var LiveLinkUpdateEntityEnabledMessage = function(id, enabled) {
    this.type = pc.LiveLinkMessageType.UPDATE_ENTITY_ENABLED;
    this.content = {id:id, enabled:enabled}
  };
  LiveLinkUpdateEntityEnabledMessage = pc.inherits(LiveLinkUpdateEntityEnabledMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ENTITY_ENABLED");
  var LiveLinkReparentEntityMessage = function(id, oldParentId, newParentId, index) {
    this.type = pc.LiveLinkMessageType.REPARENT_ENTITY;
    this.content = {id:id, oldParentId:oldParentId, newParentId:newParentId, index:index}
  };
  LiveLinkReparentEntityMessage = pc.inherits(LiveLinkReparentEntityMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("REPARENT_ENTITY");
  return{LiveLinkUpdateEntityMessage:LiveLinkUpdateEntityMessage, LiveLinkUpdateEntityNameMessage:LiveLinkUpdateEntityNameMessage, LiveLinkUpdateEntityEnabledMessage:LiveLinkUpdateEntityEnabledMessage, LiveLinkUpdateEntityTransformMessage:LiveLinkUpdateEntityTransformMessage, LiveLinkReparentEntityMessage:LiveLinkReparentEntityMessage}
}());
pc.extend(pc, function() {
  var LiveLinkCloseEntityMessage = function(id) {
    this.type = pc.LiveLinkMessageType.CLOSE_ENTITY;
    this.content = {id:id}
  };
  LiveLinkCloseEntityMessage = pc.inherits(LiveLinkCloseEntityMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("CLOSE_ENTITY");
  return{LiveLinkCloseEntityMessage:LiveLinkCloseEntityMessage}
}());
pc.extend(pc, function() {
  var LiveLinkOpenEntityMessage = function(entity) {
    this.type = pc.LiveLinkMessageType.OPEN_ENTITY;
    this.content = {entity:entity}
  };
  LiveLinkOpenEntityMessage = pc.inherits(LiveLinkOpenEntityMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("OPEN_ENTITY");
  var LiveLinkOpenPackMessage = function(hierarchy, pack) {
    this.type = pc.LiveLinkMessageType.OPEN_PACK;
    this.content = {pack:pc.extend({}, pack.getData())};
    this.content.pack.hierarchy = PCD.model.Entity.toData(hierarchy)
  };
  LiveLinkOpenPackMessage = pc.inherits(LiveLinkOpenPackMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("OPEN_PACK");
  return{LiveLinkOpenEntityMessage:LiveLinkOpenEntityMessage, LiveLinkOpenPackMessage:LiveLinkOpenPackMessage}
}());
pc.extend(pc, function() {
  var LiveLinkUpdateAssetMessage = function(id, attribute, value) {
    this.type = pc.LiveLinkMessageType.UPDATE_ASSET;
    this.content = {id:id, attribute:attribute, value:value}
  };
  LiveLinkUpdateAssetMessage = pc.inherits(LiveLinkUpdateAssetMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ASSET");
  return{LiveLinkUpdateAssetMessage:LiveLinkUpdateAssetMessage}
}());
pc.extend(pc, function() {
  var LiveLinkUpdatePackSettings = function(settings) {
    this.type = pc.LiveLinkMessageType.UPDATE_PACK_SETTINGS;
    this.content = {settings:settings}
  };
  LiveLinkUpdatePackSettings = pc.inherits(LiveLinkUpdatePackSettings, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_PACK_SETTINGS");
  return{LiveLinkUpdatePackSettings:LiveLinkUpdatePackSettings}
}());
pc.extend(pc, function() {
  var LiveLinkUpdateAssetCacheMessage = function(assets, deletedAssets) {
    this.type = pc.LiveLinkMessageType.UPDATE_ASSETCACHE;
    this.content = {assets:assets, deleted:deletedAssets}
  };
  LiveLinkUpdateAssetCacheMessage = pc.inherits(LiveLinkUpdateAssetCacheMessage, pc.LiveLinkMessage);
  pc.LiveLinkMessage.register("UPDATE_ASSETCACHE");
  return{LiveLinkUpdateAssetCacheMessage:LiveLinkUpdateAssetCacheMessage}
}());
pc.extend(pc, function() {
  var Entity = function(app) {
    this._guid = pc.guid.create();
    this._batchHandle = null;
    this.c = {};
    this._app = app;
    if(!app) {
      this._app = pc.Application.getApplication();
      if(!this._app) {
        console.error("Couldn't find current application")
      }
    }
    pc.events.attach(this)
  };
  Entity = pc.inherits(Entity, pc.GraphNode);
  Entity.prototype.addComponent = function(type, data) {
    var system = this._app.systems[type];
    if(system) {
      if(!this.c[type]) {
        return system.addComponent(this, data)
      }else {
        logERROR(pc.string.format("Entity already has {0} Component", type))
      }
    }else {
      logERROR(pc.string.format("System: '{0}' doesn't exist", type));
      return null
    }
  };
  Entity.prototype.removeComponent = function(type) {
    var system = this._app.systems[type];
    if(system) {
      if(this.c[type]) {
        system.removeComponent(this)
      }else {
        logERROR(pc.string.format("Entity doesn't have {0} Component", type))
      }
    }else {
      logERROR(pc.string.format("System: '{0}' doesn't exist", type))
    }
  };
  Entity.prototype.getGuid = function() {
    return this._guid
  };
  Entity.prototype.setGuid = function(guid) {
    this._guid = guid
  };
  Entity.prototype._onHierarchyStateChanged = function(enabled) {
    pc.Entity._super._onHierarchyStateChanged.call(this, enabled);
    var component;
    var components = this.c;
    for(type in components) {
      if(components.hasOwnProperty(type)) {
        component = components[type];
        if(component.enabled) {
          if(enabled) {
            component.onEnable()
          }else {
            component.onDisable()
          }
        }
      }
    }
  };
  Entity.prototype.setRequest = function(request) {
    this._request = request
  };
  Entity.prototype.getRequest = function() {
    return this._request
  };
  Entity.prototype.addChild = function(child) {
    if(child instanceof pc.Entity) {
      var _debug = true;
      if(_debug) {
        var root = this.getRoot();
        var dupe = root.findOne("getGuid", child.getGuid());
        if(dupe) {
          throw new Error("GUID already exists in graph");
        }
      }
    }
    pc.GraphNode.prototype.addChild.call(this, child)
  };
  Entity.prototype.findByGuid = function(guid) {
    if(this._guid === guid) {
      return this
    }
    for(var i = 0;i < this._children.length;i++) {
      if(this._children[i].findByGuid) {
        var found = this._children[i].findByGuid(guid);
        if(found !== null) {
          return found
        }
      }
    }
    return null
  };
  Entity.prototype.destroy = function() {
    var parent = this.getParent();
    var childGuids;
    for(var name in this.c) {
      this.c[name].enabled = false
    }
    for(var name in this.c) {
      this.c[name].system.removeComponent(this)
    }
    if(parent) {
      parent.removeChild(this)
    }
    var children = this.getChildren();
    var length = children.length;
    var child = children.shift();
    while(child) {
      if(child instanceof pc.Entity) {
        child.destroy()
      }
      child = children.shift()
    }
  };
  Entity.prototype.clone = function() {
    var type;
    var c = new pc.Entity(this._app);
    pc.Entity._super._cloneInternal.call(this, c);
    for(type in this.c) {
      var component = this.c[type];
      component.system.cloneComponent(this, c)
    }
    var i;
    for(i = 0;i < this.getChildren().length;i++) {
      var child = this.getChildren()[i];
      if(child instanceof pc.Entity) {
        c.addChild(child.clone())
      }
    }
    return c
  };
  Entity.deserialize = function(data) {
    var template = pc.json.parse(data.template);
    var parent = pc.json.parse(data.parent);
    var children = pc.json.parse(data.children);
    var transform = pc.json.parse(data.transform);
    var components = pc.json.parse(data.components);
    var labels = pc.json.parse(data.labels);
    var model = {_id:data._id, resource_id:data.resource_id, _rev:data._rev, name:data.name, enabled:data.enabled, labels:labels, template:template, parent:parent, children:children, transform:transform, components:components};
    return model
  };
  Entity.serialize = function(model) {
    var data = {_id:model._id, resource_id:model.resource_id, name:model.name, enabled:model.enabled, labels:pc.json.stringify(model.labels), template:pc.json.stringify(model.template), parent:pc.json.stringify(model.parent), children:pc.json.stringify(model.children), transform:pc.json.stringify(model.transform), components:pc.json.stringify(model.components)};
    if(model._rev) {
      data._rev = model._rev
    }
    return data
  };
  return{Entity:Entity}
}());
pc.resources = {};
pc.extend(pc.resources, function() {
  var ResourceLoader = function() {
    if(window.RSVP === undefined) {
      logERROR("Missing RSVP library")
    }
    this._types = {};
    this._handlers = {};
    this._requests = {};
    this._cache = {};
    this._hashes = {};
    this._canonicals = {};
    this._requested = 0;
    this._loaded = 0;
    this._sequence = 0;
    this.cache = true;
    pc.events.attach(this)
  };
  ResourceLoader.prototype = {createFileRequest:function(identifier, type) {
    return new this._types[type](identifier)
  }, registerHandler:function(RequestType, handler) {
    var request = new RequestType;
    if(request.type === "") {
      throw Error("ResourceRequests must have a type");
    }
    this._types[request.type] = RequestType;
    this._handlers[request.type] = handler;
    handler.setLoader(this)
  }, request:function(requests, options) {
    options = options || {};
    var self = this;
    var parent = options.parent;
    options.cache = self.cache;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var i, n;
      var p;
      if(requests.length === undefined) {
        requests = [requests]
      }
      var requested = [];
      var promises = [];
      for(i = 0, n = requests.length;i < n;i++) {
        var request = self._findExistingRequest(requests[i]);
        if(request !== requests[i]) {
          request.data = requests[i].data
        }
        self._makeCanonical(request);
        promises.push(self._request(request, options));
        requested.push(request);
        if(parent) {
          parent.children.push(request)
        }
      }
      var check = function(resources, requests, promises) {
        var i, n;
        var childPromises = [];
        var childRequests = [];
        requests.forEach(function(r) {
          r.children.forEach(function(c) {
            childRequests.push(c);
            childPromises.push.apply(childPromises, c.promises)
          })
        });
        if(childPromises.length) {
          pc.promise.all(childPromises).then(function(childResources) {
            check(resources, childRequests, childPromises)
          }, function(error) {
            reject(error)
          })
        }else {
          self.fire("complete", resources);
          resolve(resources)
        }
      };
      pc.promise.all(promises).then(function(resources) {
        check(resources, requested, promises)
      }, function(error) {
        reject(error)
      })
    });
    return promise
  }, open:function(RequestType, data, options) {
    var request = new RequestType;
    return this._handlers[request.type].open(data, request, options)
  }, registerHash:function(hash, identifier) {
    if(!this._hashes[identifier]) {
      this._hashes[identifier] = hash
    }
    if(!this._canonicals[hash]) {
      this._canonicals[hash] = identifier
    }
  }, unregisterHash:function(identifier) {
    var hash = this.getHash(identifier);
    if(hash) {
      delete this._canonicals[hash];
      delete this._hashes[identifier]
    }
  }, getHash:function(identifier) {
    return this._hashes[identifier]
  }, addToCache:function(identifier, resource) {
    var hash = this.getHash(identifier);
    if(hash) {
      this._cache[hash] = resource
    }else {
    }
  }, getFromCache:function(identifier) {
    var hash = this.getHash(identifier);
    if(hash) {
      return this._cache[hash]
    }else {
      return null
    }
  }, removeFromCache:function(identifier) {
    var hash = this.getHash(identifier);
    if(hash) {
      delete this._cache[hash]
    }else {
      return null
    }
  }, resetProgress:function() {
    this._requested = 0;
    this._loaded = 0
  }, _request:function(request, _options) {
    var self = this;
    var promise = null;
    var options = {};
    for(key in _options) {
      options[key] = _options[key]
    }
    if(request.id === null) {
      request.id = this._sequence++
    }
    this.fire("request", request);
    if(request.promises.length) {
      request.promises.push(new pc.promise.Promise(function(resolve, reject) {
        request.promises[0].then(function(resource) {
          var resource = self._postOpen(resource, request);
          resolve(resource)
        })
      }))
    }else {
      request.promises[0] = new pc.promise.Promise(function(resolve, reject) {
        var handler = self._handlers[request.type];
        if(!handler) {
          var msg = "Missing handler for type: " + request.type;
          self.fire("error", request, msg);
          reject(msg);
          return
        }
        var resource = self.getFromCache(request.canonical);
        if(resource && (request.Type === undefined || resource instanceof request.Type)) {
          resource = self._postOpen(resource, request);
          resolve(resource)
        }else {
          var promise = handler.load(request, options);
          promise.then(function(data) {
            try {
              var resource = self._open(data, request, options);
              if(resource) {
                resource = self._postOpen(resource, request)
              }
              resolve(resource)
            }catch(e) {
              reject(e)
            }
          }, function(error) {
            self.fire("error", request, error);
            reject(error)
          })
        }
      })
    }
    self._requests[request.canonical] = request;
    this._requested++;
    return request.promises[request.promises.length - 1]
  }, _open:function(data, request, options) {
    return this._handlers[request.type].open(data, request, options)
  }, _postOpen:function(resource, request) {
    this.addToCache(request.canonical, resource);
    resource = this._handlers[request.type].clone(resource, request);
    delete this._requests[request.canonical];
    this._loaded++;
    this.fire("progress", this._loaded / this._requested);
    this.fire("load", request, resource);
    return resource
  }, _makeCanonical:function(request) {
    var hash = this.getHash(request.identifier);
    if(hash && this._canonicals[hash]) {
      request.canonical = this._canonicals[hash]
    }else {
      request.canonical = request.identifier
    }
  }, _findExistingRequest:function(request) {
    var existing = this._requests[request.canonical];
    if(existing) {
      if(existing.type !== request.type || existing.result || request.result) {
        return request
      }else {
        return existing
      }
    }else {
      return request
    }
  }};
  var ResourceRequest = function ResourceRequest(identifier, data, result) {
    this.id = null;
    this.canonical = identifier;
    this.alternatives = [];
    this.promises = [];
    this.children = [];
    this.data = data;
    this.result = result;
    this.identifier = identifier
  };
  var ResourceHandler = function() {
  };
  ResourceHandler.prototype = {setLoader:function(loader) {
    this._loader = loader
  }, load:function(request, options) {
    throw Error("Not implemented");
  }, open:function(data, options) {
    throw Error("Not implemented");
  }, clone:function(resource) {
    return resource
  }};
  return{ResourceLoader:ResourceLoader, ResourceHandler:ResourceHandler, ResourceRequest:ResourceRequest}
}());
pc.extend(pc.resources, function() {
  var count = 0;
  var ResourceLoaderDisplay = function(element, loader) {
    loader.on("request", this.handleRequest, this);
    loader.on("load", this.handleLoad, this);
    loader.on("error", this.handleError, this);
    loader.on("progress", this.handleProgress, this);
    this.addCss();
    this._element = element;
    this._domCreate()
  };
  ResourceLoaderDisplay.prototype = {addCss:function() {
    var styles = [".pc-resourceloaderdisplay-root {", "   font-family: sans-serif;", "   font-size: 0.7em;", "   color: #aaa;", "   border-collapse: collapse;", "   position: absolute;", "   top: 10px;", "   left: 10px;", "   background-color: black;", "   opacity: 0.6;", "}", ".pc-resourceloaderdisplay-root td {", "   border: 1px solid #aaa;", "}", ".pc-resourceloaderdisplay-subtable {", "   border-collapse: collapse;", "}"].join("\n");
    var style = document.createElement("style");
    document.getElementsByTagName("head")[0].appendChild(style);
    if(style.styleSheet) {
      style.styleSheet.cssText = styles
    }else {
      var cssText = document.createTextNode(styles);
      style.appendChild(cssText)
    }
  }, handleRequest:function(request) {
    console.warn("request: " + request.id);
    this._domAddRequest(request)
  }, handleLoad:function(request, resource) {
    console.warn("load: " + request.id);
    var id = "pc-resourcesloaderdisplay-progress-" + request.id;
    var el = document.getElementsByClassName(id);
    if(el) {
      for(var i = 0;i < el.length;i++) {
        el[i].textContent = "100%"
      }
    }
  }, handleError:function(request, error) {
    var id = "pc-resourcesloaderdisplay-progress-" + request.id;
    var el = document.getElementsByClassName(id);
    if(el) {
      for(var i = 0;i < el.length;i++) {
        el[i].textContent = error
      }
    }
  }, handleProgress:function(value) {
  }, _domCreate:function() {
    this._rootTable = document.createElement("table");
    this._rootTable.setAttribute("class", "pc-resourceloaderdisplay-root");
    this._element.appendChild(this._rootTable)
  }, _domAddRequest:function(request) {
    var id = "pc-resourcesloaderdisplay-progress-" + request.id;
    var row = document.createElement("tr");
    var titleEl = document.createElement("td");
    titleEl.textContent = request.identifier;
    var progressEl = document.createElement("td");
    progressEl.className = id;
    progressEl.textContent = "0%";
    row.appendChild(titleEl);
    row.appendChild(progressEl);
    this._rootTable.appendChild(row)
  }, _sanitizeId:function(id) {
    return id.replace(/\//, "").replace(/\./, "")
  }};
  return{ResourceLoaderDisplay:ResourceLoaderDisplay}
}());
pc.extend(pc.resources, function() {
  var TextureCache = function(loader) {
    this.cache = {};
    this.loader = loader
  };
  TextureCache.prototype = {getTexture:function(url) {
    var hash = this.loader.getHash(url);
    if(hash && this.cache[hash]) {
      return this.cache[hash]
    }
    return null
  }, addTexture:function(url, texture) {
    var hash = this.loader.getHash(url);
    if(hash) {
      this.cache[hash] = texture
    }
  }};
  return{TextureCache:TextureCache}
}());
pc.extend(pc.resources, function() {
  var JsonResourceHandler = function() {
  };
  JsonResourceHandler = pc.inherits(JsonResourceHandler, pc.resources.ResourceHandler);
  JsonResourceHandler.prototype.load = function(request, options) {
    var self = this;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      pc.net.http.get(request.canonical, function(response) {
        resolve(response)
      }, {error:function() {
        reject()
      }})
    });
    return promise
  };
  JsonResourceHandler.prototype.open = function(data, request, options) {
    return data
  };
  var JsonRequest = function JsonRequest(identifier) {
  };
  JsonRequest = pc.inherits(JsonRequest, pc.resources.ResourceRequest);
  JsonRequest.prototype.type = "json";
  JsonRequest.prototype.Type = Object;
  return{JsonResourceHandler:JsonResourceHandler, JsonRequest:JsonRequest}
}());
pc.extend(pc.resources, function() {
  var TextResourceHandler = function() {
  };
  TextResourceHandler = pc.inherits(TextResourceHandler, pc.resources.ResourceHandler);
  TextResourceHandler.prototype.load = function(request, options) {
    var self = this;
    var promise = new RSVP.Promise(function(resolve, reject) {
      pc.net.http.get(request.canonical, function(response) {
        resolve(response)
      }, {error:function() {
        reject()
      }})
    });
    return promise
  };
  TextResourceHandler.prototype.open = function(data, request, options) {
    return data
  };
  var TextRequest = function TextRequest(identifier) {
  };
  TextRequest = pc.inherits(TextRequest, pc.resources.ResourceRequest);
  TextRequest.prototype.type = "text";
  TextRequest.prototype.Type = Object;
  return{TextResourceHandler:TextResourceHandler, TextRequest:TextRequest}
}());
pc.extend(pc.resources, function() {
  var ImageResourceHandler = function() {
  };
  ImageResourceHandler = pc.inherits(ImageResourceHandler, pc.resources.ResourceHandler);
  ImageResourceHandler.prototype.load = function(request, options) {
    var self = this;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var image = new Image;
      image.onload = function() {
        resolve(image)
      };
      image.onerror = function(event) {
        var element = event.srcElement;
        reject(pc.string.format("Error loading Image from: '{0}'", element.src))
      };
      image.src = request.canonical
    });
    return promise
  };
  ImageResourceHandler.prototype.open = function(data, request, options) {
    return data
  };
  var ImageRequest = function ImageRequest(identifier) {
  };
  ImageRequest = pc.inherits(ImageRequest, pc.resources.ResourceRequest);
  ImageRequest.prototype.type = "image";
  ImageRequest.prototype.Type = Image;
  return{ImageResourceHandler:ImageResourceHandler, ImageRequest:ImageRequest}
}());
pc.extend(pc.resources, function() {
  var jsonToAddressMode = {"repeat":pc.ADDRESS_REPEAT, "clamp":pc.ADDRESS_CLAMP_TO_EDGE, "mirror":pc.ADDRESS_MIRRORED_REPEAT};
  var jsonToFilterMode = {"nearest":pc.FILTER_NEAREST, "linear":pc.FILTER_LINEAR, "nearest_mip_nearest":pc.FILTER_NEAREST_MIPMAP_NEAREST, "linear_mip_nearest":pc.FILTER_LINEAR_MIPMAP_NEAREST, "nearest_mip_linear":pc.FILTER_NEAREST_MIPMAP_LINEAR, "linear_mip_linear":pc.FILTER_LINEAR_MIPMAP_LINEAR};
  function arrayBufferCopy(src, dst, dstByteOffset, numBytes) {
    dst32Offset = dstByteOffset / 4;
    var tail = numBytes % 4;
    var src32 = new Uint32Array(src.buffer, 0, (numBytes - tail) / 4);
    var dst32 = new Uint32Array(dst.buffer);
    for(var i = 0;i < src32.length;i++) {
      dst32[dst32Offset + i] = src32[i]
    }
    for(var i = numBytes - tail;i < numBytes;i++) {
      dst[dstByteOffset + i] = src[i]
    }
  }
  var TextureResourceHandler = function(device, assets) {
    this._device = device;
    this._assets = assets;
    this.crossOrigin = undefined
  };
  TextureResourceHandler = pc.inherits(TextureResourceHandler, pc.resources.ResourceHandler);
  TextureResourceHandler.prototype.load = function(request, options) {
    var identifier = request.canonical;
    var self = this;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var ext = pc.path.getExtension(identifier).toLowerCase();
      if(ext === ".dds" || ext === ".crn") {
        options = options || {};
        options.binary = true;
        options.directory = pc.path.getDirectory(identifier);
        options.crn = ext === ".crn";
        pc.net.http.get(identifier, function(response) {
          resolve(response)
        }, {cache:true, responseType:"arraybuffer"})
      }else {
        if(ext === ".jpg" || ext === ".jpeg" || ext === ".gif" || ext === ".png") {
          var image = new Image;
          if(self.crossOrigin !== undefined) {
            image.crossOrigin = self.crossOrigin
          }
          image.onload = function() {
            resolve(image)
          };
          image.onerror = function(event) {
            var element = event.srcElement;
            reject(pc.string.format("Error loading Texture from: '{0}'", element.src))
          };
          var asset = self._assets.getAssetByUrl(request.canonical);
          if(asset && asset.file) {
            identifier += "?t=" + asset.file.hash
          }
          image.src = identifier
        }
      }
    });
    return promise
  };
  TextureResourceHandler.prototype.open = function(data, request, options) {
    var self = this;
    var texture;
    if(data instanceof Image || data instanceof HTMLImageElement) {
      var img = data;
      if(request.result) {
        texture = request.result
      }else {
        format = pc.string.endsWith(img.src.toLowerCase(), ".jpg") ? pc.PIXELFORMAT_R8_G8_B8 : pc.PIXELFORMAT_R8_G8_B8_A8;
        texture = new pc.Texture(this._device, {width:img.width, height:img.height, format:format});
        var asset = self._assets.getAssetByUrl(request.canonical);
        if(asset && asset.data) {
          var updateTexture = function(data) {
            if(data.name !== undefined) {
              texture.name = data.name
            }
            if(data.addressu !== undefined) {
              texture.addressU = jsonToAddressMode[data.addressu]
            }
            if(data.addressV !== undefined) {
              texture.addressV = jsonToAddressMode[data.addressV]
            }
            if(data.magfilter !== undefined) {
              texture.magFilter = jsonToFilterMode[data.magfilter]
            }
            if(data.minfilter !== undefined) {
              texture.minFilter = jsonToFilterMode[data.minfilter]
            }
            if(data.anisotropy !== undefined) {
              texture.anisotropy = data.anisotropy
            }
          };
          updateTexture(asset.data);
          asset.on("change", function(asset, attribute, value) {
            if(attribute === "data") {
              updateTexture(value)
            }
          }, this)
        }
      }
      texture.setSource(img)
    }else {
      if(data instanceof ArrayBuffer) {
        if(options.crn) {
          var srcSize = data.byteLength;
          var bytes = new Uint8Array(data);
          var src = Module._malloc(srcSize);
          arrayBufferCopy(bytes, Module.HEAPU8, src, srcSize);
          var dst = Module._crn_decompress_get_data(src, srcSize);
          var dstSize = Module._crn_decompress_get_size(src, srcSize);
          data = Module.HEAPU8.buffer.slice(dst, dst + dstSize)
        }
        var header = new Uint32Array(data, 0, 128 / 4);
        var width = header[4];
        var height = header[3];
        var mips = Math.max(header[7], 1);
        var isFourCc = header[20] === 4;
        var fcc = header[21];
        var bpp = header[22];
        var isCubemap = header[28] === 65024;
        var FCC_DXT1 = 827611204;
        var FCC_DXT5 = 894720068;
        var FCC_FP32 = 116;
        var FCC_ETC1 = 826496069;
        var format = null;
        var compressed = false;
        var floating = false;
        var etc1 = false;
        if(isFourCc) {
          if(fcc === FCC_DXT1) {
            format = pc.PIXELFORMAT_DXT1;
            compressed = true
          }else {
            if(fcc === FCC_DXT5) {
              format = pc.PIXELFORMAT_DXT5;
              compressed = true
            }else {
              if(fcc === FCC_FP32) {
                format = pc.PIXELFORMAT_RGBA32F;
                floating = true
              }else {
                if(fcc === FCC_ETC1) {
                  format = pc.PIXELFORMAT_ETC1;
                  compressed = true;
                  etc1 = true
                }
              }
            }
          }
        }else {
          if(bpp === 32) {
            format = pc.PIXELFORMAT_R8_G8_B8_A8
          }
        }
        var requiredMips = Math.round(Math.log2(Math.max(width, height)) + 1);
        var cantLoad = !format || mips !== requiredMips && compressed;
        if(cantLoad) {
          var errEnd = ". Empty texture will be created instead.";
          if(!format) {
            console.error("This DDS pixel format is currently unsupported" + errEnd)
          }else {
            console.error("DDS has " + mips + " mips, but engine requires " + requiredMips + " for DXT format. " + errEnd)
          }
          texture = new pc.Texture(this._device, {width:4, height:4, format:pc.PIXELFORMAT_R8_G8_B8});
          return texture
        }
        var texOptions = {width:width, height:height, format:format, cubemap:isCubemap};
        texture = new pc.Texture(this._device, texOptions);
        var offset = 128;
        var faces = isCubemap ? 6 : 1;
        var mipSize;
        var DXT_BLOCK_WIDTH = 4;
        var DXT_BLOCK_HEIGHT = 4;
        var blockSize = fcc === FCC_DXT1 ? 8 : 16;
        var numBlocksAcross, numBlocksDown;
        for(var face = 0;face < faces;face++) {
          var mipWidth = width;
          var mipHeight = height;
          for(var i = 0;i < mips;i++) {
            if(compressed) {
              if(etc1) {
                mipSize = Math.floor((mipWidth + 3) / 4) * Math.floor((mipHeight + 3) / 4) * 8
              }else {
                numBlocksAcross = Math.floor((mipWidth + DXT_BLOCK_WIDTH - 1) / DXT_BLOCK_WIDTH);
                numBlocksDown = Math.floor((mipHeight + DXT_BLOCK_HEIGHT - 1) / DXT_BLOCK_HEIGHT);
                numBlocks = numBlocksAcross * numBlocksDown;
                mipSize = numBlocks * blockSize
              }
            }else {
              mipSize = mipWidth * mipHeight * 4
            }
            var mipBuff = floating ? new Float32Array(data, offset, mipSize) : new Uint8Array(data, offset, mipSize);
            if(!isCubemap) {
              texture._levels[i] = mipBuff
            }else {
              if(!texture._levels[i]) {
                texture._levels[i] = []
              }
              texture._levels[i][face] = mipBuff
            }
            offset += floating ? mipSize * 4 : mipSize;
            mipWidth = Math.max(mipWidth * 0.5, 1);
            mipHeight = Math.max(mipHeight * 0.5, 1)
          }
        }
        texture.upload()
      }
    }
    return texture
  };
  var TextureRequest = function TextureRequest(identifier) {
  };
  TextureRequest = pc.inherits(TextureRequest, pc.resources.ResourceRequest);
  TextureRequest.prototype.type = "texture";
  TextureRequest.prototype.Type = pc.Texture;
  return{TextureResourceHandler:TextureResourceHandler, TextureRequest:TextureRequest}
}());
pc.extend(pc.resources, function() {
  function onTextureAssetChanged(asset, attribute, newValue, oldValue) {
    if(attribute !== "resource") {
      return
    }
    var cubemapAsset = this;
    var cubemap = cubemapAsset.resource;
    if(!cubemap) {
      return
    }
    var sources = cubemap.getSource();
    var dirty = false;
    if(oldValue) {
      var oldImage = oldValue.getSource();
      for(var i = 0;i < sources.length;i++) {
        if(sources[i] === oldImage) {
          sources[i] = newValue.getSource();
          dirty = true
        }
      }
    }
    if(dirty) {
      cubemap.setSource(sources);
      var old = cubemapAsset.resources.slice(0);
      cubemapAsset.fire("change", cubemapAsset, "resources", cubemapAsset.resources, old)
    }else {
      asset.off("change", onTextureAssetChanged, cubemap)
    }
  }
  var CubemapResourceHandler = function(device, assets, loader) {
    this._device = device;
    this._assets = assets
  };
  CubemapResourceHandler = pc.inherits(CubemapResourceHandler, pc.resources.ResourceHandler);
  CubemapResourceHandler.prototype.load = function(request, options) {
    var self = this;
    var promise = null;
    var asset = self._getAssetFromRequest(request);
    if(pc.string.startsWith(request.canonical, "asset://")) {
      promise = new pc.promise.Promise(function(resolve, reject) {
        if(!asset) {
          reject(pc.string.format("Can't load cubemap, asset {0} not found", request.canonical))
        }
        var promises = [];
        promises.push(self._loadCubemapImages(asset));
        var url = asset.getFileUrl();
        if(url && pc.string.endsWith(url.toLowerCase(), ".dds")) {
          promises.push(self._assets.loader.request(new pc.resources.TextureRequest(url)))
        }
        pc.promise.all(promises).then(function(resources) {
          var data = pc.extend({}, asset.data);
          data.loadedTextures = resources[0];
          if(resources.length > 1) {
            var prefiltered = resources[1][0];
            data.loadedTextures.push(prefiltered)
          }
          resolve(data)
        }, function(error) {
          reject(error)
        })
      })
    }else {
      promise = new pc.promise.Promise(function(resolve, reject) {
        pc.net.http.get(request.canonical, function(response) {
          var data = pc.extend({}, response);
          var textures = data.textures;
          if(textures.length) {
            var assets = [];
            textures.forEach(function(path) {
              var filename = pc.path.getBasename(path);
              var url = pc.path.join(pc.path.split(request.canonical)[0], path);
              assets.push(new pc.asset.Asset(filename, "texture", {url:url}))
            });
            data.textures = assets.map(function(asset) {
              return asset.id
            });
            var promises = [];
            promises.push(self._assets.load(assets));
            if(data.prefiltered) {
              var url = pc.path.join(pc.path.split(request.canonical)[0], data.prefiltered);
              promises.push(self._assets.loader.request(new pc.resources.TextureRequest(url)))
            }
            pc.promise.all(promises).then(function(resources) {
              data.loadedTextures = resources[0];
              data.loadedTextures.push(resources[1][0]);
              resolve(data)
            }, function(error) {
              reject(error)
            })
          }else {
            resolve(data)
          }
        }, {error:function(error) {
          reject("Could not load cubemap json: " + error)
        }})
      })
    }
    return promise
  };
  CubemapResourceHandler.prototype.open = function(data, request, options) {
    var self = this;
    var asset = self._getAssetFromRequest(request);
    var resources = [];
    var cubemap = new pc.Texture(self._device, {format:pc.PIXELFORMAT_R8_G8_B8, cubemap:true, autoMipmap:true, fixCubemapSeams:true});
    cubemap.name = data.name;
    cubemap.minFilter = data.minFilter;
    cubemap.magFilter = data.magFilter;
    cubemap.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
    cubemap.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
    cubemap.anisotropy = data.anisotropy;
    if(data.loadedTextures) {
      cubemap.setSource(data.loadedTextures.slice(0, 6).map(function(texture) {
        return texture.getSource()
      }))
    }
    resources.push(cubemap);
    if(data.loadedTextures && data.loadedTextures.length > 6) {
      var prefiltered = data.loadedTextures[6];
      var mipSize = 128;
      for(i = 0;i < 6;i++) {
        var mip = new pc.gfx.Texture(self._device, {cubemap:true, fixCubemapSeams:true, autoMipmap:true, format:prefiltered.format, rgbm:prefiltered.rgbm, width:mipSize, height:mipSize});
        mipSize *= 0.5;
        mip._levels[0] = prefiltered._levels[i];
        mip.upload();
        resources.push(mip)
      }
    }
    asset.off("change", self._onCubemapAssetChanged, self);
    asset.on("change", self._onCubemapAssetChanged, self);
    return resources
  };
  CubemapResourceHandler.prototype._onCubemapAssetChanged = function(asset, attribute, value, oldValue) {
    var self = this;
    if(attribute === "data") {
      var texturesChanged = false;
      if(value.textures.length !== oldValue.textures.length) {
        texturesChanged = true
      }else {
        for(var i = 0;i < value.textures.length;i++) {
          if(value.textures[i] !== oldValue.textures[i]) {
            texturesChanged = true;
            break
          }
        }
      }
      if(texturesChanged) {
        self._loadCubemapImages(asset).then(function(resources) {
          var old = asset.resources.slice(0);
          if(resources) {
            asset.resource.setSource(resources.map(function(texture) {
              return texture.getSource()
            }));
            asset.fire("change", asset, "resources", asset.resources, old)
          }
        })
      }
      asset.resource.minFilter = value.minFilter;
      asset.resource.magFilter = value.magFilter;
      asset.resource.addressU = pc.ADDRESS_CLAMP_TO_EDGE;
      asset.resource.addressV = pc.ADDRESS_CLAMP_TO_EDGE;
      asset.resource.anisotropy = value.anisotropy;
      asset.resource.upload()
    }else {
      if(attribute === "file") {
        if(oldValue) {
          url = oldValue.url;
          delete self._assets._urls[url];
          self._assets.loader.removeFromCache(url);
          self._assets.loader.unregisterHash(url)
        }
        if(value) {
          url = asset.getFileUrl();
          self._assets._urls[url] = asset.id;
          self._assets.loader.registerHash(value.hash, url);
          self._assets.loader.request(new pc.resources.TextureRequest(url)).then(function(resources) {
            var prefiltered = resources[0];
            var mipSize = 128;
            var old = asset.resources.slice(0);
            asset.resources = [asset.resource];
            for(i = 0;i < 6;i++) {
              var mip = new pc.gfx.Texture(self._device, {cubemap:true, fixCubemapSeams:true, autoMipmap:true, format:prefiltered.format, rgbm:prefiltered.rgbm, width:mipSize, height:mipSize});
              mipSize *= 0.5;
              mip._levels[0] = prefiltered._levels[i];
              mip.upload();
              asset.resources.push(mip)
            }
            asset.fire("change", asset, "resources", asset.resources, old)
          }, function(error) {
            console.error("Could not load prefiltered cubemap: " + error)
          })
        }else {
          var old = asset.resources.slice(0);
          asset.resources = [asset.resource];
          asset.fire("change", asset, "resources", asset.resources, old)
        }
      }
    }
  };
  CubemapResourceHandler.prototype._areValidImages = function(images) {
    var result = images && images.length === 6;
    var error;
    if(result) {
      var width = images[0] ? images[0].width : null;
      var height = images[0] ? images[0].height : null;
      for(var i = 0;i < 6;i++) {
        if(!images[i]) {
          result = false;
          break
        }
        if(!images[i] instanceof HTMLCanvasElement || !images[i] instanceof HTMLImageElement || !images[i] instanceof HTMLVideoElement) {
          error = "Cubemap source is not an instance of HTMLCanvasElement, HTMLImageElement or HTMLVideoElement.";
          result = false;
          break
        }
        if(images[i].width !== width || images[i].height !== height) {
          error = "Cubemap sources do not all share the same dimensions.";
          result = false;
          break
        }
      }
    }
    if(error) {
      alert(error)
    }
    return result
  };
  CubemapResourceHandler.prototype._loadCubemapImages = function(cubemapAsset) {
    var data = cubemapAsset.data;
    var self = this;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      if(data.textures) {
        var assets = [];
        for(var i = 0;i < 6;i++) {
          var id = parseInt(data.textures[i], 10);
          if(id >= 0) {
            var asset = self._assets.getAssetById(id);
            if(!asset) {
              reject(pc.string.format("Could not load cubemap - Texture {0} not found", data.textures[i]));
              return
            }
            assets.push(asset)
          }else {
            resolve(null);
            return
          }
        }
        self._assets.load(assets).then(function(resources) {
          resolve(resources);
          assets.forEach(function(asset) {
            asset.off("change", onTextureAssetChanged, cubemapAsset);
            asset.on("change", onTextureAssetChanged, cubemapAsset)
          })
        }, function(error) {
          reject(error)
        })
      }else {
        resolve(null);
        return
      }
    });
    return promise
  };
  CubemapResourceHandler.prototype._getAssetFromRequest = function(request) {
    if(pc.string.startsWith(request.canonical, "asset://")) {
      return this._assets.getAssetById(parseInt(request.canonical.slice(8)))
    }else {
      return this._assets.getAssetByUrl(request.canonical)
    }
  };
  var CubemapRequest = function(identifier) {
  };
  CubemapRequest = pc.inherits(CubemapRequest, pc.resources.ResourceRequest);
  CubemapRequest.prototype.type = "cubemap";
  CubemapRequest.prototype.Type = pc.Texture;
  return{CubemapResourceHandler:CubemapResourceHandler, CubemapRequest:CubemapRequest}
}());
pc.extend(pc.resources, function() {
  var jsonToPrimitiveType = {"points":pc.PRIMITIVE_POINTS, "lines":pc.PRIMITIVE_LINES, "lineloop":pc.PRIMITIVE_LINELOOP, "linestrip":pc.PRIMITIVE_LINESTRIP, "triangles":pc.PRIMITIVE_TRIANGLES, "trianglestrip":pc.PRIMITIVE_TRISTRIP, "trianglefan":pc.PRIMITIVE_TRIFAN};
  var jsonToVertexElementType = {"int8":pc.ELEMENTTYPE_INT8, "uint8":pc.ELEMENTTYPE_UINT8, "int16":pc.ELEMENTTYPE_INT16, "uint16":pc.ELEMENTTYPE_UINT16, "int32":pc.ELEMENTTYPE_INT32, "uint32":pc.ELEMENTTYPE_UINT32, "float32":pc.ELEMENTTYPE_FLOAT32};
  var jsonToLightType = {"directional":pc.LIGHTTYPE_DIRECTIONAL, "point":pc.LIGHTTYPE_POINT, "spot":pc.LIGHTTYPE_SPOT};
  var jsonToProjectionType = {"perspective":pc.PROJECTION_PERSPECTIVE, "orthographic":pc.PROJECTION_ORTHOGRAPHIC};
  var ModelResourceHandler = function(device, assetRegistry) {
    this._device = device;
    this._assets = assetRegistry
  };
  ModelResourceHandler = pc.inherits(ModelResourceHandler, pc.resources.ResourceHandler);
  ModelResourceHandler.prototype.load = function(request, options) {
    var self = this;
    if(request.data) {
      var asset;
      var materials = [];
      var mapping = request.data;
      for(var i = 0;i < mapping.length;i++) {
        if(mapping[i].material) {
          asset = this._assets.getAssetById(mapping[i].material);
          if(asset) {
            materials.push(asset)
          }
        }
      }
    }
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var url = request.canonical;
      options = options || {};
      options.directory = pc.path.getDirectory(url);
      pc.net.http.get(url, function(response) {
        if(materials.length) {
          self._assets.load(materials).then(function() {
            resolve(response)
          })
        }else {
          resolve(response)
        }
      }, {cache:options.cache, error:function(status, xhr, e) {
        reject(pc.string.format("Error loading model: {0} [{1}]", url, status))
      }})
    });
    return promise
  };
  ModelResourceHandler.prototype.open = function(data, request, options) {
    options = options || {};
    options.directory = options.directory || "";
    options.parent = request;
    var model = null;
    if(data.model.version <= 1) {
      logERROR(pc.string.format("Asset: {0}, is an old model format. Upload source assets to re-import.", request.canonical))
    }else {
      if(data.model.version >= 2) {
        model = this._loadModelJson(data, request.data, options)
      }
    }
    return model
  };
  ModelResourceHandler.prototype.clone = function(model) {
    return model.clone()
  };
  ModelResourceHandler.prototype._loadModelJson = function(data, mapping, options) {
    var modelData = data.model;
    var i, j;
    var nodes = [];
    for(i = 0;i < modelData.nodes.length;i++) {
      var nodeData = modelData.nodes[i];
      var node = new pc.GraphNode;
      node.setName(nodeData.name);
      node.setLocalPosition(nodeData.position[0], nodeData.position[1], nodeData.position[2]);
      node.setLocalEulerAngles(nodeData.rotation[0], nodeData.rotation[1], nodeData.rotation[2]);
      node.setLocalScale(nodeData.scale[0], nodeData.scale[1], nodeData.scale[2]);
      nodes.push(node)
    }
    for(i = 1;i < modelData.parents.length;i++) {
      nodes[modelData.parents[i]].addChild(nodes[i])
    }
    if(!this._device.supportsBoneTextures && modelData.skins.length > 0) {
      var boneLimit = this._device.getBoneLimit();
      pc.partitionSkin(modelData, mapping, boneLimit)
    }
    var skins = [];
    var skinInstances = [];
    for(i = 0;i < modelData.skins.length;i++) {
      var skinData = modelData.skins[i];
      var inverseBindMatrices = [];
      for(j = 0;j < skinData.inverseBindMatrices.length;j++) {
        var ibm = skinData.inverseBindMatrices[j];
        inverseBindMatrices[j] = new pc.Mat4(ibm[0], ibm[1], ibm[2], ibm[3], ibm[4], ibm[5], ibm[6], ibm[7], ibm[8], ibm[9], ibm[10], ibm[11], ibm[12], ibm[13], ibm[14], ibm[15])
      }
      var skin = new pc.Skin(this._device, inverseBindMatrices, skinData.boneNames);
      skins.push(skin);
      var skinInstance = new pc.SkinInstance(skin);
      var bones = [];
      for(j = 0;j < skin.boneNames.length;j++) {
        var boneName = skin.boneNames[j];
        var bone = nodes[0].findByName(boneName);
        bones.push(bone)
      }
      skinInstance.bones = bones;
      skinInstances.push(skinInstance)
    }
    var vertexBuffers = [];
    var attribute, attributeName;
    var attributeMap = {position:pc.SEMANTIC_POSITION, normal:pc.SEMANTIC_NORMAL, tangent:pc.SEMANTIC_TANGENT, blendWeight:pc.SEMANTIC_BLENDWEIGHT, blendIndices:pc.SEMANTIC_BLENDINDICES, color:pc.SEMANTIC_COLOR, texCoord0:pc.SEMANTIC_TEXCOORD0, texCoord1:pc.SEMANTIC_TEXCOORD1, texCoord2:pc.SEMANTIC_TEXCOORD2, texCoord3:pc.SEMANTIC_TEXCOORD3, texCoord4:pc.SEMANTIC_TEXCOORD4, texCoord5:pc.SEMANTIC_TEXCOORD5, texCoord6:pc.SEMANTIC_TEXCOORD6, texCoord7:pc.SEMANTIC_TEXCOORD7};
    for(i = 0;i < modelData.vertices.length;i++) {
      var vertexData = modelData.vertices[i];
      if(vertexData.position && vertexData.normal && vertexData.texCoord0) {
        var indices = [];
        for(j = 0;j < modelData.meshes.length;j++) {
          if(modelData.meshes[j].vertices === i) {
            indices = indices.concat(modelData.meshes[j].indices)
          }
        }
        tangents = pc.calculateTangents(vertexData.position.data, vertexData.normal.data, vertexData.texCoord0.data, indices);
        vertexData.tangent = {type:"float32", components:4, data:tangents}
      }
      var formatDesc = [];
      for(attributeName in vertexData) {
        attribute = vertexData[attributeName];
        var attribType = attribute.type;
        if(!this._device.supportsUnsignedByte) {
          if(attribType === "uint8") {
            attribType = "float32"
          }
          if(attribType === "int8") {
            attribType = "float32"
          }
        }
        formatDesc.push({semantic:attributeMap[attributeName], components:attribute.components, type:jsonToVertexElementType[attribType], normalize:false})
      }
      var vertexFormat = new pc.VertexFormat(this._device, formatDesc);
      var numVertices = vertexData.position.data.length / vertexData.position.components;
      var vertexBuffer = new pc.VertexBuffer(this._device, vertexFormat, numVertices);
      var iterator = new pc.VertexIterator(vertexBuffer);
      for(j = 0;j < numVertices;j++) {
        for(attributeName in vertexData) {
          attribute = vertexData[attributeName];
          switch(attribute.components) {
            case 1:
              iterator.element[attributeMap[attributeName]].set(attribute.data[j]);
              break;
            case 2:
              iterator.element[attributeMap[attributeName]].set(attribute.data[j * 2], attribute.data[j * 2 + 1]);
              break;
            case 3:
              iterator.element[attributeMap[attributeName]].set(attribute.data[j * 3], attribute.data[j * 3 + 1], attribute.data[j * 3 + 2]);
              break;
            case 4:
              iterator.element[attributeMap[attributeName]].set(attribute.data[j * 4], attribute.data[j * 4 + 1], attribute.data[j * 4 + 2], attribute.data[j * 4 + 3]);
              break
          }
        }
        iterator.next()
      }
      iterator.end();
      vertexBuffers.push(vertexBuffer)
    }
    var numIndices = 0;
    for(i = 0;i < modelData.meshes.length;i++) {
      var meshData = modelData.meshes[i];
      if(meshData.indices !== undefined) {
        numIndices += meshData.indices.length
      }
    }
    var indexBuffer = null;
    var indexData = null;
    var indexBase = 0;
    if(numIndices > 0) {
      indexBuffer = new pc.IndexBuffer(this._device, pc.INDEXFORMAT_UINT16, numIndices);
      indexData = new Uint16Array(indexBuffer.lock())
    }
    var meshes = [];
    for(i = 0;i < modelData.meshes.length;i++) {
      var meshData = modelData.meshes[i];
      var min = meshData.aabb.min;
      var max = meshData.aabb.max;
      var aabb = new pc.shape.Aabb(new pc.Vec3((max[0] + min[0]) * 0.5, (max[1] + min[1]) * 0.5, (max[2] + min[2]) * 0.5), new pc.Vec3((max[0] - min[0]) * 0.5, (max[1] - min[1]) * 0.5, (max[2] - min[2]) * 0.5));
      var indexed = meshData.indices !== undefined;
      var mesh = new pc.Mesh;
      mesh.vertexBuffer = vertexBuffers[meshData.vertices];
      mesh.indexBuffer[0] = indexed ? indexBuffer : null;
      mesh.primitive[0].type = jsonToPrimitiveType[meshData.type];
      mesh.primitive[0].base = indexed ? meshData.base + indexBase : meshData.base;
      mesh.primitive[0].count = meshData.count;
      mesh.primitive[0].indexed = indexed;
      mesh.skin = meshData.skin !== undefined ? skins[meshData.skin] : null;
      mesh.aabb = aabb;
      if(indexed) {
        indexData.set(meshData.indices, indexBase);
        indexBase += meshData.indices.length
      }
      meshes.push(mesh)
    }
    if(numIndices > 0) {
      indexBuffer.unlock()
    }
    var meshInstances = [];
    var defaultMaterial = new pc.PhongMaterial;
    for(i = 0;i < modelData.meshInstances.length;i++) {
      var meshInstanceData = modelData.meshInstances[i];
      var node = nodes[meshInstanceData.node];
      var mesh = meshes[meshInstanceData.mesh];
      var material = this._getMaterial(i, mapping, options);
      if(!material) {
        material = defaultMaterial
      }
      var meshInstance = new pc.MeshInstance(node, mesh, material);
      if(mesh.skin) {
        var skinIndex = skins.indexOf(mesh.skin);
        if(skinIndex === -1) {
          throw new Error("Mesh's skin does not appear in skin array.");
        }
        meshInstance.skinInstance = skinInstances[skinIndex]
      }
      meshInstances.push(meshInstance)
    }
    var model = new pc.Model;
    model.graph = nodes[0];
    model.meshInstances = meshInstances;
    model.skinInstances = skinInstances;
    model.getGraph().syncHierarchy();
    return model
  };
  ModelResourceHandler.prototype._getMaterial = function(meshInstanceIndex, mapping, options) {
    var material;
    if(mapping && mapping.length > meshInstanceIndex) {
      if(mapping[meshInstanceIndex].material) {
        var asset = this._assets.getAssetById(mapping[meshInstanceIndex].material);
        if(!asset) {
          console.error("Reference to material not in asset list. Try reloading.");
          return null
        }else {
          if(!asset.resource) {
            console.error(pc.string.format("Material asset '{0}' is not loaded.", asset.name));
            return null
          }
        }
        material = asset.resource
      }else {
        if(mapping[meshInstanceIndex].path) {
          var path = pc.path.split(options.parent.canonical)[0];
          path = pc.path.join(path, mapping[meshInstanceIndex].path);
          var asset = this._assets.getAssetByUrl(path);
          if(asset) {
            material = asset.resource
          }
        }
      }
    }
    return material
  };
  var ModelRequest = function ModelRequest(identifier) {
  };
  ModelRequest = pc.inherits(ModelRequest, pc.resources.ResourceRequest);
  ModelRequest.prototype.type = "model";
  ModelRequest.prototype.Type = pc.Model;
  return{ModelResourceHandler:ModelResourceHandler, ModelRequest:ModelRequest}
}());
pc.extend(pc.resources, function() {
  function onTextureAssetRemoved(asset) {
    var material = this;
    asset.off("remove", onTextureAssetRemoved, material);
    if(!asset.resource) {
      return
    }
    var dirty = false;
    for(var key in material) {
      if(material.hasOwnProperty(key) && !pc.string.startsWith(key, "_")) {
        if(material[key] === asset.resource) {
          material[key] = null;
          dirty = true
        }
      }
    }
    if(dirty) {
      material.update()
    }
  }
  function onTextureAssetChanged(asset, attribute, newValue, oldValue) {
    if(attribute !== "resource") {
      return
    }
    var material = this;
    var dirty = false;
    if(oldValue) {
      for(var key in material) {
        if(material.hasOwnProperty(key) && !pc.string.startsWith(key, "_")) {
          if(material[key] === oldValue) {
            material[key] = newValue;
            dirty = true
          }
        }
      }
    }
    if(dirty) {
      material.update()
    }else {
      asset.off("change", onTextureAssetChanged, material);
      asset.off("remove", onTextureAssetRemoved, material)
    }
  }
  function onCubemapRemoved(asset) {
    var material = this;
    asset.off("remove", onCubemapRemoved, material);
    if(!asset.resource) {
      return
    }
    var dirty = false;
    if(material.cubeMap === asset.resources[0]) {
      material.cubeMap = null;
      dirty = true
    }
    if(asset.resources.length > 1) {
      var mipSize = 128;
      for(var i = 1;i < asset.resources.length;i++) {
        var prop = "prefilteredCubeMap" + mipSize;
        if(material[prop] === asset.resources[i]) {
          material[prop] = null;
          dirty = true
        }
      }
    }
    if(dirty) {
      material.update()
    }
  }
  function onCubemapChanged(asset, attribute, newValue, oldValue) {
    if(attribute !== "resources") {
      return
    }
    var material = this;
    var dirty = false;
    if(material.cubeMap === oldValue[0]) {
      material.cubeMap = newValue[0];
      dirty = true
    }
    var mipSize = 128;
    for(var i = 0;i < 6;i++) {
      var prop = "prefilteredCubeMap" + mipSize;
      if(material[prop] === oldValue[i]) {
        material[prop] = newValue[i];
        dirty = true
      }
    }
    if(dirty) {
      material.update()
    }else {
      asset.off("change", onCubemapChanged, material)
    }
  }
  var MaterialResourceHandler = function(device, assets) {
    this._assets = assets;
    this._device = device
  };
  MaterialResourceHandler = pc.inherits(MaterialResourceHandler, pc.resources.ResourceHandler);
  MaterialResourceHandler.prototype.load = function(request, options) {
    var promise = null;
    if(pc.string.startsWith(request.canonical, "asset://")) {
      promise = new pc.promise.Promise(function(resolve, reject) {
        var asset = this._getAssetFromRequest(request);
        if(!asset) {
          reject(pc.string("Can't load material, asset %s not found", request.canonical))
        }
        resolve(asset.data)
      }.bind(this))
    }else {
      promise = new pc.promise.Promise(function(resolve, reject) {
        pc.net.http.get(request.canonical, function(response) {
          if(response.mapping_format === "path") {
            var referencedAssets = this._listReferencedAssets(response);
            var assets = [];
            if(referencedAssets.length) {
              referencedAssets.forEach(function(referencedAsset) {
                var path = referencedAsset.data;
                var filename = pc.path.getBasename(path);
                var url = pc.path.join(pc.path.split(request.canonical)[0], path);
                assets.push(new pc.asset.Asset(filename, referencedAsset.type, {url:url}))
              });
              this._assets.load(assets).then(function(responses) {
                resolve(response)
              })
            }else {
              resolve(response)
            }
          }else {
            resolve(response)
          }
        }.bind(this), {error:function() {
          reject()
        }})
      }.bind(this))
    }
    return promise
  };
  MaterialResourceHandler.prototype.open = function(data, request, options) {
    var material = new pc.PhongMaterial;
    this._updatePhongMaterial(material, data, request);
    var asset = this._getAssetFromRequest(request);
    asset.on("change", function(asset, attribute, value) {
      if(attribute === "data") {
        this._updatePhongMaterial(material, value, request)
      }
    }, this);
    return material
  };
  MaterialResourceHandler.prototype._listReferencedAssets = function(data) {
    var param;
    return data.parameters.filter(function(param) {
      return(param.type === "texture" || param.type === "cubemap") && param.data
    })
  };
  MaterialResourceHandler.prototype._updatePhongMaterial = function(material, data, request) {
    var requests = [];
    data.parameters.push({name:"shadingModel", type:"float", data:data.shader === "blinn" ? pc.SPECULAR_BLINN : pc.SPECULAR_PHONG});
    var textures = [];
    var cubemapParam = null;
    for(var i = 0;i < data.parameters.length;i++) {
      var param = data.parameters[i];
      if(param.type === "texture" && param.data && !(param.data instanceof pc.Texture)) {
        var textureAsset = this._getTextureAssetFromRegistry(param.data, request);
        if(textureAsset) {
          textures.push(textureAsset)
        }
        this._loadTextureParamFromCache(param, textureAsset);
        if(!(param.data instanceof pc.Texture) && textureAsset) {
          requests.push(this._loadTextureParamPromise(param, textureAsset))
        }
      }else {
        if(param.name === "cubeMap" && param.data) {
          cubemapParam = param
        }
      }
    }
    if(cubemapParam) {
      var cubemapAsset = this._getTextureAssetFromRegistry(cubemapParam.data, request);
      if(cubemapAsset) {
        if(cubemapAsset.resources.length) {
          cubemapParam.data = cubemapAsset.resources[0];
          if(cubemapAsset.resources.length > 1) {
            var mipSize = 128;
            for(var i = 0;i < 6;i++) {
              data.parameters.push({name:"prefilteredCubeMap" + mipSize, data:cubemapAsset.resources[i + 1]});
              mipSize *= 0.5
            }
          }
        }else {
          requests.push(this._assets.load(cubemapAsset).then(function(resources) {
            var cubemaps = resources[0];
            cubemapParam.data = cubemaps[0];
            if(cubemaps.length > 1) {
              var mipSize = 128;
              for(var i = 0;i < 6;i++) {
                data.parameters.push({name:"prefilteredCubeMap" + mipSize, data:cubemaps[i + 1]});
                mipSize *= 0.5
              }
            }
          }, function(error) {
            cubemapParam.data = null
          }))
        }
        cubemapAsset.off("change", onCubemapChanged, material);
        cubemapAsset.on("change", onCubemapChanged, material);
        cubemapAsset.off("remove", onCubemapRemoved, material);
        cubemapAsset.on("remove", onCubemapRemoved, material)
      }else {
        pc.log.error(pc.string.format("Could not load cubemap. Asset {0} not found", cubemapParam.data));
        cubemapParam.data = null
      }
    }
    textures.forEach(function(textureAsset) {
      textureAsset.off("change", onTextureAssetChanged, material);
      textureAsset.on("change", onTextureAssetChanged, material);
      textureAsset.off("remove", onTextureAssetRemoved, material);
      textureAsset.on("remove", onTextureAssetRemoved, material)
    });
    if(requests.length) {
      pc.promise.all(requests).then(function() {
        material.init(data)
      }, function(error) {
        pc.log.error(error);
        material.init(data)
      })
    }else {
      material.init(data)
    }
  };
  MaterialResourceHandler.prototype._getTextureAssetFromRegistry = function(textureId, request) {
    var asset = this._assets.getAssetById(textureId);
    if(!asset && request) {
      url = pc.path.join(pc.path.split(request.canonical)[0], textureId);
      asset = this._assets.getAssetByUrl(url)
    }
    return asset
  };
  MaterialResourceHandler.prototype._loadTextureParamFromCache = function(param, textureAsset) {
    if(textureAsset) {
      if(textureAsset.resource) {
        param.data = textureAsset.resource
      }
    }else {
      pc.log.error(pc.string.format("Could not load texture. Asset {0} not found", param.data));
      param.data = null
    }
  };
  MaterialResourceHandler.prototype._loadTextureParamPromise = function(param, textureAsset) {
    return this._assets.load(textureAsset).then(function(resources) {
      param.data = resources[0]
    }, function(error) {
      param.data = null
    })
  };
  MaterialResourceHandler.prototype._getAssetFromRequest = function(request) {
    if(pc.string.startsWith(request.canonical, "asset://")) {
      return this._assets.getAssetById(parseInt(request.canonical.slice(8)))
    }else {
      return this._assets.getAssetByUrl(request.canonical)
    }
  };
  var MaterialRequest = function MaterialRequest(identifier) {
  };
  MaterialRequest = pc.inherits(MaterialRequest, pc.resources.ResourceRequest);
  MaterialRequest.prototype.type = "material";
  MaterialRequest.prototype.Type = pc.Material;
  return{MaterialRequest:MaterialRequest, MaterialResourceHandler:MaterialResourceHandler}
}());
pc.extend(pc.resources, function() {
  var ScriptResourceHandler = function(app, prefix) {
    this._app = app;
    this._prefix = prefix || "";
    this._queue = [];
    this._pending = [];
    this._loaded = {};
    this._loading = null;
    pc.script.on("created", this._onScriptCreated, this)
  };
  ScriptResourceHandler = pc.inherits(ScriptResourceHandler, pc.resources.ResourceHandler);
  ScriptResourceHandler.prototype.load = function(request, options) {
    options = options || {};
    options.timeout = options.timeout || 6E4;
    options.cache = true;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var url = request.canonical;
      var processedUrl = url;
      if(!options.cache) {
        processedUrl = this._appendTimestampToUrl(processedUrl)
      }
      var processedUrl = new pc.URI(processedUrl);
      processedUrl.path = pc.path.join(this._prefix, processedUrl.path);
      processedUrl = processedUrl.toString();
      if(this._loaded[url]) {
        if(this._loaded[url] !== true) {
          resolve(this._loaded[url])
        }else {
          resolve(null)
        }
      }else {
        if(this._loading) {
          this._queue.push({url:processedUrl, canonicalUrl:url, success:resolve, error:reject})
        }else {
          this._addScriptTag(processedUrl, url, resolve, reject)
        }
      }
      if(options.timeout) {
        (function() {
          setTimeout(function() {
            if(!this._loaded[url]) {
              reject(pc.string.format("Loading script {0} timed out after {1}s", url, options.timeout / 1E3))
            }
          }.bind(this), options.timeout)
        }).call(this)
      }
    }.bind(this));
    return promise
  };
  ScriptResourceHandler.prototype.open = function(data, request, options) {
    return data
  };
  ScriptResourceHandler.prototype._appendTimestampToUrl = function(url) {
    timestamp = Date.now();
    uri = new pc.URI(url);
    if(!uri.query) {
      uri.query = "ts=" + timestamp
    }else {
      uri.query = uri.query + "&ts=" + timestamp
    }
    url = uri.toString();
    return url
  };
  ScriptResourceHandler.prototype._onScriptCreated = function(name, callback) {
    this._pending.push({name:name, callback:callback})
  };
  ScriptResourceHandler.prototype._addScriptTag = function(url, canonicalUrl, success, error) {
    var self = this;
    var head = document.getElementsByTagName("head")[0];
    var element = document.createElement("script");
    this._loading = element;
    element.addEventListener("error", function(e) {
      error(pc.string.format("Error loading script from '{0}'", e.target.src))
    });
    var done = false;
    element.onload = element.onreadystatechange = function() {
      if(!done && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
        done = true;
        var script = self._pending.shift();
        if(script) {
          var ScriptType = script.callback(self._app);
          if(ScriptType._pcScriptName) {
            throw Error("Attribute _pcScriptName is reserved on ScriptTypes for ResourceLoader use");
          }
          ScriptType._pcScriptName = script.name;
          self._loaded[canonicalUrl] = ScriptType;
          self._loader.registerHash(canonicalUrl, canonicalUrl);
          self._loader.addToCache(canonicalUrl, ScriptType);
          success(ScriptType)
        }else {
          self._loaded[canonicalUrl] = true;
          self._loader.registerHash(canonicalUrl, canonicalUrl);
          self._loader.addToCache(canonicalUrl, true);
          success(null)
        }
        self._loading = null;
        if(self._queue.length) {
          var loadable = self._queue.shift();
          self._addScriptTag(loadable.url, loadable.canonicalUrl, loadable.success, loadable.error)
        }
      }
    };
    element.src = url;
    head.appendChild(element)
  };
  var ScriptRequest = function ScriptRequest() {
  };
  ScriptRequest = pc.inherits(ScriptRequest, pc.resources.ResourceRequest);
  ScriptRequest.prototype.type = "script";
  return{ScriptResourceHandler:ScriptResourceHandler, ScriptRequest:ScriptRequest}
}());
pc.extend(pc.resources, function() {
  var AnimationResourceHandler = function() {
  };
  AnimationResourceHandler = pc.inherits(AnimationResourceHandler, pc.resources.ResourceHandler);
  AnimationResourceHandler.prototype.load = function(request, options) {
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var url = request.canonical;
      var dir = pc.path.getDirectory(url);
      pc.net.http.get(url, function(response) {
        try {
          resolve(response)
        }catch(e) {
          reject(pc.string.format("An error occured while loading animation from: '{0}'", url))
        }
      }.bind(this), {cache:options.cache, error:function(errors) {
        reject(errors)
      }})
    });
    return promise
  };
  AnimationResourceHandler.prototype.open = function(data, request, options) {
    return this["_loadAnimationV" + data.animation.version](data)
  };
  AnimationResourceHandler.prototype._loadAnimationV3 = function(data) {
    var animData = data.animation;
    var anim = new pc.Animation;
    anim.setName(animData.name);
    anim.setDuration(animData.duration);
    for(var i = 0;i < animData.nodes.length;i++) {
      var node = new pc.Node;
      var n = animData.nodes[i];
      node._name = n.name;
      for(var j = 0;j < n.keys.length;j++) {
        var k = n.keys[j];
        var t = k.time;
        var p = k.pos;
        var r = k.rot;
        var s = k.scale;
        var pos = new pc.Vec3(p[0], p[1], p[2]);
        var rot = (new pc.Quat).setFromEulerAngles(r[0], r[1], r[2]);
        var scl = new pc.Vec3(s[0], s[1], s[2]);
        var key = new pc.Key(t, pos, rot, scl);
        node._keys.push(key)
      }
      anim.addNode(node)
    }
    return anim
  };
  AnimationResourceHandler.prototype._loadAnimationV4 = function(data) {
    var animData = data.animation;
    var anim = new pc.Animation;
    anim.setName(animData.name);
    anim.setDuration(animData.duration);
    for(var i = 0;i < animData.nodes.length;i++) {
      var node = new pc.Node;
      var n = animData.nodes[i];
      node._name = n.name;
      var defPos = n.defaults.p;
      var defRot = n.defaults.r;
      var defScl = n.defaults.s;
      for(var j = 0;j < n.keys.length;j++) {
        var k = n.keys[j];
        var t = k.t;
        var p = defPos ? defPos : k.p;
        var r = defRot ? defRot : k.r;
        var s = defScl ? defScl : k.s;
        var pos = new pc.Vec3(p[0], p[1], p[2]);
        var rot = (new pc.Quat).setFromEulerAngles(r[0], r[1], r[2]);
        var scl = new pc.Vec3(s[0], s[1], s[2]);
        var key = new pc.Key(t, pos, rot, scl);
        node._keys.push(key)
      }
      anim.addNode(node)
    }
    return anim
  };
  var AnimationRequest = function AnimationRequest(identifier) {
  };
  AnimationRequest = pc.inherits(AnimationRequest, pc.resources.ResourceRequest);
  AnimationRequest.prototype.type = "animation";
  AnimationRequest.prototype.Type = pc.Animation;
  return{AnimationResourceHandler:AnimationResourceHandler, AnimationRequest:AnimationRequest}
}());
pc.extend(pc.resources, function() {
  var AudioResourceHandler = function(manager) {
    this.manager = manager
  };
  AudioResourceHandler = pc.inherits(AudioResourceHandler, pc.resources.ResourceHandler);
  AudioResourceHandler.prototype.load = function(request, options) {
    var self = this;
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var sound = self.manager.createSound(request.canonical, function(sound) {
        resolve(sound)
      }, function(error) {
        logERROR(error);
        resolve(sound)
      })
    });
    return promise
  };
  AudioResourceHandler.prototype.open = function(data, request, options) {
    return data
  };
  var AudioRequest = function(identifier) {
  };
  AudioRequest = pc.inherits(AudioRequest, pc.resources.ResourceRequest);
  AudioRequest.prototype.type = "audio";
  AudioRequest.prototype.Type = pc.Sound;
  return{AudioResourceHandler:AudioResourceHandler, AudioRequest:AudioRequest}
}());
pc.extend(pc.resources, function() {
  var PackResourceHandler = function(app, depot) {
    this._app = app;
    this._depot = depot
  };
  PackResourceHandler = pc.inherits(PackResourceHandler, pc.resources.ResourceHandler);
  PackResourceHandler.prototype.load = function(request, options) {
    options = options || {};
    var promise = new pc.promise.Promise(function(resolve, reject) {
      var guid = request.canonical;
      if(guid in pc.content.packs) {
        setTimeout(function() {
          resolve(pc.content.packs[guid])
        }, 0)
      }else {
        this._depot.packs.getOne(guid, function(pack) {
          resolve(pack)
        }.bind(this), function(errors) {
          reject(errors)
        })
      }
    }.bind(this));
    return promise
  };
  PackResourceHandler.prototype.open = function(data, request, options) {
    var pack = this.openPack(data, request);
    return pack
  };
  PackResourceHandler.prototype.openPack = function(data, request) {
    var d = pc.extend({}, data);
    d.hierarchy = this.openEntity(d.hierarchy, request);
    return new pc.Pack(d)
  };
  PackResourceHandler.prototype.openEntity = function(data, request) {
    var hierarchy;
    hierarchy = this.openEntityHierarchy(data, request);
    hierarchy.syncHierarchy();
    hierarchy = this.openComponentData(hierarchy, data, request);
    return hierarchy
  };
  PackResourceHandler.prototype.openEntityHierarchy = function(data, request) {
    var entity = new pc.Entity(this._app);
    var p = data.position;
    var r = data.rotation;
    var s = data.scale;
    entity.setName(data.name);
    entity.setGuid(data.resource_id);
    entity.setLocalPosition(p[0], p[1], p[2]);
    entity.setLocalEulerAngles(r[0], r[1], r[2]);
    entity.setLocalScale(s[0], s[1], s[2]);
    entity._enabled = data.enabled !== undefined ? data.enabled : true;
    entity._enabledInHierarchy = entity._enabled;
    if(data.labels) {
      data.labels.forEach(function(label) {
        entity.addLabel(label)
      })
    }
    entity.__parent = data.parent;
    entity.__children = data.children;
    entity.name = data.name;
    entity.template = data.template;
    var i, child, length = data.children.length;
    for(i = 0;i < length;i++) {
      child = this.openEntityHierarchy(data.children[i], request);
      entity.addChild(child)
    }
    return entity
  };
  PackResourceHandler.prototype.openComponentData = function(entity, data, request) {
    entity.setRequest(request);
    var systems = this._app.systems.list();
    var i, len = systems.length;
    for(i = 0;i < len;i++) {
      var componentData = data.components[systems[i].id];
      if(componentData) {
        this._app.systems[systems[i].id].addComponent(entity, componentData)
      }
    }
    entity.setRequest(null);
    var child, length = data.children.length;
    var children = entity.getChildren();
    for(i = 0;i < length;i++) {
      children[i] = this.openComponentData(children[i], data.children[i], request)
    }
    return entity
  };
  var PackRequest = function PackRequest(identifier) {
  };
  PackRequest = pc.inherits(PackRequest, pc.resources.ResourceRequest);
  PackRequest.prototype.type = "pack";
  PackRequest.prototype.Type = pc.Pack;
  return{PackResourceHandler:PackResourceHandler, PackRequest:PackRequest}
}());
pc.asset = {};
pc.extend(pc.asset, function() {
  var assetIdCounter = -1;
  var Asset = function(name, type, file, data) {
    var file, data;
    this._id = ++assetIdCounter;
    this.name = arguments[0];
    this.type = arguments[1];
    this._file = arguments[2] ? {filename:file.filename, size:file.size, hash:file.hash, url:file.url} : null;
    this._data = arguments[3] || {};
    this._resources = [];
    pc.events.attach(this)
  };
  Asset.prototype = {getFileUrl:function() {
    if(!this.file) {
      return null
    }
    return this.file.url
  }};
  Object.defineProperty(Asset.prototype, "id", {get:function() {
    return this._id
  }, set:function(value) {
    this._id = value;
    if(value > assetIdCounter) {
      assetIdCounter = value
    }
  }});
  Object.defineProperty(Asset.prototype, "file", {get:function() {
    return this._file
  }, set:function(value) {
    var old = this._file;
    this._file = value;
    if(value && !old || !value && old || value && old && value.hash !== old.hash) {
      this.fire("change", this, "file", value, old)
    }
  }});
  Object.defineProperty(Asset.prototype, "data", {get:function() {
    return this._data
  }, set:function(value) {
    var old = this._data;
    this._data = value;
    if(value !== old) {
      this.fire("change", this, "data", value, old)
    }
  }});
  Object.defineProperty(Asset.prototype, "resource", {get:function() {
    return this._resources[0]
  }, set:function(value) {
    this._resources[0] = value
  }});
  Object.defineProperty(Asset.prototype, "resources", {get:function() {
    return this._resources
  }, set:function(value) {
    if(value === null || value === undefined) {
      value = []
    }else {
      if(pc.type(value) !== "array") {
        value = [value]
      }
    }
    this._resources = value
  }});
  return{Asset:Asset, ASSET_ANIMATION:"animation", ASSET_AUDIO:"audio", ASSET_IMAGE:"image", ASSET_JSON:"json", ASSET_MODEL:"model", ASSET_MATERIAL:"material", ASSET_TEXT:"text", ASSET_TEXTURE:"texture", ASSET_CUBEMAP:"cubemap"}
}());
pc.extend(pc.asset, function() {
  var AssetRegistry = function(loader) {
    if(!loader) {
      throw new Error("Must provide a ResourceLoader instance for AssetRegistry");
    }
    this.loader = loader;
    this._cache = {};
    this._names = {};
    this._urls = {};
    this._groups = {}
  };
  AssetRegistry.prototype = {addGroup:function(name, toc) {
    if(!this._groups[name]) {
      this._groups[name] = []
    }
    for(var id in toc.assets) {
      var asset = this.getAssetById(id);
      if(!asset) {
        var assetData = toc.assets[id];
        asset = this.createAndAddAsset(id, assetData)
      }else {
        pc.extend(asset, toc.assets[id])
      }
      this._groups[name].push(asset.id)
    }
  }, createAndAddAsset:function(id, assetData) {
    var asset = new pc.asset.Asset(assetData.name, assetData.type, assetData.file, assetData.data);
    asset.id = parseInt(id);
    this.addAsset(asset);
    if(asset.file) {
      this.loader.registerHash(asset.file.hash, asset.getFileUrl())
    }else {
      this.loader.registerHash(asset.id, "asset://" + asset.id)
    }
    return asset
  }, all:function() {
    return Object.keys(this._cache).map(function(id) {
      return this.getAssetById(id)
    }, this)
  }, list:function(groupName) {
    if(groupName) {
      if(this._groups[groupName]) {
        return this._groups[groupName].map(function(id) {
          return this.getAssetById(id)
        }, this)
      }
    }else {
      return Object.keys(this._cache).map(function(id) {
        return this.getAssetById(id)
      }, this)
    }
  }, addAsset:function(asset) {
    this._cache[asset.id] = asset;
    if(!this._names[asset.name]) {
      this._names[asset.name] = []
    }
    this._names[asset.name].push(asset.id);
    if(asset.file) {
      this._urls[asset.getFileUrl()] = asset.id
    }
    if(asset.type !== "cubemap") {
      asset.on("change", this._onAssetChanged, this)
    }
  }, removeAsset:function(asset) {
    delete this._cache[asset.id];
    delete this._names[asset.name];
    asset.fire("remove", asset);
    if(asset.file) {
      delete this._urls[asset.file.url]
    }
    if(asset.type !== "cubemap") {
      asset.off("change", this._onAssetChanged, this)
    }
  }, _onAssetChanged:function(asset, attribute, newValue, oldValue) {
    var url;
    if(attribute === "file") {
      if(oldValue) {
        url = oldValue.url;
        delete this._urls[url];
        this.loader.removeFromCache(url);
        this.loader.unregisterHash(url)
      }
      if(newValue) {
        url = asset.getFileUrl();
        this._urls[url] = asset.id;
        this.loader.registerHash(newValue.hash, url);
        var oldResource = asset.resource;
        this.load([asset]).then(function(resources) {
          asset.fire("change", asset, "resource", resources[0], oldResource)
        })
      }
    }
  }, findAll:function(name, type) {
    var self = this;
    var ids = this._names[name];
    var assets;
    if(ids) {
      assets = ids.map(function(id) {
        return self._cache[id]
      });
      if(type) {
        return assets.filter(function(asset) {
          return asset.type === type
        })
      }else {
        return assets
      }
    }else {
      return[]
    }
  }, find:function(name, type) {
    var asset = this.findAll(name, type);
    return asset ? asset[0] : null
  }, getAssetByResourceId:function(id) {
    console.warn("WARNING: getAssetByResourceId: Function is deprecated. Use getAssetById() instead.");
    return this._cache[id]
  }, getAssetById:function(id) {
    return this._cache[id]
  }, getAssetByUrl:function(url) {
    var id = this._urls[url];
    return this._cache[id]
  }, getAssetByName:function(name) {
    console.warn("WARNING: getAssetByName: Function is deprecated. Use find() or findAll() instead.");
    return this.find(name)
  }, load:function(assets, results, options) {
    if(assets && pc.type(assets) !== "array") {
      assets = [assets]
    }
    if(options === undefined) {
      options = results;
      results = []
    }
    var requests = [];
    assets.forEach(function(asset, index) {
      var existing = this.getAssetById(asset.id);
      if(!existing) {
        this.addAsset(asset)
      }
      switch(asset.type) {
        case pc.asset.ASSET_MODEL:
          requests.push(this._createModelRequest(asset));
          break;
        case pc.asset.ASSET_TEXTURE:
          requests.push(this._createTextureRequest(asset, results[index]));
          break;
        case pc.asset.ASSET_CUBEMAP:
          requests.push(this._createCubemapRequest(asset, results[index]));
          break;
        case pc.asset.ASSET_MATERIAL:
          requests.push(this._createMaterialRequest(asset));
          break;
        default:
          requests.push(this._createAssetRequest(asset));
          break
      }
    }, this);
    return this.loader.request(requests.filter(function(r) {
      return r !== null
    }), options).then(function(resources) {
      var promise = new pc.promise.Promise(function(resolve, reject) {
        var index = 0;
        requests.forEach(function(r, i) {
          if(r) {
            assets[i].resources = resources[index++]
          }
        });
        resolve(resources)
      });
      return promise
    }, function(error) {
      setTimeout(function() {
        throw error;
      }, 0)
    })
  }, loadFromUrl:function(url, type) {
    if(!type) {
      throw Error("type required");
    }
    if(type === "model") {
      return this._loadModel(url)
    }
    var dir = pc.path.getDirectory(url);
    var basename = pc.path.getBasename(url);
    var name = basename.replace(".json", "");
    var asset = new pc.asset.Asset(name, type, {url:url});
    var promise = new pc.promise.Promise(function(resolve, reject) {
      this.load(asset).then(function(resource) {
        resolve({resource:resource, asset:asset})
      })
    }.bind(this));
    return promise
  }, _loadModel:function(url) {
    var self = this;
    var dir = pc.path.getDirectory(url);
    var basename = pc.path.getBasename(url);
    var name = basename.replace(".json", "");
    var mappingUrl = pc.path.join(dir, basename.replace(".json", ".mapping.json"));
    var modelAsset = new pc.asset.Asset(name, "model", {url:url});
    var mappingAsset = new pc.asset.Asset(name + ".mapping", "json", {url:mappingUrl});
    var promise = new pc.promise.Promise(function(resolve, reject) {
      self.load([modelAsset, mappingAsset]).then(function(resources) {
        var model = resources[0];
        var mapping = resources[1];
        modelAsset.data = mapping;
        var materialAssets = [];
        mapping.mapping.forEach(function(map) {
          materialAssets.push(new pc.asset.Asset(pc.path.getBasename(map.path), "material", {url:pc.path.join(dir, map.path)}))
        });
        if(materialAssets.length) {
          var promise = self.load(materialAssets);
          promise.then(function(materials) {
            for(var i = 0, n = model.meshInstances.length;i < n;i++) {
              model.meshInstances[i].material = materials[i]
            }
            resolve({resource:model, asset:modelAsset})
          });
          return promise
        }else {
          resolve({resource:model, asset:modelAsset})
        }
      })
    });
    return promise
  }, _createAssetRequest:function(asset, result) {
    var url = asset.getFileUrl();
    if(url) {
      return this.loader.createFileRequest(url, asset.type)
    }else {
      return null
    }
  }, _createModelRequest:function(asset) {
    var url = asset.getFileUrl();
    var mapping = asset.data && asset.data.mapping ? asset.data.mapping : [];
    return new pc.resources.ModelRequest(url, mapping)
  }, _createTextureRequest:function(asset, texture) {
    return new pc.resources.TextureRequest(asset.getFileUrl(), null, texture)
  }, _createCubemapRequest:function(asset, texture) {
    var url = asset.getFileUrl();
    if(!url || !pc.string.endsWith(url.toLowerCase(), ".json")) {
      url = "asset://" + asset.id
    }
    return new pc.resources.CubemapRequest(url, null, texture)
  }, _createMaterialRequest:function(asset) {
    var url = asset.getFileUrl();
    if(url) {
      return new pc.resources.MaterialRequest(url)
    }else {
      return new pc.resources.MaterialRequest("asset://" + asset.id)
    }
  }};
  return{AssetRegistry:AssetRegistry}
}());
!function(a) {
  var b, c;
  !function() {
    var a = {}, d = {};
    b = function(b, c, d) {
      a[b] = {deps:c, callback:d}
    }, c = function(b) {
      function e(a) {
        if("." !== a.charAt(0)) {
          return a
        }
        for(var c = a.split("/"), d = b.split("/").slice(0, -1), e = 0, f = c.length;f > e;e++) {
          var g = c[e];
          if(".." === g) {
            d.pop()
          }else {
            if("." === g) {
              continue
            }
            d.push(g)
          }
        }
        return d.join("/")
      }
      if(d[b]) {
        return d[b]
      }
      if(d[b] = {}, !a[b]) {
        throw new Error("Could not find module " + b);
      }
      for(var f, g = a[b], h = g.deps, i = g.callback, j = [], k = 0, l = h.length;l > k;k++) {
        j.push("exports" === h[k] ? f = {} : c(e(h[k])))
      }
      var m = i.apply(this, j);
      return d[b] = f || m
    }, c.entries = a
  }(), b("rsvp/all-settled", ["./promise", "./utils", "exports"], function(a, b, c) {
    function d(a) {
      return{state:"fulfilled", value:a}
    }
    function e(a) {
      return{state:"rejected", reason:a}
    }
    var f = a["default"], g = b.isArray, h = b.isNonThenable;
    c["default"] = function(a, b) {
      return new f(function(b) {
        function c(a) {
          return function(b) {
            j(a, d(b))
          }
        }
        function i(a) {
          return function(b) {
            j(a, e(b))
          }
        }
        function j(a, c) {
          m[a] = c, 0 === --l && b(m)
        }
        if(!g(a)) {
          throw new TypeError("You must pass an array to allSettled.");
        }
        var k, l = a.length;
        if(0 === l) {
          return void b([])
        }
        for(var m = new Array(l), n = 0;n < a.length;n++) {
          k = a[n], h(k) ? j(n, d(k)) : f.resolve(k).then(c(n), i(n))
        }
      }, b)
    }
  }), b("rsvp/all", ["./promise", "exports"], function(a, b) {
    var c = a["default"];
    b["default"] = function(a, b) {
      return c.all(a, b)
    }
  }), b("rsvp/asap", ["exports"], function(a) {
    function b() {
      return function() {
        process.nextTick(e)
      }
    }
    function c() {
      var a = 0, b = new h(e), c = document.createTextNode("");
      return b.observe(c, {characterData:!0}), function() {
        c.data = a = ++a % 2
      }
    }
    function d() {
      return function() {
        setTimeout(e, 1)
      }
    }
    function e() {
      for(var a = 0;a < i.length;a++) {
        var b = i[a], c = b[0], d = b[1];
        c(d)
      }
      i.length = 0
    }
    a["default"] = function(a, b) {
      var c = i.push([a, b]);
      1 === c && f()
    };
    var f, g = "undefined" != typeof window ? window : {}, h = g.MutationObserver || g.WebKitMutationObserver, i = [];
    f = "undefined" != typeof process && "[object process]" === {}.toString.call(process) ? b() : h ? c() : d()
  }), b("rsvp/config", ["./events", "exports"], function(a, b) {
    function c(a, b) {
      return"onerror" === a ? void e.on("error", b) : 2 !== arguments.length ? e[a] : void(e[a] = b)
    }
    var d = a["default"], e = {instrument:!1};
    d.mixin(e), b.config = e, b.configure = c
  }), b("rsvp/defer", ["./promise", "exports"], function(a, b) {
    var c = a["default"];
    b["default"] = function(a) {
      var b = {};
      return b.promise = new c(function(a, c) {
        b.resolve = a, b.reject = c
      }, a), b
    }
  }), b("rsvp/events", ["exports"], function(a) {
    function b(a, b) {
      for(var c = 0, d = a.length;d > c;c++) {
        if(a[c] === b) {
          return c
        }
      }
      return-1
    }
    function c(a) {
      var b = a._promiseCallbacks;
      return b || (b = a._promiseCallbacks = {}), b
    }
    a["default"] = {mixin:function(a) {
      return a.on = this.on, a.off = this.off, a.trigger = this.trigger, a._promiseCallbacks = void 0, a
    }, on:function(a, d) {
      var e, f = c(this);
      e = f[a], e || (e = f[a] = []), -1 === b(e, d) && e.push(d)
    }, off:function(a, d) {
      var e, f, g = c(this);
      return d ? (e = g[a], f = b(e, d), void(-1 !== f && e.splice(f, 1))) : void(g[a] = [])
    }, trigger:function(a, b) {
      var d, e, f = c(this);
      if(d = f[a]) {
        for(var g = 0;g < d.length;g++) {
          (e = d[g])(b)
        }
      }
    }}
  }), b("rsvp/filter", ["./promise", "./utils", "exports"], function(a, b, c) {
    var d = a["default"], e = b.isFunction;
    c["default"] = function(a, b, c) {
      return d.all(a, c).then(function(a) {
        if(!e(b)) {
          throw new TypeError("You must pass a function as filter's second argument.");
        }
        for(var f = a.length, g = new Array(f), h = 0;f > h;h++) {
          g[h] = b(a[h])
        }
        return d.all(g, c).then(function(b) {
          for(var c = new Array(f), d = 0, e = 0;f > e;e++) {
            b[e] === !0 && (c[d] = a[e], d++)
          }
          return c.length = d, c
        })
      })
    }
  }), b("rsvp/hash-settled", ["./promise", "./utils", "exports"], function(a, b, c) {
    function d(a) {
      return{state:"fulfilled", value:a}
    }
    function e(a) {
      return{state:"rejected", reason:a}
    }
    var f = a["default"], g = b.isNonThenable, h = b.keysOf;
    c["default"] = function(a) {
      return new f(function(b) {
        function c(a) {
          return function(b) {
            j(a, d(b))
          }
        }
        function i(a) {
          return function(b) {
            j(a, e(b))
          }
        }
        function j(a, c) {
          m[a] = c, 0 === --o && b(m)
        }
        var k, l, m = {}, n = h(a), o = n.length;
        if(0 === o) {
          return void b(m)
        }
        for(var p = 0;p < n.length;p++) {
          l = n[p], k = a[l], g(k) ? j(l, d(k)) : f.resolve(k).then(c(l), i(l))
        }
      })
    }
  }), b("rsvp/hash", ["./promise", "./utils", "exports"], function(a, b, c) {
    var d = a["default"], e = b.isNonThenable, f = b.keysOf;
    c["default"] = function(a) {
      return new d(function(b, c) {
        function g(a) {
          return function(c) {
            k[a] = c, 0 === --m && b(k)
          }
        }
        function h(a) {
          m = 0, c(a)
        }
        var i, j, k = {}, l = f(a), m = l.length;
        if(0 === m) {
          return void b(k)
        }
        for(var n = 0;n < l.length;n++) {
          j = l[n], i = a[j], e(i) ? (k[j] = i, 0 === --m && b(k)) : d.resolve(i).then(g(j), h)
        }
      })
    }
  }), b("rsvp/instrument", ["./config", "./utils", "exports"], function(a, b, c) {
    var d = a.config, e = b.now;
    c["default"] = function(a, b, c) {
      try {
        d.trigger(a, {guid:b._guidKey + b._id, eventName:a, detail:b._detail, childGuid:c && b._guidKey + c._id, label:b._label, timeStamp:e(), stack:(new Error(b._label)).stack})
      }catch(f) {
        setTimeout(function() {
          throw f;
        }, 0)
      }
    }
  }), b("rsvp/map", ["./promise", "./utils", "exports"], function(a, b, c) {
    var d = a["default"], e = (b.isArray, b.isFunction);
    c["default"] = function(a, b, c) {
      return d.all(a, c).then(function(a) {
        if(!e(b)) {
          throw new TypeError("You must pass a function as map's second argument.");
        }
        for(var f = a.length, g = new Array(f), h = 0;f > h;h++) {
          g[h] = b(a[h])
        }
        return d.all(g, c)
      })
    }
  }), b("rsvp/node", ["./promise", "./utils", "exports"], function(a, b, c) {
    var d = a["default"], e = b.isArray;
    c["default"] = function(a, b) {
      function c() {
        for(var c = arguments.length, e = new Array(c), h = 0;c > h;h++) {
          e[h] = arguments[h]
        }
        var i;
        return f || g || !b ? i = this : (console.warn('Deprecation: RSVP.denodeify() doesn\'t allow setting the "this" binding anymore. Use yourFunction.bind(yourThis) instead.'), i = b), d.all(e).then(function(c) {
          function e(d, e) {
            function h() {
              for(var a = arguments.length, c = new Array(a), h = 0;a > h;h++) {
                c[h] = arguments[h]
              }
              var i = c[0], j = c[1];
              if(i) {
                e(i)
              }else {
                if(f) {
                  d(c.slice(1))
                }else {
                  if(g) {
                    var k, l, m = {}, n = c.slice(1);
                    for(l = 0;l < b.length;l++) {
                      k = b[l], m[k] = n[l]
                    }
                    d(m)
                  }else {
                    d(j)
                  }
                }
              }
            }
            c.push(h), a.apply(i, c)
          }
          return new d(e)
        })
      }
      var f = b === !0, g = e(b);
      return c.__proto__ = a, c
    }
  }), b("rsvp/promise", ["./config", "./events", "./instrument", "./utils", "./promise/cast", "./promise/all", "./promise/race", "./promise/resolve", "./promise/reject", "exports"], function(a, b, c, d, e, f, g, h, i, j) {
    function k() {
    }
    function l(a, b) {
      if(!z(a)) {
        throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");
      }
      if(!(this instanceof l)) {
        throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
      }
      this._id = H++, this._label = b, this._subscribers = [], w.instrument && x("created", this), k !== a && m(a, this)
    }
    function m(a, b) {
      function c(a) {
        r(b, a)
      }
      function d(a) {
        t(b, a)
      }
      try {
        a(c, d)
      }catch(e) {
        d(e)
      }
    }
    function n(a, b, c, d) {
      var e = a._subscribers, f = e.length;
      e[f] = b, e[f + K] = c, e[f + L] = d
    }
    function o(a, b) {
      var c, d, e = a._subscribers, f = a._detail;
      w.instrument && x(b === K ? "fulfilled" : "rejected", a);
      for(var g = 0;g < e.length;g += 3) {
        c = e[g], d = e[g + b], p(b, c, d, f)
      }
      a._subscribers = null
    }
    function p(a, b, c, d) {
      var e, f, g, h, i = z(c);
      if(i) {
        try {
          e = c(d), g = !0
        }catch(j) {
          h = !0, f = j
        }
      }else {
        e = d, g = !0
      }
      q(b, e) || (i && g ? r(b, e) : h ? t(b, f) : a === K ? r(b, e) : a === L && t(b, e))
    }
    function q(a, b) {
      var c, d = null;
      try {
        if(a === b) {
          throw new TypeError("A promises callback cannot return that same promise.");
        }
        if(y(b) && (d = b.then, z(d))) {
          return d.call(b, function(d) {
            return c ? !0 : (c = !0, void(b !== d ? r(a, d) : s(a, d)))
          }, function(b) {
            return c ? !0 : (c = !0, void t(a, b))
          }, "Settle: " + (a._label || " unknown promise")), !0
        }
      }catch(e) {
        return c ? !0 : (t(a, e), !0)
      }
      return!1
    }
    function r(a, b) {
      a === b ? s(a, b) : q(a, b) || s(a, b)
    }
    function s(a, b) {
      a._state === I && (a._state = J, a._detail = b, w.async(u, a))
    }
    function t(a, b) {
      a._state === I && (a._state = J, a._detail = b, w.async(v, a))
    }
    function u(a) {
      o(a, a._state = K)
    }
    function v(a) {
      a._onerror && a._onerror(a._detail), o(a, a._state = L)
    }
    var w = a.config, x = (b["default"], c["default"]), y = d.objectOrFunction, z = d.isFunction, A = d.now, B = e["default"], C = f["default"], D = g["default"], E = h["default"], F = i["default"], G = "rsvp_" + A() + "-", H = 0;
    j["default"] = l, l.cast = B, l.all = C, l.race = D, l.resolve = E, l.reject = F;
    var I = void 0, J = 0, K = 1, L = 2;
    l.prototype = {constructor:l, _id:void 0, _guidKey:G, _label:void 0, _state:void 0, _detail:void 0, _subscribers:void 0, _onerror:function(a) {
      w.trigger("error", a)
    }, then:function(a, b, c) {
      var d = this;
      this._onerror = null;
      var e = new this.constructor(k, c);
      if(this._state) {
        var f = arguments;
        w.async(function() {
          p(d._state, e, f[d._state - 1], d._detail)
        })
      }else {
        n(this, e, a, b)
      }
      return w.instrument && x("chained", d, e), e
    }, "catch":function(a, b) {
      return this.then(null, a, b)
    }, "finally":function(a, b) {
      var c = this.constructor;
      return this.then(function(b) {
        return c.resolve(a()).then(function() {
          return b
        })
      }, function(b) {
        return c.resolve(a()).then(function() {
          throw b;
        })
      }, b)
    }}
  }), b("rsvp/promise/all", ["../utils", "exports"], function(a, b) {
    var c = a.isArray, d = a.isNonThenable;
    b["default"] = function(a, b) {
      var e = this;
      return new e(function(b, f) {
        function g(a) {
          return function(c) {
            k[a] = c, 0 === --j && b(k)
          }
        }
        function h(a) {
          j = 0, f(a)
        }
        if(!c(a)) {
          throw new TypeError("You must pass an array to all.");
        }
        var i, j = a.length, k = new Array(j);
        if(0 === j) {
          return void b(k)
        }
        for(var l = 0;l < a.length;l++) {
          i = a[l], d(i) ? (k[l] = i, 0 === --j && b(k)) : e.resolve(i).then(g(l), h)
        }
      }, b)
    }
  }), b("rsvp/promise/cast", ["exports"], function(a) {
    a["default"] = function(a, b) {
      var c = this;
      return a && "object" == typeof a && a.constructor === c ? a : new c(function(b) {
        b(a)
      }, b)
    }
  }), b("rsvp/promise/race", ["../utils", "exports"], function(a, b) {
    var c = a.isArray, d = (a.isFunction, a.isNonThenable);
    b["default"] = function(a, b) {
      var e, f = this;
      return new f(function(b, g) {
        function h(a) {
          j && (j = !1, b(a))
        }
        function i(a) {
          j && (j = !1, g(a))
        }
        if(!c(a)) {
          throw new TypeError("You must pass an array to race.");
        }
        for(var j = !0, k = 0;k < a.length;k++) {
          if(e = a[k], d(e)) {
            return j = !1, void b(e)
          }
          f.resolve(e).then(h, i)
        }
      }, b)
    }
  }), b("rsvp/promise/reject", ["exports"], function(a) {
    a["default"] = function(a, b) {
      var c = this;
      return new c(function(b, c) {
        c(a)
      }, b)
    }
  }), b("rsvp/promise/resolve", ["exports"], function(a) {
    a["default"] = function(a, b) {
      var c = this;
      return a && "object" == typeof a && a.constructor === c ? a : new c(function(b) {
        b(a)
      }, b)
    }
  }), b("rsvp/race", ["./promise", "exports"], function(a, b) {
    var c = a["default"];
    b["default"] = function(a, b) {
      return c.race(a, b)
    }
  }), b("rsvp/reject", ["./promise", "exports"], function(a, b) {
    var c = a["default"];
    b["default"] = function(a, b) {
      return c.reject(a, b)
    }
  }), b("rsvp/resolve", ["./promise", "exports"], function(a, b) {
    var c = a["default"];
    b["default"] = function(a, b) {
      return c.resolve(a, b)
    }
  }), b("rsvp/rethrow", ["exports"], function(a) {
    a["default"] = function(a) {
      throw setTimeout(function() {
        throw a;
      }), a;
    }
  }), b("rsvp/utils", ["exports"], function(a) {
    function b(a) {
      return"function" == typeof a || "object" == typeof a && null !== a
    }
    function c(a) {
      return"function" == typeof a
    }
    function d(a) {
      return!b(a)
    }
    a.objectOrFunction = b, a.isFunction = c, a.isNonThenable = d;
    var e;
    e = Array.isArray ? Array.isArray : function(a) {
      return"[object Array]" === Object.prototype.toString.call(a)
    };
    var f = e;
    a.isArray = f;
    var g = Date.now || function() {
      return(new Date).getTime()
    };
    a.now = g;
    var h = Object.keys || function(a) {
      var b = [];
      for(var c in a) {
        b.push(c)
      }
      return b
    };
    a.keysOf = h
  }), b("rsvp", ["./rsvp/promise", "./rsvp/events", "./rsvp/node", "./rsvp/all", "./rsvp/all-settled", "./rsvp/race", "./rsvp/hash", "./rsvp/hash-settled", "./rsvp/rethrow", "./rsvp/defer", "./rsvp/config", "./rsvp/map", "./rsvp/resolve", "./rsvp/reject", "./rsvp/filter", "./rsvp/asap", "exports"], function(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q) {
    function r(a, b) {
      E.async(a, b)
    }
    function s() {
      E.on.apply(E, arguments)
    }
    function t() {
      E.off.apply(E, arguments)
    }
    var u = a["default"], v = b["default"], w = c["default"], x = d["default"], y = e["default"], z = f["default"], A = g["default"], B = h["default"], C = i["default"], D = j["default"], E = k.config, F = k.configure, G = l["default"], H = m["default"], I = n["default"], J = o["default"], K = p["default"];
    if(E.async = K, "undefined" != typeof window && "object" == typeof window.__PROMISE_INSTRUMENTATION__) {
      var L = window.__PROMISE_INSTRUMENTATION__;
      F("instrument", !0);
      for(var M in L) {
        L.hasOwnProperty(M) && s(M, L[M])
      }
    }
    q.Promise = u, q.EventTarget = v, q.all = x, q.allSettled = y, q.race = z, q.hash = A, q.hashSettled = B, q.rethrow = C, q.defer = D, q.denodeify = w, q.configure = F, q.on = s, q.off = t, q.resolve = H, q.reject = I, q.async = r, q.map = G, q.filter = J
  }), a.RSVP = c("rsvp")
}(window);
pc.promise = {Promise:window.RSVP.Promise, all:window.RSVP.all};
pc.anim = {Animation:pc.Animation, Key:pc.Key, Node:pc.Node, Skeleton:pc.Skeleton};
pc.audio = {AudioManager:pc.AudioManager, Channel:pc.Channel, Channel3d:pc.Channel3d, Listener:pc.Listener, Sound:pc.Sound};
pc.fw = {Application:pc.Application, Component:pc.Component, ComponentData:pc.ComponentData, ComponentSystem:pc.ComponentSystem, ContentFile:pc.ContentFile, Entity:pc.Entity, FillMode:{NONE:pc.FILLMODE_NONE, FILL_WINDOW:pc.FILLMODE_FILL_WINDOW, KEEP_ASPECT:pc.FILLMODE_KEEP_ASPECT}, LiveLink:pc.LiveLink, LiveLinkCloseEntityMessage:pc.LiveLinkCloseEntityMessage, LiveLinkMessage:pc.LiveLinkMessage, LiveLinkMessageRegister:pc.LiveLinkMessageRegister, LiveLinkMessageType:{CLOSE_ENTITY:"CLOSE_ENTITY",
NO_TYPE:"NO_TYPE", OPEN_ENTITY:"OPEN_ENTITY", OPEN_PACK:"OPEN_PACK", RECEIVED:"RECEIVED", REPARENT_ENTITY:"REPARENT_ENTITY", SELECTION_UPDATED:"SELECTION_UPDATED", UPDATE_ASSET:"UPDATE_ASSET", UPDATE_ASSETCACHE:"UPDATE_ASSETCACHE", UPDATE_COMPONENT:"UPDATE_COMPONENT", UPDATE_ENTITY:"UPDATE_ENTITY", UPDATE_ENTITY_ENABLED:"UPDATE_ENTITY_ENABLED", UPDATE_ENTITY_NAME:"UPDATE_ENTITY_NAME", UPDATE_ENTITY_TRANSFORM:"UPDATE_ENTITY_TRANSFORM", UPDATE_PACK_SETTINGS:"UPDATE_PACK_SETTINGS"}, LiveLinkOpenEntityMessage:pc.LiveLinkOpenEntityMessage,
LiveLinkOpenPackMessage:pc.LiveLinkOpenPackMessage, LiveLinkReparentEntityMessage:pc.LiveLinkReparentEntityMessage, LiveLinkUpdateAssetCacheMessage:pc.LiveLinkUpdateAssetCacheMessage, LiveLinkUpdateAssetMessage:pc.LiveLinkUpdateAssetMessage, LiveLinkUpdateComponentMessage:pc.LiveLinkUpdateComponentMessage, LiveLinkUpdateEntityEnabledMessage:pc.LiveLinkUpdateEntityEnabledMessage, LiveLinkUpdateEntityMessage:pc.LiveLinkUpdateEntityMessage, LiveLinkUpdateEntityNameMessage:pc.LiveLinkUpdateEntityNameMessage,
LiveLinkUpdateEntityTransformMessage:pc.LiveLinkUpdateEntityTransformMessage, LiveLinkUpdatePackSettings:pc.LiveLinkUpdatePackSettings, Pack:pc.Pack, ResolutionMode:{AUTO:pc.RESOLUTION_AUTO, FIXED:pc.RESOLUTION_FIXED}};
pc.extend(pc.gfx, {drawQuadWithShader:pc.drawQuadWithShader, precalculatedTangents:pc.precalculatedTangents, programlib:pc.programlib, shaderChunks:pc.shaderChunks, ContextCreationError:pc.ContextCreationError, Device:pc.GraphicsDevice, IndexBuffer:pc.IndexBuffer, ProgramLibrary:pc.ProgramLibrary, RenderTarget:pc.RenderTarget, ScopeId:pc.ScopeId, Shader:pc.Shader, ShaderInput:pc.ShaderInput, Texture:pc.Texture, UnsupportedBrowserError:pc.UnsupportedBrowserError, VertexBuffer:pc.VertexBuffer, VertexFormat:pc.VertexFormat,
VertexIterator:pc.VertexIterator});
pc.extend(pc.input, {getTouchTargetCoords:pc.getTouchTargetCoords, Controller:pc.Controller, GamePads:pc.GamePads, Keyboard:pc.Keyboard, KeyboardEvent:pc.KeyboardEvent, Mouse:pc.Mouse, MouseEvent:pc.MouseEvent, Touch:pc.Touch, TouchDevice:pc.TouchDevice, TouchEvent:pc.TouchEvent});
pc.posteffect = {createFullscreenQuad:pc.createFullscreenQuad, drawFullscreenQuad:pc.drawFullscreenQuad, PostEffect:pc.PostEffect, PostEffectQueue:pc.PostEffectQueue};
pc.extend(pc.scene, {partitionSkin:pc.partitionSkin, BasicMaterial:pc.BasicMaterial, DepthMaterial:pc.DepthMaterial, ForwardRenderer:pc.ForwardRenderer, GraphNode:pc.GraphNode, Material:pc.Material, Command:pc.Command, Mesh:pc.Mesh, MeshInstance:pc.MeshInstance, Model:pc.Model, ParticleEmitter:pc.ParticleEmitter, PhongMaterial:pc.PhongMaterial, Picker:pc.Picker, PickMaterial:pc.PickMaterial, Scene:pc.Scene, Skin:pc.Skin, SkinInstance:pc.SkinInstance});
pc.scene.procedural = {calculateTangents:pc.calculateTangents, createMesh:pc.createMesh, createTorus:pc.createTorus, createCylinder:pc.createCylinder, createCapsule:pc.createCapsule, createCone:pc.createCone, createSphere:pc.createSphere, createPlane:pc.createPlane, createBox:pc.createBox};
pc.scene.Projection = {ORTHOGRAPHIC:pc.PROJECTION_ORTHOGRAPHIC, PERSPECTIVE:pc.PROJECTION_PERSPECTIVE};
pc.time = {now:pc.now, Timer:pc.Timer};

/*
 PlayCanvas Engine v0.166.0
 revision e493448

 http://playcanvas.com
 Copyright 2011-2014 PlayCanvas Ltd. All rights reserved.
 Do not distribute.
 Contains: https://github.com/tildeio/rsvp.js - see page for license information
*/
var pc={config:{},common:{},apps:{},data:{},unpack:function(){console.warn("pc.unpack has been deprecated and will be removed shortly. Please update your code.")},makeArray:function(e){var a,b=[],c=e.length;for(a=0;a<c;++a)b.push(e[a]);return b},type:function(e){if(null===e)return"null";var a=typeof e;return"undefined"==a||"number"==a||"string"==a||"boolean"==a?a:_typeLookup[Object.prototype.toString.call(e)]},extend:function(e,a){var b,c;for(b in a)c=a[b],e[b]="object"==pc.type(c)?pc.extend({},c):
"array"==pc.type(c)?pc.extend([],c):c;return e},isDefined:function(e){return void 0!==e}},_typeLookup=function(){var e={},a,b="Array Object Function Date RegExp Float32Array".split(" ");for(a=0;a<b.length;++a)e["[object "+b[a]+"]"]=b[a].toLowerCase();return e}();"undefined"!==typeof exports&&(exports.pc=pc);(function(){if("undefined"!==typeof document){var e=function(){var a=document.createEvent("CustomEvent");a.initCustomEvent("fullscreenchange",!0,!1,null);document.dispatchEvent(a)},a=function(){var a=document.createEvent("CustomEvent");a.initCustomEvent("fullscreenerror",!0,!1,null);document.dispatchEvent(a)};document.addEventListener("webkitfullscreenchange",e,!1);document.addEventListener("mozfullscreenchange",e,!1);document.addEventListener("MSFullscreenChange",e,!1);document.addEventListener("webkitfullscreenerror",
a,!1);document.addEventListener("mozfullscreenerror",a,!1);document.addEventListener("MSFullscreenError",a,!1);Element.prototype.requestFullscreen=Element.prototype.mozRequestFullScreen?function(){this.mozRequestFullScreen()}:Element.prototype.requestFullscreen||Element.prototype.webkitRequestFullscreen||Element.prototype.msRequestFullscreen||function(){};document.exitFullscreen=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;document.fullscreenElement||
Object.defineProperty(document,"fullscreenElement",{enumerable:!0,configurable:!1,get:function(){return document.webkitCurrentFullScreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement}});document.fullscreenEnabled||Object.defineProperty(document,"fullscreenEnabled",{enumerable:!0,configurable:!1,get:function(){return document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}})}})();pc.extend(pc,function(){var e=function(){this.data=new Float32Array(4);3<=arguments.length?(this.data[0]=arguments[0],this.data[1]=arguments[1],this.data[2]=arguments[2],this.data[3]=4<=arguments.length?arguments[3]:1):(this.data[0]=0,this.data[1]=0,this.data[2]=0,this.data[3]=1)};e.prototype={clone:function(){return new pc.Color(this.r,this.g,this.b,this.a)},copy:function(a){var b=this.data,a=a.data;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return this},set:function(a,b,c,d){var g=this.data;g[0]=a;
g[1]=b;g[2]=c;g[3]=void 0===d?1:d;return this},fromString:function(a){var b=parseInt(a.replace("#","0x"));7<a.length?a=pc.math.intToBytes32(b):(a=pc.math.intToBytes24(b),a[3]=255);this.set(a[0]/255,a[1]/255,a[2]/255,a[3]/255);return this},toString:function(a){var b="#"+(16777216+(parseInt(255*this.r)<<16)+(parseInt(255*this.g)<<8)+parseInt(255*this.b)).toString(16).slice(1);!0===a&&(a=parseInt(255*this.a).toString(16),b=this.a<16/255?b+("0"+a):b+a);return b}};Object.defineProperty(e.prototype,"r",
{get:function(){return this.data[0]},set:function(a){this.data[0]=a}});Object.defineProperty(e.prototype,"g",{get:function(){return this.data[1]},set:function(a){this.data[1]=a}});Object.defineProperty(e.prototype,"b",{get:function(){return this.data[2]},set:function(a){this.data[2]=a}});Object.defineProperty(e.prototype,"a",{get:function(){return this.data[3]},set:function(a){this.data[3]=a}});return{Color:e}}());pc.guid=function(){return{create:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0;return("x"==e?a:a&3|8).toString(16)})}}}();pc.extend(pc,function(){var e=function(){this._isRunning=!1;this._b=this._a=0};e.prototype={start:function(){this._isRunning=!0;this._a=(new Date).getTime()},stop:function(){this._isRunning=!1;this._b=(new Date).getTime()},getMilliseconds:function(){return this._b-this._a}};return{Timer:e,now:function(){return(new Date).getTime()}}}());pc.extend(pc,function(){return{createURI:function(e){var a="";if((e.authority||e.scheme)&&(e.host||e.hostpath))throw Error("Can't have 'scheme' or 'authority' and 'host' or 'hostpath' option");if(e.host&&e.hostpath)throw Error("Can't have 'host' and 'hostpath' option");if(e.path&&e.hostpath)throw Error("Can't have 'path' and 'hostpath' option");e.scheme&&(a+=e.scheme+":");e.authority&&(a+="//"+e.authority);e.host&&(a+=e.host);e.path&&(a+=e.path);e.hostpath&&(a+=e.hostpath);e.query&&(a+="?"+e.query);
e.fragment&&(a+="#"+e.fragment);return a},URI:function(e){e=e.match(/^(([^:\/?\#]+):)?(\/\/([^\/?\#]*))?([^?\#]*)(\?([^\#]*))?(\#(.*))?/);this.scheme=e[2];this.authority=e[4];this.path=e[5];this.query=e[7];this.fragment=e[9];this.toString=function(){var a="";this.scheme&&(a+=this.scheme+":");this.authority&&(a+="//"+this.authority);a+=this.path;this.query&&(a+="?"+this.query);this.fragment&&(a+="#"+this.fragment);return a};this.getQuery=function(){var a,b,c={};this.query&&(a=decodeURIComponent(this.query).split("&"),
a.forEach(function(a){b=a.split("=");c[b[0]]=b[1]},this));return c};this.setQuery=function(a){q="";for(var b in a)a.hasOwnProperty(b)&&(""!==q&&(q+="&"),q+=encodeURIComponent(b)+"="+encodeURIComponent(a[b]));this.query=q}}}}());pc.extend(pc,function(){return{log:{write:function(e){console.log(e)},open:function(){pc.log.write(Date())},info:function(e){console.info("INFO:    "+e)},debug:function(e){console.debug("DEBUG:   "+e)},error:function(e){console.error("ERROR:   "+e)},warning:function(e){console.warn("WARNING: "+e)},alert:function(e){pc.log.write("ALERT:   "+e);alert(e)},assert:function(e,a){!1===e&&(pc.log.write("ASSERT:  "+a),alert("ASSERT failed: "+a))}}}}());
var logINFO=pc.log.info,logDEBUG=pc.log.debug,logWARNING=pc.log.warning,logERROR=pc.log.error,logALERT=pc.log.alert,logASSERT=pc.log.assert;Function.prototype.extendsFrom=function(e){var a,b,c=function(){};a=this;b=function(){e.apply(this,arguments);a.apply(this,arguments);this.constructor=a};b._super=e.prototype;c.prototype=e.prototype;b.prototype=new c;return b};pc.extend(pc,function(){return{inherits:function(e,a){var b=function(){},c=function(){a.apply(this,arguments);e.apply(this,arguments)};c._super=a.prototype;b.prototype=a.prototype;c.prototype=new b;return c}}}());Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be fBound is not callable");var a=Array.prototype.slice.call(arguments,1),b=this,c=function(){},d=function(){return b.apply(this instanceof c?this:e||window,a.concat(Array.prototype.slice.call(arguments)))};c.prototype=this.prototype;d.prototype=new c;return d});pc.path=function(){return{delimiter:"/",join:function(){var e,a=arguments.length,b=arguments[0];for(e=0;e<a-1;++e){var c=arguments[e],d=arguments[e+1];if(!pc.isDefined(c)||!pc.isDefined(d))throw Error("undefined argument to pc.path.join");b=d[0]===pc.path.delimiter?d:c&&d&&c[c.length-1]!==pc.path.delimiter&&d[0]!==pc.path.delimiter?b+(pc.path.delimiter+d):b+d}return b},split:function(e){var e=e.split(pc.path.delimiter),a=e.slice(e.length-1)[0];return[e.slice(0,e.length-1).join(pc.path.delimiter),
a]},getBasename:function(e){return pc.path.split(e)[1]},getDirectory:function(e){e=e.split(pc.path.delimiter);return e.slice(0,e.length-1).join(pc.path.delimiter)},getExtension:function(e){var a=e.split(".").pop();return a!==e?"."+a:""},isRelativePath:function(e){return"/"!==e.charAt(0)&&null===e.match(/:\/\//)},extractPath:function(e){var a=".",b=e.split("/"),c=0;if(1<b.length){!1===pc.path.isRelativePath(e)&&(a="");for(c=0;c<b.length-1;++c)a+="/"+b[c]}return a}}}();pc.string=function(){return{ASCII_LOWERCASE:"abcdefghijklmnopqrstuvwxyz",ASCII_UPPERCASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",ASCII_LETTERS:this.ASCII_LOWERCASE+this.ASCII_UPPERCASE,format:function(e){var a=0,b,c=pc.makeArray(arguments);c.shift();for(a=0;a<c.length;a++)b=RegExp("\\{"+a+"\\}","gi"),e=e.replace(b,c[a]);return e},startsWith:function(e,a){return 0===e.indexOf(a)},endsWith:function(e,a){return-1!==e.lastIndexOf(a,e.length-a.length)},toBool:function(e,a){if("true"===e)return!0;if(a){if("false"===
e)return!1;throw Error("Not a boolean string");}return!1}}}();pc.extend(pc,function(){return{json:{parse:function(e,a){return JSON.parse(e,a)},stringify:function(e,a,b){return JSON.stringify(e,function(b,d){this[b]instanceof Float32Array&&(d=pc.makeArray(this[b]));return a?a(b,d):d},b)}}}}());pc.cookie=function(){return{set:function(e,a,b){b=b||{};e=e+"="+a;b.path&&(e+=";path="+b.path);b.domain&&(e+=";domain="+b.domain);b.path&&(e+=";path="+b.path);b.secure&&(e+=";secure");e=b.lifetime?e+(";max-age="+86400*b.lifetime):e+";max-age=86400";document.cookie=e},get:function(e){var a,b=document.cookie.split(";"),c,d=b.length;for(c=0;c<d;c++)if(a=b[c].trim(),pc.string.startsWith(a,e))return a.split("=")[1]},remove:function(e,a){a.lifetime=0;pc.cookie.set(e,"",a)}}}();pc.debug=function(){var e=null,a=null,b=null,c=null;return{display:function(d){e||(e=document.createElement("table"),a=document.createElement("tr"),b=document.createElement("td"),c=document.createElement("td"),e.style.cssText="position:absolute;font-family:sans-serif;font-size:12px;color:#cccccc",e.style.top="0px",e.style.left="0px",e.style.border="thin solid #cccccc",document.body.appendChild(e));e.innerHTML="";for(var g in d){var f=a.cloneNode(),k=b.cloneNode(),m=c.cloneNode();k.textContent=g;m.textContent=
d[g];f.appendChild(k);f.appendChild(m);e.appendChild(f)}}}}();pc.extend(pc,function(){var e=function(a,c){this.objects=[];this.ctor=a;this.name=c.name;this.useNew=void 0===c.useNew||c.useNew;if(this.metrics=c.metrics)this.used=this.total=0};e.prototype={_construct:function(a,c){function d(){return a.apply(this,c)}d.prototype=a.prototype;return new d},allocate:function(){var a;this.objects.length?(a=this.objects.pop(),this.ctor.apply(a,arguments),this.metrics&&this.used++):(a=this.useNew?this._construct(this.ctor,arguments):this.ctor.apply(this,arguments),this.metrics&&
(this.total++,this.used++));return a},free:function(a){this.objects.push(a);this.metrics&&this.used--;if(a.onFree)a.onFree()},usage:function(){return pc.string.format("{0} - total: {1}, used: {2}",this.name,this.total,this.used)}};var a=function(a,c){this._constructor=a;this._pool=[];this._count=0;this._resize(c)};a.prototype={_resize:function(a){if(a>this._pool.length)for(var c=this._pool.length;c<a;c++)this._pool[c]=new this._constructor},allocate:function(){this._count>=this._pool.length&&this._resize(2*
this._pool.length);return this._pool[this._count++]},freeAll:function(){this._count=0}};return{AllocatePool:a,ObjectPool:e}}());pc.events=function(){var e={attach:function(a){var b=pc.events;a.on=b.on;a.off=b.off;a.fire=b.fire;a.hasEvent=b.hasEvent;a.bind=b.on;a.unbind=b.off;return a},on:function(a,b,c){if("string"!=pc.type(a))throw new TypeError("Event name must be a string");var d=this._callbacks||(this._callbacks={});(d[a]||(d[a]=[])).push({callback:b,scope:c||this});return this},off:function(a,b,c){var d=this._callbacks;if(d){if(b){a=d[a];if(!a)return this;for(d=0;d<a.length;d++)if(a[d].callback===b&&(!c||c===a[d].scope))a.splice(d,
1),d--}else d[a]=[];return this}},fire:function(a){var b,c,d,g;if(this._callbacks&&this._callbacks[a]&&(c=this._callbacks[a].length)){d=pc.makeArray(arguments);d.shift();g=this._callbacks[a].slice();for(b=0;b<c;++b)g[b].callback.apply(g[b].scope,d)}return this},hasEvent:function(a){return void 0!==this._callbacks&&void 0!==this._callbacks[a]&&0<this._callbacks[a].length}};e.bind=e.on;e.unbind=e.off;return e}();pc.dom=function(){return{getWidth:function(e){return e.offsetWidth},getHeight:function(e){return e.offsetHeight},setText:function(e,a){e.textContent?e.textContent=a:e.innerText&&(e.innerText=a)},getText:function(e){return e.textContent||e.innerText}}}();pc.math={DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,INV_LOG2:1/Math.log(2),clamp:function(e,a,b){return e>=b?b:e<=a?a:e},intToBytes24:function(e){return[e>>16&255,e>>8&255,e&255]},intToBytes32:function(e){return[e>>24&255,e>>16&255,e>>8&255,e&255]},bytesToInt24:function(e,a,b){e.length&&(b=e[2],a=e[1],e=e[0]);return e<<16|a<<8|b},bytesToInt32:function(e,a,b,c){e.length&&(c=e[3],b=e[2],a=e[1],e=e[0]);return(e<<24|a<<16|b<<8|c)>>>32},lerp:function(e,a,b){return e+(a-e)*pc.math.clamp(b,0,1)},lerpAngle:function(e,
a,b){180<a-e&&(a-=360);-180>a-e&&(a+=360);return pc.math.lerp(e,a,pc.math.clamp(b,0,1))},powerOfTwo:function(e){return 0!==e&&!(e&e-1)},nextPowerOfTwo:function(e){e--;e|=e>>1;e|=e>>2;e|=e>>4;e|=e>>8;e|=e>>16;e++;return e},random:function(e,a){return Math.random()*(a-e)+e},smoothstep:function(e,a,b){if(b<=e)return 0;if(b>=a)return 1;b=(b-e)/(a-e);return b*b*(3-2*b)},smootherstep:function(e,a,b){if(b<=e)return 0;if(b>=a)return 1;b=(b-e)/(a-e);return b*b*b*(b*(6*b-15)+10)}};pc.math.intToBytes=pc.math.intToBytes32;
pc.math.bytesToInt=pc.math.bytesToInt32;Math.log2||(Math.log2=function(e){return Math.log(e)*pc.math.INV_LOG2});pc.extend(pc,function(){var e=function(){this.data=new Float32Array(2);2===arguments.length?this.data.set(arguments):(this.data[0]=0,this.data[1]=0)};e.prototype={add:function(a){var b=this.data,a=a.data;b[0]+=a[0];b[1]+=a[1];return this},add2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]+d[0];g[1]=c[1]+d[1];return this},clone:function(){return(new e).copy(this)},copy:function(a){var b=this.data,a=a.data;b[0]=a[0];b[1]=a[1];return this},dot:function(a){var b=this.data,a=a.data;return b[0]*
a[0]+b[1]*a[1]},equals:function(a){var b=this.data,a=a.data;return b[0]===a[0]&&b[1]===a[1]},length:function(){var a=this.data;return Math.sqrt(a[0]*a[0]+a[1]*a[1])},lengthSq:function(){var a=this.data;return a[0]*a[0]+a[1]*a[1]},lerp:function(a,b,c){var a=a.data,b=b.data,d=this.data;d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);return this},mul:function(a){var b=this.data,a=a.data;b[0]*=a[0];b[1]*=a[1];return this},mul2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]*d[0];g[1]=c[1]*d[1];
return this},normalize:function(){return this.scale(1/this.length())},scale:function(a){var b=this.data;b[0]*=a;b[1]*=a;return this},set:function(a,b){var c=this.data;c[0]=a;c[1]=b;return this},sub:function(a){var b=this.data,a=a.data;b[0]-=a[0];b[1]-=a[1];return this},sub2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]-d[0];g[1]=c[1]-d[1];return this},toString:function(){return"["+this.data[0]+", "+this.data[1]+"]"}};Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},
set:function(a){this.data[0]=a}});Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.data[1]=a}});Object.defineProperty(e,"ONE",{get:function(){var a=new e(1,1);return function(){return a}}()});Object.defineProperty(e,"RIGHT",{get:function(){var a=new e(1,0);return function(){return a}}()});Object.defineProperty(e,"UP",{get:function(){var a=new e(0,1);return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,0);return function(){return a}}()});
return{Vec2:e}}());pc.extend(pc,function(){var e=function(){this.data=new Float32Array(3);3===arguments.length?this.data.set(arguments):(this.data[0]=0,this.data[1]=0,this.data[2]=0)};e.prototype={add:function(a){var b=this.data,a=a.data;b[0]+=a[0];b[1]+=a[1];b[2]+=a[2];return this},add2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]+d[0];g[1]=c[1]+d[1];g[2]=c[2]+d[2];return this},clone:function(){return(new e).copy(this)},copy:function(a){var b=this.data,a=a.data;b[0]=a[0];b[1]=a[1];b[2]=a[2];return this},
cross:function(a,b){var c,d,g,f,e,m,h;c=a.data;d=b.data;g=this.data;f=c[0];e=c[1];c=c[2];m=d[0];h=d[1];d=d[2];g[0]=e*d-h*c;g[1]=c*m-d*f;g[2]=f*h-m*e;return this},dot:function(a){var b=this.data,a=a.data;return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]},equals:function(a){var b=this.data,a=a.data;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]},length:function(){var a=this.data;return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2])},lengthSq:function(){var a=this.data;return a[0]*a[0]+a[1]*a[1]+a[2]*a[2]},lerp:function(a,
b,c){var a=a.data,b=b.data,d=this.data;d[0]=a[0]+c*(b[0]-a[0]);d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);return this},mul:function(a){var b=this.data,a=a.data;b[0]*=a[0];b[1]*=a[1];b[2]*=a[2];return this},mul2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]*d[0];g[1]=c[1]*d[1];g[2]=c[2]*d[2];return this},normalize:function(){return this.scale(1/this.length())},project:function(a){var b=this.data,a=a.data,c=(b[0]*a[0]+b[1]*a[1]+b[2]*a[2])/(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);b[0]=a[0]*c;
b[1]=a[1]*c;b[2]=a[2]*c;return this},scale:function(a){var b=this.data;b[0]*=a;b[1]*=a;b[2]*=a;return this},set:function(a,b,c){var d=this.data;d[0]=a;d[1]=b;d[2]=c;return this},sub:function(a){var b=this.data,a=a.data;b[0]-=a[0];b[1]-=a[1];b[2]-=a[2];return this},sub2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]-d[0];g[1]=c[1]-d[1];g[2]=c[2]-d[2];return this},toString:function(){return"["+this.data[0]+", "+this.data[1]+", "+this.data[2]+"]"}};Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},
set:function(a){this.data[0]=a}});Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},set:function(a){this.data[1]=a}});Object.defineProperty(e.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.data[2]=a}});Object.defineProperty(e,"BACK",{get:function(){var a=new e(0,0,1);return function(){return a}}()});Object.defineProperty(e,"DOWN",{get:function(){var a=new e(0,-1,0);return function(){return a}}()});Object.defineProperty(e,"FORWARD",{get:function(){var a=
new e(0,0,-1);return function(){return a}}()});Object.defineProperty(e,"LEFT",{get:function(){var a=new e(-1,0,0);return function(){return a}}()});Object.defineProperty(e,"ONE",{get:function(){var a=new e(1,1,1);return function(){return a}}()});Object.defineProperty(e,"RIGHT",{get:function(){var a=new e(1,0,0);return function(){return a}}()});Object.defineProperty(e,"UP",{get:function(){var a=new e(0,1,0);return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,
0,0);return function(){return a}}()});return{Vec3:e}}());pc.extend(pc,function(){var e=function(){this.data=new Float32Array(4);4===arguments.length?this.data.set(arguments):(this.data[0]=0,this.data[1]=0,this.data[2]=0,this.data[3]=0)};e.prototype={add:function(a){var b=this.data,a=a.data;b[0]+=a[0];b[1]+=a[1];b[2]+=a[2];b[3]+=a[3];return this},add2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]+d[0];g[1]=c[1]+d[1];g[2]=c[2]+d[2];g[3]=c[3]+d[3];return this},clone:function(){return(new e).copy(this)},copy:function(a){var b=this.data,a=a.data;
b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return this},dot:function(a){var b=this.data,a=a.data;return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]*a[3]},equals:function(a){var b=this.data,a=a.data;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]},length:function(){var a=this.data;return Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]+a[3]*a[3])},lengthSq:function(){var a=this.data;return a[0]*a[0]+a[1]*a[1]+a[2]*a[2]+a[3]*a[3]},lerp:function(a,b,c){var a=a.data,b=b.data,d=this.data;d[0]=a[0]+c*(b[0]-a[0]);
d[1]=a[1]+c*(b[1]-a[1]);d[2]=a[2]+c*(b[2]-a[2]);d[3]=a[3]+c*(b[3]-a[3]);return this},mul:function(a){var b=this.data,a=a.data;b[0]*=a[0];b[1]*=a[1];b[2]*=a[2];b[3]*=a[3];return this},mul2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]*d[0];g[1]=c[1]*d[1];g[2]=c[2]*d[2];g[3]=c[3]*d[3];return this},normalize:function(){return this.scale(1/this.length())},scale:function(a){var b=this.data;b[0]*=a;b[1]*=a;b[2]*=a;b[3]*=a;return this},set:function(a,b,c,d){var g=this.data;g[0]=a;g[1]=b;g[2]=
c;g[3]=d;return this},sub:function(a){var b=this.data,a=a.data;b[0]-=a[0];b[1]-=a[1];b[2]-=a[2];b[3]-=a[3];return this},sub2:function(a,b){var c=a.data,d=b.data,g=this.data;g[0]=c[0]-d[0];g[1]=c[1]-d[1];g[2]=c[2]-d[2];g[3]=c[3]-d[3];return this},toString:function(){return"["+this.data[0]+", "+this.data[1]+", "+this.data[2]+", "+this.data[3]+"]"}};Object.defineProperty(e.prototype,"x",{get:function(){return this.data[0]},set:function(a){this.data[0]=a}});Object.defineProperty(e.prototype,"y",{get:function(){return this.data[1]},
set:function(a){this.data[1]=a}});Object.defineProperty(e.prototype,"z",{get:function(){return this.data[2]},set:function(a){this.data[2]=a}});Object.defineProperty(e.prototype,"w",{get:function(){return this.data[3]},set:function(a){this.data[3]=a}});Object.defineProperty(e,"ONE",{get:function(){var a=new e(1,1,1,1);return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,0,0,0);return function(){return a}}()});return{Vec4:e}}());pc.extend(pc,function(){var e=function(){this.data=new Float32Array(9);9===arguments.length?this.data.set(arguments):this.setIdentity()};e.prototype={clone:function(){return(new pc.Mat3).copy(this)},copy:function(a){var a=a.data,b=this.data;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return this},equals:function(a){var b=this.data,a=a.data;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===
a[8]},isIdentity:function(){var a=this.data;return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&1===a[4]&&0===a[5]&&0===a[6]&&0===a[7]&&1===a[8]},setIdentity:function(){var a=this.data;a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return this},toString:function(){for(var a="[",b=0;9>b;b++)a+=this.data[b],a+=9!==b?", ":"";return a+"]"},transpose:function(){var a=this.data,b;b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this}};Object.defineProperty(e,"IDENTITY",
{get:function(){var a=new e;return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,0,0,0,0,0,0,0,0);return function(){return a}}()});return{Mat3:e}}());pc.extend(pc,function(){var e=function(){this.data=new Float32Array(16);16===arguments.length?this.data.set(arguments):this.setIdentity()},a,b,c;a=new pc.Vec3;b=new pc.Vec3;c=new pc.Vec3;var d,g,f;d=new pc.Vec3;g=new pc.Vec3;f=new pc.Vec3;var k=new pc.Vec3;e.prototype={add2:function(a,b){var c=a.data,d=b.data,f=this.data;f[0]=c[0]+d[0];f[1]=c[1]+d[1];f[2]=c[2]+d[2];f[3]=c[3]+d[3];f[4]=c[4]+d[4];f[5]=c[5]+d[5];f[6]=c[6]+d[6];f[7]=c[7]+d[7];f[8]=c[8]+d[8];f[9]=c[9]+d[9];f[10]=c[10]+d[10];f[11]=c[11]+
d[11];f[12]=c[12]+d[12];f[13]=c[13]+d[13];f[14]=c[14]+d[14];f[15]=c[15]+d[15];return this},add:function(a){return this.add2(this,a)},clone:function(){return(new pc.Mat4).copy(this)},copy:function(a){var a=a.data,b=this.data;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return this},equals:function(a){var b=this.data,a=a.data;return b[0]===a[0]&&b[1]===a[1]&&b[2]===a[2]&&b[3]===
a[3]&&b[4]===a[4]&&b[5]===a[5]&&b[6]===a[6]&&b[7]===a[7]&&b[8]===a[8]&&b[9]===a[9]&&b[10]===a[10]&&b[11]===a[11]&&b[12]===a[12]&&b[13]===a[13]&&b[14]===a[14]&&b[15]===a[15]},isIdentity:function(){var a=this.data;return 1===a[0]&&0===a[1]&&0===a[2]&&0===a[3]&&0===a[4]&&1===a[5]&&0===a[6]&&0===a[7]&&0===a[8]&&0===a[9]&&1===a[10]&&0===a[11]&&0===a[12]&&0===a[13]&&0===a[14]&&1===a[15]},mul2:function(a,b){var c,d,f,g,e,k,x,u,w,B,y,A,F,J,N,G,I,K,E,z;G=a.data;var D=b.data,H=this.data;c=G[0];d=G[1];f=G[2];
g=G[3];e=G[4];k=G[5];x=G[6];u=G[7];w=G[8];B=G[9];y=G[10];A=G[11];F=G[12];J=G[13];N=G[14];G=G[15];I=D[0];K=D[1];E=D[2];z=D[3];H[0]=c*I+e*K+w*E+F*z;H[1]=d*I+k*K+B*E+J*z;H[2]=f*I+x*K+y*E+N*z;H[3]=g*I+u*K+A*E+G*z;I=D[4];K=D[5];E=D[6];z=D[7];H[4]=c*I+e*K+w*E+F*z;H[5]=d*I+k*K+B*E+J*z;H[6]=f*I+x*K+y*E+N*z;H[7]=g*I+u*K+A*E+G*z;I=D[8];K=D[9];E=D[10];z=D[11];H[8]=c*I+e*K+w*E+F*z;H[9]=d*I+k*K+B*E+J*z;H[10]=f*I+x*K+y*E+N*z;H[11]=g*I+u*K+A*E+G*z;I=D[12];K=D[13];E=D[14];z=D[15];H[12]=c*I+e*K+w*E+F*z;H[13]=d*I+
k*K+B*E+J*z;H[14]=f*I+x*K+y*E+N*z;H[15]=g*I+u*K+A*E+G*z;return this},mul:function(a){return this.mul2(this,a)},transformPoint:function(a,b){var c=this.data,d=a.data,b=void 0===b?new pc.Vec3:b;return b.set(d[0]*c[0]+d[1]*c[4]+d[2]*c[8]+c[12],d[0]*c[1]+d[1]*c[5]+d[2]*c[9]+c[13],d[0]*c[2]+d[1]*c[6]+d[2]*c[10]+c[14])},transformVector:function(a,b){var c=this.data,d=a.data,b=void 0===b?new pc.Vec3:b;return b.set(d[0]*c[0]+d[1]*c[4]+d[2]*c[8],d[0]*c[1]+d[1]*c[5]+d[2]*c[9],d[0]*c[2]+d[1]*c[6]+d[2]*c[10])},
setLookAt:function(d,f,g){c.sub2(d,f).normalize();b.copy(g).normalize();a.cross(b,c).normalize();b.cross(c,a);f=this.data;f[0]=a.x;f[1]=a.y;f[2]=a.z;f[3]=0;f[4]=b.x;f[5]=b.y;f[6]=b.z;f[7]=0;f[8]=c.x;f[9]=c.y;f[10]=c.z;f[11]=0;f[12]=d.x;f[13]=d.y;f[14]=d.z;f[15]=1;return this},setFrustum:function(a,b,c,d,f,g){var e,k,x,u,w;e=2*f;k=b-a;x=d-c;u=g-f;w=this.data;w[0]=e/k;w[1]=0;w[2]=0;w[3]=0;w[4]=0;w[5]=e/x;w[6]=0;w[7]=0;w[8]=(b+a)/k;w[9]=(d+c)/x;w[10]=(-g-f)/u;w[11]=-1;w[12]=0;w[13]=0;w[14]=-e*g/u;w[15]=
0;return this},setPerspective:function(a,b,c,d){a=c*Math.tan(a*Math.PI/360);b*=a;return this.setFrustum(-b,b,-a,a,c,d)},setOrtho:function(a,b,c,d,f,g){var e=this.data;e[0]=2/(b-a);e[1]=0;e[2]=0;e[3]=0;e[4]=0;e[5]=2/(d-c);e[6]=0;e[7]=0;e[8]=0;e[9]=0;e[10]=-2/(g-f);e[11]=0;e[12]=-(b+a)/(b-a);e[13]=-(d+c)/(d-c);e[14]=-(g+f)/(g-f);e[15]=1;return this},setFromAxisAngle:function(a,b){var c,d,f,g,e,k,x,u,w,b=b*pc.math.DEG_TO_RAD;c=a.x;d=a.y;f=a.z;g=Math.cos(b);e=Math.sin(b);k=1-g;x=k*c;u=k*d;w=this.data;
w[0]=x*c+g;w[1]=x*d+e*f;w[2]=x*f-e*d;w[3]=0;w[4]=x*d-e*f;w[5]=u*d+g;w[6]=u*f+e*c;w[7]=0;w[8]=x*f+e*d;w[9]=u*f-c*e;w[10]=k*f*f+g;w[11]=0;w[12]=0;w[13]=0;w[14]=0;w[15]=1;return this},setTranslate:function(a,b,c){var d=this.data;d[0]=1;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=1;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=1;d[11]=0;d[12]=a;d[13]=b;d[14]=c;d[15]=1;return this},setScale:function(a,b,c){var d=this.data;d[0]=a;d[1]=0;d[2]=0;d[3]=0;d[4]=0;d[5]=b;d[6]=0;d[7]=0;d[8]=0;d[9]=0;d[10]=c;d[11]=0;d[12]=0;d[13]=0;d[14]=
0;d[15]=1;return this},invert:function(){var a,b,c,d,f,g,e,k,x,u,w,B,y,A,F,J,N,G,I,K,E,z,D,H,P,L,S,M,R,O;O=this.data;a=O[0];b=O[1];c=O[2];d=O[3];f=O[4];g=O[5];e=O[6];k=O[7];x=O[8];u=O[9];w=O[10];B=O[11];y=O[12];A=O[13];F=O[14];J=O[15];N=a*g-b*f;G=a*e-c*f;I=a*k-d*f;K=b*e-c*g;E=b*k-d*g;z=c*k-d*e;D=x*A-u*y;H=x*F-w*y;P=x*J-B*y;L=u*F-w*A;S=u*J-B*A;M=w*J-B*F;R=1/(N*M-G*S+I*L+K*P-E*H+z*D);O[0]=(g*M-e*S+k*L)*R;O[1]=(-b*M+c*S-d*L)*R;O[2]=(A*z-F*E+J*K)*R;O[3]=(-u*z+w*E-B*K)*R;O[4]=(-f*M+e*P-k*H)*R;O[5]=(a*
M-c*P+d*H)*R;O[6]=(-y*z+F*I-J*G)*R;O[7]=(x*z-w*I+B*G)*R;O[8]=(f*S-g*P+k*D)*R;O[9]=(-a*S+b*P-d*D)*R;O[10]=(y*E-A*I+J*N)*R;O[11]=(-x*E+u*I-B*N)*R;O[12]=(-f*L+g*H-e*D)*R;O[13]=(a*L-b*H+c*D)*R;O[14]=(-y*K+A*G-F*N)*R;O[15]=(x*K-u*G+w*N)*R;return this},setIdentity:function(){var a=this.data;a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return this},setTRS:function(a,b,c){var d,f,g,e,k,x,u,w,B,y,A,F,J;d=a.x;f=a.y;a=a.z;g=b.x;e=b.y;k=
b.z;x=b.w;b=c.x;u=c.y;c=c.z;w=g+g;B=e+e;y=k+k;A=g*w;F=g*B;g*=y;J=e*B;e*=y;k*=y;w*=x;B*=x;x*=y;y=this.data;y[0]=(1-(J+k))*b;y[1]=(F+x)*b;y[2]=(g-B)*b;y[3]=0;y[4]=(F-x)*u;y[5]=(1-(A+k))*u;y[6]=(e+w)*u;y[7]=0;y[8]=(g+B)*c;y[9]=(e-w)*c;y[10]=(1-(A+J))*c;y[11]=0;y[12]=d;y[13]=f;y[14]=a;y[15]=1;return this},transpose:function(){var a,b=this.data;a=b[1];b[1]=b[4];b[4]=a;a=b[2];b[2]=b[8];b[8]=a;a=b[3];b[3]=b[12];b[12]=a;a=b[6];b[6]=b[9];b[9]=a;a=b[7];b[7]=b[13];b[13]=a;a=b[11];b[11]=b[14];b[14]=a;return this},
invertTo3x3:function(a){var b,c,d,f,g,e,k,x,u,w;u=this.data;w=a.data;a=u[10]*u[5]-u[6]*u[9];b=-u[10]*u[1]+u[2]*u[9];c=u[6]*u[1]-u[2]*u[5];d=-u[10]*u[4]+u[6]*u[8];f=u[10]*u[0]-u[2]*u[8];g=-u[6]*u[0]+u[2]*u[4];e=u[9]*u[4]-u[5]*u[8];k=-u[9]*u[0]+u[1]*u[8];x=u[5]*u[0]-u[1]*u[4];u=u[0]*a+u[1]*d+u[2]*e;if(0===u)return console.warn("pc.Mat4#invertTo3x3: Matrix not invertible"),this;u=1/u;w[0]=u*a;w[1]=u*b;w[2]=u*c;w[3]=u*d;w[4]=u*f;w[5]=u*g;w[6]=u*e;w[7]=u*k;w[8]=u*x;return this},getTranslation:function(a){a=
void 0===a?new pc.Vec3:a;return a.set(this.data[12],this.data[13],this.data[14])},getX:function(a){a=void 0===a?new pc.Vec3:a;return a.set(this.data[0],this.data[1],this.data[2])},getY:function(a){a=void 0===a?new pc.Vec3:a;return a.set(this.data[4],this.data[5],this.data[6])},getZ:function(a){a=void 0===a?new pc.Vec3:a;return a.set(this.data[8],this.data[9],this.data[10])},getScale:function(a){a=void 0===a?new pc.Vec3:a;this.getX(d);this.getY(g);this.getZ(f);a.set(d.length(),g.length(),f.length());
return a},setFromEulerAngles:function(a,b,c){var d,f,g,e,a=a*pc.math.DEG_TO_RAD,b=b*pc.math.DEG_TO_RAD,c=c*pc.math.DEG_TO_RAD;d=Math.sin(-a);a=Math.cos(-a);f=Math.sin(-b);b=Math.cos(-b);g=Math.sin(-c);c=Math.cos(-c);e=this.data;e[0]=b*c;e[1]=-b*g;e[2]=f;e[3]=0;e[4]=a*g+c*d*f;e[5]=a*c-d*f*g;e[6]=-b*d;e[7]=0;e[8]=d*g-a*c*f;e[9]=c*d+a*f*g;e[10]=a*b;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return this},getEulerAngles:function(a){var b,c,d,f,g,e,a=void 0===a?new pc.Vec3:a;this.getScale(k);d=k.x;b=k.y;f=
k.z;g=this.data;c=Math.asin(-g[2]/d);e=0.5*Math.PI;c<e?c>-e?(b=Math.atan2(g[6]/b,g[10]/f),d=Math.atan2(g[1]/d,g[0]/d)):(d=0,b=-Math.atan2(g[4]/b,g[5]/b)):(d=0,b=Math.atan2(g[4]/b,g[5]/b));return a.set(b,c,d).scale(pc.math.RAD_TO_DEG)},toString:function(){var a,b;b="[";for(a=0;16>a;a+=1)b+=this.data[a],b+=15!==a?", ":"";return b+"]"}};Object.defineProperty(e,"IDENTITY",{get:function(){var a=new e;return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0);return function(){return a}}()});return{Mat4:e}}());pc.extend(pc,function(){var e=function(a,b,c,d){this.x=void 0===a?0:a;this.y=void 0===b?0:b;this.z=void 0===c?0:c;this.w=void 0===d?1:d};e.prototype={clone:function(){return new pc.Quat(this.x,this.y,this.z,this.w)},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},equals:function(a){return this.x===a.x&&this.y===a.y&&this.z===a.z&&this.w===a.w},getEulerAngles:function(a){var b,c,d,g,f,e,a=void 0===a?new pc.Vec3:
a;d=this.x;g=this.y;f=this.z;e=this.w;c=2*(e*g-d*f);-0.99999>=c?(b=2*Math.atan2(d,e),c=-Math.PI/2,d=0):0.99999<=c?(b=2*Math.atan2(d,e),c=Math.PI/2,d=0):(b=Math.atan2(2*(e*d+g*f),1-2*(d*d+g*g)),c=Math.asin(c),d=Math.atan2(2*(e*f+d*g),1-2*(g*g+f*f)));return a.set(b,c,d).scale(pc.math.RAD_TO_DEG)},invert:function(){return this.conjugate().normalize()},length:function(){var a,b,c,d;a=this.x;b=this.y;c=this.z;d=this.w;return Math.sqrt(a*a+b*b+c*c+d*d)},lengthSq:function(){var a=this.data;return a[0]*a[0]+
a[1]*a[1]+a[2]*a[2]},mul:function(a){var b,c,d,g,f,e,m;b=this.x;c=this.y;d=this.z;g=this.w;f=a.x;e=a.y;m=a.z;a=a.w;this.x=g*f+b*a+c*m-d*e;this.y=g*e+c*a+d*f-b*m;this.z=g*m+d*a+b*e-c*f;this.w=g*a-b*f-c*e-d*m;return this},mul2:function(a,b){var c,d,g,f,e,m,h,n;c=a.x;d=a.y;g=a.z;f=a.w;e=b.x;m=b.y;h=b.z;n=b.w;this.x=f*e+c*n+d*h-g*m;this.y=f*m+d*n+g*e-c*h;this.z=f*h+g*n+c*m-d*e;this.w=f*n-c*e-d*m-g*h;return this},normalize:function(){var a=this.length();0===a?(this.x=this.y=this.z=0,this.w=1):(a=1/a,this.x*=
a,this.y*=a,this.z*=a,this.w*=a);return this},set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setFromAxisAngle:function(a,b){var c,d,b=b*0.5*pc.math.DEG_TO_RAD;c=Math.sin(b);d=Math.cos(b);this.x=c*a.x;this.y=c*a.y;this.z=c*a.z;this.w=d;return this},setFromEulerAngles:function(a,b,c){var d,g,f;d=0.5*pc.math.DEG_TO_RAD;a*=d;b*=d;c*=d;d=Math.sin(a);a=Math.cos(a);g=Math.sin(b);b=Math.cos(b);f=Math.sin(c);c=Math.cos(c);this.x=d*b*c-a*g*f;this.y=a*g*c+d*b*f;this.z=a*b*f-d*g*c;this.w=
a*b*c+d*g*f;return this},setFromMat4:function(a){var b,c,d,g,f,e,m,h,n,l,r,a=a.data;b=a[0];c=a[1];d=a[2];g=a[4];f=a[5];e=a[6];m=a[8];h=a[9];a=a[10];n=1/Math.sqrt(b*b+c*c+d*d);l=1/Math.sqrt(g*g+f*f+e*e);r=1/Math.sqrt(m*m+h*h+a*a);b*=n;c*=n;d*=n;g*=l;f*=l;e*=l;m*=r;h*=r;a*=r;n=b+f+a;0<=n?(b=Math.sqrt(n+1),this.w=0.5*b,b=0.5/b,this.x=(e-h)*b,this.y=(m-d)*b,this.z=(c-g)*b):b>f?b>a?(b=Math.sqrt(b-(f+a)+1),this.x=0.5*b,b=0.5/b,this.w=(e-h)*b,this.y=(c+g)*b,this.z=(d+m)*b):(b=Math.sqrt(a-(b+f)+1),this.z=
0.5*b,b=0.5/b,this.w=(c-g)*b,this.x=(m+d)*b,this.y=(h+e)*b):f>a?(b=Math.sqrt(f-(a+b)+1),this.y=0.5*b,b=0.5/b,this.w=(m-d)*b,this.z=(e+h)*b,this.x=(g+c)*b):(b=Math.sqrt(a-(b+f)+1),this.z=0.5*b,b=0.5/b,this.w=(c-g)*b,this.x=(m+d)*b,this.y=(h+e)*b);return this},slerp:function(a,b,c){var d,g,f,e,m,h;d=a.x;g=a.y;f=a.z;a=a.w;e=b.x;m=b.y;h=b.z;var b=b.w,n=a*b+d*e+g*m+f*h;0>n&&(b=-b,e=-e,m=-m,h=-h,n=-n);if(1<=Math.abs(n))return this.w=a,this.x=d,this.y=g,this.z=f,this;var l=Math.acos(n),r=Math.sqrt(1-n*n);
if(0.001>Math.abs(r))return this.w=0.5*a+0.5*b,this.x=0.5*d+0.5*e,this.y=0.5*g+0.5*m,this.z=0.5*f+0.5*h,this;n=Math.sin((1-c)*l)/r;c=Math.sin(c*l)/r;this.w=a*n+b*c;this.x=d*n+e*c;this.y=g*n+m*c;this.z=f*n+h*c;return this},transformVector:function(a,b){void 0===b&&(b=new pc.Vec3);var c=a.x,d=a.y,g=a.z,f=this.x,e=this.y,m=this.z,h=this.w,n=h*c+e*g-m*d,l=h*d+m*c-f*g,r=h*g+f*d-e*c,c=-f*c-e*d-m*g;b.x=n*h+c*-f+l*-m-r*-e;b.y=l*h+c*-e+r*-f-n*-m;b.z=r*h+c*-m+n*-e-l*-f;return b},toString:function(){return"["+
this.x+", "+this.y+", "+this.z+", "+this.w+"]"}};Object.defineProperty(e,"IDENTITY",{get:function(){var a=new e;return function(){return a}}()});Object.defineProperty(e,"ZERO",{get:function(){var a=new e(0,0,0,0);return function(){return a}}()});return{Quat:e}}());pc.extend(pc,function(){var e=function(a){this.keys=[];this.type=1;this.tension=0.5;if(a)for(var b=0;b<a.length-1;b+=2)this.keys.push([a[b],a[b+1]]);this.sort()};e.prototype={add:function(a,b){for(var c=this.keys,d=c.length,g=0;g<d&&!(c[g][0]>a);g++);c=[a,b];this.keys.splice(g,0,c);return c},get:function(a){return this.keys[a]},sort:function(){this.keys.sort(function(a,b){return a[0]-b[0]})},value:function(a){var b=this.keys;if(!b.length)return 0;if(a<b[0][0])return b[0][1];if(a>b[b.length-1][0])return b[b.length-
1][1];for(var c=0,d=b.length?b[0][1]:0,g=1,f=0,e=0,m=b.length;e<m;e++){if(b[e][0]===a)return b[e][1];f=b[e][1];if(a<b[e][0]){g=b[e][0];break}c=b[e][0];d=b[e][1]}m=g-c;a=0===m?0:(a-c)/m;if(1===this.type)a*=a*(3-2*a);else if(2===this.type||3===this.type){var m=d+(d-f),h=f+(f-d),n=g=c=g-c;0<e&&(e-=1);0<e&&(m=b[e-1][1],g=b[e][0]-b[e-1][0]);b.length>e+1&&(c=b[e+1][0]-b[e][0]);b.length>e+2&&(n=b[e+2][0]-b[e+1][0],h=b[e+2][1]);m=d+(m-d)*c/g;h=f+(h-f)*c/n;return 2===this.type?this._interpolateCatmullRom(m,
d,f,h,a):this._interpolateCardinal(m,d,f,h,a,this.tension)}return pc.math.lerp(d,f,a)},_interpolateHermite:function(a,b,c,d,g){var f=g*g,e=g*g*g;return a*(2*e-3*f+1)+b*(-2*e+3*f)+c*(e-2*f+g)+d*(e-f)},_interpolateCardinal:function(a,b,c,d,g,f){return this._interpolateHermite(b,c,f*(c-a),f*(d-b),g)},_interpolateCatmullRom:function(a,b,c,d,g){return this._interpolateCardinal(a,b,c,d,g,0.5)},closest:function(a){for(var b=this.keys,c=b.length,d=2,g=null,f=0;f<c;f++){var e=Math.abs(a-b[f][0]);if(d>=e)d=
e,g=b[f];else break}return g},clone:function(){var a=new pc.Curve;a.keys=pc.extend(a.keys,this.keys);a.type=this.type;return a},quantize:function(a){for(var a=Math.max(a,2),b=new Float32Array(a),c=1/(a-1),d=0;d<a;d++){var g=this.value(c*d);b[d]=g}return b}};Object.defineProperty(e.prototype,"length",{get:function(){return this.keys.length}});return{Curve:e,CURVE_LINEAR:0,CURVE_SMOOTHSTEP:1,CURVE_CATMULL:2,CURVE_CARDINAL:3}}());pc.extend(pc,function(){var e=function(){var a;this.curves=[];this._type=pc.CURVE_SMOOTHSTEP;if(1<arguments.length)for(a=0;a<arguments.length;a++)this.curves.push(new pc.Curve(arguments[a]));else if(0===arguments.length)this.curves.push(new pc.Curve);else{var b=arguments[0];if("number"===pc.type(b))for(a=0;a<b;a++)this.curves.push(new pc.Curve);else for(a=0;a<b.length;a++)this.curves.push(new pc.Curve(b[a]))}};e.prototype={get:function(a){return this.curves[a]},value:function(a,b){var c=this.curves.length,
b=b||[];b.length=c;for(var d=0;d<c;d++)b[d]=this.curves[d].value(a);return b},clone:function(){var a=new pc.CurveSet;a.curves=[];for(var b=0;b<this.curves.length;b++)a.curves.push(this.curves[b].clone());a._type=this._type;return a},quantize:function(a){for(var a=Math.max(a,2),b=this.curves.length,c=new Float32Array(a*b),d=1/(a-1),g=[],f=0;f<a;f++){var e=this.value(d*f,g);if(1==b)c[f]=e[0];else for(var m=0;m<b;m++)c[f*b+m]=e[m]}return c}};Object.defineProperty(e.prototype,"length",{get:function(){return this.curves.length}});
Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(a){this._type=a;for(var b=0;b<this.curves.length;b++)this.curves[b].type=a}});return{CurveSet:e}}());pc.shape=function(){var e=function(){};e.prototype={containsPoint:function(){throw Error("Shape hasn't implemented containsPoint");}};return{Shape:e,Type:{CAPSULE:"Capsule",CONE:"Cone",CYLINDER:"Cylinder",CIRCLE:"Circle",RECT:"Rect"}}}();pc.shape.intersection=function(){return{aabbAabb:function(e,a){var b=e.getMax(),c=e.getMin(),d=a.getMax(),g=a.getMin();return c[0]<=d[0]&&b[0]>=g[0]&&c[1]<=d[1]&&b[1]>=g[1]&&c[2]<=d[2]&&b[2]>=g[2]},rayAabb:function(e,a,b){var c=new pc.Vec3,d,g=new pc.Vec3;d=new pc.Vec3;c.sub2(e,b.center);e=new pc.Vec3(Math.abs(c.x),Math.abs(c.y),Math.abs(c.z));d.mul2(c,a);if(e.x>b.halfExtents.x&&0<=d.x||e.y>b.halfExtents.y&&0<=d.y||e.z>b.halfExtents.z&&0<=d.z)return!1;d=new pc.Vec3(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z));
g.cross(a,c);g.set(Math.abs(g.x),Math.abs(g.y),Math.abs(g.z));return g.x>b.halfExtents.y*d.z+b.halfExtents.z*d.y||g.y>b.halfExtents.x*d.z+b.halfExtents.z*d.x||g.z>b.halfExtents.x*d.y+b.halfExtents.y*d.x?!1:!0},raySphere:function(e,a,b,c){var d=new pc.Vec3,g=0,f=0,k=0,k=0,c=c||{};d.sub2(e,b.center);if(d.dot(d)<b.radius*b.radius)return c.success=!0,c.t=0,!0;g=a.dot(a);f=2*a.dot(d);k=b.center.dot(b.center);k+=e.dot(e);k-=2*b.center.dot(e);k-=b.radius*b.radius;k=f*f-4*g*k;if(0>k)return c.success=!1,c.t=
0,!1;c.success=!0;c.t=(-f-Math.sqrt(k))/(2*g);return!0},rayTriangle:function(e,a,b,c){var d=e.clone().sub(b.v0),d=-b.n.dot(d),g=b.n.dot(a);if(1E-8>Math.fabs(g))return 0===d?2:0;d/=g;if(0>d)return 0;a=a.clone().scale(d);c.add2(e,a);c=(new pc.Vec3).sub2(c,b.v0);e=c.dot(b.u);c=c.dot(b.v);a=(b.uv*c-b.vv*e)/b.d;if(0>a||1<a)return 0;b=(b.uv*e-b.uu*c)/b.d;return 0>b||1<a+b?0:1}}}();pc.extend(pc.shape,function(){pc.shape.Type.AABB="Aabb";var e=function(a,b){this.center=a||new pc.Vec3(0,0,0);this.halfExtents=b||new pc.Vec3(0.5,0.5,0.5);this.type=pc.shape.Type.AABB},e=pc.inherits(e,pc.shape.Shape);e.prototype.add=function(a){var b=this.center,c=this.halfExtents,d=b.x-c.x,g=b.x+c.x,f=b.y-c.y,e=b.y+c.y,m=b.z-c.z,h=b.z+c.z,n=a.center,l=a.halfExtents,a=n.x-l.x,r=n.x+l.x,v=n.y-l.y,s=n.y+l.y,C=n.z-l.z,n=n.z+l.z;a<d&&(d=a);r>g&&(g=r);v<f&&(f=v);s>e&&(e=s);C<m&&(m=C);n>h&&(h=n);b.set(d+
g,f+e,m+h).scale(0.5);c.set(g-d,e-f,h-m).scale(0.5)};e.prototype.copy=function(a){this.center.copy(a.center);this.halfExtents.copy(a.halfExtents);this.type=a.type};e.prototype.setMinMax=function(a,b){this.center.add2(b,a).scale(0.5);this.halfExtents.sub2(b,a).scale(0.5)};e.prototype.getMin=function(){return this.center.clone().sub(this.halfExtents)};e.prototype.getMax=function(){return this.center.clone().add(this.halfExtents)};e.prototype.containsPoint=function(a){var b=this.getMin(),c=this.getMax(),
d;for(d=0;3>d;++d)if(a.data[d]<b.data[d]||a.data[d]>c.data[d])return!1;return!0};e.prototype.setFromTransformedAabb=function(a,b){var c=this.center,d=this.halfExtents,g=a.center.data,f=a.halfExtents.data,b=b.data,e=b[0],m=b[4],h=b[8],n=b[1],l=b[5],r=b[9],v=b[2],s=b[6],C=b[10],x=Math.abs(e),u=Math.abs(m),w=Math.abs(h),B=Math.abs(n),y=Math.abs(l),A=Math.abs(r),F=Math.abs(v),J=Math.abs(s),N=Math.abs(C);c.set(b[12]+e*g[0]+m*g[1]+h*g[2],b[13]+n*g[0]+l*g[1]+r*g[2],b[14]+v*g[0]+s*g[1]+C*g[2]);d.set(x*f[0]+
u*f[1]+w*f[2],B*f[0]+y*f[1]+A*f[2],F*f[0]+J*f[1]+N*f[2])};e.prototype.compute=function(a){for(var b=new pc.Vec3(a[0],a[1],a[2]),c=new pc.Vec3(a[0],a[1],a[2]),d=a.length/3,g=1;g<d;g++){var f=a[3*g+0],e=a[3*g+1],m=a[3*g+2];f<b.x&&(b.x=f);e<b.y&&(b.y=e);m<b.z&&(b.z=m);f>c.x&&(c.x=f);e>c.y&&(c.y=e);m>c.z&&(c.z=m)}this.setMinMax(b,c)};return{Aabb:e}}());pc.extend(pc.shape,function(){function e(a,b){this.transform=void 0===a?new pc.Mat4:a;this.halfExtents=void 0===b?new pc.Vec3(0.5,0.5,0.5):b;this.type=pc.shape.Type.BOX}pc.shape.Type.BOX="Box";var a=new pc.Vec3,b=new pc.Vec3,c=new pc.Mat4,d=new pc.Mat4,e=pc.inherits(e,pc.shape.Shape);e.prototype.containsPoint=function(g){this.transform.getTranslation(a);var f=this.getHalfExtents();c.copy(this.transform);b.copy(f).scale(2);d.setTRS(pc.Vec3.ZERO,pc.Quat.IDENTITY,b);c.mul(d).invert();c.transformPoint(g,
b);return-0.5>b.x||0.5<b.x||-0.5>b.y||0.5<b.y||-0.5>b.z||0.5<b.z?!1:!0};e.prototype.getHalfExtents=function(){return this.halfExtents};return{Box:e}}());pc.extend(pc,function(){var e=new pc.Mat4,a=function(a,c){a=a||(new pc.Mat4).setPerspective(90,16/9,0.1,1E3);c=c||new pc.Mat4;this.planes=[];for(var d=0;6>d;d++)this.planes[d]=[];this.update(a,c)};a.prototype={update:function(a,c){e.mul2(a,c);var d=e.data;this.planes[0][0]=d[3]-d[0];this.planes[0][1]=d[7]-d[4];this.planes[0][2]=d[11]-d[8];this.planes[0][3]=d[15]-d[12];t=Math.sqrt(this.planes[0][0]*this.planes[0][0]+this.planes[0][1]*this.planes[0][1]+this.planes[0][2]*this.planes[0][2]);this.planes[0][0]/=
t;this.planes[0][1]/=t;this.planes[0][2]/=t;this.planes[0][3]/=t;this.planes[1][0]=d[3]+d[0];this.planes[1][1]=d[7]+d[4];this.planes[1][2]=d[11]+d[8];this.planes[1][3]=d[15]+d[12];t=Math.sqrt(this.planes[1][0]*this.planes[1][0]+this.planes[1][1]*this.planes[1][1]+this.planes[1][2]*this.planes[1][2]);this.planes[1][0]/=t;this.planes[1][1]/=t;this.planes[1][2]/=t;this.planes[1][3]/=t;this.planes[2][0]=d[3]+d[1];this.planes[2][1]=d[7]+d[5];this.planes[2][2]=d[11]+d[9];this.planes[2][3]=d[15]+d[13];t=
Math.sqrt(this.planes[2][0]*this.planes[2][0]+this.planes[2][1]*this.planes[2][1]+this.planes[2][2]*this.planes[2][2]);this.planes[2][0]/=t;this.planes[2][1]/=t;this.planes[2][2]/=t;this.planes[2][3]/=t;this.planes[3][0]=d[3]-d[1];this.planes[3][1]=d[7]-d[5];this.planes[3][2]=d[11]-d[9];this.planes[3][3]=d[15]-d[13];t=Math.sqrt(this.planes[3][0]*this.planes[3][0]+this.planes[3][1]*this.planes[3][1]+this.planes[3][2]*this.planes[3][2]);this.planes[3][0]/=t;this.planes[3][1]/=t;this.planes[3][2]/=t;
this.planes[3][3]/=t;this.planes[4][0]=d[3]-d[2];this.planes[4][1]=d[7]-d[6];this.planes[4][2]=d[11]-d[10];this.planes[4][3]=d[15]-d[14];t=Math.sqrt(this.planes[4][0]*this.planes[4][0]+this.planes[4][1]*this.planes[4][1]+this.planes[4][2]*this.planes[4][2]);this.planes[4][0]/=t;this.planes[4][1]/=t;this.planes[4][2]/=t;this.planes[4][3]/=t;this.planes[5][0]=d[3]+d[2];this.planes[5][1]=d[7]+d[6];this.planes[5][2]=d[11]+d[10];this.planes[5][3]=d[15]+d[14];t=Math.sqrt(this.planes[5][0]*this.planes[5][0]+
this.planes[5][1]*this.planes[5][1]+this.planes[5][2]*this.planes[5][2]);this.planes[5][0]/=t;this.planes[5][1]/=t;this.planes[5][2]/=t;this.planes[5][3]/=t},containsPoint:function(a){for(var c=0;6>c;c++)if(0>=this.planes[c][0]*a.x+this.planes[c][1]*a.y+this.planes[c][2]*a.z+this.planes[c][3])return!1;return!0},containsSphere:function(a){var c=0,d;for(p=0;6>p;p++){d=this.planes[p][0]*a.center.x+this.planes[p][1]*a.center.y+this.planes[p][2]*a.center.z+this.planes[p][3];if(d<=-a.radius)return 0;d>
a.radius&&c++}return 6===c?2:1}};return{Frustum:a}}());pc.extend(pc.shape,function(){pc.shape.Type.PLANE="Plane";var e=function(a,b){this.normal=b||new pc.Vec3(0,0,1);this.point=a||new pc.Vec3(0,0,0);this.d=-this.normal.dot(this.point);this.type=pc.shape.Type.PLANE},e=pc.inherits(e,pc.shape.Shape);e.prototype.containsPoint=function(){return!1};e.prototype.distance=function(a){return this.normal.dot(a)+this.d};e.prototype.intersect=function(a,b){var c=this.distance(a),d=this.distance(b);return c/(c-d)};e.prototype.intersectPosition=function(a,b){var c=
this.intersect(a,b),d=new pc.Vec3;d.lerp(a,b,c);return d};return{Plane:e}}());pc.extend(pc.shape,function(){function e(a,b){this.center=void 0===a?new pc.Vec3(0,0,0):a;this.radius=void 0===b?1:b;this.type=pc.shape.Type.SPHERE}pc.shape.Type.SPHERE="Sphere";var e=pc.inherits(e,pc.shape.Shape),a=e.prototype,b=new pc.Vec3;a.containsPoint=function(a){var a=b.sub2(a,this.center).lengthSq(),d=this.radius;return a<d*d};e.prototype.compute=function(a){var b,g=a.length/3,f=new pc.Vec3(0,0,0),e=new pc.Vec3(0,0,0),m=new pc.Vec3(0,0,0);for(b=0;b<g;b++)f.set(a[3*b],a[3*b+1],a[3*b+2]),m.addSelf(f),
0===b%100&&(m.scale(1/g),e.add(m),m.set(0,0,0));m.scale(1/g);e.add(m);this.center.copy(e);e=0;m=new pc.Vec3(0,0,0);for(b=0;b<g;b++)f.set(a[3*b],a[3*b+1],a[3*b+2]),m.sub2(f,this.center),e=Math.max(m.lengthSq(),e);this.radius=Math.sqrt(e)};e.prototype.intersectRay=function(a,b){var g=a.clone().sub(this.center),f=g.dot(b),g=g.dot(g)-this.radius*this.radius;if(0<g&&0<f)return null;g=f*f-g;if(0>g)return null;t=Math.abs(-f-Math.sqrt(g));return b.clone().scale(t).add(a)};return{Sphere:e}}());pc.extend(pc.shape,function(){pc.shape.Type.TORUS="Torus";var e=function(a,b,c){this.transform=a;this.iradius=b;this.oradius=c;this.type=pc.shape.Type.TORUS},e=pc.inherits(e,pc.shape.Shape);e.prototype.containsPoint=function(){throw Error("Not implemented yet");};return{Torus:e}}());(function(){var e={ADDRESS_REPEAT:0,ADDRESS_CLAMP_TO_EDGE:1,ADDRESS_MIRRORED_REPEAT:2,BLENDMODE_ZERO:0,BLENDMODE_ONE:1,BLENDMODE_SRC_COLOR:2,BLENDMODE_ONE_MINUS_SRC_COLOR:3,BLENDMODE_DST_COLOR:4,BLENDMODE_ONE_MINUS_DST_COLOR:5,BLENDMODE_SRC_ALPHA:6,BLENDMODE_SRC_ALPHA_SATURATE:7,BLENDMODE_ONE_MINUS_SRC_ALPHA:8,BLENDMODE_DST_ALPHA:9,BLENDMODE_ONE_MINUS_DST_ALPHA:10,BLENDEQUATION_ADD:0,BLENDEQUATION_SUBTRACT:1,BLENDEQUATION_REVERSE_SUBTRACT:2,BUFFER_STATIC:0,BUFFER_DYNAMIC:1,BUFFER_STREAM:2,CLEARFLAG_COLOR:1,
CLEARFLAG_DEPTH:2,CLEARFLAG_STENCIL:4,CULLFACE_NONE:0,CULLFACE_BACK:1,CULLFACE_FRONT:2,CULLFACE_FRONTANDBACK:3,ELEMENTTYPE_INT8:0,ELEMENTTYPE_UINT8:1,ELEMENTTYPE_INT16:2,ELEMENTTYPE_UINT16:3,ELEMENTTYPE_INT32:4,ELEMENTTYPE_UINT32:5,ELEMENTTYPE_FLOAT32:6,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_NEAREST_MIPMAP_NEAREST:2,FILTER_NEAREST_MIPMAP_LINEAR:3,FILTER_LINEAR_MIPMAP_NEAREST:4,FILTER_LINEAR_MIPMAP_LINEAR:5,INDEXFORMAT_UINT8:0,INDEXFORMAT_UINT16:1,INDEXFORMAT_UINT32:2,PIXELFORMAT_A8:0,PIXELFORMAT_L8:1,
PIXELFORMAT_L8_A8:2,PIXELFORMAT_R5_G6_B5:3,PIXELFORMAT_R5_G5_B5_A1:4,PIXELFORMAT_R4_G4_B4_A4:5,PIXELFORMAT_R8_G8_B8:6,PIXELFORMAT_R8_G8_B8_A8:7,PIXELFORMAT_DXT1:8,PIXELFORMAT_DXT3:9,PIXELFORMAT_DXT5:10,PIXELFORMAT_RGB16F:11,PIXELFORMAT_RGBA16F:12,PIXELFORMAT_RGB32F:13,PIXELFORMAT_RGBA32F:14,PIXELFORMAT_ETC1:15,PRIMITIVE_POINTS:0,PRIMITIVE_LINES:1,PRIMITIVE_LINELOOP:2,PRIMITIVE_LINESTRIP:3,PRIMITIVE_TRIANGLES:4,PRIMITIVE_TRISTRIP:5,PRIMITIVE_TRIFAN:6,SEMANTIC_POSITION:"POSITION",SEMANTIC_NORMAL:"NORMAL",
SEMANTIC_TANGENT:"TANGENT",SEMANTIC_BLENDWEIGHT:"BLENDWEIGHT",SEMANTIC_BLENDINDICES:"BLENDINDICES",SEMANTIC_COLOR:"COLOR",SEMANTIC_TEXCOORD0:"TEXCOORD0",SEMANTIC_TEXCOORD1:"TEXCOORD1",SEMANTIC_TEXCOORD2:"TEXCOORD2",SEMANTIC_TEXCOORD3:"TEXCOORD3",SEMANTIC_TEXCOORD4:"TEXCOORD4",SEMANTIC_TEXCOORD5:"TEXCOORD5",SEMANTIC_TEXCOORD6:"TEXCOORD6",SEMANTIC_TEXCOORD7:"TEXCOORD7",SEMANTIC_ATTR0:"ATTR0",SEMANTIC_ATTR1:"ATTR1",SEMANTIC_ATTR2:"ATTR2",SEMANTIC_ATTR3:"ATTR3",SEMANTIC_ATTR4:"ATTR4",SEMANTIC_ATTR5:"ATTR5",
SEMANTIC_ATTR6:"ATTR6",SEMANTIC_ATTR7:"ATTR7",SEMANTIC_ATTR8:"ATTR8",SEMANTIC_ATTR9:"ATTR9",SEMANTIC_ATTR10:"ATTR10",SEMANTIC_ATTR11:"ATTR11",SEMANTIC_ATTR12:"ATTR12",SEMANTIC_ATTR13:"ATTR13",SEMANTIC_ATTR14:"ATTR14",SEMANTIC_ATTR15:"ATTR15",TEXTURELOCK_READ:1,TEXTURELOCK_WRITE:2,UNIFORMTYPE_BOOL:0,UNIFORMTYPE_INT:1,UNIFORMTYPE_FLOAT:2,UNIFORMTYPE_VEC2:3,UNIFORMTYPE_VEC3:4,UNIFORMTYPE_VEC4:5,UNIFORMTYPE_IVEC2:6,UNIFORMTYPE_IVEC3:7,UNIFORMTYPE_IVEC4:8,UNIFORMTYPE_BVEC2:9,UNIFORMTYPE_BVEC3:10,UNIFORMTYPE_BVEC4:11,
UNIFORMTYPE_MAT2:12,UNIFORMTYPE_MAT3:13,UNIFORMTYPE_MAT4:14,UNIFORMTYPE_TEXTURE2D:15,UNIFORMTYPE_TEXTURECUBE:16};pc.extend(pc,e);pc.gfx={};pc.extend(pc.gfx,e)})();pc.extend(pc,function(){var e=function(a){this.name=a;this.value=null;this.versionObject=new pc.VersionedObject};e.prototype={setValue:function(a){this.value=a;this.versionObject.increment()},getValue:function(){return this.value}};return{ScopeId:e}}());pc.extend(pc,function(){var e=function(a){this.name=a;this.variables={};this.namespaces={}};e.prototype={resolve:function(a){!1===this.variables.hasOwnProperty(a)&&(this.variables[a]=new pc.ScopeId(a));return this.variables[a]},getSubSpace:function(a){!1===this.namespaces.hasOwnProperty(a)&&(this.namespaces[a]=new pc.ScopeSpace(a),logDEBUG("Added ScopeSpace: "+a));return this.namespaces[a]}};return{ScopeSpace:e}}());pc.extend(pc,function(){var e=function(){this.revision=this.globalId=0};e.prototype={equals:function(a){return this.globalId===a.globalId&&this.revision===a.revision},notequals:function(a){return this.globalId!==a.globalId||this.revision!==a.revision},copy:function(a){this.globalId=a.globalId;this.revision=a.revision},reset:function(){this.revision=this.globalId=0}};return{Version:e}}());pc.extend(pc,function(){var e=0,a=function(){e++;this.version=new pc.Version;this.version.globalId=e};a.prototype={increment:function(){this.version.revision++}};return{VersionedObject:a}}());pc.extend(pc,function(){function e(f,g){this.index=0;switch(g.dataType){case pc.ELEMENTTYPE_INT8:this.array=new Int8Array(f,g.offset);break;case pc.ELEMENTTYPE_UINT8:this.array=new Uint8Array(f,g.offset);break;case pc.ELEMENTTYPE_INT16:this.array=new Int16Array(f,g.offset);break;case pc.ELEMENTTYPE_UINT16:this.array=new Uint16Array(f,g.offset);break;case pc.ELEMENTTYPE_INT32:this.array=new Int32Array(f,g.offset);break;case pc.ELEMENTTYPE_UINT32:this.array=new Uint32Array(f,g.offset);break;case pc.ELEMENTTYPE_FLOAT32:this.array=
new Float32Array(f,g.offset)}switch(g.numComponents){case 1:this.set=a;break;case 2:this.set=b;break;case 3:this.set=c;break;case 4:this.set=d}}function a(a){this.array[this.index]=a}function b(a,b){this.array[this.index]=a;this.array[this.index+1]=b}function c(a,b,c){this.array[this.index]=a;this.array[this.index+1]=b;this.array[this.index+2]=c}function d(a,b,c,d){this.array[this.index]=a;this.array[this.index+1]=b;this.array[this.index+2]=c;this.array[this.index+3]=d}function g(a){this.vertexBuffer=
a;this.buffer=this.vertexBuffer.lock();this.setters=[];this.element={};for(var a=this.vertexBuffer.getFormat(),b=0;b<a.elements.length;b++){var c=a.elements[b];this.setters[b]=new e(this.buffer,c);this.element[c.name]=this.setters[b]}}g.prototype={next:function(){for(var a=0,b=this.setters,c=this.setters.length,d=this.vertexBuffer.getFormat();a<c;){var g=b[a++];g.index+=d.size/g.array.constructor.BYTES_PER_ELEMENT}},end:function(){this.vertexBuffer.unlock()}};return{VertexIterator:g}}());pc.extend(pc,function(){var e=[];e[pc.ELEMENTTYPE_INT8]=1;e[pc.ELEMENTTYPE_UINT8]=1;e[pc.ELEMENTTYPE_INT16]=2;e[pc.ELEMENTTYPE_UINT16]=2;e[pc.ELEMENTTYPE_INT32]=4;e[pc.ELEMENTTYPE_UINT32]=4;e[pc.ELEMENTTYPE_FLOAT32]=4;return{VertexFormat:function(a,b){var c;this.elements=[];c=this.size=0;for(var d=b.length;c<d;c++){var g=b[c],g={name:g.semantic,offset:0,stride:0,stream:-1,scopeId:a.scope.resolve(g.semantic),dataType:g.type,numComponents:g.components,normalize:void 0===g.normalize?!1:g.normalize,size:g.components*
e[g.type]};this.elements.push(g);this.size+=g.size}var f=0;c=0;for(d=this.elements.length;c<d;c++)g=this.elements[c],g.offset=f,g.stride=this.size,f+=g.size}}}());pc.extend(pc,function(){var e=function(a,b,c,d,g){this.usage=d||pc.BUFFER_STATIC;this.format=b;this.numVertices=c;this.numBytes=b.size*c;this.device=a;this.bufferId=this.device.gl.createBuffer();if(!g||!this.setData(g))this.storage=new ArrayBuffer(this.numBytes)};e.prototype={destroy:function(){this.device.gl.deleteBuffer(this.bufferId)},getFormat:function(){return this.format},getUsage:function(){return this.usage},getNumVertices:function(){return this.numVertices},lock:function(){return this.storage},
unlock:function(){var a=this.device.gl,b;switch(this.usage){case pc.BUFFER_STATIC:b=a.STATIC_DRAW;break;case pc.BUFFER_DYNAMIC:b=a.DYNAMIC_DRAW;break;case pc.BUFFER_STREAM:b=a.STREAM_DRAW}a.bindBuffer(a.ARRAY_BUFFER,this.bufferId);a.bufferData(a.ARRAY_BUFFER,this.storage,b)},setData:function(a){if(a.byteLength!==this.numBytes)return console.error("VertexBuffer: wrong initial data size: expected "+this.numBytes+", got "+a.byteLength),!1;this.storage=a;this.unlock();return!0}};return{VertexBuffer:e}}());pc.extend(pc,function(){var e=function(a,b,c,d){this.usage=d||pc.BUFFER_STATIC;this.format=b;this.numIndices=c;this.device=a;a=this.device.gl;this.bufferId=a.createBuffer();var g;b===pc.INDEXFORMAT_UINT8?(g=1,this.glFormat=a.UNSIGNED_BYTE):b===pc.INDEXFORMAT_UINT16?(g=2,this.glFormat=a.UNSIGNED_SHORT):b===pc.INDEXFORMAT_UINT32&&(g=4,this.glFormat=a.UNSIGNED_INT);this.storage=new ArrayBuffer(this.numIndices*g)};e.prototype={destroy:function(){this.device.gl.deleteBuffer(this.bufferId)},getFormat:function(){return this.format},
getNumIndices:function(){return this.numIndices},lock:function(){return this.storage},unlock:function(){var a=this.device.gl,b;switch(this.usage){case pc.BUFFER_STATIC:b=a.STATIC_DRAW;break;case pc.BUFFER_DYNAMIC:b=a.DYNAMIC_DRAW;break;case pc.BUFFER_STREAM:b=a.STREAM_DRAW}a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.bufferId);a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.storage,b)}};return{IndexBuffer:e}}());pc.extend(pc,function(){var e=function(a,b){this.device=a;var c=4,d=4,g=pc.PIXELFORMAT_R8_G8_B8_A8,f=!1,e=!0,m=!1,h=!1;void 0!==b&&(c=void 0!==b.width?b.width:c,d=void 0!==b.height?b.height:d,g=void 0!==b.format?b.format:g,f=void 0!==b.cubemap?b.cubemap:f,e=void 0!==b.autoMipmap?b.autoMipmap:e,m=void 0!==b.rgbm?b.rgbm:m,h=void 0!==b.fixCubemapSeams?b.fixCubemapSeams:h);this.name=null;this.autoMipmap=e;this.rgbm=m;this.fixCubemapSeams=h;this._cubemap=f;this._format=g;this._compressed=g===pc.PIXELFORMAT_DXT1||
g===pc.PIXELFORMAT_DXT3||g===pc.PIXELFORMAT_DXT5||g===pc.PIXELFORMAT_ETC1;this._width=c||4;this._height=d||4;this._addressV=this._addressU=pc.ADDRESS_REPEAT;this._minFilter=pc.math.powerOfTwo(this._width)&&pc.math.powerOfTwo(this._height)?pc.FILTER_LINEAR_MIPMAP_LINEAR:pc.FILTER_LINEAR;this._magFilter=pc.FILTER_LINEAR;this._anisotropy=1;this._levels=f?[[null,null,null,null,null,null]]:[null];this._lockedLevel=-1;this._needsUpload=!0};Object.defineProperty(e.prototype,"minFilter",{get:function(){return this._minFilter},
set:function(a){if(!pc.math.powerOfTwo(this._width)||!pc.math.powerOfTwo(this._height))a===pc.FILTER_NEAREST||a===pc.FILTER_LINEAR||(logWARNING("Invalid minification filter mode set on non power of two texture. Forcing linear addressing."),a=pc.FILTER_LINEAR);this._minFilter=a}});Object.defineProperty(e.prototype,"magFilter",{get:function(){return this._magFilter},set:function(a){a===pc.FILTER_NEAREST||a===pc.FILTER_LINEAR||logWARNING("Invalid magnification filter mode. Must be set to FILTER_NEAREST or FILTER_LINEAR.");
this._magFilter=a}});Object.defineProperty(e.prototype,"addressU",{get:function(){return this._addressU},set:function(a){if((!pc.math.powerOfTwo(this._width)||!pc.math.powerOfTwo(this._height))&&a!==pc.ADDRESS_CLAMP_TO_EDGE)logWARNING("Invalid address mode in U set on non power of two texture. Forcing clamp to edge addressing."),a=pc.ADDRESS_CLAMP_TO_EDGE;this._addressU=a}});Object.defineProperty(e.prototype,"addressV",{get:function(){return this._addressV},set:function(a){if((!pc.math.powerOfTwo(this._width)||
!pc.math.powerOfTwo(this._height))&&a!==pc.ADDRESS_CLAMP_TO_EDGE)logWARNING("Invalid address mode in V set on non power of two texture. Forcing clamp to edge addressing."),a=pc.ADDRESS_CLAMP_TO_EDGE;this._addressV=a}});Object.defineProperty(e.prototype,"anisotropy",{get:function(){return this._anisotropy},set:function(a){this._anisotropy=a}});Object.defineProperty(e.prototype,"width",{get:function(){return this._width}});Object.defineProperty(e.prototype,"height",{get:function(){return this._height}});
Object.defineProperty(e.prototype,"format",{get:function(){return this._format}});Object.defineProperty(e.prototype,"cubemap",{get:function(){return this._cubemap}});pc.extend(e.prototype,{bind:function(){},destroy:function(){this._glTextureId&&this.device.gl.deleteTexture(this._glTextureId)},lock:function(a){a=a||{level:0,face:0,mode:pc.TEXTURELOCK_WRITE};void 0===a.level&&(a.level=0);void 0===a.face&&(a.face=0);void 0===a.mode&&(a.mode=pc.TEXTURELOCK_WRITE);this._lockedLevel=a.level;if(null===this._levels[a.level])switch(this._format){case pc.PIXELFORMAT_A8:case pc.PIXELFORMAT_L8:this._levels[a.level]=
new Uint8Array(this._width*this._height);break;case pc.PIXELFORMAT_L8_A8:this._levels[a.level]=new Uint8Array(2*this._width*this._height);break;case pc.PIXELFORMAT_R5_G6_B5:case pc.PIXELFORMAT_R5_G5_B5_A1:case pc.PIXELFORMAT_R4_G4_B4_A4:this._levels[a.level]=new Uint16Array(this._width*this._height);break;case pc.PIXELFORMAT_R8_G8_B8:this._levels[a.level]=new Uint8Array(3*this._width*this._height);break;case pc.PIXELFORMAT_R8_G8_B8_A8:this._levels[a.level]=new Uint8Array(4*this._width*this._height);
break;case pc.PIXELFORMAT_DXT1:this._levels[a.level]=new Uint8Array(8*Math.floor((this._width+3)/4)*Math.floor((this._height+3)/4));break;case pc.PIXELFORMAT_DXT3:case pc.PIXELFORMAT_DXT5:this._levels[a.level]=new Uint8Array(16*Math.floor((this._width+3)/4)*Math.floor((this._height+3)/4));break;case pc.PIXELFORMAT_RGB16F:case pc.PIXELFORMAT_RGB32F:this._levels[a.level]=new Float32Array(3*this._width*this._height);break;case pc.PIXELFORMAT_RGBA16F:case pc.PIXELFORMAT_RGBA32F:this._levels[a.level]=
new Float32Array(4*this._width*this._height)}return this._levels[a.level]},recover:function(){},load:function(a,b){if(this._cubemap){var c=a.map(function(a){return new pc.resources.ImageRequest(a)});b.request(c).then(function(a){this.setSource(a)}.bind(this))}else c=new pc.resources.ImageRequest(a),b.request(c).then(function(a){this.setSource(a[0])}.bind(this))},setSource:function(a){if(this._cubemap){logASSERT("[object Array]"===Object.prototype.toString.apply(a),"pc.Texture: setSource: supplied source is not an array");
logASSERT(6===a.length,"pc.Texture: setSource: supplied source does not have 6 entries.");for(var b=0,c=!0,d=a[0].width,g=a[0].height,f=0;6>f;f++)(a[f]instanceof HTMLCanvasElement||a[f]instanceof HTMLImageElement||a[f]instanceof HTMLVideoElement)&&b++,a[f].width!==d&&(c=!1),a[f].height!==g&&(c=!1);logASSERT(6===b,"pc.Texture: setSource: Not all supplied source elements are of required type (canvas, image or video).");logASSERT(c,"pc.Texture: setSource: Not all supplied source elements share the same dimensions.");
this._width=a[0].width;this._height=a[0].height}else logASSERT(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement||a instanceof HTMLVideoElement,"pc.Texture: setSource: supplied source is not an instance of HTMLCanvasElement, HTMLImageElement or HTMLVideoElement."),this._width=a.width,this._height=a.height;this._levels[0]=a;this.upload();this.minFilter=this._minFilter;this.magFilter=this._magFilter;this.addressu=this._addressu;this.addressv=this._addressv},getSource:function(){return this._levels[0]},
unlock:function(){logASSERT(-1!==this._lockedLevel,"Attempting to unlock a texture that is not locked");this.upload();this._lockedLevel=-1},upload:function(){this._needsUpload=!0},getDds:function(){this.format!=pc.PIXELFORMAT_R8_G8_B8_A8&&console.error("This format is not implemented yet");for(var a=128,b=0,c,d;this._levels[b];){if(this.cubemap)for(d=0;6>d;d++){c=this._levels[b][d].length;if(!c){console.error("No byte array for mip "+b+", face "+d);return}a+=c}else{c=this._levels[b].length;if(!c){console.error("No byte array for mip "+
b);return}a+=c}a+=this._levels[b].length;b++}a=new ArrayBuffer(a);d=new Uint32Array(a,0,32);b=528391;1<this._levels.length&&(b|=131072);c=4096;1<this._levels.length&&(c|=4194304);if(1<this._levels.length||this.cubemap)c|=8;var g=this.cubemap?65024:0;d[0]=542327876;d[1]=124;d[2]=b;d[3]=this.height;d[4]=this.width;d[5]=4*this.width*this.height;d[6]=0;d[7]=this._levels.length;for(b=0;11>b;b++)d[8+b]=0;d[19]=32;d[20]=65;d[21]=0;d[22]=32;d[23]=16711680;d[24]=65280;d[25]=255;d[26]=4278190080;d[27]=c;d[28]=
g;d[29]=0;d[30]=0;d[31]=0;g=128;if(this.cubemap)for(d=0;6>d;d++)for(b=0;b<this._levels.length;b++){f=this._levels[b][d];e=new Uint8Array(a,g,f.length);for(c=0;c<f.length;c++)e[c]=f[c];g+=f.length}else for(b=0;b<this._levels.length;b++){var f=this._levels[b],e=new Uint8Array(a,g,f.length);for(c=0;c<f.length;c++)e[c]=f[c];g+=f.length}return a}});return{Texture:e}}());pc.extend(pc,function(){var e={depth:!0,face:0},a=function(a,c,d){this._device=a;this._colorBuffer=c;d=void 0!==d?d:e;this._face=void 0!==d.face?d.face:0;this._depth=void 0!==d.depth?d.depth:!0};a.prototype={bind:function(){},destroy:function(){var a=this._device.gl;a.deleteFramebuffer(this._frameBuffer);this._depthBuffer&&a.deleteRenderbuffer(this._depthBuffer)},unbind:function(){}};Object.defineProperty(a.prototype,"colorBuffer",{get:function(){return this._colorBuffer}});Object.defineProperty(a.prototype,
"face",{get:function(){return this._face}});Object.defineProperty(a.prototype,"width",{get:function(){return this._colorBuffer.width}});Object.defineProperty(a.prototype,"height",{get:function(){return this._colorBuffer.height}});return{RenderTarget:a}}());pc.extend(pc,function(){return{ShaderInput:function(e,a,b,c){this.locationId=c;this.scopeId=e.scope.resolve(a);this.version=new pc.Version;this.dataType=b;this.array=[]}}}());pc.extend(pc,function(){function e(a,c,d){var g=a.createShader(c);a.shaderSource(g,d);a.compileShader(g);if(!a.getShaderParameter(g,a.COMPILE_STATUS)){for(var f=a.getShaderInfoLog(g),e=logERROR,a="Failed to compile "+(c===a.VERTEX_SHADER?"vertex":"fragment")+" shader:\n\n",d=d.split("\n"),c=0,m=d.length;c<m;c++)d[c]=c+1+":\t"+d[c];d=d.join("\n");e(a+d+"\n\n"+f)}return g}var a=function(a,c){this.device=a;this.definition=c;var d=this.device.gl,g=e(d,d.VERTEX_SHADER,c.vshader),f=e(d,d.FRAGMENT_SHADER,
c.fshader),k=d.createProgram();d.attachShader(k,g);d.attachShader(k,f);d.linkProgram(k);if(!d.getProgramParameter(k,d.LINK_STATUS)){var m=d.getProgramInfoLog(k);logERROR("Failed to link shader program. Error: "+m)}this.program=k;d.deleteShader(g);d.deleteShader(f);this.attributes=[];this.uniforms=[];this.samplers=[];g=0;f={};f[d.BOOL]=pc.UNIFORMTYPE_BOOL;f[d.INT]=pc.UNIFORMTYPE_INT;f[d.FLOAT]=pc.UNIFORMTYPE_FLOAT;f[d.FLOAT_VEC2]=pc.UNIFORMTYPE_VEC2;f[d.FLOAT_VEC3]=pc.UNIFORMTYPE_VEC3;f[d.FLOAT_VEC4]=
pc.UNIFORMTYPE_VEC4;f[d.INT_VEC2]=pc.UNIFORMTYPE_IVEC2;f[d.INT_VEC3]=pc.UNIFORMTYPE_IVEC3;f[d.INT_VEC4]=pc.UNIFORMTYPE_IVEC4;f[d.BOOL_VEC2]=pc.UNIFORMTYPE_BVEC2;f[d.BOOL_VEC3]=pc.UNIFORMTYPE_BVEC3;f[d.BOOL_VEC4]=pc.UNIFORMTYPE_BVEC4;f[d.FLOAT_MAT2]=pc.UNIFORMTYPE_MAT2;f[d.FLOAT_MAT3]=pc.UNIFORMTYPE_MAT3;f[d.FLOAT_MAT4]=pc.UNIFORMTYPE_MAT4;f[d.SAMPLER_2D]=pc.UNIFORMTYPE_TEXTURE2D;f[d.SAMPLER_CUBE]=pc.UNIFORMTYPE_TEXTURECUBE;for(var h=d.getProgramParameter(this.program,d.ACTIVE_ATTRIBUTES);g<h;)k=d.getActiveAttrib(this.program,
g++),m=d.getAttribLocation(this.program,k.name),void 0===c.attributes[k.name]&&console.error('Vertex shader attribute "'+k.name+'" is not mapped to a semantic in shader definition.'),k=new pc.ShaderInput(a,c.attributes[k.name],f[k.type],m),this.attributes.push(k);g=0;for(h=d.getProgramParameter(this.program,d.ACTIVE_UNIFORMS);g<h;)k=d.getActiveUniform(this.program,g++),m=d.getUniformLocation(this.program,k.name),k.type===d.SAMPLER_2D||k.type===d.SAMPLER_CUBE?this.samplers.push(new pc.ShaderInput(a,
k.name,f[k.type],m)):this.uniforms.push(new pc.ShaderInput(a,k.name,f[k.type],m))};a.prototype={destroy:function(){this.device.gl.deleteProgram(this.program)}};return{Shader:a}}());pc.extend(pc,function(){var e=function(a){this._device=a;this._cache={};this._generators={}};e.prototype.register=function(a,b){this.isRegistered(a)||(this._generators[a]=b)};e.prototype.unregister=function(a){this.isRegistered(a)&&delete this._generators[a]};e.prototype.isRegistered=function(a){return void 0!==this._generators[a]};e.prototype.getProgram=function(a,b){var c=this._generators[a];if(void 0===c)return logERROR("No program library functions registered for: "+a),null;var d=c.generateKey(g,
b),g=this._cache[d];if(!g)var g=this._device,c=c.createShaderDefinition(g,b),g=this._cache[d]=new pc.Shader(g,c);return g};return{ProgramLibrary:e}}());pc.extend(pc,function(){function e(a){this.name="UnsupportedBrowserError";this.message=a||""}function a(a){this.name="ContextCreationError";this.message=a||""}e.prototype=Error.prototype;a.prototype=Error.prototype;var b=function(){logWARNING("Context lost.")},c=function(){logINFO("Context restored.")},d=function(a,b){var c=a.width,d=a.height;if(c>b||d>b){var g=b/Math.max(c,d),e=Math.floor(c*g),g=Math.floor(d*g);console.warn("Image dimensions larger than max supported texture size of "+b+". Resizing from "+
c+", "+d+" to "+e+", "+g+".");var r=document.createElement("canvas");r.width=e;r.height=g;r.getContext("2d").drawImage(a,0,0,c,d,0,0,e,g);return r}return a},g=function(a){this.gl=void 0;this.canvas=a;this.indexBuffer=this.shader=null;this.vertexBuffers=[];this.precision="highp";this.enableAutoInstancing=!1;this.autoInstancingMaxObjects=16384;this.attributesInvalidated=!0;this.boundBuffer=[];this.instancedAttribs={};this.enabledAttributes={};this.textureUnits=[];this.commitFunction={};if(!window.WebGLRenderingContext)throw new pc.UnsupportedBrowserError;
for(var d=["webgl","experimental-webgl"],g=null,e=0;e<d.length;e++){try{g=a.getContext(d[e],void 0)}catch(n){}if(g)break}var l=this.gl=g;if(!this.gl)throw new pc.ContextCreationError;a.addEventListener("webglcontextlost",b,!1);a.addEventListener("webglcontextrestored",c,!1);this.canvas=a;this.indexBuffer=this.shader=null;this.vertexBuffers=[];this.precision="highp";this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE);this.maxCubeMapSize=l.getParameter(l.MAX_CUBE_MAP_TEXTURE_SIZE);a=l.getShaderPrecisionFormat(l.VERTEX_SHADER,
l.HIGH_FLOAT);g=l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_FLOAT);l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.LOW_FLOAT);d=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.HIGH_FLOAT);e=l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_FLOAT);l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.LOW_FLOAT);l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.HIGH_INT);l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.MEDIUM_INT);l.getShaderPrecisionFormat(l.VERTEX_SHADER,l.LOW_INT);l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,
l.HIGH_INT);l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.MEDIUM_INT);l.getShaderPrecisionFormat(l.FRAGMENT_SHADER,l.LOW_INT);g=0<g.precision&&0<e.precision;0<a.precision&&0<d.precision||(g?(this.precision="mediump",console.warn("WARNING: highp not supported, using mediump")):(this.precision="lowp",console.warn("WARNING: highp and mediump not supported, using lowp")));this.maxPrecision=this.precision;this.defaultClearOptions={color:[0,0,0,1],depth:1,flags:pc.CLEARFLAG_COLOR|pc.CLEARFLAG_DEPTH};this.glAddress=
[l.REPEAT,l.CLAMP_TO_EDGE,l.MIRRORED_REPEAT];this.glBlendEquation=[l.FUNC_ADD,l.FUNC_SUBTRACT,l.FUNC_REVERSE_SUBTRACT];this.glBlendFunction=[l.ZERO,l.ONE,l.SRC_COLOR,l.ONE_MINUS_SRC_COLOR,l.DST_COLOR,l.ONE_MINUS_DST_COLOR,l.SRC_ALPHA,l.SRC_ALPHA_SATURATE,l.ONE_MINUS_SRC_ALPHA,l.DST_ALPHA,l.ONE_MINUS_DST_ALPHA];this.glClearFlag=[0,l.COLOR_BUFFER_BIT,l.DEPTH_BUFFER_BIT,l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT,l.STENCIL_BUFFER_BIT,l.STENCIL_BUFFER_BIT|l.COLOR_BUFFER_BIT,l.STENCIL_BUFFER_BIT|l.DEPTH_BUFFER_BIT,
l.STENCIL_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT];this.glFilter=[l.NEAREST,l.LINEAR,l.NEAREST_MIPMAP_NEAREST,l.NEAREST_MIPMAP_LINEAR,l.LINEAR_MIPMAP_NEAREST,l.LINEAR_MIPMAP_LINEAR];this.glPrimitive=[l.POINTS,l.LINES,l.LINE_LOOP,l.LINE_STRIP,l.TRIANGLES,l.TRIANGLE_STRIP,l.TRIANGLE_FAN];this.glType=[l.BYTE,l.UNSIGNED_BYTE,l.SHORT,l.UNSIGNED_SHORT,l.INT,l.UNSIGNED_INT,l.FLOAT];this.extTextureFloat=l.getExtension("OES_texture_float");this.extTextureFloatLinear=l.getExtension("OES_texture_float_linear");
this.extTextureHalfFloat=l.getExtension("OES_texture_half_float");this.maxVertexTextures=l.getParameter(l.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.supportsBoneTextures=this.extTextureFloat&&0<this.maxVertexTextures;this.extTextureFloatRenderable=!!this.extTextureFloat;this.extTextureFloat&&(a=l.createTexture(),l.bindTexture(l.TEXTURE_2D,a),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,
l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,2,2,0,l.RGBA,l.FLOAT,null),d=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,d),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,a,0),l.bindTexture(l.TEXTURE_2D,null),l.checkFramebufferStatus(l.FRAMEBUFFER)!=l.FRAMEBUFFER_COMPLETE&&(this.extTextureFloatRenderable=!1));this.extTextureLod=l.getExtension("EXT_shader_texture_lod");this.fragmentUniformsCount=l.getParameter(l.MAX_FRAGMENT_UNIFORM_VECTORS);
this.samplerCount=l.getParameter(l.MAX_TEXTURE_IMAGE_UNITS);this.extDepthTexture=null;(this.extStandardDerivatives=l.getExtension("OES_standard_derivatives"))&&l.hint(this.extStandardDerivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES,l.NICEST);this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic");this.extTextureFilterAnisotropic||(this.extTextureFilterAnisotropic=l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"));this.extCompressedTextureS3TC=l.getExtension("WEBGL_compressed_texture_s3tc");
this.extCompressedTextureS3TC||(this.extCompressedTextureS3TC=l.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"));if(a=this.extCompressedTextureS3TC)a=window.navigator.userAgent.indexOf("MSIE "),d=navigator.userAgent.match(/Trident.*rv\:11\./),a=0<a||!!d;a&&(this.extCompressedTextureS3TC=!1);if(this.extCompressedTextureS3TC){a=l.getParameter(l.COMPRESSED_TEXTURE_FORMATS);for(d=0;d<a.length;d++);}this.extInstancing=l.getExtension("ANGLE_instanced_arrays");this.enableAutoInstancing&&!this.extInstancing&&
(this.enableAutoInstancing=!1);this.extCompressedTextureETC1=l.getExtension("WEBGL_compressed_texture_etc1");this.maxDrawBuffers=(this.extDrawBuffers=l.getExtension("EXT_draw_buffers"))?l.getParameter(this.extDrawBuffers.MAX_DRAW_BUFFERS_EXT):1;this.maxColorAttachments=this.extDrawBuffers?l.getParameter(this.extDrawBuffers.MAX_COLOR_ATTACHMENTS_EXT):1;this.renderTarget=null;this.scope=new pc.ScopeSpace("Device");this.commitFunction={};this.commitFunction[pc.UNIFORMTYPE_BOOL]=function(a,b){l.uniform1i(a,
b)};this.commitFunction[pc.UNIFORMTYPE_INT]=function(a,b){l.uniform1i(a,b)};this.commitFunction[pc.UNIFORMTYPE_FLOAT]=function(a,b){"number"==typeof b?l.uniform1f(a,b):l.uniform1fv(a,b)};this.commitFunction[pc.UNIFORMTYPE_VEC2]=function(a,b){l.uniform2fv(a,b)};this.commitFunction[pc.UNIFORMTYPE_VEC3]=function(a,b){l.uniform3fv(a,b)};this.commitFunction[pc.UNIFORMTYPE_VEC4]=function(a,b){l.uniform4fv(a,b)};this.commitFunction[pc.UNIFORMTYPE_IVEC2]=function(a,b){l.uniform2iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_BVEC2]=
function(a,b){l.uniform2iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_IVEC3]=function(a,b){l.uniform3iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_BVEC3]=function(a,b){l.uniform3iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_IVEC4]=function(a,b){l.uniform4iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_BVEC4]=function(a,b){l.uniform4iv(a,b)};this.commitFunction[pc.UNIFORMTYPE_MAT2]=function(a,b){l.uniformMatrix2fv(a,!1,b)};this.commitFunction[pc.UNIFORMTYPE_MAT3]=function(a,b){l.uniformMatrix3fv(a,!1,b)};this.commitFunction[pc.UNIFORMTYPE_MAT4]=
function(a,b){l.uniformMatrix4fv(a,!1,b)};this.setBlending(!1);this.setBlendFunction(pc.BLENDMODE_ONE,pc.BLENDMODE_ZERO);this.setBlendEquation(pc.BLENDEQUATION_ADD);this.setColorWrite(!0,!0,!0,!0);this.setCullMode(pc.CULLFACE_BACK);this.setDepthTest(!0);this.setDepthWrite(!0);this.setClearDepth(1);this.setClearColor(0,0,0,0);l.enable(l.SCISSOR_TEST);this.programLib=new pc.ProgramLibrary(this);for(var r in pc.programlib)this.programLib.register(r,pc.programlib[r]);r=l.getParameter(l.MAX_VERTEX_UNIFORM_VECTORS);
r=r-16-8;r-=1;r-=16;this.boneLimit=Math.floor(r/4);110<this.boneLimit&&(this.boneLimit=110);pc.events.attach(this);this.boundBuffer=[];this.instancedAttribs={};this.textureUnits=[];this.attributesInvalidated=!0;this.enabledAttributes={};r=l.createBuffer();a=new ArrayBuffer(16);l.bindBuffer(l.ARRAY_BUFFER,r);l.bufferData(l.ARRAY_BUFFER,a,l.STATIC_DRAW);l.getError();l.vertexAttribPointer(0,4,l.UNSIGNED_BYTE,!1,4,0);this.supportsUnsignedByte=0===l.getError();l.deleteBuffer(r)};g.prototype={setViewport:function(a,
b,c,d){this.gl.viewport(a,b,c,d)},setScissor:function(a,b,c,d){this.gl.scissor(a,b,c,d)},getProgramLibrary:function(){return this.programLib},setProgramLibrary:function(a){this.programLib=a},updateBegin:function(){var a=this.gl;this.boundBuffer=[];this.indexBuffer=null;var b=this.renderTarget;if(b)if(b._glFrameBuffer)a.bindFramebuffer(a.FRAMEBUFFER,b._glFrameBuffer);else switch(b._glFrameBuffer=a.createFramebuffer(),a.bindFramebuffer(a.FRAMEBUFFER,b._glFrameBuffer),b._colorBuffer._glTextureId||this.setTexture(b._colorBuffer,
0),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,b._colorBuffer._cubemap?a.TEXTURE_CUBE_MAP_POSITIVE_X+b._face:a.TEXTURE_2D,b._colorBuffer._glTextureId,0),b._depth&&(b._glDepthBuffer||(b._glDepthBuffer=a.createRenderbuffer()),a.bindRenderbuffer(a.RENDERBUFFER,b._glDepthBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.bindRenderbuffer(a.RENDERBUFFER,null),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b._glDepthBuffer)),a.checkFramebufferStatus(a.FRAMEBUFFER)){case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.error("ERROR: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case a.FRAMEBUFFER_UNSUPPORTED:console.error("ERROR: FRAMEBUFFER_UNSUPPORTED")}else a.bindFramebuffer(a.FRAMEBUFFER,null);for(a=0;16>a;a++)this.textureUnits[a]=null},updateEnd:function(){var a=this.gl;this.renderTarget&&a.bindFramebuffer(a.FRAMEBUFFER,null)},initializeTexture:function(a){var b=
this.gl;a._glTextureId=b.createTexture();a._glTarget=a._cubemap?b.TEXTURE_CUBE_MAP:b.TEXTURE_2D;switch(a._format){case pc.PIXELFORMAT_A8:a._glFormat=b.ALPHA;a._glInternalFormat=b.ALPHA;a._glPixelType=b.UNSIGNED_BYTE;break;case pc.PIXELFORMAT_L8:a._glFormat=b.LUMINANCE;a._glInternalFormat=b.LUMINANCE;a._glPixelType=b.UNSIGNED_BYTE;break;case pc.PIXELFORMAT_L8_A8:a._glFormat=b.LUMINANCE_ALPHA;a._glInternalFormat=b.LUMINANCE_ALPHA;a._glPixelType=b.UNSIGNED_BYTE;break;case pc.PIXELFORMAT_R5_G6_B5:a._glFormat=
b.RGB;a._glInternalFormat=b.RGB;a._glPixelType=b.UNSIGNED_SHORT_5_6_5;break;case pc.PIXELFORMAT_R5_G5_B5_A1:a._glFormat=b.RGBA;a._glInternalFormat=b.RGBA;a._glPixelType=b.UNSIGNED_SHORT_5_5_5_1;break;case pc.PIXELFORMAT_R4_G4_B4_A4:a._glFormat=b.RGBA;a._glInternalFormat=b.RGBA;a._glPixelType=b.UNSIGNED_SHORT_4_4_4_4;break;case pc.PIXELFORMAT_R8_G8_B8:a._glFormat=b.RGB;a._glInternalFormat=b.RGB;a._glPixelType=b.UNSIGNED_BYTE;break;case pc.PIXELFORMAT_R8_G8_B8_A8:a._glFormat=b.RGBA;a._glInternalFormat=
b.RGBA;a._glPixelType=b.UNSIGNED_BYTE;break;case pc.PIXELFORMAT_DXT1:ext=this.extCompressedTextureS3TC;a._glFormat=b.RGB;a._glInternalFormat=ext.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case pc.PIXELFORMAT_DXT3:ext=this.extCompressedTextureS3TC;a._glFormat=b.RGBA;a._glInternalFormat=ext.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case pc.PIXELFORMAT_DXT5:ext=this.extCompressedTextureS3TC;a._glFormat=b.RGBA;a._glInternalFormat=ext.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;case pc.PIXELFORMAT_ETC1:ext=this.extCompressedTextureETC1;
a._glFormat=b.RGB;a._glInternalFormat=ext.COMPRESSED_RGB_ETC1_WEBGL;break;case pc.PIXELFORMAT_RGB16F:ext=this.extTextureHalfFloat;a._glFormat=b.RGB;a._glInternalFormat=b.RGB;a._glPixelType=ext.HALF_FLOAT_OES;break;case pc.PIXELFORMAT_RGBA16F:ext=this.extTextureHalfFloat;a._glFormat=b.RGBA;a._glInternalFormat=b.RGBA;a._glPixelType=ext.HALF_FLOAT_OES;break;case pc.PIXELFORMAT_RGB32F:a._glFormat=b.RGB;a._glInternalFormat=b.RGB;a._glPixelType=b.FLOAT;break;case pc.PIXELFORMAT_RGBA32F:a._glFormat=b.RGBA,
a._glInternalFormat=b.RGBA,a._glPixelType=b.FLOAT}},uploadTexture:function(a){for(var b=this.gl,c=0,g;a._levels[c]||0==c;){g=a._levels[c];1==c&&!a._compressed&&b.generateMipmap(a._glTarget);if(a._cubemap){var e;b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);if(g[0]instanceof HTMLCanvasElement||g[0]instanceof HTMLImageElement||g[0]instanceof HTMLVideoElement)for(e=0;6>e;e++){var l=g[e];if(l instanceof HTMLImageElement&&(l.width>this.maxCubeMapSize||l.height>
this.maxCubeMapSize))l=d(l,this.maxCubeMapSize),0===c&&(a.width=l.width,a.height=l.height);b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+e,c,a._glInternalFormat,a._glFormat,a._glPixelType,l)}else{l=1/Math.pow(2,c);for(e=0;6>e;e++)a._compressed?b.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+e,c,a._glInternalFormat,Math.max(a._width*l,1),Math.max(a._height*l,1),0,g[e]):b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+e,c,a._glInternalFormat,Math.max(a._width*l,1),Math.max(a._height*l,1),0,a._glFormat,
a._glPixelType,g[e])}}else if(g instanceof HTMLCanvasElement||g instanceof HTMLImageElement||g instanceof HTMLVideoElement){if(g instanceof HTMLImageElement&&(g.width>this.maxTextureSize||g.height>this.maxTextureSize))g=d(g,this.maxTextureSize),0===c&&(a.width=g.width,a.height=g.height);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!0);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);b.texImage2D(b.TEXTURE_2D,c,a._glInternalFormat,a._glFormat,a._glPixelType,g)}else b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1),
l=1/Math.pow(2,c),a._compressed?b.compressedTexImage2D(b.TEXTURE_2D,c,a._glInternalFormat,Math.max(a._width*l,1),Math.max(a._height*l,1),0,g):b.texImage2D(b.TEXTURE_2D,c,a._glInternalFormat,Math.max(a._width*l,1),Math.max(a._height*l,1),0,a._glFormat,a._glPixelType,g);c++}a.autoMipmap&&(pc.math.powerOfTwo(a._width)&&pc.math.powerOfTwo(a._height)&&1===a._levels.length&&!a._compressed)&&b.generateMipmap(a._glTarget)},setTexture:function(a,b){var c=this.gl;a._glTextureId||this.initializeTexture(a);c.activeTexture(c.TEXTURE0+
b);this.textureUnits[b]!==a&&(c.bindTexture(a._glTarget,a._glTextureId),this.textureUnits[b]=a);c.texParameteri(a._glTarget,c.TEXTURE_MIN_FILTER,this.glFilter[a._minFilter]);c.texParameteri(a._glTarget,c.TEXTURE_MAG_FILTER,this.glFilter[a._magFilter]);c.texParameteri(a._glTarget,c.TEXTURE_WRAP_S,this.glAddress[a._addressU]);c.texParameteri(a._glTarget,c.TEXTURE_WRAP_T,this.glAddress[a._addressV]);var d=this.extTextureFilterAnisotropic;if(d){var g=a.anisotropy,g=Math.min(g,this.maxAnisotropy);c.texParameterf(a._glTarget,
d.TEXTURE_MAX_ANISOTROPY_EXT,g)}a._needsUpload&&(this.uploadTexture(a),a._needsUpload=!1)},draw:function(a,b){var c=this.gl,d,g,e,r,v,s,C;d=this.shader;C=d.samplers;var x=d.uniforms;1<b&&(this.boundBuffer=[],this.attributesInvalidated=!0);if(this.attributesInvalidated){s=d.attributes;d=0;for(e=s.length;d<e;d++)g=s[d],r=g.scopeId.value,null!==r&&(v=this.vertexBuffers[r.stream],this.boundBuffer[r.stream]!==v.bufferId&&(c.bindBuffer(c.ARRAY_BUFFER,v.bufferId),this.boundBuffer[r.stream]=v.bufferId),this.enabledAttributes[g.locationId]||
(c.enableVertexAttribArray(g.locationId),this.enabledAttributes[g.locationId]=!0),c.vertexAttribPointer(g.locationId,r.numComponents,this.glType[r.dataType],r.normalize,r.stride,r.offset),1===r.stream&&1<b?this.instancedAttribs[g.locationId]||(this.extInstancing.vertexAttribDivisorANGLE(g.locationId,1),this.instancedAttribs=g.locationId):this.instancedAttribs[g.locationId]&&(this.extInstancing.vertexAttribDivisorANGLE(g.locationId,0),this.instancedAttribs[g.locationId]=!1));this.attributesInvalidated=
!1}d=textureUnit=0;for(e=C.length;d<e;d++)if(r=C[d],v=r.scopeId.value,v instanceof pc.Texture)s=v,this.setTexture(s,textureUnit),r.slot!==textureUnit&&(c.uniform1i(r.locationId,textureUnit),r.slot=textureUnit),textureUnit++;else{r.array.length=0;numTexures=v.length;for(g=0;g<numTexures;g++)s=v[g],this.setTexture(s,textureUnit),r.array[g]=textureUnit,textureUnit++;c.uniform1iv(r.locationId,r.array)}d=0;for(e=x.length;d<e;d++)if(C=x[d],g=C.scopeId,r=C.version,v=g.versionObject.version,r.globalId!==
v.globalId||r.revision!==v.revision)if(r.globalId=v.globalId,r.revision=v.revision,null!==g.value)this.commitFunction[C.dataType](C.locationId,g.value);a.indexed?1<b?(this.extInstancing.drawElementsInstancedANGLE(this.glPrimitive[a.type],a.count,this.indexBuffer.glFormat,2*a.base,b),this.boundBuffer=[],this.attributesInvalidated=!0):c.drawElements(this.glPrimitive[a.type],a.count,this.indexBuffer.glFormat,2*a.base):1<b?(this.extInstancing.drawArraysInstancedANGLE(this.glPrimitive[a.type],a.base,a.count,
b),this.boundBuffer=[],this.attributesInvalidated=!0):c.drawArrays(this.glPrimitive[a.type],a.base,a.count)},clear:function(a){var b=this.defaultClearOptions,a=a||b,c=void 0===a.flags?b.flags:a.flags;if(0!==c){var d=this.gl;if(c&pc.CLEARFLAG_COLOR){var g=void 0===a.color?b.color:a.color;this.setClearColor(g[0],g[1],g[2],g[3])}c&pc.CLEARFLAG_DEPTH&&(this.setClearDepth(void 0===a.depth?b.depth:a.depth),this.depthWrite||d.depthMask(!0));d.clear(this.glClearFlag[c]);c&pc.CLEARFLAG_DEPTH&&(this.depthWrite||
d.depthMask(!1))}},readPixels:function(a,b,c,d,g){var e=this.gl;e.readPixels(a,b,c,d,e.RGBA,e.UNSIGNED_BYTE,g)},setClearDepth:function(a){a!==this.clearDepth&&(this.gl.clearDepth(a),this.clearDepth=a)},setClearColor:function(a,b,c,d){if(a!==this.clearRed||b!==this.clearGreen||c!==this.clearBlue||d!==this.clearAlpha)this.gl.clearColor(a,b,c,d),this.clearRed=a,this.clearGreen=b,this.clearBlue=c,this.clearAlpha=d},setRenderTarget:function(a){this.renderTarget=a},getRenderTarget:function(){return this.renderTarget},
getDepthTest:function(){return this.depthTest},setDepthTest:function(a){if(this.depthTest!==a){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);this.depthTest=a}},getDepthWrite:function(){return this.depthWrite},setDepthWrite:function(a){this.depthWrite!==a&&(this.gl.depthMask(a),this.depthWrite=a)},setColorWrite:function(a,b,c,d){if(this.writeRed!==a||this.writeGreen!==b||this.writeBlue!==c||this.writeAlpha!==d)this.gl.colorMask(a,b,c,d),this.writeRed=a,this.writeGreen=b,this.writeBlue=
c,this.writeAlpha=d},getBlending:function(){return this.blending},setBlending:function(a){if(this.blending!==a){var b=this.gl;a?b.enable(b.BLEND):b.disable(b.BLEND);this.blending=a}},setBlendFunction:function(a,b){if(this.blendSrc!==a||this.blendDst!==b)this.gl.blendFunc(this.glBlendFunction[a],this.glBlendFunction[b]),this.blendSrc=a,this.blendDst=b},setBlendEquation:function(a){this.blendEquation!==a&&(this.gl.blendEquation(this.glBlendEquation[a]),this.blendEquation=a)},setCullMode:function(a){if(this.cullMode!==
a){var b=this.gl;switch(a){case pc.CULLFACE_NONE:b.disable(b.CULL_FACE);break;case pc.CULLFACE_FRONT:b.enable(b.CULL_FACE);b.cullFace(b.FRONT);break;case pc.CULLFACE_BACK:b.enable(b.CULL_FACE);b.cullFace(b.BACK);break;case pc.CULLFACE_FRONTANDBACK:b.enable(b.CULL_FACE),b.cullFace(b.FRONT_AND_BACK)}this.cullMode=a}},setIndexBuffer:function(a){if(this.indexBuffer!==a){this.indexBuffer=a;var b=this.gl;b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a?a.bufferId:null)}},setVertexBuffer:function(a,b){if(this.vertexBuffers[b]!==
a){this.vertexBuffers[b]=a;for(var c=0,d=a.getFormat().elements,g=d.length;c<g;){var e=d[c++];e.stream=b;e.scopeId.setValue(e)}this.attributesInvalidated=!0}},setShader:function(a){a!==this.shader&&(this.shader=a,this.gl.useProgram(a.program),this.attributesInvalidated=!0)},getBoneLimit:function(){return this.boneLimit},setBoneLimit:function(a){this.boneLimit=a},enableValidation:function(){console.warn("enableValidation: This function is deprecated and will be removed shortly.")},validate:function(){console.warn("validate: This function is deprecated and will be removed shortly.")},
resizeCanvas:function(a,b){this.canvas.width=a;this.canvas.height=b;this.fire("resizecanvas",a,b)}};Object.defineProperty(g.prototype,"width",{get:function(){return this.gl.drawingBufferWidth||this.canvas.width}});Object.defineProperty(g.prototype,"height",{get:function(){return this.gl.drawingBufferHeight||this.canvas.height}});Object.defineProperty(g.prototype,"fullscreen",{get:function(){return!!document.fullscreenElement},set:function(a){a?this.gl.canvas.requestFullscreen():document.exitFullscreen()}});
Object.defineProperty(g.prototype,"maxAnisotropy",{get:function(){var a;return function(){if(void 0===a){a=1;var b=this.gl,c=this.extTextureFilterAnisotropic;c&&(a=b.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT))}return a}}()});return{UnsupportedBrowserError:e,ContextCreationError:a,GraphicsDevice:g,precalculatedTangents:!0}}());pc.extend(pc,function(){var e={},a={};e.collectAttribs=function(a){for(var c={},d=0,g=a.indexOf("attribute");0<=g;){var e=a.indexOf(";",g),k=a.lastIndexOf(" ",e),e=a.substr(k+1,e-(k+1));"aPosition"==e?c.aPosition=pc.SEMANTIC_POSITION:(c[e]="ATTR"+d,d++);g=a.indexOf("attribute",g+1)}return c};e.createShader=function(a,c,d){c=e[c];d=pc.programlib.getSnippet(a,"fs_precision")+"\n"+e[d];attribs=this.collectAttribs(c);return new pc.Shader(a,{attributes:attribs,vshader:c,fshader:d})};e.createShaderFromCode=
function(b,c,d,g){var e=a[g];if(void 0!=e)return e;d=pc.programlib.getSnippet(b,"fs_precision")+"\n"+d;attribs=this.collectAttribs(c);a[g]=new pc.Shader(b,{attributes:attribs,vshader:c,fshader:d});return a[g]};return{shaderChunks:e}}());pc.extend(pc,function(){var e=null;return{drawQuadWithShader:function(a,b,c){if(null==e){var d=new pc.VertexFormat(a,[{semantic:pc.SEMANTIC_POSITION,components:2,type:pc.ELEMENTTYPE_FLOAT32}]);e=new pc.VertexBuffer(a,d,4);d=new pc.VertexIterator(e);d.element[pc.SEMANTIC_POSITION].set(-1,-1);d.next();d.element[pc.SEMANTIC_POSITION].set(1,-1);d.next();d.element[pc.SEMANTIC_POSITION].set(-1,1);d.next();d.element[pc.SEMANTIC_POSITION].set(1,1);d.end()}a.setRenderTarget(b);a.updateBegin();d=null!==b?b.width:
a.width;b=null!==b?b.height:a.height;a.setViewport(0,0,d,b);a.setScissor(0,0,d,b);b=a.getDepthTest();d=a.getDepthWrite();a.setDepthTest(!1);a.setDepthWrite(!1);a.setVertexBuffer(e,0);a.setShader(c);a.draw({type:pc.PRIMITIVE_TRISTRIP,base:0,count:4,indexed:!1});a.setDepthTest(b);a.setDepthWrite(d);a.updateEnd()}}}());pc.extend(pc,function(){function e(){for(var a=Date.now()+10;Date.now()<a;);}function a(a,c,d){var g=c._colorBuffer;if(g.format==pc.PIXELFORMAT_R8_G8_B8_A8){var e=new Uint8Array(4*g.width*g.height),a=a.gl;a.bindFramebuffer(a.FRAMEBUFFER,c._glFrameBuffer);a.readPixels(0,0,g.width,g.height,a.RGBA,a.UNSIGNED_BYTE,e);g._levels||(g._levels=[]);g._levels[0]||(g._levels[0]=[]);g._levels[0][d]=e}}return{prefilterCubemap:function(b){var c=b.device,d=b.sourceCubemap,g=b.method,f=b.samples,k=b.cpuSync,m=b.chromeFix,
h=pc.shaderChunks,f=h.createShaderFromCode(c,h.fullscreenQuadVS,h.rgbmPS+h.prefilterCubemapPS.replace(/\$METHOD/g,0===g?"cos":"phong").replace(/\$NUMSAMPLES/g,f),"prefilter"+g+""+f),n=h.createShaderFromCode(c,h.fullscreenQuadVS,h.outputCubemapPS),l=c.scope.resolve("source"),r=c.scope.resolve("params"),v=new pc.Vec4,s=d.width,C=d.rgbm,x=d.format,u=[[],b.filteredFixed,b.filteredRgbm,b.filteredFixedRgbm],w=0===g?[0.9,0.85,0.7,0.4,0.25]:[512,128,32,8,2],B=[64,32,16,8,4],h=5,y,A,F;if(x===pc.PIXELFORMAT_R8_G8_B8&&
k){var x=pc.PIXELFORMAT_R8_G8_B8_A8,J=new pc.gfx.Texture(c,{cubemap:!0,rgbm:C,format:x,width:s,height:s,autoMipmap:!1});J.minFilter=pc.FILTER_LINEAR;J.magFilter=pc.FILTER_LINEAR;J.addressU=pc.ADDRESS_CLAMP_TO_EDGE;J.addressV=pc.ADDRESS_CLAMP_TO_EDGE;for(F=0;6>F;F++)y=new pc.RenderTarget(c,J,{face:F,depth:!1}),v.x=F,v.y=0,l.setValue(d),r.setValue(v.data),m&&e(),pc.drawQuadWithShader(c,y,n),a(c,y,F);d=J}if(128<s){A=Math.round(Math.log2(128));var N=Math.round(Math.log2(s))-A;for(A=0;A<N;A++){var s=0.5*
d.width,G=0===g?1:Math.pow(2,Math.round(Math.log2(w[0])+2*(N-A))),J=new pc.gfx.Texture(c,{cubemap:!0,rgbm:C,format:x,width:s,height:s,autoMipmap:!1});J.minFilter=pc.FILTER_LINEAR;J.magFilter=pc.FILTER_LINEAR;J.addressU=pc.ADDRESS_CLAMP_TO_EDGE;J.addressV=pc.ADDRESS_CLAMP_TO_EDGE;for(F=0;6>F;F++)y=new pc.RenderTarget(c,J,{face:F,depth:!1}),v.x=F,v.y=G,v.z=s,v.w=0,l.setValue(d),r.setValue(v.data),m&&e(),pc.drawQuadWithShader(c,y,n),A===N-1&&k&&a(c,y,F);d=J}}b.sourceCubemap=d;J=null;if(!C&&b.filteredFixedRgbm){J=
new pc.gfx.Texture(c,{cubemap:!0,rgbm:!0,format:pc.PIXELFORMAT_R8_G8_B8_A8,width:s,height:s,autoMipmap:!1});J.minFilter=pc.FILTER_LINEAR;J.magFilter=pc.FILTER_LINEAR;J.addressU=pc.ADDRESS_CLAMP_TO_EDGE;J.addressV=pc.ADDRESS_CLAMP_TO_EDGE;for(F=0;6>F;F++)y=new pc.RenderTarget(c,J,{face:F,depth:!1}),v.x=F,v.w=2,l.setValue(d),r.setValue(v.data),m&&e(),pc.drawQuadWithShader(c,y,n),a(c,y,F)}s=0===g?1:2048;y=0===g?0:-1;u[y]=[];for(A=0;A<h;A++)for(n=y;n<u.length;n++)null!=u[n]&&(u[n][A]=new pc.gfx.Texture(c,
{cubemap:!0,rgbm:2>n?C:!0,format:2>n?x:pc.PIXELFORMAT_R8_G8_B8_A8,fixCubemapSeams:1===n||3===n,width:B[A],height:B[A],autoMipmap:!1}),u[n][A].minFilter=pc.FILTER_LINEAR,u[n][A].magFilter=pc.FILTER_LINEAR,u[n][A].addressU=pc.ADDRESS_CLAMP_TO_EDGE,u[n][A].addressV=pc.ADDRESS_CLAMP_TO_EDGE);for(n=y;n<u.length;n++)if(null!=u[n])if(1<n&&C)u[n]=u[n-2];else for(A=0;A<h;A++)for(F=0;6>F;F++)y=new pc.RenderTarget(c,u[n][A],{face:F,depth:!1}),v.x=F,v.y=0>n?s:w[A],v.z=B[A],v.w=n,l.setValue(0===A?d:0===g?u[0][A-
1]:u[-1][A-1]),r.setValue(v.data),m&&e(),pc.drawQuadWithShader(c,y,f),k&&a(c,y,F);b.filtered=u[0];if(k&&b.singleFilteredFixed){h=[d,b.filteredFixed[0],b.filteredFixed[1],b.filteredFixed[2],b.filteredFixed[3],b.filteredFixed[4],b.filteredFixed[5]];d=new pc.gfx.Texture(c,{cubemap:!0,rgbm:C,fixCubemapSeams:!0,format:x,width:128,height:128,autoMipmap:!1});for(A=0;6>A;A++)d._levels[A]=h[A]._levels[0];d.upload();d.minFilter=pc.FILTER_LINEAR_MIPMAP_LINEAR;d.magFilter=pc.FILTER_LINEAR;d._prefilteredMips=
!0;b.singleFilteredFixed=d}if(k&&b.singlefilteredFixedRgbm&&b.filteredFixedRgbm){h=[J,b.filteredFixedRgbm[0],b.filteredFixedRgbm[1],b.filteredFixedRgbm[2],b.filteredFixedRgbm[3],b.filteredFixedRgbm[4],b.filteredFixedRgbm[5]];d=new pc.gfx.Texture(c,{cubemap:!0,rgbm:!0,fixCubemapSeams:!0,format:pc.PIXELFORMAT_R8_G8_B8_A8,width:128,height:128,autoMipmap:!1});for(A=0;6>A;A++)d._levels[A]=h[A]._levels[0];d.upload();d.minFilter=pc.FILTER_LINEAR_MIPMAP_LINEAR;d.magFilter=pc.FILTER_LINEAR;d._prefilteredMips=
!0;b.singlefilteredFixedRgbm=d}}}}());pc.shaderChunks.ambientPrefilteredCubeLodPS="void addAmbient(inout psInternalData data) {\n    vec3 fixedReflDir = fixSeamsStatic(data.normalW, 1.0 - 1.0 / 4.0);\n    fixedReflDir.x *= -1.0;\n    data.diffuseLight = $DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, 5.0) ).rgb;\n}\n\n";pc.shaderChunks.reflectionPrefilteredCubePS="uniform samplerCube texture_prefilteredCubeMap128;\nuniform samplerCube texture_prefilteredCubeMap64;\nuniform samplerCube texture_prefilteredCubeMap32;\nuniform samplerCube texture_prefilteredCubeMap16;\nuniform samplerCube texture_prefilteredCubeMap8;\nuniform samplerCube texture_prefilteredCubeMap4;\nuniform float material_reflectionFactor;\n\nvoid addReflection(inout psInternalData data) {\n\n    // Unfortunately, WebGL doesn't allow us using textureCubeLod. Therefore bunch of nasty workarounds is required.\n    // We fix mip0 to 128x128, so code is rather static.\n    // Mips smaller than 4x4 aren't great even for diffuse. Don't forget that we don't have bilinear filtering between different faces.\n\n    float bias = saturate(1.0 - data.glossiness) * 5.0; // multiply by max mip level\n    int index1 = int(bias);\n    int index2 = int(min(bias + 1.0, 7.0));\n\n    vec3 fixedReflDir = fixSeams(cubeMapProject(data.reflDirW), bias);\n    fixedReflDir.x *= -1.0;\n\n    vec4 cubes[6];\n    cubes[0] = textureCube(texture_prefilteredCubeMap128, fixedReflDir);\n    cubes[1] = textureCube(texture_prefilteredCubeMap64, fixedReflDir);\n    cubes[2] = textureCube(texture_prefilteredCubeMap32, fixedReflDir);\n    cubes[3] = textureCube(texture_prefilteredCubeMap16, fixedReflDir);\n    cubes[4] = textureCube(texture_prefilteredCubeMap8, fixedReflDir);\n    cubes[5] = textureCube(texture_prefilteredCubeMap4, fixedReflDir);\n\n    // Also we don't have dynamic indexing in PS, so...\n    vec4 cube[2];\n    for(int i = 0; i < 6; i++) {\n        if (i == index1) {\n            cube[0] = cubes[i];\n        }\n        if (i == index2) {\n            cube[1] = cubes[i];\n        }\n    }\n\n    // another variant\n    /*if (index1==0){ cube[0]=cubes[0];\n    }else if (index1==1){ cube[0]=cubes[1];\n    }else if (index1==2){ cube[0]=cubes[2];\n    }else if (index1==3){ cube[0]=cubes[3];\n    }else if (index1==4){ cube[0]=cubes[4];\n    }else if (index1==5){ cube[0]=cubes[5];}\n\n    if (index2==0){ cube[1]=cubes[0];\n    }else if (index2==1){ cube[1]=cubes[1];\n    }else if (index2==2){ cube[1]=cubes[2];\n    }else if (index2==3){ cube[1]=cubes[3];\n    }else if (index2==4){ cube[1]=cubes[4];\n    }else if (index2==5){ cube[1]=cubes[5];}*/\n\n    vec4 cubeFinal = mix(cube[0], cube[1], fract(bias));\n    vec3 refl = $DECODE(cubeFinal).rgb;\n\n    data.reflection += vec4(refl, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.normalMapPS="uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    data.normalW = data.TBN * normalMap;\n}\n\n";pc.shaderChunks.gamma2_2FastPS="vec3 gammaCorrectInput(vec3 color) {\n    return color * (color * (color * 0.305306011 + 0.682171111) + 0.012522878);\n}\n\nfloat gammaCorrectInput(float color) {\n    return color * (color * (color * 0.305306011 + 0.682171111) + 0.012522878);\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return vec4(gammaCorrectInput(color.rgb), color.a);\n}\n\nvec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    vec4 rgba = texture2D(tex, uv);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    vec4 rgba = textureCube(tex, uvw);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return pow(color, vec3(0.45));\n}\n\n";
pc.shaderChunks.particle_pointAlongVS="    angle = atan(velocityV.x, velocityV.y); // not the fastest way, but easier to plug in; TODO: create rot matrix right from vectors\n\n";pc.shaderChunks.glossConstPS="uniform float material_shininess;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = material_shininess;\n}\n\n";pc.shaderChunks.tonemappingFilmicPS="const float A =  0.15;\nconst float B =  0.50;\nconst float C =  0.10;\nconst float D =  0.20;\nconst float E =  0.02;\nconst float F =  0.30;\nconst float W =  11.2;\n\nuniform float exposure;\n\nvec3 uncharted2Tonemap(vec3 x) {\n   return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;\n}\n\nvec3 toneMap(vec3 color) {\n    color = uncharted2Tonemap(color * exposure);\n    vec3 whiteScale = 1.0 / uncharted2Tonemap(vec3(W,W,W));\n    color = color * whiteScale;\n\n    return color;\n}\n\n";
pc.shaderChunks.skyboxPS="varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvoid main(void) {\n    gl_FragColor = textureCube(texture_cubeMap, fixSeams(vViewDir));\n}\n\n";pc.shaderChunks.particleUpdaterAABBPS="uniform mat3 spawnBounds;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n    return emitterPos + spawnBounds * (inBounds - vec3(0.5));\n}\n\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n    localVelocity -= vec3(0, 0, initialVelocity);\n}\n\n";
pc.shaderChunks.uv1VS="\nvec2 getUv1(inout vsInternalData data) {\n    return vertex_texCoord1;\n}\n";pc.shaderChunks.particle_cpu_endVS="\n    localPos *= particle_vertexData2.y * emitterScale;\n    localPos += particlePos;\n\n    gl_Position = matrix_viewProjection * vec4(localPos, 1.0);\n}\n\n";pc.shaderChunks.normalVertexPS="void getNormal(inout psInternalData data) {\n    data.normalW = normalize(vNormalW);\n}\n\n";pc.shaderChunks.lightSpecularPhongPS="float getLightSpecular(inout psInternalData data) {\n    float specPow = data.glossiness;\n\n    specPow = antiAliasGlossiness(data, specPow);\n\n    // Hack: On Mac OS X, calling pow with zero for the exponent generates hideous artifacts so bias up a little\n    return pow(max(dot(data.reflDirW, -data.lightDirNormW), 0.0), specPow + 0.0001);\n}\n\n";
pc.shaderChunks.refractionPS="uniform float material_refraction, material_refractionIor;\n\nvec3 refract2(vec3 viewVec, vec3 Normal, float IOR) {\n    float vn = dot(viewVec, Normal);\n    float k = 1.0 - IOR * IOR * (1.0 - vn * vn);\n    vec3 refrVec = IOR * viewVec - (IOR * vn + sqrt(k)) * Normal;\n    return refrVec;\n}\n\nvoid addRefraction(inout psInternalData data) {\n\n    // use same reflection code with refraction vector\n    vec3 tmp = data.reflDirW;\n    vec4 tmp2 = data.reflection;\n    data.reflection = vec4(0.0);\n    data.reflDirW = refract2(-data.viewDirW, data.normalW, material_refractionIor);\n\n    addReflection(data);\n\n    data.diffuseLight = mix(data.diffuseLight, data.reflection.rgb * data.albedo, material_refraction);\n    data.reflDirW = tmp;\n    data.reflection = tmp2;\n}\n\n";
pc.shaderChunks.metalnessTexConstPS="uniform sampler2D texture_metalnessMap;\nuniform float material_metalness;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, texture2D(texture_metalnessMap, $UV).$CH * material_metalness);\n}\n\n";pc.shaderChunks.transformInstancedVS="mat4 getModelMatrix(inout vsInternalData data) {\n    return mat4(instance_line1, instance_line2, instance_line3, instance_line4);\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";
pc.shaderChunks.normalMapFloatPS="uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    normalMap = normalize(mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpMapFactor));\n    data.normalW = data.TBN * normalMap;\n}\n\n";pc.shaderChunks.combineDiffuseSpecularOldPS="vec3 combineColor(inout psInternalData data) {\n    return mix(data.albedo * data.diffuseLight + data.specularLight * data.specularity, data.reflection.rgb, data.reflection.a);\n}\n\n";
pc.shaderChunks.particleUpdaterStartPS="float saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec3 unpack3NFloats(float src) {\n    float r = fract(src);\n    float g = fract(src * 256.0);\n    float b = fract(src * 65536.0);\n    return vec3(r, g, b);\n}\n\nvec3 tex1Dlod_lerp(sampler2D tex, vec2 tc, out vec3 w) {\n    vec4 a = texture2D(tex, tc);\n    vec4 b = texture2D(tex, tc + graphSampleSize);\n    float c = fract(tc.x * graphNumSamples);\n\n    vec3 unpackedA = unpack3NFloats(a.w);\n    vec3 unpackedB = unpack3NFloats(b.w);\n    w = mix(unpackedA, unpackedB, c);\n\n    return mix(a.xyz, b.xyz, c);\n}\n\nvoid main(void)\n{\n    if (gl_FragCoord.x > numParticles) discard;\n    float outMask0 = gl_FragCoord.y < 1.0? 1.0 : 0.0;\n    float outMask1 = (gl_FragCoord.y < 2.0 && gl_FragCoord.y >= 1.0)? 1.0 : 0.0;\n    float outMask2 = (gl_FragCoord.y < 3.0 && gl_FragCoord.y >= 2.0)? 1.0 : 0.0;\n\n    vec4 tex = texture2D(particleTexIN, vec2(vUv0.x, 0.125));\n    vec4 tex2 = texture2D(particleTexIN, vec2(vUv0.x, 0.375));\n    vec4 texR = texture2D(particleTexIN, vec2(vUv0.x, 0.625));\n\n    vec4 rndFactor = texR;\n    float particleLifetime = lifetime;\n    float life = tex2.w + delta;\n    float particleRate = rate + rateDiv * rndFactor.x;\n\n        float nlife = clamp(life / particleLifetime, 0.0, 1.0);\n        vec3 localVelocityDiv;\n        vec3 velocityDiv;\n        vec3 paramDiv;\n        vec3 localVelocity = tex1Dlod_lerp(internalTex0, vec2(nlife, 0), localVelocityDiv);\n        vec3 velocity =      tex1Dlod_lerp(internalTex1, vec2(nlife, 0), velocityDiv);\n        vec3 params =        tex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n        float rotSpeed = params.x;\n        float rotSpeedDiv = paramDiv.y;\n\n        localVelocity +=    (localVelocityDiv * vec3(2.0) - vec3(1.0)) * localVelocityDivMult * rndFactor.xyz;\n        velocity +=         (velocityDiv * vec3(2.0) - vec3(1.0)) * velocityDivMult * rndFactor.zxy;\n        rotSpeed +=         (rotSpeedDiv * 2.0 - 1.0) * rotSpeedDivMult * rndFactor.y;\n\n        addInitialVelocity(localVelocity, rndFactor.xyz);\n\n        vec3 outVelocity = emitterMatrix * localVelocity.xyz + velocity.xyz * emitterScale;\n        vec3 outPosition = tex.xyz + outVelocity * delta;\n        float outRotation = tex.w + rotSpeed * delta;\n\n        bool respawn = life <= 0.0 || life > particleLifetime;\n        outPosition = respawn? calcSpawnPosition(rndFactor.xyz, rndFactor.x) : outPosition;\n        outRotation = respawn? mix(startAngle, startAngle2, rndFactor.x) : outRotation;\n        outVelocity = respawn? vec3(0.0) : outVelocity;\n\n";
pc.shaderChunks.opacityTexPS="uniform sampler2D texture_opacityMap;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = texture2D(texture_opacityMap, $UV).$CH;\n}\n\n";pc.shaderChunks.emissiveTexConstPS="uniform sampler2D texture_emissiveMap;\nuniform vec3 material_emissive;\nvec3 getEmission(inout psInternalData data) {\n    return $texture2DSAMPLE(texture_emissiveMap, $UV).$CH * material_emissive;\n}\n\n";pc.shaderChunks.normalVS="vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = matrix_normal;\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";
pc.shaderChunks.particle_stretchVS="    vec3 moveDir = particleVelocity * stretch;\n    vec3 posPrev = pos - moveDir;\n    posPrev += particlePosMoved;\n\n    vec2 centerToVertexV = normalize((mat3(matrix_view) * localPos).xy);\n\n    float interpolation = dot(-velocityV, centerToVertexV) * 0.5 + 0.5;\n\n    particlePos = mix(particlePos, posPrev, interpolation);\n\n";pc.shaderChunks.skyboxHDRPS="varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvoid main(void) {\n    vec3 color = $textureCubeSAMPLE(texture_cubeMap, fixSeams(vViewDir)).rgb;\n    color = toneMap(color);\n    color = gammaCorrectOutput(color);\n    gl_FragColor = vec4(color, 1.0);\n}\n\n";
pc.shaderChunks.reflectionPrefilteredCubeLodPS="#extension GL_EXT_shader_texture_lod : enable\n\nuniform samplerCube texture_prefilteredCubeMap128;\nuniform float material_reflectionFactor;\n\nvoid addReflection(inout psInternalData data) {\n\n    float bias = saturate(1.0 - data.glossiness) * 5.0; // multiply by max mip level\n    vec3 fixedReflDir = fixSeams(cubeMapProject(data.reflDirW), bias);\n    fixedReflDir.x *= -1.0;\n\n    vec3 refl = $DECODE( textureCubeLodEXT(texture_prefilteredCubeMap128, fixedReflDir, bias) ).rgb;\n\n    data.reflection += vec4(refl, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.reflectionSpherePS="uniform mat4 matrix_view;\nuniform sampler2D texture_sphereMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n\n    vec3 reflDirV = (mat3(matrix_view) * data.reflDirW).xyz;\n\n    float m = 2.0 * sqrt( dot(reflDirV.xy, reflDirV.xy) + (reflDirV.z+1.0)*(reflDirV.z+1.0) );\n    vec2 sphereMapUv = reflDirV.xy / m + 0.5;\n\n    data.reflection += vec4($texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb, material_reflectionFactor);\n}\n\n\n";
pc.shaderChunks.tonemappingNonePS="vec3 toneMap(vec3 color) {\n    return color;\n}\n\n";pc.shaderChunks.shadowVSPS="\nfloat getShadowHardVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    float depth = unpackFloat(texture2DProj(shadowMap, vMainShadowUv));\n    return (depth < min(vMainShadowUv.z + shadowParams.z, 1.0)) ? 0.0 : 1.0;\n}\n\nfloat getShadowMaskVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return unpackMask(texture2DProj(shadowMap, vMainShadowUv));\n}\n\nfloat getShadowPCF3x3VS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    data.shadowCoord = vMainShadowUv.xyz;\n    data.shadowCoord.z += shadowParams.z;\n    data.shadowCoord.xyz /= vMainShadowUv.w;\n    data.shadowCoord.z = min(data.shadowCoord.z, 1.0);\n    return _getShadowPCF3x3(data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3_YZWVS(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    data.shadowCoord = vMainShadowUv.xyz;\n    data.shadowCoord.z += shadowParams.z;\n    data.shadowCoord.xyz /= vMainShadowUv.w;\n    data.shadowCoord.z = min(data.shadowCoord.z, 1.0);\n    return _getShadowPCF3x3_YZW(data, shadowMap, shadowParams);\n}\n\n";
pc.shaderChunks.particle_lambertPS="\n    vec3 negNormal = max(normal, vec3(0.0));\n    vec3 posNormal = max(-normal, vec3(0.0));\n\n\n";pc.shaderChunks.viewNormalVS="\nuniform mat4 matrix_view;\nvec3 getViewNormal(inout vsInternalData data) {\n    return mat3(matrix_view) * vNormalW;\n}\n";pc.shaderChunks.packDepthPS="// Packing a float in GLSL with multiplication and mod\n// http://blog.gradientstudios.com/2012/08/23/shadow-map-improvement\nvec4 packFloat(float depth) {\n    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\n    // combination of mod and multiplication and division works better\n    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n    res -= res.xxyz * bit_mask;\n    return res;\n}\n\n\n";
pc.shaderChunks.basePS="\nuniform vec3 view_position;\n\nuniform vec3 light_globalAmbient;\n\nstruct psInternalData {\n    vec3 albedo;\n    vec3 specularity;\n    float glossiness;\n    vec3 emission;\n    vec3 normalW;\n    mat3 TBN;\n    vec3 viewDirW;\n    vec3 reflDirW;\n    vec3 diffuseLight;\n    vec3 specularLight;\n    vec4 reflection;\n    float alpha;\n    vec3 lightDirNormW;\n    vec3 lightDirW;\n    vec3 lightPosW;\n    float atten;\n    vec3 shadowCoord;\n    vec2 uvOffset;\n    vec3 normalMap;\n    float ao;\n};\n\nvoid getViewDir(inout psInternalData data) {\n    data.viewDirW = normalize(view_position - vPositionW);\n}\n\nvoid getReflDir(inout psInternalData data) {\n    data.reflDirW = normalize(-reflect(data.viewDirW, data.normalW));\n}\n\nvoid getLightDirPoint(inout psInternalData data, vec3 lightPosW) {\n    data.lightDirW = vPositionW - lightPosW;\n    data.lightDirNormW = normalize(data.lightDirW);\n    data.lightPosW = lightPosW;\n}\n\nfloat getFalloffLinear(inout psInternalData data, float lightRadius) {\n    float d = length(data.lightDirW);\n    return max(((lightRadius - d) / lightRadius), 0.0);\n}\n\nfloat square(float x) {\n    return x*x;\n}\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat getFalloffInvSquared(inout psInternalData data, float lightRadius) {\n    float sqrDist = dot(data.lightDirW, data.lightDirW);\n    float falloff = 1.0 / (sqrDist + 1.0);\n    float invRadius = 1.0 / lightRadius;\n\n    falloff *= 16.0;\n    falloff *= square( saturate( 1.0 - square( sqrDist * square(invRadius) ) ) );\n\n    return falloff;\n}\n\nfloat getSpotEffect(inout psInternalData data, vec3 lightSpotDirW, float lightInnerConeAngle, float lightOuterConeAngle) {\n    float cosAngle = dot(data.lightDirNormW, lightSpotDirW);\n    return smoothstep(lightOuterConeAngle, lightInnerConeAngle, cosAngle);\n}\n\nvoid processMetalness(inout psInternalData data, float metalness) {\n    const float dielectricF0 = 0.04;\n    data.specularity = mix(vec3(dielectricF0), data.albedo, metalness);\n    data.albedo *= 1.0 - metalness;\n}\n\n";
pc.shaderChunks.transformSkinnedVS="mat4 getModelMatrix(inout vsInternalData data) {\n    return             vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz / posW.w;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";
pc.shaderChunks.particle_lightingPS="\n    vec3 light = negNormal.x*lightCube[0] + posNormal.x*lightCube[1] +\n                        negNormal.y*lightCube[2] + posNormal.y*lightCube[3] +\n                        negNormal.z*lightCube[4] + posNormal.z*lightCube[5];\n\n\n    rgb *= light;\n\n\n";pc.shaderChunks.particle_blendMultiplyPS="\n    rgb = mix(vec3(1.0), rgb, vec3(a));\n    if (rgb.r + rgb.g + rgb.b > 2.99) discard;\n\n";pc.shaderChunks.particleUpdaterEndPS="\n   tex = vec4(outPosition, outRotation) * outMask0 +\n          vec4(outVelocity, life) * outMask1 +\n          texR * outMask2;\n\n    gl_FragColor = tex;\n}\n\n";
pc.shaderChunks.skyboxPrefilteredCubePS="varying vec3 vViewDir;\nuniform samplerCube texture_cubeMap;\n\nvec3 fixSeamsStretch(vec3 vec, float mipmapIndex, float cubemapSize) {\n    float scale = 1.0 - exp2(mipmapIndex) / cubemapSize;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvoid main(void) {\n    vec3 color = textureCubeRGBM(texture_cubeMap, fixSeamsStretch(vViewDir, 0.0, 128.0));\n    color = toneMap(color);\n    color = gammaCorrectOutput(color);\n    gl_FragColor = vec4(color, 1.0);\n}\n\n";
pc.shaderChunks.particle_normalMapPS="\n    vec3 normalMap         = normalize( texture2D(normalMap, texCoordsAlphaLife.xy).xyz * 2.0 - 1.0 );\n    vec3 normal = ParticleMat * normalMap;\n\n\n\n\n";pc.shaderChunks.particleVS="attribute vec4 particle_vertexData; // XYZ = particle position, W = particle ID + random factor\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\nuniform mat4 matrix_view;\n\nuniform float numParticles, numParticlesPot;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nuniform float stretch;\nuniform vec3 wrapBounds;\nuniform vec3 emitterScale;\nuniform float rate, rateDiv, lifetime, deltaRandomnessStatic, scaleDivMult, alphaDivMult, seed;\nuniform sampler2D particleTexOUT, particleTexIN;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nvarying vec4 texCoordsAlphaLife;\n\nvec3 unpack3NFloats(float src) {\n    float r = fract(src);\n    float g = fract(src * 256.0);\n    float b = fract(src * 65536.0);\n    return vec3(r, g, b);\n}\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec4 tex1Dlod_lerp(sampler2D tex, vec2 tc) {\n    return mix( texture2D(tex,tc), texture2D(tex,tc + graphSampleSize), fract(tc.x*graphNumSamples) );\n}\n\nvec4 tex1Dlod_lerp(sampler2D tex, vec2 tc, out vec3 w) {\n    vec4 a = texture2D(tex,tc);\n    vec4 b = texture2D(tex,tc + graphSampleSize);\n    float c = fract(tc.x*graphNumSamples);\n\n    vec3 unpackedA = unpack3NFloats(a.w);\n    vec3 unpackedB = unpack3NFloats(b.w);\n    w = mix(unpackedA, unpackedB, c);\n\n    return mix(a, b, c);\n}\n\n\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix) {\n    float c = cos(pRotation);\n    float s = sin(pRotation);\n\n    mat2 m = mat2(c, -s, s, c);\n    rotMatrix = m;\n\n    return m * quadXY;\n}\n\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY, out mat3 localMat) {\n    vec3 viewUp = matrix_viewInverse[1].xyz;\n    vec3 posCam = matrix_viewInverse[3].xyz;\n\n    mat3 billMat;\n    billMat[2] = normalize(InstanceCoords - posCam);\n    billMat[0] = normalize(cross(viewUp, billMat[2]));\n    billMat[1] = -viewUp;\n    vec3 pos = billMat * vec3(quadXY, 0);\n\n    localMat = billMat;\n\n    return pos;\n}\n\nvoid main(void) {\n    vec3 meshLocalPos = particle_vertexData.xyz;\n    float id = floor(particle_vertexData.w);\n\n    float rndFactor = fract(sin(id + 1.0 + seed));\n    vec3 rndFactor3 = vec3(rndFactor, fract(rndFactor*10.0), fract(rndFactor*100.0));\n\n    vec4 particleTex = texture2D(particleTexOUT, vec2(id / numParticlesPot, 0.125));\n    vec3 pos = particleTex.xyz;\n    float angle = particleTex.w;\n\n    vec4 particleTex2 = texture2D(particleTexOUT, vec2(id / numParticlesPot, 0.375));\n    vec3 particleVelocity = particleTex2.xyz;\n    vec2 velocityV = normalize((mat3(matrix_view) * particleVelocity).xy); // should be removed by compiler if align/stretch is not used\n    float life = particleTex2.w;\n\n    float particleLifetime = lifetime;\n\n    if (life <= 0.0 || life > particleLifetime) meshLocalPos = vec3(0.0);\n    vec2 quadXY = meshLocalPos.xy;\n    float nlife = clamp(life / particleLifetime, 0.0, 1.0);\n\n    vec3 paramDiv;\n    vec4 params = tex1Dlod_lerp(internalTex2, vec2(nlife, 0), paramDiv);\n    float scale = params.y;\n    float scaleDiv = paramDiv.x;\n    float alphaDiv = paramDiv.z;\n\n    scale += (scaleDiv * 2.0 - 1.0) * scaleDivMult * fract(rndFactor*10000.0);\n\n    texCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5,    (alphaDiv * 2.0 - 1.0) * alphaDivMult * fract(rndFactor*1000.0),    nlife);\n\n    vec3 particlePos = pos;\n    vec3 particlePosMoved = vec3(0.0);\n\n    mat2 rotMatrix;\n    mat3 localMat;\n\n\n";
pc.shaderChunks.normalXYPS="vec3 unpackNormal(vec4 nmap) {\n    vec3 normal;\n    normal.xy = nmap.wy * 2.0 - 1.0;\n    normal.z = sqrt(1.0 - saturate(dot(normal.xy, normal.xy)));\n    return normal;\n}\n\n";pc.shaderChunks.outputCubemapPS="varying vec2 vUv0;\n\nuniform samplerCube source;\nuniform vec4 params;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nvec4 encodeRGBM(vec4 color) { // modified RGBM\n    color.rgb = pow(color.rgb, vec3(0.5));\n    color.rgb *= 1.0 / 8.0;\n\n    color.a = saturate( max( max( color.r, color.g ), max( color.b, 1.0 / 255.0 ) ) );\n    color.a = ceil(color.a * 255.0) / 255.0;\n\n    color.rgb /= color.a;\n    return color;\n}\n\nvoid main(void) {\n\n    vec2 st = vUv0 * 2.0 - 1.0;\n    float face = params.x;\n\n    vec3 vec;\n    if (face==0.0) {\n        vec = vec3(1, -st.y, -st.x);\n    } else if (face==1.0) {\n        vec = vec3(-1, -st.y, st.x);\n    } else if (face==2.0) {\n        vec = vec3(st.x, 1, st.y);\n    } else if (face==3.0) {\n        vec = vec3(st.x, -1, -st.y);\n    } else if (face==4.0) {\n        vec = vec3(st.x, -st.y, 1);\n    } else {\n        vec = vec3(-st.x, -st.y, -1);\n    }\n\n    gl_FragColor = textureCube(source, vec);\n    if (params.w >= 2.0) gl_FragColor = encodeRGBM(gl_FragColor);\n}\n\n";
pc.shaderChunks.normalXYZPS="vec3 unpackNormal(vec4 nmap) {\n    return nmap.xyz * 2.0 - 1.0;\n}\n\n";pc.shaderChunks.metalnessConstPS="uniform float material_metalness;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, material_metalness);\n}\n\n";pc.shaderChunks.reflectionSphereLowPS="uniform sampler2D texture_sphereMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n\n    vec3 reflDirV = vNormalV;\n\n    vec2 sphereMapUv = reflDirV.xy * 0.5 + 0.5;\n    data.reflection += vec4($texture2DSAMPLE(texture_sphereMap, sphereMapUv).rgb, material_reflectionFactor);\n}\n\n";
pc.shaderChunks.parallaxPS="uniform sampler2D texture_heightMap;\nuniform float material_heightMapFactor;\nvoid getParallax(inout psInternalData data) {\n    float parallaxScale = material_heightMapFactor;\n    const float parallaxBias = 0.01;\n\n    float height = texture2D(texture_heightMap, $UV).r * parallaxScale - parallaxBias;\n    vec3 viewDirT = data.viewDirW * data.TBN;\n\n    data.uvOffset = min(height * viewDirT.xy, vec2(parallaxBias));\n}\n\n";pc.shaderChunks.particle_blendNormalPS="\n    if (a < 0.01) discard;\n";
pc.shaderChunks.specularAaToksvigPS="float antiAliasGlossiness(inout psInternalData data, float power) {\n    float rlen = 1.0 / saturate(length(data.normalMap));\n    float toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n    return power * toksvig;\n}\n\n";pc.shaderChunks.emissiveConstPS="uniform vec3 material_emissive;\nvec3 getEmission(inout psInternalData data) {\n    return material_emissive;\n}\n\n";pc.shaderChunks.TBNfastPS="void getTBN(inout psInternalData data) {\n    data.TBN = mat3((vTangentW), (vBinormalW), (vNormalW));\n}\n\n";
pc.shaderChunks.gamma2_2PS="vec3 gammaCorrectInput(vec3 color) {\n    return pow(color, vec3(2.2));\n}\n\nfloat gammaCorrectInput(float color) {\n    return pow(color, 2.2);\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\n\nvec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    vec4 rgba = texture2D(tex, uv);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    vec4 rgba = textureCube(tex, uvw);\n    rgba.rgb = gammaCorrectInput(rgba.rgb);\n    return rgba;\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return pow(color, vec3(0.45));\n}\n\n";
pc.shaderChunks.particle_blendAddPS="\n    rgb *= gammaCorrectInput(a);\n    if ((rgb.r + rgb.g + rgb.b) < 0.000001) discard;\n\n";pc.shaderChunks.startVS="\nvoid main(void) {\n    vsInternalData data;\n\n    gl_Position = getPosition(data);\n";pc.shaderChunks.normalSkinnedVS="vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = mat3(data.modelMatrix[0].xyz, data.modelMatrix[1].xyz, data.modelMatrix[2].xyz);\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";
pc.shaderChunks.fresnelComplexPS="// More physically-based Fresnel\nuniform float material_fresnelFactor; // should be IOR\nvoid getFresnel(inout psInternalData data) {\n    float cosThetaI = max(dot(data.normalW, data.viewDirW), 0.0);\n    float n = material_fresnelFactor;\n\n    float cosThetaT = sqrt(max(0.0, 1.0 - (1.0 - cosThetaI * cosThetaI) / (n * n)));\n    float nCosThetaT = n * cosThetaT;\n    float nCosThetaI = n * cosThetaI;\n\n    float rS = abs((cosThetaI - nCosThetaT) / (cosThetaI + nCosThetaT));\n    float rP = abs((cosThetaT - nCosThetaI) / (cosThetaT + nCosThetaI));\n    rS *= rS;\n    rP *= rP;\n\n    data.specularity *= (rS + rP) / 2.0;\n}\n\n";
pc.shaderChunks.particleUpdaterRespawnPS="    life = life > particleLifetime? -particleRate * gl_FragCoord.x : life;\n\n";pc.shaderChunks.opacityConstPS="uniform float material_opacity;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = material_opacity;\n}\n\n";pc.shaderChunks.baseVS="\nattribute vec3 vertex_position;\nattribute vec3 vertex_normal;\nattribute vec4 vertex_tangent;\nattribute vec2 vertex_texCoord0;\nattribute vec2 vertex_texCoord1;\nattribute vec4 vertex_color;\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat3 matrix_normal;\n\nstruct vsInternalData {\n    vec3 positionW;\n    mat4 modelMatrix;\n    mat3 normalMatrix;\n    vec3 lightPosW;\n    vec3 lightDirNormW;\n    vec3 normalW;\n};\n\n";
pc.shaderChunks.ambientPrefilteredCubePS="void addAmbient(inout psInternalData data) {\n    vec3 fixedReflDir = fixSeamsStatic(data.normalW, 1.0 - 1.0 / 4.0);\n    fixedReflDir.x *= -1.0;\n    data.diffuseLight = $DECODE(textureCube(texture_prefilteredCubeMap4, fixedReflDir)).rgb;\n}\n\n";pc.shaderChunks.particle_wrapVS="\n    vec3 origParticlePos = particlePos;\n    particlePos -= matrix_model[3].xyz;\n    particlePos = mod(particlePos, wrapBounds) - wrapBounds * 0.5;\n    particlePos += matrix_model[3].xyz;\n    particlePosMoved = particlePos - origParticlePos;\n\n\n";
pc.shaderChunks.combineDiffuseSpecularPS="vec3 combineColor(inout psInternalData data) {\n    return mix(data.albedo * data.diffuseLight, data.specularLight + data.reflection.rgb * data.reflection.a, data.specularity);\n}\n\n";pc.shaderChunks.normalInstancedVS="vec3 getNormal(inout vsInternalData data) {\n    data.normalMatrix = mat3(instance_line1.xyz, instance_line2.xyz, instance_line3.xyz);\n    return normalize(data.normalMatrix * vertex_normal);\n}\n\n";pc.shaderChunks.glossTexConstPS="uniform sampler2D texture_glossMap;\nuniform float material_shininess;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = material_shininess * texture2D(texture_glossMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.fresnelSchlickPS="// Schlick's approximation\nuniform float material_fresnelFactor; // unused\nvoid getFresnel(inout psInternalData data) {\n    float fresnel = 1.0 - max(dot(data.normalW, data.viewDirW), 0.0);\n    float fresnel2 = fresnel * fresnel;\n    fresnel *= fresnel2 * fresnel2;\n    fresnel *= data.glossiness * data.glossiness;\n    data.specularity = data.specularity + (1.0 - data.specularity) * fresnel;\n}\n\n";pc.shaderChunks.diffuseConstPS="uniform vec3 material_diffuse;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = material_diffuse.rgb;\n}\n\n";
pc.shaderChunks.particle_normalVS="\n    Normal = normalize(localPos - localMat[2]);\n\n\n";pc.shaderChunks.combineDiffuseSpecularNoConservePS="vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight + (data.specularLight + data.reflection.rgb * data.reflection.a) * data.specularity;\n}\n\n";pc.shaderChunks.uv0VS="\nvec2 getUv0(inout vsInternalData data) {\n    return vertex_texCoord0;\n}\n";pc.shaderChunks.emissiveTexPS="uniform sampler2D texture_emissiveMap;\nvec3 getEmission(inout psInternalData data) {\n    return $texture2DSAMPLE(texture_emissiveMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.tonemappingLinearPS="uniform float exposure;\nvec3 toneMap(vec3 color) {\n    return color * exposure;\n}\n\n";pc.shaderChunks.specularAaNonePS="float antiAliasGlossiness(inout psInternalData data, float power) {\n    return power;\n}\n\n";pc.shaderChunks.specularAaToksvigFloatPS="float antiAliasGlossiness(inout psInternalData data, float power) {\n    float rlen = 1.0 / saturate(length(data.normalMap));\n    float toksvig = 1.0 / (1.0 + power * (rlen - 1.0));\n    return power * mix(1.0, toksvig, material_bumpMapFactor);\n}\n\n";
pc.shaderChunks.prefilterCubemapPS="varying vec2 vUv0;\n\nuniform samplerCube source;\nuniform vec4 params;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat rnd(vec2 uv) {\n    return fract(sin(dot(uv, vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\n\nconst float PI = 3.14159265358979;\nvec3 hemisphereSample_cos(vec2 uv, mat3 vecSpace, vec3 cubeDir, float gloss) { // cos + lerped cone size (better than just lerped)\n    float phi = uv.y * 2.0 * PI;\n    float cosTheta = sqrt(1.0 - uv.x);\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n    return normalize(mix(vecSpace * sampleDir, cubeDir, params.y));\n}\n\nvec3 hemisphereSample_phong(vec2 uv, mat3 vecSpace, vec3 cubeDir, float specPow) {\n    float phi = uv.y * 2.0 * PI;\n    float cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n    float sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n    vec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n    return vecSpace * sampleDir;\n}\n\nmat3 matrixFromVector(vec3 n) { // frisvad\n    float a = 1.0 / (1.0 + n.z);\n    float b = -n.x * n.y * a;\n    vec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n    vec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n    return mat3(b1, b2, n);\n}\n\nvec4 encodeRGBM(vec4 color) { // modified RGBM\n    color.rgb = pow(color.rgb, vec3(0.5));\n    color.rgb *= 1.0 / 8.0;\n\n    color.a = saturate( max( max( color.r, color.g ), max( color.b, 1.0 / 255.0 ) ) );\n    color.a = ceil(color.a * 255.0) / 255.0;\n\n    color.rgb /= color.a;\n    return color;\n}\n\nvoid main(void) {\n\n    vec2 st = vUv0 * 2.0 - 1.0;\n\n    if (params.w==1.0 || params.w==3.0) {\n        st = 2.0 * floor(gl_FragCoord.xy) / (params.z - 1.0) - 1.0;\n    }\n\n    float face = params.x;\n\n    vec3 vec;\n    if (face==0.0) {\n        vec = vec3(1, -st.y, -st.x);\n    } else if (face==1.0) {\n        vec = vec3(-1, -st.y, st.x);\n    } else if (face==2.0) {\n        vec = vec3(st.x, 1, st.y);\n    } else if (face==3.0) {\n        vec = vec3(st.x, -1, -st.y);\n    } else if (face==4.0) {\n        vec = vec3(st.x, -st.y, 1);\n    } else {\n        vec = vec3(-st.x, -st.y, -1);\n    }\n\n    mat3 vecSpace = matrixFromVector(normalize(vec));\n\n    vec4 color = vec4(0.0);\n    const int samples = $NUMSAMPLES;\n    vec3 vect;\n    for(int i=0; i<samples; i++) {\n        float sini = sin(float(i));\n        float cosi = cos(float(i));\n        float rand = rnd(vec2(sini, cosi));\n\n        vect = hemisphereSample_$METHOD(vec2(float(i) / float(samples), rand), vecSpace, vec, params.y);\n\n        color += textureCube(source, vect);\n    }\n    color /= float(samples);\n\n    gl_FragColor = params.w < 2.0? color : encodeRGBM(color);\n}\n";
pc.shaderChunks.cubeMapProjectBoxPS="uniform vec3 envBoxMin, envBoxMax;\n\nvec3 cubeMapProject(vec3 nrdir) {\n    vec3 rbmax = (envBoxMax - vPositionW) / nrdir;\n    vec3 rbmin = (envBoxMin - vPositionW) / nrdir;\n\n    vec3 rbminmax;\n    rbminmax.x = nrdir.x>0.0? rbmax.x : rbmin.x;\n    rbminmax.y = nrdir.y>0.0? rbmax.y : rbmin.y;\n    rbminmax.z = nrdir.z>0.0? rbmax.z : rbmin.z;\n\n    float fa = min(min(rbminmax.x, rbminmax.y), rbminmax.z);\n\n    vec3 posonbox = vPositionW + nrdir * fa;\n    vec3 envBoxPos = (envBoxMin + envBoxMax) * 0.5;\n    return posonbox - envBoxPos;\n}\n\n";
pc.shaderChunks.fixCubemapSeamsStretchPS="vec3 fixSeams(vec3 vec, float mipmapIndex) {\n    float scale = 1.0 - exp2(mipmapIndex) / 128.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvec3 fixSeams(vec3 vec) {\n    float scale = 1.0 - 1.0 / 128.0;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n    float scale = invRecMipSize;\n    float M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\n    if (abs(vec.x) != M) vec.x *= scale;\n    if (abs(vec.y) != M) vec.y *= scale;\n    if (abs(vec.z) != M) vec.z *= scale;\n    return vec;\n}\n\n";
pc.shaderChunks.opacityTexConstPS="uniform sampler2D texture_opacityMap;\nuniform float material_opacity;\nvoid getOpacity(inout psInternalData data) {\n    data.alpha = texture2D(texture_opacityMap, $UV).$CH * material_opacity;\n}\n\n";pc.shaderChunks.combineDiffuseSpecularNoReflSeparateAmbientPS="uniform vec3 material_ambient;\nvec3 combineColor(inout psInternalData data) {\n    return (data.diffuseLight - light_globalAmbient) * data.albedo + data.specularLight * data.specularity + material_ambient * light_globalAmbient;\n}\n\n";
pc.shaderChunks.tangentBinormalVS="\nvec3 getTangent(inout vsInternalData data) {\n    return normalize(data.normalMatrix * vertex_tangent.xyz);\n}\n\nvec3 getBinormal(inout vsInternalData data) {\n    return cross(vNormalW, vTangentW) * vertex_tangent.w;\n}\n\n";pc.shaderChunks.specularTexPS="uniform sampler2D texture_specularMap;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = texture2D(texture_specularMap, $UV).$CH;\n}\n\n";pc.shaderChunks.particle_TBNVS="\n    mat3 rot3 = mat3(rotMatrix[0][0], rotMatrix[0][1], 0.0,        rotMatrix[1][0], rotMatrix[1][1], 0.0,        0.0, 0.0, 1.0);\n    localMat[2] *= -1.0;\n    ParticleMat = localMat * rot3;\n\n\n\n\n";
pc.shaderChunks.normalMapFloatTBNfastPS="uniform sampler2D texture_normalMap;\nuniform float material_bumpMapFactor;\nvoid getNormal(inout psInternalData data) {\n    vec3 normalMap = unpackNormal(texture2D(texture_normalMap, $UV));\n    data.normalMap = normalMap;\n    normalMap = mix(vec3(0.0, 0.0, 1.0), normalMap, material_bumpMapFactor);\n    data.normalW = normalize(data.TBN * normalMap);\n}\n\n";pc.shaderChunks.fresnelSimplePS="// Easily tweakable but not very correct Fresnel\nuniform float material_fresnelFactor;\nvoid getFresnel(inout psInternalData data) {\n    float fresnel = 1.0 - max(dot(data.normalW, data.viewDirW), 0.0);\n    data.specularity *= pow(fresnel, material_fresnelFactor);\n}\n\n";
pc.shaderChunks.fixCubemapSeamsNonePS="vec3 fixSeams(vec3 vec, float mipmapIndex) {\n    return vec;\n}\n\nvec3 fixSeams(vec3 vec) {\n    return vec;\n}\n\nvec3 fixSeamsStatic(vec3 vec, float invRecMipSize) {\n    return vec;\n}\n";pc.shaderChunks.particle_cpuVS="attribute vec4 particle_vertexData;     // XYZ = world pos, W = life\nattribute vec4 particle_vertexData2;     // X = angle, Y = scale, Z = alpha, W = velocity.x\nattribute vec4 particle_vertexData3;     // XYZ = particle local pos, W = velocity.y\nattribute vec2 particle_vertexData4;     // X = velocity.z, W = particle ID\n\nuniform mat4 matrix_viewProjection;\nuniform mat4 matrix_model;\nuniform mat4 matrix_view;\nuniform mat3 matrix_normal;\nuniform mat4 matrix_viewInverse;\n\nuniform float numParticles;\nuniform float lifetime;\nuniform float stretch;\n//uniform float graphSampleSize;\n//uniform float graphNumSamples;\nuniform vec3 wrapBounds, emitterScale;\nuniform sampler2D texLifeAndSourcePosOUT;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nvarying vec4 texCoordsAlphaLife;\n\n\nvec2 rotate(vec2 quadXY, float pRotation, out mat2 rotMatrix)\n{\n    float c = cos(pRotation);\n    float s = sin(pRotation);\n    //vec4 rotationMatrix = vec4(c, -s, s, c);\n\n    mat2 m = mat2(c, -s, s, c);\n    rotMatrix = m;\n\n    return m * quadXY;\n}\n\nvec3 billboard(vec3 InstanceCoords, vec2 quadXY, out mat3 localMat)\n{\n    vec3 viewUp = matrix_viewInverse[1].xyz;\n    vec3 posCam = matrix_viewInverse[3].xyz;\n\n    mat3 billMat;\n    billMat[2] = normalize(InstanceCoords - posCam);\n    billMat[0] = normalize(cross(viewUp, billMat[2]));\n    billMat[1] = -viewUp;\n    vec3 pos = billMat * vec3(quadXY, 0);\n\n    localMat = billMat;\n\n    return pos;\n}\n\n\nvoid main(void)\n{\n    vec3 particlePos = particle_vertexData.xyz;\n    vec3 pos = particlePos;\n    vec3 vertPos = particle_vertexData3.xyz;\n    vec3 particleVelocity = vec3(particle_vertexData2.w, particle_vertexData3.w, particle_vertexData4.x);\n    vec2 velocityV = normalize((mat3(matrix_view) * particleVelocity).xy); // should be removed by compiler if align/stretch is not used\n\n    vec2 quadXY = vertPos.xy;\n    texCoordsAlphaLife = vec4(quadXY * -0.5 + 0.5, particle_vertexData2.z, particle_vertexData.w);\n\n    mat2 rotMatrix;\n    mat3 localMat;\n\n    float angle = particle_vertexData2.x;\n    vec3 particlePosMoved = vec3(0.0);\n    vec3 meshLocalPos = particle_vertexData3.xyz;\n\n";
pc.shaderChunks.transformVS="mat4 getModelMatrix(inout vsInternalData data) {\n    return matrix_model;\n}\n\nvec4 getPosition(inout vsInternalData data) {\n    data.modelMatrix = getModelMatrix(data);\n    vec4 posW = data.modelMatrix * vec4(vertex_position, 1.0);\n    data.positionW = posW.xyz;\n    return matrix_viewProjection * posW;\n}\n\nvec3 getWorldPosition(inout vsInternalData data) {\n    return data.positionW;\n}\n\n";pc.shaderChunks.fogExpPS="uniform vec3 fog_color;\nuniform float fog_density;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = exp(-depth * fog_density);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    return mix(fog_color, color, fogFactor);\n}\n";
pc.shaderChunks.metalnessTexPS="uniform sampler2D texture_metalnessMap;\nvoid getSpecularity(inout psInternalData data) {\n    processMetalness(data, texture2D(texture_metalnessMap, $UV).$CH);\n}\n\n";pc.shaderChunks.cubeMapProjectNonePS="vec3 cubeMapProject(vec3 dir) {\n    return dir;\n}\n\n";pc.shaderChunks.particle_billboardVS="\n    quadXY = rotate(quadXY, angle, rotMatrix);\n    vec3 localPos = billboard(particlePos, quadXY, localMat);\n\n";pc.shaderChunks.glossTexPS="uniform sampler2D texture_glossMap;\nvoid getGlossiness(inout psInternalData data) {\n    data.glossiness = texture2D(texture_glossMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.combineDiffuseSpecularNoReflPS="vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight + data.specularLight * data.specularity;\n}\n\n";pc.shaderChunks.particle_meshVS="\n    vec3 localPos = meshLocalPos;\n    localPos.xy = rotate(localPos.xy, angle, rotMatrix);\n    localPos.yz = rotate(localPos.yz, angle, rotMatrix);\n\n    billboard(particlePos, quadXY, localMat);\n\n\n";pc.shaderChunks.particle_endPS="    rgb = addFog(data, rgb);\n    rgb = toneMap(rgb);\n    rgb = gammaCorrectOutput(rgb);\n    gl_FragColor = vec4(rgb, a);\n}\n";
pc.shaderChunks.shadowCoordPS="void _getShadowCoordOrtho(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    projPos.z += shadowParams.z;\n    projPos.z = min(projPos.z, 1.0);\n    data.shadowCoord = projPos.xyz;\n}\n\nvoid _getShadowCoordPersp(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    projPos.xyz /= projPos.w;\n    projPos.z += shadowParams.z;\n    data.shadowCoord = projPos.xyz;\n}\n\nvoid getShadowCoordOrtho(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPersp(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPerspNormalOffset(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    float distScale = abs(dot(vPositionW - data.lightPosW, data.lightDirNormW)); // fov?\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0) * distScale;\n\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, wPos);\n}\n\nvoid getShadowCoordOrthoNormalOffset(inout psInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0); //0.08\n\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, wPos);\n}\n\n";
pc.shaderChunks.fullscreenQuadVS="attribute vec2 aPosition;\n\nvarying vec2 vUv0;\n\nvoid main(void)\n{\n    gl_Position = vec4(aPosition, 0.5, 1.0);\n    vUv0 = aPosition.xy*0.5+0.5;\n}\n\n";pc.shaderChunks.particlePS="varying vec4 texCoordsAlphaLife;\n\nuniform sampler2D colorMap;\nuniform sampler2D internalTex3;\nuniform float graphSampleSize;\nuniform float graphNumSamples;\nuniform vec4 screenSize;\nuniform float camera_far;\nuniform float softening;\nuniform float colorMult;\n\nfloat saturate(float x) {\n    return clamp(x, 0.0, 1.0);\n}\n\nfloat unpackFloat(vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    float depth = dot(rgbaDepth, bitShift);\n    return depth;\n}\n\nvoid main(void) {\n    psInternalData data;\n    vec4 tex         = texture2DSRGB(colorMap, texCoordsAlphaLife.xy);\n    vec4 ramp     = texture2DSRGB(internalTex3, vec2(texCoordsAlphaLife.w, 0.0));\n    ramp.rgb *= colorMult;\n\n    ramp.a += texCoordsAlphaLife.z;\n\n    vec3 rgb =     tex.rgb * ramp.rgb;\n    float a =         tex.a * ramp.a;\n\n";
pc.shaderChunks.lightSpecularBlinnPS="// Energy-conserving (hopefully) Blinn-Phong\nfloat getLightSpecular(inout psInternalData data) {\n    vec3 h = normalize( -data.lightDirNormW + data.viewDirW );\n    float nh = max( dot( h, data.normalW ), 0.0 );\n\n    float specPow = exp2(data.glossiness * 11.0); // glossiness is linear, power is not; 0 - 2048\n    specPow = antiAliasGlossiness(data, specPow);\n\n    // Hack: On Mac OS X, calling pow with zero for the exponent generates hideous artifacts so bias up a little\n    specPow = max(specPow, 0.0001);\n\n    return pow(nh, specPow) * (specPow + 2.0) / 8.0;\n}\n\n";
pc.shaderChunks.shadowCoordVS="void getLightDirPoint(inout vsInternalData data, vec3 lightPosW) {\n    vec3 lightDirW = vPositionW - lightPosW;\n    data.lightDirNormW = normalize(lightDirW);\n    data.lightPosW = lightPosW;\n}\n\nvoid _getShadowCoordOrtho(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    vMainShadowUv = projPos;\n}\n\nvoid _getShadowCoordPersp(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams, vec3 wPos) {\n    vec4 projPos = shadowMatrix * vec4(wPos, 1.0);\n    vMainShadowUv = projPos;\n}\n\nvoid getShadowCoordOrtho(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPersp(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, vPositionW);\n}\n\nvoid getShadowCoordPerspNormalOffset(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    float distScale = abs(dot(vPositionW - data.lightPosW, data.lightDirNormW)); // fov?\n    vec3 wPos = vPositionW + data.normalW * shadowParams.y * clamp(1.0 - dot(data.normalW, -data.lightDirNormW), 0.0, 1.0) * distScale;\n\n    _getShadowCoordPersp(data, shadowMatrix, shadowParams, wPos);\n}\n\nvoid getShadowCoordOrthoNormalOffset(inout vsInternalData data, mat4 shadowMatrix, vec3 shadowParams) {\n    vec3 wPos = vPositionW + data.normalW * shadowParams.y * clamp(1.0 - dot(data.normalW, -data.lightDirNormW), 0.0, 1.0); //0.08\n\n    _getShadowCoordOrtho(data, shadowMatrix, shadowParams, wPos);\n}\n\n";
pc.shaderChunks.rgbmPS="vec3 decodeRGBM(vec4 rgbm) {\n    vec3 color = (8.0 * rgbm.a) * rgbm.rgb;\n    return color * color;\n}\n\nvec3 texture2DRGBM(sampler2D tex, vec2 uv) {\n    return decodeRGBM(texture2D(tex, uv));\n}\n\nvec3 textureCubeRGBM(samplerCube tex, vec3 uvw) {\n    return decodeRGBM(textureCube(tex, uvw));\n}\n\n";pc.shaderChunks.reflectionCubePS="uniform samplerCube texture_cubeMap;\nuniform float material_reflectionFactor;\nvoid addReflection(inout psInternalData data) {\n    vec3 lookupVec = fixSeams(cubeMapProject(data.reflDirW));\n    lookupVec.x *= -1.0;\n    data.reflection += vec4($textureCubeSAMPLE(texture_cubeMap, lookupVec).rgb, material_reflectionFactor);\n}\n";
pc.shaderChunks.specularConstPS="uniform vec3 material_specular;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = material_specular;\n}\n\n";pc.shaderChunks.packDepthMaskPS="vec4 packFloat(float depth) {\n    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n\n    // combination of mod and multiplication and division works better\n    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n    res.x = 0.0;\n    res -= res.xxyz * bit_mask;\n    return res;\n}\n\n";
pc.shaderChunks.diffuseTexPS="uniform sampler2D texture_diffuseMap;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = texture2DSRGB(texture_diffuseMap, $UV).$CH;\n}\n\n";pc.shaderChunks.endPS="   gl_FragColor.rgb = combineColor(data);\n   gl_FragColor.rgb += getEmission(data);\n   gl_FragColor.rgb = addFog(data, gl_FragColor.rgb);\n   gl_FragColor.rgb = toneMap(gl_FragColor.rgb);\n   gl_FragColor.rgb = gammaCorrectOutput(gl_FragColor.rgb);\n   gl_FragColor.a = data.alpha;\n";
pc.shaderChunks.fogNonePS="vec3 addFog(inout psInternalData data, vec3 color) {\n    return color;\n}\n\n\n";pc.shaderChunks.gamma1_0PS="vec4 texture2DSRGB(sampler2D tex, vec2 uv) {\n    return texture2D(tex, uv);\n}\n\nvec4 textureCubeSRGB(samplerCube tex, vec3 uvw) {\n    return textureCube(tex, uvw);\n}\n\nvec3 gammaCorrectOutput(vec3 color) {\n    return color;\n}\n\nvec3 gammaCorrectInput(vec3 color) {\n    return color;\n}\n\nfloat gammaCorrectInput(float color) {\n    return color;\n}\n\nvec4 gammaCorrectInput(vec4 color) {\n    return color;\n}\n\n";
pc.shaderChunks.fogExp2PS="uniform vec3 fog_color;\nuniform float fog_density;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = exp(-depth * depth * fog_density * fog_density);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    return mix(fog_color, color, fogFactor);\n}\n";pc.shaderChunks.lightDiffuseLambertPS="float getLightDiffuse(inout psInternalData data) {\n    return max(dot(data.normalW, -data.lightDirNormW), 0.0);\n}\n\n";
pc.shaderChunks.diffuseTexConstPS="uniform sampler2D texture_diffuseMap;\nuniform vec3 material_diffuse;\nvoid getAlbedo(inout psInternalData data) {\n    data.albedo = texture2DSRGB(texture_diffuseMap, $UV).$CH * material_diffuse;\n}\n\n";pc.shaderChunks.particleUpdaterSpherePS="uniform float spawnBoundsSphere;\nvec3 calcSpawnPosition(vec3 inBounds, float rndFactor) {\n    float rnd4 = fract(rndFactor * 1000.0);\n    return emitterPos + normalize(inBounds.xyz - vec3(0.5)) * rnd4 * spawnBoundsSphere;\n}\n\nvoid addInitialVelocity(inout vec3 localVelocity, vec3 inBounds) {\n    localVelocity += normalize(inBounds - vec3(0.5)) * initialVelocity;\n}\n\n";
pc.shaderChunks.ambientConstantPS="\nvoid addAmbient(inout psInternalData data) {\n    data.diffuseLight = light_globalAmbient;\n}\n";pc.shaderChunks.shadowPS="// ----- Unpacking -----\n\nfloat unpackFloat(vec4 rgbaDepth) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    return dot(rgbaDepth, bitShift);\n}\n\nfloat unpackMask(vec4 rgbaDepth) {\n    return rgbaDepth.x;\n}\n\nfloat unpackFloatYZW(vec4 enc) {\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\n    float v = dot(enc.yzw, bitShift.yzw);\n    return v;\n}\n\n\n// ----- Aux -----\n\nvec3 lessThan2(vec3 a, vec3 b) {\n    return clamp((b - a)*1000.0, 0.0, 1.0); // softer version\n}\n\nvec3 greaterThan2(vec3 a, vec3 b) {\n    return clamp((a - b)*1000.0, 0.0, 1.0); // softer version\n}\n\n\n// ----- Direct/Spot Sampling -----\n\nfloat getShadowHard(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    float depth = unpackFloat(texture2D(shadowMap, data.shadowCoord.xy));\n    return (depth < data.shadowCoord.z) ? 0.0 : 1.0;\n}\n\nfloat getShadowMask(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return unpackMask(texture2D(shadowMap, data.shadowCoord.xy));\n}\n\nfloat _xgetShadowPCF3x3(mat3 depthKernel, inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    mat3 shadowKernel;\n    vec3 shadowCoord = data.shadowCoord;\n    vec3 shadowZ = vec3(shadowCoord.z);\n    shadowKernel[0] = vec3(greaterThan(depthKernel[0], shadowZ));\n    shadowKernel[1] = vec3(greaterThan(depthKernel[1], shadowZ));\n    shadowKernel[2] = vec3(greaterThan(depthKernel[2], shadowZ));\n\n    vec2 fractionalCoord = fract( shadowCoord.xy * shadowParams.x );\n\n    shadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n    shadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\n    vec4 shadowValues;\n    shadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n    shadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n    shadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n    shadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\n    return dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\n\nfloat _getShadowPCF3x3(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    vec3 shadowCoord = data.shadowCoord;\n\n    float xoffset = 1.0 / shadowParams.x; // 1/shadow map width\n    float dx0 = -xoffset;\n    float dx1 = xoffset;\n\n    mat3 depthKernel;\n    depthKernel[0][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx0)));\n    depthKernel[0][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, 0.0)));\n    depthKernel[0][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx1)));\n    depthKernel[1][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx0)));\n    depthKernel[1][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy));\n    depthKernel[1][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx1)));\n    depthKernel[2][0] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx0)));\n    depthKernel[2][1] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, 0.0)));\n    depthKernel[2][2] = unpackFloat(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx1)));\n\n    return _xgetShadowPCF3x3(depthKernel, data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return _getShadowPCF3x3(data, shadowMap, shadowParams);\n}\n\nfloat _getShadowPCF3x3_YZW(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    vec3 shadowCoord = data.shadowCoord;\n\n    float xoffset = 1.0 / shadowParams.x; // 1/shadow map width\n    float dx0 = -xoffset;\n    float dx1 = xoffset;\n\n    mat3 depthKernel;\n    depthKernel[0][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx0)));\n    depthKernel[0][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, 0.0)));\n    depthKernel[0][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx0, dx1)));\n    depthKernel[1][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx0)));\n    depthKernel[1][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy));\n    depthKernel[1][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(0.0, dx1)));\n    depthKernel[2][0] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx0)));\n    depthKernel[2][1] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, 0.0)));\n    depthKernel[2][2] = unpackFloatYZW(texture2D(shadowMap, shadowCoord.xy + vec2(dx1, dx1)));\n\n    return _xgetShadowPCF3x3(depthKernel, data, shadowMap, shadowParams);\n}\n\nfloat getShadowPCF3x3_YZW(inout psInternalData data, sampler2D shadowMap, vec3 shadowParams) {\n    return _getShadowPCF3x3_YZW(data, shadowMap, shadowParams);\n}\n\n\n// ----- Point Sampling -----\n\nfloat getShadowPointHard(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams) {\n    return float(unpackFloat(textureCube(shadowMap, data.lightDirNormW)) > (length(data.lightDirW) * shadowParams.w + shadowParams.z));\n}\n\nfloat _getShadowPoint(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams, vec3 dir) {\n\n    vec3 tc = normalize(dir);\n    vec3 tcAbs = abs(tc);\n\n    vec4 dirX = vec4(1,0,0, tc.x);\n    vec4 dirY = vec4(0,1,0, tc.y);\n    float majorAxisLength = tc.z;\n    if ((tcAbs.x > tcAbs.y) && (tcAbs.x > tcAbs.z)) {\n        dirX = vec4(0,0,1, tc.z);\n        dirY = vec4(0,1,0, tc.y);\n        majorAxisLength = tc.x;\n    } else if ((tcAbs.y > tcAbs.x) && (tcAbs.y > tcAbs.z)) {\n        dirX = vec4(1,0,0, tc.x);\n        dirY = vec4(0,0,1, tc.z);\n        majorAxisLength = tc.y;\n    }\n\n    float shadowParamsInFaceSpace = ((1.0/shadowParams.x) * 2.0) * abs(majorAxisLength);\n\n    vec3 xoffset = (dirX.xyz * shadowParamsInFaceSpace);\n    vec3 yoffset = (dirY.xyz * shadowParamsInFaceSpace);\n    vec3 dx0 = -xoffset;\n    vec3 dy0 = -yoffset;\n    vec3 dx1 = xoffset;\n    vec3 dy1 = yoffset;\n\n    mat3 shadowKernel;\n    mat3 depthKernel;\n\n    depthKernel[0][0] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy0));\n    depthKernel[0][1] = unpackFloat(textureCube(shadowMap, tc + dx0));\n    depthKernel[0][2] = unpackFloat(textureCube(shadowMap, tc + dx0 + dy1));\n    depthKernel[1][0] = unpackFloat(textureCube(shadowMap, tc + dy0));\n    depthKernel[1][1] = unpackFloat(textureCube(shadowMap, tc));\n    depthKernel[1][2] = unpackFloat(textureCube(shadowMap, tc + dy1));\n    depthKernel[2][0] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy0));\n    depthKernel[2][1] = unpackFloat(textureCube(shadowMap, tc + dx1));\n    depthKernel[2][2] = unpackFloat(textureCube(shadowMap, tc + dx1 + dy1));\n\n    vec3 shadowZ = vec3(length(dir) * shadowParams.w + shadowParams.z);\n\n    shadowKernel[0] = vec3(lessThan2(depthKernel[0], shadowZ));\n    shadowKernel[1] = vec3(lessThan2(depthKernel[1], shadowZ));\n    shadowKernel[2] = vec3(lessThan2(depthKernel[2], shadowZ));\n\n    vec2 uv = (vec2(dirX.w, dirY.w) / abs(majorAxisLength)) * 0.5;\n\n    vec2 fractionalCoord = fract( uv * shadowParams.x );\n\n    shadowKernel[0] = mix(shadowKernel[0], shadowKernel[1], fractionalCoord.x);\n    shadowKernel[1] = mix(shadowKernel[1], shadowKernel[2], fractionalCoord.x);\n\n    vec4 shadowValues;\n    shadowValues.x = mix(shadowKernel[0][0], shadowKernel[0][1], fractionalCoord.y);\n    shadowValues.y = mix(shadowKernel[0][1], shadowKernel[0][2], fractionalCoord.y);\n    shadowValues.z = mix(shadowKernel[1][0], shadowKernel[1][1], fractionalCoord.y);\n    shadowValues.w = mix(shadowKernel[1][1], shadowKernel[1][2], fractionalCoord.y);\n\n    return 1.0 - dot( shadowValues, vec4( 1.0 ) ) * 0.25;\n}\n\nfloat getShadowPointPCF3x3(inout psInternalData data, samplerCube shadowMap, vec4 shadowParams) {\n    return _getShadowPoint(data, shadowMap, shadowParams, data.lightDirW);\n}\n\nvoid normalOffsetPointShadow(inout psInternalData data, vec4 shadowParams) {\n    float distScale = length(data.lightDirW);\n    vec3 wPos = vPositionW + vNormalW * shadowParams.y * clamp(1.0 - dot(vNormalW, -data.lightDirNormW), 0.0, 1.0) * distScale; //0.02\n    vec3 dir = wPos - data.lightPosW;\n    data.lightDirW = dir;\n}\n\n";
pc.shaderChunks.TBNPS="void getTBN(inout psInternalData data) {\n    data.TBN = mat3(normalize(vTangentW), normalize(vBinormalW), normalize(vNormalW));\n}\n\n";pc.shaderChunks.particle_halflambertPS="\n    vec3 negNormal = normal*0.5+0.5;\n    vec3 posNormal = -normal*0.5+0.5;\n    negNormal *= negNormal;\n    posNormal *= posNormal;\n\n\n";pc.shaderChunks.combineDiffusePS="vec3 combineColor(inout psInternalData data) {\n    return data.albedo * data.diffuseLight;\n}\n\n";
pc.shaderChunks.particleUpdaterInitPS="varying vec2 vUv0;\n\nuniform sampler2D particleTexIN;\nuniform sampler2D internalTex0;\nuniform sampler2D internalTex1;\nuniform sampler2D internalTex2;\n\nuniform mat3 emitterMatrix;\nuniform vec3 emitterScale;\n\nuniform vec3 emitterPos, frameRandom, localVelocityDivMult, velocityDivMult;\nuniform float delta, rate, rateDiv, lifetime, numParticles, rotSpeedDivMult, seed;\nuniform float startAngle, startAngle2;\nuniform float initialVelocity;\n\nuniform float graphSampleSize;\nuniform float graphNumSamples;\n\n";
pc.shaderChunks.fogLinearPS="uniform vec3 fog_color;\nuniform float fog_start;\nuniform float fog_end;\nvec3 addFog(inout psInternalData data, vec3 color) {\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = (fog_end - depth) / (fog_end - fog_start);\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\n    fogFactor = gammaCorrectInput(fogFactor);\n    return mix(fog_color, color, fogFactor);\n}\n";pc.shaderChunks.aoBakedPS="uniform sampler2D texture_aoMap;\nvoid applyAO(inout psInternalData data) {\n    data.ao = texture2D(texture_aoMap, $UV).$CH;\n    data.diffuseLight *= data.ao;\n}\n\nvoid occludeSpecular(inout psInternalData data) {\n    // fake specular occlusion from AO\n    float specPow = exp2(data.glossiness * 4.0); // 0 - 128\n    specPow = max(specPow, 0.0001);\n    float specOcc = saturate(pow(data.ao * (data.glossiness + 1.0), specPow));\n\n    data.specularLight *= specOcc;\n    data.reflection *= specOcc;\n}\n\n";
pc.shaderChunks.particle_endVS="\n    localPos *= scale * emitterScale;\n    localPos += particlePos;\n\n    gl_Position = matrix_viewProjection * vec4(localPos.xyz, 1.0);\n}\n";pc.shaderChunks.particle_softPS="\n    vec2 screenTC = gl_FragCoord.xy / screenSize.xy;\n    float depth = unpackFloat( texture2D(uDepthMap, screenTC) ) * camera_far;\n    float particleDepth = gl_FragCoord.z / gl_FragCoord.w;\n    float depthDiff = saturate(abs(particleDepth - depth) * softening);\n    a *= depthDiff;\n\n";
pc.shaderChunks.specularTexConstPS="uniform sampler2D texture_specularMap;\nuniform vec3 material_specular;\nvoid getSpecularity(inout psInternalData data) {\n    data.specularity = texture2D(texture_specularMap, $UV).$CH * material_specular;\n}\n\n";pc.shaderChunks.startPS="\nvoid main(void) {\n    psInternalData data;\n\tdata.diffuseLight = vec3(0);\n\tdata.specularLight = vec3(0);\n    data.reflection = vec4(0);\n\n\n";pc.shaderChunks.lightmapSinglePS="uniform sampler2D texture_lightMap;\nvoid addAmbient(inout psInternalData data) {\n    data.diffuseLight = texture2D(texture_lightMap, $UV).$CH;\n}\n\n";
pc.shaderChunks.particleUpdaterOnStopPS="    life = life < 0.0? particleLifetime + 1.0 : life;\n\n";pc.shaderChunks.instancingVS="\nattribute vec4 instance_line1;\nattribute vec4 instance_line2;\nattribute vec4 instance_line3;\nattribute vec4 instance_line4;\n\n";pc.programlib={getSnippet:function(e,a){var b="";switch(a){case "common_main_begin":b+="void main(void)\n{\n";break;case "common_main_end":b+="}\n";break;case "fs_alpha_test_decl":b+="uniform float alpha_ref;\n";break;case "fs_alpha_test":b+="    if (gl_FragColor.a < alpha_ref) discard;\n\n";break;case "fs_clamp":b+="    gl_FragColor = clamp(gl_FragColor, 0.0, 1.0);\n";break;case "fs_flat_color_decl":b+="uniform vec4 uColor;\n";break;case "fs_flat_color":b+="    gl_FragColor = uColor;\n";break;case "fs_fog_linear_decl":case "fs_fog_exp_decl":case "fs_fog_exp2_decl":b+=
"uniform vec3 fog_color;\n";b="fs_fog_linear_decl"===a?b+"uniform float fog_start;\nuniform float fog_end;\n\n":b+"uniform float fog_density;\n\n";break;case "fs_fog_linear":case "fs_fog_exp":case "fs_fog_exp2":b+="    float depth = gl_FragCoord.z / gl_FragCoord.w;\n";b="fs_fog_linear"===a?b+"    float fogFactor = (fog_end - depth) / (fog_end - fog_start);\n":"fs_fog_exp"===a?b+"    float fogFactor = exp(-depth * fog_density);\n":b+"    float fogFactor = exp(-depth * depth * fog_density * fog_density);\n";
b+="    fogFactor = clamp(fogFactor, 0.0, 1.0);\n";b+="    gl_FragColor.rgb = mix(fog_color, gl_FragColor.rgb, fogFactor);\n";break;case "fs_precision":b+="precision "+e.precision+" float;\n\n";break;case "fs_height_map_funcs":b+="vec3 perturb_normal( vec3 N, vec3 p, vec2 uv )\n";b+="{\n";b+="    vec3 dp1 = dFdx( p );\n";b+="    vec3 dp2 = dFdy( p );\n";b+="    vec2 duv1 = dFdx( uv );\n";b+="    vec2 duv2 = dFdy( uv );\n\n";b+="    vec3 dp2perp = cross( dp2, N );\n";b+="    vec3 dp1perp = cross( N, dp1 );\n\n";
b+="    const float bumpScale = 0.125;\n";b+="    float Hll = bumpScale * texture2D( texture_heightMap, uv ).x;\n";b+="    float dBx = bumpScale * texture2D( texture_heightMap, uv + duv1 ).x - Hll;\n";b+="    float dBy = bumpScale * texture2D( texture_heightMap, uv + duv2 ).x - Hll;\n\n";b+="    float fDet = dot( dp1, dp2perp );\n";b+="    vec3 vGrad = sign( fDet ) * ( dBx * dp2perp + dBy * dp1perp );\n";b+="    return normalize( abs( fDet ) * N - vGrad );\n";b+="}\n\n";break;case "fs_normal_map_funcs":pc.precalculatedTangents||
(b+="mat3 cotangent_frame( vec3 N, vec3 p, vec2 uv )\n",b+="{\n",b+="    vec3 dp1 = dFdx( p );\n",b+="    vec3 dp2 = dFdy( p );\n",b+="    vec2 duv1 = dFdx( uv );\n",b+="    vec2 duv2 = dFdy( uv );\n\n",b+="    vec3 dp2perp = cross( dp2, N );\n",b+="    vec3 dp1perp = cross( N, dp1 );\n",b+="    vec3 T = dp2perp * duv1.x + dp1perp * duv2.x;\n",b+="    vec3 B = dp2perp * duv1.y + dp1perp * duv2.y;\n\n",b+="    float invmax = inversesqrt( max( dot(T,T), dot(B,B) ) );\n",b+="    return mat3( T * invmax, B * invmax, N );\n",
b+="}\n\n",b+="vec3 perturb_normal( vec3 N, vec3 V, vec2 uv )\n",b+="{\n",b+="    vec3 map = texture2D( texture_normalMap, uv ).xyz;\n",b+="    map = map * 255./127. - 128./127.;\n",b+="    map.xy = map.xy * material_bumpMapFactor;\n",b+="    mat3 TBN = cotangent_frame( N, -V, uv );\n",b+="    return normalize( TBN * map );\n",b+="}\n\n");break;case "vs_skin_decl":b=e.supportsBoneTextures?b+"attribute vec4 vertex_boneWeights;\nattribute vec4 vertex_boneIndices;\n\nuniform sampler2D texture_poseMap;\nuniform vec2 texture_poseMapSize;\n\nmat4 getBoneMatrix(const in float i)\n{\n    float j = i * 4.0;\n    float x = mod(j, float(texture_poseMapSize.x));\n    float y = floor(j / float(texture_poseMapSize.x));\n\n    float dx = 1.0 / float(texture_poseMapSize.x);\n    float dy = 1.0 / float(texture_poseMapSize.y);\n\n    y = dy * (y + 0.5);\n\n    vec4 v1 = texture2D(texture_poseMap, vec2(dx * (x + 0.5), y));\n    vec4 v2 = texture2D(texture_poseMap, vec2(dx * (x + 1.5), y));\n    vec4 v3 = texture2D(texture_poseMap, vec2(dx * (x + 2.5), y));\n    vec4 v4 = texture2D(texture_poseMap, vec2(dx * (x + 3.5), y));\n\n    mat4 bone = mat4(v1, v2, v3, v4);\n\n    return bone;\n}":
b+["attribute vec4 vertex_boneWeights;\nattribute vec4 vertex_boneIndices;\n","uniform mat4 matrix_pose["+e.getBoneLimit()+"];","\nmat4 getBoneMatrix(const in float i)\n{\n    mat4 bone = matrix_pose[int(i)];\n\n    return bone;\n}"].join("\n");b+="\n\n";break;case "vs_transform_decl":b+="attribute vec3 vertex_position;\n",b+="uniform mat4 matrix_model;\n",b+="uniform mat4 matrix_viewProjection;\n\n"}return b},gammaCode:function(e){return e===pc.GAMMA_NONE?pc.shaderChunks.gamma1_0PS:e===pc.GAMMA_SRGBFAST?
pc.shaderChunks.gamma2_2FastPS:pc.shaderChunks.gamma2_2PS},tonemapCode:function(e){return e?pc.shaderChunks.tonemappingFilmicPS:pc.shaderChunks.tonemappingLinearPS}};pc.programlib.basic={generateKey:function(e,a){var b="basic";a.fog&&(b+="_fog");a.alphaTest&&(b+="_atst");a.vertexColors&&(b+="_vcol");a.diffuseMap&&(b+="_diff");return b},createShaderDefinition:function(e,a){var b={vertex_position:pc.SEMANTIC_POSITION};a.skin&&(b.vertex_boneWeights=pc.SEMANTIC_BLENDWEIGHT,b.vertex_boneIndices=pc.SEMANTIC_BLENDINDICES);a.vertexColors&&(b.vertex_color=pc.SEMANTIC_COLOR);a.diffuseMap&&(b.vertex_texCoord0=pc.SEMANTIC_TEXCOORD0);var c=pc.programlib.getSnippet,d;d=""+
c(e,"vs_transform_decl");a.skin&&(d+=c(e,"vs_skin_decl"));a.vertexColors&&(d+="attribute vec4 vertex_color;\nvarying vec4 vColor;\n");a.diffuseMap&&(d+="attribute vec2 vertex_texCoord0;\n",d+="varying vec2 vUv0;\n");d+=c(e,"common_main_begin");a.skin?(d+="    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n",d+="                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n",d+="                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n",
d+="                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"):d+="    mat4 modelMatrix = matrix_model;\n";d+="\n";d+="    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";d+="    gl_Position = matrix_viewProjection * positionW;\n\n";a.vertexColors&&(d+="    vColor = vertex_color;\n");a.diffuseMap&&(d+="    vUv0 = vertex_texCoord0;\n");var g=d+=c(e,"common_main_end");d=c(e,"fs_precision");d=a.vertexColors?d+"varying vec4 vColor;\n":d+"uniform vec4 uColor;\n";
a.diffuseMap&&(d+="varying vec2 vUv0;\n",d+="uniform sampler2D texture_diffuseMap;\n");a.fog&&(d+=c(e,"fs_fog_decl"));a.alphatest&&(d+=c(e,"fs_alpha_test_decl"));d+=c(e,"common_main_begin");d=a.vertexColors?d+"    gl_FragColor = vColor;\n":d+"    gl_FragColor = uColor;\n";a.diffuseMap&&(d+="    gl_FragColor *= texture2D(texture_diffuseMap, vUv0);\n");a.alphatest&&(d+=c(e,"fs_alpha_test"));d+=c(e,"fs_clamp");a.fog&&(d+=c(e,"fs_fog"));d+=c(e,"common_main_end");return{attributes:b,vshader:g,fshader:d}}};pc.programlib.depth={generateKey:function(e,a){var b="depth";a.skin&&(b+="_skin");a.opacityMap&&(b+="_opam");return b},createShaderDefinition:function(e,a){var b={vertex_position:pc.SEMANTIC_POSITION};a.skin&&(b.vertex_boneWeights=pc.SEMANTIC_BLENDWEIGHT,b.vertex_boneIndices=pc.SEMANTIC_BLENDINDICES);a.opacityMap&&(b.vertex_texCoord0=pc.SEMANTIC_TEXCOORD0);var c=pc.programlib.getSnippet,d;d=""+c(e,"vs_transform_decl");a.skin&&(d+=c(e,"vs_skin_decl"));a.opacityMap&&(d+="attribute vec2 vertex_texCoord0;\n\nvarying vec2 vUv0;\n\n");
d+=c(e,"common_main_begin");a.skin?(d+="    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n",d+="                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n",d+="                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n",d+="                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"):d+="    mat4 modelMatrix = matrix_model;\n";d+="\n";d+="    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";
d+="    gl_Position = matrix_viewProjection * positionW;\n\n";a.opacityMap&&(d+="    vUv0 = vertex_texCoord0;\n");var g=d+=c(e,"common_main_end");d=c(e,"fs_precision");d+="uniform float camera_near;\n";d+="uniform float camera_far;\n";d+="vec4 packFloat(float depth)\n";d+="{\n";d+="    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\n";d+="    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\n";d+="    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\n";
d+="    res -= res.xxyz * bit_mask;\n";d+="    return res;\n";d+="}\n\n";d+=c(e,"common_main_begin");d+="float depth = gl_FragCoord.z / gl_FragCoord.w;\n";d+="gl_FragColor = packFloat(depth / camera_far);\n";d+=c(e,"common_main_end");return{attributes:b,vshader:g,fshader:d}}};pc.programlib.depthrgba={generateKey:function(e,a){var b="depthrgba";a.skin&&(b+="_skin");a.opacityMap&&(b+="_opam"+a.opacityChannel);a.point&&(b+="_pnt");return b+="_"+a.shadowType},createShaderDefinition:function(e,a){var b={vertex_position:pc.SEMANTIC_POSITION};a.skin&&(b.vertex_boneWeights=pc.SEMANTIC_BLENDWEIGHT,b.vertex_boneIndices=pc.SEMANTIC_BLENDINDICES);a.opacityMap&&(b.vertex_texCoord0=pc.SEMANTIC_TEXCOORD0);var c=pc.programlib.getSnippet,d;d=""+c(e,"vs_transform_decl");a.skin&&(d+=c(e,
"vs_skin_decl"));a.opacityMap&&(d+="attribute vec2 vertex_texCoord0;\n\nvarying vec2 vUv0;\n\n");a.point&&(d+="varying vec3 worldPos;\n\n");d+=c(e,"common_main_begin");a.skin?(d+="    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n",d+="                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n",d+="                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n",d+="                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"):
d+="    mat4 modelMatrix = matrix_model;\n";d+="\n";d+="    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";d+="    gl_Position = matrix_viewProjection * positionW;\n\n";a.opacityMap&&(d+="    vUv0 = vertex_texCoord0;\n");a.point&&(d+="    worldPos = positionW.xyz;\n");var g=d+=c(e,"common_main_end");d=c(e,"fs_precision");a.opacityMap&&(d+="varying vec2 vUv0;\n\n",d+="uniform sampler2D texture_opacityMap;\n\n");a.point&&(d+="varying vec3 worldPos;\n\n",d+="uniform vec3 view_position;\n\n",
d+="uniform float light_radius;\n\n");var f=pc.shaderChunks;d=a.shadowType===pc.SHADOW_DEPTHMASK?d+f.packDepthMaskPS:d+f.packDepthPS;d+=c(e,"common_main_begin");a.opacityMap&&(d+="    if (texture2D(texture_opacityMap, vUv0)."+a.opacityChannel+" < 0.25) discard;\n\n");d=a.point?d+"   gl_FragData[0] = packFloat(min(distance(view_position, worldPos) / light_radius, 0.99999));\n":d+"    gl_FragData[0] = packFloat(gl_FragCoord.z);\n";d+=c(e,"common_main_end");return{attributes:b,vshader:g,fshader:d}}};pc.programlib.particle={generateKey:function(e,a){var b="particle";for(prop in a)a.hasOwnProperty(prop)&&(b+=a[prop]);return b},createShaderDefinition:function(e,a){var b=pc.programlib.getSnippet,c=pc.shaderChunks,d="",b=b(e,"fs_precision")+"\n";a.useCpu?(1==a.normal&&(d+="\nvarying vec3 Normal;\n"),2==a.normal&&(d+="\nvarying mat3 ParticleMat;\n"),d+=c.particle_cpuVS,a.alignToMotion&&(d+=c.particle_pointAlongVS),d+=a.mesh?c.particle_meshVS:c.particle_billboardVS,1==a.normal&&(d+=c.particle_normalVS),
2==a.normal&&(d+=c.particle_TBNVS),0<a.stretch&&(d+=c.particle_stretchVS),d+=c.particle_cpu_endVS):(1==a.normal&&(d+="\nvarying vec3 Normal;\n"),2==a.normal&&(d+="\nvarying mat3 ParticleMat;\n"),d+=c.particleVS,a.wrap&&(d+=c.particle_wrapVS),a.alignToMotion&&(d+=c.particle_pointAlongVS),d+=a.mesh?c.particle_meshVS:c.particle_billboardVS,1==a.normal&&(d+=c.particle_normalVS),2==a.normal&&(d+=c.particle_TBNVS),0<a.stretch&&(d+=c.particle_stretchVS),d+=c.particle_endVS);0<a.normal&&(1==a.normal?b+="\nvarying vec3 Normal;\n":
2==a.normal&&(b+="\nvarying mat3 ParticleMat;\n"),b+="\nuniform vec3 lightCube[6];\n");0==a.normal&&"none"==a.fog&&(a.srgb=!1);b+=pc.programlib.gammaCode(a.gamma);b=b+"struct psInternalData {float dummy;};\n"+pc.programlib.tonemapCode(a.toneMap);b="linear"===a.fog?b+c.fogLinearPS:"exp"===a.fog?b+c.fogExpPS:"exp2"===a.fog?b+c.fogExp2PS:b+c.fogNonePS;2==a.normal&&(b+="\nuniform sampler2D normalMap;\n");0<a.soft&&(b+="\nuniform sampler2D uDepthMap;\n");b+=c.particlePS;0<a.soft&&(b+=c.particle_softPS);
1==a.normal&&(b+="\nvec3 normal = Normal;\n");2==a.normal&&(b+=c.particle_normalMapPS);0<a.normal&&(b+=a.halflambert?c.particle_halflambertPS:c.particle_lambertPS);0<a.normal&&(b+=c.particle_lightingPS);a.blend==pc.BLEND_NORMAL?b+=c.particle_blendNormalPS:a.blend==pc.BLEND_ADDITIVE?b+=c.particle_blendAddPS:a.blend==pc.BLEND_MULTIPLICATIVE&&(b+=c.particle_blendMultiplyPS);b+=c.particle_endPS;return{attributes:pc.shaderChunks.collectAttribs(d),vshader:d,fshader:b}}};pc.programlib.phong={hashCode:function(e){var a=0;if(0==e.length)return a;for(i=0;i<e.length;i++)char=e.charCodeAt(i),a=(a<<5)-a+char,a&=a;return a},generateKey:function(e,a){var b=[],c="phong";for(prop in a)if("lights"===prop)for(var d=0;d<a.lights.length;d++)b.push(a.lights[d].getType()+"_"+(a.lights[d].getCastShadows()?1:0)+"_"+a.lights[d].getFalloffMode()+"_"+!!a.lights[d].getNormalOffsetBias());else if("chunks"===prop)for(var g in a[prop])a[prop].hasOwnProperty(g)&&b.push(g+a.chunks[g]);else a[prop]&&
b.push(prop);b.sort();for(prop in b)c+=b[prop]+a[b[prop]];return this.hashCode(c)},_setMapTransform:function(e,a,b,c){e[0]+="uniform vec4 texture_"+a+"MapTransform;\n";var d=b+100*c;e[3][d]||(e[1]+="varying vec2 vUV"+c+"_"+b+";\n",e[2]+="   vUV"+c+"_"+b+" = uv"+c+" * texture_"+a+"MapTransform.xy + texture_"+a+"MapTransform.zw;\n",e[3][d]=!0);return e},_uvSource:function(e,a){return 0==e?"vUv"+a:"vUV"+a+"_"+e},_addMap:function(e,a,b,c,d,g){var f=e+"Map";if(a[f]){var k=f+"Channel",c=this._uvSource(a[f+
"Transform"],a[f+"Uv"])+c;d||(d=a[e+"Tint"]?b[e+"TexConstPS"]:b[e+"TexPS"]);void 0!==g&&(d=d.replace(/\$texture2DSAMPLE/g,0===g?"texture2DSRGB":1===g?"texture2DRGBM":"texture2D"));return d.replace(/\$UV/g,c).replace(/\$CH/g,a[k])}return b[e+"ConstPS"]},_nonPointShadowMapProjection:function(e,a){return e.getNormalOffsetBias()?e.getType()==pc.LIGHTTYPE_SPOT?"   getShadowCoordPerspNormalOffset"+a:"   getShadowCoordOrthoNormalOffset"+a:e.getType()==pc.LIGHTTYPE_SPOT?"   getShadowCoordPersp"+a:"   getShadowCoordOrtho"+
a},_addVaryingIfNeeded:function(e,a,b){return 0<=e.indexOf(b)?"varying "+a+" "+b+";\n":""},createShaderDefinition:function(e,a){var b,c=0<a.lights.length;a.shadingModel===pc.SPECULAR_PHONG?(a.fresnelModel=0,a.specularAA=!1,a.prefilteredCubemap=!1):a.fresnelModel=0===a.fresnelModel?pc.FRESNEL_SCHLICK:a.fresnelModel;var d=a.cubeMap||a.prefilteredCubemap,g=a.sphereMap||d,f=pc.precalculatedTangents,k=a.useTexCubeLod;if(a.cubeMap||a.prefilteredCubemap)a.sphereMap=null;a.useSpecular||(a.specularMap=a.glossMap=
null);this.options=a;var m=pc.programlib.getSnippet,h="",n="",l="",r=pc.shaderChunks;if(a.chunks){var v=[],s;for(s in r)r.hasOwnProperty(s)&&(a.chunks[s]?(v[s]=a.chunks[s],!c&&!g&&(v[s]=v[s].replace(/vertex_normal/g,"vec3(0)").replace(/vertex_tangent/g,"vec4(0)"))):v[s]=r[s]);r=v}var h=h+r.baseVS,C=-1;if(!a.noShadow){for(b=0;b<a.lights.length;b++){var x=a.lights[b].getType();if(a.lights[b].getCastShadows()&&x!==pc.LIGHTTYPE_POINT){h+="uniform mat4 light"+b+"_shadowMatrixVS;\n";h+="uniform vec3 light"+
b+"_shadowParamsVS;\n";h+="uniform vec3 light"+b+(x===pc.LIGHTTYPE_DIRECTIONAL?"_directionVS":"_positionVS")+";\n";C=b;break}}0<=C&&(h+=r.shadowCoordVS)}v={vertex_position:pc.SEMANTIC_POSITION};n+="   vPositionW    = getWorldPosition(data);\n";a.useInstancing&&(v.instance_line1=pc.SEMANTIC_TEXCOORD2,v.instance_line2=pc.SEMANTIC_TEXCOORD3,v.instance_line3=pc.SEMANTIC_TEXCOORD4,v.instance_line4=pc.SEMANTIC_TEXCOORD5,h+=r.instancingVS);if(c||g){v.vertex_normal=pc.SEMANTIC_NORMAL;n+="   vNormalW    = data.normalW = getNormal(data);\n";
a.sphereMap&&16>=e.fragmentUniformsCount&&(h+=r.viewNormalVS,n+="   vNormalV    = getViewNormal(data);\n");if((a.heightMap||a.normalMap)&&f)v.vertex_tangent=pc.SEMANTIC_TANGENT,h+=r.tangentBinormalVS,n+="   vTangentW   = getTangent(data);\n   vBinormalW  = getBinormal(data);\n";0<=C&&(n=x==pc.LIGHTTYPE_DIRECTIONAL?n+("   data.lightDirNormW = light"+C+"_directionVS;\n"):n+("   getLightDirPoint(data, light"+C+"_positionVS);\n"),n+=this._nonPointShadowMapProjection(a.lights[C],"(data, light"+C+"_shadowMatrixVS, light"+
C+"_shadowParamsVS);\n"))}var u=[],w=[];for(s in pc._matTex2D)if(x=s+"Map",a[x]){var B=x+"Transform",y=x+"Uv",A=x+"Channel";a[y]=Math.min(a[y],1);if(0<pc._matTex2D[s])if(pc._matTex2D[s]<a[A].length)a[A]=a[A].substring(0,pc._matTex2D[s]);else if(pc._matTex2D[s]>a[A].length){var F=a[A],J=F.charAt(F.length-1),N=pc._matTex2D[s]-F.length;for(b=0;b<N;b++)F+=J;a[A]=F}b=a[y];u[b]=!0;w[b]=w[b]||a[x]&&!a[B]}for(b=0;2>b;b++)u[b]&&(v["vertex_texCoord"+b]=pc["SEMANTIC_TEXCOORD"+b],h+=r["uv"+b+"VS"],n+="   vec2 uv"+
b+" = getUv"+b+"(data);\n"),w[b]&&(n+="   vUv"+b+" = uv"+b+";\n");b=[h,l,n,[]];for(s in pc._matTex2D)x=s+"Map",a[x]&&(B=x+"Transform",a[B]&&(y=x+"Uv",this._setMapTransform(b,s,a[B],a[y])));h=b[0];l=b[1];n=b[2];a.vertexColors&&(v.vertex_color=pc.SEMANTIC_COLOR);if(a.skin){if(v.vertex_boneWeights=pc.SEMANTIC_BLENDWEIGHT,v.vertex_boneIndices=pc.SEMANTIC_BLENDINDICES,h+=m(e,"vs_skin_decl"),h+=r.transformSkinnedVS,c||g)h+=r.normalSkinnedVS}else if(a.useInstancing){if(h+=r.transformInstancedVS,c||g)h+=
r.normalInstancedVS}else if(h+=r.transformVS,c||g)h+=r.normalVS;h=h+"\n"+r.startVS;h+=n;s=h+="}";b=l;l=""+this._addVaryingIfNeeded(h,"vec4","vMainShadowUv");l+=this._addVaryingIfNeeded(h,"vec3","vPositionW");l+=this._addVaryingIfNeeded(h,"vec3","vNormalV");l+=this._addVaryingIfNeeded(h,"vec3","vNormalW");l+=this._addVaryingIfNeeded(h,"vec3","vTangentW");l+=this._addVaryingIfNeeded(h,"vec3","vBinormalW");l+=this._addVaryingIfNeeded(h,"vec2","vUv0");l+=this._addVaryingIfNeeded(h,"vec2","vUv1");l+=b;
s=l+s;a.forceFragmentPrecision&&("highp"!=a.forceFragmentPrecision&&"mediump"!=a.forceFragmentPrecision&&"lowp"!=a.forceFragmentPrecision)&&(a.forceFragmentPrecision=null);a.forceFragmentPrecision&&("highp"===a.forceFragmentPrecision&&"highp"!==e.maxPrecision&&(a.forceFragmentPrecision="mediump"),"mediump"===a.forceFragmentPrecision&&"lowp"===e.maxPrecision&&(a.forceFragmentPrecision="lowp"));h=a.forceFragmentPrecision?"precision "+a.forceFragmentPrecision+" float;\n\n":m(e,"fs_precision");if(a.customFragmentShader)return d=
h+a.customFragmentShader,{attributes:v,vshader:s,fshader:d};h+=l;h+=r.basePS;for(b=l=0;b<a.lights.length;b++)x=a.lights[b].getType(),h+="uniform vec3 light"+b+"_color;\n",x==pc.LIGHTTYPE_DIRECTIONAL?h+="uniform vec3 light"+b+"_direction;\n":(h+="uniform vec3 light"+b+"_position;\n",h+="uniform float light"+b+"_radius;\n",x==pc.LIGHTTYPE_SPOT&&(h+="uniform vec3 light"+b+"_spotDirection;\n",h+="uniform float light"+b+"_innerConeAngle;\n",h+="uniform float light"+b+"_outerConeAngle;\n")),a.lights[b].getCastShadows()&&
!a.noShadow&&(h+="uniform mat4 light"+b+"_shadowMatrix;\n",h=x==pc.LIGHTTYPE_POINT?h+("uniform vec4 light"+b+"_shadowParams;\n"):h+("uniform vec3 light"+b+"_shadowParams;\n"),h=x==pc.LIGHTTYPE_POINT?h+("uniform samplerCube light"+b+"_shadowMap;\n"):h+("uniform sampler2D light"+b+"_shadowMap;\n"),l++);a.alphaTest&&(h+=m(e,"fs_alpha_test_decl"));h+="\n";b=a.heightMap?" + data.uvOffset":"";n=a.fastTbn?r.TBNfastPS:r.TBNPS;if(c||g)a.normalMap&&f?(h+=a.packedNormal?r.normalXYPS:r.normalXYZPS,f=this._uvSource(a.normalMapTransform,
a.normalMapUv)+b,h=a.needsNormalFloat?h+(a.fastTbn?r.normalMapFloatTBNfastPS:r.normalMapFloatPS).replace(/\$UV/g,f):h+r.normalMapPS.replace(/\$UV/g,f),h+=n):h+=r.normalVertexPS;h+=pc.programlib.gammaCode(a.gamma);h+=pc.programlib.tonemapCode(a.toneMap);h="linear"===a.fog?h+r.fogLinearPS:"exp"===a.fog?h+r.fogExpPS:"exp2"===a.fog?h+r.fogExp2PS:h+r.fogNonePS;a.rgbmReflection&&(h+=r.rgbmPS);d&&(h+=a.fixSeams?r.fixCubemapSeamsStretchPS:r.fixCubemapSeamsNonePS,h+=0<a.cubeMapProjection?r.cubeMapProjectBoxPS:
r.cubeMapProjectNonePS);h+=this._addMap("diffuse",a,r,b);h+=this._addMap("opacity",a,r,b);h+=this._addMap("emissive",a,r,b,null,a.emissiveFormat);a.useSpecular&&(h=a.specularAA&&a.normalMap?a.needsNormalFloat&&(c||g)?h+r.specularAaToksvigFloatPS:h+r.specularAaToksvigPS:h+r.specularAaNonePS,h+=this._addMap(a.useMetalness?"metalness":"specular",a,r,b),h+=this._addMap("gloss",a,r,b),0<a.fresnelModel&&(a.fresnelModel===pc.FRESNEL_SIMPLE?h+=r.fresnelSimplePS:a.fresnelModel===pc.FRESNEL_SCHLICK?h+=r.fresnelSchlickPS:
a.fresnelModel===pc.FRESNEL_COMPLEX&&(h+=r.fresnelComplexPS)));a.heightMap&&(a.normalMap||(h+=n),h+=this._addMap("height",a,r,"",r.parallaxPS));a.aoMap&&(h+=this._addMap("ao",a,r,b,r.aoBakedPS));f=a.rgbmReflection?"decodeRGBM":a.hdrReflection?"":"gammaCorrectInput";d&&(h=a.prefilteredCubemap?k?h+r.reflectionPrefilteredCubeLodPS.replace(/\$DECODE/g,f):h+r.reflectionPrefilteredCubePS.replace(/\$DECODE/g,f):h+r.reflectionCubePS.replace(/\$textureCubeSAMPLE/g,a.rgbmReflection?"textureCubeRGBM":a.hdrReflection?
"textureCube":"textureCubeSRGB"));a.sphereMap&&(n=16<e.fragmentUniformsCount?r.reflectionSpherePS:r.reflectionSphereLowPS,n=n.replace(/\$texture2DSAMPLE/g,a.rgbmReflection?"texture2DRGBM":a.hdrReflection?"texture2D":"texture2DSRGB"),h+=n);if((d||a.sphereMap)&&a.refraction)h+=r.refractionPS;h=a.lightMap?h+this._addMap("light",a,r,b,r.lightmapSinglePS):a.prefilteredCubemap?k?h+r.ambientPrefilteredCubeLodPS.replace(/\$DECODE/g,f):h+r.ambientPrefilteredCubePS.replace(/\$DECODE/g,f):h+r.ambientConstantPS;
0<l&&(h+=r.shadowCoordPS+r.shadowPS,0<=C&&(h+=r.shadowVSPS));h+=r.lightDiffuseLambertPS;k=!1;a.useSpecular?(h+=a.shadingModel===pc.SPECULAR_PHONG?r.lightSpecularPhongPS:r.lightSpecularBlinnPS,a.sphereMap||d||0<a.fresnelModel?h=0<a.fresnelModel?a.conserveEnergy?h+r.combineDiffuseSpecularPS:h+r.combineDiffuseSpecularNoConservePS:h+r.combineDiffuseSpecularOldPS:a.diffuseMap?h+=r.combineDiffuseSpecularNoReflPS:(h+=r.combineDiffuseSpecularNoReflSeparateAmbientPS,k=!0)):h+=r.combineDiffusePS;a.modulateAmbient&&
!k&&(h+="uniform vec3 material_ambient;\n");h+=r.startPS;if(c||g){h+="   getViewDir(data);\n";if(a.heightMap||a.normalMap)h+="   getTBN(data);\n";a.heightMap&&(h+="   getParallax(data);\n");h+="   getNormal(data);\n";a.useSpecular&&(h+="   getReflDir(data);\n")}h+="   getAlbedo(data);\n";if(c&&a.useSpecular||g)h+="   getSpecularity(data);\n",h+="   getGlossiness(data);\n",0<a.fresnelModel&&(h+="   getFresnel(data);\n");h+="   getOpacity(data);\n";a.alphaTest&&(h+="   if (data.alpha < alpha_ref) discard;");
h+="   addAmbient(data);\n";a.modulateAmbient&&!k&&(h+="   data.diffuseLight *= material_ambient;\n");a.aoMap&&!a.occludeDirect&&(h+="    applyAO(data);\n");if(c||g){if(d||a.sphereMap)h+="   addReflection(data);\n";for(b=0;b<a.lights.length;b++)c=a.lights[b],x=c.getType(),x==pc.LIGHTTYPE_DIRECTIONAL?(h+="   data.lightDirNormW = light"+b+"_direction;\n",h+="   data.atten = 1.0;\n"):(h+="   getLightDirPoint(data, light"+b+"_position);\n",h=c.getFalloffMode()==pc.LIGHTFALLOFF_LINEAR?h+("   data.atten = getFalloffLinear(data, light"+
b+"_radius);\n"):h+("   data.atten = getFalloffInvSquared(data, light"+b+"_radius);\n"),x==pc.LIGHTTYPE_SPOT&&(h+="   data.atten *= getSpotEffect(data, light"+b+"_spotDirection, light"+b+"_innerConeAngle, light"+b+"_outerConeAngle);\n")),h+="   data.atten *= getLightDiffuse(data);\n",c.getCastShadows()&&!a.noShadow&&(g=null,c._shadowType<=pc.SHADOW_DEPTHMASK&&(a.shadowSampleType===pc.SHADOWSAMPLE_HARD?g="Hard":c._shadowType===pc.SHADOW_DEPTH&&a.shadowSampleType===pc.SHADOWSAMPLE_PCF3X3?g="PCF3x3":
c._shadowType===pc.SHADOW_DEPTHMASK&&a.shadowSampleType===pc.SHADOWSAMPLE_PCF3X3?g="PCF3x3_YZW":c._shadowType===pc.SHADOW_DEPTHMASK&&a.shadowSampleType===pc.SHADOWSAMPLE_MASK&&(g="Mask")),null!==g&&(x==pc.LIGHTTYPE_POINT?(k="(data, light"+b+"_shadowMap, light"+b+"_shadowParams);\n",c.getNormalOffsetBias()&&(h+="   normalOffsetPointShadow(data, light"+b+"_shadowParams);\n"),h+="   data.atten *= getShadowPoint"+g+k):(C===b?g+="VS":(k="(data, light"+b+"_shadowMatrix, light"+b+"_shadowParams);\n",h+=
this._nonPointShadowMapProjection(a.lights[b],k)),h+="   data.atten *= getShadow"+g+"(data, light"+b+"_shadowMap, light"+b+"_shadowParams);\n"))),h+="   data.diffuseLight += data.atten * light"+b+"_color;\n",a.useSpecular&&(h+="   data.atten *= getLightSpecular(data);\n",h+="   data.specularLight += data.atten * light"+b+"_color;\n"),h+="\n";if((d||a.sphereMap)&&a.refraction)h+="   addRefraction(data);\n"}h+="\n";a.aoMap&&(a.occludeDirect&&(h+="    applyAO(data);\n"),a.occludeSpecular&&(h+="    occludeSpecular(data);\n"));
h+=r.endPS;h+=m(e,"fs_clamp");d=h+=m(e,"common_main_end");return{attributes:v,vshader:s,fshader:d}}};pc.programlib.pick={generateKey:function(e,a){var b="pick";a.skin&&(b+="_skin");return b},createShaderDefinition:function(e,a){var b={vertex_position:pc.SEMANTIC_POSITION};a.skin&&(b.vertex_boneWeights=pc.SEMANTIC_BLENDWEIGHT,b.vertex_boneIndices=pc.SEMANTIC_BLENDINDICES);var c=pc.programlib.getSnippet,d;d=""+c(e,"vs_transform_decl");a.skin&&(d+=c(e,"vs_skin_decl"));d+=c(e,"common_main_begin");a.skin?(d+="    mat4 modelMatrix = vertex_boneWeights.x * getBoneMatrix(vertex_boneIndices.x) +\n                       vertex_boneWeights.y * getBoneMatrix(vertex_boneIndices.y) +\n",
d+="                       vertex_boneWeights.z * getBoneMatrix(vertex_boneIndices.z) +\n",d+="                       vertex_boneWeights.w * getBoneMatrix(vertex_boneIndices.w);\n"):d+="    mat4 modelMatrix = matrix_model;\n";d+="\n";d+="    vec4 positionW = modelMatrix * vec4(vertex_position, 1.0);\n";d+="    gl_Position = matrix_viewProjection * positionW;\n\n";var g=d+=c(e,"common_main_end");d=c(e,"fs_precision");d+=c(e,"fs_flat_color_decl");d+=c(e,"common_main_begin");d+=c(e,"fs_flat_color");
d+=c(e,"common_main_end");return{attributes:b,vshader:g,fshader:d}}};pc.programlib.skybox={generateKey:function(e,a){return"skybox"+a.rgbm+" "+a.hdr+" "+a.fixSeams+""+a.toneMapping+""+a.gamma},createShaderDefinition:function(e,a){var b=pc.programlib.getSnippet,c=pc.shaderChunks;return{attributes:{aPosition:pc.SEMANTIC_POSITION},vshader:"attribute vec3 aPosition;\n\nuniform mat4 matrix_view;\nuniform mat4 matrix_projection;\n\nvarying vec3 vViewDir;\n\nvoid main(void)\n{\n    mat4 view = matrix_view;\n    view[3][0] = view[3][1] = view[3][2] = 0.0;\n    gl_Position = matrix_projection * view * vec4(aPosition, 1.0);\n    gl_Position.z = gl_Position.w - 0.00001;\n    vViewDir = aPosition;\n    vViewDir.x *= -1.0;\n}",
fshader:b(e,"fs_precision")+(a.fixSeams?c.fixCubemapSeamsStretchPS:c.fixCubemapSeamsNonePS)+(a.hdr?pc.programlib.gammaCode(a.gamma)+pc.programlib.tonemapCode(a.toneMapping)+c.rgbmPS+c.skyboxHDRPS.replace(/\$textureCubeSAMPLE/g,a.rgbm?"textureCubeRGBM":a.hdr?"textureCube":"textureCubeSRGB"):c.skyboxPS)}}};pc.extend(pc,function(){var e=function(a){this.device=a;this.depthMap=this.shader=null;this.vertexBuffer=pc.createFullscreenQuad(a);this.needsDepthBuffer=!1};e.prototype={render:function(){}};return{PostEffect:e,createFullscreenQuad:function(a){var b=new pc.VertexFormat(a,[{semantic:pc.SEMANTIC_POSITION,components:2,type:pc.ELEMENTTYPE_FLOAT32}]),a=new pc.VertexBuffer(a,b,4),b=new pc.VertexIterator(a);b.element[pc.SEMANTIC_POSITION].set(-1,-1);b.next();b.element[pc.SEMANTIC_POSITION].set(1,-1);b.next();
b.element[pc.SEMANTIC_POSITION].set(-1,1);b.next();b.element[pc.SEMANTIC_POSITION].set(1,1);b.end();return a},drawFullscreenQuad:function(a,b,c,d,g){a.setRenderTarget(b);a.updateBegin();var e=null!==b?b.width:a.width,b=null!==b?b.height:a.height,k=0,m=0;g&&(k=g.x*e,m=g.y*b,e*=g.z,b*=g.w);a.setViewport(k,m,e,b);a.setScissor(k,m,e,b);g=a.getBlending();e=a.getDepthTest();b=a.getDepthWrite();a.setBlending(!1);a.setDepthTest(!1);a.setDepthWrite(!1);a.setVertexBuffer(c,0);a.setShader(d);a.draw({type:pc.PRIMITIVE_TRISTRIP,
base:0,count:4,indexed:!1});a.setBlending(g);a.setDepthTest(e);a.setDepthWrite(b);a.updateEnd()}}}());pc.extend(pc,function(){function e(a,b){this.app=a;this.camera=b;this.effects=[];this.enabled=!1;this.depthTarget=null;this.renderTargetScale=1;this.resizeTimeout=null;b.on("set_rect",this.onCameraRectChanged,this)}e.prototype={_createOffscreenTarget:function(a){var b=this.camera.rect,b=new pc.Texture(this.app.graphicsDevice,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:Math.floor(b.z*this.app.graphicsDevice.width*this.renderTargetScale),height:Math.floor(b.w*this.app.graphicsDevice.height*this.renderTargetScale)});
b.minFilter=pc.FILTER_NEAREST;b.magFilter=pc.FILTER_NEAREST;b.addressU=pc.ADDRESS_CLAMP_TO_EDGE;b.addressV=pc.ADDRESS_CLAMP_TO_EDGE;return new pc.RenderTarget(this.app.graphicsDevice,b,{depth:a})},_setDepthTarget:function(a){this.depthTarget!==a&&(this.depthTarget&&this.depthTarget.destroy(),this.depthTarget=a);this.camera.camera._depthTarget=a},setRenderTargetScale:function(a){this.renderTargetScale=a;this.resizeRenderTargets()},addEffect:function(a){var b=0===this.effects.length,c=this.effects,
d={effect:a,inputTarget:this._createOffscreenTarget(b),outputTarget:null};a.needsDepthBuffer&&(this.depthTarget||this._setDepthTarget(this._createOffscreenTarget(!0)),a.depthMap=this.depthTarget.colorBuffer);b&&(this.camera.renderTarget=d.inputTarget);c.push(d);a=c.length;1<a&&(c[a-2].outputTarget=d.inputTarget);this.enable()},removeEffect:function(a){for(var b=-1,c=0,d=this.effects.length;c<d;c++)if(this.effects[c].effect===a){b=c;break}0<=b&&(0<b?this.effects[b-1].outputTarget=b+1<this.effects.length?
this.effects[b+1].inputTarget:null:1<this.effects.length&&(this.effects[1].inputTarget._depth||(this.effects[1].inputTarget.destroy(),this.effects[1].inputTarget=this._createOffscreenTarget(!0)),this.camera.renderTarget=this.effects[1].inputTarget),this.effects[b].inputTarget.destroy(),this.effects.splice(b,1));if(this.depthTarget){a=!1;c=0;for(d=this.effects.length;c<d;c++)if(this.effects[c].effect.needsDepthBuffer){a=!0;break}a||this._setDepthTarget(null)}0===this.effects.length&&this.disable()},
destroy:function(){this.depthTarget&&(this.depthTarget.destroy(),this.depthTarget=null);for(var a=0,b=this.effects.length;a<b;a++)this.effects[a].inputTarget.destroy();this.effects.length=0;this.disable()},enable:function(){if(!this.enabled&&this.effects.length){this.enabled=!0;var a=this.effects,b=this.camera;this.app.graphicsDevice.on("resizecanvas",this._onCanvasResized,this);b.camera.setRect(0,0,1,1);this.command=new pc.Command(pc.LAYER_FX,pc.BLEND_NONE,function(){if(this.enabled&&b.data.isRendering){var c=
null,d=a.length;if(d){b.renderTarget=a[0].inputTarget;this._setDepthTarget(this.depthTarget);for(var g=0;g<d;g++){var e=a[g];g===d-1&&(c=b.rect);e.effect.render(e.inputTarget,e.outputTarget,c)}}}}.bind(this));this.app.scene.drawCalls.push(this.command)}},disable:function(){if(this.enabled){this.enabled=!1;this.app.graphicsDevice.off("resizecanvas",this._onCanvasResized,this);this.camera.renderTarget=null;this.camera.camera._depthTarget=null;var a=this.camera.rect;this.camera.camera.setRect(a.x,a.y,
a.z,a.w);a=this.app.scene.drawCalls.indexOf(this.command);0<=a&&this.app.scene.drawCalls.splice(a,1)}},_onCanvasResized:function(){this.resizeTimeout&&clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(this.resizeRenderTargets.bind(this),500)},resizeRenderTargets:function(){var a=this.camera.rect,b=Math.floor(a.z*this.app.graphicsDevice.width*this.renderTargetScale),a=Math.floor(a.w*this.app.graphicsDevice.height*this.renderTargetScale),c=this.effects;this.depthTarget&&(this.depthTarget.width!==
b&&this.depthTarget.height!==a)&&this._setDepthTarget(this._createOffscreenTarget(!0));for(var d=0,g=c.length;d<g;d++){var e=c[d];if(e.inputTarget.width!==b||e.inputTarget.height!==a)e.inputTarget.destroy(),e.inputTarget=this._createOffscreenTarget(e.effect.needsDepthBuffer||0===d),e.effect.needsDepthBuffer&&(e.depthMap=this.depthTarget),0<d?c[d-1].outputTarget=e.inputTarget:this.camera.renderTarget=e.inputTarget}},onCameraRectChanged:function(){this.enabled&&(this.camera.camera.setRect(0,0,1,1),
this.resizeRenderTargets())}};return{PostEffectQueue:e}}());(function(){var e={BLEND_SUBTRACTIVE:0,BLEND_ADDITIVE:1,BLEND_NORMAL:2,BLEND_NONE:3,BLEND_PREMULTIPLIED:4,BLEND_MULTIPLICATIVE:5,FOG_NONE:"none",FOG_LINEAR:"linear",FOG_EXP:"exp",FOG_EXP2:"exp2",FRESNEL_NONE:0,FRESNEL_SIMPLE:1,FRESNEL_SCHLICK:2,FRESNEL_COMPLEX:3,LAYER_HUD:0,LAYER_GIZMO:1,LAYER_FX:2,LAYER_WORLD:3,LIGHTTYPE_DIRECTIONAL:0,LIGHTTYPE_POINT:1,LIGHTTYPE_SPOT:2,LIGHTFALLOFF_LINEAR:0,LIGHTFALLOFF_INVERSESQUARED:1,SHADOW_DEPTH:0,SHADOW_DEPTHMASK:1,SHADOWSAMPLE_HARD:0,SHADOWSAMPLE_PCF3X3:1,
SHADOWSAMPLE_MASK:2,PARTICLESORT_NONE:0,PARTICLESORT_DISTANCE:1,PARTICLESORT_NEWER_FIRST:2,PARTICLESORT_OLDER_FIRST:3,PARTICLEMODE_GPU:0,PARTICLEMODE_CPU:1,EMITTERSHAPE_BOX:0,EMITTERSHAPE_SPHERE:1,PROJECTION_PERSPECTIVE:0,PROJECTION_ORTHOGRAPHIC:1,RENDERSTYLE_SOLID:0,RENDERSTYLE_WIREFRAME:1,RENDERSTYLE_POINTS:2,CUBEPROJ_NONE:0,CUBEPROJ_BOX:1,SPECULAR_PHONG:0,SPECULAR_BLINN:1,GAMMA_NONE:0,GAMMA_SRGB:1,GAMMA_SRGBFAST:2,TONEMAP_LINEAR:0,TONEMAP_FILMIC:1,SHADERDEF_NOSHADOW:1,SHADERDEF_SKIN:2,SHADOWUPDATE_NONE:0,
SHADOWUPDATE_THISFRAME:1,SHADOWUPDATE_REALTIME:2};pc.extend(pc,e);pc.scene={};pc.extend(pc.scene,e)})();
pc.extend(pc,function(){var e=function(){this.drawCalls=[];this.shadowCasters=[];this.fog=pc.FOG_NONE;this.fogColor=new pc.Color(0,0,0);this.fogStart=1;this.fogEnd=1E3;this.fogDensity=0;this.ambientLight=new pc.Color(0,0,0);this._gammaCorrection=pc.GAMMA_NONE;this._toneMapping=0;this.exposure=1;this._skyboxModel=this._skyboxCubeMap=this._skyboxPrefiltered4=this._skyboxPrefiltered8=this._skyboxPrefiltered16=this._skyboxPrefiltered32=this._skyboxPrefiltered64=this._skyboxPrefiltered128=null;this._models=
[];this._lights=[];this._globalLights=[];this._localLights=[[],[]];this.updateShaders=!0};Object.defineProperty(e.prototype,"fog",{get:function(){return this._fog},set:function(a){a!==this._fog&&(this._fog=a,this.updateShaders=!0)}});Object.defineProperty(e.prototype,"gammaCorrection",{get:function(){return this._gammaCorrection},set:function(a){a!==this._gammaCorrection&&(this._gammaCorrection=a,this.updateShaders=!0)}});Object.defineProperty(e.prototype,"toneMapping",{get:function(){return this._toneMapping},
set:function(a){a!==this._toneMapping&&(this._toneMapping=a,this.updateShaders=!0)}});Object.defineProperty(e.prototype,"skybox",{get:function(){return this._skyboxCubeMap},set:function(a){this._skyboxCubeMap=a;this._skyboxModel&&this.containsModel(this._skyboxModel)&&this.removeModel(this._skyboxModel);this._skyboxModel=null;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered128",{get:function(){return this._skyboxPrefiltered128},set:function(a){this._skyboxPrefiltered128=
a;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered64",{get:function(){return this._skyboxPrefiltered64},set:function(a){this._skyboxPrefiltered64=a;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered32",{get:function(){return this._skyboxPrefiltered32},set:function(a){this._skyboxPrefiltered32=a;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered16",{get:function(){return this._skyboxPrefiltered16},set:function(a){this._skyboxPrefiltered16=
a;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered8",{get:function(){return this._skyboxPrefiltered8},set:function(a){this._skyboxPrefiltered8=a;this.updateShaders=!0}});Object.defineProperty(e.prototype,"skyboxPrefiltered4",{get:function(){return this._skyboxPrefiltered4},set:function(a){this._skyboxPrefiltered4=a;this.updateShaders=!0}});e.prototype._updateShaders=function(a){var b;if(this._skyboxCubeMap&&!this._skyboxModel){var c=new pc.Material,d=this;c.updateShader=
function(){var b=a.getProgramLibrary().getProgram("skybox",{rgbm:d._skyboxCubeMap.rgbm,hdr:d._skyboxCubeMap.rgbm||d._skyboxCubeMap.format===pc.PIXELFORMAT_RGBA32F,fixSeams:d._skyboxCubeMap.fixCubemapSeams,gamma:d.gammaCorrection,toneMapping:d.toneMapping});this.setShader(b)};c.updateShader();c.setParameter("texture_cubeMap",this._skyboxCubeMap);c.cull=pc.CULLFACE_NONE;b=new pc.GraphNode;var g=pc.createBox(a),c=new pc.MeshInstance(b,g,c),g=new pc.Model;g.graph=b;g.meshInstances=[c];this._skyboxModel=
g;this.addModel(g)}c=[];g=this.drawCalls;for(b=0;b<g.length;b++){var e=g[b];void 0!==e.material&&-1===c.indexOf(e.material)&&c.push(e.material)}for(b=0;b<c.length;b++)c[b].clearVariants(),c[b].updateShader(a,this),c[b].variants[0]=c[b].shader};e.prototype.getModels=function(){return this._models};e.prototype.addModel=function(a){var b;if(-1===this._models.indexOf(a)){this._models.push(a);var c=a.getMaterials();for(b=0;b<c.length;b++)c[b].scene=this;var d=a.meshInstances.length;for(b=0;b<d;b++)c=a.meshInstances[b],
-1===this.drawCalls.indexOf(c)&&this.drawCalls.push(c),c.castShadow&&-1===this.shadowCasters.indexOf(c)&&this.shadowCasters.push(c);a=a.getLights();b=0;for(len=a.length;b<len;b++)this.addLight(a[b])}};e.prototype.removeModel=function(a){var b,c=this._models.indexOf(a);if(-1!==c){this._models.splice(c,1);c=a.getMaterials();for(b=0;b<c.length;b++)c[b].scene=null;var d,g=a.meshInstances.length;for(b=0;b<g;b++)d=a.meshInstances[b],c=this.drawCalls.indexOf(d),-1!==c&&this.drawCalls.splice(c,1),d.castShadow&&
(c=this.shadowCasters.indexOf(d),-1!==c&&this.shadowCasters.splice(c,1));a=a.getLights();b=0;for(len=a.length;b<len;b++)this.removeLight(a[b])}};e.prototype.containsModel=function(a){return 0<=this._models.indexOf(a)};e.prototype.addLight=function(a){-1!==this._lights.indexOf(a)?console.warn("pc.Scene#addLight: light is already in the scene"):(this._lights.push(a),a._scene=this,this.updateShaders=!0)};e.prototype.removeLight=function(a){var b=this._lights.indexOf(a);-1===b?console.warn("pc.Scene#removeLight: light is not in the scene"):
(this._lights.splice(b,1),a._scene=null,this.updateShaders=!0)};e.prototype.update=function(){for(var a=0,b=this._models.length;a<b;a++)this._models[a].getGraph().syncHierarchy()};return{Scene:e}}());pc.extend(pc,function(){function e(a,b){return a.distSqr&&b.distSqr?b.distSqr-a.distSqr:b.key-a.key}function a(a,b){var c;if(b.getType()===pc.LIGHTTYPE_POINT){c=b._shadowResolution;c=new pc.Texture(a,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:c,height:c,cubemap:!0,autoMipmap:!1});c.minFilter=pc.FILTER_NEAREST;c.magFilter=pc.FILTER_NEAREST;c.addressU=pc.ADDRESS_CLAMP_TO_EDGE;c.addressV=pc.ADDRESS_CLAMP_TO_EDGE;for(var d=[],g=0;6>g;g++){var e=new pc.RenderTarget(a,c,{face:g,depth:!0});d.push(e)}c=d;b._shadowCamera.setRenderTarget(c[0]);
b._shadowCubeMap=c}else c=new pc.Texture(a,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:b._shadowResolution,height:b._shadowResolution,autoMipmap:!1}),c.minFilter=pc.FILTER_NEAREST,c.magFilter=pc.FILTER_NEAREST,c.addressU=pc.ADDRESS_CLAMP_TO_EDGE,c.addressV=pc.ADDRESS_CLAMP_TO_EDGE,c=new pc.RenderTarget(a,c,!0),b._shadowCamera.setRenderTarget(c)}function b(a){this.device=a;a=this.device.getProgramLibrary();this._depthShaderStatic=a.getProgram("depth",{skin:!1});this._depthShaderSkin=a.getProgram("depth",
{skin:!0});this._depthProgStatic=[];this._depthProgSkin=[];this._depthProgStaticOp=[];this._depthProgSkinOp=[];this._depthProgStaticPoint=[];this._depthProgSkinPoint=[];this._depthProgStaticOpPoint=[];this._depthProgSkinOpPoint=[];for(var b=["r","g","b","a"],c=0;c<pc.SHADOW_DEPTH+1;c++){this._depthProgStatic[c]=a.getProgram("depthrgba",{skin:!1,opacityMap:!1,shadowType:c});this._depthProgSkin[c]=a.getProgram("depthrgba",{skin:!0,opacityMap:!1,shadowType:c});this._depthProgStaticPoint[c]=a.getProgram("depthrgba",
{skin:!1,opacityMap:!1,point:!0});this._depthProgSkinPoint[c]=a.getProgram("depthrgba",{skin:!0,opacityMap:!1,point:!0});this._depthProgStaticOp[c]={};this._depthProgSkinOp[c]={};this._depthProgStaticOpPoint[c]={};this._depthProgSkinOpPoint[c]={};for(var d=0;4>d;d++)this._depthProgStaticOp[c][b[d]]=a.getProgram("depthrgba",{skin:!1,opacityMap:!0,shadowType:c,opacityChannel:b[d]}),this._depthProgSkinOp[c][b[d]]=a.getProgram("depthrgba",{skin:!0,opacityMap:!0,shadowType:c,opacityChannel:b[d]}),this._depthProgStaticOpPoint[c][b[d]]=
a.getProgram("depthrgba",{skin:!1,opacityMap:!0,point:!0,opacityChannel:b[d]}),this._depthProgSkinOpPoint[c][b[d]]=a.getProgram("depthrgba",{skin:!0,opacityMap:!0,point:!0,opacityChannel:b[d]})}a=this.device.scope;this.projId=a.resolve("matrix_projection");this.viewId=a.resolve("matrix_view");this.viewId3=a.resolve("matrix_view3");this.viewInvId=a.resolve("matrix_viewInverse");this.viewProjId=a.resolve("matrix_viewProjection");this.viewPosId=a.resolve("view_position");this.nearClipId=a.resolve("camera_near");
this.farClipId=a.resolve("camera_far");this.lightRadiusId=a.resolve("light_radius");this.fogColorId=a.resolve("fog_color");this.fogStartId=a.resolve("fog_start");this.fogEndId=a.resolve("fog_end");this.fogDensityId=a.resolve("fog_density");this.modelMatrixId=a.resolve("matrix_model");this.normalMatrixId=a.resolve("matrix_normal");this.poseMatrixId=a.resolve("matrix_pose[0]");this.boneTextureId=a.resolve("texture_poseMap");this.boneTextureSizeId=a.resolve("texture_poseMapSize");this.alphaTestId=a.resolve("alpha_ref");
this._shadowAabb=new pc.shape.Aabb;this._sceneAabb=new pc.shape.Aabb;this._shadowState={blend:!1};this.centroid=new pc.Vec3;this.fogColor=new Float32Array(3);this.ambientColor=new Float32Array(3)}var c=(new pc.Mat4).setScale(0.5,0.5,0.5),d=(new pc.Mat4).setTranslate(0.5,0.5,0.5),g=(new pc.Mat4).mul2(d,c),f=(new pc.Mat4).setFromAxisAngle(pc.Vec3.RIGHT,-90),k=new pc.Mat4,m=new pc.Mat4,h=new pc.Mat4,n=new pc.Mat4,l=new pc.Mat4,r=new pc.Mat3,v=new pc.Mat4,s={},C=new pc.Mat4,x=[];for(i=0;8>i;i++)x.push(new pc.Vec3);
pc.extend(b.prototype,{setCamera:function(a,b){var c=a.getProjectionMatrix();this.projId.setValue(c.data);var d=a._node.getPosition(),g=a._node.getRotation();n.setTRS(d,g,pc.Vec3.ONE);this.viewInvId.setValue(n.data);l.copy(n).invert();this.viewId.setValue(l.data);r.data[0]=l.data[0];r.data[1]=l.data[1];r.data[2]=l.data[2];r.data[3]=l.data[4];r.data[4]=l.data[5];r.data[5]=l.data[6];r.data[6]=l.data[8];r.data[7]=l.data[9];r.data[8]=l.data[10];this.viewId3.setValue(r.data);v.mul2(c,l);this.viewProjId.setValue(v.data);
this.viewPosId.setValue(a._node.getPosition().data);this.nearClipId.setValue(a.getNearClip());this.farClipId.setValue(a.getFarClip());a._frustum.update(c,l);var c=this.device,e=a.getRenderTarget();c.setRenderTarget(e);c.updateBegin();var g=a.getRect(),d=e?e.width:c.width,e=e?e.height:c.height,f=Math.floor(g.x*d),h=Math.floor(g.y*e),k=Math.floor(g.width*d),g=Math.floor(g.height*e);c.setViewport(f,h,k,g);c.setScissor(f,h,k,g);c.clear(a.getClearOptions());b&&c.setScissor(1,1,d-2,e-2)},dispatchGlobalLights:function(a){var b;
this.mainLight=-1;this._activeShadowLights=[];var c=this.device.scope;this.ambientColor[0]=a.ambientLight.r;this.ambientColor[1]=a.ambientLight.g;this.ambientColor[2]=a.ambientLight.b;if(a.gammaCorrection)for(b=0;3>b;b++)this.ambientColor[b]=Math.pow(this.ambientColor[b],2.2);c.resolve("light_globalAmbient").setValue(this.ambientColor);c.resolve("exposure").setValue(a.exposure)},dispatchDirectLights:function(a,b){var c=a._globalLights,d=c.length,g,e,f,h,k=0,m=this.device.scope;for(g=0;g<d;g++)c[g].mask&
b&&(e=c[g],f=e._node.getWorldTransform(),h="light"+k,m.resolve(h+"_color").setValue(a.gammaCorrection?e._linearFinalColor.data:e._finalColor.data),f.getY(e._direction).scale(-1),m.resolve(h+"_direction").setValue(e._direction.normalize().data),e.getCastShadows()&&(f=this.device.extDepthTexture?e._shadowCamera._renderTarget._depthTexture:e._shadowCamera._renderTarget.colorBuffer,m.resolve(h+"_shadowMap").setValue(f),m.resolve(h+"_shadowMatrix").setValue(e._shadowMatrix.data),m.resolve(h+"_shadowParams").setValue([e._shadowResolution,
e._normalOffsetBias,e._shadowBias]),this._activeShadowLights.push(e),0>this.mainLight&&(m.resolve(h+"_shadowMatrixVS").setValue(e._shadowMatrix.data),m.resolve(h+"_shadowParamsVS").setValue([e._shadowResolution,e._normalOffsetBias,e._shadowBias]),m.resolve(h+"_directionVS").setValue(e._direction.normalize().data),this.mainLight=g)),k++);return k},dispatchLocalLights:function(a,b,c){var d,g,e,f,h;d=a._localLights;var k=0;f=d[pc.LIGHTTYPE_POINT-1];var m=d[pc.LIGHTTYPE_SPOT-1],l=f.length,n=m.length,
r=this.device.scope;for(d=0;d<l;d++)f[d].mask&b&&(e=f[d],g=e._node.getWorldTransform(),h="light"+(c+k),r.resolve(h+"_radius").setValue(e._attenuationEnd),r.resolve(h+"_color").setValue(a.gammaCorrection?e._linearFinalColor.data:e._finalColor.data),g.getTranslation(e._position),r.resolve(h+"_position").setValue(e._position.data),e.getCastShadows()&&(g=this.device.extDepthTexture?e._shadowCamera._renderTarget._depthTexture:e._shadowCamera._renderTarget.colorBuffer,r.resolve(h+"_shadowMap").setValue(g),
r.resolve(h+"_shadowMatrix").setValue(e._shadowMatrix.data),r.resolve(h+"_shadowParams").setValue([e._shadowResolution,e._normalOffsetBias,e._shadowBias,1/e.getAttenuationEnd()]),this._activeShadowLights.push(e)),k++);for(d=0;d<n;d++)m[d].mask&b&&(f=m[d],g=f._node.getWorldTransform(),h="light"+(c+k),r.resolve(h+"_innerConeAngle").setValue(f._innerConeAngleCos),r.resolve(h+"_outerConeAngle").setValue(f._outerConeAngleCos),r.resolve(h+"_radius").setValue(f._attenuationEnd),r.resolve(h+"_color").setValue(a.gammaCorrection?
f._linearFinalColor.data:f._finalColor.data),g.getTranslation(f._position),r.resolve(h+"_position").setValue(f._position.data),g.getY(f._direction).scale(-1),r.resolve(h+"_spotDirection").setValue(f._direction.data),f.getCastShadows()&&(g=this.device.extDepthTexture?f._shadowCamera._renderTarget._depthTexture:f._shadowCamera._renderTarget.colorBuffer,r.resolve(h+"_shadowMap").setValue(g),r.resolve(h+"_shadowMatrix").setValue(f._shadowMatrix.data),r.resolve(h+"_shadowParams").setValue([f._shadowResolution,
f._normalOffsetBias,f._shadowBias]),this._activeShadowLights.push(f),0>this.mainLight&&(r.resolve(h+"_shadowMatrixVS").setValue(f._shadowMatrix.data),r.resolve(h+"_shadowParamsVS").setValue([f._shadowResolution,f._normalOffsetBias,f._shadowBias]),r.resolve(h+"_positionVS").setValue(f._position.data),this.mainLight=d)),k++)},render:function(b,c){var d=this.device,l=d.scope;b._activeCamera=c;b.updateShaders&&(b._updateShaders(d),b.updateShaders=!1);var n=b._lights,r=b.drawCalls,v=r.length,N=b.shadowCasters,
G,I,K,E,z,D,H,P=null,L;b._globalLights.length=0;b._localLights[0].length=0;for(G=b._localLights[1].length=0;G<n.length;G++)E=n[G],E.getEnabled()&&(E.getType()===pc.LIGHTTYPE_DIRECTIONAL?b._globalLights.push(E):b._localLights[E.getType()===pc.LIGHTTYPE_POINT?0:1].push(E));this.culled=[];var S,M=c._node.getPosition();for(G=0;G<v;G++){E=r[G];S=!0;if(!E.command){if(E._hidden)continue;z=E;if(z.layer===pc.LAYER_WORLD&&(D=z.aabb.center,c.frustumCulling&&(z.aabb._radius||(z.aabb._radius=z.aabb.halfExtents.length()),
s.center=D,s.radius=z.aabb._radius,c._frustum.containsSphere(s)||(S=!1)),S))if(z.material.blendType===pc.BLEND_NORMAL||z.material.blendType===pc.BLEND_PREMULTIPLIED){z.syncAabb();var R=D.x-M.x;I=D.y-M.y;D=D.z-M.z;z.distSqr=R*R+I*I+D*D}else void 0!==z.distSqr&&delete z.distSqr}S&&this.culled.push(E)}r=this.culled;v=this.culled.length;for(G=0;G<v;G++)E=r[G],E.skinInstance&&E.skinInstance.updateMatrixPalette();r.sort(e);if(c._depthTarget){S=c.getRenderTarget();c.setRenderTarget(c._depthTarget);this.setCamera(c);
M=d.getBlending();d.setBlending(!1);for(G=0;G<v;G++){E=r[G];if(!E.command&&E.drawToDepth){z=E;D=z.mesh;this.modelMatrixId.setValue(z.node.worldTransform.data);if(z.skinInstance){if(d.supportsBoneTextures){this.boneTextureId.setValue(z.skinInstance.boneTexture);L=z.skinInstance.boneTexture.width;var O=z.skinInstance.boneTexture.height;this.boneTextureSizeId.setValue([L,O])}else this.poseMatrixId.setValue(z.skinInstance.matrixPalette);d.setShader(this._depthShaderSkin)}else d.setShader(this._depthShaderStatic);
L=z.renderStyle;d.setVertexBuffer(D.vertexBuffer,0);d.setIndexBuffer(D.indexBuffer[L]);d.draw(D.primitive[L])}c.setRenderTarget(S)}d.setBlending(M)}for(G=0;G<n.length;G++)if(E=n[G],S=E.getType(),E.getCastShadows()&&E.getEnabled()&&E.shadowUpdateMode!==pc.SHADOWUPDATE_NONE){E.shadowUpdateMode===pc.SHADOWUPDATE_THISFRAME&&(E.shadowUpdateMode=pc.SHADOWUPDATE_NONE);M=d;R=E;z=R._shadowCamera;I=void 0;null===z?(z=R,I=pc.CLEARFLAG_DEPTH,M.extDepthTexture||(I|=pc.CLEARFLAG_COLOR),D=new pc.Camera,D.setClearOptions({color:[1,
1,1,1],depth:1,flags:I}),D._node=new pc.GraphNode,z=z._shadowCamera=D,a(M,R)):(I=z.getRenderTarget(),(I.width!==R._shadowResolution||I.height!==R._shadowResolution)&&a(M,R));var M=z,R=1,Q;if(S===pc.LIGHTTYPE_DIRECTIONAL){I=E.getShadowDistance();z=c;D=this.centroid;D.set(0,0,0.5*-(I+z._nearClip));z._node.getWorldTransform().transformPoint(D,D);M._node.setPosition(this.centroid);M._node.setRotation(E._node.getRotation());M._node.rotateLocal(-90,0,0);z=c;D=x;K=z;H=K.getNearClip();L=K.getFov()*Math.PI/
180;O=K.getAspectRatio();K=K.getProjection();var T=Q=void 0,T=K===pc.PROJECTION_PERSPECTIVE?Math.tan(L/2)*H:z._orthoHeight;Q=T*O;D[0].x=Q;D[0].y=-T;D[0].z=-H;D[1].x=Q;D[1].y=T;D[1].z=-H;D[2].x=-Q;D[2].y=T;D[2].z=-H;D[3].x=-Q;D[3].y=-T;D[3].z=-H;K===pc.PROJECTION_PERSPECTIVE&&(T=Math.tan(L/2)*I,Q=T*O);D[4].x=Q;D[4].y=-T;D[4].z=-I;D[5].x=Q;D[5].y=T;D[5].z=-I;D[6].x=-Q;D[6].y=T;D[6].z=-I;D[7].x=-Q;D[7].y=-T;D[7].z=-I;k.copy(M._node.getWorldTransform());z=k.invert();C.mul2(z,c._node.worldTransform);for(I=
0;8>I;I++)C.transformPoint(x[I],x[I]);z=D=H=1E6;L=O=K=-1E6;for(I=0;8>I;I++)Q=x[I],Q.x<z&&(z=Q.x),Q.x>L&&(L=Q.x),Q.y<D&&(D=Q.y),Q.y>O&&(O=Q.y),Q.z<H&&(H=Q.z),Q.z>K&&(K=Q.z);M._node.translateLocal(0.5*-(L+z),0.5*(O+D),K+0.25*(K-H));k.copy(M._node.getWorldTransform());M.setProjection(pc.PROJECTION_ORTHOGRAPHIC);M.setNearClip(0);M.setFarClip(1.5*(K-H));M.setAspectRatio((L-z)/(O-D));M.setOrthoHeight(0.5*(O-D))}else S===pc.LIGHTTYPE_SPOT?(M.setProjection(pc.PROJECTION_PERSPECTIVE),M.setNearClip(E.getAttenuationEnd()/
1E3),M.setFarClip(E.getAttenuationEnd()),M.setAspectRatio(1),M.setFov(2*E.getOuterConeAngle()),z=E._node.getPosition(),I=E._node.getRotation(),k.setTRS(z,I,pc.Vec3.ONE),k.mul2(k,f)):S===pc.LIGHTTYPE_POINT&&(M.setProjection(pc.PROJECTION_PERSPECTIVE),M.setNearClip(E.getAttenuationEnd()/1E3),M.setFarClip(E.getAttenuationEnd()),M.setAspectRatio(1),M.setFov(90),R=6,this.viewPosId.setValue(M._node.getPosition().data),this.lightRadiusId.setValue(E.getAttenuationEnd()));S!=pc.LIGHTTYPE_POINT&&(m.copy(k).invert(),
h.mul2(M.getProjectionMatrix(),m),E._shadowMatrix.mul2(g,h),M._node.worldTransform.copy(k));T="r";for(Q=0;Q<R;Q++){S===pc.LIGHTTYPE_POINT&&(0===Q?M._node.setEulerAngles(0,90,180):1===Q?M._node.setEulerAngles(0,-90,180):2===Q?M._node.setEulerAngles(90,0,0):3===Q?M._node.setEulerAngles(-90,0,0):4===Q?M._node.setEulerAngles(0,180,180):5===Q&&M._node.setEulerAngles(0,0,180),M._node.setPosition(E._node.getPosition()),M.setRenderTarget(E._shadowCubeMap[Q]));this.setCamera(M,S!==pc.LIGHTTYPE_POINT);d.setBlending(!1);
d.setColorWrite(!0,!0,!0,!0);d.setDepthWrite(!0);d.setDepthTest(!0);d.extDepthTexture&&d.setColorWrite(!1,!1,!1,!1);I=0;for(K=N.length;I<K;I++)z=N[I],D=z.mesh,H=z.material,d.setCullMode(H.cull),this.modelMatrixId.setValue(z.node.worldTransform.data),H.opacityMap&&(l.resolve("texture_opacityMap").setValue(H.opacityMap),H.opacityMapChannel&&(T=H.opacityMapChannel)),z.skinInstance?(d.supportsBoneTextures?(this.boneTextureId.setValue(z.skinInstance.boneTexture),L=z.skinInstance.boneTexture.width,O=z.skinInstance.boneTexture.height,
this.boneTextureSizeId.setValue([L,O])):this.poseMatrixId.setValue(z.skinInstance.matrixPalette),S===pc.LIGHTTYPE_POINT?d.setShader(H.opacityMap?this._depthProgSkinOpPoint[E._shadowType][T]:this._depthProgSkinPoint[E._shadowType]):d.setShader(H.opacityMap?this._depthProgSkinOp[E._shadowType][T]:this._depthProgSkin[E._shadowType])):S===pc.LIGHTTYPE_POINT?d.setShader(H.opacityMap?this._depthProgStaticOpPoint[E._shadowType][T]:this._depthProgStaticPoint[E._shadowType]):d.setShader(H.opacityMap?this._depthProgStaticOp[E._shadowType][T]:
this._depthProgStatic[E._shadowType]),L=z.renderStyle,d.setVertexBuffer(D.vertexBuffer,0),d.setIndexBuffer(D.indexBuffer[L]),d.draw(D.primitive[L])}}this.setCamera(c);this.dispatchGlobalLights(b);if(b.fog!==pc.FOG_NONE){this.fogColor[0]=b.fogColor.r;this.fogColor[1]=b.fogColor.g;this.fogColor[2]=b.fogColor.b;if(b.gammaCorrection)for(G=0;3>G;G++)this.fogColor[G]=Math.pow(this.fogColor[G],2.2);this.fogColorId.setValue(this.fogColor);b.fog===pc.FOG_LINEAR?(this.fogStartId.setValue(b.fogStart),this.fogEndId.setValue(b.fogEnd)):
this.fogDensityId.setValue(b.fogDensity)}pc._instanceVertexFormat||(pc._instanceVertexFormat=new pc.VertexFormat(d,[{semantic:pc.SEMANTIC_TEXCOORD2,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD3,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD4,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_TEXCOORD5,components:4,type:pc.ELEMENTTYPE_FLOAT32}]));d.enableAutoInstancing&&!pc._autoInstanceBuffer&&(pc._autoInstanceBuffer=new pc.VertexBuffer(d,
pc._instanceVertexFormat,d.autoInstancingMaxObjects,pc.BUFFER_DYNAMIC),pc._autoInstanceBufferData=new Float32Array(pc._autoInstanceBuffer.lock()));var V;for(G=0;G<v;G++)if(E=r[G],E.command)E.command();else{z=E;D=z.mesh;H=z.material;l=z._shaderDefs;if(d.enableAutoInstancing&&(G!==numDrawCalls-1&&H.useInstancing)&&(n=G+1,r[n].mesh===D&&r[n].material===H)){for(I=0;16>I;I++)pc._autoInstanceBufferData[I]=E.node.worldTransform.data[I];for(G=1;n!==numDrawCalls&&r[n].mesh===D&&r[n].material===H;){for(I=0;16>
I;I++)pc._autoInstanceBufferData[16*G+I]=r[n].node.worldTransform.data[I];G++;n++}z.instancingData={};z.instancingData.count=G;z.instancingData._buffer=pc._autoInstanceBuffer;z.instancingData._buffer.unlock();G=n-1}z.instancingData&&d.extInstancing?z.instancingData._buffer||(z.instancingData._buffer=new pc.VertexBuffer(d,pc._instanceVertexFormat,E.instancingData.count,E.instancingData.usage,z.instancingData.buffer)):(n=z.node.worldTransform,N=z.normalMatrix,n.invertTo3x3(N),N.transpose(),this.modelMatrixId.setValue(n.data),
this.normalMatrixId.setValue(N.data));z.skinInstance&&(d.supportsBoneTextures?(this.boneTextureId.setValue(z.skinInstance.boneTexture),L=z.skinInstance.boneTexture.width,O=z.skinInstance.boneTexture.height,this.boneTextureSizeId.setValue([L,O])):this.poseMatrixId.setValue(z.skinInstance.matrixPalette));H&&(H===P&&l!==V)&&(P=null);if(H!==P){z._shader||(z._shader=H.variants[l],z._shader||(H.updateShader(d,b,l),z._shader=H.variants[l]=H.shader));d.setShader(z._shader);V=H.parameters;for(var X in V)n=
V[X],n.scopeId||(n.scopeId=d.scope.resolve(X)),n.scopeId.setValue(n.data);if(!P||H.mask!==P.mask)this._activeShadowLights=[],usedDirLights=this.dispatchDirectLights(b,H.mask),this.dispatchLocalLights(b,H.mask,usedDirLights);if(void 0!==H.shadowSampleType)for(P=0;P<this._activeShadowLights.length;P++)this._activeShadowLights[P]._shadowType===pc.SHADOW_DEPTHMASK&&(H.shadowSampleType===pc.SHADOWSAMPLE_MASK?(this._activeShadowLights[P]._shadowCamera._renderTarget.colorBuffer.minFilter=pc.FILTER_LINEAR,
this._activeShadowLights[P]._shadowCamera._renderTarget.colorBuffer.magFilter=pc.FILTER_LINEAR):(this._activeShadowLights[P]._shadowCamera._renderTarget.colorBuffer.minFilter=pc.FILTER_NEAREST,this._activeShadowLights[P]._shadowCamera._renderTarget.colorBuffer.magFilter=pc.FILTER_NEAREST));this.alphaTestId.setValue(H.alphaTest);d.setBlending(H.blend);d.setBlendFunction(H.blendSrc,H.blendDst);d.setBlendEquation(H.blendEquation);d.setColorWrite(H.redWrite,H.greenWrite,H.blueWrite,H.alphaWrite);d.setCullMode(H.cull);
d.setDepthWrite(H.depthWrite);d.setDepthTest(H.depthTest)}d.setVertexBuffer(D.vertexBuffer,0);L=z.renderStyle;d.setIndexBuffer(D.indexBuffer[L]);z.instancingData?(d.setVertexBuffer(z.instancingData._buffer,1),d.draw(D.primitive[L],E.instancingData.count),z.instancingData._buffer===pc._autoInstanceBuffer&&(z.instancingData=null)):d.draw(D.primitive[L]);P=H;V=l}}});return{ForwardRenderer:b}}());pc.extend(pc,function(){var e=function(){this.name="Untitled";this._labels={};this.localPosition=new pc.Vec3(0,0,0);this.localRotation=new pc.Quat(0,0,0,1);this.localScale=new pc.Vec3(1,1,1);this.localEulerAngles=new pc.Vec3(0,0,0);this.position=new pc.Vec3(0,0,0);this.rotation=new pc.Quat(0,0,0,1);this.eulerAngles=new pc.Vec3(0,0,0);this.localTransform=new pc.Mat4;this.dirtyLocal=!1;this.worldTransform=new pc.Mat4;this.dirtyWorld=!1;this._right=new pc.Vec3;this._up=new pc.Vec3;this._forward=new pc.Vec3;
this._parent=null;this._children=[];this._enabledInHierarchy=this._enabled=!0};Object.defineProperty(e.prototype,"right",{get:function(){return this.getWorldTransform().getX(this._right).normalize()}});Object.defineProperty(e.prototype,"up",{get:function(){return this.getWorldTransform().getY(this._up).normalize()}});Object.defineProperty(e.prototype,"forward",{get:function(){return this.getWorldTransform().getZ(this._forward).normalize().scale(-1)}});Object.defineProperty(e.prototype,"forwards",
{get:function(){console.log("pc.GraphNode#forwards is DEPRECATED. Use pc.GraphNode#forward instead.");return this.forward}});Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled&&this._enabledInHierarchy},set:function(a){this._enabled!==a&&(this._enabled=a,(!this._parent||this._parent.enabled)&&this._notifyHierarchyStateChanged(this,a))}});pc.extend(e.prototype,{_notifyHierarchyStateChanged:function(a,b){a._onHierarchyStateChanged(b);for(var c=a._children,d=0,g=c.length;d<
g;d++)c[d]._enabled&&this._notifyHierarchyStateChanged(c[d],b)},_onHierarchyStateChanged:function(a){this._enabledInHierarchy=a},_cloneInternal:function(a){a.name=this.name;a._labels=pc.extend(this._labels,{});a.localPosition.copy(this.localPosition);a.localRotation.copy(this.localRotation);a.localScale.copy(this.localScale);a.localEulerAngles.copy(this.localEulerAngles);a.position.copy(this.position);a.rotation.copy(this.rotation);a.eulerAngles.copy(this.eulerAngles);a.localTransform.copy(this.localTransform);
a.dirtyLocal=this.dirtyLocal;a.worldTransform.copy(this.worldTransform);a.dirtyWorld=this.dirtyWorld;a._enabled=this._enabled;a._enabledInHierarchy=this._enabledInHierarchy},clone:function(){var a=new pc.GraphNode;this._cloneInternal(a);return a},find:function(a,b){var c,d=this.getChildren(),g=d.length,e=[];this[a]&&(c=this[a]instanceof Function?this[a]():this[a],c===b&&e.push(this));for(c=0;c<g;++c)e=e.concat(d[c].find(a,b));return e},findOne:function(a,b){var c,d=this.getChildren(),e=d.length,f=
null;if(this[a]&&(c=this[a]instanceof Function?this[a]():this[a],c===b))return this;for(c=0;c<e;++c)if(f=d[c].findOne(a,b),null!==f)return f;return null},findByName:function(a){if(this.name===a)return this;for(var b=0;b<this._children.length;b++){var c=this._children[b].findByName(a);if(null!==c)return c}return null},findByPath:function(a){for(var a=a.split("/"),b=this,c=null,d=0,e=a.length;d<e&&b;d++){for(var f=a[d],c=null,b=b._children,k=0,m=b.length;k<m;k++)if(b[k].name==f){c=b[k];break}b=c}return c},
getPath:function(){var a=this._parent;if(a){for(var b=this.name;a&&a._parent;)b=pc.string.format("{0}/{1}",a.name,b),a=a._parent;return b}return""},getRoot:function(){var a=this.getParent();if(!a)return this;for(;a.getParent();)a=a.getParent();return a},getParent:function(){return this._parent},getChildren:function(){return this._children},getEulerAngles:function(){this.getWorldTransform().getEulerAngles(this.eulerAngles);return this.eulerAngles},getLocalEulerAngles:function(){this.localRotation.getEulerAngles(this.localEulerAngles);
return this.localEulerAngles},getLocalPosition:function(){return this.localPosition},getLocalRotation:function(){return this.localRotation},getLocalScale:function(){return this.localScale},getLocalTransform:function(){this.dirtyLocal&&(this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale),this.dirtyLocal=!1,this.dirtyWorld=!0);return this.localTransform},getName:function(){return this.name},getPosition:function(){this.getWorldTransform().getTranslation(this.position);return this.position},
getRotation:function(){this.rotation.setFromMat4(this.getWorldTransform());return this.rotation},getWorldTransform:function(){var a=[];return function(){var b=this;for(a.length=0;null!==b;)a.push(b),b=b._parent;for(b=a.length-1;0<=b;b--)a[b].sync();return this.worldTransform}}(),reparent:function(a,b){var c=this.getParent();c&&c.removeChild(this);a&&(0<=b?a.insertChild(this,b):a.addChild(this))},setLocalEulerAngles:function(){var a,b,c;switch(arguments.length){case 1:a=arguments[0].x;b=arguments[0].y;
c=arguments[0].z;break;case 3:a=arguments[0],b=arguments[1],c=arguments[2]}this.localRotation.setFromEulerAngles(a,b,c);this.dirtyLocal=!0},setLocalPosition:function(){1===arguments.length?this.localPosition.copy(arguments[0]):this.localPosition.set(arguments[0],arguments[1],arguments[2]);this.dirtyLocal=!0},setLocalRotation:function(a){1===arguments.length?this.localRotation.copy(arguments[0]):this.localRotation.set(arguments[0],arguments[1],arguments[2],arguments[3]);this.dirtyLocal=!0},setLocalScale:function(){1===
arguments.length?this.localScale.copy(arguments[0]):this.localScale.set(arguments[0],arguments[1],arguments[2]);this.dirtyLocal=!0},setName:function(a){this.name=a},setPosition:function(){var a=new pc.Vec3,b=new pc.Mat4;return function(){1===arguments.length?a.copy(arguments[0]):a.set(arguments[0],arguments[1],arguments[2]);null===this._parent?this.localPosition.copy(a):(b.copy(this._parent.getWorldTransform()).invert(),b.transformPoint(a,this.localPosition));this.dirtyLocal=!0}}(),setRotation:function(){var a=
new pc.Quat,b=new pc.Quat;return function(){1===arguments.length?a.copy(arguments[0]):a.set(arguments[0],arguments[1],arguments[2],arguments[3]);if(null===this._parent)this.localRotation.copy(a);else{var c=this._parent.getRotation();b.copy(c).invert();this.localRotation.copy(b).mul(a)}this.dirtyLocal=!0}}(),setEulerAngles:function(){var a=new pc.Quat;return function(){var b,c,d;switch(arguments.length){case 1:b=arguments[0].x;c=arguments[0].y;d=arguments[0].z;break;case 3:b=arguments[0],c=arguments[1],
d=arguments[2]}this.localRotation.setFromEulerAngles(b,c,d);null!==this._parent&&(b=this._parent.getRotation(),a.copy(b).invert(),this.localRotation.mul2(a,this.localRotation));this.dirtyLocal=!0}}(),addChild:function(a){if(null!==a.getParent())throw Error("GraphNode is already parented");this._children.push(a);this._onInsertChild(a)},addChildAndSaveTransform:function(a){var b=a.getPosition(),c=a.getRotation(),d=a.getParent();d&&d.removeChild(a);void 0==this.tmpMat4&&(this.tmpMat4=new pc.Mat4,this.tmpQuat=
new pc.Quat);a.setPosition(this.tmpMat4.copy(this.worldTransform).invert().transformPoint(b));a.setRotation(this.tmpQuat.copy(this.getRotation()).invert().mul(c));this._children.push(a);this._onInsertChild(a)},insertChild:function(a,b){if(null!==a.getParent())throw Error("GraphNode is already parented");this._children.splice(b,0,a);this._onInsertChild(a)},_onInsertChild:function(a){a._parent=this;var b=a._enabled&&this.enabled;a._enabledInHierarchy!==b&&(a._enabledInHierarchy=b,a._notifyHierarchyStateChanged(a,
b));a.dirtyWorld=!0},removeChild:function(a){var b,c=this._children.length;a._parent=null;for(b=0;b<c;++b)if(this._children[b]===a){this._children.splice(b,1);break}},addLabel:function(a){this._labels[a]=!0},getLabels:function(){return Object.keys(this._labels)},hasLabel:function(a){return!!this._labels[a]},removeLabel:function(a){delete this._labels[a]},findByLabel:function(a,b){var c,d=this._children.length,b=b||[];this.hasLabel(a)&&b.push(this);for(c=0;c<d;++c)b=this._children[c].findByLabel(a,
b);return b},sync:function(){this.dirtyLocal&&(this.localTransform.setTRS(this.localPosition,this.localRotation,this.localScale),this.dirtyLocal=!1,this.dirtyWorld=!0);if(this.dirtyWorld){null===this._parent?this.worldTransform.copy(this.localTransform):this.worldTransform.mul2(this._parent.worldTransform,this.localTransform);this.dirtyWorld=!1;for(var a=0,b=this._children.length;a<b;a++)this._children[a].dirtyWorld=!0}},syncHierarchy:function(){var a=function(){if(this._enabled){this.sync();for(var b=
this._children,c=0,d=b.length;c<d;c++)a.call(b[c])}};return a}(),lookAt:function(){var a=new pc.Mat4,b=new pc.Vec3,c=new pc.Vec3,d=new pc.Quat;return function(){switch(arguments.length){case 1:b.copy(arguments[0]);c.copy(pc.Vec3.UP);break;case 2:b.copy(arguments[0]);c.copy(arguments[1]);break;case 3:b.set(arguments[0],arguments[1],arguments[2]);c.copy(pc.Vec3.UP);break;case 6:b.set(arguments[0],arguments[1],arguments[2]),c.set(arguments[3],arguments[4],arguments[5])}a.setLookAt(this.getPosition(),
b,c);d.setFromMat4(a);this.setRotation(d)}}(),translate:function(){var a=new pc.Vec3;return function(){switch(arguments.length){case 1:a.copy(arguments[0]);break;case 3:a.set(arguments[0],arguments[1],arguments[2])}a.add(this.getPosition());this.setPosition(a)}}(),translateLocal:function(){var a=new pc.Vec3;return function(){switch(arguments.length){case 1:a.copy(arguments[0]);break;case 3:a.set(arguments[0],arguments[1],arguments[2])}this.localRotation.transformVector(a,a);this.localPosition.add(a);
this.dirtyLocal=!0}}(),rotate:function(){var a=new pc.Quat,b=new pc.Quat;return function(){var c,d,e;switch(arguments.length){case 1:c=arguments[0].x;d=arguments[0].y;e=arguments[0].z;break;case 3:c=arguments[0],d=arguments[1],e=arguments[2]}a.setFromEulerAngles(c,d,e);null===this._parent?this.localRotation.mul2(a,this.localRotation):(c=this.getRotation(),d=this._parent.getRotation(),b.copy(d).invert(),a.mul2(b,a),this.localRotation.mul2(a,c));this.dirtyLocal=!0}}(),rotateLocal:function(){var a=new pc.Quat;
return function(){var b,c,d;switch(arguments.length){case 1:b=arguments[0].x;c=arguments[0].y;d=arguments[0].z;break;case 3:b=arguments[0],c=arguments[1],d=arguments[2]}a.setFromEulerAngles(b,c,d);this.localRotation.mul(a);this.dirtyLocal=!0}}()});return{GraphNode:e}}());pc.extend(pc,function(){var e=function(){this._projection=pc.PROJECTION_PERSPECTIVE;this._nearClip=0.1;this._farClip=1E4;this._fov=45;this._orthoHeight=10;this._aspect=16/9;this.frustumCulling=!1;this._projMatDirty=!0;this._projMat=new pc.Mat4;this._viewMat=new pc.Mat4;this._viewProjMat=new pc.Mat4;this._rect={x:0,y:0,width:1,height:1};this._frustum=new pc.Frustum(this._projMat,this._viewMat);this._renderTarget=null;this._clearOptions={color:[186/255,186/255,177/255,1],depth:1,flags:pc.CLEARFLAG_COLOR|
pc.CLEARFLAG_DEPTH};this._node=null};e.prototype={clone:function(){var a=new pc.Camera;a.setProjection(this.getProjection());a.setNearClip(this.getNearClip());a.setFarClip(this.getFarClip());a.setFov(this.getFov());a.setAspectRatio(this.getAspectRatio());a.setRenderTarget(this.getRenderTarget());a.setClearOptions(this.getClearOptions());a.frustumCulling=this.frustumCulling;return a},worldToScreen:function(a,b,c,d){void 0===d&&(d=new pc.Vec3);var e=this.getProjectionMatrix(),f=this._node.getWorldTransform();
this._viewMat.copy(f).invert();this._viewProjMat.mul2(e,this._viewMat);this._viewProjMat.transformPoint(a,d);a=a.data;e=this._viewProjMat.data;a=a[0]*e[3]+a[1]*e[7]+a[2]*e[11]+1*e[15];d.x=0.5*(d.x/a+1)*b;d.y=0.5*(1-d.y/a)*c;return d},screenToWorld:function(a,b,c,d,e,f){void 0===f&&(f=new pc.Vec3);var k=this.getProjectionMatrix(),m=this._node.getWorldTransform();this._viewMat.copy(m).invert();this._viewProjMat.mul2(k,this._viewMat);k=this._viewProjMat.clone().invert();this._projection===pc.PROJECTION_PERSPECTIVE?
(b=new pc.Vec3(2*(a/d)-1,2*((e-b)/e)-1,1),a=k.transformPoint(b),a.scale(1/(b.x*k.data[3]+b.y*k.data[7]+b.z*k.data[11]+k.data[15])),c/=this._farClip,f.lerp(this._node.getPosition(),a,c)):(c=new pc.Vec3(2*(a/d)-1,2*((e-b)/e)-1,2*((this._farClip-c)/(this._farClip-this._nearClip))-1),k.transformPoint(c,f));return f},getAspectRatio:function(){return this._aspect},getClearOptions:function(){return this._clearOptions},getFarClip:function(){return this._farClip},getFov:function(){return this._fov},getFrustum:function(){return this._frustum},
getNearClip:function(){return this._nearClip},getOrthoHeight:function(){return this._orthoHeight},getProjection:function(){return this._projection},getProjectionMatrix:function(){if(this._projMatDirty){if(this._projection===pc.PROJECTION_PERSPECTIVE)this._projMat.setPerspective(this._fov,this._aspect,this._nearClip,this._farClip);else{var a=this._orthoHeight,b=a*this._aspect;this._projMat.setOrtho(-b,b,-a,a,this._nearClip,this._farClip)}this._projMatDirty=!1}return this._projMat},getRect:function(){return this._rect},
getRenderTarget:function(){return this._renderTarget},setAspectRatio:function(a){this._aspect=a;this._projMatDirty=!0},setClearOptions:function(a){this._clearOptions=a},setFarClip:function(a){this._farClip=a;this._projMatDirty=!0},setFov:function(a){this._fov=a;this._projMatDirty=!0},setNearClip:function(a){this._nearClip=a;this._projMatDirty=!0},setOrthoHeight:function(a){this._orthoHeight=a;this._projMatDirty=!0},setProjection:function(a){this._projection=a;this._projMatDirty=!0},setRect:function(a,
b,c,d){this._rect.x=a;this._rect.y=b;this._rect.width=c;this._rect.height=d},setRenderTarget:function(a){this._renderTarget=a}};return{Camera:e}}());pc.extend(pc,function(){var e=function(){this._type=pc.LIGHTTYPE_DIRECTIONAL;this._color=new pc.Color(0.8,0.8,0.8);this._intensity=1;this._enabled=this._castShadows=!1;this._attenuationEnd=this._attenuationStart=10;this._falloffMode=0;this._shadowType=pc.SHADOW_DEPTH;this.mask=1;this._innerConeAngle=40;this._outerConeAngle=45;this._finalColor=new pc.Vec3(0.8,0.8,0.8);this._linearFinalColor=new pc.Vec3;this._position=new pc.Vec3(0,0,0);this._direction=new pc.Vec3(0,0,0);this._innerConeAngleCos=Math.cos(this._innerConeAngle*
Math.PI/180);this._outerConeAngleCos=Math.cos(this._outerConeAngle*Math.PI/180);this._shadowCamera=null;this._shadowMatrix=new pc.Mat4;this._shadowDistance=40;this._shadowResolution=1024;this._shadowBias=-5E-4;this._normalOffsetBias=0;this.shadowUpdateMode=pc.SHADOWUPDATE_REALTIME;this._node=this._scene=null};e.prototype={clone:function(){var a=new pc.Light;a.setType(this.getType());a.setColor(this.getColor());a.setIntensity(this.getIntensity());a.setCastShadows(this.getCastShadows());a.setEnabled(this.getEnabled());
a.setAttenuationStart(this.getAttenuationStart());a.setAttenuationEnd(this.getAttenuationEnd());a.setFalloffMode(this.getFalloffMode());a.setShadowType(this.getShadowType());a.shadowUpdateMode=this.shadowUpdateMode;a.mask=this.mask;a.setInnerConeAngle(this.getInnerConeAngle());a.setOuterConeAngle(this.getOuterConeAngle());a.setShadowBias(this.getShadowBias());a.setNormalOffsetBias(this.getNormalOffsetBias());a.setShadowResolution(this.getShadowResolution());a.setShadowDistance(this.getShadowDistance());
return a},getAttenuationEnd:function(){return this._attenuationEnd},getAttenuationStart:function(){return this._attenuationStart},getFalloffMode:function(){return this._falloffMode},getShadowType:function(){return this._shadowType},getCastShadows:function(){return this._castShadows},getColor:function(){return this._color},getEnabled:function(){return this._enabled},getInnerConeAngle:function(){return this._innerConeAngle},getIntensity:function(){return this._intensity},getOuterConeAngle:function(){return this._outerConeAngle},
getShadowBias:function(){return this._shadowBias},getNormalOffsetBias:function(){return this._normalOffsetBias},getShadowDistance:function(){return this._shadowDistance},getShadowResolution:function(){return this._shadowResolution},getType:function(){return this._type},setAttenuationEnd:function(a){this._attenuationEnd=a},setAttenuationStart:function(a){this._attenuationStart=a},setFalloffMode:function(a){this._falloffMode=a;null!==this._scene&&(this._scene.updateShaders=!0)},setShadowType:function(a){this._shadowType=
a;null!==this._scene&&(this._scene.updateShaders=!0)},setCastShadows:function(a){this._castShadows=a;null!==this._scene&&(this._scene.updateShaders=!0)},setColor:function(){var a,b,c;1===arguments.length?(a=arguments[0].r,b=arguments[0].g,c=arguments[0].b):3===arguments.length&&(a=arguments[0],b=arguments[1],c=arguments[2]);this._color.set(a,b,c);var d=this._intensity;this._finalColor.set(a*d,b*d,c*d);for(a=0;3>a;a++)this._linearFinalColor.data[a]=1<=d?Math.pow(this._finalColor.data[a]/d,2.2)*d:Math.pow(this._finalColor.data[a],
2.2)},setEnabled:function(a){this._enabled!==a&&(this._enabled=a,null!==this._scene&&(this._scene.updateShaders=!0))},setInnerConeAngle:function(a){this._innerConeAngle=a;this._innerConeAngleCos=Math.cos(a*Math.PI/180)},setIntensity:function(a){this._intensity=a;var b=this._color,a=this._intensity;this._finalColor.set(b.r*a,b.g*a,b.b*a);for(b=0;3>b;b++)this._linearFinalColor.data[b]=1<=a?Math.pow(this._finalColor.data[b]/a,2.2)*a:Math.pow(this._finalColor.data[b],2.2)},setOuterConeAngle:function(a){this._outerConeAngle=
a;this._outerConeAngleCos=Math.cos(a*Math.PI/180)},setShadowBias:function(a){this._shadowBias=a},setNormalOffsetBias:function(a){if(!this._normalOffsetBias&&a||this._normalOffsetBias&&!a)this._scene.updateShaders=!0;this._normalOffsetBias=a},setShadowDistance:function(a){this._shadowDistance=a},setShadowResolution:function(a){this._shadowResolution=a},setType:function(a){this._type=a},updateShadow:function(){this.shadowUpdateMode!==pc.SHADOWUPDATE_REALTIME&&(this.shadowUpdateMode=pc.SHADOWUPDATE_THISFRAME)}};
return{Light:e}}());pc.extend(pc,function(){var e=0,a=function(){this.name="Untitled";this.id=e++;this.shader=null;this.variants={};this.parameters={};this.alphaTest=0;this.blend=!1;this.blendSrc=pc.BLENDMODE_ONE;this.blendDst=pc.BLENDMODE_ZERO;this.blendEquation=pc.BLENDEQUATION_ADD;this.cull=pc.CULLFACE_BACK;this.alphaWrite=this.blueWrite=this.greenWrite=this.redWrite=this.depthWrite=this.depthTest=!0;this.mask=1;this.meshInstances=[]};Object.defineProperty(a.prototype,"blendType",{get:function(){return!this.blend&&
this.blendSrc===pc.BLENDMODE_ONE&&this.blendDst===pc.BLENDMODE_ZERO&&this.blendEquation===pc.BLENDEQUATION_ADD?pc.BLEND_NONE:this.blend&&this.blendSrc===pc.BLENDMODE_SRC_ALPHA&&this.blendDst===pc.BLENDMODE_ONE_MINUS_SRC_ALPHA&&this.blendEquation===pc.BLENDEQUATION_ADD?pc.BLEND_NORMAL:this.blend&&this.blendSrc===pc.BLENDMODE_ONE&&this.blendDst===pc.BLENDMODE_ONE&&this.blendEquation===pc.BLENDEQUATION_ADD?pc.BLEND_ADDITIVE:this.blend&&this.blendSrc===pc.BLENDMODE_DST_COLOR&&this.blendDst===pc.BLENDMODE_ZERO&&
this.blendEquation===pc.BLENDEQUATION_ADD?pc.BLEND_MULTIPLICATIVE:this.blend&&this.blendSrc===pc.BLENDMODE_ONE&&this.blendDst===pc.BLENDMODE_ONE_MINUS_SRC_ALPHA&&this.blendEquation===pc.BLENDEQUATION_ADD?pc.BLEND_PREMULTIPLIED:pc.BLEND_NORMAL},set:function(a){switch(a){case pc.BLEND_NONE:this.blend=!1;this.blendSrc=pc.BLENDMODE_ONE;this.blendDst=pc.BLENDMODE_ZERO;this.blendEquation=pc.BLENDEQUATION_ADD;break;case pc.BLEND_NORMAL:this.blend=!0;this.blendSrc=pc.BLENDMODE_SRC_ALPHA;this.blendDst=pc.BLENDMODE_ONE_MINUS_SRC_ALPHA;
this.blendEquation=pc.BLENDEQUATION_ADD;break;case pc.BLEND_PREMULTIPLIED:this.blend=!0;this.blendSrc=pc.BLENDMODE_ONE;this.blendDst=pc.BLENDMODE_ONE_MINUS_SRC_ALPHA;this.blendEquation=pc.BLENDEQUATION_ADD;break;case pc.BLEND_ADDITIVE:this.blend=!0;this.blendDst=this.blendSrc=pc.BLENDMODE_ONE;this.blendEquation=pc.BLENDEQUATION_ADD;break;case pc.BLEND_MULTIPLICATIVE:this.blend=!0,this.blendSrc=pc.BLENDMODE_DST_COLOR,this.blendDst=pc.BLENDMODE_ZERO,this.blendEquation=pc.BLENDEQUATION_ADD}this._updateMeshInstanceKeys()}});
a.prototype._cloneInternal=function(a){a.name=this.name;a.id=e++;a.shader=null;a.variants={};a.parameters={};a.alphaTest=this.alphaTest;a.blend=this.blend;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.cull=this.cull;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.redWrite=this.redWrite;a.greenWrite=this.greenWrite;a.blueWrite=this.blueWrite;a.alphaWrite=this.alphaWrite;a.mask=this.mask;a.meshInstances=[]};a.prototype.clone=function(){var a=new pc.Material;
this._cloneInternal(a);return a};a.prototype._updateMeshInstanceKeys=function(){var a,c=this.meshInstances;for(a=0;a<c.length;a++)c[a].updateKey()};a.prototype.updateShader=function(){};a.prototype.getName=function(){return this.name};a.prototype.setName=function(a){this.name=a};a.prototype.clearParameters=function(){this.parameters={}};a.prototype.getParameters=function(){return this.parameters};a.prototype.clearVariants=function(){this.variants={};for(i=0;i<this.meshInstances.length;i++)this.meshInstances[i]._shader=
null};a.prototype.getParameter=function(a){return this.parameters[a]};a.prototype.setParameter=function(a,c){var d=this.parameters[a];d?d.data=c:this.parameters[a]={scopeId:null,data:c}};a.prototype.deleteParameter=function(a){this.parameters[a]&&delete this.parameters[a]};a.prototype.setParameters=function(){for(var a in this.parameters){var c=this.parameters[a];c.scopeId||(c.scopeId=device.scope.resolve(a));c.scopeId.setValue(c.data)}};a.prototype.getShader=function(){return this.shader};a.prototype.setShader=
function(a){this.shader=a};a.prototype.update=function(){throw Error("Not Implemented in base class");};a.prototype.init=function(){throw Error("Not Implemented in base class");};return{Material:a}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.color=new pc.Color(1,1,1,1);this.colorMap=null;this.update()},pc.Material);pc.extend(e.prototype,{clone:function(){var a=new pc.BasicMaterial;Material.prototype._cloneInternal.call(this,a);a.color.copy(this.color);a.colorMap=this.colorMap;a.update();return a},update:function(){this.clearParameters();this.setParameter("uColor",this.color.data);this.colorMap&&this.setParameter("texture_diffuseMap",this.colorMap)},updateShader:function(a){var b=
{skin:!!this.meshInstances[0].skinInstance};this.shader=a.getProgramLibrary().getProgram("basic",b)}});return{BasicMaterial:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){},pc.Material);pc.extend(e.prototype,{clone:function(){var a=new pc.DepthMaterial;Material.prototype._cloneInternal.call(this,a);a.update();return a},update:function(){},updateShader:function(a){var b={skin:!!this.meshInstances[0].skinInstance};this.shader=a.getProgramLibrary().getProgram("depth",b)}});return{DepthMaterial:e}}());pc.extend(pc,function(){new pc.Vec3;new pc.Vec3;var e,a=function(a,c,d,e){a[c+"Map"]=null;a[c+"MapTiling"]=new pc.Vec2(1,1);a[c+"MapOffset"]=new pc.Vec2(0,0);a[c+"MapTransform"]=null;a[c+"MapUv"]=d;0<e&&(a[c+"MapChannel"]=1<e?"rgb":"g");pc._matTex2D||(pc._matTex2D=[]);pc._matTex2D[c]=e};e=pc.inherits(function(){this.reset();this.update()},pc.Material);pc.extend(e.prototype,{reset:function(){if(!pc._matSerialProps){this._tempProps=[];for(var b in this)this.hasOwnProperty(b)&&(this._tempProps[b]=!0)}this.ambient=
new pc.Color(0.7,0.7,0.7);this.diffuse=new pc.Color(1,1,1);this.specular=new pc.Color(0,0,0);this.shininess=25;this.emissive=new pc.Color(0,0,0);this.opacity=1;this.blendType=pc.BLEND_NONE;this.heightMapFactor=this.bumpiness=1;a(this,"diffuse",0,3);a(this,"specular",0,3);a(this,"emissive",0,3);a(this,"normal",0,-1);a(this,"metalness",0,1);a(this,"gloss",0,1);a(this,"opacity",0,1);a(this,"height",0,1);a(this,"ao",0,1);a(this,"light",1,3);this.sphereMap=this.cubeMap=null;this.reflectivity=1;this.aoUvSet=
0;this.blendMapsWithColors=!0;this.specularAntialias=!1;this.occludeSpecular=this.conserveEnergy=!0;this.shadingModel=pc.SPECULAR_PHONG;this.fresnelModel=pc.FRESNEL_NONE;this.fresnelFactor=0;this.emissiveMapTint=this.specularMapTint=this.diffuseMapTint=this.ambientTint=!1;this.emissiveIntensity=1;this.normalizeNormalMap=!0;this.useInstancing=this.fastTbn=!1;this.cubeMapProjection=0;this.cubeMapProjectionBox=null;this.chunks={};this.chunks.copy=function(a){for(var b in a)a.hasOwnProperty(b)&&"copy"!==
b&&(this[b]=a[b])};this.customFragmentShader=null;this.refraction=0;this.refractionIndex=1/1.5;this.useMetalness=!1;this.metalness=1;this.shadowSampleType=pc.SHADOWSAMPLE_PCF3X3;this.forceFragmentPrecision=null;this.occludeDirect=!1;this.prefilteredCubeMap4=this.prefilteredCubeMap8=this.prefilteredCubeMap16=this.prefilteredCubeMap32=this.prefilteredCubeMap64=this.prefilteredCubeMap128=null;if(!pc._matSerialProps){pc._matSerialProps=[];for(var c in this)this.hasOwnProperty(c)&&!this._tempProps[c]&&
pc._matSerialProps.push(c)}this.ambientUniform=new Float32Array(3);this.diffuseUniform=new Float32Array(3);this.specularUniform=new Float32Array(3);this.emissiveUniform=new Float32Array(3);this.cubeMapMinUniform=new Float32Array(3);this.cubeMapMaxUniform=new Float32Array(3)},clone:function(){var a=new pc.PhongMaterial;pc.Material.prototype._cloneInternal.call(this,a);for(var c,d=0;d<pc._matSerialProps.length;d++)c=pc._matSerialProps[d],void 0!==this[c]&&(this[c]&&this[c].copy?a[c].copy(this[c]):a[c]=
this[c]);a.update();return a},init:function(a){this.reset();this.name=a.name;for(var c=0;c<a.parameters.length;c++){var d=a.parameters[c];if("vec3"===d.type)this[d.name]=new pc.Color(d.data[0],d.data[1],d.data[2]);else if("vec2"===d.type)this[d.name]=new pc.Vec2(d.data[0],d.data[1]);else if("texture"===d.type){var e=d.name;if(d.data)if(d.data instanceof pc.Texture)d=d.data;else throw Error("PhongMaterial.init() expects textures to already be created");else d=null;this[e]=d}else"bumpMapFactor"===d.name?
this.bumpiness=d.data:this[d.name]=d.data}this.update()},_updateMapTransform:function(a,c,d){a=a||new pc.Vec4;a.set(c.x,c.y,d.x,d.y);return 1==a.x&&1==a.y&&0==a.z&&0==a.w?null:a},_collectLights:function(a,c,d){for(var e=0;e<c.length;e++)c[e].getEnabled()&&c[e].mask&this.mask&&c[e].getType()==a&&d.push(c[e])},_updateMap:function(a){a+="Map";if(this[a]){this.setParameter("texture_"+a,this[a]);var c=a+"Transform";this[c]=this._updateMapTransform(this[c],this[a+"Tiling"],this[a+"Offset"]);this[c]&&this.setParameter("texture_"+
c,this[c].data)}},update:function(){this.clearParameters();this.ambientUniform[0]=this.ambient.r;this.ambientUniform[1]=this.ambient.g;this.ambientUniform[2]=this.ambient.b;this.setParameter("material_ambient",this.ambientUniform);if(!this.diffuseMap||this.diffuseMapTint)this.diffuseUniform[0]=this.diffuse.r,this.diffuseUniform[1]=this.diffuse.g,this.diffuseUniform[2]=this.diffuse.b,this.setParameter("material_diffuse",this.diffuseUniform);if(this.useMetalness)(!this.metalnessMap||1>this.metalness)&&
this.setParameter("material_metalness",this.metalness);else if(!this.specularMap||this.specularMapTint)this.specularUniform[0]=this.specular.r,this.specularUniform[1]=this.specular.g,this.specularUniform[2]=this.specular.b,this.setParameter("material_specular",this.specularUniform);this.shadingModel===pc.SPECULAR_PHONG?this.setParameter("material_shininess",Math.pow(2,0.11*this.shininess)):this.setParameter("material_shininess",0.01*this.shininess);if(!this.emissiveMap||this.emissiveMapTint)this.emissiveUniform[0]=
this.emissive.r*this.emissiveIntensity,this.emissiveUniform[1]=this.emissive.g*this.emissiveIntensity,this.emissiveUniform[2]=this.emissive.b*this.emissiveIntensity,this.setParameter("material_emissive",this.emissiveUniform);0<this.refraction&&(this.setParameter("material_refraction",this.refraction),this.setParameter("material_refractionIor",this.refractionIndex));this.setParameter("material_opacity",this.opacity);this.cubeMapProjection===pc.CUBEPROJ_BOX&&(this.cubeMapMinUniform[0]=this.cubeMapProjectionBox.center.x-
this.cubeMapProjectionBox.halfExtents.x,this.cubeMapMinUniform[1]=this.cubeMapProjectionBox.center.y-this.cubeMapProjectionBox.halfExtents.y,this.cubeMapMinUniform[2]=this.cubeMapProjectionBox.center.z-this.cubeMapProjectionBox.halfExtents.z,this.cubeMapMaxUniform[0]=this.cubeMapProjectionBox.center.x+this.cubeMapProjectionBox.halfExtents.x,this.cubeMapMaxUniform[1]=this.cubeMapProjectionBox.center.y+this.cubeMapProjectionBox.halfExtents.y,this.cubeMapMaxUniform[2]=this.cubeMapProjectionBox.center.z+
this.cubeMapProjectionBox.halfExtents.z,this.setParameter("envBoxMin",this.cubeMapMinUniform),this.setParameter("envBoxMax",this.cubeMapMaxUniform));this._updateMap("diffuse");this._updateMap("specular");this._updateMap("gloss");this._updateMap("emissive");this._updateMap("opacity");this._updateMap("normal");this._updateMap("metalness");this._updateMap("height");this._updateMap("light");this._updateMap("ao");this.normalMap&&this.setParameter("material_bumpMapFactor",this.bumpiness);this.heightMap&&
this.setParameter("material_heightMapFactor",0.025*this.heightMapFactor);this.cubeMap&&this.setParameter("texture_cubeMap",this.cubeMap);this.prefilteredCubeMap128&&this.setParameter("texture_prefilteredCubeMap128",this.prefilteredCubeMap128);this.prefilteredCubeMap64&&this.setParameter("texture_prefilteredCubeMap64",this.prefilteredCubeMap64);this.prefilteredCubeMap32&&this.setParameter("texture_prefilteredCubeMap32",this.prefilteredCubeMap32);this.prefilteredCubeMap16&&this.setParameter("texture_prefilteredCubeMap16",
this.prefilteredCubeMap16);this.prefilteredCubeMap8&&this.setParameter("texture_prefilteredCubeMap8",this.prefilteredCubeMap8);this.prefilteredCubeMap4&&this.setParameter("texture_prefilteredCubeMap4",this.prefilteredCubeMap4);this.sphereMap&&this.setParameter("texture_sphereMap",this.sphereMap);this.setParameter("material_reflectionFactor",this.reflectivity);0<this.fresnelFactor&&this.setParameter("material_fresnelFactor",this.fresnelFactor);this.shader=null;this.clearVariants()},_getMapTransformID:function(a,
c){if(!a)return 0;this._mapXForms[c]||(this._mapXForms[c]=[]);var d,e,f;for(d=0;d<this._mapXForms[c].length;d++){f=!0;for(e=0;e<a.data.length;e++)if(this._mapXForms[c][d][e]!=a.data[e]){f=!1;break}if(f)return d+1}d=this._mapXForms[c].length;this._mapXForms[c][d]=[];for(e=0;e<a.data.length;e++)this._mapXForms[c][d][e]=a.data[e];return d+1},updateShader:function(a,c,d){var e;e=c._lights;this._mapXForms=[];var f=a.extTextureLod&&16>a.samplerCount,k=this.prefilteredCubeMap128||c.skyboxPrefiltered128,
m=this.prefilteredCubeMap64||c.skyboxPrefiltered64,h=this.prefilteredCubeMap32||c.skyboxPrefiltered32,n=this.prefilteredCubeMap16||c.skyboxPrefiltered16,l=this.prefilteredCubeMap8||c.skyboxPrefiltered8,r=this.prefilteredCubeMap4||c.skyboxPrefiltered4;if(k){var v=k&&m&&h&&n&&l&&r;f?6>k._levels.length?v?this.setParameter("texture_prefilteredCubeMap128",k):console.log("Can't use prefiltered cubemap: "+v+", "+f+", "+k._levels):this.setParameter("texture_prefilteredCubeMap128",k):v?(this.setParameter("texture_prefilteredCubeMap128",
k),this.setParameter("texture_prefilteredCubeMap64",m),this.setParameter("texture_prefilteredCubeMap32",h),this.setParameter("texture_prefilteredCubeMap16",n),this.setParameter("texture_prefilteredCubeMap8",l),this.setParameter("texture_prefilteredCubeMap4",r)):console.log("Can't use prefiltered cubemap: "+v+", "+f+", "+k._levels)}m=!1;(h=(h=(this.useMetalness?!!this.metalnessMap:!!this.specularMap)||!!this.sphereMap||!!this.cubeMap||k)||(this.useMetalness?0!==this.metalness:!(0===this.specular.r&&
0===this.specular.g&&0===this.specular.b)))&&this.specularMapTint&&!this.useMetalness&&(m=1!==this.specular.r||1!==this.specular.g||1!==this.specular.b);f={fog:c.fog,gamma:c.gammaCorrection,toneMap:c.toneMapping,blendMapsWithColors:this.blendMapsWithColors,modulateAmbient:this.ambientTint,diffuseTint:(1!=this.diffuse.r||1!=this.diffuse.g||1!=this.diffuse.b)&&this.diffuseMapTint,specularTint:m,metalnessTint:this.useMetalness&&1>this.metalness,glossTint:!0,emissiveTint:(1!=this.emissive.r||1!=this.emissive.g||
1!=this.emissive.b||1!=this.emissiveIntensity)&&this.emissiveMapTint,opacityTint:1!=this.opacity,needsNormalFloat:this.normalizeNormalMap,sphereMap:!!this.sphereMap,cubeMap:!!this.cubeMap,useSpecular:h,rgbmReflection:k?k.rgbm:this.cubeMap?this.cubeMap.rgbm:this.sphereMap?this.sphereMap.rgbm:!1,hdrReflection:k?k.rgbm||k.format===pc.PIXELFORMAT_RGBA32F:this.cubeMap?this.cubeMap.rgbm||this.cubeMap.format===pc.PIXELFORMAT_RGBA32F:this.sphereMap?this.sphereMap.rgbm||this.sphereMap.format===pc.PIXELFORMAT_RGBA32F:
!1,fixSeams:k?k.fixCubemapSeams:this.cubeMap?this.cubeMap.fixCubemapSeams:!1,prefilteredCubemap:!!k,emissiveFormat:this.emissiveMap?this.emissiveMap.rgbm?1:this.emissiveMap.format===pc.PIXELFORMAT_RGBA32F?2:0:null,specularAA:this.specularAntialias,conserveEnergy:this.conserveEnergy,occludeSpecular:this.occludeSpecular,occludeDirect:this.occludeDirect,shadingModel:this.shadingModel,fresnelModel:this.fresnelModel,packedNormal:this.normalMap?this.normalMap._compressed:!1,shadowSampleType:this.shadowSampleType,
forceFragmentPrecision:this.forceFragmentPrecision,useInstancing:this.useInstancing,fastTbn:this.fastTbn,cubeMapProjection:this.cubeMapProjection,chunks:this.chunks,customFragmentShader:this.customFragmentShader,refraction:!!this.refraction,useMetalness:this.useMetalness,useTexCubeLod:f};d&&(f.noShadow=0!==(d&pc.SHADERDEF_NOSHADOW),f.skin=0!==(d&pc.SHADERDEF_SKIN));for(var s in pc._matTex2D)h=s+"Map",f[h]=!!this[h],f[h]&&(k=h+"Transform",m=h+"Channel",h+="Uv",f[k]=this._getMapTransformID(this[k],
this[h]),f[m]=this[m],f[h]=this[h]);f.aoMapUv=f.aoMapUv||this.aoUvSet;this._mapXForms=null;s=[];this._collectLights(pc.LIGHTTYPE_DIRECTIONAL,e,s);this._collectLights(pc.LIGHTTYPE_POINT,e,s);this._collectLights(pc.LIGHTTYPE_SPOT,e,s);f.lights=s;for(e=0;3>e;e++)c.gammaCorrection?(this.ambientUniform[e]=Math.pow(this.ambient.data[e],2.2),this.diffuseUniform[e]=Math.pow(this.diffuse.data[e],2.2),this.specularUniform[e]=Math.pow(this.specular.data[e],2.2),this.emissiveUniform[e]=Math.pow(this.emissive.data[e],
2.2)*this.emissiveIntensity):(this.ambientUniform[e]=this.ambient.data[e],this.diffuseUniform[e]=this.diffuse.data[e],this.specularUniform[e]=this.specular.data[e],this.emissiveUniform[e]=this.emissive.data[e]*this.emissiveIntensity);this.shader=a.getProgramLibrary().getProgram("phong",f);d||(this.clearVariants(),this.variants[0]=this.shader)}});return{PhongMaterial:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.color=new pc.Color(1,1,1,1);this.colorMap=null;this.update()},pc.Material);pc.extend(e.prototype,{clone:function(){var a=new pc.PickMaterial;Material.prototype._cloneInternal.call(this,a);a.color.copy(this.color);a.update();return a},update:function(){this.clearParameters();this.setParameter("uColor",this.color.data)},updateShader:function(a){var b={skin:!!this.meshInstances[0].skinInstance};this.shader=a.getProgramLibrary().getProgram("pick",
b)}});return{PickMaterial:e}}());pc.extend(pc,function(){var e=function(a,c,d){this.buffer=new Float32Array(a*(d||16));this.count=a;this.usage=c?pc.BUFFER_DYNAMIC:pc.BUFFER_STATIC;this._buffer=null};e.prototype={update:function(){this._buffer&&this._buffer.setData(this.buffer)}};var a=function(a,c,d){this.node=a;this.mesh=c;this.material=d;this._shader=null;this._shaderDefs=0;this.layer=pc.LAYER_WORLD;this.renderStyle=pc.RENDERSTYLE_SOLID;this.castShadow=!1;this.drawToDepth=this._receiveShadow=!0;this.key=0;this.updateKey();this._skinInstance=
null;this.aabb=new pc.shape.Aabb;this.normalMatrix=new pc.Mat3;this._boneAabb=null};Object.defineProperty(a.prototype,"aabb",{get:function(){if(this.skinInstance){var a=this.mesh.skin.boneNames.length,c;if(!this.mesh.boneAabb){this.mesh.boneAabb=[];var d=this.mesh.vertexBuffer.format.elements,e=this.mesh.vertexBuffer.numVertices,f=this.mesh.vertexBuffer.format.size,k=new DataView(this.mesh.vertexBuffer.storage),m,h,n,l,r;for(c=0;c<d.length;c++)d[c].name===pc.SEMANTIC_POSITION?h=d[c].offset:d[c].name===
pc.SEMANTIC_BLENDINDICES&&(n=d[c].offset);for(c=0;c<a;c++){d=[];for(l=0;l<e;l++)for(r=0;4>r;r++)m=k.getUint8(l*f+n+r,!0),m===c&&(d.push(k.getFloat32(l*f+h,!0)),d.push(k.getFloat32(l*f+h+4,!0)),d.push(k.getFloat32(l*f+h+8,!0)));this.mesh.boneAabb.push(new pc.shape.Aabb);this.mesh.boneAabb[c].compute(d)}}if(!this._boneAabb){this._boneAabb=[];for(c=0;c<this.mesh.boneAabb.length;c++)this._boneAabb[c]=new pc.shape.Aabb}for(c=0;c<this.mesh.boneAabb.length;c++)this._boneAabb[c].setFromTransformedAabb(this.mesh.boneAabb[c],
this.skinInstance.matrices[c]);this._aabb.center.copy(this._boneAabb[0].center);this._aabb.halfExtents.copy(this._boneAabb[0].halfExtents);for(c=0;c<this.mesh.boneAabb.length;c++)this._aabb.add(this._boneAabb[c])}else this._aabb.setFromTransformedAabb(this.mesh.aabb,this.node.worldTransform);return this._aabb},set:function(a){this._aabb=a}});Object.defineProperty(a.prototype,"material",{get:function(){return this._material},set:function(a){this._shader=null;if(this._material){var c=this._material.meshInstances,
d=c.indexOf(this);-1!==d&&c.splice(d,1)}this._material=a;this._material.meshInstances.push(this);this.updateKey()}});Object.defineProperty(a.prototype,"layer",{get:function(){return this._layer},set:function(a){this._layer=a;this.updateKey()}});Object.defineProperty(a.prototype,"receiveShadow",{get:function(){return this._receiveShadow},set:function(a){this._shaderDefs=(this._receiveShadow=a)?this._shaderDefs&~pc.SHADERDEF_NOSHADOW:this._shaderDefs|pc.SHADERDEF_NOSHADOW;this._shader=null}});Object.defineProperty(a.prototype,
"skinInstance",{get:function(){return this._skinInstance},set:function(a){this._shaderDefs=(this._skinInstance=a)?this._shaderDefs|pc.SHADERDEF_SKIN:this._shaderDefs&~pc.SHADERDEF_SKIN;this._shader=null}});pc.extend(a.prototype,{syncAabb:function(){},updateKey:function(){var a=this.material;this.key=(this.layer&7)<<28|(a.blendType&3)<<26|0|(a.id&33554431)<<0}});return{Command:function(a,c,d){this.key=(a&7)<<28|(c&3)<<26|33554432;this.command=d},Mesh:function(){this.vertexBuffer=null;this.indexBuffer=
[null];this.primitive=[{type:0,base:0,count:0}];this.skin=null;this.aabb=new pc.shape.Aabb;this.boneAabb=null},MeshInstance:a,InstancingData:e}}());pc.extend(pc,function(){var e=function(a){this.skin=a;this.bones=[];var c=a.inverseBindPose.length,a=a.device;if(a.supportsBoneTextures){var d;d=256<c?64:64<c?32:16<c?16:8;this.matrixPalette=new Float32Array(4*d*d);this.boneTexture=new pc.Texture(a,{width:d,height:d,format:pc.PIXELFORMAT_RGBA32F,autoMipmap:!1});this.boneTexture.minFilter=pc.FILTER_NEAREST;this.boneTexture.magFilter=pc.FILTER_NEAREST;this.matrixPalette=this.boneTexture.lock()}else this.matrixPalette=new Float32Array(16*c);this.matrices=
[];for(a=0;a<c;a++)this.matrices[a]=new pc.Mat4},a=new pc.Mat4;e.prototype={updateMatrixPalette:function(){for(var b=a.data,c=this.matrixPalette,d,e=this.bones.length-1;0<=e;e--)a.mul2(this.bones[e].worldTransform,this.skin.inverseBindPose[e]),this.matrices[e].copy(a),d=16*e,c[d]=b[0],c[d+1]=b[1],c[d+2]=b[2],c[d+3]=b[3],c[d+4]=b[4],c[d+5]=b[5],c[d+6]=b[6],c[d+7]=b[7],c[d+8]=b[8],c[d+9]=b[9],c[d+10]=b[10],c[d+11]=b[11],c[d+12]=b[12],c[d+13]=b[13],c[d+14]=b[14],c[d+15]=b[15];this.skin.device.supportsBoneTextures&&
(this.boneTexture.lock(),this.boneTexture.unlock())}};return{Skin:function(a,c,d){this.device=a;this.inverseBindPose=c;this.boneNames=d},SkinInstance:e}}());pc.extend(pc,function(){function e(){this.index=0;this.boneIndices=[0,0,0,0]}function a(){this.indexCount=this.indexStart=this.vertexCount=this.vertexStart=this.partition=0;this.boneIndices=[];this.vertices=[];this.indices=[];this.indexMap={}}a.prototype={addVertex:function(a,c,d){var e=-1;if(void 0!==this.indexMap[c])e=this.indexMap[c],this.indices.push(e);else{for(e=0;4>e;e++)0!==d.blendWeight.data[4*c+e]&&(a.boneIndices[e]=this.getBoneRemap(d.blendIndices.data[4*a.index+e]));e=this.vertices.length;
this.indices.push(e);this.vertices.push(a);this.indexMap[c]=e}},addPrimitive:function(a,c,d,e){var f,k,m=[],h=0,n=a.length;for(f=0;f<n;f++)for(var l=a[f].index,r=0;4>r;r++)if(0<d.blendWeight.data[4*l+r]){var v=d.blendIndices.data[4*l+r],s=!0;for(k=0;k<h;k++)if(m[k]==v){s=!1;break}s&&(m[h]=v,k=this.getBoneRemap(v),h+=-1===k?1:0)}if(this.boneIndices.length+h>e)return!1;for(f=0;f<h;f++)this.boneIndices.push(m[f]);for(f=0;f<n;f++)this.addVertex(a[f],c[f],d);return!0},getBoneRemap:function(a){for(var c=
0;c<this.boneIndices.length;c++)if(this.boneIndices[c]===a)return c;return-1}};return{partitionSkin:function(b,c,d){var g,f,k,m=b.vertices,h=b.skins,n=b.meshes,l=b.meshInstances;for(g=0;g<n.length;g++)n[g].vertices=m[n[g].vertices],void 0!==n[g].skin&&(n[g].skin=h[n[g].skin]);for(g=0;g<l.length;g++)l[g].mesh=n[l[g].mesh];m=b.vertices;h=b.skins;n=b.meshes;l=b.meshInstances;for(g=h.length-1;0<=g;g--)if(h[g].boneNames.length>d){var r=h.splice(g,1)[0],v=[];for(f=0;f<n.length;f++)n[f].skin===r&&v.push(n[f]);
for(f=0;f<v.length;f++){var s=n.indexOf(v[f]);-1!==s&&n.splice(s,1)}if(0===v.length)throw Error("partitionSkin: There should be at least one mesh that references a skin");var C=v[0].vertices;for(f=1;f<v.length;f++)if(v[f].vertices!==C)throw Error("partitionSkin: All meshes that share a skin should also share the same vertex buffer");var x=[],u=function(a){var b=new e;b.index=a;return b};k=[];var w=[],B=0;for(f=0;f<v.length;f++){for(var y=v[f],A=y.indices,F=y.base;F<y.base+y.count;){s=A[F++];k[0]=
u(s);w[0]=s;s=A[F++];k[1]=u(s);w[1]=s;s=A[F++];k[2]=u(s);w[2]=s;for(var J=!1,N=B;N<x.length;N++)if(s=x[N],s.addPrimitive(k,w,C,d)){J=!0;break}J||(s=new a,s.originalMesh=y,s.addPrimitive(k,w,C,d),x.push(s))}B=x.length}y=[];v=[];for(f=0;f<x.length;f++)if(s=x[f],s.vertices.length&&s.indices.length){u=y.length;k=s.vertices.length;w=v.length;B=s.indices.length;s.partition=f;s.vertexStart=u;s.vertexCount=k;s.indexStart=w;s.indexCount=B;A=0;for(F=u;A<k;)y[F++]=s.vertices[A++];A=0;for(F=w;A<B;)v[F++]=s.indices[A++]+
u}u=[];for(f=0;f<x.length;f++){s=x[f];w=[];B=[];for(k=0;k<s.boneIndices.length;k++)w.push(r.inverseBindMatrices[s.boneIndices[k]]),B.push(r.boneNames[s.boneIndices[k]]);s={inverseBindMatrices:w,boneNames:B};u.push(s);h.push(s)}var G,r={};for(G in C)r[G]={components:C[G].components,data:[],type:C[G].type};for(G in C)if("blendIndices"===G){s=r[G].data;for(f=0;f<y.length;f++)k=y[f].boneIndices,s.push(k[0],k[1],k[2],k[3])}else{f=C[G];data=f.data;components=f.components;for(f=0;f<y.length;f++){s=y[f].index;
for(k=0;k<components;k++)r[G].data.push(data[s*components+k])}}m[m.indexOf(C)]=r;for(f=0;f<x.length;f++){s=x[f];y={aabb:{min:[0,0,0],max:[0,0,0]},vertices:r,skin:u[f],indices:v.splice(0,s.indexCount),type:"triangles",base:0,count:s.indexCount};n.push(y);for(k=l.length-1;0<=k;k--)l[k].mesh===s.originalMesh&&(l.push({mesh:y,node:l[k].node}),c&&c.push({material:c[k].material,path:c[k].path}))}for(f=0;f<x.length;f++){s=x[f];for(k=l.length-1;0<=k;k--)l[k].mesh===s.originalMesh&&(l.splice(k,1),c&&c.splice(k,
1))}}c=b.vertices;d=b.skins;G=b.meshes;g=b.meshInstances;for(b=0;b<G.length;b++)G[b].vertices=c.indexOf(G[b].vertices),void 0!==G[b].skin&&(G[b].skin=d.indexOf(G[b].skin));for(b=0;b<g.length;b++)g[b].mesh=G.indexOf(g[b].mesh)}}}());pc.extend(pc,function(){var e=function(){this.graph=null;this.meshInstances=[];this.skinInstances=[];this.cameras=[];this.lights=[]};e.prototype={getGraph:function(){return this.graph},setGraph:function(a){this.graph=a},getCameras:function(){return this.cameras},setCameras:function(a){this.cameras=a},getLights:function(){return this.lights},setLights:function(a){this.lights=a},getMaterials:function(){var a,b=[];for(a=0;a<this.meshInstances.length;a++){var c=this.meshInstances[a];-1===b.indexOf(c.material)&&
b.push(c.material)}return b},clone:function(){var a,b=[],c=[],d=function(a){var e=a.clone();b.push(a);c.push(e);for(var a=a.getChildren(),g=0;g<a.length;g++)e.addChild(d(a[g]));return e},e=d(this.graph),f=[],k=[];for(a=0;a<this.skinInstances.length;a++){var m=this.skinInstances[a].skin,h=new pc.SkinInstance(m),n=[];for(j=0;j<m.boneNames.length;j++){var l=e.findByName(m.boneNames[j]);n.push(l)}h.bones=n;k.push(h)}for(a=0;a<this.meshInstances.length;a++)m=this.meshInstances[a],h=b.indexOf(m.node),h=
new pc.MeshInstance(c[h],m.mesh,m.material),m.skinInstance&&(m=this.skinInstances.indexOf(m.skinInstance),h.skinInstance=k[m]),f.push(h);a=new pc.Model;a.graph=e;a.meshInstances=f;a.skinInstances=k;a.getGraph().syncHierarchy();return a},generateWireframe:function(){var a,b,c,d,e,f,k,m,h,n,l=[];for(a=0;a<this.meshInstances.length;a++)f=this.meshInstances[a].mesh,-1===l.indexOf(f)&&l.push(f);var r=[[0,1],[1,2],[2,0]];for(a=0;a<l.length;a++){f=l[a];k=f.primitive[pc.RENDERSTYLE_SOLID].base;m=f.primitive[pc.RENDERSTYLE_SOLID].count;
h=f.indexBuffer[pc.RENDERSTYLE_SOLID];n=new Uint16Array(h.lock());var v={},s=[];for(b=k;b<k+m;b+=3)for(c=0;3>c;c++){d=n[b+r[c][0]];e=n[b+r[c][1]];var C=d>e?e<<16|d:d<<16|e;void 0===v[C]&&(v[C]=0,s.push(d,e))}h.unlock();b=new pc.IndexBuffer(h.device,pc.INDEXFORMAT_UINT16,s.length);c=new Uint16Array(b.lock());c.set(s);b.unlock();f.primitive[pc.RENDERSTYLE_WIREFRAME]={type:pc.PRIMITIVE_LINES,base:0,count:s.length,indexed:!0};f.indexBuffer[pc.RENDERSTYLE_WIREFRAME]=b}}};return{Model:e}}());pc.extend(pc,function(){function e(a){return Math.max(Math.min(a,1),0)}function a(a,b,c,d){var e,g,f;if(void 0===c||2>c)return b*=a.length-1,e=a[Math.floor(b)],g=a[Math.ceil(b)],pc.math.lerp(e,g,b%1);b*=a.length/c-1;d||(d=[]);for(var h=0;h<c;h++)e=a[Math.floor(b)*c+h],g=a[Math.ceil(b)*c+h],f=b%1,d[h]=pc.math.lerp(e,g,f);return d}function b(a,b){H[a]=void 0!==P[a]&&null!==P[a]?P[a]:b}function c(a,b){for(var c=a.length/3,d=Array(4*c),e=0;e<c;e++)d[4*e]=a[3*e],d[4*e+1]=a[3*e+1],d[4*e+2]=a[3*e+2],d[4*
e+3]=(255*b[3*e]<<16|255*b[3*e+1]<<8|255*b[3*e+2])/16777216;return d}function d(a,b,c){for(var d=new Float32Array(b.length),e=0;e<b.length;e++)d[e]=b[e]-a[e];for(var e=c.length,g=d.length/e,a=0;a<g;a++)for(b=0;b<e;b++){var f=Math.abs(d[a*e+b]);c[b]=Math.max(c[b],f)}a=c.length;g=d.length/a;for(b=0;b<g;b++)for(e=0;e<a;e++)d[b*a+e]/=c[e],d[b*a+e]*=0.5,d[b*a+e]+=0.5;return d}function g(a,b){b.data[0]=a.data[0];b.data[1]=a.data[1];b.data[2]=a.data[2];b.data[3]=a.data[4];b.data[4]=a.data[5];b.data[5]=a.data[6];
b.data[6]=a.data[8];b.data[7]=a.data[9];b.data[8]=a.data[10]}var f=[[-1,-1],[1,-1],[1,1],[-1,1]],k=function(a,b,c,d,e,g){e||(e=pc.PIXELFORMAT_RGBA32F);a=new pc.Texture(a,{width:b,height:c,format:e,cubemap:!1,autoMipmap:!1});a.addressU=pc.ADDRESS_CLAMP_TO_EDGE;a.addressV=pc.ADDRESS_CLAMP_TO_EDGE;a.minFilter=pc.FILTER_NEAREST;a.magFilter=pc.FILTER_NEAREST;b=a.lock();if(e==pc.PIXELFORMAT_R8_G8_B8_A8){a.minFilter=pc.FILTER_LINEAR;a.magFilter=pc.FILTER_LINEAR;e=new Uint8Array(d.length);for(c=0;c<d.length;c++)e[c]=
255*d[c]*g;d=e}b.set(d);a.unlock();return a},m=new pc.Curve([0,0,1,0]),h=new pc.Curve([0,1,1,1]),n=new pc.CurveSet([0,0,1,0],[0,0,1,0],[0,0,1,0]),l=new pc.CurveSet([0,1,1,1],[0,1,1,1],[0,1,1,1]),r=null,v=new pc.Vec3,s=new pc.Vec3,C=new pc.Vec3,x=new pc.Vec3,u=new pc.Vec3,w=new pc.Vec3,B=new pc.Vec3,y=new pc.Vec3,A=new pc.Vec3,F=new pc.Mat4,J=new pc.Mat3,N=new pc.Mat3,G=1,I,K=new pc.Mat4,E=new pc.Vec3,z=new pc.Vec3,D=new pc.Vec3;new pc.Vec3;var H,P,L=function(a,c){this.graphicsDevice=a;this.precision=
32;if(!r){var d=new Float32Array(1024),g,f,v,s;for(f=0;16>f;f++)for(g=0;16>g;g++)v=g+1-8.5,s=f+1-8.5,s=e(1-e(Math.sqrt(v*v+s*s)/16)-0.5),v=16*f+g,d[4*v]=1,d[4*v+1]=1,d[4*v+2]=1,d[4*v+3]=s;r=k(a,16,16,d,pc.PIXELFORMAT_R8_G8_B8_A8,1);r.minFilter=pc.FILTER_LINEAR;r.magFilter=pc.FILTER_LINEAR}H=this;P=c;b("numParticles",1);b("rate",1);b("rate2",this.rate);b("lifetime",50);b("emitterExtents",new pc.Vec3(0,0,0));b("emitterRadius",0);b("emitterShape",pc.EMITTERSHAPE_BOX);b("initialVelocity",1);b("wrap",
!1);b("wrapBounds",null);b("colorMap",r);b("normalMap",null);b("loop",!0);b("preWarm",!1);b("sort",pc.PARTICLESORT_NONE);b("mode",pc.PARTICLEMODE_GPU);b("scene",null);b("lighting",!1);b("halfLambert",!1);b("intensity",1);b("stretch",0);b("alignToMotion",!1);b("depthSoftening",0);b("mesh",null);b("depthWrite",!1);b("blendType",pc.BLEND_NORMAL);b("node",null);b("startAngle",0);b("startAngle2",this.startAngle);this.frameRandom=new pc.Vec3(0,0,0);b("colorGraph",l);b("colorGraph2",this.colorGraph);b("scaleGraph",
h);b("scaleGraph2",this.scaleGraph);b("alphaGraph",h);b("alphaGraph2",this.alphaGraph);b("localVelocityGraph",n);b("localVelocityGraph2",this.localVelocityGraph);b("velocityGraph",n);b("velocityGraph2",this.velocityGraph);b("rotationSpeedGraph",m);b("rotationSpeedGraph2",this.rotationSpeedGraph);this.constantParticleTexIN=a.scope.resolve("particleTexIN");this.constantParticleTexOUT=a.scope.resolve("particleTexOUT");this.constantEmitterPos=a.scope.resolve("emitterPos");this.constantEmitterScale=a.scope.resolve("emitterScale");
this.constantSpawnBounds=a.scope.resolve("spawnBounds");this.constantSpawnBoundsSphere=a.scope.resolve("spawnBoundsSphere");this.constantInitialVelocity=a.scope.resolve("initialVelocity");this.constantFrameRandom=a.scope.resolve("frameRandom");this.constantDelta=a.scope.resolve("delta");this.constantRate=a.scope.resolve("rate");this.constantRateDiv=a.scope.resolve("rateDiv");this.constantLifetime=a.scope.resolve("lifetime");this.constantLightCube=a.scope.resolve("lightCube[0]");this.constantGraphSampleSize=
a.scope.resolve("graphSampleSize");this.constantGraphNumSamples=a.scope.resolve("graphNumSamples");this.constantInternalTex0=a.scope.resolve("internalTex0");this.constantInternalTex1=a.scope.resolve("internalTex1");this.constantInternalTex2=a.scope.resolve("internalTex2");this.constantEmitterMatrix=a.scope.resolve("emitterMatrix");this.constantNumParticles=a.scope.resolve("numParticles");this.constantNumParticlesPot=a.scope.resolve("numParticlesPot");this.constantLocalVelocityDivMult=a.scope.resolve("localVelocityDivMult");
this.constantVelocityDivMult=a.scope.resolve("velocityDivMult");this.constantRotSpeedDivMult=a.scope.resolve("rotSpeedDivMult");this.constantSeed=a.scope.resolve("seed");this.constantStartAngle=a.scope.resolve("startAngle");this.constantStartAngle2=a.scope.resolve("startAngle2");this.lightCube=new Float32Array(18);this.lightCubeDir=Array(6);this.lightCubeDir[0]=new pc.Vec3(-1,0,0);this.lightCubeDir[1]=new pc.Vec3(1,0,0);this.lightCubeDir[2]=new pc.Vec3(0,-1,0);this.lightCubeDir[3]=new pc.Vec3(0,1,
0);this.lightCubeDir[4]=new pc.Vec3(0,0,-1);this.lightCubeDir[5]=new pc.Vec3(0,0,1);this.camera=this.particleDistance=this.vbOld=this.vbToSort=this.internalTex3=this.internalTex2=this.internalTex1=this.internalTex0=null;this.swapTex=!1;this.useMesh=!0;this.useCpu=!1;this.shaderParticleUpdateOnStop=this.shaderParticleUpdateNoRespawn=this.shaderParticleUpdateRespawn=null;this.numParticleIndices=this.numParticleVerts=0;this.meshInstance=this.material=null;this.seed=0;this.rebuild()};L.prototype={onChangeCamera:function(){if(0<
this.depthSoftening&&this.camera&&!this.camera._depthTarget){var a=this.camera,b;b=this.graphicsDevice;var c=this.camera._rect,c=new pc.Texture(b,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:Math.floor(c.width*b.width),height:Math.floor(c.height*b.height)});c.minFilter=pc.FILTER_NEAREST;c.magFilter=pc.FILTER_NEAREST;c.addressU=pc.ADDRESS_CLAMP_TO_EDGE;c.addressV=pc.ADDRESS_CLAMP_TO_EDGE;b=new pc.RenderTarget(b,c,{depth:!0});a._depthTarget=b;this._depthTarget=this.camera._depthTarget}this.regenShader();
this.resetMaterial()},rebuild:function(){var a,b=this.graphicsDevice;this.spawnBounds=this.emitterShape===pc.EMITTERSHAPE_BOX?this.emitterExtents:this.emitterRadius;this.useCpu=this.useCpu||this.sort>pc.PARTICLESORT_NONE||!(b.extTextureFloat&&1<=b.maxVertexTextures&&b.extTextureFloatRenderable)||100>b.fragmentUniformsCount;this.vertexBuffer=void 0;this.useMesh=!1;this.mesh&&(65535<this.numParticles*this.mesh.vertexBuffer.numVertices?console.warn("WARNING: particle system can't render mesh particles because numParticles * numVertices is more than 65k. Reverting to quad particles."):
this.useMesh=!0);this.numParticlesPot=pc.math.nextPowerOfTwo(this.numParticles);this.rebuildGraphs();this.vbToSort=Array(this.numParticles);this.particleDistance=new Float32Array(this.numParticles);this.frameRandom.x=Math.random();this.frameRandom.y=Math.random();this.frameRandom.z=Math.random();this.particleTex=new Float32Array(16*this.numParticlesPot);var c=null===this.node?pc.Vec3.ZERO:this.node.getPosition();this.emitterShape===pc.EMITTERSHAPE_BOX&&(null===this.node?K.setTRS(pc.Vec3.ZERO,pc.Quat.IDENTITY,
this.spawnBounds):K.setTRS(pc.Vec3.ZERO,this.node.getRotation(),D.copy(this.spawnBounds).mul(this.node.getLocalScale())));for(a=0;a<this.numParticles;a++)this.calcSpawnPosition(c,a);this.particleTexStart=new Float32Array(16*this.numParticlesPot);for(a=0;a<this.particleTexStart.length;a++)this.particleTexStart[a]=this.particleTex[a];this.useCpu||(this.particleTexIN=k(b,this.numParticlesPot,4,this.particleTex),this.particleTexOUT=k(b,this.numParticlesPot,4,this.particleTex),this.particleTexStart=k(b,
this.numParticlesPot,4,this.particleTexStart),this.rtParticleTexIN=new pc.RenderTarget(b,this.particleTexIN,{depth:!1}),this.rtParticleTexOUT=new pc.RenderTarget(b,this.particleTexOUT,{depth:!1}),this.swapTex=!1);a=pc.shaderChunks;var c=a.particleUpdaterInitPS+(this.emitterShape===pc.EMITTERSHAPE_BOX?a.particleUpdaterAABBPS:a.particleUpdaterSpherePS)+a.particleUpdaterStartPS,d=c+a.particleUpdaterEndPS,e=c+a.particleUpdaterOnStopPS+a.particleUpdaterEndPS;this.shaderParticleUpdateRespawn=a.createShaderFromCode(b,
a.fullscreenQuadVS,c+a.particleUpdaterRespawnPS+a.particleUpdaterEndPS,"fsQuad0");this.shaderParticleUpdateNoRespawn=a.createShaderFromCode(b,a.fullscreenQuadVS,d,"fsQuad1");this.shaderParticleUpdateOnStop=a.createShaderFromCode(b,a.fullscreenQuadVS,e,"fsQuad2");this.numParticleVerts=this.useMesh?this.mesh.vertexBuffer.numVertices:4;this.numParticleIndices=this.useMesh?this.mesh.indexBuffer[0].numIndices:6;this._allocate(this.numParticles);b=new pc.Mesh;b.vertexBuffer=this.vertexBuffer;b.indexBuffer[0]=
this.indexBuffer;b.primitive[0].type=pc.PRIMITIVE_TRIANGLES;b.primitive[0].base=0;b.primitive[0].count=this.numParticles*this.numParticleIndices;b.primitive[0].indexed=!0;this.material=new pc.Material;this.material.cullMode=pc.CULLFACE_NONE;this.material.blend=!0;this.material.blendType=this.blendType;this.material.depthWrite=this.depthWrite;this.material.emitter=this;this.regenShader();this.resetMaterial();this.meshInstance=new pc.MeshInstance(this.node,b,this.material);this.meshInstance.updateKey();
this.meshInstance.drawToDepth=!1;this._initializeTextures();this.addTime(0);this.preWarm&&this.prewarm(this.lifetime);this.resetTime()},calcSpawnPosition:function(a,b){this.particleTex[4*b+0+8*this.numParticlesPot]=Math.random();this.particleTex[4*b+1+8*this.numParticlesPot]=Math.random();this.particleTex[4*b+2+8*this.numParticlesPot]=Math.random();this.particleTex[4*b+3+8*this.numParticlesPot]=Math.random();var c=this.particleTex[4*b+0+8*this.numParticlesPot],d=this.particleTex[4*b+1+8*this.numParticlesPot],
e=this.particleTex[4*b+2+8*this.numParticlesPot],g=this.particleTex[4*b+3+8*this.numParticlesPot];E.data[0]=c-0.5;E.data[1]=d-0.5;E.data[2]=e-0.5;this.emitterShape===pc.EMITTERSHAPE_BOX?z.copy(a).add(K.transformPoint(E)):(E.normalize(),z.copy(a).add(E.scale(g*this.spawnBounds)));this.particleTex[4*b]=z.data[0];this.particleTex[4*b+1]=z.data[1];this.particleTex[4*b+2]=z.data[2];this.particleTex[4*b+3]=pc.math.lerp(this.startAngle*pc.math.DEG_TO_RAD,this.startAngle2*pc.math.DEG_TO_RAD,c);c=-pc.math.lerp(this.rate,
this.rate2,c)*b;this.particleTex[4*b+3+4*this.numParticlesPot]=c},rebuildGraphs:function(){var a=this.precision,b=this.graphicsDevice,e;this.qLocalVelocity=this.localVelocityGraph.quantize(a);this.qVelocity=this.velocityGraph.quantize(a);this.qColor=this.colorGraph.quantize(a);this.qRotSpeed=this.rotationSpeedGraph.quantize(a);this.qScale=this.scaleGraph.quantize(a);this.qAlpha=this.alphaGraph.quantize(a);this.qLocalVelocity2=this.localVelocityGraph2.quantize(a);this.qVelocity2=this.velocityGraph2.quantize(a);
this.qColor2=this.colorGraph2.quantize(a);this.qRotSpeed2=this.rotationSpeedGraph2.quantize(a);this.qScale2=this.scaleGraph2.quantize(a);this.qAlpha2=this.alphaGraph2.quantize(a);for(e=0;e<a;e++)this.qRotSpeed[e]*=pc.math.DEG_TO_RAD,this.qRotSpeed2[e]*=pc.math.DEG_TO_RAD;this.localVelocityUMax=new pc.Vec3(0,0,0);this.velocityUMax=new pc.Vec3(0,0,0);this.colorUMax=new pc.Vec3(0,0,0);this.rotSpeedUMax=[0];this.scaleUMax=[0];this.alphaUMax=[0];this.qLocalVelocityDiv=d(this.qLocalVelocity,this.qLocalVelocity2,
this.localVelocityUMax.data);this.qVelocityDiv=d(this.qVelocity,this.qVelocity2,this.velocityUMax.data);this.qColorDiv=d(this.qColor,this.qColor2,this.colorUMax.data);this.qRotSpeedDiv=d(this.qRotSpeed,this.qRotSpeed2,this.rotSpeedUMax);this.qScaleDiv=d(this.qScale,this.qScale2,this.scaleUMax);this.qAlphaDiv=d(this.qAlpha,this.qAlpha2,this.alphaUMax);if(!this.useCpu){this.internalTex0=k(b,a,1,c(this.qLocalVelocity,this.qLocalVelocityDiv));this.internalTex1=k(b,a,1,c(this.qVelocity,this.qVelocityDiv));
e=this.qRotSpeed;for(var g=this.qScale,f=this.qScaleDiv,h=this.qRotSpeedDiv,m=this.qAlphaDiv,l=Array(4*e.length),n=0;n<e.length;n++)l[4*n]=e[n],l[4*n+1]=g[n],l[4*n+2]=0,l[4*n+3]=(255*f[n]<<16|255*h[n]<<8|255*m[n])/16777216;this.internalTex2=k(b,a,1,l)}e=this.qColor;g=this.qAlpha;f=Array(4*g.length);for(h=0;h<g.length;h++)f[4*h]=e[3*h],f[4*h+1]=e[3*h+1],f[4*h+2]=e[3*h+2],f[4*h+3]=g[h];this.internalTex3=k(b,a,1,f,pc.PIXELFORMAT_R8_G8_B8_A8,1)},_initializeTextures:function(){this.colorMap&&(this.material.setParameter("colorMap",
this.colorMap),this.lighting&&this.normalMap&&this.material.setParameter("normalMap",this.normalMap))},_hasDepthTarget:function(){return this.camera?!!this.camera._depthTarget:!1},regenShader:function(){var a=this.graphicsDevice.getProgramLibrary(),b=null!=this.normalMap;this.normalOption=0;this.lighting&&(this.normalOption=b?2:1);this.material.updateShader=function(){var b=a.getProgram("particle",{useCpu:this.emitter.useCpu,normal:this.emitter.normalOption,halflambert:this.emitter.halfLambert,stretch:this.emitter.stretch,
alignToMotion:this.emitter.alignToMotion,soft:this.emitter.depthSoftening&&this.emitter._hasDepthTarget(),mesh:this.emitter.useMesh,gamma:this.emitter.scene?this.emitter.scene.gammaCorrection:0,toneMap:this.emitter.scene?this.emitter.scene.toneMapping:0,fog:this.emitter.scene?this.emitter.scene.fog:"none",wrap:this.emitter.wrap&&this.emitter.wrapBounds,blend:this.blendType});this.setShader(b)};this.material.updateShader()},resetMaterial:function(){var a=this.material,b=this.graphicsDevice;a.setParameter("stretch",
this.stretch);a.setParameter("colorMult",this.intensity);this.useCpu||(a.setParameter("internalTex0",this.internalTex0),a.setParameter("internalTex1",this.internalTex1),a.setParameter("internalTex2",this.internalTex2));a.setParameter("internalTex3",this.internalTex3);a.setParameter("numParticles",this.numParticles);a.setParameter("numParticlesPot",this.numParticlesPot);a.setParameter("lifetime",this.lifetime);a.setParameter("rate",this.rate);a.setParameter("rateDiv",this.rate2-this.rate);a.setParameter("seed",
this.seed);a.setParameter("scaleDivMult",this.scaleUMax[0]);a.setParameter("alphaDivMult",this.alphaUMax[0]);a.setParameter("graphNumSamples",this.precision);a.setParameter("graphSampleSize",1/this.precision);a.setParameter("emitterScale",pc.Vec3.ONE.data);this.wrap&&this.wrapBounds&&a.setParameter("wrapBounds",this.wrapBounds.data);this.colorMap&&a.setParameter("colorMap",this.colorMap);this.lighting&&this.normalMap&&a.setParameter("normalMap",this.normalMap);0<this.depthSoftening&&this._hasDepthTarget()&&
(a.setParameter("uDepthMap",this.camera._depthTarget.colorBuffer),a.setParameter("screenSize",(new pc.Vec4(b.width,b.height,1/b.width,1/b.height)).data),a.setParameter("softening",1/(100*this.depthSoftening*this.depthSoftening)));0<this.stretch&&(a.cull=pc.CULLFACE_NONE)},_allocate:function(a){var b=a*this.numParticleVerts,c=a*this.numParticleIndices,d;if(void 0===this.vertexBuffer||this.vertexBuffer.getNumVertices()!==b){d=this.useCpu?[{semantic:pc.SEMANTIC_ATTR0,components:4,type:pc.ELEMENTTYPE_FLOAT32},
{semantic:pc.SEMANTIC_ATTR1,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR2,components:4,type:pc.ELEMENTTYPE_FLOAT32},{semantic:pc.SEMANTIC_ATTR3,components:2,type:pc.ELEMENTTYPE_FLOAT32}]:[{semantic:pc.SEMANTIC_ATTR0,components:4,type:pc.ELEMENTTYPE_FLOAT32}];d=new pc.VertexFormat(this.graphicsDevice,d);this.vertexBuffer=new pc.VertexBuffer(this.graphicsDevice,d,b,pc.BUFFER_DYNAMIC);this.indexBuffer=new pc.IndexBuffer(this.graphicsDevice,pc.INDEXFORMAT_UINT16,c);d=new Float32Array(this.vertexBuffer.lock());
var e,g;this.useMesh&&(e=new Float32Array(this.mesh.vertexBuffer.lock()),g=e.length/this.mesh.vertexBuffer.numVertices);for(c=0;c<b;c++){id=Math.floor(c/this.numParticleVerts);if(this.useMesh){var h=c%this.numParticleVerts;d[4*c]=e[h*g];d[4*c+1]=e[h*g+1];d[4*c+2]=e[h*g+2]}else h=c%4,d[4*c]=f[h][0],d[4*c+1]=f[h][1],d[4*c+2]=0;d[4*c+3]=id}this.useCpu&&(this.vbCPU=new Float32Array(d),this.vbOld=new Float32Array(this.vbCPU.length));this.vertexBuffer.unlock();this.useMesh&&this.mesh.vertexBuffer.unlock();
b=0;indices=new Uint16Array(this.indexBuffer.lock());this.useMesh&&(e=new Uint16Array(this.mesh.indexBuffer[0].lock()));for(c=0;c<a;c++)if(this.useMesh)for(g=0;g<this.numParticleIndices;g++)indices[c*this.numParticleIndices+g]=e[g]+c*this.numParticleVerts;else g=4*c,indices[b++]=g,indices[b++]=g+1,indices[b++]=g+2,indices[b++]=g,indices[b++]=g+2,indices[b++]=g+3;this.indexBuffer.unlock();this.useMesh&&this.mesh.indexBuffer[0].unlock()}},reset:function(){this.seed=Math.random();this.material.setParameter("seed",
this.seed);if(this.useCpu)for(var a=0;a<this.particleTexStart.length;a++)this.particleTex[a]=this.particleTexStart[a];else this._initializeTextures();this.resetTime();a=this.loop;this.loop=!0;this.addTime(0);this.loop=a;this.preWarm&&this.prewarm(this.lifetime)},prewarm:function(a){for(var b=Math.min(Math.floor(a/this.lifetime*this.precision),this.precision),a=a/b,c=0;c<b;c++)this.addTime(a)},resetTime:function(){var a=Math.max(this.rate,this.rate2)*this.numParticles+this.lifetime;this.endTime=Date.now()+
1E3*a},addTime:function(b,c){var d,f,h=this.graphicsDevice;h.setBlending(!1);h.setColorWrite(!0,!0,!0,!0);h.setCullMode(pc.CULLFACE_NONE);h.setDepthTest(!1);h.setDepthWrite(!1);if(this.lighting){if(!this.scene){console.error("There is no scene defined for lighting particles");return}for(d=0;6>d;d++)this.lightCube[3*d]=this.scene.ambientLight.r,this.lightCube[3*d+1]=this.scene.ambientLight.g,this.lightCube[3*d+2]=this.scene.ambientLight.b;var k=this.scene._globalLights;for(d=0;d<k.length;d++)for(f=
0;6>f;f++){var m=Math.max(this.lightCubeDir[f].dot(k[d]._direction),0)*k[d]._intensity;this.lightCube[3*f]+=k[d]._color.r*m;this.lightCube[3*f+1]+=k[d]._color.g*m;this.lightCube[3*f+2]+=k[d]._color.b*m}this.constantLightCube.setValue(this.lightCube)}this.scene&&this.camera!=this.scene._activeCamera&&(this.camera=this.scene._activeCamera,this.onChangeCamera());this.emitterShape===pc.EMITTERSHAPE_BOX&&(null===this.meshInstance.node?K.setTRS(pc.Vec3.ZERO,pc.Quat.IDENTITY,this.emitterExtents):K.setTRS(pc.Vec3.ZERO,
this.meshInstance.node.getRotation(),D.copy(this.emitterExtents).mul(this.meshInstance.node.getLocalScale())));d=null===this.meshInstance.node?pc.Vec3.ONE.data:this.meshInstance.node.getLocalScale().data;this.material.setParameter("emitterScale",d);if(this.useCpu){k=new Float32Array(this.vertexBuffer.lock());if(this.meshInstance.node){d=this.meshInstance.node.worldTransform;for(f=0;12>f;f++)F.data[f]=d.data[f];I=this.meshInstance.node.getLocalScale();G=Math.max(Math.max(I.x,I.y),I.z)}f=null===this.meshInstance.node?
pc.Vec3.ZERO:this.meshInstance.node.getPosition();m=this.camera?this.camera._node.getPosition():pc.Vec3.ZERO;for(d=0;d<this.numParticles;d++){var l=Math.floor(this.vbCPU[4*d*this.numParticleVerts+3]),n=this.particleTex[4*d+0+8*this.numParticlesPot];u.x=n;u.y=this.particleTex[4*d+1+8*this.numParticlesPot];u.z=this.particleTex[4*d+2+8*this.numParticlesPot];var r=pc.math.lerp(this.rate,this.rate2,n),z=this.lifetime,H=this.particleTex[4*l+3+4*this.numParticlesPot]+b,L=e(H/z),P=0,W=0,Y=0<H&&H<z;if(Y){s.data=
a(this.qLocalVelocity,L,3,s.data);x.data=a(this.qLocalVelocity2,L,3,x.data);v.data=a(this.qVelocity,L,3,v.data);C.data=a(this.qVelocity2,L,3,C.data);var U=a(this.qRotSpeed,L),W=a(this.qRotSpeed2,L),P=a(this.qScale,L),$=a(this.qScale2,L),aa=a(this.qAlpha,L),ba=a(this.qAlpha2,L);s.x=pc.math.lerp(s.x,x.x,u.x);s.y=pc.math.lerp(s.y,x.y,u.y);s.z=pc.math.lerp(s.z,x.z,u.z);0<this.initialVelocity&&(this.emitterShape===pc.EMITTERSHAPE_SPHERE?(E.copy(u).scale(2).sub(pc.Vec3.ONE).normalize(),s.add(E.scale(this.initialVelocity))):
s.add(pc.Vec3.FORWARD.scale(this.initialVelocity)));v.x=pc.math.lerp(v.x,C.x,u.x);v.y=pc.math.lerp(v.y,C.y,u.y);v.z=pc.math.lerp(v.z,C.z,u.z);U=pc.math.lerp(U,W,u.y);P=pc.math.lerp(P,$,1E4*n%1)*G;W=(ba-aa)*(1E3*n%1);this.meshInstance.node&&F.transformPoint(s,s);s.add(v.mul(I));A.copy(s);w.x=this.particleTex[4*l];w.y=this.particleTex[4*l+1];w.z=this.particleTex[4*l+2];B.copy(w).add(s.scale(b));y.copy(B);this.particleTex[4*l]=y.x;this.particleTex[4*l+1]=y.y;this.particleTex[4*l+2]=y.z;this.particleTex[4*
l+3]+=U*b;this.wrap&&this.wrapBounds&&(y.sub(f),y.x=y.x-this.wrapBounds.x*Math.floor(y.x/this.wrapBounds.x)-0.5*this.wrapBounds.x,y.y=y.y-this.wrapBounds.y*Math.floor(y.y/this.wrapBounds.y)-0.5*this.wrapBounds.y,y.z=y.z-this.wrapBounds.z*Math.floor(y.z/this.wrapBounds.z)-0.5*this.wrapBounds.z,y.add(f));0<this.sort&&(1===this.sort?(D.copy(y).sub(m),this.particleDistance[l]=-(D.x*D.x+D.y*D.y+D.z*D.z)):2===this.sort?this.particleDistance[l]=H:3===this.sort&&(this.particleDistance[l]=-H))}else this.calcSpawnPosition(f,
l);H>z&&this.loop&&(H=-r*l);0>=H&&c&&(H=z+1);this.particleTex[4*l+3+4*this.numParticlesPot]=H;for(n=0;n<this.numParticleVerts;n++)r=this.vbCPU[4*d*this.numParticleVerts+4*n],z=this.vbCPU[4*d*this.numParticleVerts+4*n+1],H=this.vbCPU[4*d*this.numParticleVerts+4*n+2],Y||(r=z=H=0),U=14*d*this.numParticleVerts+14*n,k[U]=y.x,k[U+1]=y.y,k[U+2]=y.z,k[U+3]=L,k[U+4]=this.alignToMotion?0:this.particleTex[4*l+3],k[U+5]=P,k[U+6]=W,k[U+7]=A.x,k[U+8]=r,k[U+9]=z,k[U+10]=H,k[U+11]=A.y,k[U+12]=A.z}if(this.sort>pc.PARTICLESORT_NONE&&
this.camera){for(d=0;d<this.numParticles;d++)this.vbToSort[d]=[d,Math.floor(this.vbCPU[4*d*this.numParticleVerts+3])];for(d=0;d<this.vbCPU.length;d++)this.vbOld[d]=this.vbCPU[d];var Z=this.particleDistance;this.vbToSort.sort(function(a,b){return Z[a[1]]-Z[b[1]]});for(d=0;d<this.numParticles;d++){k=this.vbToSort[d][0];for(m=0;m<this.numParticleVerts;m++)for(f=0;4>f;f++)this.vbCPU[4*d*this.numParticleVerts+4*m+f]=this.vbOld[4*k*this.numParticleVerts+4*m+f]}}this.vertexBuffer.unlock()}else this.frameRandom.x=
Math.random(),this.frameRandom.y=Math.random(),this.frameRandom.z=Math.random(),this.constantGraphSampleSize.setValue(1/this.precision),this.constantGraphNumSamples.setValue(this.precision),this.constantNumParticles.setValue(this.numParticles),this.constantNumParticlesPot.setValue(this.numParticlesPot),this.constantInternalTex0.setValue(this.internalTex0),this.constantInternalTex1.setValue(this.internalTex1),this.constantInternalTex2.setValue(this.internalTex2),f=null===this.meshInstance.node?pc.Vec3.ZERO.data:
this.meshInstance.node.getPosition().data,k=null===this.meshInstance.node?pc.Mat4.IDENTITY:this.meshInstance.node.getWorldTransform(),this.emitterShape===pc.EMITTERSHAPE_BOX?(g(K,J),this.constantSpawnBounds.setValue(J.data)):this.constantSpawnBoundsSphere.setValue(this.emitterRadius),this.constantInitialVelocity.setValue(this.initialVelocity),g(k,N),this.constantEmitterPos.setValue(f),this.constantFrameRandom.setValue(this.frameRandom.data),this.constantDelta.setValue(b),this.constantRate.setValue(this.rate),
this.constantRateDiv.setValue(this.rate2-this.rate),this.constantStartAngle.setValue(this.startAngle*pc.math.DEG_TO_RAD),this.constantStartAngle2.setValue(this.startAngle2*pc.math.DEG_TO_RAD),this.constantSeed.setValue(this.seed),this.constantLifetime.setValue(this.lifetime),this.constantEmitterScale.setValue(d),this.constantEmitterMatrix.setValue(N.data),this.constantLocalVelocityDivMult.setValue(this.localVelocityUMax.data),this.constantVelocityDivMult.setValue(this.velocityUMax.data),this.constantRotSpeedDivMult.setValue(this.rotSpeedUMax[0]),
d=this.swapTex?this.particleTexOUT:this.particleTexIN,k=this.swapTex?this.particleTexIN:this.particleTexOUT,this.constantParticleTexIN.setValue(d),c?pc.drawQuadWithShader(h,this.swapTex?this.rtParticleTexIN:this.rtParticleTexOUT,this.shaderParticleUpdateOnStop):pc.drawQuadWithShader(h,this.swapTex?this.rtParticleTexIN:this.rtParticleTexOUT,this.loop?this.shaderParticleUpdateRespawn:this.shaderParticleUpdateNoRespawn),this.constantParticleTexOUT.setValue(k),this.material.setParameter("particleTexOUT",
k),this.material.setParameter("particleTexIN",d),this.swapTex=!this.swapTex;if(!this.loop&&this.onFinished&&Date.now()>this.endTime)this.onFinished();h.setDepthTest(!0);h.setDepthWrite(!0)}};return{ParticleEmitter:L}}());pc.extend(pc,function(){var e=function(a,b,c){this.device=a;a=a.getProgramLibrary();this.pickProgStatic=a.getProgram("pick",{skin:!1});this.pickProgSkin=a.getProgram("pick",{skin:!0});this.pickColor=new Float32Array(4);this.scene=null;this.clearOptions={color:[1,1,1,1],depth:1,flags:pc.CLEARFLAG_COLOR|pc.CLEARFLAG_DEPTH};this.resize(b,c)};e.prototype.getSelection=function(a){var b=this.device;a.width=a.width||1;a.height=a.height||1;var c=b.getRenderTarget();b.setRenderTarget(this._pickBufferTarget);
b.updateBegin();var d=new Uint8Array(4*a.width*a.height);b.readPixels(a.x,a.y,a.width,a.height,d);b.updateEnd();b.setRenderTarget(c);b=[];for(c=0;c<a.width*a.height;c++){var e=d[4*c+0]<<16|d[4*c+1]<<8|d[4*c+2];16777215!==e&&(e=this.scene.drawCalls[e],-1===b.indexOf(e)&&b.push(e))}return b};e.prototype.prepare=function(a,b){var c=this.device;this.scene=b;var d=c.getRenderTarget();c.setRenderTarget(this._pickBufferTarget);c.updateBegin();c.setViewport(0,0,this._pickBufferTarget.width,this._pickBufferTarget.height);
c.setScissor(0,0,this._pickBufferTarget.width,this._pickBufferTarget.height);c.clear(this.clearOptions);var e,f,k,m,h,n=b.drawCalls,l=n.length,c=this.device;f=c.scope;var r=f.resolve("matrix_model"),v=f.resolve("texture_poseMap"),s=f.resolve("texture_poseMapSize"),C=f.resolve("matrix_pose[0]"),x=f.resolve("uColor");e=f.resolve("matrix_projection");f=f.resolve("matrix_viewProjection");m=a._node.getWorldTransform();k=a.getProjectionMatrix();m=m.clone().invert();h=new pc.Mat4;h.mul2(k,m);e.setValue(k.data);
f.setValue(h.data);for(e=0;e<l;e++)if(!n[e].command){k=n[e];f=k.mesh;m=k.material;h=f.primitive[pc.RENDERSTYLE_SOLID].type;var u=m instanceof pc.PhongMaterial||m instanceof pc.BasicMaterial;if((h===pc.PRIMITIVE_TRIANGLES||h===pc.PRIMITIVE_TRISTRIP||h===pc.PRIMITIVE_TRIFAN)&&u)c.setBlending(!1),c.setCullMode(m.cull),c.setDepthWrite(m.depthWrite),c.setDepthTest(m.depthTest),r.setValue(k.node.worldTransform.data),k.skinInstance&&(c.supportsBoneTextures?(v.setValue(k.skinInstance.boneTexture),s.setValue([k.skinInstance.boneTexture.width,
k.skinInstance.boneTexture.height])):C.setValue(k.skinInstance.matrixPalette)),this.pickColor[0]=(e>>16&255)/255,this.pickColor[1]=(e>>8&255)/255,this.pickColor[2]=(e&255)/255,this.pickColor[3]=1,x.setValue(this.pickColor),c.setShader(f.skin?this.pickProgSkin:this.pickProgStatic),c.setVertexBuffer(f.vertexBuffer,0),c.setIndexBuffer(f.indexBuffer[pc.RENDERSTYLE_SOLID]),c.draw(f.primitive[pc.RENDERSTYLE_SOLID])}c.setViewport(0,0,c.width,c.height);c.setScissor(0,0,c.width,c.height);c.updateEnd();c.setRenderTarget(d)};
e.prototype.resize=function(a,b){var c=new pc.Texture(this.device,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a,height:b,autoMipmap:!1});c.minFilter=pc.FILTER_NEAREST;c.magFilter=pc.FILTER_NEAREST;c.addressU=pc.ADDRESS_CLAMP_TO_EDGE;c.addressV=pc.ADDRESS_CLAMP_TO_EDGE;this._pickBufferTarget=new pc.RenderTarget(this.device,c,{depth:!0})};Object.defineProperty(e.prototype,"renderTarget",{get:function(){return this._pickBufferTarget}});Object.defineProperty(e.prototype,"width",{get:function(){return this._pickBufferTarget.width}});
Object.defineProperty(e.prototype,"height",{get:function(){return this._pickBufferTarget.height}});return{Picker:e}}());pc.calculateTangents=function(e,a,b,c){var d=c.length/3,g=e.length/3,f,k,m,h,n,l,r,v,s,C,x,u,w,B,y=new pc.Vec3,A=new pc.Vec3,F=new pc.Vec3,J=new pc.Vec3,N=new pc.Vec3,G=new pc.Vec2,I=new pc.Vec2,K=new pc.Vec2,E,z=new Float32Array(3*g),D=new Float32Array(3*g),H=[];for(E=0;E<d;E++)f=c[3*E],k=c[3*E+1],m=c[3*E+2],F.set(e[3*f],e[3*f+1],e[3*f+2]),J.set(e[3*k],e[3*k+1],e[3*k+2]),N.set(e[3*m],e[3*m+1],e[3*m+2]),G.set(b[2*f],b[2*f+1]),I.set(b[2*k],b[2*k+1]),K.set(b[2*m],b[2*m+1]),h=J.x-F.x,n=N.x-F.x,l=J.y-
F.y,r=N.y-F.y,v=J.z-F.z,s=N.z-F.z,C=I.x-G.x,x=K.x-G.x,u=I.y-G.y,w=K.y-G.y,B=1/(C*w-x*u),y.set((w*h-u*n)*B,(w*l-u*r)*B,(w*v-u*s)*B),A.set((C*n-x*h)*B,(C*r-x*l)*B,(C*s-x*v)*B),z[3*f+0]+=y.x,z[3*f+1]+=y.y,z[3*f+2]+=y.z,z[3*k+0]+=y.x,z[3*k+1]+=y.y,z[3*k+2]+=y.z,z[3*m+0]+=y.x,z[3*m+1]+=y.y,z[3*m+2]+=y.z,D[3*f+0]+=A.x,D[3*f+1]+=A.y,D[3*f+2]+=A.z,D[3*k+0]+=A.x,D[3*k+1]+=A.y,D[3*k+2]+=A.z,D[3*m+0]+=A.x,D[3*m+1]+=A.y,D[3*m+2]+=A.z;u=new pc.Vec3;w=new pc.Vec3;e=new pc.Vec3;b=new pc.Vec3;for(E=0;E<g;E++)e.set(a[3*
E],a[3*E+1],a[3*E+2]),u.set(z[3*E],z[3*E+1],z[3*E+2]),w.set(D[3*E],D[3*E+1],D[3*E+2]),c=e.dot(u),b.copy(e).scale(c),b.sub2(u,b).normalize(),H[4*E]=b.x,H[4*E+1]=b.y,H[4*E+2]=b.z,b.cross(e,u),H[4*E+3]=0>b.dot(w)?-1:1;return H};
pc.createMesh=function(e,a,b){var c=b&&void 0!==b.normals?b.normals:null,d=b&&void 0!==b.tangents?b.tangents:null,g=b&&void 0!==b.uvs?b.uvs:null,b=b&&void 0!==b.indices?b.indices:null,f=[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}];null!==c&&f.push({semantic:pc.SEMANTIC_NORMAL,components:3,type:pc.ELEMENTTYPE_FLOAT32});null!==d&&f.push({semantic:pc.SEMANTIC_TANGENT,components:4,type:pc.ELEMENTTYPE_FLOAT32});null!==g&&f.push({semantic:pc.SEMANTIC_TEXCOORD0,components:2,
type:pc.ELEMENTTYPE_FLOAT32});for(var k=new pc.VertexFormat(e,f),f=a.length/3,k=new pc.VertexBuffer(e,k,f),m=new pc.VertexIterator(k),h=0;h<f;h++)m.element[pc.SEMANTIC_POSITION].set(a[3*h],a[3*h+1],a[3*h+2]),null!==c&&m.element[pc.SEMANTIC_NORMAL].set(c[3*h],c[3*h+1],c[3*h+2]),null!==d&&m.element[pc.SEMANTIC_TANGENT].set(d[4*h],d[4*h+1],d[4*h+2],d[4*h+3]),null!==g&&m.element[pc.SEMANTIC_TEXCOORD0].set(g[2*h],g[2*h+1]),m.next();m.end();c=null;if(d=null!==b)c=new pc.IndexBuffer(e,pc.INDEXFORMAT_UINT16,
b.length),(new Uint16Array(c.lock())).set(b),c.unlock();e=new pc.shape.Aabb;e.compute(a);a=new pc.Mesh;a.vertexBuffer=k;a.indexBuffer[0]=c;a.primitive[0].type=pc.PRIMITIVE_TRIANGLES;a.primitive[0].base=0;a.primitive[0].count=d?b.length:f;a.primitive[0].indexed=d;a.aabb=e;return a};
pc.createTorus=function(e,a){var b=a&&void 0!==a.tubeRadius?a.tubeRadius:0.2,c=a&&void 0!==a.ringRadius?a.ringRadius:0.3,d=a&&void 0!==a.segments?a.segments:30,g=a&&void 0!==a.sides?a.sides:20,f,k,m,h,n,l,r,v,s,C,x=[],u=[],w=[],B=[];for(f=0;f<=g;f++)for(k=0;k<=d;k++)m=Math.cos(2*Math.PI*k/d)*(c+b*Math.cos(2*Math.PI*f/g)),h=Math.sin(2*Math.PI*f/g)*b,n=Math.sin(2*Math.PI*k/d)*(c+b*Math.cos(2*Math.PI*f/g)),l=Math.cos(2*Math.PI*k/d)*Math.cos(2*Math.PI*f/g),r=Math.sin(2*Math.PI*f/g),v=Math.sin(2*Math.PI*
k/d)*Math.cos(2*Math.PI*f/g),s=f/g,C=1-k/d,x.push(m,h,n),u.push(l,r,v),w.push(s,C),f<g&&k<d&&(m=f*(d+1)+k,h=(f+1)*(d+1)+k,n=f*(d+1)+(k+1),l=(f+1)*(d+1)+(k+1),B.push(m,h,n),B.push(h,l,n));b={normals:u,uvs:w,indices:B};pc.precalculatedTangents&&(b.tangents=pc.calculateTangents(x,u,w,B));return pc.createMesh(e,x,b)};
pc._createConeData=function(e,a,b,c,d,g){var f,k,m,h,n,l=new pc.Vec3;m=new pc.Vec3;h=new pc.Vec3;var r,v,s=[],C=[],x=[],u=[],w;if(0<b)for(f=0;f<=c;f++)for(k=0;k<=d;k++)theta=2*(k/d)*Math.PI-Math.PI,w=Math.sin(theta),v=Math.cos(theta),r=new pc.Vec3(w*e,-b/2,v*e),n=new pc.Vec3(w*a,b/2,v*a),l.lerp(r,n,f/c),m.sub2(n,r).normalize(),v=new pc.Vec3(v,0,-w),h.cross(v,m).normalize(),s.push(l.x,l.y,l.z),C.push(h.x,h.y,h.z),x.push(k/d,f/c),f<c&&k<d&&(v=f*(d+1)+k,w=f*(d+1)+(k+1),n=(f+1)*(d+1)+k,r=(f+1)*(d+1)+
(k+1),u.push(v,w,n),u.push(w,r,n));if(g){e=Math.floor(d/2);l=b/2;for(b=0;b<=e;b++){theta=0.5*b*Math.PI/e;w=Math.sin(theta);v=Math.cos(theta);for(f=0;f<=d;f++)phi=2*f*Math.PI/d-Math.PI/2,m=Math.sin(phi),g=Math.cos(phi),g*=w,k=v,m*=w,h=1-f/d,n=1-b/e,s.push(g*a,k*a+l,m*a),C.push(g,k,m),x.push(h,n)}r=(c+1)*(d+1);for(b=0;b<e;++b)for(f=0;f<d;++f)v=b*(d+1)+f,w=v+d+1,u.push(r+v+1,r+w,r+v),u.push(r+v+1,r+w+1,r+w);for(b=0;b<=e;b++){theta=0.5*Math.PI+0.5*b*Math.PI/e;w=Math.sin(theta);v=Math.cos(theta);for(f=
0;f<=d;f++)phi=2*f*Math.PI/d-Math.PI/2,m=Math.sin(phi),g=Math.cos(phi),g*=w,k=v,m*=w,h=1-f/d,n=1-b/e,s.push(g*a,k*a-l,m*a),C.push(g,k,m),x.push(h,n)}r=(c+1)*(d+1)+(d+1)*(e+1);for(b=0;b<e;++b)for(f=0;f<d;++f)v=b*(d+1)+f,w=v+d+1,u.push(r+v+1,r+w,r+v),u.push(r+v+1,r+w+1,r+w)}else{r=(c+1)*(d+1);if(0<e)for(f=0;f<d;f++)theta=2*(f/d)*Math.PI,g=Math.sin(theta),k=-b/2,m=Math.cos(theta),h=1-(g+1)/2,n=(m+1)/2,s.push(g*e,k,m*e),C.push(0,-1,0),x.push(h,n),1<f&&u.push(r,r+f,r+f-1);r+=d;if(0<a)for(f=0;f<d;f++)theta=
2*(f/d)*Math.PI,g=Math.sin(theta),k=b/2,m=Math.cos(theta),h=1-(g+1)/2,n=(m+1)/2,s.push(g*a,k,m*a),C.push(0,1,0),x.push(h,n),1<f&&u.push(r,r+f-1,r+f)}return{positions:s,normals:C,uvs:x,indices:u}};
pc.createCylinder=function(e,a){var b=a&&void 0!==a.baseRadius?a.baseRadius:0.5,b=pc._createConeData(b,b,a&&void 0!==a.height?a.height:1,a&&void 0!==a.heightSegments?a.heightSegments:5,a&&void 0!==a.capSegments?a.capSegments:20,!1);pc.precalculatedTangents&&(b.tangents=pc.calculateTangents(b.positions,b.normals,b.uvs,b.indices));return pc.createMesh(e,b.positions,b)};
pc.createCapsule=function(e,a){var b=a&&void 0!==a.radius?a.radius:0.3,b=pc._createConeData(b,b,(a&&void 0!==a.height?a.height:1)-2*b,a&&void 0!==a.heightSegments?a.heightSegments:1,a&&void 0!==a.sides?a.sides:20,!0);pc.precalculatedTangents&&(b.tangents=pc.calculateTangents(b.positions,b.normals,b.uvs,b.indices));return pc.createMesh(e,b.positions,b)};
pc.createCone=function(e,a){var b=pc._createConeData(a&&void 0!==a.baseRadius?a.baseRadius:0.5,a&&void 0!==a.peakRadius?a.peakRadius:0,a&&void 0!==a.height?a.height:1,a&&void 0!==a.heightSegments?a.heightSegments:5,a&&void 0!==a.capSegments?a.capSegments:18,!1);pc.precalculatedTangents&&(b.tangents=pc.calculateTangents(b.positions,b.normals,b.uvs,b.indices));return pc.createMesh(e,b.positions,b)};
pc.createSphere=function(e,a){var b=a&&void 0!==a.radius?a.radius:0.5,c=a&&void 0!==a.latitudeBands?a.latitudeBands:16,d=a&&void 0!==a.longitudeBands?a.longitudeBands:16,g,f,k,m,h,n,l,r,v,s=[],C=[],x=[],u=[];for(f=0;f<=c;f++){g=f*Math.PI/c;k=Math.sin(g);m=Math.cos(g);for(g=0;g<=d;g++)h=2*g*Math.PI/d-Math.PI/2,n=Math.sin(h),h=Math.cos(h),h*=k,l=m,n*=k,r=1-g/d,v=1-f/c,s.push(h*b,l*b,n*b),C.push(h,l,n),x.push(r,v)}for(f=0;f<c;++f)for(g=0;g<d;++g)b=f*(d+1)+g,k=b+d+1,u.push(b+1,k,b),u.push(b+1,k+1,k);
c={normals:C,uvs:x,indices:u};pc.precalculatedTangents&&(c.tangents=pc.calculateTangents(s,C,x,u));return pc.createMesh(e,s,c)};
pc.createPlane=function(e,a){var b=a&&void 0!==a.halfExtents?a.halfExtents:new pc.Vec2(0.5,0.5),c=a&&void 0!==a.widthSegments?a.widthSegments:5,d=a&&void 0!==a.lengthSegments?a.lengthSegments:5,g,f,k,m,h,n,l=[],r=[],v=[],s=[];for(g=0;g<=c;g++)for(f=0;f<=d;f++)k=-b.x+2*b.x*g/c,m=-(-b.y+2*b.y*f/d),h=g/c,n=f/d,l.push(k,0,m),r.push(0,1,0),v.push(h,n),g<c&&f<d&&(s.push(f+g*(c+1),f+(g+1)*(c+1),f+g*(c+1)+1),s.push(f+(g+1)*(c+1),f+(g+1)*(c+1)+1,f+g*(c+1)+1));b={normals:r,uvs:v,indices:s};pc.precalculatedTangents&&
(b.tangents=pc.calculateTangents(l,r,v,s));return pc.createMesh(e,l,b)};
pc.createBox=function(e,a){var b=a&&void 0!==a.halfExtents?a.halfExtents:new pc.Vec3(0.5,0.5,0.5),c=a&&void 0!==a.widthSegments?a.widthSegments:1,d=a&&void 0!==a.lengthSegments?a.lengthSegments:1,g=a&&void 0!==a.heightSegments?a.heightSegments:1,f=[new pc.Vec3(-b.x,-b.y,b.z),new pc.Vec3(b.x,-b.y,b.z),new pc.Vec3(b.x,b.y,b.z),new pc.Vec3(-b.x,b.y,b.z),new pc.Vec3(b.x,-b.y,-b.z),new pc.Vec3(-b.x,-b.y,-b.z),new pc.Vec3(-b.x,b.y,-b.z),new pc.Vec3(b.x,b.y,-b.z)],k=[[0,1,3],[4,5,7],[3,2,6],[1,0,4],[1,4,
2],[5,0,6]],m=[[0,0,1],[0,0,-1],[0,1,0],[0,-1,0],[1,0,0],[-1,0,0]],h=[],n=[],l=[],r=[],b=function(a,b,c){var d,e,g,B,y=h.length/3;for(g=0;g<=b;g++)for(B=0;B<=c;B++){d=new pc.Vec3;e=new pc.Vec3;var A=new pc.Vec3,F=new pc.Vec3;d.lerp(f[k[a][0]],f[k[a][1]],g/b);e.lerp(f[k[a][0]],f[k[a][2]],B/c);A.sub2(e,f[k[a][0]]);F.add2(d,A);d=g/b;e=B/c;h.push(F.x,F.y,F.z);n.push(m[a][0],m[a][1],m[a][2]);l.push(d,e);g<b&&B<c&&(r.push(y+B+g*(b+1),y+B+(g+1)*(b+1),y+B+g*(b+1)+1),r.push(y+B+(g+1)*(b+1),y+B+(g+1)*(b+1)+
1,y+B+g*(b+1)+1))}};b(0,c,g);b(1,c,g);b(2,c,d);b(3,c,d);b(4,d,g);b(5,d,g);c={normals:n,uvs:l,indices:r};pc.precalculatedTangents&&(c.tangents=pc.calculateTangents(h,n,l,r));return pc.createMesh(e,h,c)};pc.extend(pc,function(){var e=function(){this._name="";this._duration=0;this._nodes=[];this._nodeDict={}};e.prototype.getDuration=function(){return this._duration};e.prototype.getName=function(){return this._name};e.prototype.getNode=function(a){return this._nodeDict[a]};e.prototype.getNodes=function(){return this._nodes};e.prototype.setDuration=function(a){this._duration=a};e.prototype.setName=function(a){this._name=a};e.prototype.addNode=function(a){this._nodes.push(a);this._nodeDict[a._name]=a};
return{Animation:e,Key:function(a,b,c,d){this.time=a;this.position=b;this.rotation=c;this.scale=d},Node:function(){this._name="";this._keys=[]}}}());pc.extend(pc,function(){function e(){this._written=!1;this._name="";this._keyFrames=[];this._quat=new pc.Quat;this._pos=new pc.Vec3;this._scale=new pc.Vec3;this._targetNode=null}e.prototype={getTarget:function(){return this._targetNode},setTarget:function(a){this._targetNode=a}};var a=function(a){function c(a){var b=a.getName(),k=new e;k._name=b;d._interpolatedKeys.push(k);d._interpolatedKeyDict[b]=k;d._currKeyIndices[b]=0;a=a.getChildren();for(b=0;b<a.length;b++)c(a[b])}this._animation=null;this._time=
0;this.looping=!0;this._interpolatedKeys=[];this._interpolatedKeyDict={};this._currKeyIndices={};this.graph=null;var d=this;c(a)};a.prototype.addTime=function(a){if(null!==this._animation&&(this._time!==h||this.looping)){var c,d,e,f,k,m=this._animation.getNodes();this._time+=a;var h=this._animation.getDuration();if(this._time>h){this._time=this.looping?0:h;for(h=0;h<m.length;h++)c=m[h],d=c._name,this._currKeyIndices[d]=0}else if(0>this._time){this._time=this.looping?h:0;for(h=0;h<m.length;h++)c=m[h],
d=c._name,this._currKeyIndices[d]=c._keys.length-2}a=0<a?1:-1;for(h=0;h<m.length;h++)if(c=m[h],d=c._name,e=c._keys,c=this._interpolatedKeyDict[d],1===e.length)c._pos.copy(e[0].position),c._quat.copy(e[0].rotation),c._scale(e[0].scale);else for(var n=this._currKeyIndices[d];n<e.length-1&&0<=n;n+=a)if(f=e[n],k=e[n+1],f.time<=this._time&&k.time>=this._time){e=(this._time-f.time)/(k.time-f.time);c._pos.lerp(f.position,k.position,e);c._quat.slerp(f.rotation,k.rotation,e);c._scale.lerp(f.scale,k.scale,
e);c._written=!0;this._currKeyIndices[d]=n;break}}};a.prototype.blend=function(a,c,d){for(var e=this._interpolatedKeys.length,f=0;f<e;f++){var k=a._interpolatedKeys[f],m=c._interpolatedKeys[f],h=this._interpolatedKeys[f];k._written&&m._written?(h._quat.slerp(k._quat,c._interpolatedKeys[f]._quat,d),h._pos.lerp(k._pos,c._interpolatedKeys[f]._pos,d),h._scale.lerp(k._scale,m._scale,d),h._written=!0):k._written?(h._quat.copy(k._quat),h._pos.copy(k._pos),h._scale.copy(k._scale),h._written=!0):m._written&&
(h._quat.copy(m._quat),h._pos.copy(m._pos),h._scale.copy(m._scale),h._written=!0)}};a.prototype.getAnimation=function(){return this._animation};a.prototype.getCurrentTime=function(){return this._time};a.prototype.setCurrentTime=function(a){this._time=a;for(var a=this._interpolatedKeys.length,c=0;c<a;c++)this._currKeyIndices[this._interpolatedKeys[c]._name]=0;this.addTime(0);this.updateGraph()};a.prototype.getNumNodes=function(){return this._interpolatedKeys.length};a.prototype.setAnimation=function(a){this._animation=
a;this.setCurrentTime(0)};a.prototype.setGraph=function(a){var c;if(this.graph=a)for(c=0;c<this._interpolatedKeys.length;c++){var d=a.findByName(this._interpolatedKeys[c]._name);this._interpolatedKeys[c].setTarget(d)}else for(c=0;c<this._interpolatedKeys.length;c++)this._interpolatedKeys[c].setTarget(null)};a.prototype.updateGraph=function(){if(this.graph)for(var a=0;a<this._interpolatedKeys.length;a++){var c=this._interpolatedKeys[a];if(c._written){var d=c.getTarget();d.localPosition.copy(c._pos);
d.localRotation.copy(c._quat);d.localScale.copy(c._scale);d.dirtyLocal=!0;c._written=!1}}};a.prototype.setLooping=function(a){this.looping=a};a.prototype.getLooping=function(){return this.looping};return{Skeleton:a}}());pc.extend(pc,function(){function e(){return!!("undefined"!==typeof AudioContext||"undefined"!==typeof webkitAudioContext)}var a=function(){e()&&("undefined"!==typeof AudioContext?this.context=new AudioContext:"undefined"!==typeof webkitAudioContext&&(this.context=new webkitAudioContext));this.listener=new pc.Listener(this);this.volume=1;this.suspended=!1;pc.events.attach(this)};a.hasAudio=function(){return"undefined"!==typeof Audio};a.hasAudioContext=e;a.isSupported=function(a,c){var d={".ogg":"audio/ogg",
".mp3":"audio/mpeg",".wav":"audio/x-wav"},e=pc.path.getExtension(a);return d[e]?(c||(c=new Audio),""!==c.canPlayType(d[e])):!1};a.prototype={createSound:function(a,c,d){var e=null;pc.Sound?e=new pc.Sound(this,a,c,d):d();return e},playSound:function(a,c){var c=c||{},d=null;pc.Channel&&(d=new pc.Channel(this,a,c),d.play());return d},playSound3d:function(a,c,d){var d=d||{},e=null;pc.Channel3d&&(e=new pc.Channel3d(this,a,d),e.setPosition(c),d.volume&&e.setVolume(d.volume),d.loop&&e.setLoop(d.loop),d.maxDistance&&
e.setMaxDistance(d.maxDistance),d.minDistance&&e.setMinDistance(d.minDistance),d.rollOffFactor&&e.setRollOffFactor(d.rollOffFactor),e.play());return e},getListener:function(){return this.listener},getVolume:function(){return this.volume},setVolume:function(a){this.volume=a;this.fire("volumechange",a)},suspend:function(){this.suspended=!0;this.fire("suspend")},resume:function(){this.suspended=!1;this.fire("resume")}};return{AudioManager:a}}());pc.extend(pc,function(){var e;pc.AudioManager.hasAudioContext()?e=function(a,b,c,d){this.buffer=null;this.isLoaded=!1;pc.AudioManager.isSupported(b,this.audio)?a.context&&pc.net.http.get(b,function(b){a.context.decodeAudioData(b,function(a){this.buffer=a;this.isLoaded=!0;c(this)}.bind(this),d)}.bind(this),{error:d}):setTimeout(function(){d(pc.string.format("Audio format for {0} not supported",b))},0)}:pc.AudioManager.hasAudio()&&(e=function(a,b,c){this.isLoaded=!1;this.audio=new Audio;this.audio.oncanplaythrough=
function(){this.isLoaded||(this.isLoaded=!0,c(this))}.bind(this);this.audio.src=b});return{Sound:e}}());pc.extend(pc,function(){var e=function(a){this.position=new pc.Vec3;this.velocity=new pc.Vec3;this.orientation=new pc.Mat4;pc.AudioManager.hasAudioContext()&&(this.listener=a.context.listener)};e.prototype={getPosition:function(){return this.position},setPosition:function(a){this.position.copy(a);this.listener&&this.listener.setPosition(a.x,a.y,a.z)},getVelocity:function(){return this.velocity},setVelocity:function(a){this.velocity.copy(a);this.listener&&this.listener.setPosition(a.x,a.y,a.z)},setOrientation:function(a){this.orientation.copy(a);
this.listener&&this.listener.setOrientation(-a.data[8],-a.data[9],-a.data[10],a.data[4],a.data[5],a.data[6])},getOrientation:function(){return this.orientation}};return{Listener:e}}());pc.extend(pc,function(){var e;pc.AudioManager.hasAudioContext()?(e=function(a,b,c){c=c||{};this.volume=void 0===c.volume?1:c.volume;this.loop=void 0===c.loop?!1:c.loop;this.pitch=void 0===c.pitch?1:c.pitch;this.sound=b;this.suspended=this.paused=!1;this.startOffset=this.startTime=0;this.manager=a;this.source=null;this.gain=a.context.createGain()},e.prototype={play:function(){if(this.source)throw Error("Call stop() before calling play()");this._createSource();this.setVolume(this.volume);this.setLoop(this.loop);
this.setPitch(this.pitch);this.startTime=this.manager.context.currentTime;this.source.start(0,this.startOffset%this.source.buffer.duration);this.manager.on("volumechange",this.onManagerVolumeChange,this);this.manager.on("suspend",this.onManagerSuspend,this);this.manager.on("resume",this.onManagerResume,this)},pause:function(){this.source&&(this.paused=!0,this.startOffset+=this.manager.context.currentTime-this.startTime,this.source.stop(0),this.source=null)},unpause:function(){if(this.source||!this.paused)throw Error("Call pause() before unpausing.");
this._createSource();this.setVolume(this.volume);this.setLoop(this.loop);this.setPitch(this.pitch);this.startTime=this.manager.context.currentTime;this.source.start(0,this.startOffset%this.source.buffer.duration);this.paused=!1},stop:function(){this.source&&(this.source.stop(0),this.source=null);this.manager.off("volumechange",this.onManagerVolumeChange,this);this.manager.off("suspend",this.onManagerSuspend,this);this.manager.off("resume",this.onManagerResume,this)},setLoop:function(a){this.loop=
a;this.source&&(this.source.loop=a)},setVolume:function(a){this.volume=a;this.gain&&(this.gain.gain.value=a*this.manager.getVolume())},setPitch:function(a){this.pitch=a;this.source&&(this.source.playbackRate.value=a)},isPlaying:function(){return!this.paused&&this.source.playbackState===this.source.PLAYING_STATE},getDuration:function(){return this.source?this.source.buffer.duration:0},_createSource:function(){var a=this.manager.context;this.source=a.createBufferSource();this.source.buffer=this.sound.buffer;
this.source.connect(this.gain);this.gain.connect(a.destination)}}):pc.AudioManager.hasAudio()?(e=function(a,b,c){this.volume=c.volume||1;this.loop=c.loop||!1;this.sound=b;this.pitch=void 0!==c.pitch?c.pitch:1;this.suspended=this.paused=!1;this.manager=a;this.source=b.audio.cloneNode(!1);this.source.pause()},e.prototype={play:function(){this.source&&(this.paused=!1,this.setVolume(this.volume),this.setLoop(this.loop),this.setPitch(this.pitch),this.source.play());this.manager.on("volumechange",this.onManagerVolumeChange,
this);this.manager.on("suspend",this.onManagerSuspend,this);this.manager.on("resume",this.onManagerResume,this)},pause:function(){this.source&&(this.paused=!0,this.source.pause())},unpause:function(){this.source&&(this.paused=!1,this.source.play())},stop:function(){this.source&&this.source.pause();this.manager.off("volumechange",this.onManagerVolumeChange,this);this.manager.off("suspend",this.onManagerSuspend,this);this.manager.off("resume",this.onManagerResume,this)},setVolume:function(a){this.volume=
a;this.source&&(this.source.volume=a*this.manager.getVolume())},setLoop:function(a){this.loop=a;this.source&&(this.source.loop=a)},setPitch:function(a){this.pitch=a;this.source&&(this.source.playbackRate=a)},getDuration:function(){if(this.source){var a=this.source.duration;if(a===a)return a}return 0},isPlaying:function(){return!this.source.paused}}):(console.warn("No support for 2D audio found"),e=function(){});pc.extend(e.prototype,{getVolume:function(){return this.volume},getLoop:function(){return this.loop},
getPitch:function(){return this.pitch},onManagerVolumeChange:function(){this.setVolume(this.getVolume())},onManagerSuspend:function(){this.isPlaying()&&!this.suspended&&(this.suspended=!0,this.pause())},onManagerResume:function(){this.suspended&&(this.suspended=!1,this.unpause())}});return{Channel:e}}());pc.extend(pc,function(){var e;if(pc.AudioManager.hasAudioContext())e=function(a){this.position=new pc.Vec3;this.velocity=new pc.Vec3;this.panner=a.context.createPanner()},e=pc.inherits(e,pc.Channel),e.prototype=pc.extend(e.prototype,{getPosition:function(){return this.position},setPosition:function(a){this.position.copy(a);this.panner.setPosition(a.x,a.y,a.z)},getVelocity:function(){return this.velocity},setVelocity:function(a){this.velocity.copy(a);this.panner.setVelocity(a.x,a.y,a.z)},getMaxDistance:function(){return this.panner.maxDistance},
setMaxDistance:function(a){this.panner.maxDistance=a},getMinDistance:function(){return this.panner.refDistance},setMinDistance:function(a){this.panner.refDistance=a},getRollOffFactor:function(){return this.panner.rolloffFactor},setRollOffFactor:function(a){this.panner.rolloffFactor=a},_createSource:function(){var a=this.manager.context;this.source=a.createBufferSource();this.source.buffer=this.sound.buffer;this.source.connect(this.panner);this.panner.connect(this.gain);this.gain.connect(a.destination)}});
else if(pc.AudioManager.hasAudio()){var a=new pc.Vec3,b;e=pc.inherits(function(){this.position=new pc.Vec3;this.velocity=new pc.Vec3;this.maxDistance=1E4;this.rollOffFactor=this.minDistance=1},pc.Channel);e.prototype=pc.extend(e.prototype,{getPosition:function(){return this.position},setPosition:function(c){this.position.copy(c);if(this.source){var d=this.manager.getListener().getPosition();var c=this.minDistance,e=this.maxDistance,f=this.rollOffFactor;a=a.sub2(d,this.position);b=a.length();b<c?c=
1:b>e?c=0:(d=c+f*(b-c),c=0!==d?c/d:1);d=this.getVolume();this.source.volume=d*c}},getVelocity:function(){return this.velocity},setVelocity:function(a){this.velocity.copy(a)},getMaxDistance:function(){return this.maxDistance},setMaxDistance:function(a){this.maxDistance=a},getMinDistance:function(){return this.minDistance},setMinDistance:function(a){this.minDistance=a},getRollOffFactor:function(){return this.rolloffFactor},setRollOffFactor:function(a){this.rolloffFactor=a}})}else console.warn("No support for 3D audio found"),
e=function(){};return{Channel3d:e}}());(function(){var e={ACTION_MOUSE:"mouse",ACTION_KEYBOARD:"keyboard",ACTION_GAMEPAD:"gamepad",AXIS_MOUSE_X:"mousex",AXIS_MOUSE_Y:"mousey",AXIS_PAD_L_X:"padlx",AXIS_PAD_L_Y:"padly",AXIS_PAD_R_X:"padrx",AXIS_PAD_R_Y:"padry",AXIS_KEY:"key",EVENT_KEYDOWN:"keydown",EVENT_KEYUP:"keyup",EVENT_MOUSEDOWN:"mousedown",EVENT_MOUSEMOVE:"mousemove",EVENT_MOUSEUP:"mouseup",EVENT_MOUSEWHEEL:"mousewheel",EVENT_TOUCHSTART:"touchstart",EVENT_TOUCHEND:"touchend",EVENT_TOUCHMOVE:"touchmove",EVENT_TOUCHCANCEL:"touchcancel",
KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ENTER:14,KEY_SHIFT:16,KEY_CONTROL:17,KEY_ALT:18,KEY_PAUSE:19,KEY_CAPS_LOCK:20,KEY_ESCAPE:27,KEY_SPACE:32,KEY_PAGE_UP:33,KEY_PAGE_DOWN:34,KEY_END:35,KEY_HOME:36,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_PRINT_SCREEN:44,KEY_INSERT:45,KEY_DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_SEMICOLON:59,KEY_EQUAL:61,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,
KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,KEY_WINDOWS:91,KEY_CONTEXT_MENU:93,KEY_NUMPAD_0:96,KEY_NUMPAD_1:97,KEY_NUMPAD_2:98,KEY_NUMPAD_3:99,KEY_NUMPAD_4:100,KEY_NUMPAD_5:101,KEY_NUMPAD_6:102,KEY_NUMPAD_7:103,KEY_NUMPAD_8:104,KEY_NUMPAD_9:105,KEY_MULTIPLY:106,KEY_ADD:107,KEY_SEPARATOR:108,KEY_SUBTRACT:109,KEY_DECIMAL:110,KEY_DIVIDE:111,KEY_F1:112,KEY_F2:113,KEY_F3:114,KEY_F4:115,KEY_F5:116,KEY_F6:117,
KEY_F7:118,KEY_F8:119,KEY_F9:120,KEY_F10:121,KEY_F11:122,KEY_F12:123,KEY_COMMA:188,KEY_PERIOD:190,KEY_SLASH:191,KEY_OPEN_BRACKET:219,KEY_BACK_SLASH:220,KEY_CLOSE_BRACKET:221,KEY_META:224,MOUSEBUTTON_NONE:-1,MOUSEBUTTON_LEFT:0,MOUSEBUTTON_MIDDLE:1,MOUSEBUTTON_RIGHT:2,PAD_1:0,PAD_2:1,PAD_3:2,PAD_4:3,PAD_FACE_1:0,PAD_FACE_2:1,PAD_FACE_3:2,PAD_FACE_4:3,PAD_L_SHOULDER_1:4,PAD_R_SHOULDER_1:5,PAD_L_SHOULDER_2:6,PAD_R_SHOULDER_2:7,PAD_SELECT:8,PAD_START:9,PAD_L_STICK_BUTTON:10,PAD_R_STICK_BUTTON:11,PAD_UP:12,
PAD_DOWN:13,PAD_LEFT:14,PAD_RIGHT:15,PAD_VENDOR:16,PAD_L_STICK_X:0,PAD_L_STICK_Y:1,PAD_R_STICK_X:2,PAD_R_STICK_Y:3};pc.extend(pc,e);pc.input={};pc.extend(pc.input,e)})();pc.extend(pc,function(){var e=function(a,b){var c={x:0,y:0};if(b){if(b instanceof e)throw Error("Expected MouseEvent");c=a._getTargetCoords(b)}else b={};if(c)this.x=c.x,this.y=c.y;else if(pc.Mouse.isPointerLocked())this.y=this.x=0;else return;this.wheel=b.detail?-1*b.detail:b.wheelDelta?b.wheelDelta/120:0;pc.Mouse.isPointerLocked()?(this.dx=b.movementX||b.webkitMovementX||b.mozMovementX||0,this.dy=b.movementY||b.webkitMovementY||b.mozMovementY||0):(this.dx=this.x-a._lastX,this.dy=this.y-a._lastY);
this.button="mousedown"===b.type||"mouseup"===b.type?b.button:pc.MOUSEBUTTON_NONE;this.buttons=a._buttons.slice(0);this.element=b.target;this.ctrlKey=b.ctrlKey||!1;this.altKey=b.altKey||!1;this.shiftKey=b.shiftKey||!1;this.metaKey=b.metaKey||!1;this.event=b},a=function(a){this._lastY=this._lastX=0;this._buttons=[!1,!1,!1];this._lastbuttons=[!1,!1,!1];this._upHandler=this._handleUp.bind(this);this._downHandler=this._handleDown.bind(this);this._moveHandler=this._handleMove.bind(this);this._wheelHandler=
this._handleWheel.bind(this);this._contextMenuHandler=function(a){a.preventDefault()};this._target=null;this._attached=!1;this.attach(a);pc.events.attach(this)};a.isPointerLocked=function(){return!(!document.pointerLockElement&&!document.mozPointerLockElement&&!document.webkitPointerLockElement)};a.prototype={attach:function(a){this._target=a;this._attached||(this._attached=!0,window.addEventListener("mouseup",this._upHandler,!1),window.addEventListener("mousedown",this._downHandler,!1),window.addEventListener("mousemove",
this._moveHandler,!1),window.addEventListener("mousewheel",this._wheelHandler,!1),window.addEventListener("DOMMouseScroll",this._wheelHandler,!1))},detach:function(){this._attached&&(this._attached=!1,window.removeEventListener("mouseup",this._upHandler),window.removeEventListener("mousedown",this._downHandler),window.removeEventListener("mousemove",this._moveHandler),window.removeEventListener("mousewheel",this._wheelHandler),window.removeEventListener("DOMMouseScroll",this._wheelHandler))},disableContextMenu:function(){this._target&&
this._target.addEventListener("contextmenu",this._contextMenuHandler)},enableContextMenu:function(){this._target&&this._target.removeEventListener("contextmenu",this._contextMenuHandler)},enablePointerLock:function(a,b){var c=function(){a();document.removeEventListener("pointerlockchange",c)},e=function(){b();document.removeEventListener("pointerlockerror",e)};a&&document.addEventListener("pointerlockchange",c,!1);b&&document.addEventListener("pointerlockerror",e,!1);document.body.requestPointerLock()},
disablePointerLock:function(a){var b=function(){a();document.removeEventListener("pointerlockchange",b)};a&&document.addEventListener("pointerlockchange",b,!1);document.exitPointerLock()},update:function(){this._lastbuttons[0]=this._buttons[0];this._lastbuttons[1]=this._buttons[1];this._lastbuttons[2]=this._buttons[2]},isPressed:function(a){return this._buttons[a]},wasPressed:function(a){return this._buttons[a]&&!this._lastbuttons[a]},wasReleased:function(a){return!this._buttons[a]&&this._lastbuttons[a]},
_handleUp:function(a){this._buttons[a.button]=!1;a=new e(this,a);a.event&&this.fire(pc.EVENT_MOUSEUP,a)},_handleDown:function(a){this._buttons[a.button]=!0;a=new e(this,a);a.event&&this.fire(pc.EVENT_MOUSEDOWN,a)},_handleMove:function(a){a=new e(this,a);a.event&&(this.fire(pc.EVENT_MOUSEMOVE,a),this._lastX=a.x,this._lastY=a.y)},_handleWheel:function(a){a=new e(this,a);a.event&&this.fire(pc.EVENT_MOUSEWHEEL,a)},_getTargetCoords:function(a){var b=this._target.getBoundingClientRect(),c=Math.floor(b.left),
b=Math.floor(b.top);return a.clientX<c||a.clientX>=c+this._target.clientWidth||a.clientY<b||a.clientY>=b+this._target.clientHeight?null:{x:a.clientX-c,y:a.clientY-b}}};if(!("undefined"===typeof navigator||"undefined"===typeof document)){navigator.pointer=navigator.pointer||navigator.webkitPointer||navigator.mozPointer;var b=function(){var a=document.createEvent("CustomEvent");a.initCustomEvent("pointerlockchange",!0,!1,null);document.dispatchEvent(a)},c=function(){var a=document.createEvent("CustomEvent");
a.initCustomEvent("pointerlockerror",!0,!1,null);document.dispatchEvent(a)};document.addEventListener("webkitpointerlockchange",b,!1);document.addEventListener("webkitpointerlocklost",b,!1);document.addEventListener("mozpointerlockchange",b,!1);document.addEventListener("mozpointerlocklost",b,!1);document.addEventListener("webkitpointerlockerror",c,!1);document.addEventListener("mozpointerlockerror",c,!1);Element.prototype.requestPointerLock=Element.prototype.mozRequestPointerLock?function(){this.mozRequestPointerLock()}:
Element.prototype.requestPointerLock||Element.prototype.webkitRequestPointerLock||Element.prototype.mozRequestPointerLock;!Element.prototype.requestPointerLock&&navigator.pointer&&(Element.prototype.requestPointerLock=function(){document.pointerLockElement=this;navigator.pointer.lock(this,b,c)});document.exitPointerLock=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;document.exitPointerLock||(document.exitPointerLock=function(){navigator.pointer&&(document.pointerLockElement=
null,navigator.pointer.unlock())})}return{Mouse:a,MouseEvent:e}}());pc.extend(pc,function(){function e(a){return"string"==typeof a?a.toUpperCase().charCodeAt(0):a}var a=function(a,b){this.key=b.keyCode;this.element=b.target;this.event=b},b={9:"Tab",13:"Enter",16:"Shift",17:"Control",18:"Alt",27:"Escape",37:"Left",38:"Up",39:"Right",40:"Down",46:"Delete",91:"Win"},c=function(a,b){b=b||{};this._element=null;this._keyDownHandler=this._handleKeyDown.bind(this);this._keyUpHandler=this._handleKeyUp.bind(this);this._keyPressHandler=this._handleKeyPress.bind(this);pc.events.attach(this);
this._keymap={};this._lastmap={};a&&this.attach(a);this.preventDefault=b.preventDefault||!1;this.stopPropagation=b.stopPropagation||!1};c.prototype.attach=function(a){this._element&&this.detach();this._element=a;this._element.addEventListener("keydown",this._keyDownHandler,!1);this._element.addEventListener("keypress",this._keyPressHandler,!1);this._element.addEventListener("keyup",this._keyUpHandler,!1)};c.prototype.detach=function(){this._element.removeEventListener("keydown",this._keyDownHandler);
this._element.removeEventListener("keypress",this._keyPressHandler);this._element.removeEventListener("keyup",this._keyUpHandler);this._element=null};c.prototype.toKeyIdentifier=function(a){var a=e(a),c,f;if(c=b[a.toString()])return c;c=a.toString(16).toUpperCase();f=c.length;for(a=0;a<4-f;a++)c="0"+c;return"U+"+c};c.prototype._handleKeyDown=function(b){var c=b.keyCode||b.charCode,c=b.keyIdentifier||this.toKeyIdentifier(c);this._keymap[c]=!0;this.fire("keydown",new a(this,b));this.preventDefault&&
b.preventDefault();this.stopPropagation&&b.stopPropagation()};c.prototype._handleKeyUp=function(b){var c=b.keyCode||b.charCode,c=b.keyIdentifier||this.toKeyIdentifier(c);delete this._keymap[c];this.fire("keyup",new a(this,b));this.preventDefault&&b.preventDefault();this.stopPropagation&&b.stopPropagation()};c.prototype._handleKeyPress=function(b){var c=b.keyCode||b.charCode;b.keyIdentifier||this.toKeyIdentifier(c);this.fire("keypress",new a(this,b));this.preventDefault&&b.preventDefault();this.stopPropagation&&
b.stopPropagation()};c.prototype.update=function(){var a;this._lastmap={};for(a in this._keymap)this._keymap.hasOwnProperty(a)&&(this._lastmap[a]=this._keymap[a])};c.prototype.isPressed=function(a){a=e(a);a=this.toKeyIdentifier(a);return!!this._keymap[a]};c.prototype.wasPressed=function(a){a=e(a);a=this.toKeyIdentifier(a);return!!this._keymap[a]&&!this._lastmap[a]};c.prototype.wasReleased=function(a){a=e(a);a=this.toKeyIdentifier(a);return!this._keymap[a]&&!!this._lastmap[a]};return{Keyboard:c}}());pc.extend(pc,function(){var e=function(){this.gamepadsSupported=!!navigator.getGamepads||!!navigator.webkitGetGamepads;this.current=[];this.previous=[];this.deadZone=0.25},a={DEFAULT:{buttons:"PAD_FACE_1 PAD_FACE_2 PAD_FACE_3 PAD_FACE_4 PAD_L_SHOULDER_1 PAD_R_SHOULDER_1 PAD_L_SHOULDER_2 PAD_R_SHOULDER_2 PAD_SELECT PAD_START PAD_L_STICK_BUTTON PAD_R_STICK_BUTTON PAD_UP PAD_DOWN PAD_LEFT PAD_RIGHT PAD_VENDOR".split(" "),axes:["PAD_L_STICK_X","PAD_L_STICK_Y","PAD_R_STICK_X","PAD_R_STICK_Y"]},PS3:{buttons:"PAD_FACE_1 PAD_FACE_2 PAD_FACE_4 PAD_FACE_3 PAD_L_SHOULDER_1 PAD_R_SHOULDER_1 PAD_L_SHOULDER_2 PAD_R_SHOULDER_2 PAD_SELECT PAD_START PAD_L_STICK_BUTTON PAD_R_STICK_BUTTON PAD_UP PAD_DOWN PAD_LEFT PAD_RIGHT PAD_VENDOR".split(" "),
axes:["PAD_L_STICK_X","PAD_L_STICK_Y","PAD_R_STICK_X","PAD_R_STICK_Y"]}},b={"Product: 0268":"PS3"};e.prototype={update:function(){var a=this.poll(),b,e=a.length;for(b=0;b<e;b++)this.previous[b]=this.current[b],this.current[b]=a[b]},poll:function(){var a=[];if(this.gamepadsSupported){var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads(),e,f=b.length;for(e=0;e<f;e++)b[e]&&a.push({map:this.getMap(b[e]),pad:b[e]})}return a},getMap:function(c){for(var d in b)if(0<=c.id.indexOf(d))return a[b[d]];
return a.DEFAULT},isPressed:function(a,b){return!this.current[a]?!1:this.current[a].pad.buttons[pc[this.current[a].map.buttons[b]]].pressed},wasPressed:function(a,b){if(!this.current[a])return!1;var e=pc[this.current[a].map.buttons[b]];return this.current[a].pad.buttons[e].pressed&&!this.previous[a].pad.buttons[e].pressed},getAxis:function(a,b){if(!this.current[a])return!1;var e=this.current[a].pad.axes[pc[this.current[a].map.axes[b]]];Math.abs(e)<this.deadZone&&(e=0);return e}};return{GamePads:e}}());pc.extend(pc,function(){var e=function(b,d){this.element=d.target;this.event=d;this.touches=[];this.changedTouches=[];if(d){var e,f=d.touches.length;for(e=0;e<f;e++)this.touches.push(new a(d.touches[e]));f=d.changedTouches.length;for(e=0;e<f;e++)this.changedTouches.push(new a(d.changedTouches[e]))}};e.prototype={getTouchById:function(a,b){var e,f=b.length;for(e=0;e<f;e++)if(b[e].id===a)return b[e];return null}};var a=function(a){var b=pc.getTouchTargetCoords(a);this.id=a.identifier;this.x=b.x;this.y=
b.y;this.target=a.target;this.touch=a},b=function(a){this._startHandler=this._handleTouchStart.bind(this);this._endHandler=this._handleTouchEnd.bind(this);this._moveHandler=this._handleTouchMove.bind(this);this._cancelHandler=this._handleTouchCancel.bind(this);this.attach(a);pc.events.attach(this)};b.prototype={attach:function(a){this._element&&this.detach();this._element=a;this._element.addEventListener("touchstart",this._startHandler,!1);this._element.addEventListener("touchend",this._endHandler,
!1);this._element.addEventListener("touchmove",this._moveHandler,!1);this._element.addEventListener("touchcancel",this._cancelHandler,!1)},detach:function(){this._element&&(this._element.removeEventListener("touchstart",this._startHandler,!1),this._element.removeEventListener("touchend",this._endHandler,!1),this._element.removeEventListener("touchmove",this._moveHandler,!1),this._element.removeEventListener("touchcancel",this._cancelHandler,!1));this._element=null},_handleTouchStart:function(a){this.fire("touchstart",
new e(this,a))},_handleTouchEnd:function(a){this.fire("touchend",new e(this,a))},_handleTouchMove:function(a){a.preventDefault();this.fire("touchmove",new e(this,a))},_handleTouchCancel:function(a){this.fire("touchcancel",new e(this,a))}};return{getTouchTargetCoords:function(a){for(var b=0,e=0,f=a.target;!(f instanceof HTMLElement);)f=f.parentNode;do b+=f.offsetLeft-f.scrollLeft,e+=f.offsetTop-f.scrollTop,f=f.offsetParent;while(f);return{x:a.pageX-b,y:a.pageY-e}},TouchDevice:b}}());pc.extend(pc,function(){var e=function(a,b){b=b||{};this._keyboard=b.keyboard||null;this._mouse=b.mouse||null;this._gamepads=b.gamepads||null;this._element=null;this._actions={};this._axes={};this._axesValues={};a&&this.attach(a)};e.prototype.attach=function(a){this._element=a;this._keyboard&&this._keyboard.attach(a);this._mouse&&this._mouse.attach(a)};e.prototype.detach=function(){this._keyboard&&this._keyboard.detach();this._mouse&&this._mouse.detach();this._element=null};e.prototype.disableContextMenu=
function(){this._mouse||this._enableMouse();this._mouse.disableContextMenu()};e.prototype.enableContextMenu=function(){this._mouse||this._enableMouse();this._mouse.enableContextMenu()};e.prototype.update=function(a){this._keyboard&&this._keyboard.update(a);this._mouse&&this._mouse.update(a);this._gamepads&&this._gamepads.update(a);this._axesValues={};for(var b in this._axes)this._axesValues[b]=[]};e.prototype.registerKeys=function(a,b){this._keyboard||this._enableKeyboard();if(this._actions[a])throw Error(pc.string.format("Action: {0} already registered",
a));if(void 0===b)throw Error("Invalid button");b.length||(b=[b]);this._actions[a]?this._actions[a].push({type:pc.ACTION_KEYBOARD,keys:b}):this._actions[a]=[{type:pc.ACTION_KEYBOARD,keys:b}]};e.prototype.registerMouse=function(a,b){this._mouse||this._enableMouse();if(void 0===b)throw Error("Invalid button");this._actions[a]?this._actions[a].push({type:pc.ACTION_MOUSE,button:b}):this._actions[a]=[{type:pc.ACTION_MOUSE,button:-b}]};e.prototype.registerPadButton=function(a,b,c){if(void 0===c)throw Error("Invalid button");
this._actions[a]?this._actions[a].push({type:pc.ACTION_GAMEPAD,button:c,pad:b}):this._actions[a]=[{type:pc.ACTION_GAMEPAD,button:c,pad:b}]};e.prototype.registerAxis=function(a){var b=a.name;this._axes[b]||(this._axes[b]=[]);var c=this._axes[b].push(b),a=a||{};a.pad=a.pad||pc.PAD_1;var d=function(d,e,k,m){switch(e){case "mousex":d._mouse.on(pc.EVENT_MOUSEMOVE,function(a){d._axesValues[b][c]=a.dx/10});break;case "mousey":d._mouse.on(pc.EVENT_MOUSEMOVE,function(a){d._axesValues[b][c]=a.dy/10});break;
case "key":d._axes[b].push(function(){return d._keyboard.isPressed(m)?k:0});break;case "padrx":d._axes[b].push(function(){return d._gamepads.getAxis(a.pad,pc.PAD_R_STICK_X)});break;case "padry":d._axes[b].push(function(){return d._gamepads.getAxis(a.pad,pc.PAD_R_STICK_Y)});break;case "padlx":d._axes[b].push(function(){return d._gamepads.getAxis(a.pad,pc.PAD_L_STICK_X)});break;case "padly":d._axes[b].push(function(){return d._gamepads.getAxis(a.pad,pc.PAD_L_STICK_Y)});break;default:throw Error("Unknown axis");
}};d(this,a.positive,1,a.positiveKey);(a.negativeKey||a.negative!==a.positive)&&d(this,a.negative,-1,a.negativeKey)};e.prototype.isPressed=function(a){if(!this._actions[a])return!1;for(var b,c=0,d=this._actions[a].length,c=0;c<d;++c)switch(b=this._actions[a][c],b.type){case pc.ACTION_KEYBOARD:if(this._keyboard){var e,f=b.keys.length;for(e=0;e<f;e++)if(this._keyboard.isPressed(b.keys[e]))return!0}break;case pc.ACTION_MOUSE:if(this._mouse&&this._mouse.isPressed(b.button))return!0;break;case pc.ACTION_GAMEPAD:if(this._gamepads&&
this._gamepads.isPressed(b.pad,b.button))return!0}return!1};e.prototype.wasPressed=function(a){if(!this._actions[a])return!1;for(var b=0,c=this._actions[a].length,b=0;b<c;++b){var d=this._actions[a][b];switch(d.type){case pc.ACTION_KEYBOARD:if(this._keyboard){var e,f=d.keys.length;for(e=0;e<f;e++)if(this._keyboard.wasPressed(d.keys[e]))return!0}break;case pc.ACTION_MOUSE:if(this._mouse&&this._mouse.wasPressed(d.button))return!0;break;case pc.ACTION_GAMEPAD:if(this._gamepads&&this._gamepads.wasPressed(d.pad,
d.button))return!0}}return!1};e.prototype.getAxis=function(a){var b=0;if(this._axes[a]){var c,d=this._axes[a].length;for(c=0;c<d;c++)if("function"===pc.type(this._axes[a][c])){var e=this._axes[a][c]();Math.abs(e)>Math.abs(b)&&(b=e)}else this._axesValues[a]&&Math.abs(this._axesValues[a][c])>Math.abs(b)&&(b=this._axesValues[a][c])}return b};e.prototype._enableMouse=function(){this._mouse=new pc.Mouse;if(!this._element)throw Error("Controller must be attached to a DOMElement");this._mouse.attach(this._element)};
e.prototype._enableKeyboard=function(){this._keyboard=new pc.Keyboard;if(!this._element)throw Error("Controller must be attached to a DOMElement");this._keyboard.attach(this._element)};return{Controller:e}}());pc.net=function(){return{}}();pc.extend(pc.net,function(){var e=function(){};e.ContentType={FORM_URLENCODED:"application/x-www-form-urlencoded",GIF:"image/gif",JPEG:"image/jpeg",DDS:"image/dds",JSON:"application/json",PNG:"image/png",TEXT:"text/plain",XML:"application/xml",WAV:"audio/x-wav",OGG:"audio/ogg",MP3:"audio/mpeg",BIN:"application/octet-stream"};e.ResponseType={TEXT:"text",ARRAY_BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document"};e.binaryExtensions=[".model",".wav",".ogg",".mp3",".dds"];e.prototype={ContentType:e.ContentType,
ResponseType:e.ResponseType,binaryExtensions:e.binaryExtensions,get:function(a,b,c,d){c=c||{};c.success=b;return this.request("GET",a,c,d)},post:function(a,b,c,d,e){d=d||{};d.success=b;d.postdata=c;return this.request("POST",a,d,e)},put:function(a,b,c,d,e){d=d||{};d.success=b;d.postdata=c;return this.request("PUT",a,d,e)},del:function(a,b,c,d){c=c||{};c.success=b;return this.request("DELETE",a,c,d)},request:function(a,b,c,d){var g,f,k,m=!1,c=c||{};null==c.success&&(c.success=function(){});null==c.error&&
(c.error=function(){});null==c.async&&(c.async=!0);null==c.headers&&(c.headers={});if(null!=c.postdata)if(c.postdata instanceof Document)k=c.postdata;else if(c.postdata instanceof FormData)k=c.postdata;else if(c.postdata instanceof Object)switch(k=c.headers["Content-Type"],pc.isDefined(k)||(c.headers["Content-Type"]=e.ContentType.FORM_URLENCODED,k=c.headers["Content-Type"]),k){case e.ContentType.FORM_URLENCODED:k="";f=!0;for(g in c.postdata)c.postdata.hasOwnProperty(g)&&(f?f=!1:k+="&",k+=escape(g)+
"="+escape(c.postdata[g]));break;default:null==k&&(c.headers["Content-Type"]=e.ContentType.JSON),k=JSON.stringify(c.postdata)}else k=c.postdata;d||(d=new XMLHttpRequest);!1===c.cache&&(f=pc.time.now(),g=new pc.URI(b),g.query=g.query?g.query+"&ts="+f:"ts="+f,b=g.toString());c.query&&(g=new pc.URI(b),f=pc.extend(g.getQuery(),c.query),g.setQuery(f),b=g.toString());d.open(a,b,c.async);d.withCredentials=!0;d.responseType=c.responseType||this.guessResponseType(b);for(var h in c.headers)c.headers.hasOwnProperty(h)&&
d.setRequestHeader(h,c.headers[h]);d.onreadystatechange=function(){this.onReadyStateChange(a,b,c,d)}.bind(this);d.onerror=function(){this.onError(a,b,c,d);m=!0}.bind(this);try{d.send(k)}catch(n){m||c.error(d.status,d,n)}return d},guessResponseType:function(a){a=new pc.URI(a);a=pc.path.getExtension(a.path);return 0<=e.binaryExtensions.indexOf(a)?e.ResponseType.ARRAY_BUFFER:e.ResponseType.TEXT},isBinaryContentType:function(a){return 0<=[e.ContentType.WAV,e.ContentType.OGG,e.ContentType.MP3,e.ContentType.BIN,
e.ContentType.DDS].indexOf(a)?!0:!1},onReadyStateChange:function(a,b,c,d){if(4===d.readyState)switch(d.status){case 0:if("/"!=b[0])this.onSuccess(a,b,c,d);break;case 200:case 201:case 206:case 304:this.onSuccess(a,b,c,d);break;default:this.onError(a,b,c,d)}},onSuccess:function(a,b,c,d){var g;if(a=d.getResponseHeader("Content-Type"))a=a.split(";"),g=a[0].trim(),a[1]&&a[1].trim();g===this.ContentType.JSON||pc.string.endsWith(b,".json")?b=JSON.parse(d.responseText):this.isBinaryContentType(g)?b=d.response:
d.responseType===e.ResponseType.ARRAY_BUFFER?(logWARNING(pc.string.format("responseType: {0} being served with Content-Type: {1}",e.ResponseType.ARRAY_BUFFER,g)),b=d.response):b=d.responseType===e.ResponseType.DOCUMENT||g===this.ContentType.XML?d.responseXML:d.responseText;c.success(b,d.status,d)},onError:function(a,b,c,d){c.error(d.status,d,null)}};e.prototype.delete_=e.prototype.del;return{Http:e,http:new e}}());pc.extend(pc.net,function(){var e=0,a=function(a,c,d,e,f){this.clientId=e;this.endpoint=a;this.redirectUrl=c;this.origin=d;this.scope=f;this.responseType="token";this.accessToken=null;this.OAUTH_IFRAME_ID_BASE="pc-oauth-access-token-"},a=pc.inherits(a,pc.net.Http);a.prototype.refreshAccessToken=function(a){var c=this.OAUTH_IFRAME_ID_BASE+e++,d=function(e){if(e.origin===this.origin){if(e.data.access_token){var f=document.getElementById(c);f&&f.parentNode.removeChild(f);this.accessToken=e.data.access_token;
a(e.data.access_token)}else e.data.error?logERROR(e.data.error):logWARNING("Invalid message posted to Corazon API");window.removeEventListener("message",d)}}.bind(this);window.addEventListener("message",d,!1);var g={client_id:this.clientId,redirect_url:this.redirectUrl,scope:this.scope,response_type:this.responseType},f=new pc.URI(this.endpoint);f.setQuery(g);if(g=document.getElementById(c))throw Error("accessToken request already in progress");g=document.createElement("iframe");g.src=f.toString();
g.id=c;g.style.display="none";document.body.appendChild(g)};a.prototype.request=function(a,c,d,e){d.query=d.query||{};d.query=pc.extend(d.query,{access_token:this.accessToken});return pc.net.OAuth._super.request.call(this,a,c,d,e)};a.prototype.onError=function(a,c,d,e){401==e.status?this.refreshAccessToken(function(f){d.query.access_token=f;this.request(a,c,d,e)}.bind(this)):d.error(e.status,e,null)};return{OAuth:a,oauth:new a}}());pc.extend(pc.net,function(){var e=function(a){this._ws=new WebSocket(a);this._ws.onopen=this._handleOpen.bind(this);this._ws.onerror=this._handleError.bind(this);this._ws.onmessage=this._handleMessage.bind(this);this._ws.onclose=this._handleClose.bind(this)};e.prototype={onopen:null,onerror:null,onmessage:null,get binaryType(){return this._ws.binaryType},set binaryType(a){this._ws.binaryType=a},get readyState(){return this._ws.readyState},get bufferedAmount(){return this._ws.bufferedAmount},get extensions(){return this._ws.extensions},
get protocol(){return this._ws.protocol},_handleOpen:function(){if(this.onopen)this.onopen()},_handleError:function(a){if(this.onerror)this.onerror(a)},_handleMessage:function(a){if(this.onmessage)this.onmessage(a)},_handleClose:function(){if(this.onclose)this.onclose()},send:function(a){this._ws.send(a)}};return{Socket:e}}());pc.script=function(){var e=null,a=null,b={main:function(a){if(e)throw Error("'main' Object already registered");e=a},setLoader:function(b){if(b&&a)throw Error("pc.script already has loader object.");a=b},create:function(a,b){void 0===b&&(b=attributes);this.fire("created",a,b)},attribute:function(){},start:function(){e()}};pc.events.attach(b);return b}();var designer=designer||{};pc.extend(designer,function(){var e=function(){this.exposed={};this.added={};this.scripts={};this.systems=[]};e.prototype={addComponentType:function(){},expose:function(){},add:function(){},scriptexpose:function(){}};return{LinkInterface:e,link:new e}}());pc.extend(designer,function(){var e=function(){this.exposed={};this.added={};this.scripts={};this.systems=[]};e.prototype.addComponentType=function(a){var b=a.id,c,d=this.systems,e=d.length,f=!1;for(c=0;c<e;c++)if(d[c].name===b){f=!0;break}f||this.systems.push({name:b,description:a.description});this.exposed[b]||(this.exposed[b]={})};e.prototype.expose=function(a,b){if(!b.name)throw Error("Missing option 'name'");b.options=b.options||{};if("vector"===b.type)if(b.array=!0,b.defaultValue)switch(b.defaultValue.length){case 2:b.RuntimeType=
pc.Vec2;break;case 3:b.RuntimeType=pc.Vec3;break;case 4:b.RuntimeType=pc.Vec4}else b.RuntimeType=pc.Vec3;else"rgb"===b.type||"rgba"===b.type?(b.array=!0,b.RuntimeType=pc.Color):"curve"===b.type?(b.object=!0,b.RuntimeType=pc.Curve):"curveset"===b.type&&(b.object=!0,b.RuntimeType=pc.CurveSet);this.exposed[a][b.name]||(this.exposed[a][b.name]={});this.exposed[a][b.name]=b};e.prototype.add=function(a){logASSERT(a.system,"Missing option: 'system'");logASSERT(a.variable,"Missing option: 'variable'");this.added[a.system]||
(this.added[a.system]={});this.added[a.system][a.variable]||(this.added[a.system][a.variable]={});this.added[a.system][a.variable]=a};e.prototype.scriptexpose=function(a){this.scripts[a.script]=a};return{LinkInterface:e,link:new e}}());pc.extend(pc,function(){return{ContentFile:function(e){this.packs=e.packs||{};this.appProperties=e.application_properties||{};this.toc=e.toc||{}}}}());pc.extend(pc,function(){return{Pack:function(e){this.hierarchy=e.hierarchy;this.settings=e.settings}}}());pc.extend(pc,function(){var e=function(a,b){b=b||{};pc.log.open();pc.events.attach(this);this._time=0;this.timeScale=1;this._librariesLoaded=!1;this._fillMode=pc.FILLMODE_KEEP_ASPECT;this._resolutionMode=pc.RESOLUTION_FIXED;this.context=this;this.graphicsDevice=new pc.GraphicsDevice(a);this.systems=new pc.ComponentSystemRegistry;this._audioManager=new pc.AudioManager;this.loader=new pc.resources.ResourceLoader;this.scene=new pc.Scene;this.root=new pc.fw.Entity(this);this.assets=new pc.asset.AssetRegistry(this.loader);
this.renderer=new pc.ForwardRenderer(this.graphicsDevice);this.keyboard=b.keyboard||null;this.mouse=b.mouse||null;this.touch=b.touch||null;this.gamepads=b.gamepads||null;this.content=null;this._inTools=!1;this._link=new pc.LiveLink("application");this._link.addDestinationWindow(window);this._link.listen(this._handleMessage.bind(this));!1===b.cache&&(this.loader.cache=!1);b.displayLoader&&new pc.resources.ResourceLoaderDisplay(document.body,this.loader);b.content&&(this.content=b.content,Object.keys(this.content.toc).forEach(function(a){this.assets.addGroup(a,
this.content.toc[a])}.bind(this)));new pc.resources.TextureCache(this.loader);this.loader.registerHandler(pc.resources.JsonRequest,new pc.resources.JsonResourceHandler);this.loader.registerHandler(pc.resources.TextRequest,new pc.resources.TextResourceHandler);this.loader.registerHandler(pc.resources.ImageRequest,new pc.resources.ImageResourceHandler);this.loader.registerHandler(pc.resources.MaterialRequest,new pc.resources.MaterialResourceHandler(this.graphicsDevice,this.assets));this.loader.registerHandler(pc.resources.TextureRequest,
new pc.resources.TextureResourceHandler(this.graphicsDevice,this.assets));this.loader.registerHandler(pc.resources.CubemapRequest,new pc.resources.CubemapResourceHandler(this.graphicsDevice,this.assets));this.loader.registerHandler(pc.resources.ModelRequest,new pc.resources.ModelResourceHandler(this.graphicsDevice,this.assets));this.loader.registerHandler(pc.resources.AnimationRequest,new pc.resources.AnimationResourceHandler);this.loader.registerHandler(pc.resources.PackRequest,new pc.resources.PackResourceHandler(this,
b.depot));this.loader.registerHandler(pc.resources.AudioRequest,new pc.resources.AudioResourceHandler(this._audioManager));this.loader.registerHandler(pc.resources.ScriptRequest,new pc.resources.ScriptResourceHandler(this,b.scriptPrefix));new pc.RigidBodyComponentSystem(this);new pc.CollisionComponentSystem(this);new pc.BallSocketJointComponentSystem(this);new pc.AnimationComponentSystem(this);new pc.ModelComponentSystem(this);new pc.CameraComponentSystem(this);new pc.LightComponentSystem(this);new pc.PackComponentSystem(this);
new pc.SkyboxComponentSystem(this);new pc.ScriptComponentSystem(this);new pc.PickComponentSystem(this);new pc.AudioSourceComponentSystem(this,this._audioManager);new pc.AudioListenerComponentSystem(this,this._audioManager);new pc.ParticleSystemComponentSystem(this);new pc.DesignerComponentSystem(this);this.on("librariesloaded",this.onLibrariesLoaded,this);if(b.libraries&&b.libraries.length){var c=b.libraries.map(function(a){return new pc.resources.ScriptRequest(a)});this.loader.request(c).then(function(){this.fire("librariesloaded",
this);this._librariesLoaded=!0}.bind(this))}else this.fire("librariesloaded",this),this._librariesLoaded=!0;void 0!==document.hidden?(this._hiddenAttr="hidden",document.addEventListener("visibilitychange",this.onVisibilityChange.bind(this),!1)):void 0!==document.mozHidden?(this._hiddenAttr="mozHidden",document.addEventListener("mozvisibilitychange",this.onVisibilityChange.bind(this),!1)):void 0!==document.msHidden?(this._hiddenAttr="msHidden",document.addEventListener("msvisibilitychange",this.onVisibilityChange.bind(this),
!1)):void 0!==document.webkitHidden&&(this._hiddenAttr="webkitHidden",document.addEventListener("webkitvisibilitychange",this.onVisibilityChange.bind(this),!1));e._applications[this.graphicsDevice.canvas.id]=this;e._currentApplication=this};e._currentApplication=null;e._applications={};e.getApplication=function(a){return a?e._applications[a]:e._currentApplication};e.prototype={loadFromToc:function(a,b,c,d){this.content||c("No content");var a=this.content.toc[a],b=b||function(){},c=c||function(){},
d=d||function(){},e=a.packs[0],f=function(){this.loader.request(new pc.resources.PackRequest(e)).then(function(a){a=a[0];this.root.addChild(a.hierarchy);pc.ComponentSystem.initialize(a.hierarchy);pc.ComponentSystem.postInitialize(a.hierarchy);if(this.systems.rigidbody&&"undefined"!==typeof Ammo){var c=a.settings.physics.gravity;this.systems.rigidbody.setGravity(c[0],c[1],c[2])}c=a.settings.render.global_ambient;this.scene.ambientLight=new pc.Color(c[0],c[1],c[2]);this.scene.fog=a.settings.render.fog;
c=a.settings.render.fog_color;this.scene.fogColor=new pc.Color(c[0],c[1],c[2]);this.scene.fogStart=a.settings.render.fog_start;this.scene.fogEnd=a.settings.render.fog_end;this.scene.fogDensity=a.settings.render.fog_density;this.scene.gammaCorrection=a.settings.render.gamma_correction;this.scene.toneMapping=a.settings.render.tonemapping;this.scene.exposure=a.settings.render.exposure;a.settings.render.skybox&&((c=this.assets.getAssetById(a.settings.render.skybox))?(this._setSkybox(c.resources),c.on("change",
this._onSkyBoxChanged,this),c.on("remove",this._onSkyBoxRemoved,this)):this.scene.skybox=null);b(a);this.loader.off("progress",d)}.bind(this),function(a){c(a)}).then(null,function(a){setTimeout(function(){throw a;},0)})}.bind(this),k=function(){var a=this.assets.list(e);this.loader.on("progress",d);a.length?this.assets.load(a).then(function(a){f(a)}):setTimeout(function(){f([])},0)}.bind(this);if(this._librariesLoaded)k();else this.on("librariesloaded",function(){k()})},start:function(){if(this._librariesLoaded)this.tick();
else this.on("librariesloaded",function(){this.tick()},this)},update:function(a){pc.ComponentSystem.fixedUpdate(1/60,this._inTools);pc.ComponentSystem.update(a,this._inTools);pc.ComponentSystem.postUpdate(a,this._inTools);this.fire("update",a);this.controller&&this.controller.update(a);this.mouse&&this.mouse.update(a);this.keyboard&&this.keyboard.update(a);this.gamepads&&this.gamepads.update(a)},render:function(){var a=this.systems.camera.cameras,b=null,c=this.renderer;this.root.syncHierarchy();for(var d=
0,e=a.length;d<e;d++)b=a[d],b.frameBegin(),c.render(this.scene,b.camera),b.frameEnd()},tick:function(){e._currentApplication=this;window.requestAnimationFrame(this.tick.bind(this));var a=window.performance&&window.performance.now?performance.now():Date.now(),b=(a-(this._time||a))/1E3;this._time=a;b=pc.math.clamp(b,0,0.1);b*=this.timeScale;this.update(b);this.render()},setCanvasFillMode:function(a,b,c){this._fillMode=a;this.resizeCanvas(b,c)},setCanvasResolution:function(a,b,c){this._resolutionMode=
a;a===pc.RESOLUTION_AUTO&&void 0===b&&(b=this.graphicsDevice.canvas.clientWidth,c=this.graphicsDevice.canvas.clientHeight);this.graphicsDevice.resizeCanvas(b,c)},isFullscreen:function(){return!!document.fullscreenElement},enableFullscreen:function(a,b,c){var a=a||this.graphicsDevice.canvas,d=function(){b();document.removeEventListener("fullscreenchange",d)},e=function(){c();document.removeEventListener("fullscreenerror",e)};b&&document.addEventListener("fullscreenchange",d,!1);c&&document.addEventListener("fullscreenerror",
e,!1);a.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},disableFullscreen:function(a){var b=function(){a();document.removeEventListener("fullscreenchange",b)};a&&document.addEventListener("fullscreenchange",b,!1);document.exitFullscreen()},isHidden:function(){return document[this._hiddenAttr]},onVisibilityChange:function(){this.isHidden()?this._audioManager.suspend():this._audioManager.resume()},resizeCanvas:function(a,b){var c=window.innerWidth,d=window.innerHeight;if(navigator.isCocoonJS)a=c,b=
d,c=window.devicePixelRatio,this.graphicsDevice.resizeCanvas(a*c,b*c);else{if(this._fillMode===pc.FILLMODE_KEEP_ASPECT){var e=this.graphicsDevice.canvas.width/this.graphicsDevice.canvas.height;e>c/d?(a=c,b=a/e):(b=d,a=b*e)}else this._fillMode===pc.FILLMODE_FILL_WINDOW&&(a=c,b=d);this.graphicsDevice.canvas.style.width=a+"px";this.graphicsDevice.canvas.style.height=b+"px";this._resolutionMode===pc.RESOLUTION_AUTO&&this.setCanvasResolution(pc.RESOLUTION_AUTO)}return{width:a,height:b}},onLibrariesLoaded:function(){this.systems.rigidbody.onLibraryLoaded();
this.systems.collision.onLibraryLoaded()},_handleMessage:function(a){var b;switch(a.type){case pc.LiveLinkMessageType.UPDATE_COMPONENT:this._linkUpdateComponent(a.content.id,a.content.component,a.content.attribute,a.content.value);break;case pc.LiveLinkMessageType.UPDATE_ENTITY:this._linkUpdateEntity(a.content.id,a.content.components);break;case pc.LiveLinkMessageType.UPDATE_ENTITY_TRANSFORM:this._linkUpdateEntityTransform(a.content.id,a.content.position,a.content.rotation,a.content.scale);break;
case pc.LiveLinkMessageType.UPDATE_ENTITY_NAME:b=this.root.findOne("getGuid",a.content.id);b.setName(a.content.name);break;case pc.LiveLinkMessageType.UPDATE_ENTITY_ENABLED:b=this.root.findOne("getGuid",a.content.id);b.enabled=a.content.enabled;break;case pc.LiveLinkMessageType.REPARENT_ENTITY:this._linkReparentEntity(a.content.id,a.content.newParentId,a.content.index);break;case pc.LiveLinkMessageType.CLOSE_ENTITY:if(b=this.root.findOne("getGuid",a.content.id))logDEBUG(pc.string.format("RT: Removed '{0}' from parent {1}",
a.content.id,b.getParent().getGuid())),b.destroy();break;case pc.LiveLinkMessageType.OPEN_PACK:a=this.loader.open(pc.resources.PackRequest,a.content.pack);b=a.hierarchy;b.__parent?(a=this.root.findByGuid(b.__parent),a.addChild(b)):this.root.addChild(b);break;case pc.LiveLinkMessageType.OPEN_ENTITY:a.content.entity&&(a={application_data:{},hierarchy:a.content.entity},a=this.loader.open(pc.resources.PackRequest,a),b=a.hierarchy,b.__parent?(a=this.root.findByGuid(b.__parent),a.addChild(b)):this.root.addChild(b));
break;case pc.LiveLinkMessageType.UPDATE_ASSET:this._linkUpdateAsset(a.content.id,a.content.attribute,a.content.value);break;case pc.LiveLinkMessageType.UPDATE_ASSETCACHE:var c;for(b in a.content.assets)if(c=this.assets.getAssetById(b)){var d=a.content.assets[b],e;for(e in d)d.hasOwnProperty(e)&&(c[e]=d[e])}else this.assets.createAndAddAsset(b,a.content.assets[b]);for(b in a.content.deleted)(c=this.assets.getAssetById(b))&&this.assets.removeAsset(c);break;case pc.LiveLinkMessageType.UPDATE_PACK_SETTINGS:this._linkUpdatePackSettings(a.content.settings)}},
_linkUpdateComponent:function(a,b,c,d){var a=this.root.findOne("getGuid",a),e;a&&(b?a[b]?(e=designer.link.exposed[b][c],designer&&e?e.RuntimeType?e.RuntimeType===pc.Vec3?a[b][c]=new e.RuntimeType(d[0],d[1],d[2]):e.RuntimeType===pc.Vec4?a[b][c]=new e.RuntimeType(d[0],d[1],d[2],d[3]):e.RuntimeType===pc.Vec2?a[b][c]=new e.RuntimeType(d[0],d[1]):e.RuntimeType===pc.Color?a[b][c]=3===d.length?new e.RuntimeType(d[0],d[1],d[2]):new e.RuntimeType(d[0],d[1],d[2],d[3]):e.RuntimeType===pc.Curve||e.RuntimeType===
pc.CurveSet?(a[b][c]=new e.RuntimeType(d.keys),a[b][c].type=d.type):a[b][c]=new e.RuntimeType(d):a[b][c]=d:a[b][c]=d):logWARNING(pc.string.format("No component system called '{0}' exists",b)):a[c]=d)},_linkUpdateEntityTransform:function(a,b,c,d){if(a=this.root.findByGuid(a))a.setLocalPosition(b[0],b[1],b[2]),a.setLocalEulerAngles(c[0],c[1],c[2]),a.setLocalScale(d[0],d[1],d[2]),a.fire("livelink:updatetransform",b,c,d)},_linkReparentEntity:function(a,b,c){a=this.root.findByGuid(a);b=this.root.findByGuid(b);
a.reparent(b,c)},_linkUpdateEntity:function(a,b){var c,d=this.root.findOne("getGuid",a);if(d){var e=this.systems.getComponentSystemOrder(),f,k=e.length;for(f=0;f<k;f++)c=e[f],b.hasOwnProperty(c)&&this.systems.hasOwnProperty(c)&&(d[c]||this.systems[c].addComponent(d,{}));for(c in this.systems)"gizmo"===c||"pick"===c||this.systems.hasOwnProperty(c)&&!b.hasOwnProperty(c)&&d[c]&&this.systems[c].removeComponent(d)}},_linkUpdateAsset:function(a,b,c){(a=this.assets.getAssetById(a))&&(a[b]=c)},_linkUpdatePackSettings:function(a){var b=
this,c=a.render.global_ambient;b.scene.ambientLight.set(c[0],c[1],c[2]);b.systems.rigidbody&&"undefined"!==typeof Ammo&&(c=a.physics.gravity,b.systems.rigidbody.setGravity(c[0],c[1],c[2]));b.scene.fog=a.render.fog;b.scene.fogStart=a.render.fog_start;b.scene.fogEnd=a.render.fog_end;c=a.render.fog_color;b.scene.fogColor=new pc.Color(c[0],c[1],c[2]);b.scene.fogDensity=a.render.fog_density;b.scene.gammaCorrection=a.render.gamma_correction;b.scene.toneMapping=a.render.tonemapping;b.scene.exposure=a.render.exposure;
if(a.render.skybox){var d=b.assets.getAssetById(a.render.skybox);d?d.resource?(b._setSkybox(d.resources),d.off("change",b._onSkyBoxChanged,b),d.on("change",b._onSkyBoxChanged,b),d.off("remove",b._onSkyBoxRemoved,b),d.on("remove",b._onSkyBoxRemoved,b)):b.assets.load([d]).then(function(a){b._setSkybox(a[0]);d.off("change",b._onSkyBoxChanged,b);d.on("change",b._onSkyBoxChanged,b);d.off("remove",b._onSkyBoxRemoved,b);d.on("remove",b._onSkyBoxRemoved,b)},function(){pc.log.error("Could not initialize scene skybox. Missing cubemap asset "+
a.render.skybox)}):pc.log.error("Could not initialize scene skybox. Missing cubemap asset "+a.render.skybox)}else{b.scene.skybox=null;for(var c=128,e=0;6>e;e++)b.scene["skyboxPrefiltered"+c]=null,c*=0.5}},_setSkybox:function(a){var b=this.scene;b.skybox=a[0];b.skyboxPrefiltered128=a[1];b.skyboxPrefiltered64=a[2];b.skyboxPrefiltered32=a[3];b.skyboxPrefiltered16=a[4];b.skyboxPrefiltered8=a[5];b.skyboxPrefiltered4=a[6]},_onSkyBoxChanged:function(a,b,c,d){"resources"===b&&(this.scene.skybox===d[0]?this._setSkybox(c):
skybox.off("change",this._onSkyBoxChanged,this))},_onSkyBoxRemoved:function(a){a.off("change",this._onSkyBoxRemoved,this);this.scene.skybox===a.resources[0]&&(this.scene.skybox=null);for(var b=128,c=0;6>c;c++){var d="skyboxPrefiltered"+b;this.scene[d]===a.resources[c+1]&&(this.scene[d]=null);b*=0.5}}};return{FILLMODE_NONE:"NONE",FILLMODE_FILL_WINDOW:"FILL_WINDOW",FILLMODE_KEEP_ASPECT:"KEEP_ASPECT",RESOLUTION_AUTO:"AUTO",RESOLUTION_FIXED:"FIXED",Application:e}}());pc.extend(pc,function(){var e=function(){};e.prototype={add:function(a,b){if(this[a])throw Error(pc.string.format("ComponentSystem name '{0}' already registered or not allowed",a));this[a]=b;b.name=a},remove:function(a){if(!this[a])throw Error(pc.string.format("No ComponentSystem named '{0}' registered",a));delete this[a]},list:function(){var a=Object.keys(this),b={collisionrect:0.5,collisioncircle:0.5};a.sort(function(a,d){var e=b[a]||1,f=b[d]||1;return e<f?-1:e>f?1:0});return a.map(function(a){return this[a]},
this)},getComponentSystemOrder:function(){var a,b=Object.keys(this);a=b.indexOf("collisionrect");b.splice(a,1);b.unshift("collisionrect");a=b.indexOf("collisioncircle");b.splice(a,1);b.unshift("collisioncircle");return b}};return{ComponentSystemRegistry:e}}());pc.extend(pc,function(){var e=function(a){this.app=a;this.dataStore={};this.schema=[];pc.events.attach(this)};pc.extend(e,{initialize:function(a){e.fire("initialize",a)},postInitialize:function(a){e.fire("postInitialize",a)},update:function(a,b){b?e.fire("toolsUpdate",a):e.fire("update",a)},fixedUpdate:function(a){e.fire("fixedUpdate",a)},postUpdate:function(a){e.fire("postUpdate",a)}});e.prototype={get store(){return this.dataStore},addComponent:function(a,b){var c=new this.ComponentType(this,a),
d=new this.DataType,b=b||{};this.dataStore[a.getGuid()]={entity:a,data:d};a[this.id]=c;a.c[this.id]=c;this.initializeComponentData(c,b,[]);this.fire("add",a,c);return c},removeComponent:function(a){var b=this.dataStore[a.getGuid()];this.fire("beforeremove",a,a.c[this.id]);delete this.dataStore[a.getGuid()];delete a[this.id];delete a.c[this.id];this.fire("remove",a,b.data)},cloneComponent:function(a,b){var c=this.dataStore[a.getGuid()];return this.addComponent(b,c.data)},initializeComponentData:function(a,
b,c){b=b||{};c.forEach(function(c){a[c]=void 0!==b[c]?b[c]:a.data[c]},this);if(a.enabled&&a.entity.enabled)a.onEnable()},exposeProperties:function(){designer.link.addComponentType(this);this.schema.forEach(function(a){!1!==a.exposed&&designer.link.expose(this.id,a)}.bind(this))}};pc.events.attach(e);return{ComponentSystem:e}}());pc.extend(pc,function(){var e=function(a,b){this.system=a;this.entity=b;pc.events.attach(this);this.buildAccessors(this.system.schema);this.on("set",function(a,b,e){this.fire("set_"+a,a,b,e)});this.on("set_enabled",this.onSetEnabled,this)};e.prototype={get data(){var a=this.system.store[this.entity.getGuid()];return a?a.data:null},buildAccessors:function(a){a.forEach(function(a){a.readOnly?Object.defineProperty(this,a.name,{get:function(){return this.data[a.name]},configurable:!0}):Object.defineProperty(this,
a.name,{get:function(){return this.data[a.name]},set:function(c){var d=this.data,e=d[a.name];d[a.name]=c;this.fire("set",a.name,e,c)},configurable:!0})}.bind(this))},onSetEnabled:function(a,b,c){if(b!==c&&this.entity.enabled)if(c)this.onEnable();else this.onDisable()},onEnable:function(){},onDisable:function(){}};return{Component:e}}());pc.extend(pc,function(){return{ComponentData:function(){}}}());pc.extend(pc,function(){var e=function(){this.on("set_animations",this.onSetAnimations,this);this.on("set_assets",this.onSetAssets,this);this.on("set_loop",this.onSetLoop,this)},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{play:function(a,b){if(this.data.animations[a]){if(this.enabled&&this.entity.enabled){var b=b||0,c=this.data;c.prevAnim=c.currAnim;c.currAnim=a;c.model&&(c.blending=0<b,c.blending?(c.blendTime=b,c.blendTimeRemaining=b,c.fromSkel.setAnimation(c.animations[c.prevAnim]),c.fromSkel.addTime(c.skeleton.getCurrentTime()),
c.toSkel.setAnimation(c.animations[c.currAnim])):c.skeleton.setAnimation(c.animations[c.currAnim]));c.playing=!0}}else console.error(pc.string.format("Trying to play animation '{0}' which doesn't exist",a))},getAnimation:function(a){return this.data.animations[a]},setModel:function(a){var b=this.data;if(a){var c=a.getGraph();b.fromSkel=new pc.Skeleton(c);b.toSkel=new pc.Skeleton(c);b.skeleton=new pc.Skeleton(c);b.skeleton.setLooping(b.loop);b.skeleton.setGraph(c)}b.model=a;b.animations&&(b.currAnim&&
b.animations[b.currAnim])&&this.play(b.currAnim)},loadAnimationAssets:function(a){if(a&&a.length){for(var b={parent:this.entity.getRequest()},c=a.map(function(a){return this.system.app.assets.getAssetById(a)},this),d={},e=[],f=[],k=0,m=c.length;k<m;k++){var h=c[k];h?(h.off("change",this.onAssetChanged,this),h.on("change",this.onAssetChanged,this),h.off("remove",this.onAssetRemoved,this),h.on("remove",this.onAssetRemoved,this),h.resource?d[h.name]=h.resource:(e.push(h.name),f.push(new pc.resources.AnimationRequest(h.getFileUrl())))):
logERROR(pc.string.format("Trying to load animation component before assets {0} are loaded",a))}f.length?this.system.app.loader.request(f,b).then(function(a){for(var b=0;b<f.length;b++)d[e[b]]=a[b];this.animations=d}.bind(this)):this.animations=d}},onAssetChanged:function(a,b,c){"resource"===b&&(c?(this.animations[a.name]=c,this.data.currAnim===a.name&&this.data.playing&&(this.data.enabled&&this.entity.enabled)&&this.play(a.name,0)):delete this.animations[a.name])},onAssetRemoved:function(a){a.off("remove",
this.onAssetRemoved,this);this.animations&&this.animations[a.name]&&(delete this.animations[a.name],this.data.currAnim===a.name&&(this.data.currAnim=null,this.speed=0,this.data.playing=!1,this.data.skeleton&&(this.data.skeleton.setCurrentTime(0),this.data.skeleton.setAnimation(null))))},onSetAnimations:function(){var a=this.data,b=this.entity.model;b&&(b=b.model)&&this.entity.animation.setModel(b);for(var c in a.animations){a.activate&&(a.enabled&&this.entity.enabled&&!this.system._inTools)&&this.play(c,
0);break}},onSetAssets:function(a,b,c){if(b&&b.length)for(a=0;a<b.length;a++)if(b[a]){var d=this.system.app.assets.getAssetById(b[a]);d&&(d.off("change",this.onAssetChanged,this),d.off("remove",this.onAssetRemoved,this))}this.loadAnimationAssets(c)},onSetLoop:function(){this.data.skeleton&&this.data.skeleton.setLooping(this.data.loop)},onSetCurrentTime:function(a,b,c){this.data.skeleton.setCurrentTime(c);this.data.skeleton.addTime(0);this.data.skeleton.updateGraph()},onEnable:function(){e._super.onEnable.call(this);
if(this.data.activate&&!this.data.currAnim&&!this.system._inTools)for(var a in this.data.animations){this.play(a,0);break}}});Object.defineProperties(e.prototype,{currentTime:{get:function(){return this.data.skeleton.getCurrentTime()},set:function(a){this.data.skeleton.setCurrentTime(a);this.data.skeleton.addTime(0);this.data.skeleton.updateGraph()}},duration:{get:function(){return this.data.animations[this.data.currAnim].getDuration()}}});return{AnimationComponent:e}}());pc.extend(pc,function(){var e=function(a){this.id="animation";this.description="Specifies the animation assets that can run on the model specified by the Entity's model Component.";a.systems.add(this.id,this);this.ComponentType=pc.AnimationComponent;this.DataType=pc.AnimationComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enable or disable the component",type:"boolean",defaultValue:!0},{name:"assets",displayName:"Asset",description:"Animation Asset",type:"asset",options:{max:100,
type:"animation"},defaultValue:[]},{name:"speed",displayName:"Speed Factor",description:"Scale the animation playback speed",type:"number",options:{step:0.1},defaultValue:1},{name:"loop",displayName:"Loop",description:"Loop the animation back to the start on completion",type:"boolean",defaultValue:!0},{name:"activate",displayName:"Activate",description:"Play the configured animation on load",type:"boolean",defaultValue:!0},{name:"animations",exposed:!1},{name:"skeleton",exposed:!1,readOnly:!0},{name:"model",
exposed:!1,readOnly:!0},{name:"prevAnim",exposed:!1,readOnly:!0},{name:"currAnim",exposed:!1,readOnly:!0},{name:"fromSkel",exposed:!1,readOnly:!0},{name:"toSkel",exposed:!1,readOnly:!0},{name:"blending",exposed:!1,readOnly:!0},{name:"blendTime",exposed:!1,readOnly:!0},{name:"blendTimeRemaining",exposed:!1,readOnly:!0},{name:"playing",exposed:!1,readOnly:!0}];this.exposeProperties();this.on("remove",this.onRemove,this);this.on("update",this.onUpdate,this);pc.ComponentSystem.on("update",this.onUpdate,
this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){c=["activate","loop","speed","assets","enabled"];e._super.initializeComponentData.call(this,a,b,c)},cloneComponent:function(a,b){this.addComponent(b,{});b.animation.data.assets=pc.extend([],a.animation.assets);b.animation.data.speed=a.animation.speed;b.animation.data.loop=a.animation.loop;b.animation.data.activate=a.animation.activate;b.animation.data.enabled=a.animation.enabled;b.animation.animations=
pc.extend({},a.animation.animations)},onRemove:function(a,b){delete b.animation;delete b.skeleton;delete b.fromSkel;delete b.toSkel},onUpdate:function(a){var b=this.store,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c],e=d.data;e.enabled&&(e.playing&&d.entity.enabled)&&(d=e.skeleton,null!==d&&null!==e.model&&(e.blending?(e.blendTimeRemaining-=a,0>e.blendTimeRemaining&&(e.blendTimeRemaining=0),d.blend(e.fromSkel,e.toSkel,1-e.blendTimeRemaining/e.blendTime)):(d.addTime(a*e.speed),d.getCurrentTime()===
d.getAnimation().getDuration()&&!e.loop&&(e.playing=!1)),e.blending&&0===e.blendTimeRemaining&&(e.blending=!1,d.setAnimation(e.toSkel.getAnimation())),d.updateGraph()))}}});return{AnimationComponentSystem:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.assets=[];this.speed=1;this.enabled=this.activate=this.loop=!0;this.toSkel=this.fromSkel=this.currAnim=this.prevAnim=this.model=this.skeleton=this.animations=null;this.blending=!1;this.blendTimeRemaining=this.blendTime=0;this.playing=!1},pc.ComponentData);return{AnimationComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="model";this.description="Renders a 3D model at the location of the Entity.";a.systems.add(this.id,this);this.ComponentType=pc.ModelComponent;this.DataType=pc.ModelComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enable or disable rendering of the Model",type:"boolean",defaultValue:!0},{name:"type",displayName:"Type",description:"Type of model",type:"enumeration",options:{enumerations:[{name:"Asset",value:"asset"},{name:"Box",
value:"box"},{name:"Capsule",value:"capsule"},{name:"Sphere",value:"sphere"},{name:"Cylinder",value:"cylinder"},{name:"Cone",value:"cone"},{name:"Plane",value:"plane"}]},defaultValue:"asset"},{name:"asset",displayName:"Asset",description:"Model Asset to render",type:"asset",options:{max:1,type:"model"},defaultValue:null,filter:{type:"asset"}},{name:"materialAsset",displayName:"Material",description:"The material of the model",type:"asset",options:{max:1,type:"material"},defaultValue:null,filter:{type:function(){return!1}}},
{name:"castShadows",displayName:"Cast shadows",description:"Occlude light",type:"boolean",defaultValue:!1},{name:"receiveShadows",displayName:"Receive shadows",description:"Receive shadows cast from occluders",type:"boolean",defaultValue:!0},{name:"material",exposed:!1},{name:"model",exposed:!1}];this.exposeProperties();a=a.graphicsDevice;this.box=pc.createBox(a,{halfExtents:new pc.Vec3(0.5,0.5,0.5)});this.capsule=pc.createCapsule(a,{radius:0.5,height:2});this.sphere=pc.createSphere(a,{radius:0.5});
this.cone=pc.createCone(a,{baseRadius:0.5,peakRadius:0,height:1});this.cylinder=pc.createCylinder(a,{radius:0.5,height:1});this.plane=pc.createPlane(a,{halfExtents:new pc.Vec2(0.5,0.5),widthSegments:1,lengthSegments:1});this.defaultMaterial=new pc.PhongMaterial},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){b.material=this.defaultMaterial;c="material materialAsset asset castShadows receiveShadows type enabled".split(" ");e._super.initializeComponentData.call(this,
a,b,c)},removeComponent:function(a){var b=a.model.data;a.model.asset=null;"asset"!==b.type&&b.model&&(this.app.scene.removeModel(b.model),a.removeChild(b.model.getGraph()),b.model=null);e._super.removeComponent.call(this,a)},cloneComponent:function(a,b){this.addComponent(b,{});b.model.data.type=a.model.type;b.model.data.materialAsset=a.model.materialAsset;b.model.data.asset=a.model.asset;b.model.data.castShadows=a.model.castShadows;b.model.data.receiveShadows=a.model.receiveShadows;b.model.data.material=
a.model.material;b.model.data.enabled=a.model.enabled;a.model.model&&(b.model.model=a.model.model.clone())}});return{ModelComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set_type",this.onSetType,this);this.on("set_asset",this.onSetAsset,this);this.on("set_castShadows",this.onSetCastShadows,this);this.on("set_model",this.onSetModel,this);this.on("set_receiveShadows",this.onSetReceiveShadows,this);this.on("set_material",this.onSetMaterial,this);Object.defineProperty(this,"materialAsset",{set:this.setMaterialAsset.bind(this),get:this.getMaterialAsset.bind(this)})},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{setVisible:function(a){console.warn("WARNING: setVisible: Function is deprecated. Set enabled property instead.");
this.enabled=a},loadModelAsset:function(a){var b={parent:this.entity.getRequest()},c=this.system.app.assets.getAssetById(a);c?(c.off("change",this.onAssetChange,this),c.on("change",this.onAssetChange,this),c.off("remove",this.onAssetRemoved,this),c.on("remove",this.onAssetRemoved,this),c.resource?(a=c.resource.clone(),this._onModelLoaded(a)):this.system.app.assets.load(c,[],b).then(function(a){this._onModelLoaded(a[0])}.bind(this))):logERROR(pc.string.format("Trying to load model before asset {0} is loaded.",
a))},_onModelLoaded:function(a){this.system.app.designer&&a.generateWireframe();"asset"===this.data.type&&(this.model=a)},onSetType:function(a,b,c){a=this.data;if(c)if(b=null,"asset"===c)null!==this.data.asset?this.loadModelAsset(this.data.asset):this.model=null;else{switch(c){case "box":b=this.system.box;break;case "capsule":b=this.system.capsule;break;case "sphere":b=this.system.sphere;break;case "cone":b=this.system.cone;break;case "cylinder":b=this.system.cylinder;break;case "plane":b=this.system.plane;
break;default:throw Error("Invalid model type: "+c);}var c=new pc.GraphNode,d=new pc.Model;d.graph=c;d.meshInstances=[new pc.MeshInstance(c,b,a.material)];this.system.app.designer&&d.generateWireframe();this.model=d;this.asset=null}},onSetAsset:function(a,b,c){if(b&&(a=this.system.app.assets.getAssetById(b)))a.off("change",this.onAssetChange,this),a.off("remove",this.onAssetRemoved,this);"asset"===this.data.type?c?c instanceof pc.asset.Asset?(this.data.asset=c.id,this.loadModelAsset(c.id)):this.loadModelAsset(c):
this.model=null:c||(this.data.asset=null)},onSetCastShadows:function(a,b,c){if(a=this.data.model){var b=this.system.app.scene,d=b.containsModel(a);d&&b.removeModel(a);for(var e=a.meshInstances,f=0;f<e.length;f++)e[f].castShadow=c;d&&b.addModel(a)}},onSetModel:function(a,b,c){b&&(this.system.app.scene.removeModel(b),this.entity.removeChild(b.getGraph()),delete b._entity);if(c){for(var a=this.data,b=c.meshInstances,d=0;d<b.length;d++)b[d].castShadow=a.castShadows,b[d].receiveShadow=a.receiveShadows;
this.entity.addChild(c.graph);this.enabled&&this.entity.enabled&&this.system.app.scene.addModel(c);c._entity=this.entity;this.entity.animation&&this.entity.animation.setModel(c)}},setMaterialAsset:function(a){var a="number"===typeof a||!a?a:a.id,b;if(void 0!==a&&null!==a){var c=this.system.app.assets.getAssetById(a);c?c.resource?this.material=b=c.resource:this.system.app.assets.load(c).then(function(a){this.material=a[0]}.bind(this)):console.error(pc.string.format("Entity '{0}' is trying to load Material Asset {1} which no longer exists. Maybe this model was once a primitive shape?",
this.entity.getPath(),a))}b||(b=this.system.defaultMaterial);this.material=b;b=this.data.materialAsset;this.data.materialAsset=a;this.fire("set","materialAsset",b,a)},getMaterialAsset:function(){return this.system.app.assets.getAssetById(this.data.materialAsset)},onSetMaterial:function(a,b,c){if(c!==b&&(this.data.material=c,this.data.model&&"asset"!==this.data.type)){a=this.data.model.meshInstances;for(b=0;b<a.length;b++)a[b].material=c}},onSetReceiveShadows:function(a,b,c){if(void 0!==c&&(a=this.data,
a.model)){a=a.model.meshInstances;for(b=0;b<a.length;b++)a[b].receiveShadow=c}},onEnable:function(){e._super.onEnable.call(this);var a=this.data.model;a&&(this.system.app.scene.containsModel(a)||this.system.app.scene.addModel(a))},onDisable:function(){e._super.onDisable.call(this);var a=this.data.model;a&&this.system.app.scene.containsModel(a)&&this.system.app.scene.removeModel(a)},onAssetChange:function(a,b,c){"resource"===b&&c&&this._onModelLoaded(c.clone())},onAssetRemoved:function(a){a.off("remove",
this.onAssetRemoved,this);this.asset===a.id&&(this.asset=null)}});return{ModelComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.enabled=!0;this.type="asset";this.asset=null;this.castShadows=!1;this.receiveShadows=!0;this.model=this.material=this.materialAsset=null},pc.ComponentData);return{ModelComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="skybox";this.description="Renders a skybox in the scene.";a.systems.add(this.id,this);this.ComponentType=pc.SkyboxComponent;this.DataType=pc.SkyboxComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enables or disables the component",type:"boolean",defaultValue:!0},{name:"posx",displayName:"POSX",description:"URL of the positive X face of skybox cubemap",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"negx",
displayName:"NEGX",description:"URL of the negative X face of skybox cubemap",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"posy",displayName:"POSY",description:"URL of the positive Y face of skybox cubemap",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"negy",displayName:"NEGY",description:"URL of the negative Y face of skybox cubemap",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"posz",displayName:"POSZ",description:"URL of the positive Z face of skybox cubemap",
type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"negz",displayName:"NEGZ",description:"URL of the negative Z face of skybox cubemap",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"model",exposed:!1,readOnly:!0},{name:"assets",exposed:!1,readOnly:!0},{name:"cubemap",exposed:!1}];this.exposeProperties();this.on("remove",this.onRemove,this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){c="enabled posx negx posy negy posz negz cubemap".split(" ");
e._super.initializeComponentData.call(this,a,b,c)},onRemove:function(a,b){b.model&&(this.app.scene.removeModel(b.model),a.removeChild(b.model.getGraph()),b.model=null)}});return{SkyboxComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set",this.onSet,this)},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{onSet:function(b,c,d){function e(b,c){if(!(void 0===c||null===c)){var d=a.indexOf(b),f=this.entity.skybox.assets;this.data.model=null;f[d]=this.system.app.assets.getAssetById(c);if(f[d]){if(this.data.assets=f,f[0]&&f[1]&&f[2]&&f[3]&&f[4]&&f[5]){d=this.data;a:{for(var g=this.entity,h=this.system.app,k=h.graphicsDevice,m=[],w=[],B=[],y,A=0;A<f.length;A++)if(y=f[A])if(y.resource){y=
y.resource.getSource();if(!y){logERROR(pc.string.format("Trying to load skybox component with invalid texture types"));f=void 0;break a}m.push(y)}else B.push(A),w.push(new pc.resources.TextureRequest(y.getFileUrl()));else{logERROR(pc.string.format("Trying to load skybox component before assets are loaded"));f=void 0;break a}var F=new pc.Texture(k,{format:pc.PIXELFORMAT_R8_G8_B8,cubemap:!0});F.minFilter=pc.FILTER_LINEAR_MIPMAP_LINEAR;F.magFilter=pc.FILTER_LINEAR;F.addressU=pc.ADDRESS_CLAMP_TO_EDGE;
F.addressV=pc.ADDRESS_CLAMP_TO_EDGE;w.length?(f={parent:g.getRequest()},h.loader.request(w,f).then(function(a){for(var b=0;b<a.length;b++)m[B[b]]=a[b].getSource();F.setSource(m)})):F.setSource(m);w=new pc.Material;w.updateShader=function(){var a=k.getProgramLibrary().getProgram("skybox",{hdr:!1,gamma:h.scene.gammaCorrection,toneMapping:h.scene.toneMapping});this.setShader(a)};w.updateShader();w.setParameter("texture_cubeMap",F);w.cull=pc.CULLFACE_NONE;f=new pc.GraphNode;g=pc.createBox(k);w=new pc.MeshInstance(f,
g,w);g=new pc.Model;g.graph=f;g.meshInstances=[w];f=g}d.model=f;this.enabled&&this.entity.enabled&&(this.system.app.scene.addModel(this.data.model),this.entity.addChild(this.data.model.graph))}}else logERROR(pc.string.format("Trying to load skybox component before asset {0} has loaded",c))}}if("cubemap"==b&&d){var b=this.data,f=this.system.app,k=f.graphicsDevice,m=new pc.Material;m.updateShader=function(){var a=k.getProgramLibrary().getProgram("skybox",{hdr:d.hdr,prefiltered:!0,gamma:f.scene.gammaCorrection,
toneMapping:f.scene.toneMapping});this.setShader(a)};m.updateShader();m.setParameter("texture_cubeMap",d);m.cull=pc.CULLFACE_NONE;var c=new pc.GraphNode,h=pc.createBox(k),m=new pc.MeshInstance(c,h,m),h=new pc.Model;h.graph=c;h.meshInstances=[m];b.model=h;this.enabled&&this.entity.enabled&&(this.system.app.scene.addModel(this.data.model),this.entity.addChild(this.data.model.graph))}else m={posx:function(a,b,c,d){e.call(this,b,d)},negx:function(a,b,c,d){e.call(this,b,d)},posy:function(a,b,c,d){e.call(this,
b,d)},negy:function(a,b,c,d){e.call(this,b,d)},posz:function(a,b,c,d){e.call(this,b,d)},negz:function(a,b,c,d){e.call(this,b,d)}},m[b]&&m[b].call(this,this.entity,b,c,d)},onEnable:function(){e._super.onEnable.call(this);this.data.model&&!this.system.app.scene.containsModel(this.data.model)&&(this.system.app.scene.addModel(this.data.model),this.entity.addChild(this.data.model.graph))},onDisable:function(){e._super.onDisable.call(this);this.data.model&&this.system.app.scene.containsModel(this.data.model)&&
(this.entity.removeChild(this.data.model.graph),this.system.app.scene.removeModel(this.data.model))}});var a="posx negx posy negy posz negz".split(" ");return{SkyboxComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.enabled=!0;this.negz=this.posz=this.negy=this.posy=this.negx=this.posx=null;this.assets=[];this.model=null},pc.ComponentData);return{SkyboxComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="camera";this.description="Renders the scene from the location of the Entity.";a.systems.add(this.id,this);this.ComponentType=pc.CameraComponent;this.DataType=pc.CameraComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enable or disable the component",type:"boolean",defaultValue:!0},{name:"clearColorBuffer",displayName:"Clear Color Buffer",description:"Clear color buffer",type:"boolean",defaultValue:!0},{name:"clearColor",
displayName:"Clear Color",description:"Clear Color",type:"rgba",defaultValue:[0.7294117647058823,0.7294117647058823,0.6941176470588235,1],filter:{clearColorBuffer:!0}},{name:"clearDepthBuffer",displayName:"Clear Depth Buffer",description:"Clear depth buffer",type:"boolean",defaultValue:!0},{name:"frustumCulling",displayName:"Frustum culling",type:"boolean",defaultValue:!1,exposed:!1},{name:"projection",displayName:"Projection",description:"Projection type of camera",type:"enumeration",options:{enumerations:[{name:"Perspective",
value:0},{name:"Orthographic",value:1}]},defaultValue:0},{name:"fov",displayName:"Field of View",description:"Field of view in Y axis",type:"number",defaultValue:45,options:{min:0,max:90},filter:{projection:0}},{name:"orthoHeight",displayName:"Ortho Height",description:"View window half extent of camera in Y axis",type:"number",defaultValue:100,filter:{projection:1}},{name:"nearClip",displayName:"Near Clip",description:"Near clipping distance",type:"number",defaultValue:0.3,options:{min:1E-4,decimalPrecision:5}},
{name:"farClip",displayName:"Far Clip",description:"Far clipping distance",type:"number",defaultValue:1E3,options:{min:1E-4,decimalPrecision:5}},{name:"priority",displayName:"Priority",description:"Controls which camera will be rendered first. Smaller numbers are rendered first.",type:"number",defaultValue:0},{name:"rect",displayName:"Viewport",description:"Controls where on the screen the camera will be rendered in normalized coordinates.",type:"vector",defaultValue:[0,0,1,1]},{name:"camera",exposed:!1},
{name:"aspectRatio",exposed:!1},{name:"model",exposed:!1},{name:"renderTarget",exposed:!1}];this.exposeProperties();this.cameras=[];this.on("beforeremove",this.onBeforeRemove,this);this.on("remove",this.onRemove,this);pc.ComponentSystem.on("toolsUpdate",this.toolsUpdate,this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){b=b||{};b.clearColor&&"array"===pc.type(b.clearColor)&&(c=b.clearColor,b.clearColor=new pc.Color(c[0],c[1],c[2],c[3]));b.rect&&
"array"===pc.type(b.rect)&&(c=b.rect,b.rect=new pc.Vec4(c[0],c[1],c[2],c[3]));b.activate&&(console.warn("WARNING: activate: Property is deprecated. Set enabled property instead."),b.enabled=b.activate);b.camera=new pc.Camera;b._node=a.entity;b.postEffects=new pc.PostEffectQueue(this.app,a);if(this.app.designer&&this.displayInTools(a.entity)){c=new pc.BasicMaterial;c.color=new pc.Color(1,1,0,1);c.update();var d=new pc.IndexBuffer(this.app.graphicsDevice,pc.INDEXFORMAT_UINT8,24);(new Uint8Array(d.lock())).set([0,
1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);d.unlock();var g=new pc.VertexFormat(this.app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),f=new pc.VertexBuffer(this.app.graphicsDevice,g,8,pc.BUFFER_DYNAMIC),g=new pc.Mesh;g.vertexBuffer=f;g.indexBuffer[0]=d;g.primitive[0].type=pc.PRIMITIVE_LINES;g.primitive[0].base=0;g.primitive[0].count=d.getNumIndices();g.primitive[0].indexed=!0;d=new pc.Model;d.graph=a.entity;d.meshInstances=[new pc.MeshInstance(d.graph,
g,c)];this.app.scene.addModel(d);b.model=d}c="postEffects enabled model camera aspectRatio renderTarget clearColor fov orthoHeight nearClip farClip projection priority clearColorBuffer clearDepthBuffer frustumCulling rect".split(" ");e._super.initializeComponentData.call(this,a,b,c)},onBeforeRemove:function(a,b){this.removeCamera(b)},onRemove:function(a,b){this.app.designer&&this.displayInTools(a)&&this.app.scene.containsModel(b.model)&&this.app.scene.removeModel(b.model);b.camera=null},toolsUpdate:function(){var a=
this.store,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b].entity;this.displayInTools(c)&&this._updateGfx(c.camera)}},_updateGfx:function(a){if(a.model&&a.model.meshInstances.length){var b=a.model.meshInstances[0].mesh.vertexBuffer,c=a.camera.getAspectRatio(),d=this.isToolsCamera(a.entity)?0.5:a.nearClip,e=this.isToolsCamera(a.entity)?2:a.farClip,f=a.fov*Math.PI/180,k=a.projection,m;m=k===pc.PROJECTION_PERSPECTIVE?Math.tan(f/2)*d:a.camera.getOrthoHeight();var a=m*c,h=new Float32Array(b.lock());h[0]=
a;h[1]=-m;h[2]=-d;h[3]=a;h[4]=m;h[5]=-d;h[6]=-a;h[7]=m;h[8]=-d;h[9]=-a;h[10]=-m;h[11]=-d;k===pc.PROJECTION_PERSPECTIVE&&(m=Math.tan(f/2)*e,a=m*c);h[12]=a;h[13]=-m;h[14]=-e;h[15]=a;h[16]=m;h[17]=-e;h[18]=-a;h[19]=m;h[20]=-e;h[21]=-a;h[22]=-m;h[23]=-e;b.unlock()}},addCamera:function(a){this.cameras.push(a);this.sortCamerasByPriority();if(this.app.designer&&(a=a.data.model)){var b=this.app.scene;b.containsModel(a)||b.addModel(a)}},removeCamera:function(a){var b=this.cameras.indexOf(a);0<=b&&(this.cameras.splice(b,
1),this.sortCamerasByPriority(),this.app.designer&&(a=a.data.model)&&this.app.scene.removeModel(a))},sortCamerasByPriority:function(){this.cameras.sort(function(a,b){return a.priority-b.priority})},isToolsCamera:function(a){return a.hasLabel("pc:designer")},displayInTools:function(a){return!this.isToolsCamera(a)||"Perspective"===a.getName()}});return{CameraComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set_aspectRatio",this.onSetAspectRatio,this);this.on("set_camera",this.onSetCamera,this);this.on("set_clearColor",this.onSetClearColor,this);this.on("set_fov",this.onSetFov,this);this.on("set_orthoHeight",this.onSetOrthoHeight,this);this.on("set_nearClip",this.onSetNearClip,this);this.on("set_farClip",this.onSetFarClip,this);this.on("set_projection",this.onSetProjection,this);this.on("set_priority",this.onSetPriority,this);this.on("set_clearColorBuffer",
this.updateClearFlags,this);this.on("set_clearDepthBuffer",this.updateClearFlags,this);this.on("set_renderTarget",this.onSetRenderTarget,this);this.on("set_rect",this.onSetRect,this);this.on("set_frustumCulling",this.onSetFrustumCulling,this)},e=pc.inherits(e,pc.Component);Object.defineProperty(e.prototype,"activate",{get:function(){console.warn("WARNING: activate: Property is deprecated. Query enabled property instead.");return this.enabled},set:function(a){console.warn("WARNING: activate: Property is deprecated. Set enabled property instead.");
this.enabled=a}});Object.defineProperty(e.prototype,"projectionMatrix",{get:function(){return this.data.camera.getProjectionMatrix()}});Object.defineProperty(e.prototype,"viewMatrix",{get:function(){return this.data.camera._node.getWorldTransform().clone().invert()}});Object.defineProperty(e.prototype,"frustum",{get:function(){return this.data.camera.getFrustum()}});pc.extend(e.prototype,{screenToWorld:function(a,b,c,d){var e=this.system.app.graphicsDevice,f=parseInt(e.canvas.clientWidth),e=parseInt(e.canvas.clientHeight);
return this.data.camera.screenToWorld(a,b,c,f,e,d)},worldToScreen:function(a,b){var c=this.system.app.graphicsDevice,d=parseInt(c.canvas.clientWidth),c=parseInt(c.canvas.clientHeight);return this.data.camera.worldToScreen(a,d,c,b)},onSetAspectRatio:function(a,b,c){this.data.camera.setAspectRatio(c)},onSetCamera:function(a,b,c){b&&(b._node=null);c._node=this.entity},onSetClearColor:function(a,b,c){a=this.data.camera.getClearOptions();a.color[0]=c.r;a.color[1]=c.g;a.color[2]=c.b;a.color[3]=c.a},onSetFov:function(a,
b,c){this.data.camera.setFov(c)},onSetOrthoHeight:function(a,b,c){this.data.camera.setOrthoHeight(c)},onSetNearClip:function(a,b,c){this.data.camera.setNearClip(c)},onSetFarClip:function(a,b,c){this.data.camera.setFarClip(c)},onSetFrustumCulling:function(a,b,c){this.data.camera.frustumCulling=c},onSetProjection:function(a,b,c){this.data.camera.setProjection(c)},onSetPriority:function(){this.system.sortCamerasByPriority()},updateClearFlags:function(){var a=this.data.camera.getClearOptions(),b=0;this.clearColorBuffer&&
(b|=pc.CLEARFLAG_COLOR);this.clearDepthBuffer&&(b|=pc.CLEARFLAG_DEPTH);a.flags=b},onSetRenderTarget:function(a,b,c){this.data.camera.setRenderTarget(c)},onSetRect:function(a,b,c){this.data.camera.setRect(c.data[0],c.data[1],c.data[2],c.data[3]);this._resetAspectRatio()},onEnable:function(){e._super.onEnable.call(this);this.system.addCamera(this);this.postEffects.enable()},onDisable:function(){e._super.onDisable.call(this);this.postEffects.disable();this.system.removeCamera(this)},_resetAspectRatio:function(){var a=
this.camera;if(a){var b=this.system.app.graphicsDevice,c=this.rect,b=b.width*c.z/(b.height*c.w);b!==a.getAspectRatio()&&a.setAspectRatio(b)}},frameBegin:function(){this._resetAspectRatio();this.data.isRendering=!0},frameEnd:function(){this.data.isRendering=!1}});return{CameraComponent:e}}());pc.extend(pc,function(){CameraComponentData=function(){this.clearColor=new pc.Color(0.729411780834198,0.729411780834198,0.6941176652908325,1);this.clearDepthBuffer=this.clearColorBuffer=!0;this.nearClip=0.1;this.farClip=1E3;this.fov=45;this.orthoHeight=100;this.projection=pc.PROJECTION_PERSPECTIVE;this.priority=0;this.rect=new pc.Vec4(0,0,1,1);this.enabled=!0;this.frustumCulling=!1;this.camera=null;this.aspectRatio=16/9;this.postEffects=this.renderTarget=null;this.isRendering=!1};CameraComponentData=
pc.inherits(CameraComponentData,pc.ComponentData);return{CameraComponentData:CameraComponentData}}());pc.extend(pc,function(){var e=function(a){this.id="light";this.description="Enables the Entity to emit light.";a.systems.add(this.id,this);this.ComponentType=pc.LightComponent;this.DataType=pc.LightComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enable or disable the light",type:"boolean",defaultValue:!0},{name:"type",displayName:"Type",description:"The type of the light",type:"enumeration",options:{enumerations:[{name:"Directional",value:"directional"},{name:"Point",
value:"point"},{name:"Spot",value:"spot"}]},defaultValue:"directional"},{name:"color",displayName:"Color",description:"Light Color",type:"rgb",defaultValue:[1,1,1]},{name:"intensity",displayName:"Intensity",description:"The intensity of the light",type:"number",defaultValue:1,options:{min:0,max:10,step:0.05}},{name:"castShadows",displayName:"Cast Shadows",description:"Cast shadows from this light",type:"boolean",defaultValue:!1},{name:"shadowDistance",displayName:"Shadow Distance",description:"Camera distance at which shadows are no longer rendered",
type:"number",options:{min:0,decimalPrecision:5},defaultValue:40,filter:{castShadows:!0,type:"directional"}},{name:"shadowResolution",displayName:"Shadow Resolution",description:"Resolution of shadowmap generated by this light",type:"enumeration",options:{enumerations:[{name:"128",value:128},{name:"256",value:256},{name:"512",value:512},{name:"1024",value:1024},{name:"2048",value:2048}]},defaultValue:1024,filter:{castShadows:!0}},{name:"shadowBias",displayName:"Shadow Bias",description:"Tunes the shadows to reduce rendering artifacts",
type:"number",options:{min:0,max:1,decimalPrecision:5,step:0.01},defaultValue:0.05,filter:{castShadows:!0}},{name:"normalOffsetBias",displayName:"Normal Offset Shadow Bias",description:"Tunes the shadows to reduce rendering artifacts",type:"number",options:{min:0,max:1,decimalPrecision:5,step:0.01},defaultValue:0,filter:{castShadows:!0}},{name:"range",displayName:"Range",description:"The distance from the light where its contribution falls to zero",type:"number",defaultValue:10,options:{min:0},filter:{type:["point",
"spot"]}},{name:"falloffMode",displayName:"Falloff mode",description:"Controls the rate at which a light attentuates from its position",type:"enumeration",options:{enumerations:[{name:"Linear",value:pc.LIGHTFALLOFF_LINEAR},{name:"Inverse squared",value:pc.LIGHTFALLOFF_INVERSESQUARED}]},defaultValue:0,filter:{type:["point","spot"]}},{name:"shadowType",exposed:!1},{name:"shadowUpdateMode",exposed:!1},{name:"mask",displayName:"Mask",description:"Bit mask",type:"number",defaultValue:1,exposed:!1},{name:"innerConeAngle",
displayName:"Inner Cone Angle",description:"Spotlight inner cone angle",type:"number",defaultValue:40,options:{min:0,max:90},filter:{type:"spot"}},{name:"outerConeAngle",displayName:"Outer Cone Angle",description:"Spotlight outer cone angle",type:"number",defaultValue:45,options:{min:0,max:90},filter:{type:"spot"}},{name:"light",exposed:!1},{name:"model",exposed:!1}];this.exposeProperties();this.implementations={};this.on("remove",this.onRemove,this);pc.ComponentSystem.on("toolsUpdate",this.toolsUpdate,
this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){b.type||(b.type=a.data.type);a.data.type=b.type;b.color&&"array"===pc.type(b.color)&&(b.color=new pc.Color(b.color[0],b.color[1],b.color[2]));b.enable&&(console.warn("WARNING: enable: Property is deprecated. Set enabled property instead."),b.enabled=b.enable);this._createImplementation(b.type).initialize(a,b);c="type light model enabled color intensity range falloffMode innerConeAngle outerConeAngle castShadows shadowDistance shadowResolution shadowUpdateMode shadowBias normalOffsetBias".split(" ");
e._super.initializeComponentData.call(this,a,b,c)},_createImplementation:function(a){var b=this.implementations[a];if(!b){switch(a){case "directional":b=new DirectionalLightImplementation(this);break;case "point":b=new PointLightImplementation(this);break;case "spot":b=new SpotLightImplementation(this);break;default:throw Error("Invalid light type: "+a);}this.implementations[a]=b}return b},onRemove:function(a,b){this.implementations[b.type].remove(a,b)},cloneComponent:function(a,b){var c=a.light;
this.addComponent(b,{type:c.type,enabled:c.enabled,color:[c.color.r,c.color.g,c.color.b],intensity:c.intensity,range:c.range,innerConeAngle:c.innerConeAngle,outerConeAngle:c.outerConeAngle,castShadows:c.castShadows,shadowDistance:c.shadowDistance,shadowResolution:c.shadowResolution,falloffMode:c.falloffMode,shadowUpdateMode:c.shadowUpdateMode,shadowBias:c.shadowBias,normalOffsetBias:c.normalOffsetBias})},toolsUpdate:function(){var a=this.store,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b].data,
d=this.implementations[c.type];d&&d.toolsUpdate(c)}},changeType:function(a,b,c){this.implementations[b].remove(a.entity,a.data);this._createImplementation(c).initialize(a,a.data)}});LightComponentImplementation=function(a){this.system=a};LightComponentImplementation.prototype={initialize:function(a,b){var c=new pc.Light;c.setType(this._getLightType());c._node=a.entity;this.system.app.scene.addLight(c);this._createDebugShape(a,b,c)},_getLightType:function(){},_createDebugShape:function(a,b,c){var d=
this.system.app,b=b||{};b.light=c;d.designer&&(this.mesh=this._createDebugMesh(),this.material||(this.material=this._createDebugMaterial()),c=new pc.Model,c.graph=a.entity,c.meshInstances=[new pc.MeshInstance(a.entity,this.mesh,this.material)],b.model=c)},_createDebugMesh:function(){},_createDebugMaterial:function(){},remove:function(a,b){var c=this.system.app;c.scene.removeModel(b.model);delete b.model;c.scene.removeLight(b.light);c.designer&&(c.scene.removeModel(b.model),delete b.model)},toolsUpdate:function(){}};
DirectionalLightImplementation=function(){};DirectionalLightImplementation=pc.inherits(DirectionalLightImplementation,LightComponentImplementation);DirectionalLightImplementation.prototype=pc.extend(DirectionalLightImplementation.prototype,{_getLightType:function(){return pc.LIGHTTYPE_DIRECTIONAL},_createDebugMesh:function(){if(this.mesh)return this.mesh;var a=this.system.app,b=new pc.VertexFormat(a.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]);vertexData=
[0,0,0,0,-8,0,-0.5,-8,0,0.5,-8,0,0.5,-8,0,0,-10,0,0,-10,0,-0.5,-8,0,0,0,-2,0,-8,-2,-0.25,-8,-2,0.25,-8,-2,0.25,-8,-2,0,-10,-2,0,-10,-2,-0.25,-8,-2,0,0,2,0,-8,2,-0.25,-8,2,0.25,-8,2,0.25,-8,2,0,-10,2,0,-10,2,-0.25,-8,2];var c=(new pc.Mat4).setFromAxisAngle(pc.Vec3.UP,120),d;for(d=0;24>d;d++){var e=new pc.Vec3(vertexData[3*(d+8)],vertexData[3*(d+8)+1],vertexData[3*(d+8)+2]),e=c.transformPoint(e,e);vertexData[3*(d+24)]=e[0];vertexData[3*(d+24)+1]=e[1];vertexData[3*(d+24)+2]=e[2]}a=new pc.VertexBuffer(a.graphicsDevice,
b,32);b=new Float32Array(a.lock());for(d=0;d<vertexData.length;d++)b[d]=vertexData[d];a.unlock();d=new pc.Mesh;d.vertexBuffer=a;d.indexBuffer[0]=null;d.primitive[0].type=pc.PRIMITIVE_LINES;d.primitive[0].base=0;d.primitive[0].count=a.getNumVertices();d.primitive[0].indexed=!1;return d},_createDebugMaterial:function(){var a=new pc.BasicMaterial;a.color=new pc.Color(1,1,0,1);a.update();return a}});PointLightImplementation=function(){};PointLightImplementation=pc.inherits(PointLightImplementation,LightComponentImplementation);
PointLightImplementation.prototype=pc.extend(PointLightImplementation.prototype,{_getLightType:function(){return pc.LIGHTTYPE_POINT},_createDebugMesh:function(){return this.mesh?this.mesh:pc.createSphere(this.system.app.graphicsDevice,{radius:0.1})},_createDebugMaterial:function(){var a=new pc.BasicMaterial;a.color=new pc.Color(1,1,0,1);a.update();return a}});SpotLightImplementation=function(){};SpotLightImplementation=pc.inherits(SpotLightImplementation,LightComponentImplementation);SpotLightImplementation.prototype=
pc.extend(SpotLightImplementation.prototype,{_getLightType:function(){return pc.LIGHTTYPE_SPOT},_createDebugMesh:function(){var a=this.system.app,b=this.indexBuffer;if(!b){var b=new pc.IndexBuffer(a.graphicsDevice,pc.INDEXFORMAT_UINT8,88),c=new Uint8Array(b.lock());c[0]=0;c[1]=1;c[2]=0;c[3]=11;c[4]=0;c[5]=21;c[6]=0;c[7]=31;for(var d=0;40>d;d++)c[2*d+8]=d+1,c[2*d+9]=d+2;b.unlock();this.indexBuffer=b}c=new pc.VertexFormat(a.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]);
a=new pc.VertexBuffer(a.graphicsDevice,c,42,pc.BUFFER_DYNAMIC);c=new pc.Mesh;c.vertexBuffer=a;c.indexBuffer[0]=b;c.primitive[0].type=pc.PRIMITIVE_LINES;c.primitive[0].base=0;c.primitive[0].count=b.getNumIndices();c.primitive[0].indexed=!0;return c},_createDebugMaterial:function(){return new pc.BasicMaterial},toolsUpdate:function(a){var b=a.model.meshInstances[0].mesh.vertexBuffer,c=Math.PI*a.outerConeAngle/180,d=a.range,a=-d*Math.cos(c),c=d*Math.sin(c),d=new Float32Array(b.lock());d[0]=0;d[1]=0;d[2]=
0;for(var e=b.getNumVertices(),f=0;f<e-1;f++){var k=2*Math.PI*(f/(e-2)),m=c*Math.cos(k),k=c*Math.sin(k);d[3*(f+1)+0]=m;d[3*(f+1)+1]=a;d[3*(f+1)+2]=k}b.unlock()}});return{LightComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set_type",this.onSetType,this);this.on("set_color",this.onSetColor,this);this.on("set_intensity",this.onSetIntensity,this);this.on("set_castShadows",this.onSetCastShadows,this);this.on("set_shadowDistance",this.onSetShadowDistance,this);this.on("set_shadowResolution",this.onSetShadowResolution,this);this.on("set_shadowBias",this.onSetShadowBias,this);this.on("set_normalOffsetBias",this.onSetNormalOffsetBias,this);this.on("set_range",this.onSetRange,
this);this.on("set_innerConeAngle",this.onSetInnerConeAngle,this);this.on("set_outerConeAngle",this.onSetOuterConeAngle,this);this.on("set_falloffMode",this.onSetFalloffMode,this);this.on("set_shadowType",this.onSetShadowType,this);this.on("set_shadowUpdateMode",this.onSetShadowUpdateMode,this);this.on("set_mask",this.onSetMask,this)},e=pc.inherits(e,pc.Component);Object.defineProperty(e.prototype,"enable",{get:function(){console.warn("WARNING: enable: Property is deprecated. Query enabled property instead.");
return this.enabled},set:function(a){console.warn("WARNING: enable: Property is deprecated. Set enabled property instead.");this.enabled=a}});pc.extend(e.prototype,{onSetType:function(a,b,c){b!==c&&(this.system.changeType(this,b,c),this.refreshProperties())},refreshProperties:function(){this.onSetCastShadows("castShadows",this.castShadows,this.castShadows);this.onSetColor("color",this.color,this.color);this.onSetIntensity("intensity",this.intensity,this.intensity);this.onSetShadowDistance("shadowDistance",
this.shadowDistance,this.shadowDistance);this.onSetShadowResolution("shadowResolution",this.shadowResolution,this.shadowResolution);this.onSetShadowBias("shadowBias",this.shadowBias,this.shadowBias);this.onSetNormalOffsetBias("normalOffsetBias",this.normalOffsetBias,this.normalOffsetBias);this.onSetRange("range",this.range,this.range);this.onSetInnerConeAngle("innerConeAngle",this.innerConeAngle,this.innerConeAngle);this.onSetOuterConeAngle("outerConeAngle",this.outerConeAngle,this.outerConeAngle);
this.onSetFalloffMode("falloffMode",this.falloffMode,this.falloffMode);this.onSetShadowType("shadowType",this.shadowType,this.shadowType);this.onSetShadowUpdateMode("shadowUpdateMode",this.shadowUpdateMode,this.shadowUpdateMode);this.onSetMask("mask",this.mask,this.mask);if(this.enabled&&this.entity.enabled)this.onEnable()},updateShadow:function(){this.light.updateShadow()},onSetCastShadows:function(a,b,c){this.light.setCastShadows(c)},onSetColor:function(a,b,c){this.light.setColor(c)},onSetIntensity:function(a,
b,c){this.light.setIntensity(c)},onSetShadowDistance:function(a,b,c){"directional"===this.data.type&&this.light.setShadowDistance(c)},onSetShadowResolution:function(a,b,c){this.light.setShadowResolution(c)},onSetShadowBias:function(a,b,c){this.light.setShadowBias(-0.01*c)},onSetNormalOffsetBias:function(a,b,c){this.light.setNormalOffsetBias(c)},onSetRange:function(a,b,c){("point"===this.data.type||"spot"===this.data.type)&&this.light.setAttenuationEnd(c)},onSetInnerConeAngle:function(a,b,c){"spot"===
this.data.type&&this.light.setInnerConeAngle(c)},onSetOuterConeAngle:function(a,b,c){"spot"===this.data.type&&this.light.setOuterConeAngle(c)},onSetFalloffMode:function(a,b,c){("point"===this.data.type||"spot"===this.data.type)&&this.light.setFalloffMode(c)},onSetShadowType:function(a,b,c){this.light.setShadowType(c)},onSetShadowUpdateMode:function(a,b,c){this.light.shadowUpdateMode=c},onSetMask:function(a,b,c){this.light.mask=c},onEnable:function(){e._super.onEnable.call(this);this.light.setEnabled(!0);
var a=this.data.model;if(a){var b=this.system.app.scene;b.containsModel(a)||b.addModel(a)}},onDisable:function(){e._super.onDisable.call(this);this.light.setEnabled(!1);var a=this.data.model;a&&this.system.app.scene.removeModel(a)}});return{LightComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.type="directional";this.enabled=!0;this.color=new pc.Color(1,1,1);this.intensity=1;this.castShadows=!1;this.shadowDistance=40;this.shadowResolution=1024;this.shadowBias=0.05;this.normalOffsetBias=0;this.range=10;this.innerConeAngle=40;this.outerConeAngle=45;this.falloffMode=pc.LIGHTFALLOFF_LINEAR;this.shadowType=pc.SHADOW_DEPTH;this.shadowUpdateMode=pc.SHADOWUPDATE_REALTIME;this.mask=1;this.model=this.light=null},pc.ComponentData);return{LightComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="script";this.description="Allows the Entity to run JavaScript fragments to implement custom behavior.";a.systems.add(this.id,this);this.ComponentType=pc.ScriptComponent;this.DataType=pc.ScriptComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Disabled components are not updated",type:"boolean",defaultValue:!0},{name:"scripts",displayName:"URLs",description:"Attach scripts to this Entity",type:"script",defaultValue:[]},{name:"instances",
exposed:!1},{name:"runInTools",description:"Allows scripts to be loaded and executed while in the tools",defaultValue:!1,exposed:!1}];this.exposeProperties();this.instancesWithUpdate=[];this.instancesWithFixedUpdate=[];this.instancesWithPostUpdate=[];this.instancesWithToolsUpdate=[];this.on("beforeremove",this.onBeforeRemove,this);pc.ComponentSystem.on("initialize",this.onInitialize,this);pc.ComponentSystem.on("postInitialize",this.onPostInitialize,this);pc.ComponentSystem.on("update",this.onUpdate,
this);pc.ComponentSystem.on("fixedUpdate",this.onFixedUpdate,this);pc.ComponentSystem.on("postUpdate",this.onPostUpdate,this);pc.ComponentSystem.on("toolsUpdate",this.onToolsUpdate,this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){c=["runInTools","enabled","scripts"];b.scripts&&b.scripts.length&&b.scripts.forEach(function(a){if(a.attributes&&"array"===pc.type(a.attributes)){for(var b={},c=0;c<a.attributes.length;c++)b[a.attributes[c].name]=a.attributes[c];
a.attributes=b}});e._super.initializeComponentData.call(this,a,b,c)},cloneComponent:function(a,b){var c=this.dataStore[a.getGuid()],c={runInTools:c.data.runInTools,scripts:pc.extend([],c.data.scripts),enabled:c.data.enabled};return this.addComponent(b,c)},onBeforeRemove:function(a,b){b.enabled&&this._disableScriptComponent(b);this._destroyScriptComponent(b)},onInitialize:function(a){this._registerInstances(a);if(a.enabled){a.script&&a.script.enabled&&this._initializeScriptComponent(a.script);var a=
a.getChildren(),b,c=a.length;for(b=0;b<c;b++)if(a[b]instanceof pc.Entity)this.onInitialize(a[b])}},onPostInitialize:function(a){if(a.enabled){a.script&&a.script.enabled&&this._postInitializeScriptComponent(a.script);var a=a.getChildren(),b,c=a.length;for(b=0;b<c;b++)if(a[b]instanceof pc.Entity)this.onPostInitialize(a[b])}},_callInstancesMethod:function(a,b){var c=a.data.instances,d;for(d in c)if(c.hasOwnProperty(d)){var e=c[d].instance;e[b]&&e[b].call(e)}},_initializeScriptComponent:function(a){this._callInstancesMethod(a,
"initialize");a.data.initialized=!0;a.enabled&&a.entity.enabled&&this._enableScriptComponent(a)},_enableScriptComponent:function(a){this._callInstancesMethod(a,"onEnable")},_disableScriptComponent:function(a){this._callInstancesMethod(a,"onDisable")},_destroyScriptComponent:function(a){var b,c=a.data.instances,d;for(d in c)if(c.hasOwnProperty(d)){var e=c[d].instance;e.destroy&&e.destroy();e.update&&(b=this.instancesWithUpdate.indexOf(e),0<=b&&this.instancesWithUpdate.splice(b,1));e.fixedUpdate&&(b=
this.instancesWithFixedUpdate.indexOf(e),0<=b&&this.instancesWithFixedUpdate.splice(b,1));e.postUpdate&&(b=this.instancesWithPostUpdate.indexOf(e),0<=b&&this.instancesWithPostUpdate.splice(b,1));e.toolsUpdate&&(b=this.instancesWithToolsUpdate.indexOf(e),0<=b&&this.instancesWithToolsUpdate.splice(b,1));a.instances[d].instance===a[d]&&delete a[d];delete a.instances[d]}},_postInitializeScriptComponent:function(a){this._callInstancesMethod(a,"postInitialize");a.data.postInitialized=!0},_updateInstances:function(a,
b,c){for(var d,e=0,f=b.length;e<f;e++)(d=b[e])&&(d.entity.script.enabled&&d.entity.enabled)&&d[a].call(d,c)},onUpdate:function(a){this._updateInstances("update",this.instancesWithUpdate,a)},onFixedUpdate:function(a){this._updateInstances("fixedUpdate",this.instancesWithFixedUpdate,a)},onPostUpdate:function(a){this._updateInstances("postUpdate",this.instancesWithPostUpdate,a)},onToolsUpdate:function(a){this._updateInstances("toolsUpdate",this.instancesWithToolsUpdate,a)},broadcast:function(a,b){console.warn("DEPRECATED: ScriptComponentSystem.broadcast() is deprecated and will be removed soon. Please use: http://developer.playcanvas.com/user-manual/scripting/communication/");
var c=pc.makeArray(arguments).slice(2),d,e,f,k=this.store;for(d in k)k.hasOwnProperty(d)&&(e=k[d].data,e.instances[a]&&(f=e.instances[a].instance[b])&&f.apply(e.instances[a].instance,c))},_preRegisterInstance:function(a,b,c,d){if(a.script){a.script.data._instances=a.script.data._instances||{};if(a.script.data._instances[c])throw Error(pc.string.format("Script name collision '{0}'. Scripts from '{1}' and '{2}' {{3}}",c,b,a.script.data._instances[c].url,a.getGuid()));a.script.data._instances[c]={url:b,
name:c,instance:d}}},_registerInstances:function(a){var b,c,d;if(a.script&&a.script.data._instances){a.script.instances=a.script.data._instances;for(d in a.script.instances){b=a.script.instances[d];c=b.instance;pc.events.attach(c);c.update&&this.instancesWithUpdate.push(c);c.fixedUpdate&&this.instancesWithFixedUpdate.push(c);c.postUpdate&&this.instancesWithPostUpdate.push(c);c.toolsUpdate&&this.instancesWithToolsUpdate.push(c);a.script.scripts&&this._createAccessors(a,b);if(a.script[d])throw Error(pc.string.format("Script with name '{0}' is already attached to Script Component",
d));a.script[d]=c}delete a.script.data._instances}a=a.getChildren();c=a.length;for(b=0;b<c;b++)a[b]instanceof pc.Entity&&this._registerInstances(a[b])},_createAccessors:function(a,b){var c,d=a.script.scripts.length,e=b.url;for(c=0;c<d;c++){var f=a.script.scripts[c];if(f.url===e){c=f.attributes;if(f.name&&c){for(var k in c)c.hasOwnProperty(k)&&this._createAccessor(c[k],b);a.script.data.attributes[f.name]=pc.extend({},c)}break}}},_createAccessor:function(a,b){var c=this;c._convertAttributeValue(a);
Object.defineProperty(b.instance,a.name,{get:function(){return a.value},set:function(d){var e=a.value;a.value=d;c._convertAttributeValue(a);b.instance.fire("set",a.name,e,a.value)},configurable:!0})},_updateAccessors:function(a,b){var c,d=a.script.scripts.length,e,f=b.url,k,m;for(c=0;c<d;c++)if(k=a.script,m=k.scripts[c],m.url===f){c=m.name;m=m.attributes;if(c){if(m)for(e in m)m.hasOwnProperty(e)&&this._createAccessor(m[e],b);if(d=k.data.attributes[c])for(e in d)if(f=d[e],e in m){if(m[e].value!==f.value&&
b.instance.onAttributeChanged)b.instance.onAttributeChanged(f.name,f.value,m[e].value)}else delete b.instance[f.name];m?k.data.attributes[c]=pc.extend([],m):delete k.data.attributes[c]}break}},_convertAttributeValue:function(a){"rgb"===a.type||"rgba"===a.type?"array"===pc.type(a.value)&&(a.value=3===a.value.length?new pc.Color(a.value[0],a.value[1],a.value[2]):new pc.Color(a.value[0],a.value[1],a.value[2],a.value[3])):"vector"===a.type&&"array"===pc.type(a.value)&&(a.value=new pc.Vec3(a.value[0],
a.value[1],a.value[2]))}});return{ScriptComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set_scripts",this.onSetScripts,this)},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{send:function(a,b){console.warn("DEPRECATED: ScriptComponent.send() is deprecated and will be removed soon. Please use: http://developer.playcanvas.com/user-manual/scripting/communication/");var c=pc.makeArray(arguments).slice(2),d=this.entity.script.instances,e;if(d&&d[a]&&(e=d[a].instance[b]))return e.apply(d[a].instance,c)},onEnable:function(){e._super.onEnable.call(this);
this.data.areScriptsLoaded&&(this.data.initialized?this.system._enableScriptComponent(this):this.system._initializeScriptComponent(this),this.data.postInitialized||this.system._postInitializeScriptComponent(this))},onDisable:function(){e._super.onDisable.call(this);this.system._disableScriptComponent(this)},onSetScripts:function(a,b,c){if((!this.system._inTools||this.runInTools)&&!this._updateScriptAttributes(b,c))this.enabled&&this.system._disableScriptComponent(this),this.system._destroyScriptComponent(this),
this.data.areScriptsLoaded=!1,a=c.map(function(a){return a.url}),this._loadFromCache(a)||this._loadScripts(a)},_updateScriptAttributes:function(a,b){var c=!0;if(a.length!==b.length)c=!1;else{var d;len=b.length;for(d=0;d<len;d++)if(a[d].url!==b[d].url){c=!1;break}}if(c)for(var e in this.instances)this.instances.hasOwnProperty(e)&&this.system._updateAccessors(this.entity,this.instances[e]);return c},_loadFromCache:function(a){for(var b=[],c=0,d=a.length;c<d;c++){var e=this.system.app.loader.getFromCache(a[c]);
if(e)b.push(e);else return!1}c=0;for(d=b.length;c<d;c++)if(e=b[c],!0!=e&&e&&this.entity.script&&!this.entity.script.instances[e._pcScriptName]){var f=new e(this.entity);this.system._preRegisterInstance(this.entity,a[c],e._pcScriptName,f)}this.data&&(this.data.areScriptsLoaded=!0);this.system.onInitialize(this.entity);this.system.onPostInitialize(this.entity);return!0},_loadScripts:function(a){var b=a.map(function(a){return new pc.resources.ScriptRequest(a)}),c={parent:this.entity.getRequest()};this.system.app.loader.request(b,
c).then(function(b){b.forEach(function(b,c){if(b&&this.entity.script&&!this.entity.script.instances[b._pcScriptName]){var d=new b(this.entity);this.system._preRegisterInstance(this.entity,a[c],b._pcScriptName,d)}},this);this.data&&(this.data.areScriptsLoaded=!0);c.parent||(this.system.onInitialize(this.entity),this.system.onPostInitialize(this.entity))}.bind(this)).then(null,function(a){setTimeout(function(){throw a;})})}});return{ScriptComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.scripts=[];this.enabled=!0;this.instances={};this._instances={};this.runInTools=!1;this.attributes={};this.areScriptsLoaded=this.postInitialized=this.initialized=!1},pc.ComponentData);return{ScriptComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="pack";a.systems.add(this.id,this);this.ComponentType=pc.PackComponent;this.DataType=pc.PackComponentData;this.schema=[]},e=pc.inherits(e,pc.ComponentSystem);return{PackComponentSystem:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){},pc.Component);return{PackComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){},pc.ComponentData);return{PackComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="pick";a.systems.add(this.id,this);this.ComponentType=pc.PickComponent;this.DataType=pc.PickComponentData;this.schema=[{name:"layer",exposed:!1},{name:"shapes",exposed:!1},{name:"material",exposed:!1}];this.layers={"default":[]};this.display=!1;this.on("remove",this.onRemove,this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){b.material=new pc.PhongMaterial;c=["material"];e._super.initializeComponentData.call(this,
a,b,c)},onRemove:function(a,b){this.deleteShapes(b.layer,b.shapes)},addShape:function(a,b){void 0===this.layers[a]&&(this.layers[a]=[]);this.layers[a].push(b.model);this.display&&this.app.scene.addModel(b.model)},deleteShapes:function(a,b){for(var c=this.layers[a],d=0;d<b.length;d++){var e=b[d].model,f=c.indexOf(e);-1!==f&&c.splice(f,1);this.display&&this.app.scene.removeModel(e)}},getLayerModels:function(a){return this.layers[a]}});return{PickComponentSystem:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){},pc.Component);pc.extend(e.prototype,{addShape:function(a,b){var c=this.data.material,d=null;switch(a.type){case pc.shape.Type.BOX:d=pc.createBox(this.system.app.graphicsDevice,{halfExtents:a.halfExtents});break;case pc.shape.Type.SPHERE:d=pc.createSphere(this.system.app.graphicsDevice,{radius:a.radius});break;case pc.shape.Type.TORUS:d=pc.createTorus(this.system.app.graphicsDevice,{tubeRadius:a.iradius,ringRadius:a.oradius})}var e=new pc.GraphNode,
c=new pc.MeshInstance(e,d,c);c._entity=this.entity;d=new pc.Model;d.graph=e;d.meshInstances=[c];a={shape:a,shapeName:b,model:d};this.data.shapes.push(a);this.system.addShape(this.data.layer,a)},deleteShapes:function(){this.system.deleteShapes(this.data.layer,this.data.shapes);this.data.shapes=[]}});return{PickComponent:e}}());pc.extend(pc,function(){function e(){this.layer="default";this.shapes=[];this.material=null}e=pc.inherits(e,pc.ComponentData);return{PickComponentData:e}}());pc.extend(pc,function(){var e=function(a,b){this.id="audiosource";this.description="Specifies audio assets that can be played at the position of the Entity.";a.systems.add(this.id,this);this.ComponentType=pc.AudioSourceComponent;this.DataType=pc.AudioSourceComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Disabled audiosource components do not play any sounds",type:"boolean",defaultValue:!0},{name:"assets",displayName:"Assets",description:"Audio assets",type:"asset",options:{max:100,
type:"audio"},defaultValue:[]},{name:"volume",displayName:"Volume",description:"The sound volume",type:"number",options:{max:1,min:0,step:0.1},defaultValue:1},{name:"pitch",displayName:"Pitch",description:"The sound pitch",type:"number",defaultValue:1,options:{min:0.01,step:0.01}},{name:"loop",displayName:"Loop",description:"Set whether sound loops or not",type:"boolean",defaultValue:!1},{name:"activate",displayName:"Activate",description:"Play first audio sample when scene loads",type:"boolean",
defaultValue:!0},{name:"3d",displayName:"3d",description:"3d sounds are positioned in space, and their sound is dependent on listener position/orientation. Non-3d sounds are uniform across space",type:"boolean",defaultValue:!0},{name:"minDistance",displayName:"Min Distance",description:"Distance from listener under which the sound is at full volume",type:"number",defaultValue:1,options:{min:0}},{name:"maxDistance",displayName:"Max Distance",description:"Distance from listener over which the sound cannot be heard",
type:"number",defaultValue:1E4,options:{min:0}},{name:"rollOffFactor",displayName:"Roll-off factor",description:"Strength of the roll off",type:"number",defaultValue:1,options:{min:0}},{name:"sources",exposed:!1,readOnly:!0},{name:"currentSource",exposed:!1,readOnly:!0},{name:"channel",exposed:!1,readOnly:!0}];this.exposeProperties();this.manager=b;this.initialized=!1;pc.ComponentSystem.on("initialize",this.onInitialize,this);pc.ComponentSystem.on("update",this.onUpdate,this)},e=pc.inherits(e,pc.ComponentSystem);
pc.extend(e.prototype,{initializeComponentData:function(a,b,c){c="activate volume pitch loop 3d minDistance maxDistance rollOffFactor enabled assets".split(" ");e._super.initializeComponentData.call(this,a,b,c);a.paused=!(a.enabled&&a.activate)},onInitialize:function(a){a.audiosource&&(a.enabled&&a.audiosource.enabled&&a.audiosource.activate)&&a.audiosource.play(a.audiosource.currentSource);var a=a.getChildren(),b,c=a.length;for(b=0;b<c;b++)if(a[b]instanceof pc.Entity)this.onInitialize(a[b]);this.initialized=
!0},onUpdate:function(){var a=this.store,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b],d=c.entity,c=c.data;c.enabled&&(d.enabled&&c.channel instanceof pc.Channel3d)&&(d=d.getPosition(),c.channel.setPosition(d))}},setVolume:function(a){this.manager.setVolume(a)}});return{AudioSourceComponentSystem:e}}());pc.extend(pc,function(){var e=function(){this.on("set_assets",this.onSetAssets,this);this.on("set_loop",this.onSetLoop,this);this.on("set_volume",this.onSetVolume,this);this.on("set_pitch",this.onSetPitch,this);this.on("set_minDistance",this.onSetMinDistance,this);this.on("set_maxDistance",this.onSetMaxDistance,this);this.on("set_rollOffFactor",this.onSetRollOffFactor,this)},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{play:function(a){if(this.enabled&&this.entity.enabled){this.channel&&this.stop();
var b,c=this.data;c.sources[a]&&(c.sources[a].isLoaded?(c["3d"]?(b=this.entity.getPosition(),b=this.system.manager.playSound3d(c.sources[a],b,c)):b=this.system.manager.playSound(c.sources[a],c),c.currentSource=a,c.channel=b):logWARNING(pc.string.format("Audio asset '{0}' is not loaded (probably an unsupported format) and will not be played",a)))}},pause:function(){this.channel&&this.channel.pause()},unpause:function(){this.channel&&this.channel.paused&&this.channel.unpause()},stop:function(){this.channel&&
(this.channel.stop(),this.channel=null)},onSetAssets:function(a,b,c){var a=[],d,e=c.length;if(b&&b.length)for(d=0;d<b.length;d++)if(b[d]){var f=this.system.app.assets.getAssetById(b[d]);f&&(f.off("change",this.onAssetChanged,this),f.off("remove",this.onAssetRemoved,this))}if(e)for(d=0;d<e;d++)0>b.indexOf(c[d])&&a.push(c[d]);!this.system._inTools&&a.length&&this.loadAudioSourceAssets(a)},onAssetChanged:function(a,b,c){"resource"===b&&this.data.sources&&(this.data.sources[a.name]=c,this.data.currentSource===
a.name&&this.channel&&(this.channel.paused?(this.play(a.name),this.pause()):this.play(a.name)))},onAssetRemoved:function(a){a.off("remove",this.onAssetRemoved,this);this.data.sources[a.name]&&(delete this.data.sources[a.name],this.data.currentSource===a.name&&(this.stop(),this.data.currentSource=null))},onSetLoop:function(a,b,c){b!=c&&this.channel&&this.channel.setLoop(c)},onSetVolume:function(a,b,c){b!=c&&this.channel&&this.channel.setVolume(c)},onSetPitch:function(a,b,c){b!=c&&this.channel&&this.channel.setPitch(c)},
onSetMaxDistance:function(a,b,c){b!=c&&this.channel instanceof pc.Channel3d&&this.channel.setMaxDistance(c)},onSetMinDistance:function(a,b,c){b!=c&&this.channel instanceof pc.Channel3d&&this.channel.setMinDistance(c)},onSetRollOffFactor:function(a,b,c){b!=c&&this.channel instanceof pc.Channel3d&&this.channel.setRollOffFactor(c)},onEnable:function(){e._super.onEnable.call(this);this.system.initialized&&(this.data.activate&&!this.channel?this.play(this.currentSource):this.unpause())},onDisable:function(){e._super.onDisable.call(this);
this.pause()},loadAudioSourceAssets:function(a){var b={parent:this.entity.getRequest()},c=[],d=[],e={},f=null;a.map(function(a){return this.system.app.assets.getAssetById(a)},this).forEach(function(b){b?(f=f||b.name,b.off("change",this.onAssetChanged,this),b.on("change",this.onAssetChanged,this),b.off("remove",this.onAssetRemoved,this),b.on("remove",this.onAssetRemoved,this),b.resource?e[b.name]=b.resource:(c.push(new pc.resources.AudioRequest(b.getFileUrl())),d.push(b.name))):logERROR(pc.string.format("Trying to load audiosource component before assets {0} are loaded",
a))}.bind(this));if(c.length)this.system.app.loader.request(c,b).then(function(a){for(var m=0;m<c.length;m++)e[d[m]]=a[m];this.data.sources=e;this.data.currentSource=f;if(!b.parent&&this.enabled&&this.activate&&f)this.onEnable()}.bind(this));else if(this.data.sources=e,this.data.currentSource=f,this.enabled&&this.activate&&f)this.onEnable()}});return{AudioSourceComponent:e}}());pc.AudioSourceComponentData=function(){this.enabled=!0;this.assets=[];this.activate=!0;this.pitch=this.volume=1;this.loop=!1;this["3d"]=!0;this.minDistance=1;this.maxDistance=1E4;this.rollOffFactor=1;this.paused=!0;this.sources={};this.channel=this.currentSource=null};pc.extend(pc,function(){var e=function(a,b){this.id="audiolistener";this.description="Specifies the location of the listener for 3D audio playback.";a.systems.add(this.id,this);this.ComponentType=pc.AudioListenerComponent;this.DataType=pc.AudioListenerComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Disabled audio listener components do not affect audiosources",type:"boolean",defaultValue:!0}];this.exposeProperties();this.manager=b;this.current=null;pc.ComponentSystem.on("update",
this.onUpdate,this)},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){c=["enabled"];e._super.initializeComponentData.call(this,a,b,c)},onUpdate:function(){if(this.current){var a=this.current.getPosition();this.manager.listener.setPosition(a);a=this.current.getWorldTransform();this.manager.listener.setOrientation(a)}}});return{AudioListenerComponentSystem:e}}());pc.extend(pc,function(){var e=function(){},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{setCurrentListener:function(){if(this.enabled&&this.entity.audiolistener&&this.entity.enabled){this.system.current=this.entity;var a=this.system.current.getPosition();this.system.manager.listener.setPosition(a)}},onEnable:function(){e._super.onEnable.call(this);this.setCurrentListener()},onDisable:function(){e._super.onDisable.call(this);this.system.current===this.entity&&(this.system.current=null)}});
return{AudioListenerComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.enabled=!0},pc.ComponentData);return{AudioListenerComponentData:e}}());pc.extend(pc,function(){var e=function(a){a.systems.add("designer",this)},e=pc.inherits(e,pc.ComponentSystem);e.prototype.createComponent=function(a,b){var c=new pc.DesignerComponentData;this.initializeComponent(a,c,b,["fillWindow","width","height"]);return c};return{DesignerComponentSystem:e}}());pc.extend(pc,function(){DesignerComponentData=function(){this.fillWindow=!0;this.width=800;this.height=450};DesignerComponentData=pc.inherits(DesignerComponentData,pc.ComponentData);return{DesignerComponentData:DesignerComponentData}}());pc.extend(pc,{BODYTYPE_STATIC:"static",BODYTYPE_DYNAMIC:"dynamic",BODYTYPE_KINEMATIC:"kinematic",BODYFLAG_STATIC_OBJECT:1,BODYFLAG_KINEMATIC_OBJECT:2,BODYFLAG_NORESPONSE_OBJECT:4,BODYSTATE_ACTIVE_TAG:1,BODYSTATE_ISLAND_SLEEPING:2,BODYSTATE_WANTS_DEACTIVATION:3,BODYSTATE_DISABLE_DEACTIVATION:4,BODYSTATE_DISABLE_SIMULATION:5,BODYGROUP_NONE:0,BODYGROUP_DEFAULT:1,BODYGROUP_DYNAMIC:1,BODYGROUP_STATIC:2,BODYGROUP_KINEMATIC:4,BODYGROUP_ENGINE_1:8,BODYGROUP_TRIGGER:16,BODYGROUP_ENGINE_2:32,BODYGROUP_ENGINE_3:64,
BODYGROUP_USER_1:128,BODYGROUP_USER_2:256,BODYGROUP_USER_3:512,BODYGROUP_USER_4:1024,BODYGROUP_USER_5:2048,BODYGROUP_USER_6:4096,BODYGROUP_USER_7:8192,BODYGROUP_USER_8:16384,BODYMASK_NONE:0,BODYMASK_ALL:65535,BODYMASK_STATIC:2,BODYMASK_NOT_STATIC:65533,BODYMASK_NOT_STATIC_KINEMATIC:65529});pc.extend(pc,function(){new pc.Mat4;new pc.Mat4;new pc.Vec3;new pc.Vec3;new pc.Vec3;var e,a,b={},c={},d=function(a,b,c){this.entity=a;this.point=b;this.normal=c},g=function(a,b,c){0===arguments.length?(this.b=this.a=null,this.localPointA=new pc.Vec3,this.localPointB=new pc.Vec3,this.pointA=new pc.Vec3,this.pointB=new pc.Vec3,this.normal=new pc.Vec3):(this.a=a,this.b=b,this.localPointA=c.localPoint,this.localPointB=c.localPointOther,this.pointA=c.point,this.pointB=c.pointOther,this.normal=c.normal)},
f=function(a,b,c,d,e){0===arguments.length?(this.localPoint=new pc.Vec3,this.localPointOther=new pc.Vec3,this.point=new pc.Vec3,this.pointOther=new pc.Vec3,this.normal=new pc.Vec3):(this.localPoint=a,this.localPointOther=b,this.point=c,this.pointOther=d,this.normal=e)},k=function(a,b){this.other=a;this.contacts=b},m=function(a){this.id="rigidbody";this.description="Adds the entity to the scene's physical simulation.";a.systems.add(this.id,this);this.ComponentType=pc.RigidBodyComponent;this.DataType=
pc.RigidBodyComponentData;this.contactPointPool=new pc.AllocatePool(f,1);this.contactResultPool=new pc.AllocatePool(k,1);this.singleContactResultPool=new pc.AllocatePool(g,1);this.schema=[{name:"enabled",displayName:"Enabled",description:"Enables or disables the rigid body",type:"boolean",defaultValue:!0},{name:"type",displayName:"Type",description:"The type of body determines how it moves and collides with other bodies. Dynamic is a normal body. Static will never move. Kinematic can be moved in code, but will not respond to collisions.",
type:"enumeration",options:{enumerations:[{name:"Static",value:pc.BODYTYPE_STATIC},{name:"Dynamic",value:pc.BODYTYPE_DYNAMIC},{name:"Kinematic",value:pc.BODYTYPE_KINEMATIC}]},defaultValue:pc.BODYTYPE_STATIC},{name:"mass",displayName:"Mass",description:"The mass of the body",type:"number",options:{min:0,step:1},defaultValue:1,filter:{type:[pc.BODYTYPE_DYNAMIC,pc.BODYTYPE_KINEMATIC]}},{name:"linearDamping",displayName:"Linear Damping",description:"The linear damping applied to the body",type:"number",
options:{min:0,step:1},defaultValue:0,filter:{type:[pc.BODYTYPE_DYNAMIC,pc.BODYTYPE_KINEMATIC]}},{name:"angularDamping",displayName:"Angular Damping",description:"The angular damping applied to the body",type:"number",options:{min:0,step:1},defaultValue:0,filter:{type:[pc.BODYTYPE_DYNAMIC,pc.BODYTYPE_KINEMATIC]}},{name:"linearFactor",displayName:"Linear Factor",description:"The linear factor applied to the linear motion of the body, used to contrain linear movement in each axis",type:"vector",options:{min:0,
step:0.1},defaultValue:[1,1,1],filter:{type:[pc.BODYTYPE_DYNAMIC,pc.BODYTYPE_KINEMATIC]}},{name:"angularFactor",displayName:"Angular Factor",description:"The angular factor applied to the angular motion of the body, used to contrain angular movement in each axis",type:"vector",options:{min:0,step:0.1},defaultValue:[1,1,1],filter:{type:[pc.BODYTYPE_DYNAMIC,pc.BODYTYPE_KINEMATIC]}},{name:"friction",displayName:"Friction",description:"The friction when the body slides along another body",type:"number",
options:{min:0,step:0.01},defaultValue:0.5},{name:"restitution",displayName:"Restitution",description:"The restitution determines the elasticity of collisions. 0 means an object does not bounce at all, a value of 1 will be a perfect reflection",type:"number",options:{min:0,step:0.01},defaultValue:0},{name:"group",displayName:"Group",description:"The collision group this rigidbody belongs to",type:"number",defaultValue:pc.BODYGROUP_STATIC,exposed:!1},{name:"mask",displayName:"Mask",description:"The collision mask this rigidbody uses to collide",
type:"number",defaultValue:pc.BODYMASK_NOT_STATIC,exposed:!1},{name:"body",exposed:!1}];this.exposeProperties();this.maxSubSteps=10;this.fixedTimeStep=1/60;this.on("remove",this.onRemove,this);pc.ComponentSystem.on("update",this.onUpdate,this)},m=pc.inherits(m,pc.ComponentSystem);pc.extend(m.prototype,{onLibraryLoaded:function(){if("undefined"!==typeof Ammo){var b=new Ammo.btDefaultCollisionConfiguration,c=new Ammo.btCollisionDispatcher(b),d=new Ammo.btDbvtBroadphase,f=new Ammo.btSequentialImpulseConstraintSolver;
this.dynamicsWorld=new Ammo.btDiscreteDynamicsWorld(c,d,f,b);this._ammoGravity=new Ammo.btVector3(0,-9.82,0);this.dynamicsWorld.setGravity(this._ammoGravity);e=new Ammo.btVector3;a=new Ammo.btVector3}else pc.ComponentSystem.off("update",this.onUpdate,this)},initializeComponentData:function(a,b,c){b.bodyType&&(b.type=b.bodyType,console.warn("WARNING: rigidbody.bodyType: Property is deprecated. Use type instead."));b.linearFactor&&"array"===pc.type(b.linearFactor)&&(b.linearFactor=new pc.Vec3(b.linearFactor[0],
b.linearFactor[1],b.linearFactor[2]));b.angularFactor&&"array"===pc.type(b.angularFactor)&&(b.angularFactor=new pc.Vec3(b.angularFactor[0],b.angularFactor[1],b.angularFactor[2]));c="enabled mass linearDamping angularDamping linearFactor angularFactor friction restitution type group mask".split(" ");m._super.initializeComponentData.call(this,a,b,c)},cloneComponent:function(a,b){this.addComponent(b,{enabled:a.rigidbody.enabled,mass:a.rigidbody.mass,linearDamping:a.rigidbody.linearDamping,angularDamping:a.rigidbody.angularDamping,
linearFactor:[a.rigidbody.linearFactor.x,a.rigidbody.linearFactor.y,a.rigidbody.linearFactor.z],angularFactor:[a.rigidbody.angularFactor.x,a.rigidbody.angularFactor.y,a.rigidbody.angularFactor.z],friction:a.rigidbody.friction,restitution:a.rigidbody.restitution,type:a.rigidbody.type,group:a.rigidbody.group,mask:a.rigidbody.mask})},onRemove:function(a,b){b.body&&(this.removeBody(b.body),Ammo.destroy(b.body));b.body=null},addBody:function(a,b,c){void 0!==b&&void 0!==c?this.dynamicsWorld.addRigidBody(a,
b,c):this.dynamicsWorld.addRigidBody(a);return a},removeBody:function(a){this.dynamicsWorld.removeRigidBody(a)},addConstraint:function(a){this.dynamicsWorld.addConstraint(a);return a},removeConstraint:function(a){this.dynamicsWorld.removeConstraint(a)},setGravity:function(){var a,b,c;1===arguments.length?(a=arguments[0].x,b=arguments[0].y,c=arguments[0].z):(a=arguments[0],b=arguments[1],c=arguments[2]);this._ammoGravity.setValue(a,b,c);this.dynamicsWorld.setGravity(this._ammoGravity)},raycastFirst:function(b,
c,f){e.setValue(b.x,b.y,b.z);a.setValue(c.x,c.y,c.z);b=new Ammo.ClosestRayResultCallback(e,a);this.dynamicsWorld.rayTest(e,a,b);if(b.hasHit()){var c=b.get_m_collisionObject(),c=Ammo.castObject(c,Ammo.btRigidBody),g=b.get_m_hitPointWorld(),k=b.get_m_hitNormalWorld();c&&f(new d(c.entity,new pc.Vec3(g.x(),g.y(),g.z()),new pc.Vec3(k.x(),k.y(),k.z())))}Ammo.destroy(b)},_storeCollision:function(a,d){var e=!1,f=a.getGuid();b[f]=b[f]||{others:[],entity:a};0>b[f].others.indexOf(d)&&(b[f].others.push(d),e=
!0);c[f]=c[f]||{others:[],entity:a};c[f].others.push(d);return e},_createContactPointFromAmmo:function(a){var b=this.contactPointPool.allocate();b.localPoint.set(a.get_m_localPointA().x(),a.get_m_localPointA().y(),a.get_m_localPointA().z());b.localPointOther.set(a.get_m_localPointB().x(),a.get_m_localPointB().y(),a.get_m_localPointB().z());b.point.set(a.getPositionWorldOnA().x(),a.getPositionWorldOnA().y(),a.getPositionWorldOnA().z());b.pointOther.set(a.getPositionWorldOnB().x(),a.getPositionWorldOnB().y(),
a.getPositionWorldOnB().z());b.normal.set(a.get_m_normalWorldOnB().x(),a.get_m_normalWorldOnB().y(),a.get_m_normalWorldOnB().z());return b},_createReverseContactPointFromAmmo:function(a){var b=this.contactPointPool.allocate();b.localPointOther.set(a.get_m_localPointA().x(),a.get_m_localPointA().y(),a.get_m_localPointA().z());b.localPoint.set(a.get_m_localPointB().x(),a.get_m_localPointB().y(),a.get_m_localPointB().z());b.pointOther.set(a.getPositionWorldOnA().x(),a.getPositionWorldOnA().y(),a.getPositionWorldOnA().z());
b.point.set(a.getPositionWorldOnB().x(),a.getPositionWorldOnB().y(),a.getPositionWorldOnB().z());b.normal.set(a.get_m_normalWorldOnB().x(),a.get_m_normalWorldOnB().y(),a.get_m_normalWorldOnB().z());return b},_createSingleContactResult:function(a,b,c){var d=this.singleContactResultPool.allocate();d.a=a;d.b=b;d.localPointA=c.localPoint;d.localPointB=c.localPointOther;d.pointA=c.point;d.pointB=c.pointOther;d.normal=c.normal;return d},_createContactResult:function(a,b){var c=this.contactResultPool.allocate();
c.other=a;c.contacts=b;return c},_cleanOldCollisions:function(){for(var a in b)if(b.hasOwnProperty(a)){for(var d=b[a].entity,e=d.collision,f=b[a].others,g=f.length;g--;){var k=f[g];if(!c[a]||0>c[a].others.indexOf(k))f.splice(g,1),e&&k.collision&&(d.rigidbody&&k.rigidbody?e.fire("collisionend",k):d.trigger&&e.fire("triggerleave",k))}0===f.length&&delete b[a]}},onUpdate:function(a){frameContacts=0;this.dynamicsWorld.stepSimulation(a,this.maxSubSteps,this.fixedTimeStep);var b=this.store,d;for(d in b)if(b.hasOwnProperty(d)){var e=
b[d].entity,f=b[d].data;f.body&&(f.body.isActive()&&f.enabled&&e.enabled)&&(f.type===pc.BODYTYPE_DYNAMIC?e.rigidbody.syncBodyToEntity():f.type===pc.BODYTYPE_KINEMATIC&&e.rigidbody._updateKinematic(a))}var a=this.dynamicsWorld.getDispatcher(),b=a.getNumManifolds(),g;c={};for(d=0;d<b;d++){var k=a.getManifoldByIndexInternal(d),m=k.getBody0(),u=k.getBody1(),e=Ammo.castObject(m,Ammo.btRigidBody),f=Ammo.castObject(u,Ammo.btRigidBody),e=e.entity,f=f.entity;if(e&&f){g=m.getCollisionFlags();var w=u.getCollisionFlags(),
B=k.getNumContacts(),y=[],u=[];if(0<B)if(g&pc.BODYFLAG_NORESPONSE_OBJECT||w&pc.BODYFLAG_NORESPONSE_OBJECT){var A=e.collision?e.collision.hasEvent("triggerenter")||e.collision.hasEvent("triggerleave"):!1,m=f.collision?f.collision.hasEvent("triggerenter")||f.collision.hasEvent("triggerleave"):!1;A&&(k=this._storeCollision(e,f))&&e.collision&&!(w&pc.BODYFLAG_NORESPONSE_OBJECT)&&e.collision.fire("triggerenter",f);m&&(k=this._storeCollision(f,e))&&f.collision&&!(g&pc.BODYFLAG_NORESPONSE_OBJECT)&&f.collision.fire("triggerenter",
e)}else if(A=e.collision?e.collision.hasEvent("collisionstart")||e.collision.hasEvent("collisionend")||e.collision.hasEvent("contact"):!1,m=f.collision?f.collision.hasEvent("collisionstart")||f.collision.hasEvent("collisionend")||f.collision.hasEvent("contact"):!1,(w=this.hasEvent("contact"))||A||m){for(g=0;g<B;g++){var F=k.getContactPoint(g),J=this._createContactPointFromAmmo(F),N=null;if(A||m)N=this._createReverseContactPointFromAmmo(F),y.push(J),u.push(N);w&&(F=this._createSingleContactResult(e,
f,J),this.fire("contact",F))}A&&(B=this._createContactResult(f,y),e.collision&&e.collision.fire("contact",B),(k=this._storeCollision(e,f))&&e.collision&&e.collision.fire("collisionstart",B));m&&(u=this._createContactResult(e,u),f.collision&&f.collision.fire("contact",u),(k=this._storeCollision(f,e))&&f.collision&&f.collision.fire("collisionstart",u))}}}this._cleanOldCollisions();this.contactPointPool.freeAll();this.contactResultPool.freeAll();this.singleContactResultPool.freeAll()}});return{RIGIDBODY_TYPE_STATIC:"static",
RIGIDBODY_TYPE_DYNAMIC:"dynamic",RIGIDBODY_TYPE_KINEMATIC:"kinematic",RIGIDBODY_CF_STATIC_OBJECT:1,RIGIDBODY_CF_KINEMATIC_OBJECT:2,RIGIDBODY_CF_NORESPONSE_OBJECT:4,RIGIDBODY_ACTIVE_TAG:1,RIGIDBODY_ISLAND_SLEEPING:2,RIGIDBODY_WANTS_DEACTIVATION:3,RIGIDBODY_DISABLE_DEACTIVATION:4,RIGIDBODY_DISABLE_SIMULATION:5,RigidBodyComponentSystem:m}}());pc.extend(pc,function(){var e,a,b,c,d,g=function(f,g){"undefined"!==typeof Ammo&&!e&&(e=new Ammo.btTransform,a=new Ammo.btVector3,b=new Ammo.btVector3,c=new Ammo.btQuaternion,d=new Ammo.btVector3(0,0,0));this.on("set_mass",this.onSetMass,this);this.on("set_linearDamping",this.onSetLinearDamping,this);this.on("set_angularDamping",this.onSetAngularDamping,this);this.on("set_linearFactor",this.onSetLinearFactor,this);this.on("set_angularFactor",this.onSetAngularFactor,this);this.on("set_friction",this.onSetFriction,
this);this.on("set_restitution",this.onSetRestitution,this);this.on("set_type",this.onSetType,this);this.on("set_group",this.onSetGroupOrMask,this);this.on("set_mask",this.onSetGroupOrMask,this);this.on("set_body",this.onSetBody,this);g.on("livelink:updatetransform",this.onLiveLinkUpdateTransform,this);this.system.on("beforeremove",this.onBeforeRemove,this);this._displacement=new pc.Vec3(0,0,0);this._linearVelocity=new pc.Vec3(0,0,0);this._angularVelocity=new pc.Vec3(0,0,0)},g=pc.inherits(g,pc.Component);
Object.defineProperty(g.prototype,"bodyType",{get:function(){console.warn("WARNING: bodyType: Function is deprecated. Query type property instead.");return this.type},set:function(a){console.warn("WARNING: bodyType: Function is deprecated. Set type property instead.");this.type=a}});Object.defineProperty(g.prototype,"linearVelocity",{get:function(){if(this.isKinematic())return this._linearVelocity;if(this.body){var a=this.body.getLinearVelocity();this._linearVelocity.set(a.x(),a.y(),a.z());return this._linearVelocity}},
set:function(b){this.activate();if(this.isKinematic())this._linearVelocity.copy(b);else{var c=this.body;c&&(a.setValue(b.x,b.y,b.z),c.setLinearVelocity(a))}}});Object.defineProperty(g.prototype,"angularVelocity",{get:function(){if(this.isKinematic())return this._angularVelocity;if(this.body){var a=this.body.getAngularVelocity();this._angularVelocity.set(a.x(),a.y(),a.z());return this._angularVelocity}},set:function(b){this.activate();if(this.isKinematic())this._angularVelocity.copy(b);else{var c=
this.body;c&&(a.setValue(b.x,b.y,b.z),c.setAngularVelocity(a))}}});pc.extend(g.prototype,{createBody:function(){var b=this.entity,d;b.collision&&(d=b.collision.shape,b.trigger&&(b.trigger.destroy(),delete b.trigger));if(d){this.body&&(this.system.removeBody(this.body),Ammo.destroy(this.body));var e=this.isStaticOrKinematic(),g=e?0:this.mass,n=new Ammo.btVector3(0,0,0);e||d.calculateLocalInertia(g,n);var e=b.getPosition(),l=b.getRotation();c.setValue(l.x,l.y,l.z,l.w);l=new Ammo.btTransform;l.setIdentity();
l.getOrigin().setValue(e.x,e.y,e.z);l.setRotation(c);e=new Ammo.btDefaultMotionState(l);d=new Ammo.btRigidBodyConstructionInfo(g,e,d,n);d=new Ammo.btRigidBody(d);d.setRestitution(this.restitution);d.setFriction(this.friction);d.setDamping(this.linearDamping,this.angularDamping);g=this.linearFactor;a.setValue(g.x,g.y,g.z);d.setLinearFactor(a);g=this.angularFactor;a.setValue(g.x,g.y,g.z);d.setAngularFactor(a);d.entity=b;this.isKinematic()&&(d.setCollisionFlags(d.getCollisionFlags()|pc.BODYFLAG_KINEMATIC_OBJECT),
d.setActivationState(pc.BODYSTATE_DISABLE_DEACTIVATION));b.rigidbody.body=d;this.enabled&&this.entity.enabled&&this.enableSimulation()}},isActive:function(){return this.body?this.body.isActive():!1},activate:function(){this.body&&this.body.activate()},enableSimulation:function(){if(this.entity.collision&&this.entity.collision.enabled&&!this.data.simulationEnabled){var a=this.body;a&&(this.system.addBody(a,this.group,this.mask),this.isKinematic()?(a.forceActivationState(pc.BODYSTATE_DISABLE_DEACTIVATION),
a.activate()):(a.forceActivationState(pc.BODYFLAG_ACTIVE_TAG),this.syncEntityToBody()),this.data.simulationEnabled=!0)}},disableSimulation:function(){var a=this.body;a&&this.data.simulationEnabled&&(this.system.removeBody(a),a.forceActivationState(pc.BODYSTATE_DISABLE_SIMULATION),this.data.simulationEnabled=!1)},applyForce:function(){var c,e,g,h,n,l;switch(arguments.length){case 1:c=arguments[0].x;e=arguments[0].y;g=arguments[0].z;break;case 2:c=arguments[0].x;e=arguments[0].y;g=arguments[0].z;h=
arguments[1].x;n=arguments[1].y;l=arguments[1].z;break;case 3:c=arguments[0];e=arguments[1];g=arguments[2];break;case 6:c=arguments[0],e=arguments[1],g=arguments[2],h=arguments[3],n=arguments[4],l=arguments[5]}var r=this.body;r&&(r.activate(),a.setValue(c,e,g),void 0!==h?(b.setValue(h,n,l),r.applyForce(a,b)):r.applyForce(a,d))},applyTorque:function(){var b,c,d;switch(arguments.length){case 1:b=arguments[0].x;c=arguments[0].y;d=arguments[0].z;break;case 3:b=arguments[0];c=arguments[1];d=arguments[2];
break;default:console.error("ERROR: applyTorque: function takes 1 or 3 arguments");return}var e=this.body;e&&(e.activate(),a.setValue(b,c,d),e.applyTorque(a))},applyImpulse:function(){var c,e,g,h,n,l;switch(arguments.length){case 1:c=arguments[0].x;e=arguments[0].y;g=arguments[0].z;break;case 2:c=arguments[0].x;e=arguments[0].y;g=arguments[0].z;h=arguments[1].x;n=arguments[1].y;l=arguments[1].z;break;case 3:c=arguments[0];e=arguments[1];g=arguments[2];break;case 6:c=arguments[0],e=arguments[1],g=
arguments[2],h=arguments[0],n=arguments[1],l=arguments[2]}var r=this.body;r&&(r.activate(),a.setValue(c,e,g),void 0!==h?(b.setValue(h,n,l),r.applyImpulse(a,b)):r.applyImpulse(a,d))},applyTorqueImpulse:function(){var b,c,d;switch(arguments.length){case 1:b=arguments[0].x;c=arguments[0].y;d=arguments[0].z;break;case 3:b=arguments[0];c=arguments[1];d=arguments[2];break;default:console.error("ERROR: applyTorqueImpulse: function takes 1 or 3 arguments");return}var e=this.body;e&&(e.activate(),a.setValue(b,
c,d),e.applyTorqueImpulse(a))},isStatic:function(){return this.type===pc.BODYTYPE_STATIC},isStaticOrKinematic:function(){return this.type===pc.BODYTYPE_STATIC||this.type===pc.BODYTYPE_KINEMATIC},isKinematic:function(){return this.type===pc.BODYTYPE_KINEMATIC},syncEntityToBody:function(){var a=this.body;if(a){var b=this.entity.getPosition(),d=this.entity.getRotation(),e=a.getWorldTransform();e.getOrigin().setValue(b.x,b.y,b.z);c.setValue(d.x,d.y,d.z,d.w);e.setRotation(c);a.activate()}},syncBodyToEntity:function(){var a=
this.body;if(a.isActive()&&(a=a.getMotionState())){a.getWorldTransform(e);var a=e.getOrigin(),b=e.getRotation();this.entity.setPosition(a.x(),a.y(),a.z());this.entity.setRotation(b.x(),b.y(),b.z(),b.w())}},teleport:function(){3>arguments.length?(arguments[0]&&this.entity.setPosition(arguments[0]),arguments[1]&&(arguments[1]instanceof pc.Quat?this.entity.setRotation(arguments[1]):this.entity.setEulerAngles(arguments[1]))):(6===arguments.length&&this.entity.setEulerAngles(arguments[3],arguments[4],
arguments[5]),this.entity.setPosition(arguments[0],arguments[1],arguments[2]));this.syncEntityToBody()},_updateKinematic:function(a){this._displacement.copy(this._linearVelocity).scale(a);this.entity.translate(this._displacement);this._displacement.copy(this._angularVelocity).scale(a);this.entity.rotate(this._displacement.x,this._displacement.y,this._displacement.z);if(this.body.getMotionState()){var a=this.entity.getPosition(),b=this.entity.getRotation();e.getOrigin().setValue(a.x,a.y,a.z);c.setValue(b.x,
b.y,b.z,b.w);e.setRotation(c);this.body.getMotionState().setWorldTransform(e)}},onEnable:function(){g._super.onEnable.call(this);this.body||this.createBody();this.enableSimulation()},onDisable:function(){g._super.onDisable.call(this);this.disableSimulation()},onSetMass:function(a,b,c){if(a=this.data.body){(b=this.enabled&&this.entity.enabled)&&this.disableSimulation();var d=new Ammo.btVector3(0,0,0);a.getCollisionShape().calculateLocalInertia(c,d);a.setMassProps(c,d);a.updateInertiaTensor();b&&this.enableSimulation()}},
onSetLinearDamping:function(a,b,c){(a=this.data.body)&&a.setDamping(c,this.data.angularDamping)},onSetAngularDamping:function(a,b,c){(a=this.data.body)&&a.setDamping(this.data.linearDamping,c)},onSetLinearFactor:function(b,c,d){if(b=this.data.body)a.setValue(d.x,d.y,d.z),b.setLinearFactor(a)},onSetAngularFactor:function(b,c,d){if(b=this.data.body)a.setValue(d.x,d.y,d.z),b.setAngularFactor(a)},onSetFriction:function(a,b,c){(a=this.data.body)&&a.setFriction(c)},onSetRestitution:function(a,b,c){(a=this.data.body)&&
a.setRestitution(c)},onSetType:function(a,b,c){c!==b&&(this.disableSimulation(),c===pc.BODYTYPE_DYNAMIC?(this.data.group=pc.BODYGROUP_DYNAMIC,this.data.mask=pc.BODYMASK_ALL):c===pc.BODYTYPE_KINEMATIC?(this.data.group=pc.BODYGROUP_KINEMATIC,this.data.mask=pc.BODYMASK_ALL):(this.data.group=pc.BODYGROUP_STATIC,this.data.mask=pc.BODYMASK_NOT_STATIC),this.createBody())},onSetGroupOrMask:function(a,b,c){c!==b&&(this.enabled&&this.entity.enabled)&&(this.disableSimulation(),this.enableSimulation())},onSetBody:function(){this.body&&
this.data.simulationEnabled&&this.body.activate()},onLiveLinkUpdateTransform:function(){this.syncEntityToBody();this.angularVelocity=this.linearVelocity=pc.Vec3.ZERO},onBeforeRemove:function(a,b){this===b&&(a.off("livelink:updatetransform",this.onLiveLinkUpdateTransform,this),this.system.off("beforeremove",this.onBeforeRemove,this))}});return{RigidBodyComponent:g}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.enabled=!0;this.mass=1;this.angularDamping=this.linearDamping=0;this.linearFactor=new pc.Vec3(1,1,1);this.angularFactor=new pc.Vec3(1,1,1);this.friction=0.5;this.restitution=0;this.type=pc.BODYTYPE_STATIC;this.group=pc.BODYGROUP_STATIC;this.mask=pc.BODYMASK_NOT_STATIC;this.body=null;this.simulationEnabled=!1},pc.ComponentData);return{RigidBodyComponentData:e}}());pc.extend(pc,function(){var e,a,b=function(b,d,g){this.entity=d.entity;this.component=d;this.app=b;"undefined"!==typeof Ammo&&(e=new Ammo.btVector3,a=new Ammo.btQuaternion);this.initialize(g)};b.prototype={initialize:function(b){var d=this.entity;if((b=b.shape)&&"undefined"!==typeof Ammo){d.trigger&&d.trigger.destroy();var g=new Ammo.btVector3(0,0,0);b.calculateLocalInertia(1,g);var f=d.getPosition(),k=d.getRotation();a.setValue(k.x,k.y,k.z,k.w);k=new Ammo.btTransform;k.setIdentity();k.getOrigin().setValue(f.x,
f.y,f.z);k.setRotation(a);f=new Ammo.btDefaultMotionState(k);b=new Ammo.btRigidBodyConstructionInfo(1,f,b,g);this.body=b=new Ammo.btRigidBody(b);b.setRestitution(0);b.setFriction(0);b.setDamping(0,0);e.setValue(0,0,0);b.setLinearFactor(e);b.setAngularFactor(e);b.setCollisionFlags(b.getCollisionFlags()|pc.BODYFLAG_NORESPONSE_OBJECT);b.entity=d;this.component.enabled&&d.enabled&&this.enable()}},destroy:function(){this.body&&this.app.systems.rigidbody.removeBody(this.body)},syncEntityToBody:function(){var b=
this.body;if(b){var d=this.entity.getPosition(),e=this.entity.getRotation(),f=b.getWorldTransform();f.getOrigin().setValue(d.x,d.y,d.z);a.setValue(e.x,e.y,e.z,e.w);f.setRotation(a);b.activate()}},enable:function(){var a=this.body;this.app.systems.rigidbody.addBody(a,pc.BODYGROUP_TRIGGER,pc.BODYMASK_NOT_STATIC^pc.BODYGROUP_TRIGGER);a.forceActivationState(pc.BODYSTATE_ACTIVE_TAG);a.activate()},disable:function(){var a=this.body;this.app.systems.rigidbody.removeBody(a);a.forceActivationState(pc.BODYSTATE_DISABLE_SIMULATION)}};
return{Trigger:b}}());pc.extend(pc,function(){var e=function(a){this.id="collision";this.description="Specifies a collision volume.";a.systems.add(this.id,this);this.ComponentType=pc.CollisionComponent;this.DataType=pc.CollisionComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enables or disables the collision",type:"boolean",defaultValue:!0},{name:"type",displayName:"Type",description:"The type of the collision volume",type:"enumeration",options:{enumerations:[{name:"Box",value:"box"},{name:"Sphere",
value:"sphere"},{name:"Capsule",value:"capsule"},{name:"Cylinder",value:"cylinder"},{name:"Mesh",value:"mesh"}]},defaultValue:"box"},{name:"halfExtents",displayName:"Half Extents",description:"The half-extents of the box",type:"vector",options:{min:0,step:0.1},defaultValue:[0.5,0.5,0.5],filter:{type:"box"}},{name:"radius",displayName:"Radius",description:"The radius of the collision volume",type:"number",options:{min:0,step:0.1},defaultValue:0.5,filter:{type:["sphere","capsule","cylinder"]}},{name:"axis",
displayName:"Axis",description:"Major axis of the volume",type:"enumeration",options:{enumerations:[{name:"X",value:0},{name:"Y",value:1},{name:"Z",value:2}]},defaultValue:1,filter:{type:["capsule","cylinder"]}},{name:"height",displayName:"Height",description:"Height of the volume",type:"number",options:{min:0,step:0.1},defaultValue:2,filter:{type:["capsule","cylinder"]}},{name:"asset",displayName:"Asset",description:"Collision mesh asset",type:"asset",options:{max:1,type:"model"},defaultValue:null,
filter:{type:"mesh"}},{name:"shape",exposed:!1},{name:"model",exposed:!1}];this.exposeProperties();this.implementations={};this.debugRender=!1;this.on("remove",this.onRemove,this);pc.ComponentSystem.on("update",this.onUpdate,this);pc.ComponentSystem.on("toolsUpdate",this.onToolsUpdate,this)},e=pc.inherits(e,pc.ComponentSystem);e.prototype=pc.extend(e.prototype,{onLibraryLoaded:function(){"undefined"===typeof Ammo&&pc.ComponentSystem.off("update",this.onUpdate,this)},initializeComponentData:function(a,
b,c){b.type||(b.type=a.data.type);a.data.type=b.type;b.halfExtents&&"array"===pc.type(b.halfExtents)&&(b.halfExtents=new pc.Vec3(b.halfExtents[0],b.halfExtents[1],b.halfExtents[2]));var d=this._createImplementation(b.type);d.beforeInitialize(a,b);c="type halfExtents radius axis height shape model asset enabled".split(" ");e._super.initializeComponentData.call(this.system,a,b,c);d.afterInitialize(a,b)},_createImplementation:function(a){if(void 0===this.implementations[a]){var b;switch(a){case "box":b=
new CollisionBoxSystemImpl(this);break;case "sphere":b=new CollisionSphereSystemImpl(this);break;case "capsule":b=new CollisionCapsuleSystemImpl(this);break;case "cylinder":b=new CollisionCylinderSystemImpl(this);break;case "mesh":b=new CollisionMeshSystemImpl(this);break;default:throw"Invalid collision system type: "+a;}this.implementations[a]=b}return this.implementations[a]},_getImplementation:function(a){return this.implementations[a.collision.data.type]},cloneComponent:function(a,b){return this._getImplementation(a).clone(a,
b)},onRemove:function(a,b){this.implementations[b.type].remove(a,b)},onUpdate:function(){var a,b,c,d=this.store;for(a in d)b=d[a].entity,c=d[a].data,c.enabled&&b.enabled&&!b.rigidbody&&b.trigger&&b.trigger.syncEntityToBody(),this.debugRender&&this.updateDebugShape(b,c,this._getImplementation(b))},updateDebugShape:function(a,b,c){var d=this.app;if(void 0!==c&&c.hasDebugShape){if(b.model)if(d.scene.containsModel(b.model)){if(!b.enabled||!a.enabled)d.root.removeChild(b.model.graph),d.scene.removeModel(b.model)}else a.enabled&&
b.enabled&&(d.scene.addModel(b.model),d.root.addChild(b.model.graph));b.enabled&&a.enabled&&c.updateDebugShape(a,b)}},onTransformChanged:function(a,b,c,d){this.implementations[a.data.type].updateTransform(a,b,c,d)},onToolsUpdate:function(){var a,b,c=this.store;for(a in c)b=c[a].entity,this.updateDebugShape(b,c[a].data,this._getImplementation(b))},setDebugRender:function(a){this.debugRender=a},changeType:function(a,b,c){this.implementations[b].remove(a.entity,a.data);this._createImplementation(c).reset(a,
a.data)},recreatePhysicalShapes:function(a){this.implementations[a.data.type].recreatePhysicalShapes(a)}});CollisionSystemImpl=function(a){this.system=a;this.hasDebugShape=!0};CollisionSystemImpl.prototype={beforeInitialize:function(a,b){b.shape=this.createPhysicalShape(a.entity,b);b.model=new pc.Model;b.model.graph=new pc.GraphNode;b.model.meshInstances=[this.createDebugMesh(b)]},afterInitialize:function(a){this.recreatePhysicalShapes(a);a.data.initialized=!0},reset:function(a,b){this.beforeInitialize(a,
b);this.afterInitialize(a,b)},recreatePhysicalShapes:function(a){var b=a.entity,c=a.data;"undefined"!==typeof Ammo&&(c.shape=this.createPhysicalShape(a.entity,c),b.rigidbody?(b.rigidbody.disableSimulation(),b.rigidbody.createBody()):b.trigger?b.trigger.initialize(c):b.trigger=new pc.Trigger(this.system.app,a,c))},createDebugMesh:function(){},createPhysicalShape:function(){},updateDebugShape:function(){},updateTransform:function(a){a.entity.trigger&&a.entity.trigger.syncEntityToBody()},remove:function(a,
b){var c=this.system.app;a.rigidbody&&a.rigidbody.body&&c.systems.rigidbody.removeBody(a.rigidbody.body);a.trigger&&(a.trigger.destroy(),delete a.trigger);c.scene.containsModel(b.model)&&(c.root.removeChild(b.model.graph),c.scene.removeModel(b.model))},clone:function(a,b){var c=this.system.dataStore[a.getGuid()];return this.system.addComponent(b,{enabled:c.data.enabled,type:c.data.type,halfExtents:[c.data.halfExtents.x,c.data.halfExtents.y,c.data.halfExtents.z],radius:c.data.radius,axis:c.data.axis,
height:c.data.height,asset:c.data.asset,model:c.data.model})}};CollisionBoxSystemImpl=function(){};CollisionBoxSystemImpl=pc.inherits(CollisionBoxSystemImpl,CollisionSystemImpl);CollisionBoxSystemImpl.prototype=pc.extend(CollisionBoxSystemImpl.prototype,{createDebugMesh:function(a){if(!this.mesh){var b=this.system.app.graphicsDevice,c=new pc.VertexFormat(b,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),c=new pc.VertexBuffer(b,c,8);(new Float32Array(c.lock())).set([-0.5,
-0.5,-0.5,-0.5,-0.5,0.5,0.5,-0.5,0.5,0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5]);c.unlock();b=new pc.IndexBuffer(b,pc.INDEXFORMAT_UINT8,24);(new Uint8Array(b.lock())).set([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);b.unlock();var d=new pc.Mesh;d.vertexBuffer=c;d.indexBuffer[0]=b;d.primitive[0].type=pc.PRIMITIVE_LINES;d.primitive[0].base=0;d.primitive[0].count=b.getNumIndices();d.primitive[0].indexed=!0;this.mesh=d}this.material||(c=new pc.BasicMaterial,c.color=new pc.Color(0,
0,1,1),c.update(),this.material=c);return new pc.MeshInstance(a.model.graph,this.mesh,this.material)},createPhysicalShape:function(a,b){if("undefined"!==typeof Ammo){var c=b.halfExtents,c=new Ammo.btVector3(c.x,c.y,c.z);return new Ammo.btBoxShape(c)}},updateDebugShape:function(a,b){var c=b.halfExtents,d=c.x,e=c.y,c=c.z,f=b.model.graph;f.setPosition(a.getPosition());f.setRotation(a.getRotation());f.setLocalScale(2*d,2*e,2*c)}});CollisionSphereSystemImpl=function(){};CollisionSphereSystemImpl=pc.inherits(CollisionSphereSystemImpl,
CollisionSystemImpl);CollisionSphereSystemImpl.prototype=pc.extend(CollisionSphereSystemImpl.prototype,{createDebugMesh:function(a){if(!this.mesh){for(var b=this.system.app.graphicsDevice,c=new pc.VertexFormat(b,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),b=new pc.VertexBuffer(b,c,240),c=new Float32Array(b.lock()),d,e=0,f,k=0;3>k;k++){var m=0,h=1,n=2;1===k?(m=1,h=0,n=2):2===k&&(m=0,h=2,n=1);for(d=0;40>d;d++)f=2*Math.PI*(d/40),c[e+m]=0.5*Math.cos(f),c[e+h]=0,c[e+n]=
0.5*Math.sin(f),e+=3,f=2*Math.PI*((d+1)/40),c[e+m]=0.5*Math.cos(f),c[e+h]=0,c[e+n]=0.5*Math.sin(f),e+=3}b.unlock();c=new pc.Mesh;c.vertexBuffer=b;c.primitive[0].type=pc.PRIMITIVE_LINES;c.primitive[0].base=0;c.primitive[0].count=b.getNumVertices();c.primitive[0].indexed=!1;this.mesh=c}this.material||(b=new pc.BasicMaterial,b.color=new pc.Color(0,0,1,1),b.update(),this.material=b);return new pc.MeshInstance(a.model.graph,this.mesh,this.material)},createPhysicalShape:function(a,b){if("undefined"!==typeof Ammo)return new Ammo.btSphereShape(b.radius)},
updateDebugShape:function(a,b){var c=b.model.graph;c.setPosition(a.getPosition());c.setRotation(a.getRotation());var d=2*b.radius;c.setLocalScale(d,d,d)}});CollisionCapsuleSystemImpl=function(){};CollisionCapsuleSystemImpl=pc.inherits(CollisionCapsuleSystemImpl,CollisionSystemImpl);CollisionCapsuleSystemImpl.prototype=pc.extend(CollisionCapsuleSystemImpl.prototype,{createDebugMesh:function(a){if(a.model&&a.model.meshInstances&&a.model.meshInstances.length)return a.model.meshInstances[0];var b=this.system.app.graphicsDevice,
c=new pc.VertexFormat(b,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),c=new pc.VertexBuffer(b,c,328,pc.BUFFER_DYNAMIC);this.updateCapsuleShape(a,c);b=new pc.Mesh;b.vertexBuffer=c;b.primitive[0].type=pc.PRIMITIVE_LINES;b.primitive[0].base=0;b.primitive[0].count=c.getNumVertices();b.primitive[0].indexed=!1;this.mesh=b;this.material||(c=new pc.BasicMaterial,c.color=new pc.Color(0,0,1,1),c.update(),this.material=c);return new pc.MeshInstance(a.model.graph,b,this.material)},
updateCapsuleShape:function(a,b){var c=void 0!==a.axis?a.axis:1,d=a.radius||0.5,e=Math.max((a.height||2)-2*d,0),f=new Float32Array(b.lock()),k=0,m=1,h=2;0===c?(k=1,m=0,h=2):2===c&&(k=0,m=2,h=1);var n=0,l;for(cap=-1;2>cap;cap+=2){for(c=0;40>c;c++)l=2*Math.PI*(c/40),f[n+k]=d*Math.cos(l),f[n+m]=0.5*cap*e,f[n+h]=d*Math.sin(l),n+=3,l=2*Math.PI*((c+1)/40),f[n+k]=d*Math.cos(l),f[n+m]=0.5*cap*e,f[n+h]=d*Math.sin(l),n+=3;for(c=0;20>c;c++)l=Math.PI*(c/20)+1.5*Math.PI,f[n+k]=0,f[n+m]=cap*(0.5*e+d*Math.cos(l)),
f[n+h]=cap*d*Math.sin(l),n+=3,l=Math.PI*((c+1)/20)+1.5*Math.PI,f[n+k]=0,f[n+m]=cap*(0.5*e+d*Math.cos(l)),f[n+h]=cap*d*Math.sin(l),n+=3;for(c=0;20>c;c++)l=Math.PI*(c/20)+1.5*Math.PI,f[n+k]=cap*d*Math.sin(l),f[n+m]=cap*(0.5*e+d*Math.cos(l)),f[n+h]=0,n+=3,l=Math.PI*((c+1)/20)+1.5*Math.PI,f[n+k]=cap*d*Math.sin(l),f[n+m]=cap*(0.5*e+d*Math.cos(l)),f[n+h]=0,n+=3}for(c=0;4>c;c++)l=2*Math.PI*(c/4),f[n+k]=d*Math.cos(l),f[n+m]=0.5*e,f[n+h]=d*Math.sin(l),n+=3,l=2*Math.PI*(c/4),f[n+k]=d*Math.cos(l),f[n+m]=0.5*
-e,f[n+h]=d*Math.sin(l),n+=3;b.unlock()},createPhysicalShape:function(a,b){var c=null,d=void 0!==b.axis?b.axis:1,e=b.radius||0.5,f=Math.max((b.height||2)-2*e,0);if("undefined"!==typeof Ammo)switch(d){case 0:c=new Ammo.btCapsuleShapeX(e,f);break;case 1:c=new Ammo.btCapsuleShape(e,f);break;case 2:c=new Ammo.btCapsuleShapeZ(e,f)}return c},updateDebugShape:function(a,b){var c=b.model.graph;c.setPosition(a.getPosition());c.setRotation(a.getRotation());c.setLocalScale(1,1,1)},recreatePhysicalShapes:function(a){if(a.data.model){var b=
this.createDebugMesh(a.data).mesh.vertexBuffer;this.updateCapsuleShape(a.data,b);CollisionCapsuleSystemImpl._super.recreatePhysicalShapes.call(this,a)}}});CollisionCylinderSystemImpl=function(){};CollisionCylinderSystemImpl=pc.inherits(CollisionCylinderSystemImpl,CollisionSystemImpl);CollisionCylinderSystemImpl.prototype=pc.extend(CollisionCylinderSystemImpl.prototype,{createDebugMesh:function(a){if(a.model&&a.model.meshInstances&&a.model.meshInstances.length)return a.model.meshInstances[0];var b=
this.system.app.graphicsDevice,c=new pc.VertexFormat(b,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),c=new pc.VertexBuffer(b,c,168,pc.BUFFER_DYNAMIC);this.updateCylinderShape(a,c);b=new pc.Mesh;b.vertexBuffer=c;b.primitive[0].type=pc.PRIMITIVE_LINES;b.primitive[0].base=0;b.primitive[0].count=c.getNumVertices();b.primitive[0].indexed=!1;this.material||(c=new pc.BasicMaterial,c.color=new pc.Color(0,0,1,1),c.update(),this.material=c);return new pc.MeshInstance(a.model.graph,
b,this.material)},updateCylinderShape:function(a,b){var c=void 0!==a.axis?a.axis:1,d=void 0!==a.radius?a.radius:0.5,e=void 0!==a.height?a.height:1,f=new Float32Array(b.lock()),k=0,m=1,h=2;0===c?(k=1,m=0,h=2):2===c&&(k=0,m=2,h=1);var n=0,l;for(cap=-1;2>cap;cap+=2)for(c=0;40>c;c++)l=2*Math.PI*(c/40),f[n+k]=d*Math.cos(l),f[n+m]=0.5*cap*e,f[n+h]=d*Math.sin(l),n+=3,l=2*Math.PI*((c+1)/40),f[n+k]=d*Math.cos(l),f[n+m]=0.5*cap*e,f[n+h]=d*Math.sin(l),n+=3;for(c=0;4>c;c++)l=2*Math.PI*(c/4),f[n+k]=d*Math.cos(l),
f[n+m]=0.5*e,f[n+h]=d*Math.sin(l),n+=3,l=2*Math.PI*(c/4),f[n+k]=d*Math.cos(l),f[n+m]=0.5*-e,f[n+h]=d*Math.sin(l),n+=3;b.unlock()},createPhysicalShape:function(a,b){var c=null,c=null,d=void 0!==b.axis?b.axis:1,e=void 0!==b.radius?b.radius:0.5,f=void 0!==b.height?b.height:1;if("undefined"!==typeof Ammo)switch(d){case 0:c=new Ammo.btVector3(0.5*f,e,e);c=new Ammo.btCylinderShapeX(c);break;case 1:c=new Ammo.btVector3(e,0.5*f,e);c=new Ammo.btCylinderShape(c);break;case 2:c=new Ammo.btVector3(e,e,0.5*f),
c=new Ammo.btCylinderShapeZ(c)}return c},updateDebugShape:function(a,b){var c=b.model.graph;c.setPosition(a.getPosition());c.setRotation(a.getRotation());c.setLocalScale(1,1,1)},recreatePhysicalShapes:function(a){if(a.data.model){var b=this.createDebugMesh(a.data).mesh.vertexBuffer;this.updateCylinderShape(a.data,b);CollisionCylinderSystemImpl._super.recreatePhysicalShapes.call(this,a)}}});CollisionMeshSystemImpl=function(){this.hasDebugShape=!1};CollisionMeshSystemImpl=pc.inherits(CollisionMeshSystemImpl,
CollisionSystemImpl);CollisionMeshSystemImpl.prototype=pc.extend(CollisionMeshSystemImpl.prototype,{beforeInitialize:function(){},createPhysicalShape:function(a,b){if("undefined"!==typeof Ammo&&b.model){var c=b.model,d=new Ammo.btCompoundShape,e,f;for(e=0;e<c.meshInstances.length;e++){var k=c.meshInstances[e],m=k.mesh,h=m.indexBuffer[pc.RENDERSTYLE_SOLID],n=m.vertexBuffer,l=n.getFormat(),r=l.size/4,v;for(f=0;f<l.elements.length;f++){var s=l.elements[f];s.name===pc.SEMANTIC_POSITION&&(v=new Float32Array(n.lock(),
s.offset))}var h=new Uint16Array(h.lock()),n=m.primitive[0].count/3,l=new Ammo.btVector3,s=new Ammo.btVector3,C=new Ammo.btVector3,x,u,w=m.primitive[0].base,B=new Ammo.btTriangleMesh;for(f=0;f<n;f++)m=h[w+3*f]*r,x=h[w+3*f+1]*r,u=h[w+3*f+2]*r,l.setValue(v[m],v[m+1],v[m+2]),s.setValue(v[x],v[x+1],v[x+2]),C.setValue(v[u],v[u+1],v[u+2]),B.addTriangle(l,s,C,!0);f=new Ammo.btBvhTriangleMeshShape(B,!0);r=k.node.getWorldTransform().getScale();f.setLocalScaling(new Ammo.btVector3(r.x,r.y,r.z));r=k.node.getPosition();
k=k.node.getRotation();h=new Ammo.btTransform;h.setIdentity();h.getOrigin().setValue(r.x,r.y,r.z);r=new Ammo.btQuaternion;r.setValue(k.x,k.y,k.z,k.w);h.setRotation(r);d.addChildShape(h,f)}c=a.getWorldTransform().getScale();e=new Ammo.btVector3;e.setValue(c.x,c.y,c.z);d.setLocalScaling(e);return d}},recreatePhysicalShapes:function(a){var b=a.data;null!==b.asset?this.loadModelAsset(a):(b.model=null,this.doRecreatePhysicalShape(a))},loadModelAsset:function(a){var b=a.data.asset,c=a.data,d={parent:a.entity.getRequest()},
e=this.system.app.assets.getAssetById(b);e?e.resource?(c.model=e.resource,this.doRecreatePhysicalShape(a)):this.system.app.assets.load(e,[],d).then(function(b){c.model=b[0];this.doRecreatePhysicalShape(a)}.bind(this)):logERROR(pc.string.format("Trying to load model before asset {0} is loaded.",b))},doRecreatePhysicalShape:function(a){var b=a.entity,c=a.data;c.model?(c.shape&&Ammo.destroy(c.shape),c.shape=this.createPhysicalShape(b,c),b.rigidbody?b.rigidbody.createBody():b.trigger?b.trigger.initialize(c):
b.trigger=new pc.Trigger(this.system.app,a,c)):this.remove(b,c)},updateTransform:function(a,b,c,d){if(a.shape){var e=a.entity.getWorldTransform().getScale(),f=a.shape.getLocalScaling();(e.x!==f.x()||e.y!==f.y()||e.z!==f.z())&&this.doRecreatePhysicalShape(a)}CollisionMeshSystemImpl._super.updateTransform.call(this,a,b,c,d)}});return{CollisionComponentSystem:e}}());pc.extend(pc,function(){var e=function(a,b){this.on("set_type",this.onSetType,this);this.on("set_halfExtents",this.onSetHalfExtents,this);this.on("set_radius",this.onSetRadius,this);this.on("set_height",this.onSetHeight,this);this.on("set_axis",this.onSetAxis,this);this.on("set_asset",this.onSetAsset,this);b.on("livelink:updatetransform",this.onLiveLinkUpdateTransform,this);a.on("beforeremove",this.onBeforeRemove,this)},e=pc.inherits(e,pc.Component);pc.extend(e.prototype,{onSetType:function(a,b,c){b!==
c&&this.system.changeType(this,b,c)},onSetHalfExtents:function(){this.data.initialized&&"box"===this.data.type&&this.system.recreatePhysicalShapes(this)},onSetRadius:function(){this.data.initialized&&("sphere"===this.data.type||"capsule"===this.data.type||"cylinder"===this.data.type)&&this.system.recreatePhysicalShapes(this)},onSetHeight:function(){this.data.initialized&&("capsule"===this.data.type||"cylinder"===this.data.type)&&this.system.recreatePhysicalShapes(this)},onSetAxis:function(){this.data.initialized&&
("capsule"===this.data.type||"cylinder"===this.data.type)&&this.system.recreatePhysicalShapes(this)},onSetAsset:function(a,b,c){b&&(a=this.system.app.assets.getAssetById(b))&&a.off("remove",this.onAssetRemoved,this);if(c&&(c instanceof pc.asset.Asset&&(this.data.asset=c.id),a=this.system.app.assets.getAssetById(this.data.asset)))a.off("remove",this.onAssetRemoved,this),a.on("remove",this.onAssetRemoved,this);this.data.initialized&&"mesh"===this.data.type&&this.system.recreatePhysicalShapes(this)},
onAssetRemoved:function(a){a.off("remove",this.onAssetRemoved,this);this.data.asset===a.id&&(this.asset=null)},onEnable:function(){e._super.onEnable.call(this);this.entity.trigger?this.entity.trigger.enable():this.entity.rigidbody&&this.entity.rigidbody.enabled&&this.entity.rigidbody.enableSimulation()},onDisable:function(){e._super.onDisable.call(this);this.entity.trigger?this.entity.trigger.disable():this.entity.rigidbody&&this.entity.rigidbody.disableSimulation()},onLiveLinkUpdateTransform:function(a,
b,c){if(this.enabled&&this.entity.enabled)this.system.onTransformChanged(this,a,b,c)},onBeforeRemove:function(a,b){this===b&&(a.off("livelink:updatetransform",this.onLiveLinkUpdateTransform,this),this.system.off("beforeremove",this.onBeforeRemove,this))}});return{CollisionComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.enabled=!0;this.type="box";this.halfExtents=new pc.Vec3(0.5,0.5,0.5);this.radius=0.5;this.axis=1;this.height=2;this.model=this.shape=this.asset=null;this.initialized=!1},pc.ComponentData);return{CollisionComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="ballsocketjoint";a.systems.add(this.id,this);this.ComponentType=pc.BallSocketJointComponent;this.DataType=pc.BallSocketJointComponentData;this.schema=[{name:"pivot",displayName:"Pivot",description:"Local space pivot",type:"vector",options:{min:0,step:0.1},defaultValue:[0,0,0]},{name:"position",displayName:"Position",description:"World space joint position",type:"vector",options:{min:0,step:0.1},defaultValue:[0,0,0]},{name:"tau",displayName:"Tau",
description:"TBD",type:"number",defaultValue:0.001,options:{min:0,max:1}},{name:"damping",displayName:"Damping",description:"Damping",type:"number",defaultValue:1,options:{min:0,max:1}},{name:"impulseClamp",displayName:"Impulse Clamp",description:"Impulse Clamp",type:"number",defaultValue:0,options:{min:0,max:100}},{name:"constraint",exposed:!1}];this.debugRender=!1;this.on("remove",this.onRemove,this);pc.ComponentSystem.on("update",this.onUpdate,this);pc.ComponentSystem.on("toolsUpdate",this.onToolsUpdate,
this)},e=pc.inherits(e,pc.ComponentSystem);e.prototype=pc.extend(e.prototype,{onLibraryLoaded:function(){"undefined"===typeof Ammo&&pc.ComponentSystem.off("update",this.onUpdate,this)},initializeComponentData:function(a,b,c){"undefined"!==typeof Ammo&&a.entity.rigidbody&&(b.pivot&&"array"===pc.type(b.pivot)&&(b.pivot=new pc.Vec3(b.pivot[0],b.pivot[1],b.pivot[2])),b.position&&"array"===pc.type(b.position)&&(b.position=new pc.Vec3(b.position[0],b.position[1],b.position[2])),c=new Ammo.btVector3(b.pivot.x,
b.pivot.y,b.pivot.z),b.constraint=new Ammo.btPoint2PointConstraint(a.entity.rigidbody.body,c),c=b.constraint.getPivotInB(),b.position=[c.x(),c.y(),c.z()],this.app.systems.rigidbody.addConstraint(b.constraint));c="constraint pivot position tau damping impulseClamp".split(" ");e._super.initializeComponentData.call(this,a,b,c)},cloneComponent:function(a,b){return this.addComponent(b,{pivot:[a.ballsocketjoint.pivot.x,a.ballsocketjoint.pivot.y,a.ballsocketjoint.pivot.z],position:[a.ballsocketjoint.position.x,
a.ballsocketjoint.position.y,a.ballsocketjoint.position.z],tau:a.ballsocketjoint.tau,damping:a.ballsocketjoint.damping,impulseClamp:a.ballsocketjoint.impulseClamp})},onRemove:function(a,b){b.constraint&&this.app.systems.rigidbody.removeConstraint(b.constraint)},setDebugRender:function(a){this.debugRender=a},onUpdate:function(){this.debugRender&&this.updateDebugShapes()},onToolsUpdate:function(){this.updateDebugShapes()},updateDebugShapes:function(){var a=this.store,b;for(b in a);}});return{BallSocketJointComponentSystem:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.on("set_pivot",this.onSetPivot,this);this.on("set_position",this.onSetPosition,this);this.on("set_tau",this.onSetTau,this);this.on("set_damping",this.onSetDamping,this);this.on("set_impulseClamp",this.onSetImpulseClamp,this)},pc.Component);pc.extend(e.prototype,{onSetPivot:function(a,b,c){"undefined"!==typeof Ammo&&this.data.constraint&&(a=new Ammo.btVector3(c.x,c.y,c.z),this.data.constraint.setPivotA(a))},onSetPosition:function(a,b,c){"undefined"!==
typeof Ammo&&this.data.constraint&&(a=new Ammo.btVector3(c.x,c.y,c.z),this.data.constraint.setPivotB(a))},onSetTau:function(a,b,c){"undefined"!==typeof Ammo&&this.data.constraint&&this.data.constraint.get_m_setting().set_m_tau(c)},onSetDamping:function(a,b,c){"undefined"!==typeof Ammo&&this.data.constraint&&this.data.constraint.get_m_setting().set_m_damping(c)},onSetImpulseClamp:function(a,b,c){"undefined"!==typeof Ammo&&this.data.constraint&&this.data.constraint.get_m_setting().set_m_impulseClamp(c)}});
return{BallSocketJointComponent:e}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.pivot=new pc.Vec3(0,0,0);this.position=new pc.Vec3(0,0,0);this.tau=0.3;this.damping=1;this.impulseClamp=0;this.constraint=null},pc.ComponentData);return{BallSocketJointComponentData:e}}());pc.extend(pc,function(){var e=function(a){this.id="particlesystem";this.description="Updates and renders particle system in the scene.";a.systems.add(this.id,this);this.ComponentType=pc.ParticleSystemComponent;this.DataType=pc.ParticleSystemComponentData;this.schema=[{name:"enabled",displayName:"Enabled",description:"Enable or disable the component",type:"boolean",defaultValue:!0},{name:"autoPlay",displayName:"Auto Play",description:"Play automatically on start",type:"boolean",defaultValue:!0},{name:"numParticles",
displayName:"Particle Count",description:"Total number of particles allocated",type:"number",defaultValue:30,options:{min:1,max:4096,step:1}},{name:"lifetime",displayName:"Lifetime",description:"The lifetime of each particle in seconds",type:"number",defaultValue:5,options:{min:0,step:0.01}},{name:"rate",displayName:"Emission Rate",description:"Delay between emission of each particle in seconds",type:"number",defaultValue:0.1,options:{min:0,step:0.01}},{name:"rate2",displayName:"Emission Rate 2",
description:"Defines the random range of Emission Rate",type:"number",defaultValue:0.1,options:{min:0,step:0.01}},{name:"startAngle",displayName:"Start Angle",description:"The starting angle of each particle in degrees",type:"number",defaultValue:0,options:{min:0,step:0.01}},{name:"startAngle2",displayName:"Start Angle 2",description:"Defines the random range of Start Angle",type:"number",defaultValue:0,options:{min:0,step:0.01}},{name:"loop",displayName:"Loop",description:"Enables looping",type:"boolean",
defaultValue:!0},{name:"preWarm",displayName:"Pre Warm",description:"Starts particles in the middle of simulation",type:"boolean",defaultValue:!1,filter:{loop:!0}},{name:"lighting",displayName:"Lighting",description:"Enables particle lighting; Only ambient and directional lights are used",type:"boolean",defaultValue:!1},{name:"halfLambert",displayName:"Half-Lambert",description:"Uses Half-Lambert shading instead of Lambert, for softer lighting.",type:"boolean",defaultValue:!1,filter:{lighting:!0}},
{name:"intensity",displayName:"Color Intensity",description:"Controls the intensity of the colors for each particle",type:"number",defaultValue:1,options:{min:0,max:10,step:0.1}},{name:"depthWrite",displayName:"Depth Write",description:"Enables writing to depth buffer, therefore giving accurate occlusion between particles. Do not use it for semi-transparent particles",type:"boolean",defaultValue:!1},{name:"depthSoftening",displayName:"Depth Softening",description:"Softens particle intersections with scene geometry",
type:"number",defaultValue:0,options:{min:0,max:1,step:0.01}},{name:"sort",displayName:"Sorting Mode",description:"How to sort particles; Any value other than None will force CPU mode",type:"enumeration",options:{enumerations:[{name:"None",value:pc.PARTICLESORT_NONE},{name:"Camera Distance",value:pc.PARTICLESORT_DISTANCE},{name:"Newer First",value:pc.PARTICLESORT_NEWER_FIRST},{name:"Older First",value:pc.PARTICLESORT_OLDER_FIRST}]},defaultValue:0},{name:"blendType",displayName:"Blending Mode",description:"How to blend particles",
type:"enumeration",options:{enumerations:[{name:"Alpha",value:pc.BLEND_NORMAL},{name:"Add",value:pc.BLEND_ADDITIVE},{name:"Multiply",value:pc.BLEND_MULTIPLICATIVE}]},defaultValue:pc.BLEND_NORMAL},{name:"stretch",displayName:"Stretch",description:"Stretch particles in the direction of motion",type:"number",defaultValue:0,options:{min:0,step:0.01}},{name:"alignToMotion",displayName:"Align To Motion",description:"Rotates particles along the direction of motion",type:"boolean",defaultValue:!1},{name:"emitterShape",
displayName:"Emitter Shape",description:"Defines a shape in which particles are allowed to spawn",type:"enumeration",options:{enumerations:[{name:"Box",value:pc.EMITTERSHAPE_BOX},{name:"Sphere",value:pc.EMITTERSHAPE_SPHERE}]},defaultValue:pc.EMITTERSHAPE_BOX},{name:"emitterExtents",displayName:"Emitter Extents",description:"Defines a local box in which particles are allowed to spawn",type:"vector",filter:{emitterShape:pc.EMITTERSHAPE_BOX},defaultValue:[0,0,0]},{name:"emitterRadius",displayName:"Emitter Radius",
description:"Defines radius in which particles are allowed to spawn",type:"number",filter:{emitterShape:pc.EMITTERSHAPE_SPHERE},defaultValue:0},{name:"initialVelocity",displayName:"Initial velocity",description:"Adds initial local velocity with defined length and direction based on spawn shape",type:"number",defaultValue:0,options:{min:0,step:0.1}},{name:"wrap",displayName:"Wrap",description:"Set to true to wrap particles around the camera. Used for infinite atmospheric effect like rain or mist.",
type:"boolean",defaultValue:!1},{name:"wrapBounds",displayName:"Wrap Bounds",description:"AABB around to camera to wrap particles. Used for infinite atmospheric effect like rain or mist.",type:"vector",filter:{wrap:!0},defaultValue:[0,0,0]},{name:"colorMapAsset",displayName:"Color Map",description:"Color map used for each particle, with alpha channel",type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"normalMapAsset",displayName:"Normal Map",description:"Normal map used for each particle",
type:"asset",options:{max:1,type:"texture"},defaultValue:null},{name:"mesh",displayName:"Particle Mesh",description:"Mesh to use as particle; Will be quad, if not set",type:"asset",options:{max:1,type:"model"},defaultValue:null},{name:"localVelocityGraph",displayName:"Local Velocity",description:"Curves that define the local velocity of particles over time.",type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,0],[0,0],[0,0]],betweenCurves:!1},options:{curveNames:["X","Y","Z"],secondCurve:"localVelocityGraph2"}},
{name:"localVelocityGraph2",displayName:"Local Velocity 2",description:"Curves that define the range of the Local Velocity",type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,0],[0,0],[0,0]]},filter:{always:!1}},{name:"velocityGraph",displayName:"Velocity",description:"Curves that define the world velocity of particles over time.",type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,-1],[0,-1],[0,-1]],betweenCurves:!0},options:{curveNames:["X","Y","Z"],secondCurve:"velocityGraph2"}},
{name:"velocityGraph2",displayName:"Velocity 2",description:"Curves that define the range of the Velocity",type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,1],[0,1],[0,1]]},options:{curveNames:["X","Y","Z"]},filter:{always:!1}},{name:"rotationSpeedGraph",displayName:"Rotation Speed",description:"Curve that defines how fast particles rotate over time.",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,0],betweenCurves:!1},options:{curveNames:["Angle"],secondCurve:"rotationSpeedGraph2",
verticalAxisValue:360},filter:{alignToMotion:!1}},{name:"rotationSpeedGraph2",displayName:"Rotation Speed 2",description:"Curve that defines the range of Rotation Speed",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,0]},options:{curveNames:["Angle"],verticalAxisValue:360},filter:{always:!1}},{name:"scaleGraph",displayName:"Scale",description:"Curve that defines the scale of particles over time",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,0.1],betweenCurves:!1},options:{curveNames:["Scale"],
verticalAxisValue:1,secondCurve:"scaleGraph2",min:0}},{name:"scaleGraph2",displayName:"Scale 2",description:"Curve that defines the range of Scale",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,0.1]},options:{curveNames:["Scale"],verticalAxisValue:1,min:0},filter:{always:!1}},{name:"colorGraph",displayName:"Color",description:"Curves that define the color of particles over time",type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,1],[0,1],[0,1]],betweenCurves:!1},options:{curveNames:["R",
"G","B"],max:1,min:0}},{name:"colorGraph2",displayName:"Color 2",description:"Curves that define the range of Color",exposed:!1,type:"curveset",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[[0,1,1,1],[0,1,1,1],[0,1,1,1]]},options:{curveNames:["R","G","B"],max:1,min:0}},{name:"alphaGraph",displayName:"Opacity",description:"Curve that defines the opacity of particles over time",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,1],betweenCurves:!1},options:{curveNames:["Opacity"],max:1,min:0,
secondCurve:"alphaGraph2"}},{name:"alphaGraph2",displayName:"Opacity 2",description:"Curve that defines the range of Opacity",type:"curve",defaultValue:{type:pc.CURVE_SMOOTHSTEP,keys:[0,1]},options:{curveNames:["Opacity"],max:1,min:0},filter:{always:!1}},{name:"colorMap",exposed:!1},{name:"normalMap",exposed:!1}];this.exposeProperties();this.propertyTypes={};for(a=0;a<this.schema.length;a++){var b=this.schema[a];this.propertyTypes[b.name]=b.type}this.on("remove",this.onRemove,this);pc.ComponentSystem.on("update",
this.onUpdate,this);pc.ComponentSystem.on("toolsUpdate",this.onToolsUpdate,this);this.debugMesh=this._createDebugMesh();this.debugMaterial=new pc.BasicMaterial;this.debugMaterial.color=new pc.Color(1,0.5,0,1);this.debugMaterial.update()},e=pc.inherits(e,pc.ComponentSystem);pc.extend(e.prototype,{initializeComponentData:function(a,b,c){var c=[],d=this.propertyTypes,g,f;for(f in b)b.hasOwnProperty(f)&&c.push(f),"vector"===d[f]?"array"===pc.type(b[f])&&(b[f]=new pc.Vec3(b[f][0],b[f][1],b[f][2])):"curve"===
d[f]?b[f]instanceof pc.Curve||(g=b[f].type,b[f]=new pc.Curve(b[f].keys),b[f].type=g):"curveset"===d[f]&&!(b[f]instanceof pc.CurveSet)&&(g=b[f].type,b[f]=new pc.CurveSet(b[f].keys),b[f].type=g);e._super.initializeComponentData.call(this,a,b,c);this._inTools&&this._createDebugShape(a)},cloneComponent:function(a,b){for(var c=a.particlesystem.data,d=this.schema,e={},f=0,k=d.length;f<k;f++){var m=d[f],h=c[m.name];h instanceof pc.Vec3||h instanceof pc.Curve||h instanceof pc.CurveSet?(h=h.clone(),e[m.name]=
h):null!==h&&void 0!==h&&(e[m.name]=h)}return this.addComponent(b,e)},onUpdate:function(a){var b=this.store,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c],e=d.entity,d=d.data;d.enabled&&e.enabled&&(e=d.model.emitter,d.paused||e.addTime(a))}},onToolsUpdate:function(){var a=this.store,b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b];c.data.enabled&&c.entity.enabled&&this._updateDebugShape(c)}},onRemove:function(a,b){b.model&&(this.app.scene.removeModel(b.model),a.removeChild(b.model.getGraph()),b.model=
null)},_createDebugMesh:function(){var a=this.app.graphicsDevice,b=new pc.VertexFormat(a,[{semantic:pc.SEMANTIC_POSITION,components:3,type:pc.ELEMENTTYPE_FLOAT32}]),b=new pc.VertexBuffer(a,b,8);(new Float32Array(b.lock())).set([-0.5,-0.5,-0.5,-0.5,-0.5,0.5,0.5,-0.5,0.5,0.5,-0.5,-0.5,-0.5,0.5,-0.5,-0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,-0.5]);b.unlock();a=new pc.IndexBuffer(a,pc.INDEXFORMAT_UINT8,24);(new Uint8Array(a.lock())).set([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);a.unlock();var c=new pc.Mesh;
c.vertexBuffer=b;c.indexBuffer[0]=a;c.primitive[0].type=pc.PRIMITIVE_LINES;c.primitive[0].base=0;c.primitive[0].count=a.getNumIndices();c.primitive[0].indexed=!0;return c},_createDebugShape:function(a){var b=new pc.GraphNode,c=new pc.Model;c.graph=b;c.meshInstances=[new pc.MeshInstance(b,this.debugMesh,this.debugMaterial)];a.data.debugShape=c;a.data.enabled&&a.entity.enabled&&(this.app.root.addChild(b),this.app.scene.addModel(c));return c},_updateDebugShape:function(a){var b=a.data.emitterExtents,
c=b.x,d=b.y,b=b.z,e=a.entity,a=a.data.debugShape.graph;a.setPosition(e.getPosition());a.setRotation(e.getRotation());a.setLocalScale(c||5E-4,d||5E-4,b||5E-4)}});return{ParticleSystemComponentSystem:e}}());pc.extend(pc,function(){var e="emitterExtents emitterRadius colorMap normalMap loop initialVelocity".split(" "),a="numParticles lifetime rate rate2 startAngle startAngle2 lighting halfLambert intensity wrap wrapBounds depthWrite depthSoftening sort stretch alignToMotion preWarm emitterShape".split(" "),b="scaleGraph scaleGraph2 colorGraph colorGraph2 alphaGraph alphaGraph2 velocityGraph velocityGraph2 localVelocityGraph localVelocityGraph2 rotationSpeedGraph rotationSpeedGraph2".split(" "),c=function(){this.on("set_colorMapAsset",
this.onSetColorMapAsset,this);this.on("set_normalMapAsset",this.onSetNormalMapAsset,this);this.on("set_mesh",this.onSetMesh,this);this.on("set_loop",this.onSetLoop,this);this.on("set_blendType",this.onSetBlendType,this);e.forEach(function(a){this.on("set_"+a,this.onSetSimpleProperty,this)}.bind(this));a.forEach(function(a){this.on("set_"+a,this.onSetComplexProperty,this)}.bind(this));b.forEach(function(a){this.on("set_"+a,this.onSetGraphProperty,this)}.bind(this))},c=pc.inherits(c,pc.Component);pc.extend(c.prototype,
{onSetColorMapAsset:function(a,b,c){b&&(a=this.system.app.assets.getAssetById(b))&&a.off("remove",this.onColorMapRemoved,this);if(c){if(a=this._loadAsset(c,function(a){this.colorMap=a}.bind(this)))a.on("remove",this.onColorMapRemoved,this)}else this.colorMap=null},onColorMapRemoved:function(a){a.off("remove",this.onColorMapRemoved,this);this.colorMapAsset=null},onSetNormalMapAsset:function(a,b,c){b&&(a=this.system.app.assets.getAssetById(b))&&a.off("remove",this.onNormalMapRemoved,this);if(c){if(a=
this._loadAsset(c,function(a){this.normalMap=a}.bind(this)))a.on("remove",this.onNormalMapRemoved,this)}else this.normalMap=null},onNormalMapRemoved:function(a){a.off("remove",this.onNormalMapRemoved,this);this.normalMapAsset=null},_loadAsset:function(a,b){var c=a instanceof pc.asset.Asset?a:this.system.app.assets.getAssetById(a);if(c){if(c.resource)b(c.resource);else{var e={parent:this.entity.getRequest()};this.system.app.assets.load(c,[],e).then(function(a){b(a[0])})}return c}logERROR(pc.string.format("Trying to load particle system before asset {0} is loaded.",
a))},onSetMesh:function(a,b,c){b&&"number"===pc.type(b)&&(a=this.system.app.assets.getAssetById(b))&&a.off("remove",this.onMeshRemoved,this);if(c)if(c instanceof pc.asset.Asset||"number"===pc.type(c)){if(a=this._loadAsset(c,function(a){this._onMeshChanged(a)}.bind(this)))a.on("remove",this.onMeshRemoved,this)}else this._onMeshChanged(c);else this._onMeshChanged(null)},_onMeshChanged:function(a){a&&(a=a.meshInstances[0]?a.meshInstances[0].mesh:null);this.data.mesh=a;this.emitter&&(this.emitter.mesh=
a,this.emitter.resetMaterial(),this.rebuild())},onMeshRemoved:function(a){a.off("remove",this.onMeshRemoved,this);this.mesh=null},onSetLoop:function(a,b,c){this.emitter&&(this.emitter[a]=c,this.emitter.resetTime())},onSetBlendType:function(a,b,c){this.emitter&&(this.emitter[a]=c,this.emitter.material.blendType=c,this.emitter.resetMaterial(),this.rebuild())},onSetSimpleProperty:function(a,b,c){this.emitter&&(this.emitter[a]=c,this.emitter.resetMaterial())},onSetComplexProperty:function(a,b,c){this.emitter&&
(this.emitter[a]=c,this.reset(),this.emitter.resetMaterial(),this.rebuild())},onSetGraphProperty:function(a,b,c){this.emitter&&(this.emitter[a]=c,this.emitter.rebuildGraphs(),this.emitter.resetMaterial())},onEnable:function(){!this.emitter&&!this.system._inTools&&(this.emitter=new pc.ParticleEmitter(this.system.app.graphicsDevice,{numParticles:this.data.numParticles,emitterExtents:this.data.emitterExtents,emitterRadius:this.data.emitterRadius,emitterShape:this.data.emitterShape,initialVelocity:this.data.initialVelocity,
wrap:this.data.wrap,wrapBounds:this.data.wrapBounds,lifetime:this.data.lifetime,rate:this.data.rate,rate2:this.data.rate2,startAngle:this.data.startAngle,startAngle2:this.data.startAngle2,scaleGraph:this.data.scaleGraph,scaleGraph2:this.data.scaleGraph2,colorGraph:this.data.colorGraph,colorGraph2:this.data.colorGraph2,alphaGraph:this.data.alphaGraph,alphaGraph2:this.data.alphaGraph2,localVelocityGraph:this.data.localVelocityGraph,localVelocityGraph2:this.data.localVelocityGraph2,velocityGraph:this.data.velocityGraph,
velocityGraph2:this.data.velocityGraph2,rotationSpeedGraph:this.data.rotationSpeedGraph,rotationSpeedGraph2:this.data.rotationSpeedGraph2,colorMap:this.data.colorMap,normalMap:this.data.normalMap,loop:this.data.loop,preWarm:this.data.preWarm,sort:this.data.sort,stretch:this.data.stretch,alignToMotion:this.data.alignToMotion,lighting:this.data.lighting,halfLambert:this.data.halfLambert,intensity:this.data.intensity,depthSoftening:this.data.depthSoftening,scene:this.system.app.scene,mesh:this.data.mesh,
depthWrite:this.data.depthWrite,node:this.entity,blendType:this.data.blendType}),this.emitter.meshInstance.node=this.entity,this.psys=new pc.Model,this.psys.graph=this.entity,this.psys.emitter=this.emitter,this.psys.meshInstances=[this.emitter.meshInstance],this.data.model=this.psys,this.emitter.psys=this.psys,!this.data.loop&&!this.data.autoPlay&&this.pause());this.data.model&&(this.system.app.scene.containsModel(this.data.model)||this.emitter.colorMap&&this.system.app.scene.addModel(this.data.model));
this.data.debugShape&&!this.system.app.scene.containsModel(this.data.debugShape)&&(this.system.app.scene.addModel(this.data.debugShape),this.system.app.root.addChild(this.data.debugShape.graph));c._super.onEnable.call(this)},onDisable:function(){c._super.onDisable.call(this);this.data.model&&this.system.app.scene.containsModel(this.data.model)&&this.system.app.scene.removeModel(this.data.model);this.data.debugShape&&(this.system.app.root.removeChild(this.data.debugShape.graph),this.system.app.scene.removeModel(this.data.debugShape))},
reset:function(){this.stop();this.emitter&&(this.emitter.addTime(1E3),this.emitter.loop=this.data.loop,this.emitter.reset())},stop:function(){this.emitter&&(this.emitter.loop=!1,this.emitter.resetTime(),this.emitter.addTime(0,!0))},pause:function(){this.data.paused=!0},unpause:function(){this.data.paused=!1},play:function(){this.data.paused=!1;this.emitter&&(this.emitter.loop=this.data.loop,this.emitter.resetTime())},isPlaying:function(){return this.data.paused?!1:this.emitter&&this.emitter.loop?
!0:Date.now()<=this.emitter.endTime},rebuild:function(){var a=this.enabled;this.enabled=!1;this.emitter&&(this.emitter.rebuild(),this.emitter.meshInstance.node=this.entity,this.data.model.meshInstances=[this.emitter.meshInstance]);this.enabled=a}});return{ParticleSystemComponent:c}}());pc.extend(pc,function(){var e;e=pc.inherits(function(){this.rate=this.numParticles=1;this.rate2=null;this.startAngle=0;this.startAngle2=null;this.lifetime=50;this.emitterExtents=new pc.Vec3;this.emitterRadius=0;this.emitterShape=pc.EMITTERSHAPE_BOX;this.initialVelocity=0;this.wrapBounds=new pc.Vec3;this.normalMapAsset=this.normalMap=this.colorMapAsset=this.colorMap=null;this.loop=!0;this.preWarm=!1;this.sort=0;this.mode=pc.PARTICLEMODE_GPU;this.scene=null;this.halfLambert=this.lighting=!1;this.intensity=
1;this.stretch=0;this.alignToMotion=!1;this.depthSoftening=0;this.mesh=null;this.depthWrite=!1;this.rotationSpeedGraph2=this.rotationSpeedGraph=this.velocityGraph2=this.velocityGraph=this.localVelocityGraph2=this.localVelocityGraph=this.alphaGraph2=this.alphaGraph=this.colorGraph2=this.colorGraph=this.scaleGraph2=this.scaleGraph=null;this.blendType=pc.BLEND_NORMAL;this.model=null;this.enabled=!0;this.paused=!1;this.debugShape=null},pc.ComponentData);return{ParticleSystemComponentData:e}}());pc.extend(pc,function(){var e=function(a){this._destinations=[];this._callbacks={};this._linkid=(a||"")+"-"+pc.guid.create();this._listener=null;this._handler=this._handleMessage.bind(this);window.addEventListener("message",this._handler,!1);pc.livelinks||(pc.livelinks=[]);pc.livelinks.push(this)};e.prototype.detach=function(){this._listener=null;window.removeEventListener("message",this._handler,!1)};e.prototype.addDestinationWindow=function(a){this._destinations.push(a)};e.prototype.removeDestinationWindow=
function(a){var b;for(b=0;b<this._destinations.length;++b)if(this._destinations[b]==a){this._destinations.splice(b,1);break}};e.prototype.send=function(a,b,c){var b=b||function(){},c=c||this._destinations,d,e=c.length,f=[];for(d=0;d<e;d++){var k=c[d];k.closed?f.push(k):this._send(a,b,k,k.location.protocol+"//"+k.location.host)}e=f.length;for(d=0;d<e;d++)this.removeDestinationWindow(f[d])};e.prototype._send=function(a,b,c,d){a.senderid=this._linkid;this._callbacks[a.id]?this._callbacks[a.id].count++:
this._callbacks[a.id]={count:1,callback:b?b.bind(this):function(){}};var e=pc.LiveLinkMessage.serialize(a);c===window?pc.livelinks.forEach(function(a){a._handleMessage({source:window,data:e})}):c.postMessage(e,d)};e.prototype.listen=function(a){if(this._listener)throw Error("LiveLink already listening");this._listener=a};e.prototype._handleMessage=function(a){var b,c;if(b=pc.LiveLinkMessage.deserialize(a.data))b=new pc.LiveLinkMessage(b,a.source),this._linkid!==b.senderid&&(b.type==pc.LiveLinkMessageType.RECEIVED?
b.content.received_from==this._linkid&&(this._callbacks[b.content.id].count--,0===this._callbacks[b.content.id].count&&(this._callbacks[b.content.id].callback(),delete this._callbacks[b.content.id])):this._listener&&(this._listener(b),c=new pc.LiveLinkMessage,c.type=pc.LiveLinkMessageType.RECEIVED,c.content={id:b.id,received_from:b.senderid},this._send(c,null,a.source,a.origin)))};return{LiveLink:e}}());pc.extend(pc,function(){var e=function(a,b){a=a||{};this.type=a.type||pc.LiveLinkMessageType.NO_TYPE;this.content=a.content||{};this.id=a.id||pc.guid.create();this.senderid=a.senderid||null;this.source=b||null};e.register=function(a){pc.LiveLinkMessageType[a]=a};e.serialize=function(a){return JSON.stringify({type:a.type,content:a.content,id:a.id,senderid:a.senderid},function(a){return this[a]instanceof Float32Array?pc.makeArray(this[a]):this[a]})};e.deserialize=function(a){try{return JSON.parse(a)}catch(b){return null}};
return{LiveLinkMessage:e,LiveLinkMessageRegister:{},LiveLinkMessageType:{NO_TYPE:"NO_TYPE",RECEIVED:"RECEIVED"}}}());pc.extend(pc,function(){var e=function(a,b,c,d){this.type=pc.LiveLinkMessageType.UPDATE_COMPONENT;this.content={id:a,component:b,attribute:c,value:d}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_COMPONENT");return{LiveLinkUpdateComponentMessage:e}}());pc.extend(pc,function(){var e=function(a,b){this.type=pc.LiveLinkMessageType.UPDATE_ENTITY;this.content={id:a,components:b}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ENTITY");var a=function(a,b,c,d){this.type=pc.LiveLinkMessageType.UPDATE_ENTITY_TRANSFORM;this.content={id:a,position:b,rotation:c,scale:d}},a=pc.inherits(a,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ENTITY_TRANSFORM");var b=function(a,b){this.type=pc.LiveLinkMessageType.UPDATE_ENTITY_NAME;
this.content={id:a,name:b}},b=pc.inherits(b,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ENTITY_NAME");var c=function(a,b){this.type=pc.LiveLinkMessageType.UPDATE_ENTITY_ENABLED;this.content={id:a,enabled:b}},c=pc.inherits(c,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ENTITY_ENABLED");var d=function(a,b,c,d){this.type=pc.LiveLinkMessageType.REPARENT_ENTITY;this.content={id:a,oldParentId:b,newParentId:c,index:d}},d=pc.inherits(d,pc.LiveLinkMessage);pc.LiveLinkMessage.register("REPARENT_ENTITY");
return{LiveLinkUpdateEntityMessage:e,LiveLinkUpdateEntityNameMessage:b,LiveLinkUpdateEntityEnabledMessage:c,LiveLinkUpdateEntityTransformMessage:a,LiveLinkReparentEntityMessage:d}}());pc.extend(pc,function(){var e=function(a){this.type=pc.LiveLinkMessageType.CLOSE_ENTITY;this.content={id:a}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("CLOSE_ENTITY");return{LiveLinkCloseEntityMessage:e}}());pc.extend(pc,function(){var e=function(a){this.type=pc.LiveLinkMessageType.OPEN_ENTITY;this.content={entity:a}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("OPEN_ENTITY");var a=function(a,c){this.type=pc.LiveLinkMessageType.OPEN_PACK;this.content={pack:pc.extend({},c.getData())};this.content.pack.hierarchy=PCD.model.Entity.toData(a)},a=pc.inherits(a,pc.LiveLinkMessage);pc.LiveLinkMessage.register("OPEN_PACK");return{LiveLinkOpenEntityMessage:e,LiveLinkOpenPackMessage:a}}());pc.extend(pc,function(){var e=function(a,b,c){this.type=pc.LiveLinkMessageType.UPDATE_ASSET;this.content={id:a,attribute:b,value:c}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ASSET");return{LiveLinkUpdateAssetMessage:e}}());pc.extend(pc,function(){var e=function(a){this.type=pc.LiveLinkMessageType.UPDATE_PACK_SETTINGS;this.content={settings:a}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_PACK_SETTINGS");return{LiveLinkUpdatePackSettings:e}}());pc.extend(pc,function(){var e=function(a,b){this.type=pc.LiveLinkMessageType.UPDATE_ASSETCACHE;this.content={assets:a,deleted:b}},e=pc.inherits(e,pc.LiveLinkMessage);pc.LiveLinkMessage.register("UPDATE_ASSETCACHE");return{LiveLinkUpdateAssetCacheMessage:e}}());pc.extend(pc,function(){var e=function(a){this._guid=pc.guid.create();this._batchHandle=null;this.c={};this._app=a;a||(this._app=pc.Application.getApplication())||console.error("Couldn't find current application");pc.events.attach(this)},e=pc.inherits(e,pc.GraphNode);e.prototype.addComponent=function(a,b){var c=this._app.systems[a];if(c)if(this.c[a])logERROR(pc.string.format("Entity already has {0} Component",a));else return c.addComponent(this,b);else return logERROR(pc.string.format("System: '{0}' doesn't exist",
a)),null};e.prototype.removeComponent=function(a){var b=this._app.systems[a];b?this.c[a]?b.removeComponent(this):logERROR(pc.string.format("Entity doesn't have {0} Component",a)):logERROR(pc.string.format("System: '{0}' doesn't exist",a))};e.prototype.getGuid=function(){return this._guid};e.prototype.setGuid=function(a){this._guid=a};e.prototype._onHierarchyStateChanged=function(a){pc.Entity._super._onHierarchyStateChanged.call(this,a);var b,c=this.c;for(type in c)if(c.hasOwnProperty(type)&&(b=c[type],
b.enabled))if(a)b.onEnable();else b.onDisable()};e.prototype.setRequest=function(a){this._request=a};e.prototype.getRequest=function(){return this._request};e.prototype.addChild=function(a){if(a instanceof pc.Entity&&this.getRoot().findOne("getGuid",a.getGuid()))throw Error("GUID already exists in graph");pc.GraphNode.prototype.addChild.call(this,a)};e.prototype.findByGuid=function(a){if(this._guid===a)return this;for(var b=0;b<this._children.length;b++)if(this._children[b].findByGuid){var c=this._children[b].findByGuid(a);
if(null!==c)return c}return null};e.prototype.destroy=function(){var a=this.getParent(),b;for(b in this.c)this.c[b].enabled=!1;for(b in this.c)this.c[b].system.removeComponent(this);a&&a.removeChild(this);a=this.getChildren();for(b=a.shift();b;)b instanceof pc.Entity&&b.destroy(),b=a.shift()};e.prototype.clone=function(){var a,b=new pc.Entity(this._app);pc.Entity._super._cloneInternal.call(this,b);for(a in this.c)this.c[a].system.cloneComponent(this,b);for(a=0;a<this.getChildren().length;a++){var c=
this.getChildren()[a];c instanceof pc.Entity&&b.addChild(c.clone())}return b};e.deserialize=function(a){var b=pc.json.parse(a.template),c=pc.json.parse(a.parent),d=pc.json.parse(a.children),e=pc.json.parse(a.transform),f=pc.json.parse(a.components),k=pc.json.parse(a.labels);return{_id:a._id,resource_id:a.resource_id,_rev:a._rev,name:a.name,enabled:a.enabled,labels:k,template:b,parent:c,children:d,transform:e,components:f}};e.serialize=function(a){var b={_id:a._id,resource_id:a.resource_id,name:a.name,
enabled:a.enabled,labels:pc.json.stringify(a.labels),template:pc.json.stringify(a.template),parent:pc.json.stringify(a.parent),children:pc.json.stringify(a.children),transform:pc.json.stringify(a.transform),components:pc.json.stringify(a.components)};a._rev&&(b._rev=a._rev);return b};return{Entity:e}}());pc.resources={};pc.extend(pc.resources,function(){var e=function(){void 0===window.RSVP&&logERROR("Missing RSVP library");this._types={};this._handlers={};this._requests={};this._cache={};this._hashes={};this._canonicals={};this._sequence=this._loaded=this._requested=0;this.cache=!0;pc.events.attach(this)};e.prototype={createFileRequest:function(a,c){return new this._types[c](a)},registerHandler:function(a,c){var d=new a;if(""===d.type)throw Error("ResourceRequests must have a type");this._types[d.type]=a;this._handlers[d.type]=
c;c.setLoader(this)},request:function(a,c){var c=c||{},d=this,e=c.parent;c.cache=d.cache;return new pc.promise.Promise(function(f,k){var m,h;void 0===a.length&&(a=[a]);var n=[],l=[];m=0;for(h=a.length;m<h;m++){var r=d._findExistingRequest(a[m]);r!==a[m]&&(r.data=a[m].data);d._makeCanonical(r);l.push(d._request(r,c));n.push(r);e&&e.children.push(r)}var v=function(a,b){var c=[],e=[];b.forEach(function(a){a.children.forEach(function(a){e.push(a);c.push.apply(c,a.promises)})});c.length?pc.promise.all(c).then(function(){v(a,
e,c)},function(a){k(a)}):(d.fire("complete",a),f(a))};pc.promise.all(l).then(function(a){v(a,n,l)},function(a){k(a)})})},open:function(a,c,d){a=new a;return this._handlers[a.type].open(c,a,d)},registerHash:function(a,c){this._hashes[c]||(this._hashes[c]=a);this._canonicals[a]||(this._canonicals[a]=c)},unregisterHash:function(a){var c=this.getHash(a);c&&(delete this._canonicals[c],delete this._hashes[a])},getHash:function(a){return this._hashes[a]},addToCache:function(a,c){var d=this.getHash(a);d&&
(this._cache[d]=c)},getFromCache:function(a){return(a=this.getHash(a))?this._cache[a]:null},removeFromCache:function(a){if(a=this.getHash(a))delete this._cache[a];else return null},resetProgress:function(){this._loaded=this._requested=0},_request:function(a,c){var d=this,e={};for(key in c)e[key]=c[key];null===a.id&&(a.id=this._sequence++);this.fire("request",a);a.promises.length?a.promises.push(new pc.promise.Promise(function(c){a.promises[0].then(function(e){e=d._postOpen(e,a);c(e)})})):a.promises[0]=
new pc.promise.Promise(function(c,k){var m=d._handlers[a.type];if(m){var h=d.getFromCache(a.canonical);h&&(void 0===a.Type||h instanceof a.Type)?(h=d._postOpen(h,a),c(h)):m.load(a,e).then(function(h){try{var m=d._open(h,a,e);m&&(m=d._postOpen(m,a));c(m)}catch(r){k(r)}},function(c){d.fire("error",a,c);k(c)})}else m="Missing handler for type: "+a.type,d.fire("error",a,m),k(m)});d._requests[a.canonical]=a;this._requested++;return a.promises[a.promises.length-1]},_open:function(a,c,d){return this._handlers[c.type].open(a,
c,d)},_postOpen:function(a,c){this.addToCache(c.canonical,a);a=this._handlers[c.type].clone(a,c);delete this._requests[c.canonical];this._loaded++;this.fire("progress",this._loaded/this._requested);this.fire("load",c,a);return a},_makeCanonical:function(a){var c=this.getHash(a.identifier);a.canonical=c&&this._canonicals[c]?this._canonicals[c]:a.identifier},_findExistingRequest:function(a){var c=this._requests[a.canonical];return c?c.type!==a.type||c.result||a.result?a:c:a}};var a=function(){};a.prototype=
{setLoader:function(a){this._loader=a},load:function(){throw Error("Not implemented");},open:function(){throw Error("Not implemented");},clone:function(a){return a}};return{ResourceLoader:e,ResourceHandler:a,ResourceRequest:function(a,c,d){this.id=null;this.canonical=a;this.alternatives=[];this.promises=[];this.children=[];this.data=c;this.result=d;this.identifier=a}}}());pc.extend(pc.resources,function(){var e=function(a,b){b.on("request",this.handleRequest,this);b.on("load",this.handleLoad,this);b.on("error",this.handleError,this);b.on("progress",this.handleProgress,this);this.addCss();this._element=a;this._domCreate()};e.prototype={addCss:function(){var a=document.createElement("style");document.getElementsByTagName("head")[0].appendChild(a);if(a.styleSheet)a.styleSheet.cssText=".pc-resourceloaderdisplay-root {\n   font-family: sans-serif;\n   font-size: 0.7em;\n   color: #aaa;\n   border-collapse: collapse;\n   position: absolute;\n   top: 10px;\n   left: 10px;\n   background-color: black;\n   opacity: 0.6;\n}\n.pc-resourceloaderdisplay-root td {\n   border: 1px solid #aaa;\n}\n.pc-resourceloaderdisplay-subtable {\n   border-collapse: collapse;\n}";
else{var b=document.createTextNode(".pc-resourceloaderdisplay-root {\n   font-family: sans-serif;\n   font-size: 0.7em;\n   color: #aaa;\n   border-collapse: collapse;\n   position: absolute;\n   top: 10px;\n   left: 10px;\n   background-color: black;\n   opacity: 0.6;\n}\n.pc-resourceloaderdisplay-root td {\n   border: 1px solid #aaa;\n}\n.pc-resourceloaderdisplay-subtable {\n   border-collapse: collapse;\n}");a.appendChild(b)}},handleRequest:function(a){console.warn("request: "+a.id);this._domAddRequest(a)},
handleLoad:function(a){console.warn("load: "+a.id);if(a=document.getElementsByClassName("pc-resourcesloaderdisplay-progress-"+a.id))for(var b=0;b<a.length;b++)a[b].textContent="100%"},handleError:function(a,b){var c=document.getElementsByClassName("pc-resourcesloaderdisplay-progress-"+a.id);if(c)for(var d=0;d<c.length;d++)c[d].textContent=b},handleProgress:function(){},_domCreate:function(){this._rootTable=document.createElement("table");this._rootTable.setAttribute("class","pc-resourceloaderdisplay-root");
this._element.appendChild(this._rootTable)},_domAddRequest:function(a){var b="pc-resourcesloaderdisplay-progress-"+a.id,c=document.createElement("tr"),d=document.createElement("td");d.textContent=a.identifier;a=document.createElement("td");a.className=b;a.textContent="0%";c.appendChild(d);c.appendChild(a);this._rootTable.appendChild(c)},_sanitizeId:function(a){return a.replace(/\//,"").replace(/\./,"")}};return{ResourceLoaderDisplay:e}}());pc.extend(pc.resources,function(){var e=function(a){this.cache={};this.loader=a};e.prototype={getTexture:function(a){return(a=this.loader.getHash(a))&&this.cache[a]?this.cache[a]:null},addTexture:function(a,b){var c=this.loader.getHash(a);c&&(this.cache[c]=b)}};return{TextureCache:e}}());pc.extend(pc.resources,function(){var e;e=pc.inherits(function(){},pc.resources.ResourceHandler);e.prototype.load=function(a){return new pc.promise.Promise(function(c,d){pc.net.http.get(a.canonical,function(a){c(a)},{error:function(){d()}})})};e.prototype.open=function(a){return a};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type="json";a.prototype.Type=Object;return{JsonResourceHandler:e,JsonRequest:a}}());pc.extend(pc.resources,function(){var e;e=pc.inherits(function(){},pc.resources.ResourceHandler);e.prototype.load=function(a){return new RSVP.Promise(function(c,d){pc.net.http.get(a.canonical,function(a){c(a)},{error:function(){d()}})})};e.prototype.open=function(a){return a};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type="text";a.prototype.Type=Object;return{TextResourceHandler:e,TextRequest:a}}());pc.extend(pc.resources,function(){var e;e=pc.inherits(function(){},pc.resources.ResourceHandler);e.prototype.load=function(a){return new pc.promise.Promise(function(c,d){var e=new Image;e.onload=function(){c(e)};e.onerror=function(a){d(pc.string.format("Error loading Image from: '{0}'",a.srcElement.src))};e.src=a.canonical})};e.prototype.open=function(a){return a};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type="image";a.prototype.Type=Image;return{ImageResourceHandler:e,
ImageRequest:a}}());pc.extend(pc.resources,function(){var e={repeat:pc.ADDRESS_REPEAT,clamp:pc.ADDRESS_CLAMP_TO_EDGE,mirror:pc.ADDRESS_MIRRORED_REPEAT},a={nearest:pc.FILTER_NEAREST,linear:pc.FILTER_LINEAR,nearest_mip_nearest:pc.FILTER_NEAREST_MIPMAP_NEAREST,linear_mip_nearest:pc.FILTER_LINEAR_MIPMAP_NEAREST,nearest_mip_linear:pc.FILTER_NEAREST_MIPMAP_LINEAR,linear_mip_linear:pc.FILTER_LINEAR_MIPMAP_LINEAR},b=function(a,b){this._device=a;this._assets=b;this.crossOrigin=void 0},b=pc.inherits(b,pc.resources.ResourceHandler);
b.prototype.load=function(a,b){var c=a.canonical,e=this;return new pc.promise.Promise(function(m,h){var n=pc.path.getExtension(c).toLowerCase();if(".dds"===n||".crn"===n)b=b||{},b.binary=!0,b.directory=pc.path.getDirectory(c),b.crn=".crn"===n,pc.net.http.get(c,function(a){m(a)},{cache:!0,responseType:"arraybuffer"});else if(".jpg"===n||".jpeg"===n||".gif"===n||".png"===n){var l=new Image;void 0!==e.crossOrigin&&(l.crossOrigin=e.crossOrigin);l.onload=function(){m(l)};l.onerror=function(a){h(pc.string.format("Error loading Texture from: '{0}'",
a.srcElement.src))};(n=e._assets.getAssetByUrl(a.canonical))&&n.file&&(c+="?t="+n.file.hash);l.src=c}})};b.prototype.open=function(b,c,f){var k;if(b instanceof Image||b instanceof HTMLImageElement){if(c.result)k=c.result;else if(u=pc.string.endsWith(b.src.toLowerCase(),".jpg")?pc.PIXELFORMAT_R8_G8_B8:pc.PIXELFORMAT_R8_G8_B8_A8,k=new pc.Texture(this._device,{width:b.width,height:b.height,format:u}),(c=this._assets.getAssetByUrl(c.canonical))&&c.data){var m=function(b){void 0!==b.name&&(k.name=b.name);
void 0!==b.addressu&&(k.addressU=e[b.addressu]);void 0!==b.addressV&&(k.addressV=e[b.addressV]);void 0!==b.magfilter&&(k.magFilter=a[b.magfilter]);void 0!==b.minfilter&&(k.minFilter=a[b.minfilter]);void 0!==b.anisotropy&&(k.anisotropy=b.anisotropy)};m(c.data);c.on("change",function(a,b,c){"data"===b&&m(c)},this)}k.setSource(b)}else if(b instanceof ArrayBuffer){if(f.crn){var c=b.byteLength,f=new Uint8Array(b),b=Module._malloc(c),h=Module.HEAPU8;dst32Offset=b/4;for(var n=c%4,l=new Uint32Array(f.buffer,
0,(c-n)/4),r=new Uint32Array(h.buffer),v=0;v<l.length;v++)r[dst32Offset+v]=l[v];for(v=c-n;v<c;v++)h[b+v]=f[v];f=Module._crn_decompress_get_data(b,c);b=Module._crn_decompress_get_size(b,c);b=Module.HEAPU8.buffer.slice(f,f+b)}var s=new Uint32Array(b,0,32),c=s[4],f=s[3],h=Math.max(s[7],1),C=s[21],x=s[22],n=65024===s[28],u=null,v=r=l=!1;4===s[20]?827611204===C?(u=pc.PIXELFORMAT_DXT1,l=!0):894720068===C?(u=pc.PIXELFORMAT_DXT5,l=!0):116===C?(u=pc.PIXELFORMAT_RGBA32F,r=!0):826496069===C&&(u=pc.PIXELFORMAT_ETC1,
v=l=!0):32===x&&(u=pc.PIXELFORMAT_R8_G8_B8_A8);s=Math.round(Math.log2(Math.max(c,f))+1);if(!u||h!==s&&l)return u?console.error("DDS has "+h+" mips, but engine requires "+s+" for DXT format. . Empty texture will be created instead."):console.error("This DDS pixel format is currently unsupported. Empty texture will be created instead."),k=new pc.Texture(this._device,{width:4,height:4,format:pc.PIXELFORMAT_R8_G8_B8});k=new pc.Texture(this._device,{width:c,height:f,format:u,cubemap:n});for(var u=128,
s=n?6:1,w,C=827611204===C?8:16,B,x=0;x<s;x++)for(var y=c,A=f,F=0;F<h;F++)l?v?w=8*Math.floor((y+3)/4)*Math.floor((A+3)/4):(w=Math.floor((y+4-1)/4),B=Math.floor((A+4-1)/4),numBlocks=w*B,w=numBlocks*C):w=4*y*A,B=r?new Float32Array(b,u,w):new Uint8Array(b,u,w),n?(k._levels[F]||(k._levels[F]=[]),k._levels[F][x]=B):k._levels[F]=B,u+=r?4*w:w,y=Math.max(0.5*y,1),A=Math.max(0.5*A,1);k.upload()}return k};var c;c=pc.inherits(function(){},pc.resources.ResourceRequest);c.prototype.type="texture";c.prototype.Type=
pc.Texture;return{TextureResourceHandler:b,TextureRequest:c}}());pc.extend(pc.resources,function(){function e(a,b,g,f){if("resource"===b&&(b=this.resource)){var k=b.getSource(),m=!1;if(f)for(var f=f.getSource(),h=0;h<k.length;h++)k[h]===f&&(k[h]=g.getSource(),m=!0);m?(b.setSource(k),a=this.resources.slice(0),this.fire("change",this,"resources",this.resources,a)):a.off("change",e,b)}}var a=function(a,b){this._device=a;this._assets=b},a=pc.inherits(a,pc.resources.ResourceHandler);a.prototype.load=function(a){var b=this,e=null,f=b._getAssetFromRequest(a);return e=
pc.string.startsWith(a.canonical,"asset://")?new pc.promise.Promise(function(e,g){f||g(pc.string.format("Can't load cubemap, asset {0} not found",a.canonical));var h=[];h.push(b._loadCubemapImages(f));var n=f.getFileUrl();n&&pc.string.endsWith(n.toLowerCase(),".dds")&&h.push(b._assets.loader.request(new pc.resources.TextureRequest(n)));pc.promise.all(h).then(function(a){var b=pc.extend({},f.data);b.loadedTextures=a[0];1<a.length&&b.loadedTextures.push(a[1][0]);e(b)},function(a){g(a)})}):new pc.promise.Promise(function(e,
f){pc.net.http.get(a.canonical,function(g){var n=pc.extend({},g),g=n.textures;if(g.length){var l=[];g.forEach(function(b){var d=pc.path.getBasename(b),b=pc.path.join(pc.path.split(a.canonical)[0],b);l.push(new pc.asset.Asset(d,"texture",{url:b}))});n.textures=l.map(function(a){return a.id});g=[];g.push(b._assets.load(l));if(n.prefiltered){var r=pc.path.join(pc.path.split(a.canonical)[0],n.prefiltered);g.push(b._assets.loader.request(new pc.resources.TextureRequest(r)))}pc.promise.all(g).then(function(a){n.loadedTextures=
a[0];n.loadedTextures.push(a[1][0]);e(n)},function(a){f(a)})}else e(n)},{error:function(a){f("Could not load cubemap json: "+a)}})})};a.prototype.open=function(a,b){var e=this._getAssetFromRequest(b),f=[],k=new pc.Texture(this._device,{format:pc.PIXELFORMAT_R8_G8_B8,cubemap:!0,autoMipmap:!0,fixCubemapSeams:!0});k.name=a.name;k.minFilter=a.minFilter;k.magFilter=a.magFilter;k.addressU=pc.ADDRESS_CLAMP_TO_EDGE;k.addressV=pc.ADDRESS_CLAMP_TO_EDGE;k.anisotropy=a.anisotropy;a.loadedTextures&&k.setSource(a.loadedTextures.slice(0,
6).map(function(a){return a.getSource()}));f.push(k);if(a.loadedTextures&&6<a.loadedTextures.length){var k=a.loadedTextures[6],m=128;for(i=0;6>i;i++){var h=new pc.gfx.Texture(this._device,{cubemap:!0,fixCubemapSeams:!0,autoMipmap:!0,format:k.format,rgbm:k.rgbm,width:m,height:m}),m=0.5*m;h._levels[0]=k._levels[i];h.upload();f.push(h)}}e.off("change",this._onCubemapAssetChanged,this);e.on("change",this._onCubemapAssetChanged,this);return f};a.prototype._onCubemapAssetChanged=function(a,b,e,f){var k=
this;if("data"===b){b=!1;if(e.textures.length!==f.textures.length)b=!0;else for(var m=0;m<e.textures.length;m++)if(e.textures[m]!==f.textures[m]){b=!0;break}b&&k._loadCubemapImages(a).then(function(b){var d=a.resources.slice(0);b&&(a.resource.setSource(b.map(function(a){return a.getSource()})),a.fire("change",a,"resources",a.resources,d))});a.resource.minFilter=e.minFilter;a.resource.magFilter=e.magFilter;a.resource.addressU=pc.ADDRESS_CLAMP_TO_EDGE;a.resource.addressV=pc.ADDRESS_CLAMP_TO_EDGE;a.resource.anisotropy=
e.anisotropy;a.resource.upload()}else"file"===b&&(f&&(url=f.url,delete k._assets._urls[url],k._assets.loader.removeFromCache(url),k._assets.loader.unregisterHash(url)),e?(url=a.getFileUrl(),k._assets._urls[url]=a.id,k._assets.loader.registerHash(e.hash,url),k._assets.loader.request(new pc.resources.TextureRequest(url)).then(function(b){var b=b[0],d=128,e=a.resources.slice(0);a.resources=[a.resource];for(m=0;6>m;m++){var f=new pc.gfx.Texture(k._device,{cubemap:!0,fixCubemapSeams:!0,autoMipmap:!0,format:b.format,
rgbm:b.rgbm,width:d,height:d}),d=0.5*d;f._levels[0]=b._levels[m];f.upload();a.resources.push(f)}a.fire("change",a,"resources",a.resources,e)},function(a){console.error("Could not load prefiltered cubemap: "+a)})):(e=a.resources.slice(0),a.resources=[a.resource],a.fire("change",a,"resources",a.resources,e)))};a.prototype._areValidImages=function(a){var b=a&&6===a.length,e;if(b)for(var f=a[0]?a[0].width:null,k=a[0]?a[0].height:null,m=0;6>m;m++){if(!a[m]){b=!1;break}if(!a[m]instanceof HTMLCanvasElement||
!a[m]instanceof HTMLImageElement||!a[m]instanceof HTMLVideoElement){e="Cubemap source is not an instance of HTMLCanvasElement, HTMLImageElement or HTMLVideoElement.";b=!1;break}if(a[m].width!==f||a[m].height!==k){e="Cubemap sources do not all share the same dimensions.";b=!1;break}}e&&alert(e);return b};a.prototype._loadCubemapImages=function(a){var b=a.data,g=this;return new pc.promise.Promise(function(f,k){if(b.textures){for(var m=[],h=0;6>h;h++){var n=parseInt(b.textures[h],10);if(0<=n){n=g._assets.getAssetById(n);
if(!n){k(pc.string.format("Could not load cubemap - Texture {0} not found",b.textures[h]));return}m.push(n)}else{f(null);return}}g._assets.load(m).then(function(b){f(b);m.forEach(function(b){b.off("change",e,a);b.on("change",e,a)})},function(a){k(a)})}else f(null)})};a.prototype._getAssetFromRequest=function(a){return pc.string.startsWith(a.canonical,"asset://")?this._assets.getAssetById(parseInt(a.canonical.slice(8))):this._assets.getAssetByUrl(a.canonical)};var b;b=pc.inherits(function(){},pc.resources.ResourceRequest);
b.prototype.type="cubemap";b.prototype.Type=pc.Texture;return{CubemapResourceHandler:a,CubemapRequest:b}}());pc.extend(pc.resources,function(){var e={points:pc.PRIMITIVE_POINTS,lines:pc.PRIMITIVE_LINES,lineloop:pc.PRIMITIVE_LINELOOP,linestrip:pc.PRIMITIVE_LINESTRIP,triangles:pc.PRIMITIVE_TRIANGLES,trianglestrip:pc.PRIMITIVE_TRISTRIP,trianglefan:pc.PRIMITIVE_TRIFAN},a={int8:pc.ELEMENTTYPE_INT8,uint8:pc.ELEMENTTYPE_UINT8,int16:pc.ELEMENTTYPE_INT16,uint16:pc.ELEMENTTYPE_UINT16,int32:pc.ELEMENTTYPE_INT32,uint32:pc.ELEMENTTYPE_UINT32,float32:pc.ELEMENTTYPE_FLOAT32},b=function(a,b){this._device=a;this._assets=
b},b=pc.inherits(b,pc.resources.ResourceHandler);b.prototype.load=function(a,b){var c=this;if(a.data)for(var e,m=[],h=a.data,n=0;n<h.length;n++)h[n].material&&(e=this._assets.getAssetById(h[n].material))&&m.push(e);return new pc.promise.Promise(function(e,h){var k=a.canonical;b=b||{};b.directory=pc.path.getDirectory(k);pc.net.http.get(k,function(a){m.length?c._assets.load(m).then(function(){e(a)}):e(a)},{cache:b.cache,error:function(a){h(pc.string.format("Error loading model: {0} [{1}]",k,a))}})})};
b.prototype.open=function(a,b,c){c=c||{};c.directory=c.directory||"";c.parent=b;var e=null;1>=a.model.version?logERROR(pc.string.format("Asset: {0}, is an old model format. Upload source assets to re-import.",b.canonical)):2<=a.model.version&&(e=this._loadModelJson(a,b.data,c));return e};b.prototype.clone=function(a){return a.clone()};b.prototype._loadModelJson=function(b,c,f){var k=b.model,m,h,b=[];for(m=0;m<k.nodes.length;m++){var n=k.nodes[m],l=new pc.GraphNode;l.setName(n.name);l.setLocalPosition(n.position[0],
n.position[1],n.position[2]);l.setLocalEulerAngles(n.rotation[0],n.rotation[1],n.rotation[2]);l.setLocalScale(n.scale[0],n.scale[1],n.scale[2]);b.push(l)}for(m=1;m<k.parents.length;m++)b[k.parents[m]].addChild(b[m]);!this._device.supportsBoneTextures&&0<k.skins.length&&(m=this._device.getBoneLimit(),pc.partitionSkin(k,c,m));var r=[],n=[];for(m=0;m<k.skins.length;m++){var v=k.skins[m],l=[];for(h=0;h<v.inverseBindMatrices.length;h++){var s=v.inverseBindMatrices[h];l[h]=new pc.Mat4(s[0],s[1],s[2],s[3],
s[4],s[5],s[6],s[7],s[8],s[9],s[10],s[11],s[12],s[13],s[14],s[15])}v=new pc.Skin(this._device,l,v.boneNames);r.push(v);l=new pc.SkinInstance(v);s=[];for(h=0;h<v.boneNames.length;h++){var C=b[0].findByName(v.boneNames[h]);s.push(C)}l.bones=s;n.push(l)}var v=[],x,l={position:pc.SEMANTIC_POSITION,normal:pc.SEMANTIC_NORMAL,tangent:pc.SEMANTIC_TANGENT,blendWeight:pc.SEMANTIC_BLENDWEIGHT,blendIndices:pc.SEMANTIC_BLENDINDICES,color:pc.SEMANTIC_COLOR,texCoord0:pc.SEMANTIC_TEXCOORD0,texCoord1:pc.SEMANTIC_TEXCOORD1,
texCoord2:pc.SEMANTIC_TEXCOORD2,texCoord3:pc.SEMANTIC_TEXCOORD3,texCoord4:pc.SEMANTIC_TEXCOORD4,texCoord5:pc.SEMANTIC_TEXCOORD5,texCoord6:pc.SEMANTIC_TEXCOORD6,texCoord7:pc.SEMANTIC_TEXCOORD7};for(m=0;m<k.vertices.length;m++){s=k.vertices[m];if(s.position&&s.normal&&s.texCoord0){C=[];for(h=0;h<k.meshes.length;h++)k.meshes[h].vertices===m&&(C=C.concat(k.meshes[h].indices));tangents=pc.calculateTangents(s.position.data,s.normal.data,s.texCoord0.data,C);s.tangent={type:"float32",components:4,data:tangents}}h=
[];for(x in s){var C=s[x],u=C.type;this._device.supportsUnsignedByte||("uint8"===u&&(u="float32"),"int8"===u&&(u="float32"));h.push({semantic:l[x],components:C.components,type:a[u],normalize:!1})}h=new pc.VertexFormat(this._device,h);var u=s.position.data.length/s.position.components,w=new pc.VertexBuffer(this._device,h,u),B=new pc.VertexIterator(w);for(h=0;h<u;h++){for(x in s)switch(C=s[x],C.components){case 1:B.element[l[x]].set(C.data[h]);break;case 2:B.element[l[x]].set(C.data[2*h],C.data[2*h+
1]);break;case 3:B.element[l[x]].set(C.data[3*h],C.data[3*h+1],C.data[3*h+2]);break;case 4:B.element[l[x]].set(C.data[4*h],C.data[4*h+1],C.data[4*h+2],C.data[4*h+3])}B.next()}B.end();v.push(w)}for(m=l=0;m<k.meshes.length;m++)s=k.meshes[m],void 0!==s.indices&&(l+=s.indices.length);u=C=null;w=0;0<l&&(C=new pc.IndexBuffer(this._device,pc.INDEXFORMAT_UINT16,l),u=new Uint16Array(C.lock()));x=[];for(m=0;m<k.meshes.length;m++){s=k.meshes[m];h=s.aabb.min;var B=s.aabb.max,B=new pc.shape.Aabb(new pc.Vec3(0.5*
(B[0]+h[0]),0.5*(B[1]+h[1]),0.5*(B[2]+h[2])),new pc.Vec3(0.5*(B[0]-h[0]),0.5*(B[1]-h[1]),0.5*(B[2]-h[2]))),y=void 0!==s.indices;h=new pc.Mesh;h.vertexBuffer=v[s.vertices];h.indexBuffer[0]=y?C:null;h.primitive[0].type=e[s.type];h.primitive[0].base=y?s.base+w:s.base;h.primitive[0].count=s.count;h.primitive[0].indexed=y;h.skin=void 0!==s.skin?r[s.skin]:null;h.aabb=B;y&&(u.set(s.indices,w),w+=s.indices.length);x.push(h)}0<l&&C.unlock();v=[];s=new pc.PhongMaterial;for(m=0;m<k.meshInstances.length;m++){h=
k.meshInstances[m];l=b[h.node];h=x[h.mesh];(C=this._getMaterial(m,c,f))||(C=s);l=new pc.MeshInstance(l,h,C);if(h.skin){h=r.indexOf(h.skin);if(-1===h)throw Error("Mesh's skin does not appear in skin array.");l.skinInstance=n[h]}v.push(l)}c=new pc.Model;c.graph=b[0];c.meshInstances=v;c.skinInstances=n;c.getGraph().syncHierarchy();return c};b.prototype._getMaterial=function(a,b,c){var e;if(b&&b.length>a)if(b[a].material){if(a=this._assets.getAssetById(b[a].material)){if(!a.resource)return console.error(pc.string.format("Material asset '{0}' is not loaded.",
a.name)),null}else return console.error("Reference to material not in asset list. Try reloading."),null;e=a.resource}else if(b[a].path&&(c=pc.path.split(c.parent.canonical)[0],c=pc.path.join(c,b[a].path),a=this._assets.getAssetByUrl(c)))e=a.resource;return e};var c;c=pc.inherits(function(){},pc.resources.ResourceRequest);c.prototype.type="model";c.prototype.Type=pc.Model;return{ModelResourceHandler:b,ModelRequest:c}}());pc.extend(pc.resources,function(){function e(a){a.off("remove",e,this);if(a.resource){var b=!1,c;for(c in this)this.hasOwnProperty(c)&&!pc.string.startsWith(c,"_")&&this[c]===a.resource&&(this[c]=null,b=!0);b&&this.update()}}function a(b,c,d,g){if("resource"===c){c=!1;if(g)for(var n in this)this.hasOwnProperty(n)&&!pc.string.startsWith(n,"_")&&this[n]===g&&(this[n]=d,c=!0);c?this.update():(b.off("change",a,this),b.off("remove",e,this))}}function b(a){a.off("remove",b,this);if(a.resource){var c=!1;
this.cubeMap===a.resources[0]&&(this.cubeMap=null,c=!0);if(1<a.resources.length)for(var d=1;d<a.resources.length;d++)this.prefilteredCubeMap128===a.resources[d]&&(this.prefilteredCubeMap128=null,c=!0);c&&this.update()}}function c(a,b,d,e){if("resources"===b){b=!1;this.cubeMap===e[0]&&(this.cubeMap=d[0],b=!0);for(var g=0;6>g;g++)this.prefilteredCubeMap128===e[g]&&(this.prefilteredCubeMap128=d[g],b=!0);b?this.update():a.off("change",c,this)}}var d=function(a,b){this._assets=b;this._device=a},d=pc.inherits(d,
pc.resources.ResourceHandler);d.prototype.load=function(a){var b=null;return b=pc.string.startsWith(a.canonical,"asset://")?new pc.promise.Promise(function(b,c){var d=this._getAssetFromRequest(a);d||c(pc.string("Can't load material, asset %s not found",a.canonical));b(d.data)}.bind(this)):new pc.promise.Promise(function(b,c){pc.net.http.get(a.canonical,function(c){if("path"===c.mapping_format){var d=this._listReferencedAssets(c),e=[];d.length?(d.forEach(function(b){var c=b.data,d=pc.path.getBasename(c),
c=pc.path.join(pc.path.split(a.canonical)[0],c);e.push(new pc.asset.Asset(d,b.type,{url:c}))}),this._assets.load(e).then(function(){b(c)})):b(c)}else b(c)}.bind(this),{error:function(){c()}})}.bind(this))};d.prototype.open=function(a,b){var c=new pc.PhongMaterial;this._updatePhongMaterial(c,a,b);this._getAssetFromRequest(b).on("change",function(a,d,e){"data"===d&&this._updatePhongMaterial(c,e,b)},this);return c};d.prototype._listReferencedAssets=function(a){return a.parameters.filter(function(a){return("texture"===
a.type||"cubemap"===a.type)&&a.data})};d.prototype._updatePhongMaterial=function(d,g,m){var h=[];g.parameters.push({name:"shadingModel",type:"float",data:"blinn"===g.shader?pc.SPECULAR_BLINN:pc.SPECULAR_PHONG});for(var n=[],l=null,r=0;r<g.parameters.length;r++){var v=g.parameters[r];if("texture"===v.type&&v.data&&!(v.data instanceof pc.Texture)){var s=this._getTextureAssetFromRegistry(v.data,m);s&&n.push(s);this._loadTextureParamFromCache(v,s);!(v.data instanceof pc.Texture)&&s&&h.push(this._loadTextureParamPromise(v,
s))}else"cubeMap"===v.name&&v.data&&(l=v)}if(l)if(m=this._getTextureAssetFromRegistry(l.data,m)){if(m.resources.length){if(l.data=m.resources[0],1<m.resources.length){v=128;for(r=0;6>r;r++)g.parameters.push({name:"prefilteredCubeMap"+v,data:m.resources[r+1]}),v*=0.5}}else h.push(this._assets.load(m).then(function(a){a=a[0];l.data=a[0];if(1<a.length)for(var b=128,c=0;6>c;c++)g.parameters.push({name:"prefilteredCubeMap"+b,data:a[c+1]}),b*=0.5},function(){l.data=null}));m.off("change",c,d);m.on("change",
c,d);m.off("remove",b,d);m.on("remove",b,d)}else pc.log.error(pc.string.format("Could not load cubemap. Asset {0} not found",l.data)),l.data=null;n.forEach(function(b){b.off("change",a,d);b.on("change",a,d);b.off("remove",e,d);b.on("remove",e,d)});h.length?pc.promise.all(h).then(function(){d.init(g)},function(a){pc.log.error(a);d.init(g)}):d.init(g)};d.prototype._getTextureAssetFromRegistry=function(a,b){var c=this._assets.getAssetById(a);!c&&b&&(url=pc.path.join(pc.path.split(b.canonical)[0],a),
c=this._assets.getAssetByUrl(url));return c};d.prototype._loadTextureParamFromCache=function(a,b){b?b.resource&&(a.data=b.resource):(pc.log.error(pc.string.format("Could not load texture. Asset {0} not found",a.data)),a.data=null)};d.prototype._loadTextureParamPromise=function(a,b){return this._assets.load(b).then(function(b){a.data=b[0]},function(){a.data=null})};d.prototype._getAssetFromRequest=function(a){return pc.string.startsWith(a.canonical,"asset://")?this._assets.getAssetById(parseInt(a.canonical.slice(8))):
this._assets.getAssetByUrl(a.canonical)};var g;g=pc.inherits(function(){},pc.resources.ResourceRequest);g.prototype.type="material";g.prototype.Type=pc.Material;return{MaterialRequest:g,MaterialResourceHandler:d}}());pc.extend(pc.resources,function(){var e=function(a,c){this._app=a;this._prefix=c||"";this._queue=[];this._pending=[];this._loaded={};this._loading=null;pc.script.on("created",this._onScriptCreated,this)},e=pc.inherits(e,pc.resources.ResourceHandler);e.prototype.load=function(a,c){c=c||{};c.timeout=c.timeout||6E4;c.cache=!0;return new pc.promise.Promise(function(d,e){var f=a.canonical,k=f;c.cache||(k=this._appendTimestampToUrl(k));k=new pc.URI(k);k.path=pc.path.join(this._prefix,k.path);k=k.toString();
this._loaded[f]?!0!==this._loaded[f]?d(this._loaded[f]):d(null):this._loading?this._queue.push({url:k,canonicalUrl:f,success:d,error:e}):this._addScriptTag(k,f,d,e);c.timeout&&setTimeout(function(){this._loaded[f]||e(pc.string.format("Loading script {0} timed out after {1}s",f,c.timeout/1E3))}.bind(this),c.timeout)}.bind(this))};e.prototype.open=function(a){return a};e.prototype._appendTimestampToUrl=function(a){timestamp=Date.now();uri=new pc.URI(a);uri.query=uri.query?uri.query+"&ts="+timestamp:
"ts="+timestamp;return a=uri.toString()};e.prototype._onScriptCreated=function(a,c){this._pending.push({name:a,callback:c})};e.prototype._addScriptTag=function(a,c,d,e){var f=this,k=document.getElementsByTagName("head")[0],m=document.createElement("script");this._loading=m;m.addEventListener("error",function(a){e(pc.string.format("Error loading script from '{0}'",a.target.src))});var h=!1;m.onload=m.onreadystatechange=function(){if(!h&&(!this.readyState||"loaded"==this.readyState||"complete"==this.readyState)){h=
!0;var a=f._pending.shift();if(a){var b=a.callback(f._app);if(b._pcScriptName)throw Error("Attribute _pcScriptName is reserved on ScriptTypes for ResourceLoader use");b._pcScriptName=a.name;f._loaded[c]=b;f._loader.registerHash(c,c);f._loader.addToCache(c,b);d(b)}else f._loaded[c]=!0,f._loader.registerHash(c,c),f._loader.addToCache(c,!0),d(null);f._loading=null;f._queue.length&&(a=f._queue.shift(),f._addScriptTag(a.url,a.canonicalUrl,a.success,a.error))}};m.src=a;k.appendChild(m)};var a;a=pc.inherits(function(){},
pc.resources.ResourceRequest);a.prototype.type="script";return{ScriptResourceHandler:e,ScriptRequest:a}}());pc.extend(pc.resources,function(){var e;e=pc.inherits(function(){},pc.resources.ResourceHandler);e.prototype.load=function(a,c){return new pc.promise.Promise(function(d,e){var f=a.canonical;pc.path.getDirectory(f);pc.net.http.get(f,function(a){try{d(a)}catch(b){e(pc.string.format("An error occured while loading animation from: '{0}'",f))}}.bind(this),{cache:c.cache,error:function(a){e(a)}})})};e.prototype.open=function(a){return this["_loadAnimationV"+a.animation.version](a)};e.prototype._loadAnimationV3=
function(a){var a=a.animation,c=new pc.Animation;c.setName(a.name);c.setDuration(a.duration);for(var d=0;d<a.nodes.length;d++){var e=new pc.Node,f=a.nodes[d];e._name=f.name;for(var k=0;k<f.keys.length;k++){var m=f.keys[k],h=m.time,n=m.pos,l=m.rot,m=m.scale,n=new pc.Vec3(n[0],n[1],n[2]),l=(new pc.Quat).setFromEulerAngles(l[0],l[1],l[2]),m=new pc.Vec3(m[0],m[1],m[2]),h=new pc.Key(h,n,l,m);e._keys.push(h)}c.addNode(e)}return c};e.prototype._loadAnimationV4=function(a){var a=a.animation,c=new pc.Animation;
c.setName(a.name);c.setDuration(a.duration);for(var d=0;d<a.nodes.length;d++){var e=new pc.Node,f=a.nodes[d];e._name=f.name;for(var k=f.defaults.p,m=f.defaults.r,h=f.defaults.s,n=0;n<f.keys.length;n++){var l=f.keys[n],r=l.t,v=k?k:l.p,s=m?m:l.r,l=h?h:l.s,v=new pc.Vec3(v[0],v[1],v[2]),s=(new pc.Quat).setFromEulerAngles(s[0],s[1],s[2]),l=new pc.Vec3(l[0],l[1],l[2]),r=new pc.Key(r,v,s,l);e._keys.push(r)}c.addNode(e)}return c};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type=
"animation";a.prototype.Type=pc.Animation;return{AnimationResourceHandler:e,AnimationRequest:a}}());pc.extend(pc.resources,function(){var e=function(a){this.manager=a},e=pc.inherits(e,pc.resources.ResourceHandler);e.prototype.load=function(a){var c=this;return new pc.promise.Promise(function(d){var e=c.manager.createSound(a.canonical,function(a){d(a)},function(a){logERROR(a);d(e)})})};e.prototype.open=function(a){return a};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type="audio";a.prototype.Type=pc.Sound;return{AudioResourceHandler:e,AudioRequest:a}}());pc.extend(pc.resources,function(){var e=function(a,c){this._app=a;this._depot=c},e=pc.inherits(e,pc.resources.ResourceHandler);e.prototype.load=function(a){return new pc.promise.Promise(function(c,d){var e=a.canonical;e in pc.content.packs?setTimeout(function(){c(pc.content.packs[e])},0):this._depot.packs.getOne(e,function(a){c(a)}.bind(this),function(a){d(a)})}.bind(this))};e.prototype.open=function(a,c){return this.openPack(a,c)};e.prototype.openPack=function(a,c){var d=pc.extend({},a);d.hierarchy=
this.openEntity(d.hierarchy,c);return new pc.Pack(d)};e.prototype.openEntity=function(a,c){var d;d=this.openEntityHierarchy(a,c);d.syncHierarchy();return d=this.openComponentData(d,a,c)};e.prototype.openEntityHierarchy=function(a,c){var d=new pc.Entity(this._app),e=a.position,f=a.rotation,k=a.scale;d.setName(a.name);d.setGuid(a.resource_id);d.setLocalPosition(e[0],e[1],e[2]);d.setLocalEulerAngles(f[0],f[1],f[2]);d.setLocalScale(k[0],k[1],k[2]);d._enabled=void 0!==a.enabled?a.enabled:!0;d._enabledInHierarchy=
d._enabled;a.labels&&a.labels.forEach(function(a){d.addLabel(a)});d.__parent=a.parent;d.__children=a.children;d.name=a.name;d.template=a.template;k=a.children.length;for(e=0;e<k;e++)f=this.openEntityHierarchy(a.children[e],c),d.addChild(f);return d};e.prototype.openComponentData=function(a,c,d){a.setRequest(d);var e=this._app.systems.list(),f,k=e.length;for(f=0;f<k;f++){var m=c.components[e[f].id];m&&this._app.systems[e[f].id].addComponent(a,m)}a.setRequest(null);e=c.children.length;k=a.getChildren();
for(f=0;f<e;f++)k[f]=this.openComponentData(k[f],c.children[f],d);return a};var a;a=pc.inherits(function(){},pc.resources.ResourceRequest);a.prototype.type="pack";a.prototype.Type=pc.Pack;return{PackResourceHandler:e,PackRequest:a}}());pc.asset={};
pc.extend(pc.asset,function(){var e=-1,a=function(a,c,d,g){this._id=++e;this.name=a;this.type=c;this._file=d?{filename:d.filename,size:d.size,hash:d.hash,url:d.url}:null;this._data=g||{};this._resources=[];pc.events.attach(this)};a.prototype={getFileUrl:function(){return!this.file?null:this.file.url}};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},set:function(a){this._id=a;a>e&&(e=a)}});Object.defineProperty(a.prototype,"file",{get:function(){return this._file},set:function(a){var c=
this._file;((this._file=a)&&!c||!a&&c||a&&c&&a.hash!==c.hash)&&this.fire("change",this,"file",a,c)}});Object.defineProperty(a.prototype,"data",{get:function(){return this._data},set:function(a){var c=this._data;this._data=a;a!==c&&this.fire("change",this,"data",a,c)}});Object.defineProperty(a.prototype,"resource",{get:function(){return this._resources[0]},set:function(a){this._resources[0]=a}});Object.defineProperty(a.prototype,"resources",{get:function(){return this._resources},set:function(a){null===
a||void 0===a?a=[]:"array"!==pc.type(a)&&(a=[a]);this._resources=a}});return{Asset:a,ASSET_ANIMATION:"animation",ASSET_AUDIO:"audio",ASSET_IMAGE:"image",ASSET_JSON:"json",ASSET_MODEL:"model",ASSET_MATERIAL:"material",ASSET_TEXT:"text",ASSET_TEXTURE:"texture",ASSET_CUBEMAP:"cubemap"}}());pc.extend(pc.asset,function(){var e=function(a){if(!a)throw Error("Must provide a ResourceLoader instance for AssetRegistry");this.loader=a;this._cache={};this._names={};this._urls={};this._groups={}};e.prototype={addGroup:function(a,b){this._groups[a]||(this._groups[a]=[]);for(var c in b.assets){var d=this.getAssetById(c);d?pc.extend(d,b.assets[c]):d=this.createAndAddAsset(c,b.assets[c]);this._groups[a].push(d.id)}},createAndAddAsset:function(a,b){var c=new pc.asset.Asset(b.name,b.type,b.file,b.data);
c.id=parseInt(a);this.addAsset(c);c.file?this.loader.registerHash(c.file.hash,c.getFileUrl()):this.loader.registerHash(c.id,"asset://"+c.id);return c},all:function(){return Object.keys(this._cache).map(function(a){return this.getAssetById(a)},this)},list:function(a){if(a){if(this._groups[a])return this._groups[a].map(function(a){return this.getAssetById(a)},this)}else return Object.keys(this._cache).map(function(a){return this.getAssetById(a)},this)},addAsset:function(a){this._cache[a.id]=a;this._names[a.name]||
(this._names[a.name]=[]);this._names[a.name].push(a.id);a.file&&(this._urls[a.getFileUrl()]=a.id);if("cubemap"!==a.type)a.on("change",this._onAssetChanged,this)},removeAsset:function(a){delete this._cache[a.id];delete this._names[a.name];a.fire("remove",a);a.file&&delete this._urls[a.file.url];"cubemap"!==a.type&&a.off("change",this._onAssetChanged,this)},_onAssetChanged:function(a,b,c,d){if("file"===b&&(d&&(b=d.url,delete this._urls[b],this.loader.removeFromCache(b),this.loader.unregisterHash(b)),
c)){b=a.getFileUrl();this._urls[b]=a.id;this.loader.registerHash(c.hash,b);var e=a.resource;this.load([a]).then(function(b){a.fire("change",a,"resource",b[0],e)})}},findAll:function(a,b){var c=this,d=this._names[a];return d?(d=d.map(function(a){return c._cache[a]}),b?d.filter(function(a){return a.type===b}):d):[]},find:function(a,b){var c=this.findAll(a,b);return c?c[0]:null},getAssetByResourceId:function(a){console.warn("WARNING: getAssetByResourceId: Function is deprecated. Use getAssetById() instead.");
return this._cache[a]},getAssetById:function(a){return this._cache[a]},getAssetByUrl:function(a){return this._cache[this._urls[a]]},getAssetByName:function(a){console.warn("WARNING: getAssetByName: Function is deprecated. Use find() or findAll() instead.");return this.find(a)},load:function(a,b,c){a&&"array"!==pc.type(a)&&(a=[a]);void 0===c&&(c=b,b=[]);var d=[];a.forEach(function(a,c){this.getAssetById(a.id)||this.addAsset(a);switch(a.type){case pc.asset.ASSET_MODEL:d.push(this._createModelRequest(a));
break;case pc.asset.ASSET_TEXTURE:d.push(this._createTextureRequest(a,b[c]));break;case pc.asset.ASSET_CUBEMAP:d.push(this._createCubemapRequest(a,b[c]));break;case pc.asset.ASSET_MATERIAL:d.push(this._createMaterialRequest(a));break;default:d.push(this._createAssetRequest(a))}},this);return this.loader.request(d.filter(function(a){return null!==a}),c).then(function(b){return new pc.promise.Promise(function(c){var e=0;d.forEach(function(c,d){c&&(a[d].resources=b[e++])});c(b)})},function(a){setTimeout(function(){throw a;
},0)})},loadFromUrl:function(a,b){if(!b)throw Error("type required");if("model"===b)return this._loadModel(a);pc.path.getDirectory(a);var c=pc.path.getBasename(a).replace(".json",""),d=new pc.asset.Asset(c,b,{url:a});return new pc.promise.Promise(function(a){this.load(d).then(function(b){a({resource:b,asset:d})})}.bind(this))},_loadModel:function(a){var b=this,c=pc.path.getDirectory(a),d=pc.path.getBasename(a),e=d.replace(".json",""),d=pc.path.join(c,d.replace(".json",".mapping.json")),f=new pc.asset.Asset(e,
"model",{url:a}),k=new pc.asset.Asset(e+".mapping","json",{url:d});return new pc.promise.Promise(function(a){b.load([f,k]).then(function(d){var e=d[0],d=d[1];f.data=d;var g=[];d.mapping.forEach(function(a){g.push(new pc.asset.Asset(pc.path.getBasename(a.path),"material",{url:pc.path.join(c,a.path)}))});if(g.length)return d=b.load(g),d.then(function(b){for(var c=0,d=e.meshInstances.length;c<d;c++)e.meshInstances[c].material=b[c];a({resource:e,asset:f})}),d;a({resource:e,asset:f})})})},_createAssetRequest:function(a){var b=
a.getFileUrl();return b?this.loader.createFileRequest(b,a.type):null},_createModelRequest:function(a){var b=a.getFileUrl();return new pc.resources.ModelRequest(b,a.data&&a.data.mapping?a.data.mapping:[])},_createTextureRequest:function(a,b){return new pc.resources.TextureRequest(a.getFileUrl(),null,b)},_createCubemapRequest:function(a,b){var c=a.getFileUrl();if(!c||!pc.string.endsWith(c.toLowerCase(),".json"))c="asset://"+a.id;return new pc.resources.CubemapRequest(c,null,b)},_createMaterialRequest:function(a){var b=
a.getFileUrl();return b?new pc.resources.MaterialRequest(b):new pc.resources.MaterialRequest("asset://"+a.id)}};return{AssetRegistry:e}}());!function(e){var a,b,c={},d={};a=function(a,b,d){c[a]={deps:b,callback:d}};b=function(a){function e(b){if("."!==b.charAt(0))return b;for(var b=b.split("/"),c=a.split("/").slice(0,-1),d=0,f=b.length;f>d;d++){var h=b[d];".."===h?c.pop():"."!==h&&c.push(h)}return c.join("/")}if(d[a])return d[a];if(d[a]={},!c[a])throw Error("Could not find module "+a);for(var k,m=c[a],h=m.deps,m=m.callback,n=[],l=0,r=h.length;r>l;l++)n.push("exports"===h[l]?k={}:b(e(h[l])));h=m.apply(this,n);return d[a]=k||h};b.entries=
c;!0;a("rsvp/all-settled",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=b.isArray,n=b.isNonThenable;c["default"]=function(a,b){return new d(function(b){function c(a){return function(b){g(a,{state:"fulfilled",value:b})}}function f(a){return function(b){g(a,{state:"rejected",reason:b})}}function g(a,c){B[a]=c;0===--r&&b(B)}if(!e(a))throw new TypeError("You must pass an array to allSettled.");var k,r=a.length;if(0===r)return void b([]);for(var B=Array(r),y=0;y<a.length;y++)k=
a[y],n(k)?g(y,{state:"fulfilled",value:k}):d.resolve(k).then(c(y),f(y))},b)}});a("rsvp/all",["./promise","exports"],function(a,b){var c=a["default"];b["default"]=function(a,b){return c.all(a,b)}});a("rsvp/asap",["exports"],function(a){function b(){for(var a=0;a<d.length;a++){var c=d[a];(0,c[0])(c[1])}d.length=0}a["default"]=function(a,b){1===d.push([a,b])&&c()};var c,a="undefined"!=typeof window?window:{},a=a.MutationObserver||a.WebKitMutationObserver,d=[];if("undefined"!=typeof process&&"[object process]"===
{}.toString.call(process))a=function(){process.nextTick(b)};else if(a)var e=0,a=new a(b),n=document.createTextNode(""),a=(a.observe(n,{characterData:!0}),function(){n.data=e=++e%2});else a=function(){setTimeout(b,1)};c=a});a("rsvp/config",["./events","exports"],function(a,b){var c={instrument:!1};a["default"].mixin(c);b.config=c;b.configure=function(a,b){return"onerror"===a?void c.on("error",b):2!==arguments.length?c[a]:void(c[a]=b)}});a("rsvp/defer",["./promise","exports"],function(a,b){var c=a["default"];
b["default"]=function(a){var b={};return b.promise=new c(function(a,c){b.resolve=a;b.reject=c},a),b}});a("rsvp/events",["exports"],function(a){function b(a,c){for(var d=0,e=a.length;e>d;d++)if(a[d]===c)return d;return-1}function c(a){var b=a._promiseCallbacks;return b||(b=a._promiseCallbacks={}),b}a["default"]={mixin:function(a){return a.on=this.on,a.off=this.off,a.trigger=this.trigger,a._promiseCallbacks=void 0,a},on:function(a,d){var e,g=c(this);(e=g[a])||(e=g[a]=[]);-1===b(e,d)&&e.push(d)},off:function(a,
d){var e,g,r=c(this);return d?(e=r[a],g=b(e,d),void(-1!==g&&e.splice(g,1))):void(r[a]=[])},trigger:function(a,b){var d;if(d=c(this)[a])for(var e=0;e<d.length;e++)(0,d[e])(b)}}});a("rsvp/filter",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=b.isFunction;c["default"]=function(a,b,c){return d.all(a,c).then(function(a){if(!e(b))throw new TypeError("You must pass a function as filter's second argument.");for(var f=a.length,g=Array(f),k=0;f>k;k++)g[k]=b(a[k]);return d.all(g,c).then(function(b){for(var c=
Array(f),d=0,e=0;f>e;e++)!0===b[e]&&(c[d]=a[e],d++);return c.length=d,c})})}});a("rsvp/hash-settled",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=b.isNonThenable,n=b.keysOf;c["default"]=function(a){return new d(function(b){function c(a){return function(b){g(a,{state:"fulfilled",value:b})}}function f(a){return function(b){g(a,{state:"rejected",reason:b})}}function g(a,c){w[a]=c;0===--y&&b(w)}var k,u,w={},B=n(a),y=B.length;if(0===y)return void b(w);for(var A=0;A<B.length;A++)u=
B[A],k=a[u],e(k)?g(u,{state:"fulfilled",value:k}):d.resolve(k).then(c(u),f(u))})}});a("rsvp/hash",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=b.isNonThenable,n=b.keysOf;c["default"]=function(a){return new d(function(b,c){function f(a){return function(c){w[a]=c;0===--y&&b(w)}}function g(a){y=0;c(a)}var k,u,w={},B=n(a),y=B.length;if(0===y)return void b(w);for(var A=0;A<B.length;A++)u=B[A],k=a[u],e(k)?(w[u]=k,0===--y&&b(w)):d.resolve(k).then(f(u),g)})}});a("rsvp/instrument",
["./config","./utils","exports"],function(a,b,c){var d=a.config,e=b.now;c["default"]=function(a,b,c){try{d.trigger(a,{guid:b._guidKey+b._id,eventName:a,detail:b._detail,childGuid:c&&b._guidKey+c._id,label:b._label,timeStamp:e(),stack:Error(b._label).stack})}catch(f){setTimeout(function(){throw f;},0)}}});a("rsvp/map",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=(b.isArray,b.isFunction);c["default"]=function(a,b,c){return d.all(a,c).then(function(a){if(!e(b))throw new TypeError("You must pass a function as map's second argument.");
for(var f=a.length,g=Array(f),k=0;f>k;k++)g[k]=b(a[k]);return d.all(g,c)})}});a("rsvp/node",["./promise","./utils","exports"],function(a,b,c){var d=a["default"],e=b.isArray;c["default"]=function(a,b){function c(){for(var e=arguments.length,h=Array(e),k=0;e>k;k++)h[k]=arguments[k];var r;return f||g||!b?r=this:(console.warn('Deprecation: RSVP.denodeify() doesn\'t allow setting the "this" binding anymore. Use yourFunction.bind(yourThis) instead.'),r=b),d.all(h).then(function(c){return new d(function(d,
e){c.push(function(){for(var a=arguments.length,c=Array(a),h=0;a>h;h++)c[h]=arguments[h];a=c[0];h=c[1];if(a)e(a);else if(f)d(c.slice(1));else if(g){for(var a={},k=c.slice(1),h=0;h<b.length;h++)c=b[h],a[c]=k[h];d(a)}else d(h)});a.apply(r,c)})})}var f=!0===b,g=e(b);return c.__proto__=a,c}});a("rsvp/promise","./config ./events ./instrument ./utils ./promise/cast ./promise/all ./promise/race ./promise/resolve ./promise/reject exports".split(" "),function(a,b,c,d,e,n,l,r,v,s){function C(){}function x(a,
b){if(!E(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof x))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._id=z++;this._label=b;this._subscribers=[];G.instrument&&I("created",this);if(C!==a){var c=this,d=function(a){y(c,a)},e=function(a){F(c,a)};try{a(d,e)}catch(f){e(f)}}}function u(a,b){var c,d,e=a._subscribers,f=a._detail;
G.instrument&&I(b===P?"fulfilled":"rejected",a);for(var g=0;g<e.length;g+=3)c=e[g],d=e[g+b],w(b,c,d,f);a._subscribers=null}function w(a,b,c,d){var e,f,g,h,k=E(c);if(k)try{e=c(d),g=!0}catch(m){h=!0,f=m}else e=d,g=!0;B(b,e)||(k&&g?y(b,e):h?F(b,f):a===P?y(b,e):a===L&&F(b,e))}function B(a,b){var c,d=null;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(K(b)&&(d=b.then,E(d)))return d.call(b,function(d){return c?!0:(c=!0,void(b!==d?y(a,d):A(a,d)))},function(b){return c?
!0:(c=!0,void F(a,b))},"Settle: "+(a._label||" unknown promise")),!0}catch(e){return c?!0:(F(a,e),!0)}return!1}function y(a,b){a===b?A(a,b):B(a,b)||A(a,b)}function A(a,b){a._state===D&&(a._state=H,a._detail=b,G.async(J,a))}function F(a,b){a._state===D&&(a._state=H,a._detail=b,G.async(N,a))}function J(a){u(a,a._state=P)}function N(a){a._onerror&&a._onerror(a._detail);u(a,a._state=L)}var G=a.config,I=(b["default"],c["default"]),K=d.objectOrFunction,E=d.isFunction,a=d.now,e=e["default"],n=n["default"],
l=l["default"],r=r["default"],v=v["default"],a="rsvp_"+a()+"-",z=0;s["default"]=x;x.cast=e;x.all=n;x.race=l;x.resolve=r;x.reject=v;var D=void 0,H=0,P=1,L=2;x.prototype={constructor:x,_id:void 0,_guidKey:a,_label:void 0,_state:void 0,_detail:void 0,_subscribers:void 0,_onerror:function(a){G.trigger("error",a)},then:function(a,b,c){var d=this;this._onerror=null;var e=new this.constructor(C,c);if(this._state){var f=arguments;G.async(function(){w(d._state,e,f[d._state-1],d._detail)})}else{var g=this._subscribers,
h=g.length;g[h]=e;g[h+P]=a;g[h+L]=b}return G.instrument&&I("chained",d,e),e},"catch":function(a,b){return this.then(null,a,b)},"finally":function(a,b){var c=this.constructor;return this.then(function(b){return c.resolve(a()).then(function(){return b})},function(b){return c.resolve(a()).then(function(){throw b;})},b)}}});a("rsvp/promise/all",["../utils","exports"],function(a,b){var c=a.isArray,d=a.isNonThenable;b["default"]=function(a,b){var e=this;return new e(function(b,f){function g(a){return function(c){w[a]=
c;0===--u&&b(w)}}function n(a){u=0;f(a)}if(!c(a))throw new TypeError("You must pass an array to all.");var x,u=a.length,w=Array(u);if(0===u)return void b(w);for(var B=0;B<a.length;B++)x=a[B],d(x)?(w[B]=x,0===--u&&b(w)):e.resolve(x).then(g(B),n)},b)}});a("rsvp/promise/cast",["exports"],function(a){a["default"]=function(a,b){return a&&"object"==typeof a&&a.constructor===this?a:new this(function(b){b(a)},b)}});a("rsvp/promise/race",["../utils","exports"],function(a,b){var c=a.isArray,d=(a.isFunction,
a.isNonThenable);b["default"]=function(a,b){var e,f=this;return new f(function(b,g){function n(a){u&&(u=!1,b(a))}function x(a){u&&(u=!1,g(a))}if(!c(a))throw new TypeError("You must pass an array to race.");for(var u=!0,w=0;w<a.length;w++){if(e=a[w],d(e))return u=!1,void b(e);f.resolve(e).then(n,x)}},b)}});a("rsvp/promise/reject",["exports"],function(a){a["default"]=function(a,b){return new this(function(b,c){c(a)},b)}});a("rsvp/promise/resolve",["exports"],function(a){a["default"]=function(a,b){return a&&
"object"==typeof a&&a.constructor===this?a:new this(function(b){b(a)},b)}});a("rsvp/race",["./promise","exports"],function(a,b){var c=a["default"];b["default"]=function(a,b){return c.race(a,b)}});a("rsvp/reject",["./promise","exports"],function(a,b){var c=a["default"];b["default"]=function(a,b){return c.reject(a,b)}});a("rsvp/resolve",["./promise","exports"],function(a,b){var c=a["default"];b["default"]=function(a,b){return c.resolve(a,b)}});a("rsvp/rethrow",["exports"],function(a){a["default"]=function(a){throw setTimeout(function(){throw a;
}),a;}});a("rsvp/utils",["exports"],function(a){function b(a){return"function"==typeof a||"object"==typeof a&&null!==a}a.objectOrFunction=b;a.isFunction=function(a){return"function"==typeof a};a.isNonThenable=function(a){return!b(a)};a.isArray=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};a.now=Date.now||function(){return(new Date).getTime()};a.keysOf=Object.keys||function(a){var b=[],c;for(c in a)b.push(c);return b}});a("rsvp","./rsvp/promise ./rsvp/events ./rsvp/node ./rsvp/all ./rsvp/all-settled ./rsvp/race ./rsvp/hash ./rsvp/hash-settled ./rsvp/rethrow ./rsvp/defer ./rsvp/config ./rsvp/map ./rsvp/resolve ./rsvp/reject ./rsvp/filter ./rsvp/asap exports".split(" "),
function(a,b,c,d,e,n,l,r,v,s,C,x,u,w,B,y,A){function F(){J.on.apply(J,arguments)}var a=a["default"],b=b["default"],c=c["default"],d=d["default"],e=e["default"],n=n["default"],l=l["default"],r=r["default"],v=v["default"],s=s["default"],J=C.config,C=C.configure,x=x["default"],u=u["default"],w=w["default"],B=B["default"];if(J.async=y["default"],"undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){y=window.__PROMISE_INSTRUMENTATION__;C("instrument",!0);for(var N in y)y.hasOwnProperty(N)&&
F(N,y[N])}A.Promise=a;A.EventTarget=b;A.all=d;A.allSettled=e;A.race=n;A.hash=l;A.hashSettled=r;A.rethrow=v;A.defer=s;A.denodeify=c;A.configure=C;A.on=F;A.off=function(){J.off.apply(J,arguments)};A.resolve=u;A.reject=w;A.async=function(a,b){J.async(a,b)};A.map=x;A.filter=B});e.RSVP=b("rsvp")}(window);pc.promise={Promise:window.RSVP.Promise,all:window.RSVP.all};pc.anim={Animation:pc.Animation,Key:pc.Key,Node:pc.Node,Skeleton:pc.Skeleton};pc.audio={AudioManager:pc.AudioManager,Channel:pc.Channel,Channel3d:pc.Channel3d,Listener:pc.Listener,Sound:pc.Sound};
pc.fw={Application:pc.Application,Component:pc.Component,ComponentData:pc.ComponentData,ComponentSystem:pc.ComponentSystem,ContentFile:pc.ContentFile,Entity:pc.Entity,FillMode:{NONE:pc.FILLMODE_NONE,FILL_WINDOW:pc.FILLMODE_FILL_WINDOW,KEEP_ASPECT:pc.FILLMODE_KEEP_ASPECT},LiveLink:pc.LiveLink,LiveLinkCloseEntityMessage:pc.LiveLinkCloseEntityMessage,LiveLinkMessage:pc.LiveLinkMessage,LiveLinkMessageRegister:pc.LiveLinkMessageRegister,LiveLinkMessageType:{CLOSE_ENTITY:"CLOSE_ENTITY",NO_TYPE:"NO_TYPE",
OPEN_ENTITY:"OPEN_ENTITY",OPEN_PACK:"OPEN_PACK",RECEIVED:"RECEIVED",REPARENT_ENTITY:"REPARENT_ENTITY",SELECTION_UPDATED:"SELECTION_UPDATED",UPDATE_ASSET:"UPDATE_ASSET",UPDATE_ASSETCACHE:"UPDATE_ASSETCACHE",UPDATE_COMPONENT:"UPDATE_COMPONENT",UPDATE_ENTITY:"UPDATE_ENTITY",UPDATE_ENTITY_ENABLED:"UPDATE_ENTITY_ENABLED",UPDATE_ENTITY_NAME:"UPDATE_ENTITY_NAME",UPDATE_ENTITY_TRANSFORM:"UPDATE_ENTITY_TRANSFORM",UPDATE_PACK_SETTINGS:"UPDATE_PACK_SETTINGS"},LiveLinkOpenEntityMessage:pc.LiveLinkOpenEntityMessage,
LiveLinkOpenPackMessage:pc.LiveLinkOpenPackMessage,LiveLinkReparentEntityMessage:pc.LiveLinkReparentEntityMessage,LiveLinkUpdateAssetCacheMessage:pc.LiveLinkUpdateAssetCacheMessage,LiveLinkUpdateAssetMessage:pc.LiveLinkUpdateAssetMessage,LiveLinkUpdateComponentMessage:pc.LiveLinkUpdateComponentMessage,LiveLinkUpdateEntityEnabledMessage:pc.LiveLinkUpdateEntityEnabledMessage,LiveLinkUpdateEntityMessage:pc.LiveLinkUpdateEntityMessage,LiveLinkUpdateEntityNameMessage:pc.LiveLinkUpdateEntityNameMessage,
LiveLinkUpdateEntityTransformMessage:pc.LiveLinkUpdateEntityTransformMessage,LiveLinkUpdatePackSettings:pc.LiveLinkUpdatePackSettings,Pack:pc.Pack,ResolutionMode:{AUTO:pc.RESOLUTION_AUTO,FIXED:pc.RESOLUTION_FIXED}};
pc.extend(pc.gfx,{drawQuadWithShader:pc.drawQuadWithShader,precalculatedTangents:pc.precalculatedTangents,programlib:pc.programlib,shaderChunks:pc.shaderChunks,ContextCreationError:pc.ContextCreationError,Device:pc.GraphicsDevice,IndexBuffer:pc.IndexBuffer,ProgramLibrary:pc.ProgramLibrary,RenderTarget:pc.RenderTarget,ScopeId:pc.ScopeId,Shader:pc.Shader,ShaderInput:pc.ShaderInput,Texture:pc.Texture,UnsupportedBrowserError:pc.UnsupportedBrowserError,VertexBuffer:pc.VertexBuffer,VertexFormat:pc.VertexFormat,
VertexIterator:pc.VertexIterator});pc.extend(pc.input,{getTouchTargetCoords:pc.getTouchTargetCoords,Controller:pc.Controller,GamePads:pc.GamePads,Keyboard:pc.Keyboard,KeyboardEvent:pc.KeyboardEvent,Mouse:pc.Mouse,MouseEvent:pc.MouseEvent,Touch:pc.Touch,TouchDevice:pc.TouchDevice,TouchEvent:pc.TouchEvent});pc.posteffect={createFullscreenQuad:pc.createFullscreenQuad,drawFullscreenQuad:pc.drawFullscreenQuad,PostEffect:pc.PostEffect,PostEffectQueue:pc.PostEffectQueue};
pc.extend(pc.scene,{partitionSkin:pc.partitionSkin,BasicMaterial:pc.BasicMaterial,DepthMaterial:pc.DepthMaterial,ForwardRenderer:pc.ForwardRenderer,GraphNode:pc.GraphNode,Material:pc.Material,Command:pc.Command,Mesh:pc.Mesh,MeshInstance:pc.MeshInstance,Model:pc.Model,ParticleEmitter:pc.ParticleEmitter,PhongMaterial:pc.PhongMaterial,Picker:pc.Picker,PickMaterial:pc.PickMaterial,Scene:pc.Scene,Skin:pc.Skin,SkinInstance:pc.SkinInstance});
pc.scene.procedural={calculateTangents:pc.calculateTangents,createMesh:pc.createMesh,createTorus:pc.createTorus,createCylinder:pc.createCylinder,createCapsule:pc.createCapsule,createCone:pc.createCone,createSphere:pc.createSphere,createPlane:pc.createPlane,createBox:pc.createBox};pc.scene.Projection={ORTHOGRAPHIC:pc.PROJECTION_ORTHOGRAPHIC,PERSPECTIVE:pc.PROJECTION_PERSPECTIVE};pc.time={now:pc.now,Timer:pc.Timer};
# Tanky
A fun and cute little mobile game where you must protect your tank

Tanks is Love. Tank is Life. <3
body {
    padding: 0;
    margin: 0;
}

canvas {
    position: absolute;
}
/*
canvas {
	width: 100%;
	height: 100%;
	top: 0;
	left: 0;
	position: fixed;
}*/
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <system.web>
        <identity impersonate="true" />
    </system.web>
</configuration>
